var VN=Object.defineProperty;var Eg=e=>{throw TypeError(e)};var WN=(e,t,r)=>t in e?VN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Qu=(e,t,r)=>WN(e,typeof t!="symbol"?t+"":t,r),Ih=(e,t,r)=>t.has(e)||Eg("Cannot "+r);var F=(e,t,r)=>(Ih(e,t,"read from private field"),r?r.call(e):t.get(e)),Ne=(e,t,r)=>t.has(e)?Eg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),pe=(e,t,r,n)=>(Ih(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ze=(e,t,r)=>(Ih(e,t,"access private method"),r);var Ku=(e,t,r,n)=>({set _(s){pe(e,t,s,r)},get _(){return F(e,t,n)}});function GN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var kr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function YN(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var w1={exports:{}},Bd={},E1={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju=Symbol.for("react.element"),QN=Symbol.for("react.portal"),KN=Symbol.for("react.fragment"),ZN=Symbol.for("react.strict_mode"),XN=Symbol.for("react.profiler"),JN=Symbol.for("react.provider"),ek=Symbol.for("react.context"),tk=Symbol.for("react.forward_ref"),rk=Symbol.for("react.suspense"),nk=Symbol.for("react.memo"),sk=Symbol.for("react.lazy"),_g=Symbol.iterator;function ak(e){return e===null||typeof e!="object"?null:(e=_g&&e[_g]||e["@@iterator"],typeof e=="function"?e:null)}var _1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N1=Object.assign,k1={};function _l(e,t,r){this.props=e,this.context=t,this.refs=k1,this.updater=r||_1}_l.prototype.isReactComponent={};_l.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function S1(){}S1.prototype=_l.prototype;function Lp(e,t,r){this.props=e,this.context=t,this.refs=k1,this.updater=r||_1}var Op=Lp.prototype=new S1;Op.constructor=Lp;N1(Op,_l.prototype);Op.isPureReactComponent=!0;var Ng=Array.isArray,T1=Object.prototype.hasOwnProperty,Pp={current:null},C1={key:!0,ref:!0,__self:!0,__source:!0};function j1(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)T1.call(t,n)&&!C1.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:ju,type:e,key:i,ref:l,props:s,_owner:Pp.current}}function ik(e,t){return{$$typeof:ju,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Dp(e){return typeof e=="object"&&e!==null&&e.$$typeof===ju}function lk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var kg=/\/+/g;function Rh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lk(""+e.key):t.toString(36)}function jc(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case ju:case QN:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+Rh(l,0):n,Ng(s)?(r="",e!=null&&(r=e.replace(kg,"$&/")+"/"),jc(s,t,r,"",function(c){return c})):s!=null&&(Dp(s)&&(s=ik(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(kg,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",Ng(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+Rh(i,o);l+=jc(i,t,r,u,s)}else if(u=ak(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+Rh(i,o++),l+=jc(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Zu(e,t,r){if(e==null)return e;var n=[],s=0;return jc(e,n,"","",function(i){return t.call(r,i,s++)}),n}function ok(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var dr={current:null},Ac={transition:null},uk={ReactCurrentDispatcher:dr,ReactCurrentBatchConfig:Ac,ReactCurrentOwner:Pp};function A1(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:Zu,forEach:function(e,t,r){Zu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Zu(e,function(){t++}),t},toArray:function(e){return Zu(e,function(t){return t})||[]},only:function(e){if(!Dp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=_l;Qe.Fragment=KN;Qe.Profiler=XN;Qe.PureComponent=Lp;Qe.StrictMode=ZN;Qe.Suspense=rk;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uk;Qe.act=A1;Qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=N1({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Pp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)T1.call(t,u)&&!C1.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ju,type:e.type,key:s,ref:i,props:n,_owner:l}};Qe.createContext=function(e){return e={$$typeof:ek,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:JN,_context:e},e.Consumer=e};Qe.createElement=j1;Qe.createFactory=function(e){var t=j1.bind(null,e);return t.type=e,t};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:tk,render:e}};Qe.isValidElement=Dp;Qe.lazy=function(e){return{$$typeof:sk,_payload:{_status:-1,_result:e},_init:ok}};Qe.memo=function(e,t){return{$$typeof:nk,type:e,compare:t===void 0?null:t}};Qe.startTransition=function(e){var t=Ac.transition;Ac.transition={};try{e()}finally{Ac.transition=t}};Qe.unstable_act=A1;Qe.useCallback=function(e,t){return dr.current.useCallback(e,t)};Qe.useContext=function(e){return dr.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return dr.current.useDeferredValue(e)};Qe.useEffect=function(e,t){return dr.current.useEffect(e,t)};Qe.useId=function(){return dr.current.useId()};Qe.useImperativeHandle=function(e,t,r){return dr.current.useImperativeHandle(e,t,r)};Qe.useInsertionEffect=function(e,t){return dr.current.useInsertionEffect(e,t)};Qe.useLayoutEffect=function(e,t){return dr.current.useLayoutEffect(e,t)};Qe.useMemo=function(e,t){return dr.current.useMemo(e,t)};Qe.useReducer=function(e,t,r){return dr.current.useReducer(e,t,r)};Qe.useRef=function(e){return dr.current.useRef(e)};Qe.useState=function(e){return dr.current.useState(e)};Qe.useSyncExternalStore=function(e,t,r){return dr.current.useSyncExternalStore(e,t,r)};Qe.useTransition=function(){return dr.current.useTransition()};Qe.version="18.3.1";E1.exports=Qe;var w=E1.exports;const Kr=Ud(w),ck=GN({__proto__:null,default:Kr},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dk=w,hk=Symbol.for("react.element"),fk=Symbol.for("react.fragment"),mk=Object.prototype.hasOwnProperty,pk=dk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gk={key:!0,ref:!0,__self:!0,__source:!0};function I1(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)mk.call(t,n)&&!gk.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:hk,type:e,key:i,ref:l,props:s,_owner:pk.current}}Bd.Fragment=fk;Bd.jsx=I1;Bd.jsxs=I1;w1.exports=Bd;var a=w1.exports,R1={exports:{}},Ur={},L1={exports:{}},O1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,Q){var N=M.length;M.push(Q);e:for(;0<N;){var K=N-1>>>1,$=M[K];if(0<s($,Q))M[K]=Q,M[N]=$,N=K;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var Q=M[0],N=M.pop();if(N!==Q){M[0]=N;e:for(var K=0,$=M.length,R=$>>>1;K<R;){var me=2*(K+1)-1,ce=M[me],we=me+1,Z=M[we];if(0>s(ce,N))we<$&&0>s(Z,ce)?(M[K]=Z,M[we]=N,K=we):(M[K]=ce,M[me]=N,K=me);else if(we<$&&0>s(Z,N))M[K]=Z,M[we]=N,K=we;else break e}}return Q}function s(M,Q){var N=M.sortIndex-Q.sortIndex;return N!==0?N:M.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],d=1,h=null,f=3,g=!1,p=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=M)n(c),Q.sortIndex=Q.expirationTime,t(u,Q);else break;Q=r(c)}}function k(M){if(b=!1,v(M),!p)if(r(u)!==null)p=!0,H(_);else{var Q=r(c);Q!==null&&A(k,Q.startTime-M)}}function _(M,Q){p=!1,b&&(b=!1,x(j),j=-1),g=!0;var N=f;try{for(v(Q),h=r(u);h!==null&&(!(h.expirationTime>Q)||M&&!B());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var $=K(h.expirationTime<=Q);Q=e.unstable_now(),typeof $=="function"?h.callback=$:h===r(u)&&n(u),v(Q)}else n(u);h=r(u)}if(h!==null)var R=!0;else{var me=r(c);me!==null&&A(k,me.startTime-Q),R=!1}return R}finally{h=null,f=N,g=!1}}var S=!1,I=null,j=-1,D=5,T=-1;function B(){return!(e.unstable_now()-T<D)}function O(){if(I!==null){var M=e.unstable_now();T=M;var Q=!0;try{Q=I(!0,M)}finally{Q?Y():(S=!1,I=null)}}else S=!1}var Y;if(typeof y=="function")Y=function(){y(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,z=G.port2;G.port1.onmessage=O,Y=function(){z.postMessage(null)}}else Y=function(){E(O,0)};function H(M){I=M,S||(S=!0,Y())}function A(M,Q){j=E(function(){M(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){p||g||(p=!0,H(_))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var N=f;f=Q;try{return M()}finally{f=N}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,Q){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var N=f;f=M;try{return Q()}finally{f=N}},e.unstable_scheduleCallback=function(M,Q,N){var K=e.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?K+N:K):N=K,M){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=N+$,M={id:d++,callback:Q,priorityLevel:M,startTime:N,expirationTime:$,sortIndex:-1},N>K?(M.sortIndex=N,t(c,M),r(u)===null&&M===r(c)&&(b?(x(j),j=-1):b=!0,A(k,N-K))):(M.sortIndex=$,t(u,M),p||g||(p=!0,H(_))),M},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(M){var Q=f;return function(){var N=f;f=Q;try{return M.apply(this,arguments)}finally{f=N}}}})(O1);L1.exports=O1;var xk=L1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yk=w,Mr=xk;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var P1=new Set,Fo={};function ai(e,t){il(e,t),il(e+"Capture",t)}function il(e,t){for(Fo[e]=t,e=0;e<t.length;e++)P1.add(t[e])}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vf=Object.prototype.hasOwnProperty,bk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sg={},Tg={};function vk(e){return Vf.call(Tg,e)?!0:Vf.call(Sg,e)?!1:bk.test(e)?Tg[e]=!0:(Sg[e]=!0,!1)}function wk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ek(e,t,r,n){if(t===null||typeof t>"u"||wk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function hr(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Gt[e]=new hr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Gt[t]=new hr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Gt[e]=new hr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Gt[e]=new hr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Gt[e]=new hr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Gt[e]=new hr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Gt[e]=new hr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Gt[e]=new hr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Gt[e]=new hr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mp=/[\-:]([a-z])/g;function Fp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mp,Fp);Gt[t]=new hr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mp,Fp);Gt[t]=new hr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mp,Fp);Gt[t]=new hr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Gt[e]=new hr(e,1,!1,e.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new hr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Gt[e]=new hr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Up(e,t,r,n){var s=Gt.hasOwnProperty(t)?Gt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ek(t,r,s,n)&&(r=null),n||s===null?vk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var fs=yk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xu=Symbol.for("react.element"),bi=Symbol.for("react.portal"),vi=Symbol.for("react.fragment"),Bp=Symbol.for("react.strict_mode"),Wf=Symbol.for("react.profiler"),D1=Symbol.for("react.provider"),M1=Symbol.for("react.context"),Hp=Symbol.for("react.forward_ref"),Gf=Symbol.for("react.suspense"),Yf=Symbol.for("react.suspense_list"),$p=Symbol.for("react.memo"),Ts=Symbol.for("react.lazy"),F1=Symbol.for("react.offscreen"),Cg=Symbol.iterator;function Bl(e){return e===null||typeof e!="object"?null:(e=Cg&&e[Cg]||e["@@iterator"],typeof e=="function"?e:null)}var wt=Object.assign,Lh;function so(e){if(Lh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Lh=t&&t[1]||""}return`
`+Lh+e}var Oh=!1;function Ph(e,t){if(!e||Oh)return"";Oh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{Oh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?so(e):""}function _k(e){switch(e.tag){case 5:return so(e.type);case 16:return so("Lazy");case 13:return so("Suspense");case 19:return so("SuspenseList");case 0:case 2:case 15:return e=Ph(e.type,!1),e;case 11:return e=Ph(e.type.render,!1),e;case 1:return e=Ph(e.type,!0),e;default:return""}}function Qf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vi:return"Fragment";case bi:return"Portal";case Wf:return"Profiler";case Bp:return"StrictMode";case Gf:return"Suspense";case Yf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case M1:return(e.displayName||"Context")+".Consumer";case D1:return(e._context.displayName||"Context")+".Provider";case Hp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $p:return t=e.displayName||null,t!==null?t:Qf(e.type)||"Memo";case Ts:t=e._payload,e=e._init;try{return Qf(e(t))}catch{}}return null}function Nk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qf(t);case 8:return t===Bp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function U1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kk(e){var t=U1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ju(e){e._valueTracker||(e._valueTracker=kk(e))}function B1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=U1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Gc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Kf(e,t){var r=t.checked;return wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function jg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=sa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function H1(e,t){t=t.checked,t!=null&&Up(e,"checked",t,!1)}function Zf(e,t){H1(e,t);var r=sa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xf(e,t.type,r):t.hasOwnProperty("defaultValue")&&Xf(e,t.type,sa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ag(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Xf(e,t,r){(t!=="number"||Gc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ao=Array.isArray;function Li(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+sa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Jf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ig(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(le(92));if(ao(r)){if(1<r.length)throw Error(le(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:sa(r)}}function $1(e,t){var r=sa(t.value),n=sa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Rg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function z1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function em(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?z1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ec,q1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ec=ec||document.createElement("div"),ec.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ec.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Uo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var go={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sk=["Webkit","ms","Moz","O"];Object.keys(go).forEach(function(e){Sk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),go[t]=go[e]})});function V1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||go.hasOwnProperty(e)&&go[e]?(""+t).trim():t+"px"}function W1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=V1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var Tk=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tm(e,t){if(t){if(Tk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function rm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nm=null;function zp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sm=null,Oi=null,Pi=null;function Lg(e){if(e=Ru(e)){if(typeof sm!="function")throw Error(le(280));var t=e.stateNode;t&&(t=Vd(t),sm(e.stateNode,e.type,t))}}function G1(e){Oi?Pi?Pi.push(e):Pi=[e]:Oi=e}function Y1(){if(Oi){var e=Oi,t=Pi;if(Pi=Oi=null,Lg(e),t)for(e=0;e<t.length;e++)Lg(t[e])}}function Q1(e,t){return e(t)}function K1(){}var Dh=!1;function Z1(e,t,r){if(Dh)return e(t,r);Dh=!0;try{return Q1(e,t,r)}finally{Dh=!1,(Oi!==null||Pi!==null)&&(K1(),Y1())}}function Bo(e,t){var r=e.stateNode;if(r===null)return null;var n=Vd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(le(231,t,typeof r));return r}var am=!1;if(ls)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){am=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{am=!1}function Ck(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var xo=!1,Yc=null,Qc=!1,im=null,jk={onError:function(e){xo=!0,Yc=e}};function Ak(e,t,r,n,s,i,l,o,u){xo=!1,Yc=null,Ck.apply(jk,arguments)}function Ik(e,t,r,n,s,i,l,o,u){if(Ak.apply(this,arguments),xo){if(xo){var c=Yc;xo=!1,Yc=null}else throw Error(le(198));Qc||(Qc=!0,im=c)}}function ii(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function X1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Og(e){if(ii(e)!==e)throw Error(le(188))}function Rk(e){var t=e.alternate;if(!t){if(t=ii(e),t===null)throw Error(le(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Og(s),e;if(i===n)return Og(s),t;i=i.sibling}throw Error(le(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?e:t}function J1(e){return e=Rk(e),e!==null?ev(e):null}function ev(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ev(e);if(t!==null)return t;e=e.sibling}return null}var tv=Mr.unstable_scheduleCallback,Pg=Mr.unstable_cancelCallback,Lk=Mr.unstable_shouldYield,Ok=Mr.unstable_requestPaint,St=Mr.unstable_now,Pk=Mr.unstable_getCurrentPriorityLevel,qp=Mr.unstable_ImmediatePriority,rv=Mr.unstable_UserBlockingPriority,Kc=Mr.unstable_NormalPriority,Dk=Mr.unstable_LowPriority,nv=Mr.unstable_IdlePriority,Hd=null,On=null;function Mk(e){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot(Hd,e,void 0,(e.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:Bk,Fk=Math.log,Uk=Math.LN2;function Bk(e){return e>>>=0,e===0?32:31-(Fk(e)/Uk|0)|0}var tc=64,rc=4194304;function io(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=io(o):(i&=l,i!==0&&(n=io(i)))}else l=r&~s,l!==0?n=io(l):i!==0&&(n=io(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-pn(t),s=1<<r,n|=e[r],t&=~s;return n}function Hk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $k(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-pn(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=Hk(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function lm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sv(){var e=tc;return tc<<=1,!(tc&4194240)&&(tc=64),e}function Mh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Au(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pn(t),e[t]=r}function zk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-pn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Vp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-pn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var lt=0;function av(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var iv,Wp,lv,ov,uv,om=!1,nc=[],Qs=null,Ks=null,Zs=null,Ho=new Map,$o=new Map,Is=[],qk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dg(e,t){switch(e){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Ks=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Ho.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$o.delete(t.pointerId)}}function $l(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ru(t),t!==null&&Wp(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Vk(e,t,r,n,s){switch(t){case"focusin":return Qs=$l(Qs,e,t,r,n,s),!0;case"dragenter":return Ks=$l(Ks,e,t,r,n,s),!0;case"mouseover":return Zs=$l(Zs,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Ho.set(i,$l(Ho.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,$o.set(i,$l($o.get(i)||null,e,t,r,n,s)),!0}return!1}function cv(e){var t=Aa(e.target);if(t!==null){var r=ii(t);if(r!==null){if(t=r.tag,t===13){if(t=X1(r),t!==null){e.blockedOn=t,uv(e.priority,function(){lv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ic(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=um(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);nm=n,r.target.dispatchEvent(n),nm=null}else return t=Ru(r),t!==null&&Wp(t),e.blockedOn=r,!1;t.shift()}return!0}function Mg(e,t,r){Ic(e)&&r.delete(t)}function Wk(){om=!1,Qs!==null&&Ic(Qs)&&(Qs=null),Ks!==null&&Ic(Ks)&&(Ks=null),Zs!==null&&Ic(Zs)&&(Zs=null),Ho.forEach(Mg),$o.forEach(Mg)}function zl(e,t){e.blockedOn===t&&(e.blockedOn=null,om||(om=!0,Mr.unstable_scheduleCallback(Mr.unstable_NormalPriority,Wk)))}function zo(e){function t(s){return zl(s,e)}if(0<nc.length){zl(nc[0],e);for(var r=1;r<nc.length;r++){var n=nc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Qs!==null&&zl(Qs,e),Ks!==null&&zl(Ks,e),Zs!==null&&zl(Zs,e),Ho.forEach(t),$o.forEach(t),r=0;r<Is.length;r++)n=Is[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Is.length&&(r=Is[0],r.blockedOn===null);)cv(r),r.blockedOn===null&&Is.shift()}var Di=fs.ReactCurrentBatchConfig,Xc=!0;function Gk(e,t,r,n){var s=lt,i=Di.transition;Di.transition=null;try{lt=1,Gp(e,t,r,n)}finally{lt=s,Di.transition=i}}function Yk(e,t,r,n){var s=lt,i=Di.transition;Di.transition=null;try{lt=4,Gp(e,t,r,n)}finally{lt=s,Di.transition=i}}function Gp(e,t,r,n){if(Xc){var s=um(e,t,r,n);if(s===null)Gh(e,t,n,Jc,r),Dg(e,n);else if(Vk(s,e,t,r,n))n.stopPropagation();else if(Dg(e,n),t&4&&-1<qk.indexOf(e)){for(;s!==null;){var i=Ru(s);if(i!==null&&iv(i),i=um(e,t,r,n),i===null&&Gh(e,t,n,Jc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Gh(e,t,n,null,r)}}var Jc=null;function um(e,t,r,n){if(Jc=null,e=zp(n),e=Aa(e),e!==null)if(t=ii(e),t===null)e=null;else if(r=t.tag,r===13){if(e=X1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jc=e,null}function dv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Pk()){case qp:return 1;case rv:return 4;case Kc:case Dk:return 16;case nv:return 536870912;default:return 16}default:return 16}}var Vs=null,Yp=null,Rc=null;function hv(){if(Rc)return Rc;var e,t=Yp,r=t.length,n,s="value"in Vs?Vs.value:Vs.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return Rc=s.slice(e,1<n?1-n:void 0)}function Lc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sc(){return!0}function Fg(){return!1}function Br(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sc:Fg,this.isPropagationStopped=Fg,this}return wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=sc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=sc)},persist:function(){},isPersistent:sc}),t}var Nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qp=Br(Nl),Iu=wt({},Nl,{view:0,detail:0}),Qk=Br(Iu),Fh,Uh,ql,$d=wt({},Iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ql&&(ql&&e.type==="mousemove"?(Fh=e.screenX-ql.screenX,Uh=e.screenY-ql.screenY):Uh=Fh=0,ql=e),Fh)},movementY:function(e){return"movementY"in e?e.movementY:Uh}}),Ug=Br($d),Kk=wt({},$d,{dataTransfer:0}),Zk=Br(Kk),Xk=wt({},Iu,{relatedTarget:0}),Bh=Br(Xk),Jk=wt({},Nl,{animationName:0,elapsedTime:0,pseudoElement:0}),eS=Br(Jk),tS=wt({},Nl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),rS=Br(tS),nS=wt({},Nl,{data:0}),Bg=Br(nS),sS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=iS[e])?!!t[e]:!1}function Kp(){return lS}var oS=wt({},Iu,{key:function(e){if(e.key){var t=sS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?aS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kp,charCode:function(e){return e.type==="keypress"?Lc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uS=Br(oS),cS=wt({},$d,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hg=Br(cS),dS=wt({},Iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kp}),hS=Br(dS),fS=wt({},Nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),mS=Br(fS),pS=wt({},$d,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gS=Br(pS),xS=[9,13,27,32],Zp=ls&&"CompositionEvent"in window,yo=null;ls&&"documentMode"in document&&(yo=document.documentMode);var yS=ls&&"TextEvent"in window&&!yo,fv=ls&&(!Zp||yo&&8<yo&&11>=yo),$g=" ",zg=!1;function mv(e,t){switch(e){case"keyup":return xS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wi=!1;function bS(e,t){switch(e){case"compositionend":return pv(t);case"keypress":return t.which!==32?null:(zg=!0,$g);case"textInput":return e=t.data,e===$g&&zg?null:e;default:return null}}function vS(e,t){if(wi)return e==="compositionend"||!Zp&&mv(e,t)?(e=hv(),Rc=Yp=Vs=null,wi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return fv&&t.locale!=="ko"?null:t.data;default:return null}}var wS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wS[e.type]:t==="textarea"}function gv(e,t,r,n){G1(n),t=ed(t,"onChange"),0<t.length&&(r=new Qp("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bo=null,qo=null;function ES(e){Tv(e,0)}function zd(e){var t=Ni(e);if(B1(t))return e}function _S(e,t){if(e==="change")return t}var xv=!1;if(ls){var Hh;if(ls){var $h="oninput"in document;if(!$h){var Vg=document.createElement("div");Vg.setAttribute("oninput","return;"),$h=typeof Vg.oninput=="function"}Hh=$h}else Hh=!1;xv=Hh&&(!document.documentMode||9<document.documentMode)}function Wg(){bo&&(bo.detachEvent("onpropertychange",yv),qo=bo=null)}function yv(e){if(e.propertyName==="value"&&zd(qo)){var t=[];gv(t,qo,e,zp(e)),Z1(ES,t)}}function NS(e,t,r){e==="focusin"?(Wg(),bo=t,qo=r,bo.attachEvent("onpropertychange",yv)):e==="focusout"&&Wg()}function kS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zd(qo)}function SS(e,t){if(e==="click")return zd(t)}function TS(e,t){if(e==="input"||e==="change")return zd(t)}function CS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vn=typeof Object.is=="function"?Object.is:CS;function Vo(e,t){if(vn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Vf.call(t,s)||!vn(e[s],t[s]))return!1}return!0}function Gg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yg(e,t){var r=Gg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Gg(r)}}function bv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function vv(){for(var e=window,t=Gc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Gc(e.document)}return t}function Xp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function jS(e){var t=vv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&bv(r.ownerDocument.documentElement,r)){if(n!==null&&Xp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Yg(r,i);var l=Yg(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var AS=ls&&"documentMode"in document&&11>=document.documentMode,Ei=null,cm=null,vo=null,dm=!1;function Qg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dm||Ei==null||Ei!==Gc(n)||(n=Ei,"selectionStart"in n&&Xp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),vo&&Vo(vo,n)||(vo=n,n=ed(cm,"onSelect"),0<n.length&&(t=new Qp("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ei)))}function ac(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _i={animationend:ac("Animation","AnimationEnd"),animationiteration:ac("Animation","AnimationIteration"),animationstart:ac("Animation","AnimationStart"),transitionend:ac("Transition","TransitionEnd")},zh={},wv={};ls&&(wv=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);function qd(e){if(zh[e])return zh[e];if(!_i[e])return e;var t=_i[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in wv)return zh[e]=t[r];return e}var Ev=qd("animationend"),_v=qd("animationiteration"),Nv=qd("animationstart"),kv=qd("transitionend"),Sv=new Map,Kg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function da(e,t){Sv.set(e,t),ai(t,[e])}for(var qh=0;qh<Kg.length;qh++){var Vh=Kg[qh],IS=Vh.toLowerCase(),RS=Vh[0].toUpperCase()+Vh.slice(1);da(IS,"on"+RS)}da(Ev,"onAnimationEnd");da(_v,"onAnimationIteration");da(Nv,"onAnimationStart");da("dblclick","onDoubleClick");da("focusin","onFocus");da("focusout","onBlur");da(kv,"onTransitionEnd");il("onMouseEnter",["mouseout","mouseover"]);il("onMouseLeave",["mouseout","mouseover"]);il("onPointerEnter",["pointerout","pointerover"]);il("onPointerLeave",["pointerout","pointerover"]);ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LS=new Set("cancel close invalid load scroll toggle".split(" ").concat(lo));function Zg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ik(n,t,void 0,e),e.currentTarget=null}function Tv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;Zg(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;Zg(s,o,c),i=u}}}if(Qc)throw e=im,Qc=!1,im=null,e}function mt(e,t){var r=t[gm];r===void 0&&(r=t[gm]=new Set);var n=e+"__bubble";r.has(n)||(Cv(t,e,2,!1),r.add(n))}function Wh(e,t,r){var n=0;t&&(n|=4),Cv(r,e,n,t)}var ic="_reactListening"+Math.random().toString(36).slice(2);function Wo(e){if(!e[ic]){e[ic]=!0,P1.forEach(function(r){r!=="selectionchange"&&(LS.has(r)||Wh(r,!1,e),Wh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ic]||(t[ic]=!0,Wh("selectionchange",!1,t))}}function Cv(e,t,r,n){switch(dv(t)){case 1:var s=Gk;break;case 4:s=Yk;break;default:s=Gp}r=s.bind(null,t,r,e),s=void 0,!am||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Gh(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=Aa(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}Z1(function(){var c=i,d=zp(r),h=[];e:{var f=Sv.get(e);if(f!==void 0){var g=Qp,p=e;switch(e){case"keypress":if(Lc(r)===0)break e;case"keydown":case"keyup":g=uS;break;case"focusin":p="focus",g=Bh;break;case"focusout":p="blur",g=Bh;break;case"beforeblur":case"afterblur":g=Bh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ug;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Zk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=hS;break;case Ev:case _v:case Nv:g=eS;break;case kv:g=mS;break;case"scroll":g=Qk;break;case"wheel":g=gS;break;case"copy":case"cut":case"paste":g=rS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Hg}var b=(t&4)!==0,E=!b&&e==="scroll",x=b?f!==null?f+"Capture":null:f;b=[];for(var y=c,v;y!==null;){v=y;var k=v.stateNode;if(v.tag===5&&k!==null&&(v=k,x!==null&&(k=Bo(y,x),k!=null&&b.push(Go(y,k,v)))),E)break;y=y.return}0<b.length&&(f=new g(f,p,null,r,d),h.push({event:f,listeners:b}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",f&&r!==nm&&(p=r.relatedTarget||r.fromElement)&&(Aa(p)||p[os]))break e;if((g||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,g?(p=r.relatedTarget||r.toElement,g=c,p=p?Aa(p):null,p!==null&&(E=ii(p),p!==E||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=c),g!==p)){if(b=Ug,k="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(b=Hg,k="onPointerLeave",x="onPointerEnter",y="pointer"),E=g==null?f:Ni(g),v=p==null?f:Ni(p),f=new b(k,y+"leave",g,r,d),f.target=E,f.relatedTarget=v,k=null,Aa(d)===c&&(b=new b(x,y+"enter",p,r,d),b.target=v,b.relatedTarget=E,k=b),E=k,g&&p)t:{for(b=g,x=p,y=0,v=b;v;v=ci(v))y++;for(v=0,k=x;k;k=ci(k))v++;for(;0<y-v;)b=ci(b),y--;for(;0<v-y;)x=ci(x),v--;for(;y--;){if(b===x||x!==null&&b===x.alternate)break t;b=ci(b),x=ci(x)}b=null}else b=null;g!==null&&Xg(h,f,g,b,!1),p!==null&&E!==null&&Xg(h,E,p,b,!0)}}e:{if(f=c?Ni(c):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var _=_S;else if(qg(f))if(xv)_=TS;else{_=kS;var S=NS}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=SS);if(_&&(_=_(e,c))){gv(h,_,r,d);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&Xf(f,"number",f.value)}switch(S=c?Ni(c):window,e){case"focusin":(qg(S)||S.contentEditable==="true")&&(Ei=S,cm=c,vo=null);break;case"focusout":vo=cm=Ei=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,Qg(h,r,d);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":Qg(h,r,d)}var I;if(Zp)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else wi?mv(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(fv&&r.locale!=="ko"&&(wi||j!=="onCompositionStart"?j==="onCompositionEnd"&&wi&&(I=hv()):(Vs=d,Yp="value"in Vs?Vs.value:Vs.textContent,wi=!0)),S=ed(c,j),0<S.length&&(j=new Bg(j,e,null,r,d),h.push({event:j,listeners:S}),I?j.data=I:(I=pv(r),I!==null&&(j.data=I)))),(I=yS?bS(e,r):vS(e,r))&&(c=ed(c,"onBeforeInput"),0<c.length&&(d=new Bg("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=I))}Tv(h,t)})}function Go(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ed(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Bo(e,r),i!=null&&n.unshift(Go(e,i,s)),i=Bo(e,t),i!=null&&n.push(Go(e,i,s))),e=e.return}return n}function ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xg(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=Bo(r,i),u!=null&&l.unshift(Go(r,u,o))):s||(u=Bo(r,i),u!=null&&l.push(Go(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var OS=/\r\n?/g,PS=/\u0000|\uFFFD/g;function Jg(e){return(typeof e=="string"?e:""+e).replace(OS,`
`).replace(PS,"")}function lc(e,t,r){if(t=Jg(t),Jg(e)!==t&&r)throw Error(le(425))}function td(){}var hm=null,fm=null;function mm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pm=typeof setTimeout=="function"?setTimeout:void 0,DS=typeof clearTimeout=="function"?clearTimeout:void 0,ex=typeof Promise=="function"?Promise:void 0,MS=typeof queueMicrotask=="function"?queueMicrotask:typeof ex<"u"?function(e){return ex.resolve(null).then(e).catch(FS)}:pm;function FS(e){setTimeout(function(){throw e})}function Yh(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),zo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);zo(t)}function Xs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function tx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var kl=Math.random().toString(36).slice(2),Ln="__reactFiber$"+kl,Yo="__reactProps$"+kl,os="__reactContainer$"+kl,gm="__reactEvents$"+kl,US="__reactListeners$"+kl,BS="__reactHandles$"+kl;function Aa(e){var t=e[Ln];if(t)return t;for(var r=e.parentNode;r;){if(t=r[os]||r[Ln]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=tx(e);e!==null;){if(r=e[Ln])return r;e=tx(e)}return t}e=r,r=e.parentNode}return null}function Ru(e){return e=e[Ln]||e[os],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ni(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function Vd(e){return e[Yo]||null}var xm=[],ki=-1;function ha(e){return{current:e}}function pt(e){0>ki||(e.current=xm[ki],xm[ki]=null,ki--)}function ht(e,t){ki++,xm[ki]=e.current,e.current=t}var aa={},Jt=ha(aa),Er=ha(!1),Wa=aa;function ll(e,t){var r=e.type.contextTypes;if(!r)return aa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function _r(e){return e=e.childContextTypes,e!=null}function rd(){pt(Er),pt(Jt)}function rx(e,t,r){if(Jt.current!==aa)throw Error(le(168));ht(Jt,t),ht(Er,r)}function jv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(le(108,Nk(e)||"Unknown",s));return wt({},r,n)}function nd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||aa,Wa=Jt.current,ht(Jt,e),ht(Er,Er.current),!0}function nx(e,t,r){var n=e.stateNode;if(!n)throw Error(le(169));r?(e=jv(e,t,Wa),n.__reactInternalMemoizedMergedChildContext=e,pt(Er),pt(Jt),ht(Jt,e)):pt(Er),ht(Er,r)}var Xn=null,Wd=!1,Qh=!1;function Av(e){Xn===null?Xn=[e]:Xn.push(e)}function HS(e){Wd=!0,Av(e)}function fa(){if(!Qh&&Xn!==null){Qh=!0;var e=0,t=lt;try{var r=Xn;for(lt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Xn=null,Wd=!1}catch(s){throw Xn!==null&&(Xn=Xn.slice(e+1)),tv(qp,fa),s}finally{lt=t,Qh=!1}}return null}var Si=[],Ti=0,sd=null,ad=0,Vr=[],Wr=0,Ga=null,ns=1,ss="";function Na(e,t){Si[Ti++]=ad,Si[Ti++]=sd,sd=e,ad=t}function Iv(e,t,r){Vr[Wr++]=ns,Vr[Wr++]=ss,Vr[Wr++]=Ga,Ga=e;var n=ns;e=ss;var s=32-pn(n)-1;n&=~(1<<s),r+=1;var i=32-pn(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,ns=1<<32-pn(t)+s|r<<s|n,ss=i+e}else ns=1<<i|r<<s|n,ss=e}function Jp(e){e.return!==null&&(Na(e,1),Iv(e,1,0))}function e0(e){for(;e===sd;)sd=Si[--Ti],Si[Ti]=null,ad=Si[--Ti],Si[Ti]=null;for(;e===Ga;)Ga=Vr[--Wr],Vr[Wr]=null,ss=Vr[--Wr],Vr[Wr]=null,ns=Vr[--Wr],Vr[Wr]=null}var Or=null,Lr=null,xt=!1,hn=null;function Rv(e,t){var r=Qr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function sx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Or=e,Lr=Xs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Or=e,Lr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ga!==null?{id:ns,overflow:ss}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Or=e,Lr=null,!0):!1;default:return!1}}function ym(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bm(e){if(xt){var t=Lr;if(t){var r=t;if(!sx(e,t)){if(ym(e))throw Error(le(418));t=Xs(r.nextSibling);var n=Or;t&&sx(e,t)?Rv(n,r):(e.flags=e.flags&-4097|2,xt=!1,Or=e)}}else{if(ym(e))throw Error(le(418));e.flags=e.flags&-4097|2,xt=!1,Or=e}}}function ax(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Or=e}function oc(e){if(e!==Or)return!1;if(!xt)return ax(e),xt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!mm(e.type,e.memoizedProps)),t&&(t=Lr)){if(ym(e))throw Lv(),Error(le(418));for(;t;)Rv(e,t),t=Xs(t.nextSibling)}if(ax(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Lr=Xs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Lr=null}}else Lr=Or?Xs(e.stateNode.nextSibling):null;return!0}function Lv(){for(var e=Lr;e;)e=Xs(e.nextSibling)}function ol(){Lr=Or=null,xt=!1}function t0(e){hn===null?hn=[e]:hn.push(e)}var $S=fs.ReactCurrentBatchConfig;function Vl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,e))}return e}function uc(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ix(e){var t=e._init;return t(e._payload)}function Ov(e){function t(x,y){if(e){var v=x.deletions;v===null?(x.deletions=[y],x.flags|=16):v.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=ra(x,y),x.index=0,x.sibling=null,x}function i(x,y,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<y?(x.flags|=2,y):v):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,v,k){return y===null||y.tag!==6?(y=rf(v,x.mode,k),y.return=x,y):(y=s(y,v),y.return=x,y)}function u(x,y,v,k){var _=v.type;return _===vi?d(x,y,v.props.children,k,v.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ts&&ix(_)===y.type)?(k=s(y,v.props),k.ref=Vl(x,y,v),k.return=x,k):(k=Bc(v.type,v.key,v.props,null,x.mode,k),k.ref=Vl(x,y,v),k.return=x,k)}function c(x,y,v,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=nf(v,x.mode,k),y.return=x,y):(y=s(y,v.children||[]),y.return=x,y)}function d(x,y,v,k,_){return y===null||y.tag!==7?(y=za(v,x.mode,k,_),y.return=x,y):(y=s(y,v),y.return=x,y)}function h(x,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=rf(""+y,x.mode,v),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Xu:return v=Bc(y.type,y.key,y.props,null,x.mode,v),v.ref=Vl(x,null,y),v.return=x,v;case bi:return y=nf(y,x.mode,v),y.return=x,y;case Ts:var k=y._init;return h(x,k(y._payload),v)}if(ao(y)||Bl(y))return y=za(y,x.mode,v,null),y.return=x,y;uc(x,y)}return null}function f(x,y,v,k){var _=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:o(x,y,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Xu:return v.key===_?u(x,y,v,k):null;case bi:return v.key===_?c(x,y,v,k):null;case Ts:return _=v._init,f(x,y,_(v._payload),k)}if(ao(v)||Bl(v))return _!==null?null:d(x,y,v,k,null);uc(x,v)}return null}function g(x,y,v,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(v)||null,o(y,x,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Xu:return x=x.get(k.key===null?v:k.key)||null,u(y,x,k,_);case bi:return x=x.get(k.key===null?v:k.key)||null,c(y,x,k,_);case Ts:var S=k._init;return g(x,y,v,S(k._payload),_)}if(ao(k)||Bl(k))return x=x.get(v)||null,d(y,x,k,_,null);uc(y,k)}return null}function p(x,y,v,k){for(var _=null,S=null,I=y,j=y=0,D=null;I!==null&&j<v.length;j++){I.index>j?(D=I,I=null):D=I.sibling;var T=f(x,I,v[j],k);if(T===null){I===null&&(I=D);break}e&&I&&T.alternate===null&&t(x,I),y=i(T,y,j),S===null?_=T:S.sibling=T,S=T,I=D}if(j===v.length)return r(x,I),xt&&Na(x,j),_;if(I===null){for(;j<v.length;j++)I=h(x,v[j],k),I!==null&&(y=i(I,y,j),S===null?_=I:S.sibling=I,S=I);return xt&&Na(x,j),_}for(I=n(x,I);j<v.length;j++)D=g(I,x,j,v[j],k),D!==null&&(e&&D.alternate!==null&&I.delete(D.key===null?j:D.key),y=i(D,y,j),S===null?_=D:S.sibling=D,S=D);return e&&I.forEach(function(B){return t(x,B)}),xt&&Na(x,j),_}function b(x,y,v,k){var _=Bl(v);if(typeof _!="function")throw Error(le(150));if(v=_.call(v),v==null)throw Error(le(151));for(var S=_=null,I=y,j=y=0,D=null,T=v.next();I!==null&&!T.done;j++,T=v.next()){I.index>j?(D=I,I=null):D=I.sibling;var B=f(x,I,T.value,k);if(B===null){I===null&&(I=D);break}e&&I&&B.alternate===null&&t(x,I),y=i(B,y,j),S===null?_=B:S.sibling=B,S=B,I=D}if(T.done)return r(x,I),xt&&Na(x,j),_;if(I===null){for(;!T.done;j++,T=v.next())T=h(x,T.value,k),T!==null&&(y=i(T,y,j),S===null?_=T:S.sibling=T,S=T);return xt&&Na(x,j),_}for(I=n(x,I);!T.done;j++,T=v.next())T=g(I,x,j,T.value,k),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?j:T.key),y=i(T,y,j),S===null?_=T:S.sibling=T,S=T);return e&&I.forEach(function(O){return t(x,O)}),xt&&Na(x,j),_}function E(x,y,v,k){if(typeof v=="object"&&v!==null&&v.type===vi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Xu:e:{for(var _=v.key,S=y;S!==null;){if(S.key===_){if(_=v.type,_===vi){if(S.tag===7){r(x,S.sibling),y=s(S,v.props.children),y.return=x,x=y;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ts&&ix(_)===S.type){r(x,S.sibling),y=s(S,v.props),y.ref=Vl(x,S,v),y.return=x,x=y;break e}r(x,S);break}else t(x,S);S=S.sibling}v.type===vi?(y=za(v.props.children,x.mode,k,v.key),y.return=x,x=y):(k=Bc(v.type,v.key,v.props,null,x.mode,k),k.ref=Vl(x,y,v),k.return=x,x=k)}return l(x);case bi:e:{for(S=v.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){r(x,y.sibling),y=s(y,v.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=nf(v,x.mode,k),y.return=x,x=y}return l(x);case Ts:return S=v._init,E(x,y,S(v._payload),k)}if(ao(v))return p(x,y,v,k);if(Bl(v))return b(x,y,v,k);uc(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(r(x,y.sibling),y=s(y,v),y.return=x,x=y):(r(x,y),y=rf(v,x.mode,k),y.return=x,x=y),l(x)):r(x,y)}return E}var ul=Ov(!0),Pv=Ov(!1),id=ha(null),ld=null,Ci=null,r0=null;function n0(){r0=Ci=ld=null}function s0(e){var t=id.current;pt(id),e._currentValue=t}function vm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Mi(e,t){ld=e,r0=Ci=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(wr=!0),e.firstContext=null)}function Xr(e){var t=e._currentValue;if(r0!==e)if(e={context:e,memoizedValue:t,next:null},Ci===null){if(ld===null)throw Error(le(308));Ci=e,ld.dependencies={lanes:0,firstContext:e}}else Ci=Ci.next=e;return t}var Ia=null;function a0(e){Ia===null?Ia=[e]:Ia.push(e)}function Dv(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,a0(t)):(r.next=s.next,s.next=r),t.interleaved=r,us(e,n)}function us(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Cs=!1;function i0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function as(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Js(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,et&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,us(e,r)}return s=n.interleaved,s===null?(t.next=t,a0(n)):(t.next=s.next,s.next=t),n.interleaved=t,us(e,r)}function Oc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Vp(e,r)}}function lx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function od(e,t,r,n){var s=e.updateQueue;Cs=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;l=0,d=c=u=null,o=i;do{var f=o.lane,g=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,b=o;switch(f=t,g=r,b.tag){case 1:if(p=b.payload,typeof p=="function"){h=p.call(g,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=b.payload,f=typeof p=="function"?p.call(g,h,f):p,f==null)break e;h=wt({},h,f);break e;case 2:Cs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else g={eventTime:g,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,u=h):d=d.next=g,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Qa|=l,e.lanes=l,e.memoizedState=h}}function ox(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(le(191,s));s.call(n)}}}var Lu={},Pn=ha(Lu),Qo=ha(Lu),Ko=ha(Lu);function Ra(e){if(e===Lu)throw Error(le(174));return e}function l0(e,t){switch(ht(Ko,t),ht(Qo,e),ht(Pn,Lu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:em(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=em(t,e)}pt(Pn),ht(Pn,t)}function cl(){pt(Pn),pt(Qo),pt(Ko)}function Fv(e){Ra(Ko.current);var t=Ra(Pn.current),r=em(t,e.type);t!==r&&(ht(Qo,e),ht(Pn,r))}function o0(e){Qo.current===e&&(pt(Pn),pt(Qo))}var bt=ha(0);function ud(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kh=[];function u0(){for(var e=0;e<Kh.length;e++)Kh[e]._workInProgressVersionPrimary=null;Kh.length=0}var Pc=fs.ReactCurrentDispatcher,Zh=fs.ReactCurrentBatchConfig,Ya=0,vt=null,Ot=null,Bt=null,cd=!1,wo=!1,Zo=0,zS=0;function Yt(){throw Error(le(321))}function c0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vn(e[r],t[r]))return!1;return!0}function d0(e,t,r,n,s,i){if(Ya=i,vt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pc.current=e===null||e.memoizedState===null?GS:YS,e=r(n,s),wo){i=0;do{if(wo=!1,Zo=0,25<=i)throw Error(le(301));i+=1,Bt=Ot=null,t.updateQueue=null,Pc.current=QS,e=r(n,s)}while(wo)}if(Pc.current=dd,t=Ot!==null&&Ot.next!==null,Ya=0,Bt=Ot=vt=null,cd=!1,t)throw Error(le(300));return e}function h0(){var e=Zo!==0;return Zo=0,e}function Sn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?vt.memoizedState=Bt=e:Bt=Bt.next=e,Bt}function Jr(){if(Ot===null){var e=vt.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=Bt===null?vt.memoizedState:Bt.next;if(t!==null)Bt=t,Ot=e;else{if(e===null)throw Error(le(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Bt===null?vt.memoizedState=Bt=e:Bt=Bt.next=e}return Bt}function Xo(e,t){return typeof t=="function"?t(e):t}function Xh(e){var t=Jr(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=Ot,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var d=c.lane;if((Ya&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,l=n):u=u.next=h,vt.lanes|=d,Qa|=d}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,vn(n,t.memoizedState)||(wr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,vt.lanes|=i,Qa|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Jh(e){var t=Jr(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);vn(i,t.memoizedState)||(wr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Uv(){}function Bv(e,t){var r=vt,n=Jr(),s=t(),i=!vn(n.memoizedState,s);if(i&&(n.memoizedState=s,wr=!0),n=n.queue,f0(zv.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Bt!==null&&Bt.memoizedState.tag&1){if(r.flags|=2048,Jo(9,$v.bind(null,r,n,s,t),void 0,null),$t===null)throw Error(le(349));Ya&30||Hv(r,t,s)}return s}function Hv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function $v(e,t,r,n){t.value=r,t.getSnapshot=n,qv(t)&&Vv(e)}function zv(e,t,r){return r(function(){qv(t)&&Vv(e)})}function qv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vn(e,r)}catch{return!0}}function Vv(e){var t=us(e,1);t!==null&&gn(t,e,1,-1)}function ux(e){var t=Sn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e},t.queue=e,e=e.dispatch=WS.bind(null,vt,e),[t.memoizedState,e]}function Jo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Wv(){return Jr().memoizedState}function Dc(e,t,r,n){var s=Sn();vt.flags|=e,s.memoizedState=Jo(1|t,r,void 0,n===void 0?null:n)}function Gd(e,t,r,n){var s=Jr();n=n===void 0?null:n;var i=void 0;if(Ot!==null){var l=Ot.memoizedState;if(i=l.destroy,n!==null&&c0(n,l.deps)){s.memoizedState=Jo(t,r,i,n);return}}vt.flags|=e,s.memoizedState=Jo(1|t,r,i,n)}function cx(e,t){return Dc(8390656,8,e,t)}function f0(e,t){return Gd(2048,8,e,t)}function Gv(e,t){return Gd(4,2,e,t)}function Yv(e,t){return Gd(4,4,e,t)}function Qv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kv(e,t,r){return r=r!=null?r.concat([e]):null,Gd(4,4,Qv.bind(null,t,e),r)}function m0(){}function Zv(e,t){var r=Jr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&c0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Xv(e,t){var r=Jr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&c0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Jv(e,t,r){return Ya&21?(vn(r,t)||(r=sv(),vt.lanes|=r,Qa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wr=!0),e.memoizedState=r)}function qS(e,t){var r=lt;lt=r!==0&&4>r?r:4,e(!0);var n=Zh.transition;Zh.transition={};try{e(!1),t()}finally{lt=r,Zh.transition=n}}function ew(){return Jr().memoizedState}function VS(e,t,r){var n=ta(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},tw(e))rw(t,r);else if(r=Dv(e,t,r,n),r!==null){var s=or();gn(r,e,n,s),nw(r,t,n)}}function WS(e,t,r){var n=ta(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(tw(e))rw(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,vn(o,l)){var u=t.interleaved;u===null?(s.next=s,a0(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=Dv(e,t,s,n),r!==null&&(s=or(),gn(r,e,n,s),nw(r,t,n))}}function tw(e){var t=e.alternate;return e===vt||t!==null&&t===vt}function rw(e,t){wo=cd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function nw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Vp(e,r)}}var dd={readContext:Xr,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},GS={readContext:Xr,useCallback:function(e,t){return Sn().memoizedState=[e,t===void 0?null:t],e},useContext:Xr,useEffect:cx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Dc(4194308,4,Qv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dc(4,2,e,t)},useMemo:function(e,t){var r=Sn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Sn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=VS.bind(null,vt,e),[n.memoizedState,e]},useRef:function(e){var t=Sn();return e={current:e},t.memoizedState=e},useState:ux,useDebugValue:m0,useDeferredValue:function(e){return Sn().memoizedState=e},useTransition:function(){var e=ux(!1),t=e[0];return e=qS.bind(null,e[1]),Sn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=vt,s=Sn();if(xt){if(r===void 0)throw Error(le(407));r=r()}else{if(r=t(),$t===null)throw Error(le(349));Ya&30||Hv(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,cx(zv.bind(null,n,i,e),[e]),n.flags|=2048,Jo(9,$v.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Sn(),t=$t.identifierPrefix;if(xt){var r=ss,n=ns;r=(n&~(1<<32-pn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Zo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=zS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},YS={readContext:Xr,useCallback:Zv,useContext:Xr,useEffect:f0,useImperativeHandle:Kv,useInsertionEffect:Gv,useLayoutEffect:Yv,useMemo:Xv,useReducer:Xh,useRef:Wv,useState:function(){return Xh(Xo)},useDebugValue:m0,useDeferredValue:function(e){var t=Jr();return Jv(t,Ot.memoizedState,e)},useTransition:function(){var e=Xh(Xo)[0],t=Jr().memoizedState;return[e,t]},useMutableSource:Uv,useSyncExternalStore:Bv,useId:ew,unstable_isNewReconciler:!1},QS={readContext:Xr,useCallback:Zv,useContext:Xr,useEffect:f0,useImperativeHandle:Kv,useInsertionEffect:Gv,useLayoutEffect:Yv,useMemo:Xv,useReducer:Jh,useRef:Wv,useState:function(){return Jh(Xo)},useDebugValue:m0,useDeferredValue:function(e){var t=Jr();return Ot===null?t.memoizedState=e:Jv(t,Ot.memoizedState,e)},useTransition:function(){var e=Jh(Xo)[0],t=Jr().memoizedState;return[e,t]},useMutableSource:Uv,useSyncExternalStore:Bv,useId:ew,unstable_isNewReconciler:!1};function ln(e,t){if(e&&e.defaultProps){t=wt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function wm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:wt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Yd={isMounted:function(e){return(e=e._reactInternals)?ii(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=or(),s=ta(e),i=as(n,s);i.payload=t,r!=null&&(i.callback=r),t=Js(e,i,s),t!==null&&(gn(t,e,s,n),Oc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=or(),s=ta(e),i=as(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Js(e,i,s),t!==null&&(gn(t,e,s,n),Oc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=or(),n=ta(e),s=as(r,n);s.tag=2,t!=null&&(s.callback=t),t=Js(e,s,n),t!==null&&(gn(t,e,n,r),Oc(t,e,n))}};function dx(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!Vo(r,n)||!Vo(s,i):!0}function sw(e,t,r){var n=!1,s=aa,i=t.contextType;return typeof i=="object"&&i!==null?i=Xr(i):(s=_r(t)?Wa:Jt.current,n=t.contextTypes,i=(n=n!=null)?ll(e,s):aa),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Yd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function hx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Yd.enqueueReplaceState(t,t.state,null)}function Em(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},i0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Xr(i):(i=_r(t)?Wa:Jt.current,s.context=ll(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(wm(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Yd.enqueueReplaceState(s,s.state,null),od(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function dl(e,t){try{var r="",n=t;do r+=_k(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function ef(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function _m(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var KS=typeof WeakMap=="function"?WeakMap:Map;function aw(e,t,r){r=as(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){fd||(fd=!0,Lm=n),_m(e,t)},r}function iw(e,t,r){r=as(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){_m(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){_m(e,t),typeof n!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function fx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new KS;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=cT.bind(null,e,t,r),t.then(e,e))}function mx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function px(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=as(-1,1),t.tag=2,Js(r,t,1))),r.lanes|=1),e)}var ZS=fs.ReactCurrentOwner,wr=!1;function ir(e,t,r,n){t.child=e===null?Pv(t,null,r,n):ul(t,e.child,r,n)}function gx(e,t,r,n,s){r=r.render;var i=t.ref;return Mi(t,s),n=d0(e,t,r,n,i,s),r=h0(),e!==null&&!wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(xt&&r&&Jp(t),t.flags|=1,ir(e,t,n,s),t.child)}function xx(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!E0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,lw(e,t,i,n,s)):(e=Bc(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:Vo,r(l,n)&&e.ref===t.ref)return cs(e,t,s)}return t.flags|=1,e=ra(i,n),e.ref=t.ref,e.return=t,t.child=e}function lw(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Vo(i,n)&&e.ref===t.ref)if(wr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(wr=!0);else return t.lanes=e.lanes,cs(e,t,s)}return Nm(e,t,r,n,s)}function ow(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(Ai,Ir),Ir|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(Ai,Ir),Ir|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ht(Ai,Ir),Ir|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ht(Ai,Ir),Ir|=n;return ir(e,t,s,r),t.child}function uw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Nm(e,t,r,n,s){var i=_r(r)?Wa:Jt.current;return i=ll(t,i),Mi(t,s),r=d0(e,t,r,n,i,s),n=h0(),e!==null&&!wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(xt&&n&&Jp(t),t.flags|=1,ir(e,t,r,s),t.child)}function yx(e,t,r,n,s){if(_r(r)){var i=!0;nd(t)}else i=!1;if(Mi(t,s),t.stateNode===null)Mc(e,t),sw(t,r,n),Em(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=Xr(c):(c=_r(r)?Wa:Jt.current,c=ll(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&hx(t,l,n,c),Cs=!1;var f=t.memoizedState;l.state=f,od(t,n,l,s),u=t.memoizedState,o!==n||f!==u||Er.current||Cs?(typeof d=="function"&&(wm(t,r,d,n),u=t.memoizedState),(o=Cs||dx(t,r,o,n,f,u,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Mv(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ln(t.type,o),l.props=c,h=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=Xr(u):(u=_r(r)?Wa:Jt.current,u=ll(t,u));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==u)&&hx(t,l,n,u),Cs=!1,f=t.memoizedState,l.state=f,od(t,n,l,s);var p=t.memoizedState;o!==h||f!==p||Er.current||Cs?(typeof g=="function"&&(wm(t,r,g,n),p=t.memoizedState),(c=Cs||dx(t,r,c,n,f,p,u)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return km(e,t,r,n,i,s)}function km(e,t,r,n,s,i){uw(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&nx(t,r,!1),cs(e,t,i);n=t.stateNode,ZS.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=ul(t,e.child,null,i),t.child=ul(t,null,o,i)):ir(e,t,o,i),t.memoizedState=n.state,s&&nx(t,r,!0),t.child}function cw(e){var t=e.stateNode;t.pendingContext?rx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&rx(e,t.context,!1),l0(e,t.containerInfo)}function bx(e,t,r,n,s){return ol(),t0(s),t.flags|=256,ir(e,t,r,n),t.child}var Sm={dehydrated:null,treeContext:null,retryLane:0};function Tm(e){return{baseLanes:e,cachePool:null,transitions:null}}function dw(e,t,r){var n=t.pendingProps,s=bt.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ht(bt,s&1),e===null)return bm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Zd(l,n,0,null),e=za(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Tm(r),t.memoizedState=Sm,e):p0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return XS(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=ra(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=ra(o,i):(i=za(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?Tm(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Sm,n}return i=e.child,e=i.sibling,n=ra(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function p0(e,t){return t=Zd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cc(e,t,r,n){return n!==null&&t0(n),ul(t,e.child,null,r),e=p0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function XS(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=ef(Error(le(422))),cc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Zd({mode:"visible",children:n.children},s,0,null),i=za(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ul(t,e.child,null,l),t.child.memoizedState=Tm(l),t.memoizedState=Sm,i);if(!(t.mode&1))return cc(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(le(419)),n=ef(i,n,void 0),cc(e,t,l,n)}if(o=(l&e.childLanes)!==0,wr||o){if(n=$t,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,us(e,s),gn(n,e,s,-1))}return w0(),n=ef(Error(le(421))),cc(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=dT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Lr=Xs(s.nextSibling),Or=t,xt=!0,hn=null,e!==null&&(Vr[Wr++]=ns,Vr[Wr++]=ss,Vr[Wr++]=Ga,ns=e.id,ss=e.overflow,Ga=t),t=p0(t,n.children),t.flags|=4096,t)}function vx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),vm(e.return,t,r)}function tf(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function hw(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(ir(e,t,n.children,r),n=bt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vx(e,r,t);else if(e.tag===19)vx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ht(bt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&ud(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),tf(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ud(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}tf(t,!0,r,null,i);break;case"together":tf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,r=ra(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ra(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function JS(e,t,r){switch(t.tag){case 3:cw(t),ol();break;case 5:Fv(t);break;case 1:_r(t.type)&&nd(t);break;case 4:l0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ht(id,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ht(bt,bt.current&1),t.flags|=128,null):r&t.child.childLanes?dw(e,t,r):(ht(bt,bt.current&1),e=cs(e,t,r),e!==null?e.sibling:null);ht(bt,bt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return hw(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(bt,bt.current),n)break;return null;case 22:case 23:return t.lanes=0,ow(e,t,r)}return cs(e,t,r)}var fw,Cm,mw,pw;fw=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Cm=function(){};mw=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ra(Pn.current);var i=null;switch(r){case"input":s=Kf(e,s),n=Kf(e,n),i=[];break;case"select":s=wt({},s,{value:void 0}),n=wt({},n,{value:void 0}),i=[];break;case"textarea":s=Jf(e,s),n=Jf(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=td)}tm(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&mt("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};pw=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wl(e,t){if(!xt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function eT(e,t,r){var n=t.pendingProps;switch(e0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(t),null;case 1:return _r(t.type)&&rd(),Qt(t),null;case 3:return n=t.stateNode,cl(),pt(Er),pt(Jt),u0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(oc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,hn!==null&&(Dm(hn),hn=null))),Cm(e,t),Qt(t),null;case 5:o0(t);var s=Ra(Ko.current);if(r=t.type,e!==null&&t.stateNode!=null)mw(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(le(166));return Qt(t),null}if(e=Ra(Pn.current),oc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Ln]=t,n[Yo]=i,e=(t.mode&1)!==0,r){case"dialog":mt("cancel",n),mt("close",n);break;case"iframe":case"object":case"embed":mt("load",n);break;case"video":case"audio":for(s=0;s<lo.length;s++)mt(lo[s],n);break;case"source":mt("error",n);break;case"img":case"image":case"link":mt("error",n),mt("load",n);break;case"details":mt("toggle",n);break;case"input":jg(n,i),mt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},mt("invalid",n);break;case"textarea":Ig(n,i),mt("invalid",n)}tm(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&lc(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&lc(n.textContent,o,e),s=["children",""+o]):Fo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&mt("scroll",n)}switch(r){case"input":Ju(n),Ag(n,i,!0);break;case"textarea":Ju(n),Rg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=td)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=z1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Ln]=t,e[Yo]=n,fw(e,t,!1,!1),t.stateNode=e;e:{switch(l=rm(r,n),r){case"dialog":mt("cancel",e),mt("close",e),s=n;break;case"iframe":case"object":case"embed":mt("load",e),s=n;break;case"video":case"audio":for(s=0;s<lo.length;s++)mt(lo[s],e);s=n;break;case"source":mt("error",e),s=n;break;case"img":case"image":case"link":mt("error",e),mt("load",e),s=n;break;case"details":mt("toggle",e),s=n;break;case"input":jg(e,n),s=Kf(e,n),mt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=wt({},n,{value:void 0}),mt("invalid",e);break;case"textarea":Ig(e,n),s=Jf(e,n),mt("invalid",e);break;default:s=n}tm(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?W1(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&q1(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Uo(e,u):typeof u=="number"&&Uo(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&mt("scroll",e):u!=null&&Up(e,i,u,l))}switch(r){case"input":Ju(e),Ag(e,n,!1);break;case"textarea":Ju(e),Rg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+sa(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Li(e,!!n.multiple,i,!1):n.defaultValue!=null&&Li(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=td)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qt(t),null;case 6:if(e&&t.stateNode!=null)pw(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(le(166));if(r=Ra(Ko.current),Ra(Pn.current),oc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ln]=t,(i=n.nodeValue!==r)&&(e=Or,e!==null))switch(e.tag){case 3:lc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&lc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ln]=t,t.stateNode=n}return Qt(t),null;case 13:if(pt(bt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xt&&Lr!==null&&t.mode&1&&!(t.flags&128))Lv(),ol(),t.flags|=98560,i=!1;else if(i=oc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(le(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[Ln]=t}else ol(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qt(t),i=!1}else hn!==null&&(Dm(hn),hn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||bt.current&1?Dt===0&&(Dt=3):w0())),t.updateQueue!==null&&(t.flags|=4),Qt(t),null);case 4:return cl(),Cm(e,t),e===null&&Wo(t.stateNode.containerInfo),Qt(t),null;case 10:return s0(t.type._context),Qt(t),null;case 17:return _r(t.type)&&rd(),Qt(t),null;case 19:if(pt(bt),i=t.memoizedState,i===null)return Qt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Wl(i,!1);else{if(Dt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=ud(e),l!==null){for(t.flags|=128,Wl(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ht(bt,bt.current&1|2),t.child}e=e.sibling}i.tail!==null&&St()>hl&&(t.flags|=128,n=!0,Wl(i,!1),t.lanes=4194304)}else{if(!n)if(e=ud(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!xt)return Qt(t),null}else 2*St()-i.renderingStartTime>hl&&r!==1073741824&&(t.flags|=128,n=!0,Wl(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=St(),t.sibling=null,r=bt.current,ht(bt,n?r&1|2:r&1),t):(Qt(t),null);case 22:case 23:return v0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ir&1073741824&&(Qt(t),t.subtreeFlags&6&&(t.flags|=8192)):Qt(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function tT(e,t){switch(e0(t),t.tag){case 1:return _r(t.type)&&rd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cl(),pt(Er),pt(Jt),u0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return o0(t),null;case 13:if(pt(bt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));ol()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(bt),null;case 4:return cl(),null;case 10:return s0(t.type._context),null;case 22:case 23:return v0(),null;case 24:return null;default:return null}}var dc=!1,Zt=!1,rT=typeof WeakSet=="function"?WeakSet:Set,xe=null;function ji(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){_t(e,t,n)}else r.current=null}function jm(e,t,r){try{r()}catch(n){_t(e,t,n)}}var wx=!1;function nT(e,t){if(hm=Xc,e=vv(),Xp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var g;h!==r||s!==0&&h.nodeType!==3||(o=l+s),h!==i||n!==0&&h.nodeType!==3||(u=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++d===n&&(u=l),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(fm={focusedElem:e,selectionRange:r},Xc=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var b=p.memoizedProps,E=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?b:ln(t.type,b),E);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(k){_t(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return p=wx,wx=!1,p}function Eo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&jm(t,r,i)}s=s.next}while(s!==n)}}function Qd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Am(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function gw(e){var t=e.alternate;t!==null&&(e.alternate=null,gw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ln],delete t[Yo],delete t[gm],delete t[US],delete t[BS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xw(e){return e.tag===5||e.tag===3||e.tag===4}function Ex(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Im(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=td));else if(n!==4&&(e=e.child,e!==null))for(Im(e,t,r),e=e.sibling;e!==null;)Im(e,t,r),e=e.sibling}function Rm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Rm(e,t,r),e=e.sibling;e!==null;)Rm(e,t,r),e=e.sibling}var qt=null,cn=!1;function ys(e,t,r){for(r=r.child;r!==null;)yw(e,t,r),r=r.sibling}function yw(e,t,r){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount(Hd,r)}catch{}switch(r.tag){case 5:Zt||ji(r,t);case 6:var n=qt,s=cn;qt=null,ys(e,t,r),qt=n,cn=s,qt!==null&&(cn?(e=qt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):qt.removeChild(r.stateNode));break;case 18:qt!==null&&(cn?(e=qt,r=r.stateNode,e.nodeType===8?Yh(e.parentNode,r):e.nodeType===1&&Yh(e,r),zo(e)):Yh(qt,r.stateNode));break;case 4:n=qt,s=cn,qt=r.stateNode.containerInfo,cn=!0,ys(e,t,r),qt=n,cn=s;break;case 0:case 11:case 14:case 15:if(!Zt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&jm(r,t,l),s=s.next}while(s!==n)}ys(e,t,r);break;case 1:if(!Zt&&(ji(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){_t(r,t,o)}ys(e,t,r);break;case 21:ys(e,t,r);break;case 22:r.mode&1?(Zt=(n=Zt)||r.memoizedState!==null,ys(e,t,r),Zt=n):ys(e,t,r);break;default:ys(e,t,r)}}function _x(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new rT),t.forEach(function(n){var s=hT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function an(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:qt=o.stateNode,cn=!1;break e;case 3:qt=o.stateNode.containerInfo,cn=!0;break e;case 4:qt=o.stateNode.containerInfo,cn=!0;break e}o=o.return}if(qt===null)throw Error(le(160));yw(i,l,s),qt=null,cn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){_t(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bw(t,e),t=t.sibling}function bw(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(an(t,e),Nn(e),n&4){try{Eo(3,e,e.return),Qd(3,e)}catch(b){_t(e,e.return,b)}try{Eo(5,e,e.return)}catch(b){_t(e,e.return,b)}}break;case 1:an(t,e),Nn(e),n&512&&r!==null&&ji(r,r.return);break;case 5:if(an(t,e),Nn(e),n&512&&r!==null&&ji(r,r.return),e.flags&32){var s=e.stateNode;try{Uo(s,"")}catch(b){_t(e,e.return,b)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&H1(s,i),rm(o,l);var c=rm(o,i);for(l=0;l<u.length;l+=2){var d=u[l],h=u[l+1];d==="style"?W1(s,h):d==="dangerouslySetInnerHTML"?q1(s,h):d==="children"?Uo(s,h):Up(s,d,h,c)}switch(o){case"input":Zf(s,i);break;case"textarea":$1(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Li(s,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Li(s,!!i.multiple,i.defaultValue,!0):Li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Yo]=i}catch(b){_t(e,e.return,b)}}break;case 6:if(an(t,e),Nn(e),n&4){if(e.stateNode===null)throw Error(le(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){_t(e,e.return,b)}}break;case 3:if(an(t,e),Nn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zo(t.containerInfo)}catch(b){_t(e,e.return,b)}break;case 4:an(t,e),Nn(e);break;case 13:an(t,e),Nn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(y0=St())),n&4&&_x(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Zt=(c=Zt)||d,an(t,e),Zt=c):an(t,e),Nn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(xe=e,d=e.child;d!==null;){for(h=xe=d;xe!==null;){switch(f=xe,g=f.child,f.tag){case 0:case 11:case 14:case 15:Eo(4,f,f.return);break;case 1:ji(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(b){_t(n,r,b)}}break;case 5:ji(f,f.return);break;case 22:if(f.memoizedState!==null){kx(h);continue}}g!==null?(g.return=f,xe=g):kx(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,u=h.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=V1("display",l))}catch(b){_t(e,e.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){_t(e,e.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:an(t,e),Nn(e),n&4&&_x(e);break;case 21:break;default:an(t,e),Nn(e)}}function Nn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(xw(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Uo(s,""),n.flags&=-33);var i=Ex(e);Rm(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Ex(e);Im(e,o,l);break;default:throw Error(le(161))}}catch(u){_t(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sT(e,t,r){xe=e,vw(e)}function vw(e,t,r){for(var n=(e.mode&1)!==0;xe!==null;){var s=xe,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||dc;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||Zt;o=dc;var c=Zt;if(dc=l,(Zt=u)&&!c)for(xe=s;xe!==null;)l=xe,u=l.child,l.tag===22&&l.memoizedState!==null?Sx(s):u!==null?(u.return=l,xe=u):Sx(s);for(;i!==null;)xe=i,vw(i),i=i.sibling;xe=s,dc=o,Zt=c}Nx(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,xe=i):Nx(e)}}function Nx(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Zt||Qd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Zt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ln(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&ox(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ox(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&zo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Zt||t.flags&512&&Am(t)}catch(f){_t(t,t.return,f)}}if(t===e){xe=null;break}if(r=t.sibling,r!==null){r.return=t.return,xe=r;break}xe=t.return}}function kx(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,xe=r;break}xe=t.return}}function Sx(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Qd(4,t)}catch(u){_t(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){_t(t,s,u)}}var i=t.return;try{Am(t)}catch(u){_t(t,i,u)}break;case 5:var l=t.return;try{Am(t)}catch(u){_t(t,l,u)}}}catch(u){_t(t,t.return,u)}if(t===e){xe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,xe=o;break}xe=t.return}}var aT=Math.ceil,hd=fs.ReactCurrentDispatcher,g0=fs.ReactCurrentOwner,Zr=fs.ReactCurrentBatchConfig,et=0,$t=null,It=null,Vt=0,Ir=0,Ai=ha(0),Dt=0,eu=null,Qa=0,Kd=0,x0=0,_o=null,br=null,y0=0,hl=1/0,Kn=null,fd=!1,Lm=null,ea=null,hc=!1,Ws=null,md=0,No=0,Om=null,Fc=-1,Uc=0;function or(){return et&6?St():Fc!==-1?Fc:Fc=St()}function ta(e){return e.mode&1?et&2&&Vt!==0?Vt&-Vt:$S.transition!==null?(Uc===0&&(Uc=sv()),Uc):(e=lt,e!==0||(e=window.event,e=e===void 0?16:dv(e.type)),e):1}function gn(e,t,r,n){if(50<No)throw No=0,Om=null,Error(le(185));Au(e,r,n),(!(et&2)||e!==$t)&&(e===$t&&(!(et&2)&&(Kd|=r),Dt===4&&Rs(e,Vt)),Nr(e,n),r===1&&et===0&&!(t.mode&1)&&(hl=St()+500,Wd&&fa()))}function Nr(e,t){var r=e.callbackNode;$k(e,t);var n=Zc(e,e===$t?Vt:0);if(n===0)r!==null&&Pg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Pg(r),t===1)e.tag===0?HS(Tx.bind(null,e)):Av(Tx.bind(null,e)),MS(function(){!(et&6)&&fa()}),r=null;else{switch(av(n)){case 1:r=qp;break;case 4:r=rv;break;case 16:r=Kc;break;case 536870912:r=nv;break;default:r=Kc}r=Cw(r,ww.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ww(e,t){if(Fc=-1,Uc=0,et&6)throw Error(le(327));var r=e.callbackNode;if(Fi()&&e.callbackNode!==r)return null;var n=Zc(e,e===$t?Vt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=pd(e,n);else{t=n;var s=et;et|=2;var i=_w();($t!==e||Vt!==t)&&(Kn=null,hl=St()+500,$a(e,t));do try{oT();break}catch(o){Ew(e,o)}while(!0);n0(),hd.current=i,et=s,It!==null?t=0:($t=null,Vt=0,t=Dt)}if(t!==0){if(t===2&&(s=lm(e),s!==0&&(n=s,t=Pm(e,s))),t===1)throw r=eu,$a(e,0),Rs(e,n),Nr(e,St()),r;if(t===6)Rs(e,n);else{if(s=e.current.alternate,!(n&30)&&!iT(s)&&(t=pd(e,n),t===2&&(i=lm(e),i!==0&&(n=i,t=Pm(e,i))),t===1))throw r=eu,$a(e,0),Rs(e,n),Nr(e,St()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(le(345));case 2:ka(e,br,Kn);break;case 3:if(Rs(e,n),(n&130023424)===n&&(t=y0+500-St(),10<t)){if(Zc(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){or(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=pm(ka.bind(null,e,br,Kn),t);break}ka(e,br,Kn);break;case 4:if(Rs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-pn(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=St()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aT(n/1960))-n,10<n){e.timeoutHandle=pm(ka.bind(null,e,br,Kn),n);break}ka(e,br,Kn);break;case 5:ka(e,br,Kn);break;default:throw Error(le(329))}}}return Nr(e,St()),e.callbackNode===r?ww.bind(null,e):null}function Pm(e,t){var r=_o;return e.current.memoizedState.isDehydrated&&($a(e,t).flags|=256),e=pd(e,t),e!==2&&(t=br,br=r,t!==null&&Dm(t)),e}function Dm(e){br===null?br=e:br.push.apply(br,e)}function iT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!vn(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rs(e,t){for(t&=~x0,t&=~Kd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-pn(t),n=1<<r;e[r]=-1,t&=~n}}function Tx(e){if(et&6)throw Error(le(327));Fi();var t=Zc(e,0);if(!(t&1))return Nr(e,St()),null;var r=pd(e,t);if(e.tag!==0&&r===2){var n=lm(e);n!==0&&(t=n,r=Pm(e,n))}if(r===1)throw r=eu,$a(e,0),Rs(e,t),Nr(e,St()),r;if(r===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ka(e,br,Kn),Nr(e,St()),null}function b0(e,t){var r=et;et|=1;try{return e(t)}finally{et=r,et===0&&(hl=St()+500,Wd&&fa())}}function Ka(e){Ws!==null&&Ws.tag===0&&!(et&6)&&Fi();var t=et;et|=1;var r=Zr.transition,n=lt;try{if(Zr.transition=null,lt=1,e)return e()}finally{lt=n,Zr.transition=r,et=t,!(et&6)&&fa()}}function v0(){Ir=Ai.current,pt(Ai)}function $a(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,DS(r)),It!==null)for(r=It.return;r!==null;){var n=r;switch(e0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&rd();break;case 3:cl(),pt(Er),pt(Jt),u0();break;case 5:o0(n);break;case 4:cl();break;case 13:pt(bt);break;case 19:pt(bt);break;case 10:s0(n.type._context);break;case 22:case 23:v0()}r=r.return}if($t=e,It=e=ra(e.current,null),Vt=Ir=t,Dt=0,eu=null,x0=Kd=Qa=0,br=_o=null,Ia!==null){for(t=0;t<Ia.length;t++)if(r=Ia[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}Ia=null}return e}function Ew(e,t){do{var r=It;try{if(n0(),Pc.current=dd,cd){for(var n=vt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}cd=!1}if(Ya=0,Bt=Ot=vt=null,wo=!1,Zo=0,g0.current=null,r===null||r.return===null){Dt=1,eu=t,It=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=Vt,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=mx(l);if(g!==null){g.flags&=-257,px(g,l,o,i,t),g.mode&1&&fx(i,c,t),t=g,u=c;var p=t.updateQueue;if(p===null){var b=new Set;b.add(u),t.updateQueue=b}else p.add(u);break e}else{if(!(t&1)){fx(i,c,t),w0();break e}u=Error(le(426))}}else if(xt&&o.mode&1){var E=mx(l);if(E!==null){!(E.flags&65536)&&(E.flags|=256),px(E,l,o,i,t),t0(dl(u,o));break e}}i=u=dl(u,o),Dt!==4&&(Dt=2),_o===null?_o=[i]:_o.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=aw(i,u,t);lx(i,x);break e;case 1:o=u;var y=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ea===null||!ea.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var k=iw(i,o,t);lx(i,k);break e}}i=i.return}while(i!==null)}kw(r)}catch(_){t=_,It===r&&r!==null&&(It=r=r.return);continue}break}while(!0)}function _w(){var e=hd.current;return hd.current=dd,e===null?dd:e}function w0(){(Dt===0||Dt===3||Dt===2)&&(Dt=4),$t===null||!(Qa&268435455)&&!(Kd&268435455)||Rs($t,Vt)}function pd(e,t){var r=et;et|=2;var n=_w();($t!==e||Vt!==t)&&(Kn=null,$a(e,t));do try{lT();break}catch(s){Ew(e,s)}while(!0);if(n0(),et=r,hd.current=n,It!==null)throw Error(le(261));return $t=null,Vt=0,Dt}function lT(){for(;It!==null;)Nw(It)}function oT(){for(;It!==null&&!Lk();)Nw(It)}function Nw(e){var t=Tw(e.alternate,e,Ir);e.memoizedProps=e.pendingProps,t===null?kw(e):It=t,g0.current=null}function kw(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=tT(r,t),r!==null){r.flags&=32767,It=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Dt=6,It=null;return}}else if(r=eT(r,t,Ir),r!==null){It=r;return}if(t=t.sibling,t!==null){It=t;return}It=t=e}while(t!==null);Dt===0&&(Dt=5)}function ka(e,t,r){var n=lt,s=Zr.transition;try{Zr.transition=null,lt=1,uT(e,t,r,n)}finally{Zr.transition=s,lt=n}return null}function uT(e,t,r,n){do Fi();while(Ws!==null);if(et&6)throw Error(le(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(zk(e,i),e===$t&&(It=$t=null,Vt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hc||(hc=!0,Cw(Kc,function(){return Fi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Zr.transition,Zr.transition=null;var l=lt;lt=1;var o=et;et|=4,g0.current=null,nT(e,r),bw(r,e),jS(fm),Xc=!!hm,fm=hm=null,e.current=r,sT(r),Ok(),et=o,lt=l,Zr.transition=i}else e.current=r;if(hc&&(hc=!1,Ws=e,md=s),i=e.pendingLanes,i===0&&(ea=null),Mk(r.stateNode),Nr(e,St()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(fd)throw fd=!1,e=Lm,Lm=null,e;return md&1&&e.tag!==0&&Fi(),i=e.pendingLanes,i&1?e===Om?No++:(No=0,Om=e):No=0,fa(),null}function Fi(){if(Ws!==null){var e=av(md),t=Zr.transition,r=lt;try{if(Zr.transition=null,lt=16>e?16:e,Ws===null)var n=!1;else{if(e=Ws,Ws=null,md=0,et&6)throw Error(le(331));var s=et;for(et|=4,xe=e.current;xe!==null;){var i=xe,l=i.child;if(xe.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(xe=c;xe!==null;){var d=xe;switch(d.tag){case 0:case 11:case 15:Eo(8,d,i)}var h=d.child;if(h!==null)h.return=d,xe=h;else for(;xe!==null;){d=xe;var f=d.sibling,g=d.return;if(gw(d),d===c){xe=null;break}if(f!==null){f.return=g,xe=f;break}xe=g}}}var p=i.alternate;if(p!==null){var b=p.child;if(b!==null){p.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}xe=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,xe=l;else e:for(;xe!==null;){if(i=xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Eo(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,xe=x;break e}xe=i.return}}var y=e.current;for(xe=y;xe!==null;){l=xe;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,xe=v;else e:for(l=y;xe!==null;){if(o=xe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Qd(9,o)}}catch(_){_t(o,o.return,_)}if(o===l){xe=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,xe=k;break e}xe=o.return}}if(et=s,fa(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot(Hd,e)}catch{}n=!0}return n}finally{lt=r,Zr.transition=t}}return!1}function Cx(e,t,r){t=dl(r,t),t=aw(e,t,1),e=Js(e,t,1),t=or(),e!==null&&(Au(e,1,t),Nr(e,t))}function _t(e,t,r){if(e.tag===3)Cx(e,e,r);else for(;t!==null;){if(t.tag===3){Cx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ea===null||!ea.has(n))){e=dl(r,e),e=iw(t,e,1),t=Js(t,e,1),e=or(),t!==null&&(Au(t,1,e),Nr(t,e));break}}t=t.return}}function cT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=or(),e.pingedLanes|=e.suspendedLanes&r,$t===e&&(Vt&r)===r&&(Dt===4||Dt===3&&(Vt&130023424)===Vt&&500>St()-y0?$a(e,0):x0|=r),Nr(e,t)}function Sw(e,t){t===0&&(e.mode&1?(t=rc,rc<<=1,!(rc&130023424)&&(rc=4194304)):t=1);var r=or();e=us(e,t),e!==null&&(Au(e,t,r),Nr(e,r))}function dT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Sw(e,r)}function hT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(t),Sw(e,r)}var Tw;Tw=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Er.current)wr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return wr=!1,JS(e,t,r);wr=!!(e.flags&131072)}else wr=!1,xt&&t.flags&1048576&&Iv(t,ad,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mc(e,t),e=t.pendingProps;var s=ll(t,Jt.current);Mi(t,r),s=d0(null,t,n,e,s,r);var i=h0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_r(n)?(i=!0,nd(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,i0(t),s.updater=Yd,t.stateNode=s,s._reactInternals=t,Em(t,n,e,r),t=km(null,t,n,!0,i,r)):(t.tag=0,xt&&i&&Jp(t),ir(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mc(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=mT(n),e=ln(n,e),s){case 0:t=Nm(null,t,n,e,r);break e;case 1:t=yx(null,t,n,e,r);break e;case 11:t=gx(null,t,n,e,r);break e;case 14:t=xx(null,t,n,ln(n.type,e),r);break e}throw Error(le(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Nm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),yx(e,t,n,s,r);case 3:e:{if(cw(t),e===null)throw Error(le(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Mv(e,t),od(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=dl(Error(le(423)),t),t=bx(e,t,n,r,s);break e}else if(n!==s){s=dl(Error(le(424)),t),t=bx(e,t,n,r,s);break e}else for(Lr=Xs(t.stateNode.containerInfo.firstChild),Or=t,xt=!0,hn=null,r=Pv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ol(),n===s){t=cs(e,t,r);break e}ir(e,t,n,r)}t=t.child}return t;case 5:return Fv(t),e===null&&bm(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,mm(n,s)?l=null:i!==null&&mm(n,i)&&(t.flags|=32),uw(e,t),ir(e,t,l,r),t.child;case 6:return e===null&&bm(t),null;case 13:return dw(e,t,r);case 4:return l0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ul(t,null,n,r):ir(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),gx(e,t,n,s,r);case 7:return ir(e,t,t.pendingProps,r),t.child;case 8:return ir(e,t,t.pendingProps.children,r),t.child;case 12:return ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,ht(id,n._currentValue),n._currentValue=l,i!==null)if(vn(i.value,l)){if(i.children===s.children&&!Er.current){t=cs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=as(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),vm(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(le(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),vm(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}ir(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Mi(t,r),s=Xr(s),n=n(s),t.flags|=1,ir(e,t,n,r),t.child;case 14:return n=t.type,s=ln(n,t.pendingProps),s=ln(n.type,s),xx(e,t,n,s,r);case 15:return lw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Mc(e,t),t.tag=1,_r(n)?(e=!0,nd(t)):e=!1,Mi(t,r),sw(t,n,s),Em(t,n,s,r),km(null,t,n,!0,e,r);case 19:return hw(e,t,r);case 22:return ow(e,t,r)}throw Error(le(156,t.tag))};function Cw(e,t){return tv(e,t)}function fT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,t,r,n){return new fT(e,t,r,n)}function E0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mT(e){if(typeof e=="function")return E0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hp)return 11;if(e===$p)return 14}return 2}function ra(e,t){var r=e.alternate;return r===null?(r=Qr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bc(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")E0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case vi:return za(r.children,s,i,t);case Bp:l=8,s|=8;break;case Wf:return e=Qr(12,r,t,s|2),e.elementType=Wf,e.lanes=i,e;case Gf:return e=Qr(13,r,t,s),e.elementType=Gf,e.lanes=i,e;case Yf:return e=Qr(19,r,t,s),e.elementType=Yf,e.lanes=i,e;case F1:return Zd(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D1:l=10;break e;case M1:l=9;break e;case Hp:l=11;break e;case $p:l=14;break e;case Ts:l=16,n=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=Qr(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function za(e,t,r,n){return e=Qr(7,e,n,t),e.lanes=r,e}function Zd(e,t,r,n){return e=Qr(22,e,n,t),e.elementType=F1,e.lanes=r,e.stateNode={isHidden:!1},e}function rf(e,t,r){return e=Qr(6,e,null,t),e.lanes=r,e}function nf(e,t,r){return t=Qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function pT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mh(0),this.expirationTimes=Mh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mh(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _0(e,t,r,n,s,i,l,o,u){return e=new pT(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Qr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},i0(i),e}function gT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function jw(e){if(!e)return aa;e=e._reactInternals;e:{if(ii(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_r(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var r=e.type;if(_r(r))return jv(e,r,t)}return t}function Aw(e,t,r,n,s,i,l,o,u){return e=_0(r,n,!0,e,s,i,l,o,u),e.context=jw(null),r=e.current,n=or(),s=ta(r),i=as(n,s),i.callback=t??null,Js(r,i,s),e.current.lanes=s,Au(e,s,n),Nr(e,n),e}function Xd(e,t,r,n){var s=t.current,i=or(),l=ta(s);return r=jw(r),t.context===null?t.context=r:t.pendingContext=r,t=as(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Js(s,t,l),e!==null&&(gn(e,s,l,i),Oc(e,s,l)),l}function gd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function jx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function N0(e,t){jx(e,t),(e=e.alternate)&&jx(e,t)}function xT(){return null}var Iw=typeof reportError=="function"?reportError:function(e){console.error(e)};function k0(e){this._internalRoot=e}Jd.prototype.render=k0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));Xd(e,t,null,null)};Jd.prototype.unmount=k0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ka(function(){Xd(null,e,null,null)}),t[os]=null}};function Jd(e){this._internalRoot=e}Jd.prototype.unstable_scheduleHydration=function(e){if(e){var t=ov();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Is.length&&t!==0&&t<Is[r].priority;r++);Is.splice(r,0,e),r===0&&cv(e)}};function S0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ax(){}function yT(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=gd(l);i.call(c)}}var l=Aw(t,n,e,0,null,!1,!1,"",Ax);return e._reactRootContainer=l,e[os]=l.current,Wo(e.nodeType===8?e.parentNode:e),Ka(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=gd(u);o.call(c)}}var u=_0(e,0,!1,null,null,!1,!1,"",Ax);return e._reactRootContainer=u,e[os]=u.current,Wo(e.nodeType===8?e.parentNode:e),Ka(function(){Xd(t,u,r,n)}),u}function th(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=gd(l);o.call(u)}}Xd(t,l,e,s)}else l=yT(r,t,e,s,n);return gd(l)}iv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=io(t.pendingLanes);r!==0&&(Vp(t,r|1),Nr(t,St()),!(et&6)&&(hl=St()+500,fa()))}break;case 13:Ka(function(){var n=us(e,1);if(n!==null){var s=or();gn(n,e,1,s)}}),N0(e,1)}};Wp=function(e){if(e.tag===13){var t=us(e,134217728);if(t!==null){var r=or();gn(t,e,134217728,r)}N0(e,134217728)}};lv=function(e){if(e.tag===13){var t=ta(e),r=us(e,t);if(r!==null){var n=or();gn(r,e,t,n)}N0(e,t)}};ov=function(){return lt};uv=function(e,t){var r=lt;try{return lt=e,t()}finally{lt=r}};sm=function(e,t,r){switch(t){case"input":if(Zf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Vd(n);if(!s)throw Error(le(90));B1(n),Zf(n,s)}}}break;case"textarea":$1(e,r);break;case"select":t=r.value,t!=null&&Li(e,!!r.multiple,t,!1)}};Q1=b0;K1=Ka;var bT={usingClientEntryPoint:!1,Events:[Ru,Ni,Vd,G1,Y1,b0]},Gl={findFiberByHostInstance:Aa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vT={bundleType:Gl.bundleType,version:Gl.version,rendererPackageName:Gl.rendererPackageName,rendererConfig:Gl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=J1(e),e===null?null:e.stateNode},findFiberByHostInstance:Gl.findFiberByHostInstance||xT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fc.isDisabled&&fc.supportsFiber)try{Hd=fc.inject(vT),On=fc}catch{}}Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bT;Ur.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S0(t))throw Error(le(200));return gT(e,t,null,r)};Ur.createRoot=function(e,t){if(!S0(e))throw Error(le(299));var r=!1,n="",s=Iw;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=_0(e,1,!1,null,null,r,!1,n,s),e[os]=t.current,Wo(e.nodeType===8?e.parentNode:e),new k0(t)};Ur.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=J1(t),e=e===null?null:e.stateNode,e};Ur.flushSync=function(e){return Ka(e)};Ur.hydrate=function(e,t,r){if(!eh(t))throw Error(le(200));return th(null,e,t,!0,r)};Ur.hydrateRoot=function(e,t,r){if(!S0(e))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=Iw;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Aw(t,null,e,1,r??null,s,!1,i,l),e[os]=t.current,Wo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Jd(t)};Ur.render=function(e,t,r){if(!eh(t))throw Error(le(200));return th(null,e,t,!1,r)};Ur.unmountComponentAtNode=function(e){if(!eh(e))throw Error(le(40));return e._reactRootContainer?(Ka(function(){th(null,null,e,!1,function(){e._reactRootContainer=null,e[os]=null})}),!0):!1};Ur.unstable_batchedUpdates=b0;Ur.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!eh(r))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return th(e,t,r,!1,n)};Ur.version="18.3.1-next-f1338f8080-20240426";function Rw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rw)}catch(e){console.error(e)}}Rw(),R1.exports=Ur;var wT=R1.exports,Lw,Ix=wT;Lw=Ix.createRoot,Ix.hydrateRoot;var Sl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Za=typeof window>"u"||"Deno"in globalThis;function qr(){}function ET(e,t){return typeof e=="function"?e(t):e}function Mm(e){return typeof e=="number"&&e>=0&&e!==1/0}function Ow(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ui(e,t){return typeof e=="function"?e(t):e}function fn(e,t){return typeof e=="function"?e(t):e}function Rx(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==T0(l,t.options))return!1}else if(!tu(t.queryKey,l))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||i&&!i(t))}function Lx(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Xa(t.options.mutationKey)!==Xa(i))return!1}else if(!tu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function T0(e,t){return((t==null?void 0:t.queryKeyHashFn)||Xa)(e)}function Xa(e){return JSON.stringify(e,(t,r)=>Fm(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function tu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>tu(e[r],t[r])):!1}function Pw(e,t){if(e===t)return e;const r=Ox(e)&&Ox(t);if(r||Fm(e)&&Fm(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{};let u=0;for(let c=0;c<l;c++){const d=r?c:i[c];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=Pw(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return s===l&&u===s?e:o}return t}function xd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Ox(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Fm(e){if(!Px(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Px(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Px(e){return Object.prototype.toString.call(e)==="[object Object]"}function _T(e){return new Promise(t=>{setTimeout(t,e)})}function Um(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Pw(e,t):t}function NT(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function kT(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var C0=Symbol();function Dw(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===C0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Oa,Ps,Gi,d1,ST=(d1=class extends Sl{constructor(){super();Ne(this,Oa);Ne(this,Ps);Ne(this,Gi);pe(this,Gi,t=>{if(!Za&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){F(this,Ps)||this.setEventListener(F(this,Gi))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Ps))==null||t.call(this),pe(this,Ps,void 0))}setEventListener(t){var r;pe(this,Gi,t),(r=F(this,Ps))==null||r.call(this),pe(this,Ps,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){F(this,Oa)!==t&&(pe(this,Oa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof F(this,Oa)=="boolean"?F(this,Oa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Oa=new WeakMap,Ps=new WeakMap,Gi=new WeakMap,d1),j0=new ST,Yi,Ds,Qi,h1,TT=(h1=class extends Sl{constructor(){super();Ne(this,Yi,!0);Ne(this,Ds);Ne(this,Qi);pe(this,Qi,t=>{if(!Za&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){F(this,Ds)||this.setEventListener(F(this,Qi))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Ds))==null||t.call(this),pe(this,Ds,void 0))}setEventListener(t){var r;pe(this,Qi,t),(r=F(this,Ds))==null||r.call(this),pe(this,Ds,t(this.setOnline.bind(this)))}setOnline(t){F(this,Yi)!==t&&(pe(this,Yi,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return F(this,Yi)}},Yi=new WeakMap,Ds=new WeakMap,Qi=new WeakMap,h1),yd=new TT;function Bm(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function CT(e){return Math.min(1e3*2**e,3e4)}function Mw(e){return(e??"online")==="online"?yd.isOnline():!0}var Fw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function sf(e){return e instanceof Fw}function Uw(e){let t=!1,r=0,n=!1,s;const i=Bm(),l=b=>{var E;n||(f(new Fw(b)),(E=e.abort)==null||E.call(e))},o=()=>{t=!0},u=()=>{t=!1},c=()=>j0.isFocused()&&(e.networkMode==="always"||yd.isOnline())&&e.canRun(),d=()=>Mw(e.networkMode)&&e.canRun(),h=b=>{var E;n||(n=!0,(E=e.onSuccess)==null||E.call(e,b),s==null||s(),i.resolve(b))},f=b=>{var E;n||(n=!0,(E=e.onError)==null||E.call(e,b),s==null||s(),i.reject(b))},g=()=>new Promise(b=>{var E;s=x=>{(n||c())&&b(x)},(E=e.onPause)==null||E.call(e)}).then(()=>{var b;s=void 0,n||(b=e.onContinue)==null||b.call(e)}),p=()=>{if(n)return;let b;const E=r===0?e.initialPromise:void 0;try{b=E??e.fn()}catch(x){b=Promise.reject(x)}Promise.resolve(b).then(h).catch(x=>{var S;if(n)return;const y=e.retry??(Za?0:3),v=e.retryDelay??CT,k=typeof v=="function"?v(r,x):v,_=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,x);if(t||!_){f(x);return}r++,(S=e.onFail)==null||S.call(e,r,x),_T(k).then(()=>c()?void 0:g()).then(()=>{t?f(x):p()})})};return{promise:i,cancel:l,continue:()=>(s==null||s(),i),cancelRetry:o,continueRetry:u,canStart:d,start:()=>(d()?p():g().then(p),i)}}var jT=e=>setTimeout(e,0);function AT(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=jT;const i=o=>{t?e.push(o):s(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||l()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var Pt=AT(),Pa,f1,Bw=(f1=class{constructor(){Ne(this,Pa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Mm(this.gcTime)&&pe(this,Pa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Za?1/0:5*60*1e3))}clearGcTimeout(){F(this,Pa)&&(clearTimeout(F(this,Pa)),pe(this,Pa,void 0))}},Pa=new WeakMap,f1),Ki,Zi,zr,Da,Kt,ku,Ma,on,Yn,m1,IT=(m1=class extends Bw{constructor(t){super();Ne(this,on);Ne(this,Ki);Ne(this,Zi);Ne(this,zr);Ne(this,Da);Ne(this,Kt);Ne(this,ku);Ne(this,Ma);pe(this,Ma,!1),pe(this,ku,t.defaultOptions),this.setOptions(t.options),this.observers=[],pe(this,Da,t.client),pe(this,zr,F(this,Da).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,pe(this,Ki,RT(this.options)),this.state=t.state??F(this,Ki),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=F(this,Kt))==null?void 0:t.promise}setOptions(t){this.options={...F(this,ku),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&F(this,zr).remove(this)}setData(t,r){const n=Um(this.state.data,t,this.options);return ze(this,on,Yn).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ze(this,on,Yn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=F(this,Kt))==null?void 0:n.promise;return(s=F(this,Kt))==null||s.cancel(t),r?r.then(qr).catch(qr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(F(this,Ki))}isActive(){return this.observers.some(t=>fn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===C0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Ow(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,Kt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,Kt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),F(this,zr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(F(this,Kt)&&(F(this,Ma)?F(this,Kt).cancel({revert:!0}):F(this,Kt).cancelRetry()),this.scheduleGc()),F(this,zr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ze(this,on,Yn).call(this,{type:"invalidate"})}fetch(t,r){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(F(this,Kt))return F(this,Kt).continueRetry(),F(this,Kt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(pe(this,Ma,!0),n.signal)})},i=()=>{const h=Dw(this.options,r),f={client:F(this,Da),queryKey:this.queryKey,meta:this.meta};return s(f),pe(this,Ma,!1),this.options.persister?this.options.persister(h,f,this):h(f)},l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:F(this,Da),state:this.state,fetchFn:i};s(l),(u=this.options.behavior)==null||u.onFetch(l,this),pe(this,Zi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=l.fetchOptions)==null?void 0:c.meta))&&ze(this,on,Yn).call(this,{type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta});const o=h=>{var f,g,p,b;sf(h)&&h.silent||ze(this,on,Yn).call(this,{type:"error",error:h}),sf(h)||((g=(f=F(this,zr).config).onError)==null||g.call(f,h,this),(b=(p=F(this,zr).config).onSettled)==null||b.call(p,this.state.data,h,this)),this.scheduleGc()};return pe(this,Kt,Uw({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,g,p,b;if(h===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(E){o(E);return}(g=(f=F(this,zr).config).onSuccess)==null||g.call(f,h,this),(b=(p=F(this,zr).config).onSettled)==null||b.call(p,h,this.state.error,this),this.scheduleGc()},onError:o,onFail:(h,f)=>{ze(this,on,Yn).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{ze(this,on,Yn).call(this,{type:"pause"})},onContinue:()=>{ze(this,on,Yn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),F(this,Kt).start()}},Ki=new WeakMap,Zi=new WeakMap,zr=new WeakMap,Da=new WeakMap,Kt=new WeakMap,ku=new WeakMap,Ma=new WeakMap,on=new WeakSet,Yn=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Hw(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return sf(s)&&s.revert&&F(this,Zi)?{...F(this,Zi),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Pt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),F(this,zr).notify({query:this,type:"updated",action:t})})},m1);function Hw(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Mw(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function RT(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var jn,p1,LT=(p1=class extends Sl{constructor(t={}){super();Ne(this,jn);this.config=t,pe(this,jn,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??T0(s,r);let l=this.get(i);return l||(l=new IT({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){F(this,jn).has(t.queryHash)||(F(this,jn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=F(this,jn).get(t.queryHash);r&&(t.destroy(),r===t&&F(this,jn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Pt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return F(this,jn).get(t)}getAll(){return[...F(this,jn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Rx(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>Rx(t,n)):r}notify(t){Pt.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Pt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Pt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},jn=new WeakMap,p1),An,sr,Fa,In,Es,g1,OT=(g1=class extends Bw{constructor(t){super();Ne(this,In);Ne(this,An);Ne(this,sr);Ne(this,Fa);this.mutationId=t.mutationId,pe(this,sr,t.mutationCache),pe(this,An,[]),this.state=t.state||$w(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){F(this,An).includes(t)||(F(this,An).push(t),this.clearGcTimeout(),F(this,sr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){pe(this,An,F(this,An).filter(r=>r!==t)),this.scheduleGc(),F(this,sr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){F(this,An).length||(this.state.status==="pending"?this.scheduleGc():F(this,sr).remove(this))}continue(){var t;return((t=F(this,Fa))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,u,c,d,h,f,g,p,b,E,x,y,v,k,_,S,I,j;const r=()=>{ze(this,In,Es).call(this,{type:"continue"})};pe(this,Fa,Uw({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(D,T)=>{ze(this,In,Es).call(this,{type:"failed",failureCount:D,error:T})},onPause:()=>{ze(this,In,Es).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>F(this,sr).canRun(this)}));const n=this.state.status==="pending",s=!F(this,Fa).canStart();try{if(n)r();else{ze(this,In,Es).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(i=F(this,sr).config).onMutate)==null?void 0:l.call(i,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&ze(this,In,Es).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const D=await F(this,Fa).start();return await((d=(c=F(this,sr).config).onSuccess)==null?void 0:d.call(c,D,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,D,t,this.state.context)),await((p=(g=F(this,sr).config).onSettled)==null?void 0:p.call(g,D,null,this.state.variables,this.state.context,this)),await((E=(b=this.options).onSettled)==null?void 0:E.call(b,D,null,t,this.state.context)),ze(this,In,Es).call(this,{type:"success",data:D}),D}catch(D){try{throw await((y=(x=F(this,sr).config).onError)==null?void 0:y.call(x,D,t,this.state.context,this)),await((k=(v=this.options).onError)==null?void 0:k.call(v,D,t,this.state.context)),await((S=(_=F(this,sr).config).onSettled)==null?void 0:S.call(_,void 0,D,this.state.variables,this.state.context,this)),await((j=(I=this.options).onSettled)==null?void 0:j.call(I,void 0,D,t,this.state.context)),D}finally{ze(this,In,Es).call(this,{type:"error",error:D})}}finally{F(this,sr).runNext(this)}}},An=new WeakMap,sr=new WeakMap,Fa=new WeakMap,In=new WeakSet,Es=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Pt.batch(()=>{F(this,An).forEach(n=>{n.onMutationUpdate(t)}),F(this,sr).notify({mutation:this,type:"updated",action:t})})},g1);function $w(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var es,un,Su,x1,PT=(x1=class extends Sl{constructor(t={}){super();Ne(this,es);Ne(this,un);Ne(this,Su);this.config=t,pe(this,es,new Set),pe(this,un,new Map),pe(this,Su,0)}build(t,r,n){const s=new OT({mutationCache:this,mutationId:++Ku(this,Su)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){F(this,es).add(t);const r=mc(t);if(typeof r=="string"){const n=F(this,un).get(r);n?n.push(t):F(this,un).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(F(this,es).delete(t)){const r=mc(t);if(typeof r=="string"){const n=F(this,un).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&F(this,un).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=mc(t);if(typeof r=="string"){const n=F(this,un).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=mc(t);if(typeof r=="string"){const s=(n=F(this,un).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Pt.batch(()=>{F(this,es).forEach(t=>{this.notify({type:"removed",mutation:t})}),F(this,es).clear(),F(this,un).clear()})}getAll(){return Array.from(F(this,es))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Lx(r,n))}findAll(t={}){return this.getAll().filter(r=>Lx(t,r))}notify(t){Pt.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Pt.batch(()=>Promise.all(t.map(r=>r.continue().catch(qr))))}},es=new WeakMap,un=new WeakMap,Su=new WeakMap,x1);function mc(e){var t;return(t=e.options.scope)==null?void 0:t.id}function Dx(e){return{onFetch:(t,r)=>{var d,h,f,g,p;const n=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((g=t.state.data)==null?void 0:g.pages)||[],l=((p=t.state.data)==null?void 0:p.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let b=!1;const E=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?b=!0:t.signal.addEventListener("abort",()=>{b=!0}),t.signal)})},x=Dw(t.options,t.fetchOptions),y=async(v,k,_)=>{if(b)return Promise.reject();if(k==null&&v.pages.length)return Promise.resolve(v);const S={client:t.client,queryKey:t.queryKey,pageParam:k,direction:_?"backward":"forward",meta:t.options.meta};E(S);const I=await x(S),{maxPages:j}=t.options,D=_?kT:NT;return{pages:D(v.pages,I,j),pageParams:D(v.pageParams,k,j)}};if(s&&i.length){const v=s==="backward",k=v?DT:Mx,_={pages:i,pageParams:l},S=k(n,_);o=await y(_,S,v)}else{const v=e??i.length;do{const k=u===0?l[0]??n.initialPageParam:Mx(n,o);if(u>0&&k==null)break;o=await y(o,k),u++}while(u<v)}return o};t.options.persister?t.fetchFn=()=>{var b,E;return(E=(b=t.options).persister)==null?void 0:E.call(b,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function Mx(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function DT(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Et,Ms,Fs,Xi,Ji,Us,el,tl,y1,MT=(y1=class{constructor(e={}){Ne(this,Et);Ne(this,Ms);Ne(this,Fs);Ne(this,Xi);Ne(this,Ji);Ne(this,Us);Ne(this,el);Ne(this,tl);pe(this,Et,e.queryCache||new LT),pe(this,Ms,e.mutationCache||new PT),pe(this,Fs,e.defaultOptions||{}),pe(this,Xi,new Map),pe(this,Ji,new Map),pe(this,Us,0)}mount(){Ku(this,Us)._++,F(this,Us)===1&&(pe(this,el,j0.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,Et).onFocus())})),pe(this,tl,yd.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,Et).onOnline())})))}unmount(){var e,t;Ku(this,Us)._--,F(this,Us)===0&&((e=F(this,el))==null||e.call(this),pe(this,el,void 0),(t=F(this,tl))==null||t.call(this),pe(this,tl,void 0))}isFetching(e){return F(this,Et).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return F(this,Ms).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,Et).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=F(this,Et).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Ui(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return F(this,Et).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=F(this,Et).get(n.queryHash),i=s==null?void 0:s.state.data,l=ET(t,i);if(l!==void 0)return F(this,Et).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return Pt.batch(()=>F(this,Et).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,Et).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=F(this,Et);Pt.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=F(this,Et);return Pt.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Pt.batch(()=>F(this,Et).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(qr).catch(qr)}invalidateQueries(e,t={}){return Pt.batch(()=>(F(this,Et).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Pt.batch(()=>F(this,Et).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(qr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(qr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=F(this,Et).build(this,t);return r.isStaleByTime(Ui(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(qr).catch(qr)}fetchInfiniteQuery(e){return e.behavior=Dx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(qr).catch(qr)}ensureInfiniteQueryData(e){return e.behavior=Dx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return yd.isOnline()?F(this,Ms).resumePausedMutations():Promise.resolve()}getQueryCache(){return F(this,Et)}getMutationCache(){return F(this,Ms)}getDefaultOptions(){return F(this,Fs)}setDefaultOptions(e){pe(this,Fs,e)}setQueryDefaults(e,t){F(this,Xi).set(Xa(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...F(this,Xi).values()],r={};return t.forEach(n=>{tu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){F(this,Ji).set(Xa(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...F(this,Ji).values()],r={};return t.forEach(n=>{tu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...F(this,Fs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=T0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===C0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...F(this,Fs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){F(this,Et).clear(),F(this,Ms).clear()}},Et=new WeakMap,Ms=new WeakMap,Fs=new WeakMap,Xi=new WeakMap,Ji=new WeakMap,Us=new WeakMap,el=new WeakMap,tl=new WeakMap,y1),xr,Ze,Tu,ar,Ua,rl,Bs,Hs,Cu,nl,sl,Ba,Ha,$s,al,it,oo,Hm,$m,zm,qm,Vm,Wm,Gm,zw,b1,FT=(b1=class extends Sl{constructor(t,r){super();Ne(this,it);Ne(this,xr);Ne(this,Ze);Ne(this,Tu);Ne(this,ar);Ne(this,Ua);Ne(this,rl);Ne(this,Bs);Ne(this,Hs);Ne(this,Cu);Ne(this,nl);Ne(this,sl);Ne(this,Ba);Ne(this,Ha);Ne(this,$s);Ne(this,al,new Set);this.options=r,pe(this,xr,t),pe(this,Hs,null),pe(this,Bs,Bm()),this.options.experimental_prefetchInRender||F(this,Bs).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(F(this,Ze).addObserver(this),Fx(F(this,Ze),this.options)?ze(this,it,oo).call(this):this.updateResult(),ze(this,it,qm).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ym(F(this,Ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ym(F(this,Ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ze(this,it,Vm).call(this),ze(this,it,Wm).call(this),F(this,Ze).removeObserver(this)}setOptions(t){const r=this.options,n=F(this,Ze);if(this.options=F(this,xr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof fn(this.options.enabled,F(this,Ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ze(this,it,Gm).call(this),F(this,Ze).setOptions(this.options),r._defaulted&&!xd(this.options,r)&&F(this,xr).getQueryCache().notify({type:"observerOptionsUpdated",query:F(this,Ze),observer:this});const s=this.hasListeners();s&&Ux(F(this,Ze),n,this.options,r)&&ze(this,it,oo).call(this),this.updateResult(),s&&(F(this,Ze)!==n||fn(this.options.enabled,F(this,Ze))!==fn(r.enabled,F(this,Ze))||Ui(this.options.staleTime,F(this,Ze))!==Ui(r.staleTime,F(this,Ze)))&&ze(this,it,Hm).call(this);const i=ze(this,it,$m).call(this);s&&(F(this,Ze)!==n||fn(this.options.enabled,F(this,Ze))!==fn(r.enabled,F(this,Ze))||i!==F(this,$s))&&ze(this,it,zm).call(this,i)}getOptimisticResult(t){const r=F(this,xr).getQueryCache().build(F(this,xr),t),n=this.createResult(r,t);return BT(this,n)&&(pe(this,ar,n),pe(this,rl,this.options),pe(this,Ua,F(this,Ze).state)),n}getCurrentResult(){return F(this,ar)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){F(this,al).add(t)}getCurrentQuery(){return F(this,Ze)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=F(this,xr).defaultQueryOptions(t),n=F(this,xr).getQueryCache().build(F(this,xr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return ze(this,it,oo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),F(this,ar)))}createResult(t,r){var D;const n=F(this,Ze),s=this.options,i=F(this,ar),l=F(this,Ua),o=F(this,rl),c=t!==n?t.state:F(this,Tu),{state:d}=t;let h={...d},f=!1,g;if(r._optimisticResults){const T=this.hasListeners(),B=!T&&Fx(t,r),O=T&&Ux(t,n,r,s);(B||O)&&(h={...h,...Hw(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:b,status:E}=h;g=h.data;let x=!1;if(r.placeholderData!==void 0&&g===void 0&&E==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,x=!0):T=typeof r.placeholderData=="function"?r.placeholderData((D=F(this,sl))==null?void 0:D.state.data,F(this,sl)):r.placeholderData,T!==void 0&&(E="success",g=Um(i==null?void 0:i.data,T,r),f=!0)}if(r.select&&g!==void 0&&!x)if(i&&g===(l==null?void 0:l.data)&&r.select===F(this,Cu))g=F(this,nl);else try{pe(this,Cu,r.select),g=r.select(g),g=Um(i==null?void 0:i.data,g,r),pe(this,nl,g),pe(this,Hs,null)}catch(T){pe(this,Hs,T)}F(this,Hs)&&(p=F(this,Hs),g=F(this,nl),b=Date.now(),E="error");const y=h.fetchStatus==="fetching",v=E==="pending",k=E==="error",_=v&&y,S=g!==void 0,j={status:E,fetchStatus:h.fetchStatus,isPending:v,isSuccess:E==="success",isError:k,isInitialLoading:_,isLoading:_,data:g,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:b,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:y,isRefetching:y&&!v,isLoadingError:k&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&S,isStale:A0(t,r),refetch:this.refetch,promise:F(this,Bs)};if(this.options.experimental_prefetchInRender){const T=Y=>{j.status==="error"?Y.reject(j.error):j.data!==void 0&&Y.resolve(j.data)},B=()=>{const Y=pe(this,Bs,j.promise=Bm());T(Y)},O=F(this,Bs);switch(O.status){case"pending":t.queryHash===n.queryHash&&T(O);break;case"fulfilled":(j.status==="error"||j.data!==O.value)&&B();break;case"rejected":(j.status!=="error"||j.error!==O.reason)&&B();break}}return j}updateResult(){const t=F(this,ar),r=this.createResult(F(this,Ze),this.options);if(pe(this,Ua,F(this,Ze).state),pe(this,rl,this.options),F(this,Ua).data!==void 0&&pe(this,sl,F(this,Ze)),xd(r,t))return;pe(this,ar,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!F(this,al).size)return!0;const l=new Set(i??F(this,al));return this.options.throwOnError&&l.add("error"),Object.keys(F(this,ar)).some(o=>{const u=o;return F(this,ar)[u]!==t[u]&&l.has(u)})};ze(this,it,zw).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ze(this,it,qm).call(this)}},xr=new WeakMap,Ze=new WeakMap,Tu=new WeakMap,ar=new WeakMap,Ua=new WeakMap,rl=new WeakMap,Bs=new WeakMap,Hs=new WeakMap,Cu=new WeakMap,nl=new WeakMap,sl=new WeakMap,Ba=new WeakMap,Ha=new WeakMap,$s=new WeakMap,al=new WeakMap,it=new WeakSet,oo=function(t){ze(this,it,Gm).call(this);let r=F(this,Ze).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(qr)),r},Hm=function(){ze(this,it,Vm).call(this);const t=Ui(this.options.staleTime,F(this,Ze));if(Za||F(this,ar).isStale||!Mm(t))return;const n=Ow(F(this,ar).dataUpdatedAt,t)+1;pe(this,Ba,setTimeout(()=>{F(this,ar).isStale||this.updateResult()},n))},$m=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(F(this,Ze)):this.options.refetchInterval)??!1},zm=function(t){ze(this,it,Wm).call(this),pe(this,$s,t),!(Za||fn(this.options.enabled,F(this,Ze))===!1||!Mm(F(this,$s))||F(this,$s)===0)&&pe(this,Ha,setInterval(()=>{(this.options.refetchIntervalInBackground||j0.isFocused())&&ze(this,it,oo).call(this)},F(this,$s)))},qm=function(){ze(this,it,Hm).call(this),ze(this,it,zm).call(this,ze(this,it,$m).call(this))},Vm=function(){F(this,Ba)&&(clearTimeout(F(this,Ba)),pe(this,Ba,void 0))},Wm=function(){F(this,Ha)&&(clearInterval(F(this,Ha)),pe(this,Ha,void 0))},Gm=function(){const t=F(this,xr).getQueryCache().build(F(this,xr),this.options);if(t===F(this,Ze))return;const r=F(this,Ze);pe(this,Ze,t),pe(this,Tu,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},zw=function(t){Pt.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(F(this,ar))}),F(this,xr).getQueryCache().notify({query:F(this,Ze),type:"observerResultsUpdated"})})},b1);function UT(e,t){return fn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Fx(e,t){return UT(e,t)||e.state.data!==void 0&&Ym(e,t,t.refetchOnMount)}function Ym(e,t,r){if(fn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&A0(e,t)}return!1}function Ux(e,t,r,n){return(e!==t||fn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&A0(e,r)}function A0(e,t){return fn(t.enabled,e)!==!1&&e.isStaleByTime(Ui(t.staleTime,e))}function BT(e,t){return!xd(e.getCurrentResult(),t)}var zs,qs,yr,ts,is,Hc,Qm,v1,HT=(v1=class extends Sl{constructor(r,n){super();Ne(this,is);Ne(this,zs);Ne(this,qs);Ne(this,yr);Ne(this,ts);pe(this,zs,r),this.setOptions(n),this.bindMethods(),ze(this,is,Hc).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=F(this,zs).defaultMutationOptions(r),xd(this.options,n)||F(this,zs).getMutationCache().notify({type:"observerOptionsUpdated",mutation:F(this,yr),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Xa(n.mutationKey)!==Xa(this.options.mutationKey)?this.reset():((s=F(this,yr))==null?void 0:s.state.status)==="pending"&&F(this,yr).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=F(this,yr))==null||r.removeObserver(this)}onMutationUpdate(r){ze(this,is,Hc).call(this),ze(this,is,Qm).call(this,r)}getCurrentResult(){return F(this,qs)}reset(){var r;(r=F(this,yr))==null||r.removeObserver(this),pe(this,yr,void 0),ze(this,is,Hc).call(this),ze(this,is,Qm).call(this)}mutate(r,n){var s;return pe(this,ts,n),(s=F(this,yr))==null||s.removeObserver(this),pe(this,yr,F(this,zs).getMutationCache().build(F(this,zs),this.options)),F(this,yr).addObserver(this),F(this,yr).execute(r)}},zs=new WeakMap,qs=new WeakMap,yr=new WeakMap,ts=new WeakMap,is=new WeakSet,Hc=function(){var n;const r=((n=F(this,yr))==null?void 0:n.state)??$w();pe(this,qs,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Qm=function(r){Pt.batch(()=>{var n,s,i,l,o,u,c,d;if(F(this,ts)&&this.hasListeners()){const h=F(this,qs).variables,f=F(this,qs).context;(r==null?void 0:r.type)==="success"?((s=(n=F(this,ts)).onSuccess)==null||s.call(n,r.data,h,f),(l=(i=F(this,ts)).onSettled)==null||l.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((u=(o=F(this,ts)).onError)==null||u.call(o,r.error,h,f),(d=(c=F(this,ts)).onSettled)==null||d.call(c,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(F(this,qs))})})},v1),qw=w.createContext(void 0),tn=e=>{const t=w.useContext(qw);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Vw=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(qw.Provider,{value:e,children:t})),Ww=w.createContext(!1),$T=()=>w.useContext(Ww);Ww.Provider;function zT(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qT=w.createContext(zT()),VT=()=>w.useContext(qT);function Gw(e,t){return typeof e=="function"?e(...t):!!e}function Km(){}var WT=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},GT=e=>{w.useEffect(()=>{e.clearReset()},[e])},YT=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||Gw(r,[e.error,n])),QT=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},KT=(e,t)=>e.isLoading&&e.isFetching&&!t,ZT=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Bx=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function XT(e,t,r){var h,f,g,p,b;const n=tn(),s=$T(),i=VT(),l=n.defaultQueryOptions(e);(f=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",QT(l),WT(l,i),GT(i);const o=!n.getQueryCache().get(l.queryHash),[u]=w.useState(()=>new t(n,l)),c=u.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(E=>{const x=d?u.subscribe(Pt.batchCalls(E)):Km;return u.updateResult(),x},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(l)},[l,u]),ZT(l,c))throw Bx(l,u,i);if(YT({result:c,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((p=(g=n.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||p.call(g,l,c),l.experimental_prefetchInRender&&!Za&&KT(c,s)){const E=o?Bx(l,u,i):(b=n.getQueryCache().get(l.queryHash))==null?void 0:b.promise;E==null||E.catch(Km).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function Rt(e,t){return XT(e,FT)}function kt(e,t){const r=tn(),[n]=w.useState(()=>new HT(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const s=w.useSyncExternalStore(w.useCallback(l=>n.subscribe(Pt.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((l,o)=>{n.mutate(l,o).catch(Km)},[n]);if(s.error&&Gw(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ru(){return ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ru.apply(this,arguments)}var Gs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Gs||(Gs={}));const Hx="popstate";function JT(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return Zm("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:bd(s)}return tC(t,r,null,e)}function Ct(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Yw(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function eC(){return Math.random().toString(36).substr(2,8)}function $x(e,t){return{usr:e.state,key:e.key,idx:t}}function Zm(e,t,r,n){return r===void 0&&(r=null),ru({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Tl(t):t,{state:r,key:t&&t.key||n||eC()})}function bd(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Tl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function tC(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=Gs.Pop,u=null,c=d();c==null&&(c=0,l.replaceState(ru({},l.state,{idx:c}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=Gs.Pop;let E=d(),x=E==null?null:E-c;c=E,u&&u({action:o,location:b.location,delta:x})}function f(E,x){o=Gs.Push;let y=Zm(b.location,E,x);c=d()+1;let v=$x(y,c),k=b.createHref(y);try{l.pushState(v,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(k)}i&&u&&u({action:o,location:b.location,delta:1})}function g(E,x){o=Gs.Replace;let y=Zm(b.location,E,x);c=d();let v=$x(y,c),k=b.createHref(y);l.replaceState(v,"",k),i&&u&&u({action:o,location:b.location,delta:0})}function p(E){let x=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof E=="string"?E:bd(E);return y=y.replace(/ $/,"%20"),Ct(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let b={get action(){return o},get location(){return e(s,l)},listen(E){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Hx,h),u=E,()=>{s.removeEventListener(Hx,h),u=null}},createHref(E){return t(s,E)},createURL:p,encodeLocation(E){let x=p(E);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:g,go(E){return l.go(E)}};return b}var zx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(zx||(zx={}));function rC(e,t,r){return r===void 0&&(r="/"),nC(e,t,r)}function nC(e,t,r,n){let s=typeof t=="string"?Tl(t):t,i=I0(s.pathname||"/",r);if(i==null)return null;let l=Qw(e);sC(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=gC(i);o=fC(l[u],c)}return o}function Qw(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(Ct(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=na([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(Ct(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Qw(i.children,t,d,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:dC(c,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of Kw(i.path))s(i,l,u)}),t}function Kw(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=Kw(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function sC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:hC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const aC=/^:[\w-]+$/,iC=3,lC=2,oC=1,uC=10,cC=-2,qx=e=>e==="*";function dC(e,t){let r=e.split("/"),n=r.length;return r.some(qx)&&(n+=cC),t&&(n+=lC),r.filter(s=>!qx(s)).reduce((s,i)=>s+(aC.test(i)?iC:i===""?oC:uC),n)}function hC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function fC(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=mC({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),l.push({params:s,pathname:na([i,h.pathname]),pathnameBase:vC(na([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=na([i,h.pathnameBase]))}return l}function mC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=pC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:g}=d;if(f==="*"){let b=o[h]||"";l=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const p=o[h];return g&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function pC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Yw(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function gC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yw(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function I0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function xC(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Tl(e):e;return{pathname:r?r.startsWith("/")?r:yC(r,t):t,search:wC(n),hash:EC(s)}}function yC(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function af(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bC(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function R0(e,t){let r=bC(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function L0(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Tl(e):(s=ru({},e),Ct(!s.pathname||!s.pathname.includes("?"),af("?","pathname","search",s)),Ct(!s.pathname||!s.pathname.includes("#"),af("#","pathname","hash",s)),Ct(!s.search||!s.search.includes("#"),af("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let u=xC(s,o),c=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const na=e=>e.join("/").replace(/\/\/+/g,"/"),vC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),wC=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,EC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _C(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Zw=["post","put","patch","delete"];new Set(Zw);const NC=["get",...Zw];new Set(NC);/**
 * React Router v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nu(){return nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nu.apply(this,arguments)}const O0=w.createContext(null),kC=w.createContext(null),ma=w.createContext(null),rh=w.createContext(null),ms=w.createContext({outlet:null,matches:[],isDataRoute:!1}),Xw=w.createContext(null);function SC(e,t){let{relative:r}=t===void 0?{}:t;Cl()||Ct(!1);let{basename:n,navigator:s}=w.useContext(ma),{hash:i,pathname:l,search:o}=e2(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:na([n,l])),s.createHref({pathname:u,search:o,hash:i})}function Cl(){return w.useContext(rh)!=null}function pa(){return Cl()||Ct(!1),w.useContext(rh).location}function Jw(e){w.useContext(ma).static||w.useLayoutEffect(e)}function rn(){let{isDataRoute:e}=w.useContext(ms);return e?UC():TC()}function TC(){Cl()||Ct(!1);let e=w.useContext(O0),{basename:t,future:r,navigator:n}=w.useContext(ma),{matches:s}=w.useContext(ms),{pathname:i}=pa(),l=JSON.stringify(R0(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return Jw(()=>{o.current=!0}),w.useCallback(function(c,d){if(d===void 0&&(d={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=L0(c,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:na([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,l,i,e])}function P0(){let{matches:e}=w.useContext(ms),t=e[e.length-1];return t?t.params:{}}function e2(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(ma),{matches:s}=w.useContext(ms),{pathname:i}=pa(),l=JSON.stringify(R0(s,n.v7_relativeSplatPath));return w.useMemo(()=>L0(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function CC(e,t){return jC(e,t)}function jC(e,t,r,n){Cl()||Ct(!1);let{navigator:s}=w.useContext(ma),{matches:i}=w.useContext(ms),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=pa(),d;if(t){var h;let E=typeof t=="string"?Tl(t):t;u==="/"||(h=E.pathname)!=null&&h.startsWith(u)||Ct(!1),d=E}else d=c;let f=d.pathname||"/",g=f;if(u!=="/"){let E=u.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let p=rC(e,{pathname:g}),b=OC(p&&p.map(E=>Object.assign({},E,{params:Object.assign({},o,E.params),pathname:na([u,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?u:na([u,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,r,n);return t&&b?w.createElement(rh.Provider,{value:{location:nu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Gs.Pop}},b):b}function AC(){let e=FC(),t=_C(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const IC=w.createElement(AC,null);class RC extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(ms.Provider,{value:this.props.routeContext},w.createElement(Xw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LC(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(O0);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(ms.Provider,{value:t},n)}function OC(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Ct(!1),l=l.slice(0,Math.min(l.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:g}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||p){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let g,p=!1,b=null,E=null;r&&(g=o&&h.route.id?o[h.route.id]:void 0,b=h.route.errorElement||IC,u&&(c<0&&f===0?(BC("route-fallback"),p=!0,E=null):c===f&&(p=!0,E=h.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),y=()=>{let v;return g?v=b:p?v=E:h.route.Component?v=w.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=d,w.createElement(LC,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(RC,{location:r.location,revalidation:r.revalidation,component:b,error:g,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var t2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(t2||{}),r2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(r2||{});function PC(e){let t=w.useContext(O0);return t||Ct(!1),t}function DC(e){let t=w.useContext(kC);return t||Ct(!1),t}function MC(e){let t=w.useContext(ms);return t||Ct(!1),t}function n2(e){let t=MC(),r=t.matches[t.matches.length-1];return r.route.id||Ct(!1),r.route.id}function FC(){var e;let t=w.useContext(Xw),r=DC(),n=n2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function UC(){let{router:e}=PC(t2.UseNavigateStable),t=n2(r2.UseNavigateStable),r=w.useRef(!1);return Jw(()=>{r.current=!0}),w.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,nu({fromRouteId:t},i)))},[e,t])}const Vx={};function BC(e,t,r){Vx[e]||(Vx[e]=!0)}const Wx={};function HC(e,t){Wx[t]||(Wx[t]=!0,console.warn(t))}const Gx=(e,t,r)=>HC(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function $C(e,t){(e==null?void 0:e.v7_startTransition)===void 0&&Gx("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&Gx("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function ko(e){let{to:t,replace:r,state:n,relative:s}=e;Cl()||Ct(!1);let{future:i,static:l}=w.useContext(ma),{matches:o}=w.useContext(ms),{pathname:u}=pa(),c=rn(),d=L0(t,R0(o,i.v7_relativeSplatPath),u,s==="path"),h=JSON.stringify(d);return w.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function $r(e){Ct(!1)}function zC(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Gs.Pop,navigator:i,static:l=!1,future:o}=e;Cl()&&Ct(!1);let u=t.replace(/^\/*/,"/"),c=w.useMemo(()=>({basename:u,navigator:i,static:l,future:nu({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Tl(n));let{pathname:d="/",search:h="",hash:f="",state:g=null,key:p="default"}=n,b=w.useMemo(()=>{let E=I0(d,u);return E==null?null:{location:{pathname:E,search:h,hash:f,state:g,key:p},navigationType:s}},[u,d,h,f,g,p,s]);return b==null?null:w.createElement(ma.Provider,{value:c},w.createElement(rh.Provider,{children:r,value:b}))}function Yx(e){let{children:t,location:r}=e;return CC(Xm(t),r)}new Promise(()=>{});function Xm(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let i=[...t,s];if(n.type===w.Fragment){r.push.apply(r,Xm(n.props.children,i));return}n.type!==$r&&Ct(!1),!n.props.index||!n.props.children||Ct(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Xm(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jm(){return Jm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jm.apply(this,arguments)}function qC(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function VC(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function WC(e,t){return e.button===0&&(!t||t==="_self")&&!VC(e)}const GC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],YC="6";try{window.__reactRouterVersion=YC}catch{}const QC="startTransition",Qx=ck[QC];function KC(e){let{basename:t,children:r,future:n,window:s}=e,i=w.useRef();i.current==null&&(i.current=JT({window:s,v5Compat:!0}));let l=i.current,[o,u]=w.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},d=w.useCallback(h=>{c&&Qx?Qx(()=>u(h)):u(h)},[u,c]);return w.useLayoutEffect(()=>l.listen(d),[l,d]),w.useEffect(()=>$C(n),[n]),w.createElement(zC,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const ZC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",XC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ep=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:d,viewTransition:h}=t,f=qC(t,GC),{basename:g}=w.useContext(ma),p,b=!1;if(typeof c=="string"&&XC.test(c)&&(p=c,ZC))try{let v=new URL(window.location.href),k=c.startsWith("//")?new URL(v.protocol+c):new URL(c),_=I0(k.pathname,g);k.origin===v.origin&&_!=null?c=_+k.search+k.hash:b=!0}catch{}let E=SC(c,{relative:s}),x=JC(c,{replace:l,state:o,target:u,preventScrollReset:d,relative:s,viewTransition:h});function y(v){n&&n(v),v.defaultPrevented||x(v)}return w.createElement("a",Jm({},f,{href:p||E,onClick:b||i?n:y,ref:r,target:u}))});var Kx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Kx||(Kx={}));var Zx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Zx||(Zx={}));function JC(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=rn(),c=pa(),d=e2(e,{relative:l});return w.useCallback(h=>{if(WC(h,r)){h.preventDefault();let f=n!==void 0?n:bd(c)===bd(d);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,d,n,s,r,e,i,l,o])}const ej="modulepreload",tj=function(e){return"/"+e},Xx={},fl=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=tj(u),u in Xx)return;Xx[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":ej,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},rj=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fl(async()=>{const{default:n}=await Promise.resolve().then(()=>jl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class D0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class nj extends D0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class sj extends D0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class aj extends D0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var tp;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(tp||(tp={}));var ij=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class lj{constructor(t,{headers:r={},customFetch:n,region:s=tp.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=rj(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return ij(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:l}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let c;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=l):typeof l=="string"?(o["Content-Type"]="text/plain",c=l):typeof FormData<"u"&&l instanceof FormData?c=l:(o["Content-Type"]="application/json",c=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(p=>{throw new nj(p)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new sj(d);if(!d.ok)throw new aj(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield d.json():f==="application/octet-stream"?g=yield d.blob():f==="text/event-stream"?g=d:f==="multipart/form-data"?g=yield d.formData():g=yield d.text(),{data:g,error:null}}catch(s){return{data:null,error:s}}})}}var vr={},M0={},nh={},Ou={},sh={},ah={},oj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ml=oj();const uj=ml.fetch,s2=ml.fetch.bind(ml),a2=ml.Headers,cj=ml.Request,dj=ml.Response,jl=Object.freeze(Object.defineProperty({__proto__:null,Headers:a2,Request:cj,Response:dj,default:s2,fetch:uj},Symbol.toStringTag,{value:"Module"})),hj=YN(jl);var ih={};Object.defineProperty(ih,"__esModule",{value:!0});let fj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ih.default=fj;var i2=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ah,"__esModule",{value:!0});const mj=i2(hj),pj=i2(ih);let gj=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=mj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,u;let c=null,d=null,h=null,f=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const b=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),E=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");b&&E&&E.length>1&&(h=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,g="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,g="OK")}catch{i.status===404&&b===""?(f=204,g="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,g="OK"),c&&this.shouldThrowOnError)throw new pj.default(c)}return{error:c,data:d,count:h,status:f,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var l,o,u;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};ah.default=gj;var xj=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sh,"__esModule",{value:!0});const yj=xj(ah);let bj=class extends yj.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:l="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${c}"; options=${u};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};sh.default=bj;var vj=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ou,"__esModule",{value:!0});const wj=vj(sh);let Ej=class extends wj.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Ou.default=Ej;var _j=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nh,"__esModule",{value:!0});const Yl=_j(Ou);let Nj=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&(this.headers.Prefer=`count=${n}`),new Yl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new Yl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const l="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Yl.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new Yl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Yl.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};nh.default=Nj;var lh={},oh={};Object.defineProperty(oh,"__esModule",{value:!0});oh.version=void 0;oh.version="0.0.0-automated";Object.defineProperty(lh,"__esModule",{value:!0});lh.DEFAULT_HEADERS=void 0;const kj=oh;lh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${kj.version}`};var l2=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(M0,"__esModule",{value:!0});const Sj=l2(nh),Tj=l2(Ou),Cj=lh;let jj=class o2{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},Cj.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new Sj.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new o2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let l;const o=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new Tj.default({method:l,url:o,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};M0.default=jj;var Al=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vr,"__esModule",{value:!0});vr.PostgrestError=vr.PostgrestBuilder=vr.PostgrestTransformBuilder=vr.PostgrestFilterBuilder=vr.PostgrestQueryBuilder=vr.PostgrestClient=void 0;const u2=Al(M0);vr.PostgrestClient=u2.default;const c2=Al(nh);vr.PostgrestQueryBuilder=c2.default;const d2=Al(Ou);vr.PostgrestFilterBuilder=d2.default;const h2=Al(sh);vr.PostgrestTransformBuilder=h2.default;const f2=Al(ah);vr.PostgrestBuilder=f2.default;const m2=Al(ih);vr.PostgrestError=m2.default;var Aj=vr.default={PostgrestClient:u2.default,PostgrestQueryBuilder:c2.default,PostgrestFilterBuilder:d2.default,PostgrestTransformBuilder:h2.default,PostgrestBuilder:f2.default,PostgrestError:m2.default};const{PostgrestClient:Ij,PostgrestQueryBuilder:vB,PostgrestFilterBuilder:wB,PostgrestTransformBuilder:EB,PostgrestBuilder:_B,PostgrestError:NB}=Aj,Rj="2.11.2",Lj={"X-Client-Info":`realtime-js/${Rj}`},Oj="1.0.0",p2=1e4,Pj=1e3;var Bi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Bi||(Bi={}));var Ar;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ar||(Ar={}));var dn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(dn||(dn={}));var rp;(function(e){e.websocket="websocket"})(rp||(rp={}));var Ta;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ta||(Ta={}));class Dj{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const c=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class g2{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ct;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ct||(ct={}));const Jx=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,l)=>(i[l]=Mj(l,e,t,s),i),{})},Mj=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?x2(i,l):np(l)},x2=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Hj(t,r)}switch(e){case ct.bool:return Fj(t);case ct.float4:case ct.float8:case ct.int2:case ct.int4:case ct.int8:case ct.numeric:case ct.oid:return Uj(t);case ct.json:case ct.jsonb:return Bj(t);case ct.timestamp:return $j(t);case ct.abstime:case ct.date:case ct.daterange:case ct.int4range:case ct.int8range:case ct.money:case ct.reltime:case ct.text:case ct.time:case ct.timestamptz:case ct.timetz:case ct.tsrange:case ct.tstzrange:return np(t);default:return np(t)}},np=e=>e,Fj=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Uj=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Bj=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Hj=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>x2(t,o))}return e},$j=e=>typeof e=="string"?e.replace(" ","T"):e,y2=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class lf{constructor(t,r,n={},s=p2){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ey;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ey||(ey={}));class So{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=So.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=So.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=So.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,d)=>{l[c]||(u[c]=d)}),this.map(l,(c,d)=>{const h=i[c];if(h){const f=d.map(E=>E.presence_ref),g=h.map(E=>E.presence_ref),p=d.filter(E=>g.indexOf(E.presence_ref)<0),b=h.filter(E=>f.indexOf(E.presence_ref)<0);p.length>0&&(o[c]=p),b.length>0&&(u[c]=b)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),d.length>0){const h=t[o].map(g=>g.presence_ref),f=d.filter(g=>h.indexOf(g.presence_ref)<0);t[o].unshift(...f)}n(o,d,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ty;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ty||(ty={}));var ry;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ry||(ry={}));var Zn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Zn||(Zn={}));class F0{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ar.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new lf(this,dn.join,this.params,this.timeout),this.rejoinTimer=new g2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ar.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ar.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ar.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ar.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dn.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new So(this),this.broadcastEndpointURL=y2(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:l,private:o}}=this.params;this._onError(d=>t==null?void 0:t(Zn.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(Zn.CLOSED));const u={},c={broadcast:i,presence:l,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(Zn.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,g=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,p=[];for(let b=0;b<g;b++){const E=f[b],{filter:{event:x,schema:y,table:v,filter:k}}=E,_=d&&d[b];if(_&&_.event===x&&_.schema===y&&_.table===v&&_.filter===k)p.push(Object.assign(Object.assign({},E),{id:_.id}));else{this.unsubscribe(),t==null||t(Zn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,t&&t(Zn.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(Zn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Zn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ar.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new lf(this,dn.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new lf(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:d}=dn;if(n&&[o,u,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var p,b,E;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((E=(b=g.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(g=>g.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(g=>{var p,b,E,x,y,v;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in g){const k=g.id,_=(p=g.filter)===null||p===void 0?void 0:p.event;return k&&((b=r.ids)===null||b===void 0?void 0:b.includes(k))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const k=(y=(x=g==null?void 0:g.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return k==="*"||k===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===l}).map(g=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:b,table:E,commit_timestamp:x,type:y,errors:v}=p;f=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:x,eventType:y,new:{},old:{},errors:v}),this._getPayloadRecords(p))}g.callback(f,n)})}_isClosed(){return this.state===Ar.closed}_isJoined(){return this.state===Ar.joined}_isJoining(){return this.state===Ar.joining}_isLeaving(){return this.state===Ar.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&F0.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(dn.close,{},t)}_onError(t){this._on(dn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ar.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Jx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Jx(t.columns,t.old_record)),r}}const zj=()=>{},qj=typeof WebSocket<"u",Vj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Wj{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Lj,this.params={},this.timeout=p2,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=zj,this.conn=null,this.sendBuffer=[],this.serializer=new Dj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...o)=>fl(async()=>{const{default:u}=await Promise.resolve().then(()=>jl);return{default:u}},void 0).then(({default:u})=>u(...o)):l=fetch,(...o)=>l(...o)},this.endPoint=`${t}/${rp.websocket}`,this.httpEndpoint=y2(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,l)=>l(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new g2(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(qj){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Gj(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),fl(async()=>{const{default:t}=await import("./browser-csjJoUUE.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oj}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Bi.connecting:return Ta.Connecting;case Bi.open:return Ta.Open;case Bi.closing:return Ta.Closing;default:return Ta.Closed}}isConnected(){return this.connectionState()===Ta.Open}channel(t,r={config:{}}){const n=new F0(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(dn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Pj,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:l}=r;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${l&&"("+l+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,l)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(dn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Vj],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Gj{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Bi.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class U0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ut(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Yj extends U0{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class sp extends U0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Qj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const b2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fl(async()=>{const{default:n}=await Promise.resolve().then(()=>jl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Kj=()=>Qj(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fl(()=>Promise.resolve().then(()=>jl),void 0)).Response:Response}),ap=e=>{if(Array.isArray(e))return e.map(r=>ap(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=ap(n)}),t};var li=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const of=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Zj=(e,t,r)=>li(void 0,void 0,void 0,function*(){const n=yield Kj();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new Yj(of(s),e.status||500))}).catch(s=>{t(new sp(of(s),s))}):t(new sp(of(e),e))}),Xj=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Pu(e,t,r,n,s,i){return li(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,Xj(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>Zj(u,o,n))})})}function vd(e,t,r,n){return li(this,void 0,void 0,function*(){return Pu(e,"GET",t,r,n)})}function js(e,t,r,n,s){return li(this,void 0,void 0,function*(){return Pu(e,"POST",t,n,s,r)})}function Jj(e,t,r,n,s){return li(this,void 0,void 0,function*(){return Pu(e,"PUT",t,n,s,r)})}function e3(e,t,r,n){return li(this,void 0,void 0,function*(){return Pu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function v2(e,t,r,n,s){return li(this,void 0,void 0,function*(){return Pu(e,"DELETE",t,n,s,r)})}var mr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const t3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ny={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class r3{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=b2(s)}uploadOrUpdate(t,r,n,s){return mr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},ny),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Ut(i))return{data:null,error:i};throw i}})}upload(t,r,n){return mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return mr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:ny.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(Ut(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return mr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield js(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new U0("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(n){if(Ut(n))return{data:null,error:n};throw n}})}update(t,r,n){return mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return mr(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}})}copy(t,r,n){return mr(this,void 0,void 0,function*(){try{return{data:{path:(yield js(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return mr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield js(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return mr(this,void 0,void 0,function*(){try{const s=yield js(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}})}download(t,r){return mr(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield vd(this.fetch,`${this.url}/${s}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ut(o))return{data:null,error:o};throw o}})}info(t){return mr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield vd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ap(n),error:null}}catch(n){if(Ut(n))return{data:null,error:n};throw n}})}exists(t){return mr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield e3(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Ut(n)&&n instanceof sp){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return mr(this,void 0,void 0,function*(){try{return{data:yield v2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}})}list(t,r,n){return mr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},t3),r),{prefix:t||""});return{data:yield js(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const n3="2.7.1",s3={"X-Client-Info":`storage-js/${n3}`};var di=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class a3{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},s3),r),this.fetch=b2(n)}listBuckets(){return di(this,void 0,void 0,function*(){try{return{data:yield vd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ut(t))return{data:null,error:t};throw t}})}getBucket(t){return di(this,void 0,void 0,function*(){try{return{data:yield vd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return di(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ut(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return di(this,void 0,void 0,function*(){try{return{data:yield Jj(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ut(n))return{data:null,error:n};throw n}})}emptyBucket(t){return di(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}})}deleteBucket(t){return di(this,void 0,void 0,function*(){try{return{data:yield v2(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}})}}class i3 extends a3{constructor(t,r={},n){super(t,r,n)}from(t){return new r3(this.url,this.headers,t,this.fetch)}}const l3="2.49.4";let uo="";typeof Deno<"u"?uo="deno":typeof document<"u"?uo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?uo="react-native":uo="node";const o3={"X-Client-Info":`supabase-js-${uo}/${l3}`},u3={headers:o3},c3={schema:"public"},d3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},h3={};var f3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const m3=e=>{let t;return e?t=e:typeof fetch>"u"?t=s2:t=fetch,(...r)=>t(...r)},p3=()=>typeof Headers>"u"?a2:Headers,g3=(e,t,r)=>{const n=m3(r),s=p3();return(i,l)=>f3(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},l),{headers:c}))})};var x3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};function y3(e){return e.replace(/\/$/,"")}function b3(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:l,auth:o,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>x3(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const w2="2.69.1",gi=30*1e3,ip=3,uf=ip*gi,v3="http://localhost:9999",w3="supabase.auth.token",E3={"X-Client-Info":`gotrue-js/${w2}`},lp="X-Supabase-Api-Version",E2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_3=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,N3=6e5;class B0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function He(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class k3 extends B0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function S3(e){return He(e)&&e.name==="AuthApiError"}class _2 extends B0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ga extends B0{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class _s extends ga{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function T3(e){return He(e)&&e.name==="AuthSessionMissingError"}class cf extends ga{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pc extends ga{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class gc extends ga{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function C3(e){return He(e)&&e.name==="AuthImplicitGrantRedirectError"}class sy extends ga{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class op extends ga{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function df(e){return He(e)&&e.name==="AuthRetryableFetchError"}class ay extends ga{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class To extends ga{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const iy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ly=` 	
\r=`.split(""),j3=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ly.length;t+=1)e[ly[t].charCodeAt(0)]=-2;for(let t=0;t<iy.length;t+=1)e[iy[t].charCodeAt(0)]=t;return e})();function N2(e,t,r){const n=j3[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function oy(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{R3(l,n,r)};for(let l=0;l<e.length;l+=1)N2(e.charCodeAt(l),s,i);return t.join("")}function A3(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function I3(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}A3(n,t)}}function R3(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function L3(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)N2(e.charCodeAt(s),r,n);return new Uint8Array(t)}function O3(e){const t=[];return I3(e,r=>t.push(r)),new Uint8Array(t)}function P3(e){return Math.round(Date.now()/1e3)+e}function D3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const kn=()=>typeof window<"u"&&typeof document<"u",wa={tested:!1,writable:!1},Co=()=>{if(!kn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wa.tested)return wa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wa.tested=!0,wa.writable=!0}catch{wa.tested=!0,wa.writable=!1}return wa.writable};function M3(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const k2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fl(async()=>{const{default:n}=await Promise.resolve().then(()=>jl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},F3=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",S2=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},xc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},yc=async(e,t)=>{await e.removeItem(t)};class uh{constructor(){this.promise=new uh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}uh.promiseConstructor=Promise;function hf(e){const t=e.split(".");if(t.length!==3)throw new To("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!_3.test(t[n]))throw new To("JWT not in base64url format");return{header:JSON.parse(oy(t[0])),payload:JSON.parse(oy(t[1])),signature:L3(t[2]),raw:{header:t[0],payload:t[1]}}}async function U3(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function B3(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function H3(e){return("0"+e.toString(16)).substr(-2)}function $3(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,H3).join("")}async function z3(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function q3(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await z3(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hi(e,t,r=!1){const n=$3();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await S2(e,`${t}-code-verifier`,s);const i=await q3(n);return[i,n===i?"plain":"s256"]}const V3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function W3(e){const t=e.headers.get(lp);if(!t||!t.match(V3))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function G3(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Y3(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Q3=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Sa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),K3=[502,503,504];async function uy(e){var t;if(!F3(e))throw new op(Sa(e),0);if(K3.includes(e.status))throw new op(Sa(e),e.status);let r;try{r=await e.json()}catch(i){throw new _2(Sa(i),i)}let n;const s=W3(e);if(s&&s.getTime()>=E2["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ay(Sa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new _s}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new ay(Sa(r),e.status,r.weak_password.reasons);throw new k3(Sa(r),e.status||500,n)}const Z3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ke(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[lp]||(i[lp]=E2["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await X3(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function X3(e,t,r,n,s,i){const l=Z3(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new op(Sa(u),0)}if(o.ok||await uy(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await uy(u)}}function Ns(e){var t;let r=null;rA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=P3(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function cy(e){const t=Ns(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ls(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function J3(e){return{data:e,error:null}}function eA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=Q3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function tA(e){return e}function rA(e){return e.access_token&&e.refresh_token&&e.expires_in}var nA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class sA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=k2(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ke(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ls})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=nA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:eA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(He(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ke(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ls})}catch(r){if(He(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},d=await Ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:tA});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(u=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(p.split(";")[1].split("=")[1]);c[`${E}Page`]=b}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(He(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ke(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ls})}catch(r){if(He(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ke(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ls})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ls})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ke(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(He(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}}}const aA={getItem:e=>Co()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Co()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Co()&&globalThis.localStorage.removeItem(e)}};function dy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function iA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fi={debug:!!(globalThis&&Co()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class T2 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class lA extends T2{}async function oA(e,t,r){fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(fi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}iA();const uA={url:v3,storageKey:w3,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:E3,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hy(e,t,r){return await r()}class su{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=su.nextInstanceID,su.nextInstanceID+=1,this.instanceID>0&&kn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},uA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new sA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=k2(s.fetch),this.lock=s.lock||hy,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:kn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=oA:this.lock=hy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Co()?this.storage=aA:(this.memoryStorage={},this.storage=dy(this.memoryStorage)):(this.memoryStorage={},this.storage=dy(this.memoryStorage)),kn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${w2}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=M3(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),kn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),C3(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return He(r)?{error:r}:{error:new _2("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ns}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(He(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await hi(this.storage,this.storageKey)),i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:p},xform:Ns})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ns})}else throw new pc("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(He(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:cy})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:cy})}else throw new pc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new cf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await xc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:l}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ns});if(await yc(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new cf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(He(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ns}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new cf}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await hi(this.storage,this.storageKey));const{error:h}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:d}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new pc("You must provide either an email or phone number.")}catch(o){if(He(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ns});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(He(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await hi(this.storage,this.storageKey)),await Ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:J3})}catch(i){if(He(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new _s;const{error:s}=await Ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(He(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await Ke(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await Ke(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new pc("You must provide either an email or phone number and a type")}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await xc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<uf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!l&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ls}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _s}:await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ls})})}catch(r){if(He(r))return T3(r)&&(await this._removeSession(),await yc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new _s;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await hi(this.storage,this.storageKey));const{data:c,error:d}=await Ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:Ls});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new _s;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=hf(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(He(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new _s;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!kn())throw new gc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new gc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new sy("No code detected.");const{data:y,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new gc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;u&&(f=parseInt(u));const g=f-d;g*1e3<=gi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:b,error:E}=await this._getUser(i);if(E)throw E;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(He(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await xc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(S3(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await yc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=D3(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await hi(this.storage,this.storageKey,!0));try{return await Ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(He(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,d;const{data:h,error:f}=i;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Ke(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return kn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(He(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await Ke(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await B3(async s=>(s>0&&await U3(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ns})),(s,i)=>{const l=200*Math.pow(2,s);return i&&df(i)&&Date.now()+l-n<gi})}catch(n){if(this._debug(r,"error",n),He(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),kn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await xc(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<uf;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${uf}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),df(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new _s;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new uh;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new _s;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),He(i)){const l={session:null,error:i};return df(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await S2(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await yc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&kn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),gi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/gi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${gi}ms, refresh threshold is ${ip} ticks`),s<=ip&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof T2)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await hi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ke(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await Ke(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await Ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(He(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(He(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=hf(s.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n||(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+N3>Date.now()))return n;const{data:s,error:i}=await Ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new To("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(l=>l.kid===t),!n)throw new To("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:g,error:p}=await this.getSession();if(p||!g.session)return{data:null,error:p};n=g.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=hf(n);if(G3(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(n);if(g)throw g;return{data:{claims:i,header:s,signature:l},error:null}}const c=Y3(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,l,O3(`${o}.${u}`)))throw new To("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}}}su.nextInstanceID=0;const cA=su;class dA extends cA{constructor(t){super(t)}}var hA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class fA{constructor(t,r,n){var s,i,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=y3(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:c3,realtime:h3,auth:Object.assign(Object.assign({},d3),{storageKey:u}),global:u3},d=b3(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=g3(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Ij(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new lj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new i3(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return hA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:l,lock:o,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:l,lock:o,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Wj(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mA=(e,t,r)=>new fA(e,t,r),pA="https://tkenxulvmzhhkuhfvcpt.supabase.co",gA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrZW54dWx2bXpoaGt1aGZ2Y3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgwOTEwNzgsImV4cCI6MjA1MzY2NzA3OH0.UJPzvtHD6k6rJ09BlFYkdYEyHC3sx3h1rpAG8DULSHI",ff={maxRetries:3,retryDelay:1e3,retryCondition:e=>{var t,r,n,s,i;return(e==null?void 0:e.status)===500||(e==null?void 0:e.status)===503||(e==null?void 0:e.status)===504||(e==null?void 0:e.status)===429||((t=e==null?void 0:e.message)==null?void 0:t.includes("Database error"))||((r=e==null?void 0:e.message)==null?void 0:r.includes("unexpected_failure"))||((n=e==null?void 0:e.message)==null?void 0:n.includes("schema"))||((s=e==null?void 0:e.message)==null?void 0:s.includes("network"))||((i=e==null?void 0:e.message)==null?void 0:i.includes("timeout"))}},te=mA(pA,gA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"dragonbane_auth",flowType:"implicit"},global:{headers:{"X-Client-Info":"dragonbane-character-manager"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}},maxRetries:ff.maxRetries,retryDelay:ff.retryDelay,retryCondition:ff.retryCondition});te.auth.onAuthStateChange((e,t)=>{(e==="USER_DELETED"||e==="SIGNED_OUT")&&console.log("Auth event:",e),e==="TOKEN_REFRESHED"&&console.log("Token refreshed successfully"),e==="SIGNED_OUT"&&!t&&console.error("Auth error: Session ended unexpectedly")});window.addEventListener("online",()=>{te.auth.startAutoRefresh()});window.addEventListener("offline",()=>{te.auth.stopAutoRefresh()});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),C2=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},u)=>w.createElement("svg",{ref:u,...yA,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:C2("lucide",s),...o},[...l.map(([c,d])=>w.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=(e,t)=>{const r=w.forwardRef(({className:n,...s},i)=>w.createElement(bA,{ref:i,iconNode:t,className:C2(`lucide-${xA(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vA=re("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=re("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=re("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z",key:"wvr1b5"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}],["path",{d:"M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5",key:"xk3gvk"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=re("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=re("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=re("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=re("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=re("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=re("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=re("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=re("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _A=re("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=re("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=re("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=re("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=re("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=re("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=re("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=re("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=re("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=re("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=re("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=re("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=re("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=re("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gy=re("Dice4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=re("Dice6",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=re("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=re("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=re("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=re("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=re("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=re("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=re("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=re("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=re("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=re("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=re("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=re("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=re("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=re("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=re("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=re("LampDesk",[["path",{d:"m14 5-3 3 2 7 8-8-7-2Z",key:"1b0msb"}],["path",{d:"m14 5-3 3-3-3 3-3 3 3Z",key:"1uemms"}],["path",{d:"M9.5 6.5 4 12l3 6",key:"1bx08v"}],["path",{d:"M3 22v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2H3Z",key:"wap775"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=re("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=re("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=re("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=re("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=re("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=re("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=re("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=re("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=re("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=re("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=re("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=re("Notebook",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=re("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=re("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=re("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=re("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=re("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=re("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=re("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=re("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=re("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=re("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=re("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=re("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=re("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=re("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=re("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=re("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=re("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=re("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=re("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=re("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=re("SquareMinus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=re("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=re("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=re("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=re("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=re("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=re("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=re("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=re("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=re("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=re("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=re("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mh=re("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=re("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=re("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=re("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=re("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Q2=w.createContext(void 0);function t4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(!1),[i,l]=w.useState(null);return a.jsxs(Q2.Provider,{value:{setGlobalError:r,setGlobalLoading:s,setGlobalWarning:l},children:[n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})})}),i&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(fh,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-yellow-700",children:i})}),a.jsx("button",{onClick:()=>l(null),className:"text-yellow-500 hover:text-yellow-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]})})}),t&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Nt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-700",children:t})}),a.jsx("button",{onClick:()=>r(null),className:"text-red-500 hover:text-red-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]})})}),e]})}function K2(){const e=w.useContext(Q2);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}async function r4(e,t,r,n){const{data:s,error:i}=await te.auth.signUp({email:e,password:t,options:{data:{username:r.trim(),role:n}}});if(i)throw i.message.includes("User already registered")?new Error("An account with this email already exists."):(console.error("Sign up error (auth):",i.message),new Error(`Authentication error: ${i.message}`));if(!s.user)throw console.error("Sign up error: User object not returned after sign up."),new Error("Sign up failed: Could not retrieve user information.");const{error:l}=await te.from("users").insert({id:s.user.id,username:r.trim(),role:n,email:e});if(l)throw console.error("Sign up error (profile creation):",l.message),new Error(`Account created, but failed to set up user profile: ${l.message}. Please contact support.`);return s.user}async function n4(e,t){const{data:r,error:n}=await te.auth.signInWithPassword({email:e,password:t});if(n)throw n;if(r.user){const{error:s}=await te.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.user.id);s&&console.error("Failed to update user timestamps on login:",s.message)}if(!r.session){const{data:s,error:i}=await te.auth.getSession();if(i)throw i;return{user:r.user,session:s.session}}return{user:r.user,session:r.session}}async function s4(){const{error:e}=await te.auth.signOut();if(e)throw console.error("Sign out error:",e.message),e}const _y=["player","dm","admin"],Z2=w.createContext(void 0);function Mt(){const e=w.useContext(Z2);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function a4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState(!0),[c,d]=w.useState(!1),h=rn(),{setGlobalError:f}=K2(),g=w.useCallback(async _=>{var S,I,j;try{const{data:D,error:T}=await te.auth.getSession();if(T)console.error("[fetchUserRole] Error getting session for metadata check:",T.message);else{const z=(j=(I=(S=D==null?void 0:D.session)==null?void 0:S.user)==null?void 0:I.user_metadata)==null?void 0:j.role;if(z&&_y.includes(z))return z}const{data:B,error:O,status:Y}=await te.from("users").select("role").eq("id",_).single();if(O)return O.code==="PGRST116"||Y===404?"player":Y===401||Y===403?(f("Permission issue accessing user data. Please contact support if this persists."),"player"):(console.error("[fetchUserRole] Database error fetching role from table:",O),f("Failed to retrieve user role data due to a database error."),"player");const G=B==null?void 0:B.role;return G&&_y.includes(G)?G:"player"}catch(D){return console.error("[fetchUserRole] Unexpected error during role fetch process:",D),f("Failed to determine user role due to an unexpected error."),"player"}},[f]);w.useEffect(()=>{u(!0),te.auth.getSession().then(({data:{session:_}})=>{s(_),r((_==null?void 0:_.user)??null),_!=null&&_.user||u(!1)}).catch(_=>{console.error("Error getting initial session:",_),f("Failed to initialize user session."),s(null),r(null),l(null),u(!1)})},[]),w.useEffect(()=>{const{data:_}=te.auth.onAuthStateChange(async(S,I)=>{const j=(I==null?void 0:I.user)??null;s(I),r(j),S==="SIGNED_OUT"?(l(null),u(!1),f(null),h("/login")):S==="SIGNED_IN"&&window.location.pathname==="/login"&&j&&h("/")});return()=>{var S;(S=_==null?void 0:_.subscription)==null||S.unsubscribe()}},[h,f]),w.useEffect(()=>{t?(o||u(!0),g(t.id).then(_=>{l(_)}).catch(_=>{l("player")}).finally(()=>{u(!1)})):(l(null),o&&u(!1))},[t,g]);const p=async(_,S,I,j)=>{try{d(!0),f(null),await r4(_,S,I,j)}catch(D){throw f(D instanceof Error?D.message:"Signup failed"),D}finally{d(!1)}},b=async(_,S)=>{try{d(!0),f(null),await n4(_,S)}catch(I){let j="Authentication failed. Please check your credentials.";throw I instanceof Error&&(I.message.includes("Invalid login credentials")?j="Incorrect email or password.":I.message.includes("Email not confirmed")?j="Please verify your email address before logging in.":I.message.includes("network error")||I.message.includes("Failed to fetch")?j="Network error. Please check your connection and try again.":j=I.message.length>100?"An unexpected authentication error occurred.":I.message),f(j),new Error(j)}finally{d(!1)}},E=w.useCallback(async()=>{if(!c)try{d(!0),await s4()}catch(_){console.error("Sign out error:",_),f("Failed to sign out")}finally{d(!1)}},[f,c]),x=()=>i==="admin",y=()=>i==="dm"||i==="admin",v=()=>i==="player",k=o||c;return a.jsx(Z2.Provider,{value:{user:t,session:n,role:i,isLoading:k,signIn:b,signUp:p,signOut:E,isAdmin:x,isDM:y,isPlayer:v},children:e})}const X2=w.createContext(void 0),bc=30*60*1e3,Ny=30*1e3,i4=10*1e3;function l4({children:e}){const{signOut:t}=Mt(),r=rn(),n=w.useRef(Date.now()),s=w.useRef(null),i=w.useRef(null),[l,o]=w.useState(!1),u=w.useCallback(()=>{s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{o(!0)},bc-Ny),s.current=setTimeout(async()=>{await t(),r("/login",{state:{message:"Your session has expired due to inactivity."}})},bc),n.current=Date.now(),o(!1)},[t,r]),c=w.useCallback(()=>{u()},[u]);return w.useEffect(()=>{const d=["mousedown","keydown","scroll","mousemove","click","touchstart"];let h;function f(p,b){let E;return function(...y){const v=()=>{clearTimeout(E),p(...y)};clearTimeout(E),E=setTimeout(v,b)}}const g=f(()=>{Date.now()-n.current>1e3&&u()},1e3);return d.forEach(p=>{document.addEventListener(p,g)}),h=window.setInterval(()=>{const p=Date.now()-n.current;p>=bc-Ny&&o(!0),p>=bc&&(t(),r("/login",{state:{message:"Your session has expired due to inactivity."}}))},i4),u(),()=>{d.forEach(p=>{document.removeEventListener(p,g)}),s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),window.clearInterval(h)}},[u,t,r]),a.jsx(X2.Provider,{value:{showWarning:l,extendSession:c},children:e})}function o4(){const e=w.useContext(X2);if(e===void 0)throw new Error("useSessionTimeout must be used within a SessionTimeoutProvider");return e}const Cn=class Cn{constructor(){Qu(this,"environment");this.environment="production"}static getInstance(){return Cn.instance||(Cn.instance=new Cn),Cn.instance}logError(t,r={},n="medium"){const s={error:t,context:{...r,timestamp:new Date().toISOString(),path:window.location.pathname},severity:n};this.environment==="development"&&console.error("Error Report:",{message:t.message,stack:t.stack,...s.context,severity:n}),this.environment==="production"&&this.sendToErrorTrackingService(s)}async sendToErrorTrackingService(t){try{console.error("Production Error:",t)}catch(r){console.error("Failed to send error report:",r)}}static handleError(t,r){const n=Cn.getInstance();t instanceof Error?n.logError(t,r):n.logError(new Error(String(t)),r)}static handleNetworkError(t,r){const n=Cn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("network")||t.message.toLowerCase().includes("connection")||t.message.toLowerCase().includes("offline");n.logError(t,{...r,additionalData:{isNetworkError:s}},s?"high":"medium")}}static handleAuthError(t,r){const n=Cn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("auth")||t.message.toLowerCase().includes("unauthorized")||t.message.toLowerCase().includes("forbidden");n.logError(t,{...r,additionalData:{isAuthError:s}},s?"high":"medium")}}};Qu(Cn,"instance");let zi=Cn;class u4 extends w.Component{constructor(r){super(r);Qu(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){zi.handleError(r,{action:"render",additionalData:{componentStack:n.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(fh,{className:"w-8 h-8 text-red-500"}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Something went wrong"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. The application has encountered an unexpected error."}),this.state.error&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-red-700 font-mono break-all",children:this.state.error.message||"No error message available"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(z2,{className:"w-5 h-5"}),"Refresh Page"]}),a.jsxs(ep,{to:"/",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(RA,{className:"w-5 h-5"}),"Go Home"]})]})]})}):this.props.children}}const J2=new MT({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1,retry:1}}}),eE=w.createContext(void 0),c4=20;function d4({children:e}){const[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState(!1),[h,f]=w.useState(!1),g=w.useCallback(_=>{r(S=>{const I=!S;if(I){s(_||null);let j=(_==null?void 0:_.initialDice)||[];(_==null?void 0:_.rollMode)==="deathRoll"?j=["d20"]:(_==null?void 0:_.rollMode)==="recoveryRoll"?j=["d6"]:(_==null?void 0:_.rollMode)==="rallyRoll"?j=["d20"]:(_==null?void 0:_.rollMode)==="skillCheck"&&!_.initialDice?j=["d20"]:(_==null?void 0:_.rollMode)==="advancementRoll"&&(j=["d20"]),l(j),d(!1),f((_==null?void 0:_.requiresBane)||(_==null?void 0:_.rollMode)==="rallyRoll"||!1)}else s(null),l([]),d(!1),f(!1);return I})},[]),p=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l(S=>[...S,_]),(c||h)&&(d(!1),f(!1)))},[c,h,n]),b=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||l(S=>{if(S.length===0)return[];if(_){const I=S.lastIndexOf(_);if(I!==-1){const j=[...S];return j.splice(I,1),j}}return S.slice(0,-1)})},[n]),E=w.useCallback(()=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l([]),d(!1),f(!1))},[n]),x=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(_?(d(!0),f(!1),l(["d20"])):d(!1))},[n]),y=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(_?(f(!0),d(!1),l(["d20"])):(n==null?void 0:n.rollMode)!=="rallyRoll"&&f(!1))},[n]),v=w.useCallback(_=>{u(S=>{const j=[{..._,id:crypto.randomUUID(),timestamp:Date.now()},...S];return j.length>c4&&j.pop(),j})},[]),k=w.useCallback(()=>{u([])},[]);return a.jsx(eE.Provider,{value:{showDiceRoller:t,currentConfig:n,dicePool:i,rollHistory:o,isBoonActive:c,isBaneActive:h,toggleDiceRoller:g,addDie:p,removeLastDie:b,clearDicePool:E,setBoon:x,setBane:y,addRollToHistory:v,clearHistory:k},children:e})}function xa(){const e=w.useContext(eE);if(e===void 0)throw new Error("useDice must be used within a DiceProvider");return e}function h4(){const e=pa(),{signOut:t,isAdmin:r,isDM:n,role:s}=Mt(),{toggleDiceRoller:i}=xa(),[l,o]=w.useState(!1),u=w.useRef(null),c=f=>e.pathname===f,d=[{path:"/",label:"Characters",icon:xn,roles:["player","dm","admin"]},{path:"/compendium",label:"Compendium",icon:Du,roles:["player","dm","admin"]},{path:"/adventure-party",label:"Adventure Party",icon:Ja,roles:["player","dm","admin"]},{path:"/notes",label:"Notes",icon:pl,roles:["player","dm","admin"]},{path:"/settings",label:"Settings",icon:q2,roles:["player","dm","admin"]}],h=()=>{l&&o(!1)};return w.useEffect(()=>{const f=g=>{u.current&&!u.current.contains(g.target)&&o(!1)};return l?document.addEventListener("mousedown",f):document.removeEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[l]),a.jsxs("nav",{className:"bg-gray-800 text-white",ref:u,children:[a.jsx("div",{className:"container mx-auto px-4",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0"}),a.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-4",children:d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:g,icon:p})=>a.jsxs(ep,{to:f,onClick:h,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(p,{className:"w-5 h-5"}),a.jsx("span",{children:g})]},f))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Open Dice Roller",children:[a.jsx(en,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Dice"})]}),a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700",title:`Current role: ${s}`,children:[r()?a.jsx(py,{className:"w-5 h-5 text-yellow-400"}):n()?a.jsx(ds,{className:"w-5 h-5 text-blue-400"}):a.jsx(xn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:r()?"Admin":n()?"DM":"Player"})]}),a.jsxs("button",{onClick:()=>{t(),h()},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Log Out",children:[a.jsx(yy,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Log Out"})]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center",children:[a.jsx("button",{onClick:i,className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white mr-2",title:"Open Dice Roller",children:a.jsx(en,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>o(!l),className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white","aria-expanded":l,"aria-controls":"mobile-menu",children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),l?a.jsx(Lt,{className:"block h-6 w-6"}):a.jsx(UA,{className:"block h-6 w-6"})]})]})]})}),l&&a.jsx("div",{className:"md:hidden absolute top-16 inset-x-0 bg-gray-800 z-50 shadow-lg",id:"mobile-menu",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:g,icon:p})=>a.jsxs(ep,{to:f,onClick:h,className:`flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(p,{className:"w-6 h-6"}),a.jsx("span",{children:g})]},f)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700 w-full",children:r()?a.jsxs(a.Fragment,{children:[a.jsx(py,{className:"w-5 h-5 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}):n()?a.jsxs(a.Fragment,{children:[a.jsx(ds,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-sm font-medium",children:"DM"})]}):a.jsxs(a.Fragment,{children:[a.jsx(xn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Player"})]})})}),a.jsxs("button",{onClick:()=>{t(),h()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:[a.jsx(yy,{className:"w-6 h-6"}),a.jsx("span",{children:"Log Out"})]})]})})]})}function f4({character:e}){const t=r=>r>=16?"text-purple-600":r>=14?"text-blue-600":r>=12?"text-green-600":r>=10?"text-yellow-600":"text-gray-600";return a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.kin," ",e.profession]})]}),a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.age})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ds,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:t(e.attributes.STR),children:e.attributes.STR})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V0,{className:"w-4 h-4 text-pink-600"}),a.jsx("span",{className:t(e.attributes.CON),children:e.attributes.CON})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Y0,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{className:t(e.attributes.AGL),children:e.attributes.AGL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O2,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:t(e.attributes.INT),children:e.attributes.INT})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Fn,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:t(e.attributes.WIL),children:e.attributes.WIL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xn,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:t(e.attributes.CHA),children:e.attributes.CHA})]})]}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsx("p",{className:"line-clamp-2",children:e.appearance||"No appearance set"})})]})})}const m4={},ky=e=>{let t;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const g=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(p=>p(t,g))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(m4?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,s,u);return u},p4=e=>e?ky(e):ky;var tE={exports:{}},rE={},nE={exports:{}},sE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=w;function g4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var x4=typeof Object.is=="function"?Object.is:g4,y4=gl.useState,b4=gl.useEffect,v4=gl.useLayoutEffect,w4=gl.useDebugValue;function E4(e,t){var r=t(),n=y4({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return v4(function(){s.value=r,s.getSnapshot=t,gf(s)&&i({inst:s})},[e,r,t]),b4(function(){return gf(s)&&i({inst:s}),e(function(){gf(s)&&i({inst:s})})},[e]),w4(r),r}function gf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!x4(e,r)}catch{return!0}}function _4(e,t){return t()}var N4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_4:E4;sE.useSyncExternalStore=gl.useSyncExternalStore!==void 0?gl.useSyncExternalStore:N4;nE.exports=sE;var k4=nE.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph=w,S4=k4;function T4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var C4=typeof Object.is=="function"?Object.is:T4,j4=S4.useSyncExternalStore,A4=ph.useRef,I4=ph.useEffect,R4=ph.useMemo,L4=ph.useDebugValue;rE.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=A4(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=R4(function(){function u(g){if(!c){if(c=!0,d=g,g=n(g),s!==void 0&&l.hasValue){var p=l.value;if(s(p,g))return h=p}return h=g}if(p=h,C4(d,g))return p;var b=n(g);return s!==void 0&&s(p,b)?(d=g,p):(d=g,h=b)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,r,n,s]);var o=j4(e,i[0],i[1]);return I4(function(){l.hasValue=!0,l.value=o},[o]),L4(o),o};tE.exports=rE;var O4=tE.exports;const P4=Ud(O4),aE={},{useDebugValue:D4}=Kr,{useSyncExternalStoreWithSelector:M4}=P4;let Sy=!1;const F4=e=>e;function U4(e,t=F4,r){(aE?"production":void 0)!=="production"&&r&&!Sy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Sy=!0);const n=M4(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return D4(n),n}const Ty=e=>{(aE?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?p4(e):e,r=(n,s)=>U4(t,n,s);return Object.assign(r,t),r},iE=e=>e?Ty(e):Ty,gs=iE(e=>({step:0,character:{},setStep:t=>e({step:t}),updateCharacter:t=>e(r=>({character:{...r.character,...t}})),resetCharacter:()=>e({character:{},step:0})}));async function B4(){const{data:e,error:t}=await te.from("kin").select("id, name, description, heroic_ability");if(t)throw console.error("Error fetching kin list:",t),new Error(t.message||"Failed to fetch kin list");return e||[]}async function H4(e){if(!e||e.length===0)return[];const t=e.map(s=>s.trim()).filter(s=>s);if(t.length===0)return[];const{data:r,error:n}=await te.from("heroic_abilities").select("id, name, description, willpower_cost, requirement").in("name",t);if(n)throw console.error("Error fetching ability details by names:",n),new Error(n.message||"Failed to fetch ability details");return(r||[]).map(s=>({id:s.id,name:s.name,description:s.description,willpower_cost:s.willpower_cost,requirement:s.requirement}))}function Ge({size:e="md",className:t=""}){const r={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-4",lg:"w-12 h-12 border-4"};return a.jsx("div",{className:`flex items-center justify-center ${t}`,role:"status",children:a.jsx("div",{className:`${r[e]} animate-spin rounded-full border-gray-200 border-t-blue-600`,"aria-label":"Loading..."})})}function Ie({message:e,onClose:t}){return e?a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 flex items-start justify-between",role:"alert",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(dh,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{className:"block sm:inline",children:e})]}),t&&a.jsx("button",{onClick:t,className:"ml-4 p-1 text-red-500 hover:text-red-700 hover:bg-red-200 rounded-full transition-colors","aria-label":"Close error message",children:a.jsx(Lt,{className:"w-4 h-4"})})]}):null}const Cy=e=>e?e.split(",").map(t=>t.trim()).filter(t=>t):[];function $4(){const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState(null),{data:s=[],isLoading:i,error:l}=Rt({queryKey:["kinListWithHeroicAbility"],queryFn:B4,retry:!1});w.useEffect(()=>{if(e.kin&&s.length>0&&!r){const p=s.find(b=>b.name===e.kin);if(p){n(p.id);const b=Cy(p.heroic_ability);JSON.stringify(e.kinAbilityNames)!==JSON.stringify(b)&&t({kinAbilityNames:b})}}},[e.kin,s,r,e.kinAbilityNames,t]);const o=p=>{n(p.id);const b=Cy(p.heroic_ability);t({kin:p.name,kinAbilityNames:b})},u=w.useMemo(()=>s.find(p=>p.id===r),[s,r]),c=w.useMemo(()=>e.kinAbilityNames||[],[e.kinAbilityNames]),{data:d=[],isLoading:h,error:f}=Rt({queryKey:["abilityDetails",c.sort().join(",")],queryFn:()=>H4(c),enabled:c.length>0,staleTime:10*60*1e3,retry:!1}),g=p=>a.jsxs("div",{className:"mb-4 p-3 border rounded bg-gray-50 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-md text-gray-800",children:p.name}),p.willpower_cost!=null&&a.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:["Willpower Cost: ",p.willpower_cost]}),p.requirement&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requirement: ",p.requirement]}),a.jsx("p",{className:"text-sm text-gray-700 mt-2",children:p.description})]},p.id);if(i)return a.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:a.jsx(Ge,{size:"lg"})});if(l){const p=l instanceof Error?l.message:"Failed to load Kin options.";return console.error("Error loading Kin:",l),a.jsx(Ie,{title:"Error Loading Kin",message:p})}return a.jsxs("div",{className:"flex space-x-6 h-[60vh]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Kin List"}),a.jsx("ul",{className:"space-y-1",children:s.map(p=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md text-sm ${r===p.id?"bg-blue-100 font-semibold text-blue-800":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>o(p),children:p.name},p.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:u?a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-1",children:u.name}),a.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:u.description}),a.jsx("hr",{className:"my-4 border-gray-300"}),a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Kin Abilities"}),h?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(Ge,{})}):f?a.jsx(Ie,{title:"Error Loading Abilities",message:f.message||"Failed to load ability details."}):d.length>0?d.map(g):c.length>0&&!h?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-orange-600 italic mb-2",children:"Could not fetch full details for the following abilities (check names in database):"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:c.map(p=>a.jsx("li",{children:p},p))})]}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific heroic abilities listed for this Kin."})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"Select a kin from the list to view details and abilities."})})})]})}async function z4(){const{data:e,error:t}=await te.from("professions").select("*").order("name");if(t)throw console.error("Error fetching profession list:",t),new Error(t.message||"Failed to fetch profession list");return e||[]}async function q4(e){const{data:t,error:r}=await te.from("heroic_abilities").select("*").eq("profession",e);if(r)throw console.error("Error fetching heroic abilities:",r),new Error(r.message||"Failed to fetch heroic abilities");return t||[]}async function V4(){const{data:e,error:t}=await te.from("game_spells").select(`
      *,
      magic_schools ( name )
    `).order("name",{ascending:!0});if(t)throw console.error("Error fetching spells:",t),new Error(t.message||"Failed to fetch spells");return e||[]}async function lE(){const{data:e,error:t}=await te.from("magic_schools").select("id, name, description").order("name",{ascending:!0});if(t)throw console.error("Error fetching magic schools:",t),new Error(t.message||"Failed to fetch magic schools");return e||[]}function W4(){const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(null),[u,c]=w.useState(!1),[d,h]=w.useState(null),{data:f=[],isLoading:g,error:p}=Rt({queryKey:["professions"],queryFn:z4}),{data:b=[],isLoading:E,error:x}=Rt({queryKey:["magicSchools"],queryFn:lE});w.useEffect(()=>{if(e.profession&&f.length>0){const I=f.find(j=>j.name===e.profession);if(I&&(n(I),I.magic_school_id===null&&e.professionHeroicAbilityName&&y(I.name,e.professionHeroicAbilityName),e.professionHeroicAbilityName&&s.length>0)){const j=s.find(D=>D.name===e.professionHeroicAbilityName);j&&o(j)}}},[e.profession,f,e.professionHeroicAbilityName]);const y=async(I,j)=>{c(!0),h(null);try{const T=await q4(I);i(T);const B=j??e.professionHeroicAbilityName;if(B){const O=T.find(Y=>Y.name===B);o(O||null)}else o(null)}catch(D){h(D instanceof Error?D.message:"Failed to load heroic abilities"),i([]),o(null)}finally{c(!1)}};w.useEffect(()=>{r&&r.magic_school_id===null?y(r.name):(i([]),o(null),e.professionHeroicAbilityName&&t({professionHeroicAbilityName:null}))},[r]);const v=I=>{var D;n(I),I.magic_school_id!==null&&((D=b.find(T=>T.id===I.magic_school_id))==null||D.name);const j={profession:I.name,key_attribute:I.key_attribute,magicSchool:I.magic_school_id??null,professionHeroicAbilityName:null};I.magic_school_id!==null&&o(null),t(j)},k=I=>{o(I),t({professionHeroicAbilityName:I.name})},_=I=>{var j;return I===null||b.length===0?null:((j=b.find(D=>D.id===I))==null?void 0:j.name)??`ID: ${I}`},S=(I,j)=>{if(!Array.isArray(I)||I.length===0)return a.jsxs("p",{className:"text-sm text-gray-500",children:["No ",j.toLowerCase()," listed."]});const D=I.filter(T=>typeof T=="string");return D.length===0?a.jsxs("p",{className:"text-sm text-gray-500",children:["No valid ",j.toLowerCase()," listed."]}):a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:D.map((T,B)=>a.jsx("li",{children:T},B))})};return g||E?a.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:a.jsx(Ge,{size:"lg"})}):p||x?a.jsx(Ie,{message:(p==null?void 0:p.message)||(x==null?void 0:x.message)||"Failed to load required data."}):(r&&console.log("Selected Profession Data:",r),a.jsxs("div",{className:"flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6 h-[80vh]",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 overflow-y-auto max-h-[30vh] md:max-h-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Profession List"}),a.jsx("ul",{className:"space-y-2",children:f.map(I=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md border ${(r==null?void 0:r.id)===I.id?"bg-blue-100 border-blue-300 font-semibold":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>v(I),children:I.name},I.id))})]}),a.jsx("div",{className:"w-full md:w-2/3 md:pl-4 overflow-y-auto max-h-[calc(80vh-30vh-2rem)] md:max-h-full",children:r?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:r.description})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Key Attribute"}),a.jsx("p",{className:"text-gray-700",children:r.key_attribute})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Skills"}),S(r.skills,"Skills")]}),r.starting_equipment&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Starting Equipment"}),S(r.starting_equipment,"Starting Equipment")]}),r.equipment_description&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Equipment Notes"}),S(r.equipment_description,"Equipment Notes")]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Heroic Ability / Magic"}),r.magic_school_id!==null?a.jsxs("p",{className:"text-gray-600",children:["As a mage of the ",a.jsx("strong",{children:_(r.magic_school_id)??"Unknown School"})," school, you don't get a starting heroic ability. Instead, you get your magic."]}):a.jsxs(a.Fragment,{children:[u&&a.jsx(Ge,{size:"sm"}),d&&a.jsx(Ie,{message:d}),!u&&!d&&s.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(I=>a.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${(l==null?void 0:l.id)===I.id?"border-green-500 bg-green-50 ring-2 ring-green-300":"border-gray-200 hover:border-green-300 hover:bg-green-50"}`,onClick:()=>k(I),children:[a.jsx("h5",{className:"font-semibold text-lg mb-2",children:I.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:I.description}),a.jsxs("p",{className:"text-sm text-blue-600",children:["Willpower Cost: ",I.willpower_cost??"N/A"," WP"]}),I.requirement&&typeof I.requirement=="string"&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requirement: ",I.requirement]})]},I.id))}):!u&&!d&&a.jsx("p",{className:"text-gray-600",children:"No specific heroic abilities listed for this profession, or none available."})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg sticky bottom-0",children:[a.jsxs("p",{className:"text-blue-800 font-medium",children:["Selected: ",a.jsx("strong",{children:r.name}),r.magic_school_id!==null&&a.jsxs(a.Fragment,{children:[" (Magic School: ",a.jsx("strong",{children:_(r.magic_school_id)??"N/A"}),")"]}),r.magic_school_id===null&&e.professionHeroicAbilityName&&a.jsxs(a.Fragment,{children:[" with Heroic Ability: ",a.jsx("strong",{children:e.professionHeroicAbilityName})]})]}),r.magic_school_id===null&&!e.professionHeroicAbilityName&&s.length>0&&!u&&a.jsx("p",{className:"text-amber-700 mt-2 text-sm",children:"Please select a heroic ability above to continue."}),r.magic_school_id===null&&s.length===0&&!u&&!d&&a.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"No heroic ability selection required for this profession."})]})]}):a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500 text-lg",children:"Select a profession from the list to view details."})})})]}))}const vc={Young:{attributes:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},skillPoints:8},Adult:{attributes:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},skillPoints:10},Old:{attributes:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0},skillPoints:12}};function G4(){const{character:e,updateCharacter:t}=gs(),r=n=>n===0?"No change":n>0?`+${n}`:n;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Details"}),a.jsx("p",{className:"text-gray-600",children:"Choose a name that fits your character's background and select their age category. Age affects your starting attributes and the number of skill points available during character creation."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Character Name"}),a.jsxs("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Il,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:e.name||"",onChange:n=>t({name:n.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter character name"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Age Category"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Young","Adult","Old"].map(n=>a.jsxs("div",{className:`relative rounded-lg border p-6 cursor-pointer transition-all ${e.age===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>t({age:n}),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx($0,{className:`h-5 w-5 ${e.age===n?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium",children:n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Attribute Modifiers"}),a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:Object.entries(vc[n].attributes).map(([s,i])=>i!==0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-gray-600",children:[s,":"]}),a.jsx("span",{className:i>0?"text-green-600":"text-red-600",children:r(i)})]},s))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Skill Points"}),a.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[vc[n].skillPoints," points"]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[n==="Young"&&"Quick to learn, physically developing",n==="Adult"&&"Balanced attributes and experience",n==="Old"&&"Wise and knowledgeable, physically declining"]})]})]},n))})]})]}),(e.name||e.age)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[e.name&&a.jsxs("p",{className:"text-green-800",children:["Name: ",a.jsx("strong",{children:e.name})]}),e.age&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-green-800",children:["Age Category: ",a.jsx("strong",{children:e.age})]}),a.jsxs("p",{className:"text-sm text-green-700",children:["Starting Skill Points: ",a.jsx("strong",{children:vc[e.age].skillPoints})]}),Object.entries(vc[e.age].attributes).filter(([n,s])=>s!==0).map(([n,s])=>a.jsxs("p",{className:"text-sm text-green-700",children:[n," Modifier: ",a.jsx("strong",{children:r(s)})]},n))]})]})})]})}const xf=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,yf=e=>e<=12?"None":e<=15?"+D4":"+D6",mi=()=>{const e=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return e.sort((t,r)=>r-t),e.slice(0,3).reduce((t,r)=>t+r,0)},Y4=()=>({STR:mi(),CON:mi(),AGL:mi(),INT:mi(),WIL:mi(),CHA:mi()}),Q4={Young:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},Adult:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},Old:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0}};function K4(){var f,g,p,b,E,x;const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState({STR:{value:((f=e.attributes)==null?void 0:f.STR)||0,baseChance:0},CON:{value:((g=e.attributes)==null?void 0:g.CON)||0,baseChance:0},AGL:{value:((p=e.attributes)==null?void 0:p.AGL)||0,baseChance:0},INT:{value:((b=e.attributes)==null?void 0:b.INT)||0,baseChance:0},WIL:{value:((E=e.attributes)==null?void 0:E.WIL)||0,baseChance:0},CHA:{value:((x=e.attributes)==null?void 0:x.CHA)||0,baseChance:0}}),[s,i]=w.useState(!1),l=y=>e.age?Q4[e.age][y]:0,o=(y,v)=>{const k=l(y);return v+k},u=()=>{i(!0);const y=Y4(),v=Object.entries(y).reduce((_,[S,I])=>({..._,[S]:o(S,I)}),{}),k=Object.entries(y).reduce((_,[S,I])=>({..._,[S]:{value:I,baseChance:xf(o(S,I))}}),{});n(k),t({attributes:v,current_hp:v.CON,current_wp:v.WIL,magic_school:e.magicSchool??null}),i(!1)},c=(y,v)=>{const k=Math.max(3,Math.min(18,parseInt(v)||0)),_=o(y,k),S={...r,[y]:{value:k,baseChance:xf(_)}};n(S);const I=Object.entries(S).reduce((j,[D,{value:T}])=>({...j,[D]:o(D,T)}),{});t({attributes:I,current_hp:I.CON,current_wp:I.WIL,magic_school:e.magicSchool??null})},d=()=>{if(!e.kin||!r.AGL.value)return 0;const y={Human:10,Halfling:8,Dwarf:8,Elf:10,Mallard:8,Wolfkin:12}[e.kin],v=o("AGL",r.AGL.value);let k=0;return v<=6?k=-4:v<=9?k=-2:v<=12?k=0:v<=15?k=2:k=4,y+k},h=e.key_attribute;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Assign Attributes"}),a.jsxs("p",{className:"text-gray-600",children:["Roll or manually enter your character's attributes. Each attribute is determined by rolling 4D6 and removing the lowest die, giving you a score between 3 and 18. ",e.age&&"Age modifiers will be automatically applied."]}),e.profession&&a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-blue-800",children:["Selected Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&a.jsxs(a.Fragment,{children:[" (Key Attribute: ",a.jsx("strong",{children:e.key_attribute}),")"]})]})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?a.jsx(z2,{className:"w-5 h-5 animate-spin"}):a.jsx(en,{className:"w-5 h-5"}),"Roll All Attributes"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([y,{value:v,baseChance:k}])=>{const _=l(y),S=o(y,v),I=h===y;return a.jsxs("div",{className:`p-4 border rounded-lg shadow-sm bg-white ${I?"bg-yellow-100 border-yellow-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-lg font-medium",children:y}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Base Chance: ",xf(S)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",min:"3",max:"18",value:v||"",onChange:j=>c(y,j.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_!==0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Age Modifier:"}),a.jsx("span",{className:_>0?"text-green-600":"text-red-600",children:_>0?`+${_}`:_})]}),v>0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Final Value:"}),a.jsx("span",{className:"font-medium text-blue-600",children:S})]})]}),(y==="STR"||y==="AGL")&&S>12&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Damage Bonus: ",yf(S)]})]},y)})}),e.kin&&Object.values(r).every(y=>y.value>0)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"Movement"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d()})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"STR Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:yf(o("STR",r.STR.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"AGL Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:yf(o("AGL",r.AGL.value))})]})]})}),e.age&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Age Modifiers Applied"}),a.jsxs("p",{className:"text-sm text-amber-700",children:[e.age==="Young"&&"Young: +1 CON, +1 AGL",e.age==="Adult"&&"Adult: No attribute modifiers",e.age==="Old"&&"Old: -2 STR, -2 CON, -2 AGL, +1 INT, +1 WIL"]})]})]})]})}function Z4(e){const[t,r]=w.useState([]),[n,s]=w.useState([]),[i,l]=w.useState(!0),[o,u]=w.useState(null);return w.useEffect(()=>{async function c(){try{l(!0),u(null);const{data:d,error:h}=await te.from("game_spells").select("*").eq("rank",0).order("name");if(h)throw h;r(d||[]);let f=te.from("game_spells").select(`
            *,
            magic_schools ( name )
          `).eq("rank",1).order("name");e?f=f.or(`school_id.is.null,school_id.eq.${e}`):f=f.is("school_id",null);const{data:g,error:p}=await f;if(p)throw p;s(g||[])}catch(d){console.error("Error loading spells:",d),u(d instanceof Error?d.message:"Failed to load spells")}finally{l(!1)}}c()},[e]),{tricks:t,spells:n,loading:i,error:o}}const bf={"6d2d7686-da89-4c42-a763-6b143c1dac60":"Elementalist","b500058b-543f-4c44-a097-911102245236":"Mentalist","e7836c1c-517a-41f8-bd71-92ba20d9c9e1":"Animist"};function X4(){var y;const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState("all"),[u,c]=w.useState(1),d=(y=e.profession)==null?void 0:y.includes("Mage"),h=d&&e.magicSchool?e.magicSchool:null;if(!d)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Only mages can learn and cast spells. Continue to the next step."})});if(h===null)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please go back to the Profession step and select a magic school before choosing spells."})]})]})});const{tricks:f,spells:g,loading:p}=Z4(h),b=(v,k)=>{k==="trick"?r.includes(v)?n(r.filter(_=>_!==v)):r.length<3&&n([...r,v]):s.includes(v)?i(s.filter(_=>_!==v)):s.length<3&&i([...s,v])},E=g.filter(v=>l==="general"?v.school_id===null:l==="school"?v.school_id===h:v.rank===u);if(p)return a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(FA,{className:"w-8 h-8 animate-spin text-blue-600"})});const x=()=>{t({spells:{general:[...r,...s.filter(v=>{var k;return((k=g.find(_=>_.name===v))==null?void 0:k.school_id)===null})],school:{name:bf[h]||"Unknown",spells:s.filter(v=>{var k;return((k=g.find(_=>_.name===v))==null?void 0:k.school_id)===h})}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Magic"}),a.jsxs("p",{className:"text-gray-600",children:["As a newly created mage, you may choose three rank 1 spells and three magic tricks. You can select spells from both General Magic and your chosen school of magic (",bf[h]||"General",")."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Your Magic School"}),a.jsx("p",{className:"text-sm text-blue-700",children:bf[h]||"General Magic"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Magic Tricks"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",r.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(v=>{var k;return a.jsxs("div",{onClick:()=>b(v.name,"trick"),className:`p-4 border rounded-lg cursor-pointer transition-all ${r.includes(v.name)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx($i,{className:`w-5 h-5 ${r.includes(v.name)?"text-purple-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((k=v.magic_schools)==null?void 0:k.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.casting_time]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Rank 1 Spells"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("select",{value:u,onChange:v=>c(parseInt(v.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[...Array(10)].map((v,k)=>a.jsxs("option",{value:k+1,children:["Rank ",k+1]},k+1))}),a.jsx(ps,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:l,onChange:v=>o(v.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Spells"}),a.jsx("option",{value:"general",children:"General Magic"}),a.jsx("option",{value:"school",children:"School Spells"})]})]})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",s.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(v=>{var k;return a.jsxs("div",{onClick:()=>b(v.name,"spell"),className:`p-4 border rounded-lg cursor-pointer transition-all ${s.includes(v.name)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx($i,{className:`w-5 h-5 ${s.includes(v.name)?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((k=v.magic_schools)==null?void 0:k.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.range]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement!=="None"&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),(r.length<3||s.length<3)&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select 3 magic tricks and 3 rank 1 spells to continue."})]})]}),a.jsxs("button",{onClick:x,disabled:r.length<3||s.length<3,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx($i,{className:"w-5 h-5"}),"Save Spell Selections"]})]})}function oE(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null);return w.useEffect(()=>{async function l(){n(!0),i(null),console.log("useSkills: Fetching skills...");try{const{data:o,error:u}=await te.from("game_skills").select("*").order("name");if(u)throw console.error("useSkills: Supabase error fetching skills:",u),new Error(u.message||"Failed to fetch skills from database");if(console.log("useSkills: Raw data received from Supabase:",o),Array.isArray(o)){let d=!1;o.forEach((h,f)=>{if(h&&typeof h=="object"){const g=Object.keys(h);g.length>0&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(g[0])&&(!("id"in h)||!("name"in h))&&(console.warn(`useSkills: Potential problematic object structure found at index ${f}:`,h),d=!0),(typeof h.id!="string"||typeof h.name!="string")&&console.warn(`useSkills: Item at index ${f} missing 'id' or 'name', or they have wrong types:`,h)}else console.warn(`useSkills: Invalid non-object item found in fetched data at index ${f}:`,h),d=!0}),d||console.log("useSkills: Initial check of fetched data structure passed.")}else console.warn("useSkills: Fetched data is not an array:",o);const c=Array.isArray(o)?o:[];t(c),console.log(`useSkills: Successfully processed and set ${c.length} skills.`)}catch(o){console.error("useSkills: Error during fetch or processing:",o);const u=o instanceof Error?o.message:"An unknown error occurred while fetching skills";i(u),t([])}finally{n(!1),console.log("useSkills: Fetch finished.")}}l()},[]),{skills:e,loading:r,error:s}}const wc=e=>{switch(e){case"Young":return 2;case"Adult":return 4;case"Old":return 6;default:return 0}},vf=["Animism","Elementalism","Mentalism"],jy=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"];function J4(){const{character:e,updateCharacter:t}=gs(),{skills:r,loading:n,error:s}=oE(),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState("profession"),[h,f]=w.useState("all"),[g,p]=w.useState([]),[b,E]=w.useState(!1),[x,y]=w.useState(null),v=w.useMemo(()=>{var A;return(A=e.profession)==null?void 0:A.toLowerCase().includes("mage")},[e.profession]),_=(A=>{if(typeof A=="string")return A;if(typeof A=="object"&&A!==null){if("name"in A&&typeof A.name=="string")return A.name;if("id"in A&&typeof A.id=="string")return A.id}return null})(e.magicSchool);w.useEffect(()=>{async function A(){if(!e.profession){p([]);return}E(!0),y(null);try{const{data:M,error:Q}=await te.from("professions").select("skills").eq("name",e.profession).single();if(Q)throw new Error(`Failed to load skills for profession: ${e.profession}. ${Q.message}`);const N=Array.isArray(M==null?void 0:M.skills)?M.skills.filter(K=>typeof K=="string"):[];p(N)}catch(M){const Q=M instanceof Error?M.message:"An unknown error occurred loading profession skills.";y(Q),p([])}finally{E(!1)}}A()},[e.profession]);const S=w.useMemo(()=>n||b||!Array.isArray(r)||!Array.isArray(g)?[]:r.filter(A=>A&&typeof A.name=="string"&&g.includes(A.name)),[r,n,b,g]),I=w.useMemo(()=>{if(n||!Array.isArray(r))return[];let A=r.filter(M=>!(!M||typeof M.name!="string"||i.includes(M.name)));switch(v||(A=A.filter(M=>!vf.includes(M.name))),h){case"combat":return A.filter(M=>jy.includes(M.name));case"general":return A.filter(M=>!jy.includes(M.name)&&!vf.includes(M.name));case"magic":return v?A.filter(M=>vf.includes(M.name)):[];case"all":default:return A}},[r,n,i,h,v]);w.useEffect(()=>{if(e.trainedSkills&&!Array.isArray(e.trainedSkills))console.error("CRITICAL: character.trainedSkills in store is not an array!",e.trainedSkills);else if(e.trainedSkills){const A=e.trainedSkills.filter(M=>typeof M!="string");A.length>0&&console.error("CRITICAL: character.trainedSkills in store contains non-string items!",A)}},[e.trainedSkills]);const j=(A,M)=>{if(typeof A!="string"||!A){console.error("Invalid skillName passed to handleSkillSelection:",A);return}if(M==="profession")i.includes(A)?l(N=>N.filter(K=>K!==A)):i.length<6&&l(N=>[...N,A]);else{const Q=wc(e.age||"");o.includes(A)?u(N=>N.filter(K=>K!==A)):o.length<Q&&u(N=>[...N,A])}},D=()=>{if(c==="profession"&&i.length===6)d("additional");else if(c==="additional"&&o.length===wc(e.age||"")){const A=[...new Set([...i,...o])];A.every(M=>typeof M=="string")?(t({trainedSkills:A}),console.log("Skills saved to character state (names):",A)):console.error("CRITICAL: Attempted to save non-string skills to character state!",A)}},T=(A,M)=>{if(!A||typeof A!="object"||typeof A.id!="string"||typeof A.name!="string")return console.error("Invalid skill object passed to renderSkillCard:",A),a.jsx("div",{className:"p-4 border border-red-500 rounded-lg bg-red-50 text-red-700",children:"Invalid Skill Data"});const Q=A.name,N=typeof A.description=="string"?A.description:null,K=typeof A.attribute=="string"?A.attribute:null,$=M==="profession"?i.includes(Q):o.includes(Q),R=i.length>=6,me=o.length>=wc(e.age||""),ce=M==="profession"&&R&&!$||M==="additional"&&me&&!$;return a.jsxs("div",{onClick:()=>!ce&&j(Q,M),className:`p-4 border rounded-lg transition-all ${ce?"bg-gray-100 opacity-60 cursor-not-allowed":"cursor-pointer"} ${$?"border-blue-500 bg-blue-50 ring-1 ring-blue-500":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(au,{className:`w-5 h-5 flex-shrink-0 ${$?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h5",{className:"font-medium",children:Q}),K&&a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:K})]})]}),N&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N})]},A.id)};if(n)return a.jsx(Ge,{size:"lg",className:"my-8"});if(s)return a.jsx(Ie,{message:`Skills Error: ${s}`,onClose:()=>{}});if(!e.profession||!e.age)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession and age first."})});if(v&&!e.magicSchool)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"As a Mage, please select a magic school first."})]})]})});const B=i.length,O=o.length,Y=6,G=wc(e.age),z=B===Y,H=O===G;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Select Skills"}),e.profession&&a.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-sm",children:[a.jsxs("p",{className:"text-indigo-800",children:["Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&` (Key Attribute: ${e.key_attribute})`,v&&_&&` (School: ${_})`]}),a.jsxs("p",{className:"text-indigo-700 mt-1",children:["Age: ",a.jsx("strong",{children:e.age})," (Grants ",G," additional skill points)"]})]}),a.jsxs("p",{className:"text-gray-600 text-sm",children:[c==="profession"?`Choose ${Y} skills from your profession's list below.`:`Choose ${G} additional skills based on your age (${e.age}).`,v&&c==="additional"&&" Magic skills are now available.",!v&&c==="additional"&&" Magic skills are not available for your profession."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Selection Progress"}),a.jsx("p",{className:"text-sm text-blue-700",children:c==="profession"?`Professional Skills: ${B}/${Y}`:`Additional Skills: ${O}/${G}`})]})]}),c==="additional"&&a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx(ps,{className:"w-4 h-4 text-gray-500"}),a.jsx("label",{htmlFor:"skillFilter",className:"text-sm font-medium text-gray-700",children:"Filter:"}),a.jsxs("select",{id:"skillFilter",value:h,onChange:A=>f(A.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Available"}),a.jsx("option",{value:"combat",children:"Combat"}),a.jsx("option",{value:"general",children:"General"}),v&&a.jsx("option",{value:"magic",children:"Magic"})]})]}),c==="profession"&&b&&a.jsx(Ge,{size:"md",className:"my-4"}),c==="profession"&&x&&a.jsx(Ie,{message:`Profession Skills Error: ${x}`,onClose:()=>y(null)}),!b&&!x&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c==="profession"&&(Array.isArray(S)?S.map(A=>T(A,"profession")):(console.error("Error: availableProfessionSkillsData is not an array!",S),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Profession skills data is not an array."}))),c==="additional"&&(Array.isArray(I)?I.map(A=>T(A,"additional")):(console.error("Error: remainingSkillsData is not an array!",I),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Remaining skills data is not an array."}))),c==="profession"&&S.length===0&&!b&&!x&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No specific skills found for the selected profession, or skills failed to load."}),c==="additional"&&I.length===0&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No skills match the current filter or selection."})]}),(c==="profession"&&!z&&B>0||c==="additional"&&!H&&O>0)&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:c==="profession"?`Please select ${Y-B} more professional skill(s).`:`Please select ${G-O} more additional skill(s).`})]})]}),a.jsxs("button",{onClick:D,disabled:c==="profession"&&!z||c==="additional"&&!H||b,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[b?a.jsx(Os,{className:"w-5 h-5 animate-spin"}):a.jsx(au,{className:"w-5 h-5"}),c==="profession"?"Continue to Additional Skills":"Confirm Skill Selections"]})]})}function uE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=uE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function cE(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=uE(e))&&(n&&(n+=" "),n+=t);return n}const Ay=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Iy=cE,e6=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Iy(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(c=>{const d=r==null?void 0:r[c],h=i==null?void 0:i[c];if(d===null)return null;const f=Ay(d)||Ay(h);return s[c][f]}),o=r&&Object.entries(r).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,d)=>{let{class:h,className:f,...g}=d;return Object.entries(g).every(p=>{let[b,E]=p;return Array.isArray(E)?E.includes({...i,...o}[b]):{...i,...o}[b]===E})?[...c,h,f]:c},[]);return Iy(e,l,u,r==null?void 0:r.class,r==null?void 0:r.className)},Q0="-",t6=e=>{const t=n6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(Q0);return o[0]===""&&o.length!==1&&o.shift(),dE(o,t)||r6(l)},getConflictingClassGroupIds:(l,o)=>{const u=r[l]||[];return o&&n[l]?[...u,...n[l]]:u}}},dE=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?dE(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(Q0);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},Ry=/^\[(.+)\]$/,r6=e=>{if(Ry.test(e)){const t=Ry.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},n6=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return a6(Object.entries(e.classGroups),r).forEach(([i,l])=>{cp(l,n,i,t)}),n},cp=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:Ly(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(s6(s)){cp(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{cp(l,Ly(t,i),r,n)})})},Ly=(e,t)=>{let r=e;return t.split(Q0).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},s6=e=>e.isThemeGetter,a6=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,i6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},hE="!",l6=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const u=[];let c=0,d=0,h;for(let E=0;E<o.length;E++){let x=o[E];if(c===0){if(x===s&&(n||o.slice(E,E+i)===t)){u.push(o.slice(d,E)),d=E+i;continue}if(x==="/"){h=E;continue}}x==="["?c++:x==="]"&&c--}const f=u.length===0?o:o.substring(d),g=f.startsWith(hE),p=g?f.substring(1):f,b=h&&h>d?h-d:void 0;return{modifiers:u,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:l}):l},o6=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},u6=e=>({cache:i6(e.cacheSize),parseClassName:l6(e),...t6(e)}),c6=/\s+/,d6=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(c6);let o="";for(let u=l.length-1;u>=0;u-=1){const c=l[u],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:g}=r(c);let p=!!g,b=n(p?f.substring(0,g):f);if(!b){if(!p){o=c+(o.length>0?" "+o:o);continue}if(b=n(f),!b){o=c+(o.length>0?" "+o:o);continue}p=!1}const E=o6(d).join(":"),x=h?E+hE:E,y=x+b;if(i.includes(y))continue;i.push(y);const v=s(b,p);for(let k=0;k<v.length;++k){const _=v[k];i.push(x+_)}o=c+(o.length>0?" "+o:o)}return o};function h6(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=fE(t))&&(n&&(n+=" "),n+=r);return n}const fE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=fE(e[n]))&&(r&&(r+=" "),r+=t);return r};function f6(e,...t){let r,n,s,i=l;function l(u){const c=t.reduce((d,h)=>h(d),e());return r=u6(c),n=r.cache.get,s=r.cache.set,i=o,o(u)}function o(u){const c=n(u);if(c)return c;const d=d6(u,r);return s(u,d),d}return function(){return i(h6.apply(null,arguments))}}const ft=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},mE=/^\[(?:([a-z-]+):)?(.+)\]$/i,m6=/^\d+\/\d+$/,p6=new Set(["px","full","screen"]),g6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,x6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,y6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,b6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,v6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Wn=e=>qi(e)||p6.has(e)||m6.test(e),bs=e=>Rl(e,"length",C6),qi=e=>!!e&&!Number.isNaN(Number(e)),wf=e=>Rl(e,"number",qi),Kl=e=>!!e&&Number.isInteger(Number(e)),w6=e=>e.endsWith("%")&&qi(e.slice(0,-1)),Be=e=>mE.test(e),vs=e=>g6.test(e),E6=new Set(["length","size","percentage"]),_6=e=>Rl(e,E6,pE),N6=e=>Rl(e,"position",pE),k6=new Set(["image","url"]),S6=e=>Rl(e,k6,A6),T6=e=>Rl(e,"",j6),Zl=()=>!0,Rl=(e,t,r)=>{const n=mE.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},C6=e=>x6.test(e)&&!y6.test(e),pE=()=>!1,j6=e=>b6.test(e),A6=e=>v6.test(e),I6=()=>{const e=ft("colors"),t=ft("spacing"),r=ft("blur"),n=ft("brightness"),s=ft("borderColor"),i=ft("borderRadius"),l=ft("borderSpacing"),o=ft("borderWidth"),u=ft("contrast"),c=ft("grayscale"),d=ft("hueRotate"),h=ft("invert"),f=ft("gap"),g=ft("gradientColorStops"),p=ft("gradientColorStopPositions"),b=ft("inset"),E=ft("margin"),x=ft("opacity"),y=ft("padding"),v=ft("saturate"),k=ft("scale"),_=ft("sepia"),S=ft("skew"),I=ft("space"),j=ft("translate"),D=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto",Be,t],O=()=>[Be,t],Y=()=>["",Wn,bs],G=()=>["auto",qi,Be],z=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],A=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",Be],N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[qi,Be];return{cacheSize:500,separator:":",theme:{colors:[Zl],spacing:[Wn,bs],blur:["none","",vs,Be],brightness:K(),borderColor:[e],borderRadius:["none","","full",vs,Be],borderSpacing:O(),borderWidth:Y(),contrast:K(),grayscale:Q(),hueRotate:K(),invert:Q(),gap:O(),gradientColorStops:[e],gradientColorStopPositions:[w6,bs],inset:B(),margin:B(),opacity:K(),padding:O(),saturate:K(),scale:K(),sepia:Q(),skew:K(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",Be]}],container:["container"],columns:[{columns:[vs]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...z(),Be]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Kl,Be]}],basis:[{basis:B()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Be]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Kl,Be]}],"grid-cols":[{"grid-cols":[Zl]}],"col-start-end":[{col:["auto",{span:["full",Kl,Be]},Be]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Zl]}],"row-start-end":[{row:["auto",{span:[Kl,Be]},Be]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Be]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Be]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Be,t]}],"min-w":[{"min-w":[Be,t,"min","max","fit"]}],"max-w":[{"max-w":[Be,t,"none","full","min","max","fit","prose",{screen:[vs]},vs]}],h:[{h:[Be,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Be,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Be,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Be,t,"auto","min","max","fit"]}],"font-size":[{text:["base",vs,bs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",wf]}],"font-family":[{font:[Zl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Be]}],"line-clamp":[{"line-clamp":["none",qi,wf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Wn,Be]}],"list-image":[{"list-image":["none",Be]}],"list-style-type":[{list:["none","disc","decimal",Be]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Wn,bs]}],"underline-offset":[{"underline-offset":["auto",Wn,Be]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...z(),N6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",_6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},S6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:H()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[Wn,Be]}],"outline-w":[{outline:[Wn,bs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Wn,bs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",vs,T6]}],"shadow-color":[{shadow:[Zl]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...A(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":A()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",vs,Be]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[v]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Be]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",Be]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",Be]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Kl,Be]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Be]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Be]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Be]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Wn,bs,wf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},R6=f6(I6);function L6(...e){return R6(cE(e))}const xl=e=>{if(typeof e=="string")try{const t=JSON.parse(e);if(typeof t=="object"&&t!==null){const r={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=Number(t[n]);isNaN(s)||(r[n]=s)}return r}return{}}catch(t){return console.error("[parseSkillLevels] Error parsing skill_levels JSON string:",t),{}}else if(typeof e=="object"&&e!==null){const t={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=Number(e[r]);isNaN(n)||(t[r]=n)}return t}return{}},O6=e6("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",danger:"bg-red-600 text-white hover:bg-red-700",danger_outline:"border border-red-500 text-red-600 hover:bg-red-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"primary",size:"default"}}),q=Kr.forwardRef(({className:e,variant:t,size:r,icon:n,iconPosition:s="left",fullWidth:i,loading:l,children:o,...u},c)=>{const d=l||u.disabled;return a.jsxs("button",{className:L6(O6({variant:t,size:r,className:e}),i&&"w-full",l&&"relative"),ref:c,disabled:d,...u,children:[l&&a.jsx(Os,{className:`animate-spin h-4 w-4 ${o?s==="left"?"mr-2":"ml-2":""}`}),!l&&n&&s==="left"&&a.jsx(n,{className:`h-4 w-4 ${o?"mr-2":""}`}),!l&&o,!l&&n&&s==="right"&&a.jsx(n,{className:`h-4 w-4 ${o?"ml-2":""}`})]})});q.displayName="Button";async function gh(e){let t=te.from("game_items").select("*");e&&e!=="all"&&typeof e=="string"&&(t=t.eq("category",e.toUpperCase()));const{data:r,error:n}=await t.order("category").order("name");if(n)throw console.error("Error fetching game items:",n),new Error(n.message||"Failed to fetch game items");return r||[]}function Oy(e){const t={gold:0,silver:0,copper:0};if(!e||typeof e!="string")return t;const r=e.toLowerCase().split(/,\s*|\s+/);for(let n=0;n<r.length;n++){const s=parseInt(r[n]);if(!isNaN(s)&&n+1<r.length){const i=r[n+1];i.startsWith("gold")||i.startsWith("g")?(t.gold=s,n++):i.startsWith("silver")||i.startsWith("s")?(t.silver=s,n++):(i.startsWith("copper")||i.startsWith("c"))&&(t.copper=s,n++)}}return gE(t)}function P6(e){if(!e)return"0 copper";const t=[];return e.gold>0&&t.push(`${e.gold} gold`),e.silver>0&&t.push(`${e.silver} silver`),e.copper>0&&t.push(`${e.copper} copper`),t.length>0?t.join(", "):"0 copper"}function gE(e){let{gold:t,silver:r,copper:n}=e;return r+=Math.floor(n/100),n%=100,t+=Math.floor(r/100),r%=100,{gold:t,silver:r,copper:n}}function D6(e,t){const r=e.gold*1e4+e.silver*100+e.copper,n=t.gold*1e4+t.silver*100+t.copper;if(r<n)return{success:!1,newMoney:e};let s=r-n;const i=Math.floor(s/1e4);s%=1e4;const l=Math.floor(s/100);return s%=100,{success:!0,newMoney:{gold:i,silver:l,copper:s}}}function M6(){var T,B;const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState({}),[f,g]=w.useState(!0),[p,b]=w.useState(""),{data:E=[],isLoading:x,error:y}=Rt({queryKey:["gameItems"],queryFn:gh,staleTime:1e3*60*10});w.useEffect(()=>{async function O(){if(!e.profession){b("Profession not selected."),g(!1);return}try{g(!0),b("");const{data:Y,error:G}=await te.from("professions").select("starting_equipment, equipment_description").eq("name",e.profession).single();if(G)throw G;if(Y){const z=Y,H=(z.starting_equipment||[]).map((A,M)=>({option:M+1,items:A.split(",").map(Q=>Q.trim()).filter(Boolean),description:(z.equipment_description||[])[M]||""}));i(H)}else i([])}catch(Y){console.error("Error fetching equipment options:",Y),b("Failed to load equipment options.")}finally{g(!1)}}O()},[e.profession]);const v=O=>{const G=O.split(" or ")[0].trim().replace(/^\d+\s+/,"");return E.find(z=>z.name===G)},k=O=>{const Y=O.match(/^(\d*D\d+)/i);if(!Y)return null;const G=Y[1],z=G.toUpperCase().split("D"),H=z[0]===""?1:parseInt(z[0]),A=parseInt(z[1]),M=O.slice(G.length).trim();return{count:H,sides:A,rest:M}},_=(O,Y)=>{let G=0;for(let z=0;z<O;z++)G+=Math.floor(Math.random()*Y)+1;return G},S=O=>{n(O),o(!1)},I=()=>{var G,z;if(r===null)return;const O=s.find(H=>H.option===r);if(!O)return;if(O.items.some(H=>k(H)||H.toLowerCase().includes(" or "))){const H=O.items.reduce((A,M,Q)=>{if(M.toLowerCase().includes(" or ")){const N=M.split(/\s+or\s+/i).map(K=>K.trim());A[Q]=N[0]}else A[Q]="";return A},{});h(H),c(!0)}else{const H=((G=e.equipment)==null?void 0:G.money)||{gold:0,silver:0,copper:0};t({startingEquipment:{option:r,items:O.items},equipment:{money:H,equipped:((z=e.equipment)==null?void 0:z.equipped)||{weapons:[]},inventory:[...O.items]}}),o(!0)}},j=()=>{var H,A;if(r===null)return;const O=s.find(M=>M.option===r);if(!O)return;const G={...((H=e.equipment)==null?void 0:H.money)||{gold:0,silver:0,copper:0}},z=[];O.items.forEach((M,Q)=>{if(M.toLowerCase().includes(" or ")){const N=d[Q]||M.split(/\s+or\s+/i)[0].trim();z.push(N)}else{const N=k(M);if(N){const K=d[Q]?parseInt(d[Q]):_(N.count,N.sides),$=N.rest.toLowerCase();$.includes("gold")?G.gold+=K:$.includes("silver")?G.silver+=K:$.includes("copper")?G.copper+=K:z.push(`${K} ${N.rest}`)}else z.push(M)}}),t({startingEquipment:{option:r,items:z},equipment:{money:gE(G),equipped:((A=e.equipment)==null?void 0:A.equipped)||{weapons:[]},inventory:[...z]}}),c(!1),o(!0)},D=r!==null&&((T=s.find(O=>O.option===r))==null?void 0:T.items.every((O,Y)=>O.toLowerCase().includes(" or ")||k(O)?!!d[Y]:!0));return f||x?a.jsx(Ge,{}):p||y?a.jsx(Ie,{message:p||(y==null?void 0:y.message)||"Failed to load data."}):e.profession?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Starting Equipment"}),a.jsxs("p",{className:"text-gray-600",children:["Select one of the available equipment packages for your ",e.profession,"."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Equipment Selection"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Choose carefully  this will be your starting gear. Items with ",a.jsx(gy,{className:"inline w-4 h-4 text-amber-600"})," require a dice roll, items with ",a.jsx(vy,{className:"inline w-4 h-4 text-purple-600"})," offer a choice."]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(O=>a.jsxs("div",{onClick:()=>S(O.option),className:`p-6 border rounded-lg cursor-pointer transition-all ${r===O.option?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(iu,{className:"w-6 h-6 text-gray-500"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold",children:["Option ",O.option]}),a.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Equipment List:"}),a.jsx("ul",{className:"space-y-1",children:O.items.map((Y,G)=>{const z=!!k(Y),H=Y.toLowerCase().includes(" or "),A=v(Y);return a.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-600 group relative",children:[z?a.jsx(gy,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):H?a.jsx(vy,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):a.jsx(au,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a.jsx("span",{children:Y}),(A==null?void 0:A.effect)&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 max-w-xs",children:[A.effect," (W: ",A.weight,", Cost: ",A.cost,")"]})]},G)})})]}),r===O.option&&a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[a.jsx(au,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Selected"})]})]},O.option))}),!r&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Equipment Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select a starting equipment package."})]})]}),a.jsxs("button",{onClick:I,disabled:!r||l,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${l?"bg-green-600 text-white cursor-default":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[a.jsx(I2,{className:"w-5 h-5"}),l?"Equipment Confirmed":"Confirm Equipment Selection"]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Resolve Dice Rolls & Selections"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),(((B=s.find(O=>O.option===r))==null?void 0:B.items)||[]).map((O,Y)=>{if(O.toLowerCase().includes(" or ")){const z=O.split(/\s+or\s+/i).map(H=>H.trim());return a.jsxs("div",{className:"mb-4 p-3 border rounded bg-purple-50 border-purple-200",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:O}),a.jsxs("select",{value:d[Y]||"",onChange:H=>h(A=>({...A,[Y]:H.target.value})),className:"mt-1 w-full border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select one..."}),z.map((H,A)=>a.jsx("option",{value:H,children:H},A))]})]},Y)}const G=k(O);return G?a.jsxs("div",{className:"mb-4 p-3 border rounded bg-amber-50 border-amber-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium",children:O}),a.jsxs(q,{size:"sm",variant:"secondary",onClick:()=>{const z=_(G.count,G.sides);h(H=>({...H,[Y]:z.toString()}))},children:["Roll ",G.count,"D",G.sides]})]}),a.jsx("input",{type:"number",min:G.count,max:G.count*G.sides,value:d[Y]||"",onChange:z=>{const H=z.target.value;if(H==="")h(A=>({...A,[Y]:""}));else{const A=parseInt(H);if(!isNaN(A)){const M=Math.max(G.count,Math.min(G.count*G.sides,A));h(Q=>({...Q,[Y]:M.toString()}))}}},className:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:`Enter result (${G.count}-${G.count*G.sides})`})]},Y):null}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(q,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),a.jsx(q,{variant:"primary",onClick:j,disabled:!D,children:"Confirm Rolls/Choices"})]})]})})]}):a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession before choosing equipment."})})}const F6=["Short","Below Average","Average","Above Average","Tall"],U6=["Slight","Lean","Average","Athletic","Muscular","Heavy"],B6=["Black","Brown","Blonde","Red","Gray","White","Other"],H6=["Short","Medium","Long","Braided","Curly","Straight","Bald"],$6=["Brown","Blue","Green","Gray","Hazel","Other"],z6=["Fair","Light","Medium","Tan","Dark","Other"];function q6(){const{character:e,updateCharacter:t}=gs(),[r,n]=w.useState({height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",distinctiveFeatures:"",clothing:""}),s=()=>{const o=[];return r.height&&r.build&&o.push(`A ${r.height.toLowerCase()}, ${r.build.toLowerCase()} individual`),r.hairStyle&&r.hairColor&&(r.hairStyle.toLowerCase()==="bald"?o.push("Bald"):o.push(`${r.hairStyle.toLowerCase()} ${r.hairColor.toLowerCase()} hair`)),r.eyeColor&&o.push(`${r.eyeColor.toLowerCase()} eyes`),r.skinTone&&o.push(`${r.skinTone.toLowerCase()} skin`),r.distinctiveFeatures&&o.push(r.distinctiveFeatures),r.clothing&&o.push(`Typically wearing ${r.clothing}`),o.join(". ")+"."},i=()=>{const o=s();t({appearance:o})},l=()=>r.height&&r.build&&r.hairColor&&r.hairStyle&&r.eyeColor&&r.skinTone&&r.distinctiveFeatures&&r.clothing;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Appearance"}),a.jsx("p",{className:"text-gray-600",children:"Describe your character's physical appearance. This will help bring your character to life during gameplay."})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Character Details"}),a.jsxs("p",{className:"text-sm text-blue-700",children:[e.kin,"  ",e.age,"  ",e.profession]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(qA,{className:"w-5 h-5 text-gray-500"}),"Physical Characteristics"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),a.jsxs("select",{value:r.height,onChange:o=>n({...r,height:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select height..."}),F6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build"}),a.jsxs("select",{value:r.build,onChange:o=>n({...r,build:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select build..."}),U6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(Il,{className:"w-5 h-5 text-gray-500"}),"Hair and Face"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Color"}),a.jsxs("select",{value:r.hairColor,onChange:o=>n({...r,hairColor:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select color..."}),B6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Style"}),a.jsxs("select",{value:r.hairStyle,onChange:o=>n({...r,hairStyle:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select style..."}),H6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eye Color"}),a.jsxs("select",{value:r.eyeColor,onChange:o=>n({...r,eyeColor:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select color..."}),$6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skin Tone"}),a.jsxs("select",{value:r.skinTone,onChange:o=>n({...r,skinTone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select tone..."}),z6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx($i,{className:"w-5 h-5 text-gray-500"}),"Distinctive Features"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notable Features"}),a.jsx("textarea",{value:r.distinctiveFeatures,onChange:o=>n({...r,distinctiveFeatures:o.target.value}),placeholder:"Scars, tattoos, birthmarks, or other distinctive features...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(H2,{className:"w-5 h-5 text-gray-500"}),"Clothing Style"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Typical Attire"}),a.jsx("textarea",{value:r.clothing,onChange:o=>n({...r,clothing:o.target.value}),placeholder:"Describe your character's typical clothing and style...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]})]})]}),l()&&a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Appearance Preview"}),a.jsx("p",{className:"text-green-700",children:s()})]}),!l()&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Description"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please fill in all appearance details to continue."})]})]}),a.jsxs("button",{onClick:i,disabled:!l(),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Fr,{className:"w-5 h-5"}),"Save Appearance"]})]})}const Xl=[{title:"Kin",component:$4},{title:"Profession",component:W4},{title:"Name & Age",component:G4},{title:"Attributes",component:K4},{title:"Magic",component:X4},{title:"Trained Skills",component:J4},{title:"Gear",component:M6},{title:"Appearance",component:q6}],V6=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,xE={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR"},W6=Object.keys(xE);function G6(){const{user:e}=Mt(),{step:t,setStep:r,character:n,resetCharacter:s}=gs(),[i,l]=Kr.useState(null),[o,u]=Kr.useState(!1),c=rn(),d=tn(),h=Xl[t].component,f=()=>{var p;switch(t){case 0:return!!n.kin&&n.kinAbilityNames!==void 0&&n.kinAbilityNames.length>0;case 1:const b=n.magicSchool!==null&&n.magicSchool!==void 0;return!!n.profession&&(b||n.professionHeroicAbilityName!==void 0);case 2:return!!n.name&&n.name.trim().length>0&&!!n.age;case 3:return n.attributes&&Object.values(n.attributes).every(E=>E>0);case 4:return n.magicSchool?((p=n.spells)==null?void 0:p.general)&&n.spells.general.length>=3:!0;case 5:return n.trainedSkills&&n.trainedSkills.length>=6&&!!n.attributes;case 6:return n.startingEquipment&&n.startingEquipment.items.length>=0;case 7:return!!n.appearance&&n.appearance.trim().length>0;default:return!1}},g=async()=>{var p,b,E,x;if(!e){l("You must be logged in to create a character");return}if(!f()){l("Please complete all required fields for the final step before saving.");return}if(!n.attributes){l("Attributes must be set before saving.");return}try{u(!0),l(null),console.log("[CharacterSave] Starting character save process...");const y={},v=new Set(n.trainedSkills||[]);W6.forEach(D=>{var G;const T=xE[D];if(!T){console.warn(`[CharacterSave] Missing attribute mapping for skill: ${D}`);return}const B=((G=n.attributes)==null?void 0:G[T])??0,O=V6(B),Y=v.has(D);y[D]=Y?O*2:O}),console.log("[CharacterSave] Calculated initial skill levels:",y);const k=[...n.kinAbilityNames||[],...n.professionHeroicAbilityName?[n.professionHeroicAbilityName]:[]].filter(Boolean);console.log("[CharacterSave] Combined heroic abilities:",k);const _={user_id:e.id,name:(p=n.name)==null?void 0:p.trim(),kin:n.kin,profession:n.profession,magic_school:n.magicSchool,age:n.age,attributes:n.attributes,trained_skills:n.trainedSkills||[],other_skills:n.otherSkills||[],skill_levels:y,equipment:n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},appearance:(b=n.appearance)==null?void 0:b.trim(),conditions:n.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},spells:n.spells||null,starting_equipment:n.startingEquipment||{items:[],money:{gold:0,silver:0,copper:0}},experience:{marked_skills:[]},current_hp:((E=n.attributes)==null?void 0:E.CON)??10,current_wp:((x=n.attributes)==null?void 0:x.WIL)??10,heroic_ability:k};console.log("[CharacterSave] Prepared character data for insert:",_),Object.keys(_).forEach(D=>{_[D]===void 0&&(console.warn(`[CharacterSave] Removing undefined key: ${D}`),delete _[D])}),console.log("[CharacterSave] Inserting character into Supabase...");const{data:S,error:I}=await te.from("characters").insert(_).select().single();if(I)throw console.error("[CharacterSave] Supabase insert error:",I),I;if(!S)throw console.error("[CharacterSave] Character insert succeeded but no data returned."),new Error("Character not created or data not returned.");console.log("[CharacterSave] Character saved successfully:",S),console.log("[CharacterSave] Invalidating characters query cache..."),await d.invalidateQueries({queryKey:["characters",e.id]}),await d.invalidateQueries({queryKey:["characters"]}),console.log("[CharacterSave] Resetting character creation store..."),s();const j=S.id;console.log(`[CharacterSave] Navigating to /characters/${j}`),c(`/characters/${j}`)}catch(y){console.error("[CharacterSave] Save process failed:",y);const v=y instanceof Error?y.message:"Failed to save character";if(v.includes("violates check constraint")&&v.includes("attributes_check"))l("Failed to save character: Invalid attribute values. Please ensure all attributes are set correctly.");else if(v.includes("violates not-null constraint")){const k=v.match(/null value in column "(\w+)"/),_=k?k[1]:"a required field";l(`Failed to save character: ${_} is missing. Please review your selections. Details: ${v}`)}else v.includes("unique constraint")?l("Failed to save character: A character with this name might already exist or another unique field conflicts."):l(`Failed to save character: ${v}`)}finally{console.log("[CharacterSave] Save process finished (finally block)."),u(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-8 my-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Create New Character"}),a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Step ",t+1," of ",Xl.length]})]}),a.jsx("div",{className:"flex space-x-1",children:Xl.map((p,b)=>a.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden bg-gray-200",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${b<t?"bg-blue-500":b===t?"bg-blue-300":"bg-gray-200"}`,style:{width:b===t?"50%":"100%"}})},p.title))}),a.jsx("p",{className:"text-center text-lg font-semibold mt-3 text-gray-700",children:Xl[t].title})]}),i&&a.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-red-50 border border-red-300 rounded-lg shadow-sm",children:[a.jsx(Nt,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Creation Error"}),a.jsx("p",{className:"text-sm text-red-700",children:i})]})]}),a.jsxs("div",{className:"min-h-[400px] mb-8",children:[" ",a.jsx(h,{})]}),a.jsxs("div",{className:"flex justify-between items-center mt-8 border-t pt-6",children:[a.jsx("button",{onClick:()=>r(t-1),disabled:t===0||o,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t===Xl.length-1?a.jsxs("button",{onClick:g,disabled:!f()||o,className:`inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":f()?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"}`,children:[a.jsx(Fr,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Saving Character...":"Create Character"]}):a.jsx("button",{onClick:()=>r(t+1),disabled:!f()||o,className:`inline-flex items-center px-5 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":f()?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Next Step"})]})]})}function dp({icon:e,title:t,description:r,action:n}){return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 mb-6",children:r}),n]})}const Ll=e=>{const t={STR:10,AGL:10,INT:10,CON:10,WIL:10,CHA:10},r=e.attributes||{},n={STR:r.strength??r.STR??t.STR,AGL:r.agility??r.AGL??t.AGL,INT:r.intelligence??r.INT??t.INT,CHA:r.charisma??r.CHA??t.CHA,CON:r.constitution??r.CON??t.CON,WIL:r.willpower??r.WIL??t.WIL},s=n.CON,i=n.WIL,l=e.equipment||{},o=l.inventory||[],u=l.equipped||{weapons:[]},c=l.money||{gold:0,silver:0,copper:0};let d=e.teacher;return typeof d!="object"||d===null?d=null:d.skillUnderStudy===void 0&&(d={...d,skillUnderStudy:null}),{id:e.id,user_id:e.user_id,name:e.name,kin:e.kin,profession:e.profession,magicSchool:e.magic_school,age:e.age,attributes:n,max_hp:s,current_hp:e.current_hp??s,max_wp:i,current_wp:e.current_wp??i,movement:e.movement??10,damage_bonus:e.damage_bonus??0,conditions:e.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},equipment:{inventory:o,equipped:u,money:c},trainedSkills:e.trained_skills||[],untrainedSkills:e.other_skills||[],heroic_ability:e.heroic_ability||[],spells:e.spells||{school:null,general:[]},prepared_spells:e.prepared_spells||[],experience:e.experience??0,reputation:e.reputation??0,corruption:e.corruption??0,notes:e.notes??"",created_at:e.created_at,updated_at:e.updated_at,party_id:e.party_id,is_npc:e.is_npc??!1,key_attribute:e.key_attribute,death_rolls_failed:e.death_rolls_failed??0,death_rolls_passed:e.death_rolls_passed??0,appearance:e.appearance??"",skill_levels:e.skill_levels||{},teacher:d}};async function Y6(e){if(!e)return[];const{data:t,error:r}=await te.from("characters").select(`
      *
    `).eq("user_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching characters:",r),new Error(r.message||"Failed to fetch characters");return(t||[]).map(Ll)}async function Q6(e,t){if(!e)return null;const r=te.from("characters").select(`
      *
    `).eq("id",e),{data:n,error:s}=await r.maybeSingle();if(s&&(console.error("Error fetching character by ID:",s),s.code!=="PGRST116"))throw new Error(s.message||"Failed to fetch character");return n?Ll(n):null}async function K6(e,t){const r={},n={untrainedSkills:"other_skills",trainedSkills:"trained_skills"};for(const l in t)if(Object.prototype.hasOwnProperty.call(t,l)){const o=t[l],u=n[l]||l;r[u]=o}r.updated_at=new Date().toISOString();const{data:s,error:i}=await te.from("characters").update(r).eq("id",e).select(`
      *
    `).single();if(i)throw console.error("Error updating character:",i),i.code==="PGRST116"?(console.error(`Update failed: Character ${e} not found or RLS prevented access.`),new Error(`Character ${e} not found or update permission denied.`)):new Error(i.message||"Failed to update character");return s?Ll(s):(console.error(`Update seemed successful but no data returned for character ${e}.`),null)}async function Z6(e){if(e.length===0)return;const{error:t}=await te.from("characters").delete().in("id",e);if(t)throw console.error("Error deleting characters:",t),new Error(t.message||"Failed to delete characters")}const yE=Kr.forwardRef(({className:e,...t},r)=>a.jsx("input",{ref:r,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed ${e}`,...t}));yE.displayName="Input";function X6({isOpen:e,onClose:t,onJoin:r}){const[n,s]=w.useState(""),[i,l]=w.useState(""),[o,u]=w.useState(!1),c=async()=>{l("");const h=n.match(/party\/join\/([^/?]+)/);if(h&&h[1]){const f=h[1];u(!0);try{await r(f),d()}catch(g){console.error("Join operation failed:",g)}finally{u(!1)}}else l("Invalid party invite link. Please paste the full link.")},d=()=>{s(""),l(""),u(!1),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity","aria-labelledby":"join-party-title",role:"dialog","aria-modal":"true",onClick:d,children:a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md m-4 transform transition-all",onClick:h=>h.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{id:"join-party-title",className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(W0,{className:"w-6 h-6 text-blue-600"}),"Join an Adventure Party"]}),a.jsx("button",{onClick:d,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600","aria-label":"Close dialog",disabled:o,children:a.jsx(Lt,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Paste the invite link you received from your Dungeon Master to join their party."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party-link",className:"sr-only",children:"Party Invite Link"}),a.jsx(yE,{id:"party-link",type:"text",value:n,onChange:h=>s(h.target.value),placeholder:"https://.../party/join/...",className:"w-full","aria-describedby":"link-error",disabled:o}),i&&a.jsx("p",{id:"link-error",className:"text-red-500 text-sm mt-2",children:i})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(q,{variant:"secondary",onClick:d,disabled:o,children:"Cancel"}),a.jsx(q,{variant:"primary",onClick:c,disabled:!n||o,children:o?"Joining...":"Join Party"})]})]})}):null}function hp({isOpen:e,onClose:t,onConfirm:r,title:n,description:s,confirmText:i="Confirm",cancelText:l="Cancel",isLoading:o=!1,isDestructive:u=!1,icon:c}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[c&&a.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${u?"bg-red-100":"bg-blue-100"}`,children:c}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",id:"modal-title",children:n}),a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:s})})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3",children:[a.jsx(q,{variant:"secondary",onClick:t,disabled:o,className:"mt-3 sm:mt-0 w-full sm:w-auto",children:l}),a.jsx(q,{variant:u?"danger":"primary",onClick:r,loading:o,className:"w-full sm:w-auto",children:i})]})]})}):null}function J6(){const{user:e}=Mt(),t=rn(),r=tn(),[n,s]=w.useState(!1),[i,l]=w.useState(!1),[o,u]=w.useState([]),[c,d]=w.useState(!1),{data:h=[],isLoading:f,error:g}=Rt({queryKey:["characters",e==null?void 0:e.id],queryFn:()=>Y6(e==null?void 0:e.id),enabled:!!e}),p=kt({mutationFn:Z6,onSuccess:()=>{r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]}),u([]),d(!1)},onError:E=>{console.error("Failed to delete characters:",E),d(!1)}}),b=(E,x)=>{if(E.shiftKey)E.preventDefault(),u(y=>y.includes(x)?y.filter(v=>v!==x):[...y,x]);else{if(o.length>0)return;t(`/character/${x}`)}};return f?a.jsx("div",{className:"p-8 flex justify-center items-center h-full",children:a.jsx(Ge,{size:"lg"})}):g?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:g.message||"Failed to load characters"})}):e?a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Characters"}),h.length>0&&!n&&a.jsxs("div",{className:"relative group flex items-center",children:[a.jsx(Mn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 cursor-pointer transition-colors"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 z-10 mb-2 w-max max-w-xs -translate-x-1/2 transform rounded-lg bg-gray-900 px-3 py-2 text-center text-sm font-normal text-white opacity-0 transition-opacity duration-300 group-hover:opacity-100 pointer-events-none",children:["Hold ",a.jsx("kbd",{className:"px-2 py-1.5 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg",children:"Shift"})," and click cards to select multiple for deletion.",a.jsx("div",{className:"absolute left-1/2 top-full h-0 w-0 -translate-x-1/2 border-x-4 border-x-transparent border-t-4 border-t-gray-900"})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[o.length>0&&a.jsxs(q,{variant:"danger",icon:Sr,onClick:()=>d(!0),loading:p.isPending,children:["Delete (",o.length,")"]}),a.jsx(q,{variant:"secondary",icon:W0,onClick:()=>l(!0),children:"Join Party"}),a.jsx(q,{variant:"primary",icon:Wt,onClick:()=>s(!0),children:"Create Character"})]})]}),n?a.jsx(G6,{onComplete:()=>{s(!1),r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]})}}):h.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(E=>a.jsxs("div",{className:"relative group cursor-pointer",onClick:x=>b(x,E.id),children:[a.jsx("div",{className:`absolute inset-0 rounded-lg border-2 transition-all duration-200 pointer-events-none ${o.includes(E.id)?"border-red-500 shadow-lg":"border-transparent group-hover:border-blue-500"}`}),a.jsx(f4,{character:E})]},E.id))}):a.jsx(dp,{icon:Wt,title:"No Characters Yet",description:"Create your first character to begin your adventure.",action:a.jsx(q,{variant:"primary",icon:Wt,onClick:()=>s(!0),children:"Create Your First Character"})}),a.jsx(X6,{isOpen:i,onClose:()=>l(!1),onJoin:E=>{l(!1),t(`/party/join/${E}`)}}),a.jsx(hp,{isOpen:c,onClose:()=>d(!1),onConfirm:()=>{o.length>0&&p.mutate(o)},title:`Delete ${o.length} ${o.length>1?"Characters":"Character"}?`,description:"Are you sure you want to permanently delete the selected character(s)? All of their data will be lost. This action cannot be undone.",confirmText:`Yes, Delete ${o.length}`,isLoading:p.isPending,isDestructive:!0,icon:a.jsx(fh,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})})]}):a.jsx("div",{className:"p-8",children:a.jsx(dp,{icon:Nt,title:"Authentication Required",description:"Please sign in to view your characters."})})}function ho(e,t){var c;const r=e.trim();let n=r,s=1,i;const l=r.match(/^(\d+)\s+(.*)/),o=r.match(/^(.*?)\s+(\d+)\s*(\w+)?$/);l?(s=parseInt(l[1],10),n=l[2].trim(),n.match(/^(.*?)\s+(\d+)\s*(\w+)?$/)&&console.warn(`Ambiguous item string: "${r}". Using quantity ${s} for name "${n}".`)):o&&(n=o[1].trim(),s=parseInt(o[2],10),i=(c=o[3])==null?void 0:c.trim());const u=t==null?void 0:t.find(d=>{var h;return((h=d.name)==null?void 0:h.toLowerCase())===n.toLowerCase()});return{name:n,quantity:s,unit:i,originalName:r,description:u==null?void 0:u.description,weight:u==null?void 0:u.weight,cost:u==null?void 0:u.cost,category:u==null?void 0:u.category,damage:u==null?void 0:u.damage,armor_rating:u==null?void 0:u.armor_rating,grip:u==null?void 0:u.grip,range:u==null?void 0:u.range,durability:u==null?void 0:u.durability,features:u==null?void 0:u.features,effect:u==null?void 0:u.effect,id:`${n}-${Date.now()}-${Math.random()}`}}function Ec(e){let t="";return e.quantity>1?t=` (x${e.quantity}${e.unit?" "+e.unit:""})`:e.unit&&(t=` (${e.quantity} ${e.unit})`),`${e.name}${t}`}function Jl(e,t){const r=e.findIndex(n=>n.name.toLowerCase()===t.name.toLowerCase()&&n.unit===t.unit);if(r>-1){const n=[...e],s=n[r];return n[r]={...s,quantity:s.quantity+t.quantity,originalName:`${t.quantity>1?t.quantity+" ":""}${s.name}${t.unit?" "+t.unit:""}`.trim()},n}else return[...e,t]}async function eI(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1}).limit(1);if(r)throw console.error("Error fetching latest encounter:",r),r;return(t==null?void 0:t[0])||null}async function tI(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching all encounters:",r),r;return t||[]}async function bE(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("id",e).single();if(r)throw console.error("Error fetching encounter details:",r),r;return t}async function K0(e){const{data:t,error:r}=await te.from("encounter_combatants").select("*, characters(name), monsters(name)").eq("encounter_id",e).order("initiative_roll",{ascending:!1,nullsLast:!0}).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching encounter combatants:",r),r;return(t||[]).map(n=>({...n,display_name:n.display_name||(n.character_id&&n.characters?n.characters.name:n.monster_id&&n.monsters?n.monsters.name:"Unknown Combatant")}))}async function vE(e,t,r){const{data:n,error:s}=await te.from("encounters").insert({party_id:e,name:t,description:r,status:"planning"}).select().single();if(s)throw console.error("Error creating encounter:",s),s;if(!n)throw new Error("Encounter creation returned no data");return n}async function rI(e){const{error:t}=await te.from("encounter_combatants").delete().eq("encounter_id",e);if(t)throw console.error("Error deleting encounter combatants:",t),t;const{error:r}=await te.from("encounters").delete().eq("id",e);if(r)throw console.error("Error deleting encounter:",r),r}async function nI(e,t,r){const n=await bE(e);if(!n)throw new Error("Original encounter not found");const s=await vE(n.party_id,t,n.description||void 0),i=await K0(e);if(i.length>0){const l=i.map(u=>({encounter_id:s.id,character_id:u.character_id,monster_id:u.monster_id,display_name:u.display_name,max_hp:u.max_hp,current_hp:u.max_hp,max_wp:u.max_wp,current_wp:u.max_wp,is_player_character:u.is_player_character,initiative_roll:null,is_active_turn:!1,status_effects:[]})),{error:o}=await te.from("encounter_combatants").insert(l);if(o)throw console.error("Error duplicating combatants:",o),o}return s}async function sI(e,t){var r;if(t.type==="character"){const{data:n,error:s}=await te.from("characters").select("id, name, max_health, current_health, max_willpower, current_willpower").eq("id",t.characterId).single();if(s||!n)throw console.error("Error fetching character for combatant:",s==null?void 0:s.message),new Error(`Character (ID: ${t.characterId}) not found or error fetching details.`);const i=n.name||"Unnamed Character",l={encounter_id:e,character_id:n.id,display_name:i,max_hp:n.max_health??10,current_hp:n.current_health??n.max_health??10,max_wp:n.max_willpower,current_wp:n.current_willpower,is_player_character:!0,initiative_roll:t.initiativeRoll},{data:o,error:u}=await te.from("encounter_combatants").insert(l).select().single();if(u)throw console.error("Error inserting character combatant:",u.message),u;return[o]}else if(t.type==="monster"){const{data:n,error:s}=await te.from("monsters").select("id, name, stats").eq("id",t.monsterId).single();if(s||!n)throw console.error("Error fetching monster for combatant:",s==null?void 0:s.message),new Error(`Monster (ID: ${t.monsterId}) not found or error fetching details.`);const i=((r=n.stats)==null?void 0:r.HP)??10,l=t.instanceCount??1,o=[];for(let d=0;d<l;d++){const h=l>1?`${t.customName||n.name||"Unnamed Monster"} ${d+1}`:t.customName||n.name||"Unnamed Monster";o.push({encounter_id:e,monster_id:n.id,display_name:h,max_hp:i,current_hp:i,max_wp:null,current_wp:null,is_player_character:!1,initiative_roll:t.initiativeRoll})}const{data:u,error:c}=await te.from("encounter_combatants").insert(o).select();if(c)throw console.error("Error inserting monster combatants:",c.message),c;return u||[]}throw new Error("Invalid combatant type specified.")}async function xh(e,t){const{data:r,error:n}=await te.from("encounters").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating encounter:",n),n;if(!r)throw new Error("Encounter update returned no data");return r}async function lu(e,t){const{data:r,error:n}=await te.from("encounter_combatants").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating combatant:",n),n;if(!r)throw new Error("Combatant update returned no data");return r}async function aI(e){const{error:t}=await te.from("encounter_combatants").delete().eq("id",e);if(t)throw console.error("Error removing combatant:",t),t}async function iI(e,t){const{data:r,error:n}=await te.from("encounter_combatants").select("*, monsters(stats)").eq("encounter_id",e).in("id",t);if(n)throw console.error("Error fetching combatants for initiative:",n),n;const i=((r==null?void 0:r.map(l=>{var u,c;let o;if(l.is_player_character)o=Math.floor(Math.random()*10)+1;else{const d=((c=(u=l.monsters)==null?void 0:u.stats)==null?void 0:c.ferocity)??1,h=Math.max(1,Math.min(d,5)),f=Array.from({length:h},()=>Math.floor(Math.random()*10)+1);o=Math.max(...f)}return{id:l.id,initiative_roll:o}}))||[]).map(l=>lu(l.id,{initiative_roll:l.initiative_roll}));return Promise.all(i)}async function lI(e,t){const{data:r,error:n}=await te.from("encounter_combatants").select("id, initiative_roll").in("id",[e,t]);if(n||!r||r.length!==2)throw new Error("Could not fetch combatants for initiative swap");const[s,i]=r,[l,o]=await Promise.all([lu(s.id,{initiative_roll:i.initiative_roll}),lu(i.id,{initiative_roll:s.initiative_roll})]);return[l,o]}async function oI(e){return await xh(e,{status:"active",current_round:1})}async function uI(e){return await xh(e,{status:"completed",active_combatant_id:null})}async function cI(e){const{data:t}=await te.from("encounters").select("current_round").eq("id",e).single();if(!t)throw new Error("Encounter not found");return xh(e,{current_round:t.current_round+1,active_combatant_id:null})}const ur=iE((e,t)=>({character:null,isLoading:!1,isSaving:!1,error:null,saveError:null,markedSkillsThisSession:new Set,allGameItems:[],isLoadingGameItems:!1,activeStatusMessage:null,statusMessageTimeoutId:null,activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null,fetchCharacter:async(r,n)=>{e({character:null,isLoading:!0,error:null,saveError:null});try{t().allGameItems.length===0&&!t().isLoadingGameItems&&await t()._loadGameItems();const s=t().allGameItems,i=await Q6(r,n);if(!i)throw new Error(`Character with ID ${r} not found.`);i.equipment?(i.equipment.inventory||(i.equipment.inventory=[]),i.equipment.equipped||(i.equipment.equipped={weapons:[]}),i.equipment.money||(i.equipment.money={gold:0,silver:0,copper:0})):i.equipment={inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},Array.isArray(i.equipment.inventory)&&i.equipment.inventory.length>0&&typeof i.equipment.inventory[0]=="string"&&(i.equipment.inventory=i.equipment.inventory.map(l=>ho(l,s))),e({character:i,isLoading:!1}),i!=null&&i.party_id?t().fetchActiveEncounter(i.party_id,i.id):t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch character";e({error:i,isLoading:!1})}},setCharacter:r=>{e({character:r}),!r||!r.party_id?t().clearActiveEncounter():t().fetchActiveEncounter(r.party_id,r.id)},_saveCharacter:async r=>{var s,i;const n=t().character;if(!(n!=null&&n.id)){const l="Cannot save: Character ID is missing.";throw e({saveError:l}),new Error(l)}e({isSaving:!0,saveError:null});try{const l={...n};r.equipment&&(l.equipment={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},...r.equipment,...r.equipment.money&&{money:{...((s=n.equipment)==null?void 0:s.money)||{gold:0,silver:0,copper:0},...r.equipment.money}},...r.equipment.inventory&&{inventory:r.equipment.inventory},...r.equipment.equipped&&{equipped:{...((i=n.equipment)==null?void 0:i.equipped)||{weapons:[]},...r.equipment.equipped,...r.equipment.equipped.weapons&&{weapons:r.equipment.equipped.weapons}}}}),r.attributes&&(l.attributes={...n.attributes||{STR:10,AGL:10,INT:10,CHA:10,CON:10,WIL:10},...r.attributes}),r.conditions&&(l.conditions={...n.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},...r.conditions}),"teacher"in r&&(l.teacher=r.teacher),r.skill_levels&&(l.skill_levels=r.skill_levels),r.spells&&(l.spells=r.spells),r.heroic_ability&&(l.heroic_ability=r.heroic_ability),"max_hp"in r&&(l.max_hp=r.max_hp),"current_hp"in r&&(l.current_hp=r.current_hp),"temporary_hp"in r&&(l.temporary_hp=r.temporary_hp),"max_wp"in r&&(l.max_wp=r.max_wp),"current_wp"in r&&(l.current_wp=r.current_wp),"death_rolls_passed"in r&&(l.death_rolls_passed=r.death_rolls_passed),"death_rolls_failed"in r&&(l.death_rolls_failed=r.death_rolls_failed),"is_rallied"in r&&(l.is_rallied=r.is_rallied),"notes"in r&&(l.notes=r.notes),"experience"in r&&(l.experience=r.experience),"reputation"in r&&(l.reputation=r.reputation),"corruption"in r&&(l.corruption=r.corruption),"appearance"in r&&(l.appearance=r.appearance),"name"in r&&(l.name=r.name),"class"in r&&(l.class=r.class),"race"in r&&(l.race=r.race),"level"in r&&(l.level=r.level),"background"in r&&(l.background=r.background),"alignment"in r&&(l.alignment=r.alignment),"experience_points"in r&&(l.experience_points=r.experience_points),"armor_class"in r&&(l.armor_class=r.armor_class),"speed"in r&&(l.speed=r.speed),"proficiency_bonus"in r&&(l.proficiency_bonus=r.proficiency_bonus),"age"in r&&(l.age=r.age),"kin"in r&&(l.kin=r.kin),"profession"in r&&(l.profession=r.profession),"mementos"in r&&(l.mementos=r.mementos),"weak_spot"in r&&(l.weak_spot=r.weak_spot),"prepared_spells"in r&&(l.prepared_spells=r.prepared_spells);const o=await K6(n.id,l);e({character:o,isSaving:!1})}catch(l){const o=l instanceof Error?l.message:"Failed to save character";throw e({saveError:o,isSaving:!1}),l}},_loadGameItems:async()=>{if(!(t().isLoadingGameItems||t().allGameItems.length>0)){e({isLoadingGameItems:!0});try{const r=await gh();e({allGameItems:r,isLoadingGameItems:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load game items";e({isLoadingGameItems:!1,error:n,allGameItems:[]})}}},updateCharacterData:async r=>t()._saveCharacter(r),adjustStat:async(r,n)=>{const s=t().character;if(!s)return;let i;if(r==="current_hp"){const l=s.current_hp,o=s.max_hp;if(i=Math.max(0,Math.min(o,l+n)),i!==l){const u={current_hp:i};s.current_hp<=0&&i>0&&(u.death_rolls_passed=0,u.death_rolls_failed=0,u.is_rallied=!1),await t()._saveCharacter(u)}}else if(r==="current_wp"){const l=s.current_wp,o=s.max_wp;i=Math.max(0,Math.min(o,l+n)),i!==l&&await t()._saveCharacter({current_wp:i})}},toggleCondition:async r=>{const n=t().character;if(!n)return;const s=n.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i={...s,[r]:!s[r]};await t()._saveCharacter({conditions:i})},performRest:async(r,n)=>{const s=t().character;if(!s)return;const i={},l=s.current_hp,o=s.max_hp,u=s.current_wp,c=s.max_wp,d=()=>Math.floor(Math.random()*6)+1;if(r==="round")i.current_wp=Math.min(c,u+d());else if(r==="stretch"){if(l<=0){e({saveError:"Cannot take Stretch Rest while dying."}),setTimeout(()=>e(E=>({...E,saveError:E.saveError==="Cannot take Stretch Rest while dying."?null:E.saveError})),3e3);return}const h=n?d()+d():d();i.current_hp=Math.min(o,l+h),i.current_wp=Math.min(c,u+d());const f=s.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},g=Object.keys(f);let p={...f},b=!1;for(const E of g)if(p[E]===!0){p[E]=!1,b=!0;break}b&&(i.conditions=p)}else if(r==="shift"){i.current_hp=o,i.current_wp=c;const h={...s.conditions??{}};for(const f in h)h[f]=!1;i.conditions=h,i.death_rolls_failed=0,i.death_rolls_passed=0,i.is_rallied=!1}Object.keys(i).length>0&&await t()._saveCharacter(i)},setDeathRollState:async(r,n,s)=>{const i={death_rolls_passed:r,death_rolls_failed:n};s!==void 0&&(i.is_rallied=s),await t()._saveCharacter(i)},updateAttribute:async(r,n)=>{const s=t().character;if(!s)return;const l={attributes:{...s.attributes||{STR:10,AGL:10,INT:10,CHA:10,CON:10,WIL:10},[r]:n}};r==="CON"&&(l.max_hp=n,l.current_hp=Math.min(s.current_hp,n)),r==="WIL"&&(l.max_wp=n,l.current_wp=Math.min(s.current_wp,n)),await t()._saveCharacter(l)},updateCurrentHP:async r=>{await t()._saveCharacter({current_hp:r})},updateWillpowerPoints:async r=>{await t()._saveCharacter({current_wp:r})},updateConditions:async r=>{await t()._saveCharacter({conditions:r})},updateInventory:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},inventory:r};await t()._saveCharacter({equipment:s})},updateEquipped:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},equipped:r};await t()._saveCharacter({equipment:s})},updateMoney:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},money:r};await t()._saveCharacter({equipment:s})},updateNotes:async r=>{await t()._saveCharacter({notes:r})},updateExperience:async r=>{await t()._saveCharacter({experience:r})},updateReputation:async r=>{await t()._saveCharacter({reputation:r})},updateCorruption:async r=>{await t()._saveCharacter({corruption:r})},updateDeathRolls:async(r,n)=>{const s=t().character;s&&(r==="failed"?await t().setDeathRollState(s.death_rolls_passed??0,n,s.is_rallied):await t().setDeathRollState(n,s.death_rolls_failed??0,s.is_rallied))},updateAppearance:async r=>{await t()._saveCharacter({appearance:r})},updateSkillLevel:async(r,n)=>{const s=t().character;if(!s)return;const l={...xl(s.skill_levels),[r]:n};await t()._saveCharacter({skill_levels:l})},increaseSkillLevel:async r=>{var u;const n=t().character;if(!n)return;const s=xl(n.skill_levels),i=s[r]??0;if(i>=18)return;const l=Math.min(i+1,18),o={skill_levels:{...s,[r]:l}};((u=n.teacher)==null?void 0:u.skillUnderStudy)===r&&(o.teacher=null),await t()._saveCharacter(o)},addHeroicAbility:async r=>{const n=t().character;if(!n)return;const s=n.heroic_ability||[];if(!s.includes(r)){const i=[...s,r];await t()._saveCharacter({heroic_ability:i})}},learnSpell:async r=>{var o,u;const n=t().character;if(!n)return;const s=n.spells?{...n.spells}:{school:null,general:[]};s.general||(s.general=[]),s.school&&!s.school.spells&&(s.school.spells=[]);const i=s.general.includes(r),l=((u=(o=s.school)==null?void 0:o.spells)==null?void 0:u.includes(r))??!1;if(!i&&!l){const c=[...s.general,r],d={...s,general:c};await t()._saveCharacter({spells:d})}},setSkillUnderStudy:async r=>{if(!t().character)return;const s=r?{skillUnderStudy:r}:null;await t()._saveCharacter({teacher:s})},markSkillThisSession:r=>{e(n=>({markedSkillsThisSession:new Set(n.markedSkillsThisSession).add(r)}))},clearMarkedSkillsThisSession:()=>{e({markedSkillsThisSession:new Set})},setActiveStatusMessage:(r,n=3e4)=>{const s=t().statusMessageTimeoutId;s&&clearTimeout(s),e({activeStatusMessage:r});const i=setTimeout(()=>{e({activeStatusMessage:null,statusMessageTimeoutId:null})},n);e({statusMessageTimeoutId:i})},clearActiveStatusMessage:()=>{const r=t().statusMessageTimeoutId;r&&clearTimeout(r),e({activeStatusMessage:null,statusMessageTimeoutId:null})},fetchActiveEncounter:async(r,n)=>{e({isLoadingEncounter:!0,encounterError:null,activeEncounter:null,currentCombatant:null});try{const s=await eI(r);if(s){e({activeEncounter:s});const l=(await K0(s.id)).find(o=>o.character_id===n);e({currentCombatant:l??null})}else e({activeEncounter:null,currentCombatant:null});e({isLoadingEncounter:!1})}catch(s){const i=s instanceof Error?s.message:"Failed to fetch active encounter";e({encounterError:i,isLoadingEncounter:!1})}},drawInitiative:async()=>{const{currentCombatant:r,activeEncounter:n}=t();if(!r||!n||n.status!=="active"){t().setActiveStatusMessage("Cannot draw initiative: Not in an active encounter or not added as a combatant.",5e3);return}e({isSaving:!0,saveError:null});try{const s=Math.floor(Math.random()*10)+1,i=await lu(r.id,{initiative_roll:s});e(l=>({currentCombatant:i,isSaving:!1,saveError:null})),t().setActiveStatusMessage(`Initiative drawn: ${s}`,5e3)}catch(s){const i=s instanceof Error?s.message:"Failed to draw initiative";e({saveError:i,isSaving:!1}),t().setActiveStatusMessage(`Failed to draw initiative: ${i}`,5e3)}},clearActiveEncounter:()=>{e({activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null})}})),dI=[{kin:"Human",movement:10},{kin:"Halfling",movement:8},{kin:"Dwarf",movement:8},{kin:"Elf",movement:10},{kin:"Mallard",movement:8},{kin:"Wolfkin",movement:12}];function hI(e,t){var s;const r=((s=dI.find(i=>i.kin===e))==null?void 0:s.movement)||10;let n=0;return t<=6?n=-4:t<=9?n=-2:t<=12?n=0:t<=15?n=2:n=4,r+n}const Ef={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},fI=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming"],mI=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],pI=["Mentalism","Animism","Elementalism"],gI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,xI=(e,t,r)=>{var l,o;console.warn(`[SkillsModal] Calculating fallback level for ${t}.`);const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=gI(s);return n?i*2:i};function yI({onClose:e}){const{toggleDiceRoller:t}=xa(),{character:r}=ur(),[n,s]=w.useState([]),[i,l]=w.useState(!1),[o,u]=w.useState(null);if(w.useEffect(()=>{(async()=>{l(!0),u(null);try{const{data:k,error:_}=await te.from("magic_schools").select("id, name");if(_)throw _;s(k||[]),console.log("[SkillsModal] Fetched magic schools:",k)}catch(k){console.error("[SkillsModal] Error fetching magic schools:",k),u("Failed to load magic schools data.")}finally{l(!1)}})()},[]),!r)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6",children:a.jsx(Ge,{})})});let c=r.skill_levels;if(typeof c=="string")try{c=JSON.parse(c)}catch(v){console.error("[SkillsModal] Error parsing skill_levels JSON string:",v),c={}}else(c===null||typeof c!="object")&&(c={});const d=r.magicSchool,h=!!d;console.log(`[SkillsModal] Character School ID: ${d}, Is Mage: ${h}`);let f=null;if(h&&!i&&n.length>0){const v=n.find(k=>k.id===d);v?(f=v.name,console.log(`[SkillsModal] Found Magic School Name: ${f}`)):console.warn(`[SkillsModal] Could not find magic school name for ID: ${d}`)}const g=v=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[v],p=(v,k,_)=>{console.log(`[SkillsModal] Rolling for ${v}, Target: ${k}, Bane: ${_}`),t({initialDice:["d20"],rollMode:"skillCheck",targetValue:k,description:`${v} Check`,requiresBane:_,skillName:v}),e()},b=fI.map(v=>({name:v,attr:Ef[v]})).sort((v,k)=>v.name.localeCompare(k.name)),E=mI.map(v=>({name:v,attr:Ef[v]})).sort((v,k)=>v.name.localeCompare(k.name)),x=f?pI.filter(v=>v===f).map(v=>({name:v,attr:Ef[v]})).sort((v,k)=>v.name.localeCompare(k.name)):[];console.log("[SkillsModal] Filtered Mage Skills for display:",x);const y=v=>{var j,D;const k=((j=r.trainedSkills)==null?void 0:j.includes(v.name))??!1,_=(c==null?void 0:c[v.name])??xI(r,v.name,v.attr),S=g(v.attr),I=((D=r.conditions)==null?void 0:D[S])??!1;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${I?"bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"hover:bg-gray-100"}`,onClick:()=>p(v.name,_,I),title:`Click to roll ${v.name} (Target  ${_}${I?", Bane":""})`,children:[a.jsxs("div",{children:[a.jsx("span",{className:`${k?"font-bold":""} ${I?"text-red-700":"text-gray-800"}`,children:v.name}),a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",v.attr,")"]}),I&&a.jsx("span",{className:"text-xs text-red-600 font-semibold ml-2",children:"(Bane)"})]}),a.jsxs("span",{className:`font-medium text-sm ${I?"text-red-700":"text-gray-600"}`,children:["Target: ",_]})]},v.name)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Skills (d20 Check)"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click a skill to roll a d20 check. Roll  Skill Level for success. 1 is Dragon (Crit Success), 20 is Demon (Crit Fail). Conditions apply Bane (roll 2d20, take highest/worst). Trained skills are bolded."})]}),a.jsxs("div",{className:`grid grid-cols-1 ${h?"md:grid-cols-3":"md:grid-cols-2"} gap-6 p-6 overflow-y-auto flex-grow`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"General Skills"}),a.jsx("div",{className:"space-y-1",children:b.map(y)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Weapon Skills"}),a.jsx("div",{className:"space-y-1",children:E.map(y)})]}),h&&a.jsxs("div",{children:[i&&a.jsxs("div",{className:"text-center text-gray-500 p-4",children:[a.jsx(Ge,{size:"sm"})," Loading magic info..."]}),o&&!i&&a.jsx("div",{className:"text-center text-red-600 p-4 border border-red-200 bg-red-50 rounded",children:o}),!i&&!o&&f&&a.jsxs(a.Fragment,{children:[a.jsxs("h3",{className:"font-bold mb-4 text-gray-700",children:["Magic Skill (",f,")"]}),a.jsx("div",{className:"space-y-1",children:x.length>0?x.map(y):a.jsxs("p",{className:"text-sm text-gray-500 italic px-2 py-1",children:["No matching magic skill component found for ",f,"."]})})]}),!i&&!o&&!f&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Magic Skill"}),a.jsxs("p",{className:"text-sm text-orange-600 italic px-2 py-1 bg-orange-50 border border-orange-200 rounded",children:["Could not determine magic school name from ID (",d,")."]})]})]})]}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(q,{variant:"outline",onClick:e,children:"Close"})})]})})}function bI(e){var h,f;const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),o=ur(g=>g.character),u=w.useMemo(()=>{if(!(o!=null&&o.spells))return[];let g=[];if(o.spells.general&&(Array.isArray(o.spells.general)?g=g.concat(o.spells.general):console.warn("[useSpells] character.spells.general is not an array:",o.spells.general)),o.spells.school&&o.spells.school.spells){const p=o.spells.school.spells;Array.isArray(p)?g=g.concat(p):console.warn("[useSpells] character.spells.school.spells is not an array:",p)}return Array.from(new Set(g))},[o==null?void 0:o.spells]);w.useEffect(()=>{if(!e||u.length===0){s(!1),r([]);return}async function g(){s(!0),l(null);try{const{data:p,error:b}=await te.from("game_spells").select(`
            *,
            power_level,
            magic_schools ( name )
          `).in("name",u).order("rank",{ascending:!0}).order("name",{ascending:!0});if(b)throw b;r(p||[])}catch(p){console.error("Error loading learned spell details:",p),l(p instanceof Error?p.message:"Failed to load spell details"),r([])}finally{s(!1)}}g()},[e,u]);const c=w.useMemo(()=>t.map(g=>({id:g.id,name:g.name,schoolId:g.school_id,rank:g.rank,requirement:g.requirement,castingTime:g.casting_time,range:g.range,duration:g.duration,description:g.description,willpowerCost:g.willpower_cost,createdAt:g.created_at,powerLevel:g.power_level})),[t]),d=w.useMemo(()=>{var g,p;return((p=(g=o==null?void 0:o.spells)==null?void 0:g.school)==null?void 0:p.name)??null},[(f=(h=o==null?void 0:o.spells)==null?void 0:h.school)==null?void 0:f.name]);return{learnedSpells:c,characterSchoolName:d,loading:n,error:i}}const wE=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,vI=(e,t)=>{var l,o;const r="WIL",n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=wE(s);return console.log(`[SpellcastingView - Fallback] Skill: ${t}, Trained: ${n}, Base Attr (${r}): ${s}, Base Chance: ${i}, Final Fallback: ${n?i*2:i}`),n?i*2:i},wI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch(t){return console.error("Error parsing skill_levels JSON:",t),{}}else if(typeof e=="object"&&e!==null)return e;return{}};function EI({onClose:e}){var we,Z,be;const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState("prepared"),[c,d]=w.useState({}),[h,f]=w.useState("all"),{toggleDiceRoller:g}=xa(),{character:p,updateCharacterData:b,isSaving:E,setActiveStatusMessage:x}=ur(),{learnedSpells:y,characterSchoolName:v,loading:k,error:_}=bI(p==null?void 0:p.id),S=((we=p==null?void 0:p.attributes)==null?void 0:we.INT)??10,I=wE(S),j=w.useMemo(()=>new Set((p==null?void 0:p.prepared_spells)??[]),[p==null?void 0:p.prepared_spells]),D=w.useMemo(()=>y.filter(ee=>ee.rank>0&&j.has(ee.id)).length,[y,j]),T=D<I,B=async(ee,de)=>{if(s(null),!p)return;const _e=p.prepared_spells??[];let je;if(de)je=_e.filter(Pe=>Pe!==ee);else{if(!T){s(`Preparation limit reached (${I} spells based on INT ${S}).`);return}je=[..._e,ee]}try{await b({prepared_spells:je})}catch(Pe){console.error("Error updating prepared spells:",Pe),s(Pe instanceof Error?Pe.message:"Failed to update preparation")}},{preparedSpellsList:O,grimoireSpellsList:Y}=w.useMemo(()=>{const ee=y.filter(Pe=>Pe.rank===0),de=y.filter(Pe=>Pe.rank>0&&j.has(Pe.id)),_e=[...ee,...de].sort((Pe,Fe)=>Pe.rank-Fe.rank||Pe.name.localeCompare(Fe.name)),je=[...y].sort((Pe,Fe)=>Pe.rank-Fe.rank||Pe.name.localeCompare(Fe.name));return{preparedSpellsList:_e,grimoireSpellsList:je}},[y,j]),G=w.useMemo(()=>{const ee=new Set;return y.forEach(de=>ee.add(de.rank)),Array.from(ee).sort((de,_e)=>de-_e)},[y]),z=w.useMemo(()=>{const ee=[{label:"All",value:"all"}];return G.forEach(de=>{de===0?ee.push({label:"Trick",value:0}):de>=1&&de<=9&&ee.push({label:`Rank ${de}`,value:de})}),ee},[G]),H=w.useMemo(()=>{const ee=o==="prepared"?O:Y;if(h==="all")return ee;const de=typeof h=="number"?h:-1;return ee.filter(_e=>_e.rank===de)},[o,O,Y,h]),A=v;let M=null,Q=null,N=!1;const K=["Animism","Elementalism","Symbolism","General Magic"];if(p&&A){const ee=new Set([...p.trainedSkills??[],...Object.keys(p.skill_levels??{})]);if(A==="Animist"&&ee.has("Animism")?M="Animism":A==="Elementalist"&&ee.has("Elementalism")?M="Elementalism":(M=K.find(de=>ee.has(de))??null,!M&&ee.has(A)&&(M=A)),console.log(`[SpellcastingView - Calc] Character ID: ${p.id}`),console.log(`[SpellcastingView - Calc] Derived School Name (Display Hint): ${A}`),console.log(`[SpellcastingView - Calc] Determined Actual Magic Skill Name: ${M}`),console.log("[SpellcastingView - Calc] Character Skills Set:",ee),M){const de=wI(p.skill_levels),_e=de==null?void 0:de[M],je=((Z=p.trainedSkills)==null?void 0:Z.includes(M))??!1;console.log("[SpellcastingView - Calc] Trained Skills Array:",p.trainedSkills),console.log(`[SpellcastingView - Calc] Is ${M} Trained?: ${je}`),console.log("[SpellcastingView - Calc] Parsed Skill Levels:",de),console.log(`[SpellcastingView - Calc] Stored Level for ${M}: ${_e}`),_e!==void 0?(Q=_e,console.log(`[SpellcastingView - Calc] Using stored level: ${Q}`)):(console.log(`[SpellcastingView - Calc] No stored level found for ${M}, calculating fallback...`),Q=vI(p,M)),N=((be=p.conditions)==null?void 0:be.scared)??!1,console.log(`[SpellcastingView - Calc] Final Magic Skill Value: ${Q}, Affected by Bane: ${N}`)}else console.warn(`[SpellcastingView - Calc] Could not determine actual magic skill name for character based on school '${A}'.`)}else console.log(`[SpellcastingView - Calc] Skipping calculation: Character or Derived School Name missing. Name: ${A}`);if(w.useEffect(()=>{const ee={};y.forEach(de=>{de.powerLevel==="yes"&&(ee[de.id]=c[de.id]||1)}),d(ee)},[y]),!p)return null;const $=async ee=>{l(ee.id),r(null);try{const de=p.current_wp??p.attributes.WIL,_e=Number(ee.willpowerCost??0),je=c[ee.id]||1,Pe=ee.powerLevel==="yes",Fe=Pe?_e+(je-1)*2:_e;if(de<Fe){r(`Insufficient Willpower Points (Need ${Fe}, Have ${de})`),l(null);return}const V=de-Fe;await b({current_wp:V}),x(`Casted ${ee.name}${Pe?` (Lvl ${je})`:""} for ${Fe} WP.`)}catch(de){console.error("Error casting spell:",de),r(de instanceof Error?de.message:"Failed to cast spell")}finally{l(null)}},R=(ee,de)=>{d(_e=>{const je=_e[ee]||1,Pe=Math.max(1,Math.min(3,je+de));return{..._e,[ee]:Pe}})},me=()=>{!M||Q===null||g({initialDice:["d20"],rollMode:"skillCheck",targetValue:Q,description:`${M} Check`,requiresBane:N,skillName:M})},ce=({spell:ee,isPreparedView:de})=>{const _e=j.has(ee.id),je=ee.rank===0,Pe=!je&&(_e||T),Fe=ee.powerLevel==="yes",V=c[ee.id]||1,ye=Number(ee.willpowerCost??0),ie=Fe?ye+(V-1)*2:ye,ke=(p.current_wp??p.attributes.WIL)<ie;let Le=`Rank ${ee.rank}`,$e="bg-amber-100",tt="text-amber-800",ut="border-amber-200";return ee.rank===0?(Le="Trick",$e="bg-gray-100",tt="text-gray-800",ut="border-gray-300"):ee.rank<=1?($e="bg-blue-100",tt="text-blue-800",ut="border-blue-200"):ee.rank<=3&&($e="bg-purple-100",tt="text-purple-800",ut="border-purple-200"),a.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm flex flex-col justify-between ${!de&&!je?"opacity-70":""}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-base text-gray-900 flex items-center gap-1.5",children:ee.name}),!de&&a.jsx("div",{className:"ml-2 flex-shrink-0",children:je?a.jsx(up,{className:"w-5 h-5 text-green-500",title:"Tricks are always prepared"}):a.jsx("button",{onClick:()=>B(ee.id,_e),disabled:!Pe||E,className:`disabled:opacity-50 disabled:cursor-not-allowed ${E?"animate-pulse":""}`,title:_e?"Click to unprepare":T?"Click to prepare":`Preparation limit reached (${I})`,children:_e?a.jsx(up,{className:"w-5 h-5 text-blue-600 hover:text-blue-800"}):a.jsx(G2,{className:`w-5 h-5 ${T?"text-gray-400 hover:text-gray-600":"text-gray-300"}`})})})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${$e} ${tt} border ${ut}`,children:Le}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Fn,{size:14,className:"text-gray-400"}),a.jsxs("span",{children:[ie," WP",Fe&&V>1&&a.jsxs("span",{className:"text-xs text-blue-600",children:[" (Lvl ",V,")"]})]})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-2 mb-4",children:[ee.requirement&&a.jsxs("p",{className:"text-amber-700 bg-amber-50 px-2 py-1 rounded border border-amber-200",children:[a.jsx("span",{className:"font-medium",children:"Requirement:"})," ",ee.requirement]}),a.jsxs("p",{className:"whitespace-normal break-words",children:[a.jsx("span",{className:"font-medium",children:"Description:"})," ",ee.description||"No description available."]}),a.jsx("hr",{className:"border-gray-200 my-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1 text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hh,{size:12})," ",ee.castingTime]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(XA,{size:12})," ",ee.range]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx($0,{size:12})," ",ee.duration]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Fn,{size:12})," ",ye," WP ",Fe?"(Base)":""]})]})]})]}),de&&a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center justify-center gap-1",children:Fe?a.jsxs(a.Fragment,{children:[a.jsxs(q,{variant:"primary",size:"sm",onClick:()=>R(ee.id,-1),disabled:V<=1||i!==null||E,className:"px-2","aria-label":"Decrease power level",title:"Decrease power level",children:[" ",a.jsx(U2,{size:14})," "]}),a.jsxs(q,{variant:"primary",size:"sm",onClick:()=>$(ee),loading:i===ee.id||E,disabled:i!==null||E||ke,className:"flex-grow min-w-[80px]",title:ke?`Insufficient WP (Need ${ie})`:`Cast ${ee.name} at Level ${V}`,children:[" ",i===ee.id?"":`Cast Lvl ${V}`," "]}),a.jsxs(q,{variant:"primary",size:"sm",onClick:()=>R(ee.id,1),disabled:V>=3||i!==null||E,className:"px-2","aria-label":"Increase power level",title:"Increase power level",children:[" ",a.jsx(Wt,{size:14})," "]})]}):a.jsxs(q,{variant:"primary",size:"sm",onClick:()=>$(ee),loading:i===ee.id||E,disabled:i!==null||E||ke,className:"w-full",title:ke?`Insufficient WP (Need ${ie})`:`Cast ${ee.name}`,children:[" ",i===ee.id?"":"Cast"," "]})})}),!de&&!je&&a.jsx("div",{className:"mt-auto pt-3 text-center text-xs text-gray-400 italic",children:_e?"Prepared":"Prepare in Grimoire"})]})};return k?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:[a.jsx(Ge,{}),a.jsx("p",{className:"text-center mt-2 text-gray-600",children:"Loading spell details..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-7xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 text-gray-800 mb-1",children:[a.jsx($i,{className:"w-6 h-6 text-purple-600"}),"Spellcasting"]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Current WP: ",a.jsx("strong",{className:"font-semibold",children:p.current_wp??p.attributes.WIL})," / ",p.attributes.WIL]}),M&&Q!==null&&a.jsxs("div",{className:`flex items-center gap-1 cursor-pointer px-2 py-0.5 rounded transition-colors ${N?"text-red-700 bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 ring-1 ring-indigo-200"}`,onClick:me,title:`Click to roll ${M} (Target  ${Q}${N?", Bane":""})`,children:[a.jsx(en,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"font-medium",children:[M,":"]})," ",a.jsx("span",{children:Q}),N&&a.jsx("span",{className:"text-xs font-semibold",children:"(Bane)"})]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none focus:outline-none mt-[-4px]","aria-label":"Close",children:""})]}),t&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Casting Error"}),a.jsx("p",{className:"text-xs text-red-700",children:t})]})]}),n&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Preparation Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:n})]})]}),_&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Spell Data Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:_})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>{u("prepared"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="prepared"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(kd,{size:16})," Prepared (",O.length,")"]}),a.jsxs("button",{onClick:()=>{u("grimoire"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="grimoire"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(L2,{size:16})," Grimoire (",y.length,")"]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"py-3 px-1 text-sm text-gray-500",children:["Preparation Slots: ",a.jsxs("span",{className:"font-medium",children:[D," / ",I]})," (INT ",S,")"]})]})}),y.length>0&&z.length>1&&a.jsxs("div",{className:"pt-4 flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-600 flex items-center gap-1 mr-1 shrink-0",children:[a.jsx(ps,{size:14})," Filter:"]}),z.map(ee=>a.jsx(q,{variant:h===ee.value?"primary":"outline",size:"xs",onClick:()=>f(ee.value),className:`px-2.5 py-1 ${h===ee.value?"":"text-gray-600 bg-white hover:bg-gray-50"}`,children:ee.label},ee.value))]})]}),a.jsx("div",{className:"overflow-y-auto flex-grow p-6 bg-gray-50",children:H.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:H.map(ee=>a.jsx(ce,{spell:ee,isPreparedView:o==="prepared"},ee.id))}):a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[k&&a.jsx("p",{children:"Loading spells..."}),!k&&_&&a.jsx("p",{children:"Could not load spell details."}),!k&&!_&&a.jsxs(a.Fragment,{children:[o==="prepared"&&O.length===0&&a.jsx("p",{children:"No spells prepared. Go to the Grimoire tab to prepare spells. Tricks are always prepared."}),o==="grimoire"&&Y.length===0&&a.jsx("p",{children:"Character has not learned any spells."}),o==="prepared"&&O.length>0&&H.length===0&&a.jsx("p",{children:"No prepared spells match the selected rank filter."}),o==="grimoire"&&Y.length>0&&H.length===0&&a.jsx("p",{children:"No learned spells match the selected rank filter."})]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(q,{variant:"outline",onClick:e,disabled:i!==null||E,children:"Close"})})]})})}const Py=["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS","CLOTHES","MUSICAL INSTRUMENTS","TRADE GOODS","STUDIES & MAGIC","LIGHT SOURCES","TOOLS","CONTAINERS","MEDICINE","SERVICES","HUNTING & FISHING","MEANS OF TRAVEL","ANIMALS"],_I=[{name:"Armor & Weapons",categories:["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS"],Icon:ds},{name:"Clothing & Accessories",categories:["CLOTHES"],Icon:iu},{name:"Musical & Trade Goods",categories:["MUSICAL INSTRUMENTS","TRADE GOODS"],Icon:by},{name:"Magic & Studies",categories:["STUDIES & MAGIC"],Icon:VA},{name:"Light & Tools",categories:["LIGHT SOURCES","TOOLS"],Icon:e4},{name:"Containers & Medicine",categories:["CONTAINERS","MEDICINE"],Icon:iu},{name:"Services",categories:["SERVICES"],Icon:by},{name:"Hunting & Travel",categories:["HUNTING & FISHING","MEANS OF TRAVEL"],Icon:j2},{name:"Animals",categories:["ANIMALS"],Icon:Mu}];function NI({onClose:e}){var M,Q,N,K,$,R,me,ce,we,Z,be,ee,de,_e,je,Pe,Fe;const{isAdmin:t,isDM:r}=Mt(),[n,s]=w.useState(null),[i,l]=w.useState("inventory"),[o,u]=w.useState({search:"",category:"all"}),[c,d]=w.useState({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""}),[h,f]=w.useState(!1),[g,p]=w.useState(null),{character:b,updateCharacterData:E,updateInventory:x,isSaving:y,saveError:v,allGameItems:k,isLoadingGameItems:_,_loadGameItems:S}=ur(V=>({character:V.character,updateCharacterData:V.updateCharacterData,updateInventory:V.updateInventory,isSaving:V.isSaving,saveError:V.saveError,allGameItems:V.allGameItems,isLoadingGameItems:V.isLoadingGameItems,_loadGameItems:V._loadGameItems}));if(w.useEffect(()=>{k.length===0&&!_&&S()},[S,k,_]),w.useEffect(()=>{if(v){s(`Save failed: ${v}`);const V=setTimeout(()=>s(null),5e3);return()=>clearTimeout(V)}else s(null)},[v]),!b)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 text-center",children:[a.jsx(Ge,{}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Loading character data..."})]})});const I=V=>{if(!(!V||typeof V!="string"))return k.find(ye=>{var ie;return((ie=ye.name)==null?void 0:ie.toLowerCase())===V.toLowerCase()})},j=(V,ye)=>{var Le;s(null);const ie=((Le=b.equipment)==null?void 0:Le.money)||{gold:0,silver:0,copper:0},ke=Math.max(0,(ie[V]||0)+ye);E({equipment:{...b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},money:{...ie,[V]:ke}}})},D=()=>{var Le,$e,tt;if(s(null),!c.name||!c.cost){s("Name and cost are required for custom items");return}if(!Oy(c.cost)){s('Invalid cost format. Use e.g., "10 silver", "1 gold 5 copper".');return}const ye={id:`custom-${Date.now()}-${Math.random().toString(36).substring(7)}`,name:c.name.trim(),quantity:c.quantity>0?c.quantity:1,unit:((Le=c.unit)==null?void 0:Le.trim())||void 0,originalName:Ec({name:c.name.trim(),quantity:c.quantity,unit:($e=c.unit)==null?void 0:$e.trim()}),cost:c.cost,weight:c.weight,category:c.category,effect:c.effect||void 0},ie=((tt=b.equipment)==null?void 0:tt.inventory)||[],ke=Jl(ie,ye);x(ke),f(!1),d({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""})},T=(V,ye)=>{s(null);const ie=I(V.name);if(!ie){s(`Details not found for item: ${V.name}`);return}const ke=structuredClone(b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}}),Le=ke.inventory,$e=ke.equipped,tt=Le[ye];if(!tt||tt.id!==V.id){s(`Item "${V.name}" not found at expected index ${ye}. Inventory might be out of sync.`);return}tt.quantity>1?Le[ye]={...tt,quantity:tt.quantity-1}:Le.splice(ye,1);const ut=typeof ie.category=="string"?ie.category.toUpperCase():"";let jt=null;try{if(ut==="ARMOR & HELMETS"){const sn=ie.name.toLowerCase().includes("helmet")?"helmet":"armor",J=$e[sn];if(J){const oe=I(J);jt=ho(J,k),jt.quantity=1}$e[sn]=V.name}else if(ut==="MELEE WEAPONS"||ut==="RANGED WEAPONS"){$e.weapons||($e.weapons=[]),ie.grip==="2H"&&$e.weapons.length>0&&($e.weapons.forEach(oe=>{const Se=ho(oe.name,k);Se.quantity=1,jt=Jl(jt?[jt]:[],Se)[0]}),$e.weapons=[]);const Tr=$e.weapons.reduce((oe,Se)=>oe+(Se.grip==="2H"?2:1),0),sn=ie.grip==="2H"?2:1;if(Tr+sn>2)throw new Error(`Cannot equip ${V.name}. Not enough free hands.`);const J={name:V.name,grip:ie.grip||"1H",range:ie.range||"Melee",damage:ie.damage||"1d6",durability:ie.durability,features:ie.features||[]};$e.weapons.push(J)}else throw new Error(`Item "${V.name}" category "${ie.category}" is not directly equippable.`);jt?ke.inventory=Jl(Le,jt):ke.inventory=Le,E({equipment:ke})}catch(Tr){s(Tr.message||"Failed to equip item.")}},B=(V,ye)=>{var tt;s(null);const ie=structuredClone(b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}});if(!ie.equipped)return;let ke=null,Le=ie.equipped,$e=ie.inventory;if(V==="armor"&&Le.armor)ke=Le.armor,Le.armor=void 0;else if(V==="helmet"&&Le.helmet)ke=Le.helmet,Le.helmet=void 0;else if(V==="weapon"&&typeof ye=="number"&&((tt=Le.weapons)!=null&&tt[ye]))ke=Le.weapons[ye].name,Le.weapons.splice(ye,1);else{s(`Could not find item to unequip (${V}, ${ye})`);return}if(ke){I(ke);let ut;ut=ho(ke,k),ut.quantity=1,$e=Jl($e,ut),E({equipment:{...ie,inventory:$e,equipped:Le}})}else E({equipment:ie})},O=V=>{var jt,Tr;s(null);const ye=Oy(V.cost);if(!ye){s(`Invalid cost format for item: ${V.name} (${V.cost})`);return}const ie=((jt=b.equipment)==null?void 0:jt.money)||{gold:0,silver:0,copper:0},{success:ke,newMoney:Le}=D6(ie,ye);if(!ke){s("Not enough money to buy this item."),setTimeout(()=>s(null),3e3);return}const $e=ho(V.name||"Unknown Item",k);$e.quantity<=0&&($e.quantity=1);const tt=((Tr=b.equipment)==null?void 0:Tr.inventory)||[],ut=Jl(tt,$e);E({equipment:{...b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},inventory:ut,money:Le}})},Y=V=>{var ie;s(null);const ye=[...((ie=b.equipment)==null?void 0:ie.inventory)||[]];if(V<0||V>=ye.length){s("Invalid item index for dropping.");return}ye.splice(V,1),x(ye)},G=V=>{var ke;s(null);const ye=[...((ke=b.equipment)==null?void 0:ke.inventory)||[]];if(V<0||V>=ye.length){s("Invalid item index for using.");return}const ie={...ye[V]};ie.quantity>1?(ie.quantity-=1,ye[V]=ie):ye.splice(V,1),x(ye)},z=(((M=b.equipment)==null?void 0:M.inventory)||[]).filter(V=>{if(!V||typeof V.name!="string")return!1;const ye=V.name.toLowerCase(),ie=o.search.toLowerCase(),ke=I(V.name),Le=typeof(ke==null?void 0:ke.category)=="string"?ke.category.toUpperCase():"",$e=typeof V.originalName=="string"?V.originalName.toLowerCase():"",tt=ye.includes(ie)||$e.includes(ie),ut=o.category==="all"||Le===o.category.toUpperCase();return tt&&ut}),H=k.filter(V=>{if(!V||typeof V.name!="string")return!1;const ye=V.name.toLowerCase(),ie=o.search.toLowerCase(),ke=typeof V.category=="string"?V.category.toUpperCase():"",Le=ye.includes(ie),$e=g?g.categories.includes(ke||""):o.category==="all"||ke===o.category.toUpperCase();return Le&&$e}),A=()=>{var ye,ie;const V=(ye=b.equipment)==null?void 0:ye.equipped;return!V||!V.armor&&!V.helmet&&(!V.weapons||V.weapons.length===0)?null:a.jsxs("div",{className:"mt-6 pt-4 border-t",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-600 mb-3",children:"Equipped Items"}),a.jsxs("div",{className:"space-y-2",children:[V.armor&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[V.armor," (Armor)"]}),a.jsx(q,{variant:"secondary",size:"xs",icon:pf,onClick:()=>B("armor",V.armor),disabled:y,title:`Unequip ${V.armor}`,children:"Unequip"})]}),V.helmet&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[V.helmet," (Helmet)"]}),a.jsx(q,{variant:"secondary",size:"xs",icon:pf,onClick:()=>B("helmet",V.helmet),disabled:y,title:`Unequip ${V.helmet}`,children:"Unequip"})]}),(ie=V.weapons)==null?void 0:ie.map((ke,Le)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[ke.name," (",ke.grip," Weapon)"]}),a.jsx(q,{variant:"secondary",size:"xs",icon:pf,onClick:()=>B("weapon",Le),disabled:y,title:`Unequip ${ke.name}`,children:"Unequip"})]},`${ke.name}-${Le}`))]})]})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-4 md:p-6 border-b flex-shrink-0 bg-gray-50 rounded-t-lg",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800",children:i==="inventory"?"Inventory & Equipped":i==="shop"?"Shop":"Money"}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs md:text-sm font-medium",children:[a.jsx(TA,{className:"w-3 h-3 md:w-4 md:h-4"}),P6(((Q=b.equipment)==null?void 0:Q.money)||{gold:0,silver:0,copper:0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(q,{size:"sm",variant:i==="inventory"?"primary":"secondary",onClick:()=>{l("inventory"),p(null)},children:"Inventory"}),a.jsx(q,{size:"sm",variant:i==="shop"?"primary":"secondary",onClick:()=>{l("shop"),p(null)},children:"Shop"}),a.jsx(q,{size:"sm",variant:i==="money"?"primary":"secondary",onClick:()=>{l("money"),p(null)},children:"Money"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-800 rounded-full hover:bg-gray-200 transition-colors",children:a.jsx(Lt,{className:"w-5 h-5"})})]})]}),(i==="inventory"||i==="shop"&&!g)&&a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mt-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:`Search ${i==="inventory"?"inventory by name":"shop"}...`,value:o.search,onChange:V=>u({...o,search:V.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsxs("select",{value:o.category,onChange:V=>u({...o,category:V.target.value}),className:"w-full md:w-auto pl-9 pr-8 py-2 border rounded-lg appearance-none bg-white text-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),Py.map(V=>a.jsx("option",{value:V,children:V},V))]})]}),i==="inventory"&&(t()||r())&&a.jsx(q,{variant:"secondary",size:"sm",icon:Wt,onClick:()=>f(!0),children:"Custom Item"})]}),i==="shop"&&g&&a.jsx(q,{variant:"secondary",size:"sm",icon:H0,onClick:()=>p(null),className:"mt-3",children:"Back to Categories"})]}),a.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto flex-1 bg-white",children:[n&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:n})}),(_||y)&&a.jsxs("div",{className:"flex justify-center items-center py-10",children:[a.jsx(Ge,{}),a.jsx("span",{className:"ml-2 text-gray-600",children:y?"Saving...":"Loading items..."})]}),i==="money"&&!y&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-yellow-800 text-center",children:"Gold"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("gold",-1),disabled:y||(((K=(N=b.equipment)==null?void 0:N.money)==null?void 0:K.gold)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-yellow-900 min-w-[3ch] text-center",children:((R=($=b.equipment)==null?void 0:$.money)==null?void 0:R.gold)||0}),a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("gold",1),disabled:y,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border border-gray-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-gray-800 text-center",children:"Silver"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("silver",-1),disabled:y||(((ce=(me=b.equipment)==null?void 0:me.money)==null?void 0:ce.silver)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-gray-900 min-w-[3ch] text-center",children:((Z=(we=b.equipment)==null?void 0:we.money)==null?void 0:Z.silver)||0}),a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("silver",1),disabled:y,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-orange-800 text-center",children:"Copper"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("copper",-1),disabled:y||(((ee=(be=b.equipment)==null?void 0:be.money)==null?void 0:ee.copper)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-orange-900 min-w-[3ch] text-center",children:((_e=(de=b.equipment)==null?void 0:de.money)==null?void 0:_e.copper)||0}),a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>j("copper",1),disabled:y,children:"+1"})]})]})]}),(t()||r())&&a.jsxs("div",{className:"mt-6 pt-6 border-t",children:[a.jsx("h3",{className:"font-medium mb-3 text-sm text-gray-600",children:"Quick Add (Admin/DM)"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsx(q,{variant:"outline",size:"sm",onClick:()=>j("gold",10),disabled:y,children:"+10 Gold"}),a.jsx(q,{variant:"outline",size:"sm",onClick:()=>j("silver",50),disabled:y,children:"+50 Silver"}),a.jsx(q,{variant:"outline",size:"sm",onClick:()=>j("copper",100),disabled:y,children:"+100 Copper"})]})]})]}),i==="shop"&&!_&&!y&&(g===null?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 md:gap-4",children:_I.map(V=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-3 md:p-4 border rounded-lg hover:shadow-lg cursor-pointer transition-shadow bg-white hover:bg-gray-50",onClick:()=>p(V),children:[a.jsx(V.Icon,{className:"w-8 h-8 md:w-10 md:h-10 text-blue-600 mb-2"}),a.jsx("span",{className:"font-medium text-center text-xs md:text-sm",children:V.name})]},V.name))}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[H.map(V=>a.jsxs("div",{className:"group relative flex flex-col p-3 border rounded-lg hover:shadow-md transition-shadow bg-white",children:[a.jsxs("div",{className:"flex-1 mb-2",children:[a.jsx("h4",{className:"font-medium text-sm",children:V.name}),a.jsx("p",{className:"text-xs text-gray-500",children:V.category}),a.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:V.effect||V.description||"No description."})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-100",children:[a.jsx("span",{className:"text-xs font-semibold text-green-700",children:V.cost||"N/A"}),a.jsx(q,{variant:"primary",size:"xs",onClick:()=>O(V),disabled:y||!V.cost,children:"Buy"})]}),(V.effect||V.description)&&a.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:V.effect||V.description})]},V.id)),H.length===0&&a.jsx("p",{className:"text-gray-500 italic col-span-full text-center py-6",children:"No items found matching filters in this category."})]})),i==="inventory"&&!y&&a.jsxs(a.Fragment,{children:[A(),a.jsx("h3",{className:"font-medium text-sm text-gray-600 mt-6 mb-3 pt-4 border-t",children:"Inventory Items"}),a.jsxs("div",{className:"space-y-3",children:[(((je=b.equipment)==null?void 0:je.inventory)||[]).map((V,ye)=>{var tt,ut,jt;if(!z.includes(V)||!V||typeof V.name!="string")return null;const ie=I(V.name),ke=typeof(ie==null?void 0:ie.category)=="string"?ie.category.toUpperCase():"",Le=ie&&(ke==="ARMOR & HELMETS"||ke==="MELEE WEAPONS"||ke==="RANGED WEAPONS"),$e=V.quantity>0&&(((tt=ie==null?void 0:ie.category)==null?void 0:tt.toUpperCase())==="MEDICINE"||((ut=ie==null?void 0:ie.category)==null?void 0:ut.toUpperCase())==="STUDIES & MAGIC"||((jt=ie==null?void 0:ie.category)==null?void 0:jt.toUpperCase())==="LIGHT SOURCES"||V.name.toLowerCase().includes("ration"));return a.jsxs("div",{className:"group relative p-3 border rounded-lg hover:shadow-sm transition-shadow flex items-center justify-between gap-2 bg-white",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-sm truncate",title:Ec(V),children:Ec(V)}),ie&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-1",children:ie.effect||ie.description||"No description."})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ie==null?void 0:ie.category)&&a.jsx("span",{className:"hidden sm:inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 text-gray-700 whitespace-nowrap",children:ie.category}),$e&&a.jsx(q,{variant:"outline",size:"xs",icon:NA,onClick:()=>G(ye),disabled:y,title:`Use one ${V.name}`,children:"Use"}),Le&&a.jsx(q,{variant:"secondary",size:"xs",icon:up,onClick:()=>T(V,ye),disabled:y,title:`Equip ${V.name}`,children:"Equip"}),a.jsx(q,{variant:"dangerOutline",size:"xs",icon:Sr,onClick:()=>Y(ye),disabled:y,title:`Drop ${Ec(V)}`,children:"Drop"}),((ie==null?void 0:ie.effect)||(ie==null?void 0:ie.description))&&a.jsxs("span",{className:"relative inline-block ml-1",children:[a.jsx(Mn,{className:"w-4 h-4 text-gray-400 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:[a.jsx("h5",{className:"font-semibold mb-1 border-b border-gray-600 pb-1",children:ie.name}),ie.effect||ie.description,ie.weight&&a.jsxs("p",{className:"mt-1 text-gray-300",children:["Weight: ",ie.weight]}),ie.cost&&a.jsxs("p",{className:"text-gray-300",children:["Cost: ",ie.cost]})]})]})]})]},V.id||`${V.name}-${ye}`)}),z.length===0&&(((Pe=b.equipment)==null?void 0:Pe.inventory)||[]).length>0&&a.jsx("div",{className:"text-center py-8 text-gray-500 italic",children:"No items match current filters."}),(((Fe=b.equipment)==null?void 0:Fe.inventory)||[]).length===0&&!A()&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(iu,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{className:"text-gray-500",children:"Inventory is empty."}),a.jsx(q,{variant:"link",size:"sm",onClick:()=>l("shop"),className:"mt-2",children:"Go to Shop"})]})]}),h&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Create Custom Item"}),a.jsx("button",{onClick:()=>f(!1),className:"p-1 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-200",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Name"}),a.jsx("input",{type:"text",value:c.name,onChange:V=>d({...c,name:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Category"}),a.jsx("select",{value:c.category,onChange:V=>d({...c,category:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm bg-white",children:Py.map(V=>a.jsx("option",{value:V,children:V},V))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Cost (per item)"}),a.jsx("input",{type:"text",value:c.cost,onChange:V=>d({...c,cost:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., 1 gold 5 silver"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Weight (per item)"}),a.jsx("input",{type:"number",value:c.weight,onChange:V=>d({...c,weight:Number(V.target.value)}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Quantity"}),a.jsx("input",{type:"number",value:c.quantity,onChange:V=>d({...c,quantity:Math.max(1,Number(V.target.value))}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"1"})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Unit (Optional)"}),a.jsx("input",{type:"text",value:c.unit,onChange:V=>d({...c,unit:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., meters, doses"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Effect/Description"}),a.jsx("textarea",{value:c.effect,onChange:V=>d({...c,effect:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",rows:2})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[a.jsx(q,{variant:"secondary",size:"sm",onClick:()=>f(!1),children:"Cancel"}),a.jsx(q,{variant:"primary",size:"sm",icon:Wt,onClick:D,disabled:y||!c.name||!c.cost,children:"Add Item"})]})]})]})]})]})})}const _f={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},kI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,SI=(e,t,r)=>{var l,o;const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=kI(s);return n?i*2:i},TI=e=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[e],CI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}else if(typeof e=="object"&&e!==null)return e;return{}},Dy=e=>e?e.split("(")[0].trim():null,jI=e=>["d4","d6","d8","d10","d12","d20"].includes(e),Nf=e=>e?Array.isArray(e)?e.join(", "):e:"-";function AI({character:e}){var y,v,k,_,S,I;const{toggleDiceRoller:t}=xa(),{data:r=[],isLoading:n,error:s}=Rt({queryKey:["gameItems"],queryFn:gh,staleTime:1e3*60*10}),i=j=>{if(j)return r.find(D=>{var T;return((T=D.name)==null?void 0:T.toLowerCase())===j.toLowerCase()})},l=()=>{var B,O,Y,G;let j=0;const D=(O=(B=e.equipment)==null?void 0:B.equipped)==null?void 0:O.armor,T=(G=(Y=e.equipment)==null?void 0:Y.equipped)==null?void 0:G.helmet;if(D){const z=i(D);j+=Number(z==null?void 0:z.armor_rating)||0}if(T){const z=i(T);j+=Number(z==null?void 0:z.armor_rating)||0}return j},o=(j,D)=>{const T=D==null?void 0:D.match(/(\d+)?d(\d+)/i);let B=["d6"],O="1d6";if(T){const K=T[1]?parseInt(T[1],10):1,$=`d${T[2]}`;jI($)&&(B=Array(K).fill($),O=`${K}d${T[2]}`)}let Y="",G=null;const z=i(j),H=z==null?void 0:z.skill,A=Dy(H),M=A?_f[A]:null;M==="STR"?e.attributes.STR>15?(Y="d6",G="d6"):e.attributes.STR>12&&(Y="d4",G="d4"):M==="AGL"&&(e.attributes.AGL>15?(Y="d6",G="d6"):e.attributes.AGL>12&&(Y="d4",G="d4"));let Q=O;Y&&(Q+=` + ${Y}`);const N=[...B];G&&N.push(G),t({rollMode:"attackDamage",initialDice:N,description:`Damage roll for ${j} (${Q})`})},u=(j,D,T)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:D,description:`${j} Check`,requiresBane:T,skillName:j})},c=l(),d=((v=(y=e.equipment)==null?void 0:y.equipped)==null?void 0:v.weapons)||[],h=CI(e.skill_levels),f=(_=(k=e.equipment)==null?void 0:k.equipped)==null?void 0:_.armor,g=(I=(S=e.equipment)==null?void 0:S.equipped)==null?void 0:I.helmet,p=f?i(f):void 0,b=g?i(g):void 0,E=p?Nf(p.features):"-",x=b?Nf(b.features):"-";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[" ",a.jsx(ds,{className:"w-5 h-5 text-blue-600"})," Armor"]}),n?a.jsx(Ge,{size:"sm"}):s?a.jsx(Ie,{message:"Could not load item details for armor."}):a.jsxs("div",{className:"space-y-3",children:[" ",a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Body:"})," ",(p==null?void 0:p.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(p==null?void 0:p.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",p.armor_rating,")"]})]}),p&&p.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(xy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:E})]})]}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Helmet:"})," ",(b==null?void 0:b.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(b==null?void 0:b.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",b.armor_rating,")"]})]}),b&&b.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(xy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:x})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium mt-2",children:[a.jsx(ds,{className:"w-4 h-4"}),a.jsxs("span",{children:["Total Armor Rating: ",c]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[a.jsx(Ja,{className:"w-5 h-5 text-red-600"})," Weapons"]}),n?a.jsx(Ge,{size:"sm"}):s?a.jsx(Ie,{message:"Could not load item details for weapons."}):d.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No weapons equipped."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Weapon / Shield"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Grip"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Range"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Damage"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Features"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:d.map((j,D)=>{var A;const T=i(j.name),B=T==null?void 0:T.skill,O=Dy(B);let Y=null,G=!1,z=null;if(O&&_f[O]){z=_f[O],Y=(h==null?void 0:h[O])??SI(e,O,z);const M=TI(z);G=((A=e.conditions)==null?void 0:A[M])??!1}const H=Nf(j.features);return a.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:j.name}),a.jsx("td",{className:"px-4 py-2",children:j.grip||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.range||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.damage||"-"}),a.jsx("td",{className:"px-4 py-2",children:H}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[j.damage?a.jsxs(q,{variant:"link",size:"xs",onClick:()=>o(j.name,j.damage),className:"text-red-600 hover:text-red-800 font-medium p-0 flex items-center gap-1",title:`Roll damage for ${j.name} (${j.damage})`,children:[a.jsx(en,{className:"w-3 h-3"}),"Damage"]}):null,O&&Y!==null?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(q,{variant:"link",size:"xs",onClick:()=>u(O,Y,G),className:`${G?"text-red-600 hover:text-red-800":"text-indigo-600 hover:text-indigo-800"} font-medium p-0 flex items-center gap-1`,title:`Roll ${O} check (Target  ${Y}${G?", Bane":""})`,children:[a.jsx(en,{className:"w-3 h-3"}),O,": ",Y]}),G&&a.jsx("span",{className:"text-xs text-red-500 font-semibold",children:"(Bane)"})]}):B?a.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Skill '${B}' not found or level unavailable.`,children:["(",O||B," N/A)"]}):null]})})]},`${j.name}-${D}`)})})]})})]})]})}var EE=(e=>(e.Acrobatics="Acrobatics",e.Arcana="Arcana",e.Athletics="Athletics",e.Deception="Deception",e.History="History",e.Insight="Insight",e.Intimidation="Intimidation",e.Investigation="Investigation",e.Medicine="Medicine",e.Nature="Nature",e.Perception="Perception",e.Performance="Performance",e.Persuasion="Persuasion",e.Religion="Religion",e.SleightOfHand="SleightOfHand",e.Stealth="Stealth",e.Survival="Survival",e))(EE||{});function Z0(e){return typeof e!="object"||e===null?!1:typeof e.skill=="string"&&Object.values(EE).includes(e.skill)&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}function My(e){return typeof e!="object"||e===null?!1:typeof e.skill_id=="string"&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}async function _E(){const{data:e,error:t}=await te.from("heroic_abilities").select(`
      id,
      name,
      description,
      willpower_cost,
      requirement,
      kin,        
      profession  
    `);if(t)throw console.error("Error fetching heroic abilities:",t),new Error(t.message||"Failed to fetch heroic abilities");return(e||[]).map(n=>({id:n.id,name:n.name,description:n.description,willpower_cost:n.willpower_cost,requirement:n.requirement,kin:n.kin,profession:n.profession}))}function II(e){return Rt({queryKey:["heroicAbilities",e],queryFn:async()=>await _E(),staleTime:15*60*1e3})}const RI=e=>Object.entries(e).map(([t,r])=>r!==null?`${t} (Level ${r})`:t).join(", "),LI=e=>e?typeof e=="string"?e:Z0(e)?RI(e):typeof e=="object"?(console.warn("Unexpected requirement object format:",e),`Requires: ${Object.keys(e).join(", ")}`):(console.warn("Unexpected requirement type:",typeof e,e),"Unknown requirement format"):null;function OI({onClose:e}){const{character:t,updateCharacterData:r,isSaving:n,setActiveStatusMessage:s}=ur(),{data:i,isLoading:l,error:o}=II(),[u,c]=w.useState(null);if(Kr.useEffect(()=>{console.log("HeroicAbilitiesView - Character Data:",t)},[t]),!t)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6",children:[a.jsx(Ge,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]})});const d=w.useMemo(()=>{if(!i||!t||!t.heroic_ability)return console.log("Filtering abilities: Missing data",{allAbilities:!!i,character:!!t,heroic_ability:t==null?void 0:t.heroic_ability}),[];const p=new Set(Array.isArray(t.heroic_ability)?t.heroic_ability:[]);console.log("Filtering abilities: Character abilities names:",p);const b=i.filter(E=>p.has(E.name));return console.log("Filtering abilities: Filtered result:",b),b},[i,t]),h=async p=>{c(null),console.log(`Attempting to activate ability: ${p.name}`);const b=p.willpower_cost,E=t.current_wp;if(console.log(`Ability cost: ${b}, Current WP: ${E}`),b==null||b<=0){console.log(`Activated free ability: ${p.name}`),s(`Used Heroic Ability: ${p.name}`);return}if(typeof E!="number"){const x=`Cannot activate ${p.name}: Current Willpower (current_wp) is not a valid number. Value: ${E}`;c(x),console.error(x);return}if(E>=b){const x=E-b;console.log(`Sufficient WP. New WP will be: ${x}`);try{console.log(`Calling updateCharacterData with: { current_wp: ${x} }`),await r({current_wp:x}),console.log(`Successfully activated ability: ${p.name}. WP updated to: ${x}`),s(`Used Heroic Ability: ${p.name} for ${b} WP.`)}catch(y){const v=`Failed to update Willpower for ${p.name}: ${y.message}`;c(v),console.error("Error updating WP via store:",y)}}else{const x=`Not enough Willpower Points to activate ${p.name}. Required: ${b}, Available: ${E}`;c(x),console.warn(x)}},f=()=>l?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx(Ge,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading heroic abilities..."})]}):o?a.jsx("div",{className:"p-6",children:a.jsx(Ie,{message:`Failed to load abilities: ${o.message}`})}):t.profession==="Mage"?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Magic Instead of Heroic Abilities"}),a.jsx("p",{className:"text-sm text-blue-700",children:"As a mage, you use magic instead of heroic abilities. Check the Spells tab to manage your magical capabilities."})]})]})}):!d||d.length===0?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx(Mn,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"No Heroic Abilities Assigned"}),a.jsx("p",{className:"text-sm text-gray-700",children:"This character does not currently have any heroic abilities assigned in their profile (check `characters.heroic_ability`), or the abilities could not be loaded from the `heroic_abilities` table."})]})]})}):a.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[u&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(V2,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800",children:"Activation Failed"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(p=>{const b=p.willpower_cost,E=t.current_wp,x=b==null||b<=0||typeof E=="number"&&E>=b,y=LI(p.requirement);return a.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:p.name}),a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded",children:b!=null&&b>0?a.jsxs(a.Fragment,{children:[a.jsx(Nd,{className:"w-4 h-4 text-amber-500"}),a.jsxs("span",{children:[b," WP"]})]}):a.jsx("span",{className:"text-green-600",children:"Free"})})]}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:p.description}),y&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Requirement: ",y]})]}),a.jsxs(q,{onClick:()=>h(p),disabled:!x||n,loading:n,variant:x?"default":"secondary",size:"sm",className:"w-full mt-4",children:[a.jsx(Fn,{className:"w-4 h-4 mr-2"}),"Activate ",b!=null&&b>0?`(${b} WP)`:""]})]},p.id)})})]}),g=typeof t.current_wp=="number"?t.current_wp:"N/A";return console.log("Displaying WP:",g,"(raw value:",t.current_wp,")"),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(Y0,{className:"w-6 h-6 text-blue-600"}),"Heroic Abilities"]}),a.jsxs("p",{className:"text-gray-600",children:["Available Willpower: ",g," WP"]})]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-3xl leading-none","aria-label":"Close",children:""})]})}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:f()}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(q,{variant:"outline",onClick:e,children:"Close"})})]})})}const Fy={Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},PI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,Gn=e=>{const t=ur.getState().character,r=xl(t==null?void 0:t.skill_levels);return(r==null?void 0:r[e])??0};function DI(e){const t=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming","Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],r=new Set([...e.trainedSkills||[],...e.untrainedSkills||[],...t]);!!e.magicSchool&&Object.keys(Fy).forEach(o=>r.add(o));const s={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",...Fy},i=[],l=xl(e.skill_levels);return r.forEach(o=>{var f;const u=s[o];if(!u)return;const c=((f=e.trainedSkills)==null?void 0:f.includes(o))??!1,h=(l==null?void 0:l[o])??(()=>{const g=e.attributes[u],p=PI(g);return c?p*2:p})();i.push({name:o,attribute:u,level:h,isTrained:c})}),i.sort((o,u)=>o.name.localeCompare(u.name)),i}const MI=(e,t)=>{var l,o;if(!t)return!1;if(!e.requirement)return!0;const r=e.requirement,n=t.attributes,s=xl(t.skill_levels),i=Object.fromEntries(Object.entries(n).map(([u,c])=>[u.toUpperCase(),c]));if(typeof r=="string"){const u=r.split(" ");if(u.length===2){const c=u[0].toUpperCase(),d=parseInt(u[1],10);if(!isNaN(d)){if(c in i)return i[c]>=d;const h=(l=Object.entries(s).find(([f])=>f.toUpperCase()===c))==null?void 0:l[1];if(h!==void 0)return h>=d}}return!1}else if(typeof r=="object"&&r!==null){for(const[u,c]of Object.entries(r)){if(c==null)continue;const d=u.toUpperCase();if(d in i){if(i[d]<c)return!1}else{const h=(o=Object.entries(s).find(([f])=>f.toUpperCase()===d))==null?void 0:o[1];if(h===void 0||h<c)return!1}}return!0}else return!1},NE=e=>{var r;if(!e)return[];const t=[];return e.general&&t.push(...e.general.map(n=>n.toUpperCase())),(r=e.school)!=null&&r.spells&&t.push(...e.school.spells.map(n=>n.toUpperCase())),Array.from(new Set(t))},FI=(e,t,r,n)=>{var E;if(!e)return!0;const s=NE(t.spells),i=xl(t.skill_levels),l=t.attributes,o=x=>{let y=!1;switch(x.type){case"spell":y=s.includes(x.name.toUpperCase());break;case"school":y=(r==null?void 0:r.toUpperCase())===x.name.toUpperCase();break;case"anySchool":y=!!t.magicSchool;break;case"skill":const v=i[x.name];y=v!==void 0&&v>=x.value;break;case"attribute":const k=l[x.name.toLowerCase()];y=k!==void 0&&k>=x.value;break}return x.negate?!y:y};let u;const c=x=>{if(x.operator==="AND"){const y=x.conditions.every(v=>u(v));return x.negate?!y:y}else if(x.operator==="OR"){const y=x.conditions.some(v=>u(v));return x.negate?!y:y}return console.warn("Unknown logical operator in spell prerequisite:",x.operator),!1};u=x=>x.type==="logical"?c(x):o(x);let d=null;try{e.trim().startsWith("{")&&(d=JSON.parse(e))}catch{}if(d&&d.type)return u(d);const h=n.map(x=>x.name.toUpperCase()),f=(E=t.magicSchool)==null?void 0:E.name,g=x=>{const y=x.trim().toUpperCase();if(y==="ANY SCHOOL OF MAGIC")return!!t.magicSchool;if(s.includes(y))return!0;if(h.includes(y))return(f==null?void 0:f.toUpperCase())===y;const v=y.split(" ");if(v.length===2){const[k,_]=v,S=parseInt(_,10);if(!isNaN(S)){const I=Object.keys(l).find(D=>D.toUpperCase()===k);if(I)return l[I]>=S;const j=Object.keys(i).find(D=>D.toUpperCase()===k);if(j)return i[j]>=S}}return!1},p=x=>x.trim().split(/ AND /i).every(g);return e.trim().split(/ OR /i).some(p)};function UI({character:e,onClose:t}){var Ul;const{character:r,markedSkillsThisSession:n,clearMarkedSkillsThisSession:s,increaseSkillLevel:i,addHeroicAbility:l,setSkillUnderStudy:o,learnSpell:u,isSaving:c,saveError:d}=ur(),{toggleDiceRoller:h}=xa(),[f,g]=w.useState("initial"),[p,b]=w.useState(null),[E,x]=w.useState(0),[y,v]=w.useState(new Set),[k,_]=w.useState([]),[S,I]=w.useState(0),[j,D]=w.useState(null),[T,B]=w.useState(null),[O,Y]=w.useState([]),[G,z]=w.useState(!1),[H,A]=w.useState(null),[M,Q]=w.useState(null),[N,K]=w.useState(null),[$,R]=w.useState(null),[me,ce]=w.useState([]),[we,Z]=w.useState([]),[be,ee]=w.useState([]),[de,_e]=w.useState(null),[je,Pe]=w.useState(!1),Fe=r||e,V=w.useMemo(()=>Fe?DI(Fe):[],[Fe]),ye=(Ul=r==null?void 0:r.teacher)==null?void 0:Ul.skillUnderStudy,ie=()=>{b(null),D(null),K(null),x(0),v(new Set),_([]),I(0),B(null),A(null),Q(null),ee([]),_e(null),Pe(!1),z(!1)},ke=()=>{ie(),g("enterMarks")},Le=()=>{ie(),g("selectStudyType")},$e=async()=>{if(!r||!r.magicSchool){b("Character has no magic school assigned."),g("selectStudyType");return}Pe(!0),b(null);try{let U=we;U.length===0&&(U=await lE(),Z(U));let he=me;he.length===0&&(he=await V4(),ce(he));const Te=U.find(st=>st.id===r.magicSchool),Ve=Te?Te.name:null;R(Ve);const rt=NE(r.spells),Ae=he.filter(st=>rt.includes(st.name.toUpperCase())?!1:FI(st.prerequisite,r,Ve,U));ee(Ae),g("studyMagicSelectSpell")}catch(U){console.error("Error loading magic data:",U),b(U instanceof Error?U.message:"Failed to load magic study data."),g("selectStudyType")}finally{Pe(!1)}},tt=U=>{U==="teacher"?g("studyTeacherSelectSkill"):U==="magic"?$e():b("Invalid study type selected.")},ut=U=>{if(U.preventDefault(),E>0){const he=new Set;let Te=0;const Ve=V.map(rt=>rt.name);for(const rt of n)Te<E&&Ve.includes(rt)&&(he.add(rt),Te++);v(he),b(null),g("selectSkills")}else b("Please enter at least one Advancement Mark.")},jt=U=>{v(he=>{const Te=new Set(he);return Te.has(U)?Te.delete(U):Te.size<E&&Te.add(U),Te})},Tr=()=>{if(y.size!==E){b(`Please select exactly ${E} skill(s).`);return}b(null),_(Array.from(y)),I(0),D(null),g("rollSkills")},sn=w.useCallback(async U=>{if(!r){D("Error: Character data not available."),h();return}if(!U.results||U.results.length===0){D("Error: Roll results are missing or empty."),h();return}const he=U.results[0].value,Te=U.skillName,Ve=U.targetValue;if(!Te||Ve===void 0){D("Error: Roll context missing skill information."),h();return}const rt=he>Ve;let Ae=`Rolled ${he} vs ${Te} (Target > ${Ve}). `;if(rt){Ae+="Success! Skill increased.",await i(Te);const st=Gn(Te);Ae+=` New Level: ${st}.`,st===18&&Ve<18&&(B(Te),Ae+=" Reached level 18!")}else Ae+="Failed to increase skill.";D(Ae),h()},[r,i,h,D,B]),J=(U,he)=>{const Te=Gn(U);if(Te>=18){(he==="study"?K:D)(`Skill ${U} is already at max level (18). Cannot advance further.`);return}D(null),K(null);const Ve=he==="study"?qn:sn;h({rollMode:"advancementRoll",targetValue:Te,skillName:U,description:`Advancement Roll: ${U} (d20 vs > ${Te})`,onRollComplete:Ve})},oe=async(U,he)=>{if(!r){(he==="study"?K:D)("Error: Character data not available.");return}const Te=Gn(U),Ve=he==="study"?K:D;if(Te>=18){Ve(`Skill ${U} is already at max level (18). Cannot advance further.`);return}D(null),K(null);let rt=`Manually advanced ${U}. Skill increased.`;await i(U);const Ae=Gn(U);rt+=` New Level: ${Ae}.`,Ae===18&&Te<18&&(he==="endSession"&&B(U),rt+=" Reached level 18!"),Ve(rt)},Se=()=>{D(null),T?(Ue(),g("selectAbility")):S<k.length-1?I(U=>U+1):Hr()},Ue=async()=>{z(!0),b(null);try{const U=await _E(),he=ur.getState().character;if(!he)throw new Error("Character data not available in store for ability filtering.");const Te=he.heroic_ability||[],Ve=U.filter(rt=>{var Ae,st;return!(Te.some(va=>va.toUpperCase()===rt.name.toUpperCase())||rt.kin&&rt.kin.toLowerCase()!==((Ae=he.kin)==null?void 0:Ae.toLowerCase())||rt.profession&&rt.profession.toLowerCase()!==((st=he.profession)==null?void 0:st.toLowerCase())||!MI(rt,he))});Y(Ve)}catch(U){console.error("Error fetching abilities:",U),b(U instanceof Error?U.message:"Failed to load heroic abilities.")}finally{z(!1)}},nt=U=>{A(U)},nr=async()=>{if(!H){b("Please select a heroic ability.");return}b(null),await l(H.name),B(null),A(null),S<k.length-1?(I(U=>U+1),g("rollSkills")):Hr()},Hr=()=>{s(),g("finished")},Cr=U=>{Q(U)},zn=async()=>{if(!M){b("Please select a skill to study.");return}b(null),K(null),await o(M),g("studyTeacherRollSkill")},qn=w.useCallback(async U=>{if(!r){K("Error: Character data not available."),h();return}if(!U.results||U.results.length===0){K("Error: Roll results are missing or empty."),h();return}const he=U.results[0].value,Te=U.skillName,Ve=U.targetValue;if(!Te||Ve===void 0){K("Error: Roll context missing skill information."),h();return}const rt=he>Ve;let Ae=`Studied ${Te}. Rolled ${he} vs Target > ${Ve}. `;if(rt){Ae+="Success! Skill increased.",await i(Te);const st=Gn(Te);Ae+=` New Level: ${st}.`,st===18&&Ve<18&&(Ae+=" Reached level 18!")}else Ae+="Failed to increase skill this time.";K(Ae),h()},[r,i,h,K]),zt=U=>{_e(U)},fr=async()=>{if(!de){b("Please select a spell to learn.");return}if(!u){b("Error: learnSpell function is not available.");return}b(null);try{await u(de.name),t()}catch(U){console.error("Error learning spell:",U),b(U instanceof Error?U.message:"Failed to learn the spell.")}},at=()=>{Q(null),K(null),_e(null),ee([]),t()},Wu=()=>{if(!Fe&&f!=="initial")return a.jsx(Ge,{text:"Loading character data..."});switch(f){case"initial":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Choose an action to proceed."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(q,{onClick:ke,className:"flex-1",children:[a.jsx(co,{className:"w-5 h-5 mr-2"})," End Session & Advance"]}),a.jsxs(q,{onClick:Le,variant:"outline",className:"flex-1",children:[a.jsx(L2,{className:"w-5 h-5 mr-2"})," Study"]})]})]});case"enterMarks":return a.jsxs("form",{onSubmit:ut,className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"End Session Advancement"}),a.jsx("label",{htmlFor:"advancementMarks",className:"block font-medium text-gray-700",children:"How many Advancement Marks did you gain this session?"}),a.jsx("input",{type:"number",id:"advancementMarks",name:"advancementMarks",min:"1",value:E===0?"":E,onChange:Ee=>x(parseInt(Ee.target.value,10)||0),className:"w-full p-2 border rounded focus:ring-blue-500 focus:border-blue-500",required:!0}),p&&a.jsx(Ie,{message:p}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(q,{type:"button",variant:"secondary",onClick:()=>g("initial"),children:[a.jsx(Ql,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(q,{type:"submit",disabled:E<=0,children:["Next ",a.jsx(Ca,{className:"w-4 h-4 ml-1"})]})]})]});case"selectSkills":return Fe?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Select ",E," skill(s) to attempt advancement:"]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:V.length===0?a.jsx("p",{className:"text-gray-500 italic",children:"No skills found for this character."}):V.map(Ee=>{const _n=Gn(Ee.name),Vn=_n>=18,Yu=Ee.name===ye;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Vn?"opacity-60 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",checked:y.has(Ee.name),onChange:()=>jt(Ee.name),disabled:Vn||!y.has(Ee.name)&&y.size>=E,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${Ee.isTrained?"font-semibold":""}`,children:Ee.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",Ee.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",_n]}),Vn&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"}),n.has(Ee.name)&&!Vn&&a.jsx(Nd,{className:"w-4 h-4 text-yellow-500 flex-shrink-0",title:"Marked this session (rolled 1 or 20)"}),Yu&&a.jsx(co,{className:"w-4 h-4 text-purple-600 flex-shrink-0 ml-1",title:"Currently studying with teacher"})]},Ee.name)})}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",y.size," / ",E]}),p&&a.jsx(Ie,{message:p}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(q,{type:"button",variant:"secondary",onClick:()=>g("enterMarks"),children:[a.jsx(Ql,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(q,{onClick:Tr,disabled:y.size!==E,children:["Confirm Selection ",a.jsx(Ca,{className:"w-4 h-4 ml-1"})]})]})]}):a.jsx(Ge,{});case"rollSkills":if(k.length===0||!Fe)return a.jsx(Ge,{text:"Preparing skill roll..."});const U=k[S],he=Gn(U),Te=he>=18,Ve=!!j;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Attempting Advancement (",S+1," / ",k.length,")"]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:U}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",he]}),Te&&!Ve&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Skipped."})]}),j&&a.jsx("div",{className:`p-3 rounded border text-center ${j.includes("Success")||j.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":j.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:j}),d&&a.jsx(Ie,{message:d}),p&&a.jsx(Ie,{message:p}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Ve&&!Te&&a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>J(U,"endSession"),disabled:c,loading:c,children:[a.jsx(en,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",he,")"]}),a.jsxs(q,{variant:"outline",onClick:()=>oe(U,"endSession"),disabled:c,loading:c,children:[a.jsx(Fn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(Ve||Te&&!Ve)&&a.jsxs(q,{onClick:Se,disabled:c,loading:c,children:[T?"Select Heroic Ability":S<k.length-1?"Next Skill":"Finish Session"," ",a.jsx(Ca,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Os,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectAbility":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 flex items-center gap-2",children:[a.jsx(A2,{className:"w-5 h-5"})," Skill ",a.jsx("span",{className:"font-bold",children:T})," reached level 18!"]}),a.jsx("p",{className:"text-gray-700",children:"Select a new Heroic Ability:"}),G&&a.jsx(Ge,{text:"Loading available abilities..."}),p&&a.jsx(Ie,{message:p}),!G&&O.length===0&&!p&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No eligible heroic abilities found for this character."}),!G&&O.length>0&&a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:O.map(Ee=>a.jsxs("div",{onClick:()=>nt(Ee),className:`p-3 rounded border cursor-pointer ${(H==null?void 0:H.id)===Ee.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("p",{className:"font-semibold",children:Ee.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:Ee.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[Ee.willpower_cost&&a.jsxs("span",{children:["WP: ",Ee.willpower_cost]}),Ee.requirement&&typeof Ee.requirement=="object"&&Object.keys(Ee.requirement).length>0&&a.jsxs("span",{children:["Req: ",Object.entries(Ee.requirement).filter(([,_n])=>_n!=null).map(([_n,Vn])=>`${_n} ${Vn}`).join(", ")]}),Ee.requirement&&typeof Ee.requirement=="string"&&a.jsxs("span",{children:["Req: ",Ee.requirement]})]})]},Ee.id))}),d&&a.jsx(Ie,{message:d}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsxs(q,{onClick:nr,disabled:!H||G||c||O.length===0&&!p&&!G,loading:c,children:["Confirm Ability & Continue ",a.jsx(Ca,{className:"w-4 h-4 ml-1"})]})}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Os,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectStudyType":const rt=!!(r!=null&&r.magicSchool);return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Choose Study Method"}),a.jsx("p",{className:"text-gray-600",children:"How would you like to study to improve a skill or learn magic?"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(q,{onClick:()=>tt("teacher"),className:"flex-1",children:[a.jsx(co,{className:"w-5 h-5 mr-2"})," Find a Teacher (Skills)"]}),a.jsxs(q,{onClick:()=>tt("magic"),variant:"outline",className:"flex-1",disabled:!rt||je,loading:je,children:[a.jsx(kd,{className:"w-5 h-5 mr-2"})," Study Magic (Spells)"]})]}),!rt&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Nt,{className:"w-4 h-4 flex-shrink-0"})," Character must belong to a Magic School to study magic."]}),p&&a.jsx(Ie,{message:p}),a.jsx("div",{className:"flex justify-start",children:a.jsxs(q,{type:"button",variant:"secondary",onClick:()=>g("initial"),children:[a.jsx(Ql,{className:"w-4 h-4 mr-1"})," Back"]})})]});case"studyTeacherSelectSkill":return Fe?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Study with a Teacher"}),a.jsx("p",{className:"text-gray-600",children:"Select one skill to focus on improving. You cannot study a skill currently being studied until it has been advanced or study is completed."}),ye&&a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded text-purple-800 text-sm flex items-center gap-2",children:[a.jsx(Mn,{className:"w-4 h-4 flex-shrink-0"}),"Currently studying: ",a.jsx("span",{className:"font-semibold",children:ye}),". Complete or advance this study first to pick another skill."]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:V.map(Ee=>{const _n=Gn(Ee.name),Vn=_n>=18,Yu=Vn||!!ye&&ye!==Ee.name;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Yu?"opacity-60 cursor-not-allowed":M===Ee.name?"bg-blue-100 border border-blue-300":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"radio",name:"studySkill",checked:M===Ee.name,onChange:()=>Cr(Ee.name),disabled:Yu,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${Ee.isTrained?"font-semibold":""}`,children:Ee.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",Ee.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",_n]}),Vn&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"})]},Ee.name)})}),p&&a.jsx(Ie,{message:p}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(q,{type:"button",variant:"secondary",onClick:()=>g("selectStudyType"),children:[a.jsx(Ql,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(q,{onClick:zn,disabled:!M||!!ye||c,loading:c,children:["Confirm Study Skill ",a.jsx(Ca,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Os,{className:"w-4 h-4 animate-spin"})," Saving..."]})]}):a.jsx(Ge,{});case"studyTeacherRollSkill":const Ae=ye||M;if(!Ae||!Fe)return a.jsx(Ie,{message:"Error: No skill selected or found for study, or character data missing."});const st=Gn(Ae),va=st>=18,Gu=!!N;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: ",Ae]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Ae}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",st]}),va&&!Gu&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Study complete."})]}),N&&a.jsx("div",{className:`p-3 rounded border text-center ${N.includes("Success")||N.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":N.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:N}),d&&a.jsx(Ie,{message:d}),p&&a.jsx(Ie,{message:p}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Gu&&!va&&a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>J(Ae,"study"),disabled:c,loading:c,children:[a.jsx(en,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",st,")"]}),a.jsxs(q,{variant:"outline",onClick:()=>oe(Ae,"study"),disabled:c,loading:c,children:[a.jsx(Fn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(Gu||va&&!Gu)&&a.jsxs(q,{onClick:at,disabled:c,loading:c,children:["Finish Study ",a.jsx(Hi,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Os,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSpell":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(kd,{className:"w-5 h-5 text-purple-600"})," Study Magic"]}),$&&a.jsxs("p",{className:"text-gray-600",children:["School: ",a.jsx("span",{className:"font-semibold",children:$})]}),a.jsx("p",{className:"text-gray-600",children:"Select a spell to learn:"}),je&&a.jsx(Ge,{text:"Loading spells..."}),p&&a.jsx(Ie,{message:p}),!je&&be.length===0&&!p&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No new spells available to learn at this time, or prerequisites not met."}),!je&&be.length>0&&a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:be.map(Ee=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(de==null?void 0:de.id)===Ee.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSpell",checked:(de==null?void 0:de.id)===Ee.id,onChange:()=>zt(Ee),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-semibold",children:[Ee.name," ",a.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(Rank ",Ee.rank??"N/A",")"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:Ee.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[Ee.casting_time&&a.jsxs("span",{children:["Cast: ",Ee.casting_time]}),Ee.range&&a.jsxs("span",{children:["Range: ",Ee.range]}),Ee.duration&&a.jsxs("span",{children:["Duration: ",Ee.duration]}),Ee.willpower_cost&&a.jsxs("span",{children:["WP: ",Ee.willpower_cost]}),Ee.prerequisite&&a.jsxs("span",{className:"italic",children:["(Learn Req: ",Ee.prerequisite,")"]}),Ee.casting_requirement&&a.jsxs("span",{className:"italic",children:["(Cast Req: ",Ee.casting_requirement,")"]})]})]})]},Ee.id))}),d&&a.jsx(Ie,{message:d}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(q,{type:"button",variant:"secondary",onClick:()=>{g("selectStudyType"),b(null)},children:[a.jsx(Ql,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(q,{onClick:fr,disabled:!de||je||c||be.length===0&&!p&&!je,loading:c,children:["Learn Selected Spell ",a.jsx(Hi,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Os,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"finished":return a.jsxs("div",{className:"text-center space-y-4 p-6 bg-green-50 rounded border border-green-200",children:[a.jsx(Hi,{className:"w-12 h-12 text-green-500 mx-auto"}),a.jsx("h4",{className:"text-xl font-semibold text-green-800",children:"Session Ended & Advancement Complete!"}),a.jsx("p",{className:"text-gray-700",children:"Character data has been updated. Marked skills for this session have been cleared."}),a.jsx(q,{onClick:t,children:"Done"})]});default:const qN=f;return a.jsxs("p",{children:["Unknown step: ",qN]})}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4 sticky top-0 bg-white z-10",children:[a.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(co,{className:"w-6 h-6 text-blue-600"}),"Character Advancement"]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600","aria-label":"Close advancement modal",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-6",children:Wu()})]})})}function BI({character:e}){const{toggleDiceRoller:t}=xa(),{setDeathRollState:r,adjustStat:n,isSaving:s}=ur(),[i,l]=w.useState(!1),[o,u]=w.useState(null),c=e.death_rolls_passed??0,d=e.death_rolls_failed??0,h=e.is_rallied??!1,f=e.attributes.CON,g=e.attributes.WIL,p=c>=3,b=d>=3,E=D=>{l(!1);const T=D.results[0].value,B=D.isCritical&&D.isSuccess,O=D.isCritical&&!D.isSuccess,Y=D.isSuccess;let G=c,z=d;B?(G+=2,u(`Rolled ${T} (Dragon! +2 Successes)`)):O?(z+=2,u(`Rolled ${T} (Demon! +2 Failures)`)):Y?(G+=1,u(`Rolled ${T} (Success vs CON ${f})`)):(z+=1,u(`Rolled ${T} (Failure vs CON ${f})`)),r(G,z,h),t()},x=D=>{l(!1);const T=D.results[0].value;D.isSuccess?(r(c,d,!0),u(`Rallied! (Rolled ${T} vs WIL ${g} w/ Bane)`)):(r(c,d,!1),u(`Rally Failed (Rolled ${T} vs WIL ${g} w/ Bane)`)),t()},y=D=>{l(!1);const T=D.results[0].value;u(`Recovered ${T} HP!`),n("current_hp",T),t()},v=()=>{i||p||b||(l(!0),u(null),t({rollMode:"deathRoll",targetValue:f,description:`Death Save (d20 vs CON ${f})`,onRollComplete:E}))},k=()=>{i||h||p||b||(l(!0),u(null),t({rollMode:"rallyRoll",targetValue:g,requiresBane:!0,description:`Rally Self (d20 vs WIL ${g}, Bane)`,onRollComplete:x}))},_=()=>{i||!p||b||(l(!0),u(null),t({rollMode:"recoveryRoll",description:"Recovery Roll (1d6 HP)",onRollComplete:y}))},S=D=>{if(p||b||s)return;const T=Math.max(0,Math.min(3,c+D));r(T,d,h)},I=D=>{if(p||b||s)return;const T=Math.max(0,Math.min(3,d+D));r(c,T,h)},j=(D,T,B,O,Y,G)=>a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(O,{className:`w-4 h-4 sm:w-5 sm:h-5 ${Y}`}),a.jsxs("span",{className:"font-medium text-xs sm:text-sm w-16 sm:w-20",children:[D,":"]}),a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{onClick:()=>G(-1),disabled:T===0||p||b||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Decrease ${D}`,children:a.jsx(U2,{className:"w-3 h-3"})}),[...Array(B)].map((z,H)=>a.jsx("div",{className:`w-3 h-3 sm:w-4 sm:h-4 rounded-full border ${H<T?D==="Successes"?"bg-green-500 border-green-600":"bg-red-500 border-red-600":"bg-gray-200 border-gray-300"}`},H)),a.jsx("button",{onClick:()=>G(1),disabled:T===B||p||b||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Increase ${D}`,children:a.jsx(Wt,{className:"w-3 h-3"})})]})]});return a.jsxs("div",{className:"p-3 rounded-lg shadow bg-red-50 border border-red-300 space-y-2",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm text-red-700",children:[a.jsx(_d,{className:"w-4 h-4 text-red-600 animate-pulse"}),"DYING (",e.current_hp," HP)"]}),a.jsxs("div",{className:"space-y-1",children:[j("Successes",c,3,ch,"text-green-500",S),j("Failures",d,3,dh,"text-red-500",I)]}),o&&a.jsx("p",{className:"text-xs text-center text-gray-700 italic",children:o}),h&&!p&&!b&&a.jsxs("p",{className:"text-xs text-center text-yellow-800 bg-yellow-100 p-1 rounded border border-yellow-200 flex items-center justify-center gap-1",children:[a.jsx(Mn,{className:"w-3 h-3"})," Rallied! Can act, but still dying."]}),a.jsx("div",{className:"pt-1 space-y-2",children:b?a.jsx("div",{className:"text-center font-bold text-lg text-red-800 p-2 bg-red-200 rounded",children:"CHARACTER DIED"}):p?a.jsxs(q,{onClick:_,disabled:i||s,loading:i||s,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[a.jsx(q0,{className:"w-4 h-4 mr-1"})," Roll Recovery (1d6 HP)"]}):a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:v,disabled:i||s,loading:i||s,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"sm",children:[a.jsx(_d,{className:"w-4 h-4 mr-1"})," Roll Death Save (d20)"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(q,{onClick:k,disabled:i||s||h,loading:i||s,className:`w-full text-black ${h?"bg-gray-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,size:"sm",children:[a.jsx(W2,{className:"w-4 h-4 mr-1"})," ",h?"Rallied!":"Attempt Rally (Self)"]}),!h&&a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 p-2 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none",children:["Roll d20 vs WIL (",g,") with Bane. Success lets you act while dying.",a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-black rotate-45"})]})]})]})}),s&&a.jsx("div",{className:"text-xs text-center text-blue-600 italic mt-1",children:"Saving..."})]})}function HI(){const e=ur(r=>r.activeStatusMessage),t=ur(r=>r.clearActiveStatusMessage);return e?a.jsxs("div",{className:"my-3 p-3 bg-blue-100 border border-blue-300 rounded-lg shadow-sm flex items-center justify-between animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Fn,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsxs("p",{className:"text-sm text-blue-800",children:["Activated: ",a.jsx("span",{className:"font-semibold",children:e})]})]}),a.jsx("button",{onClick:t,className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full transition-colors","aria-label":"Dismiss status message",children:a.jsx(Lt,{className:"w-4 h-4"})})]}):null}function $I({}){var M,Q,N,K,$,R,me,ce,we;rn();const{toggleDiceRoller:e}=xa(),{character:t,adjustStat:r,toggleCondition:n,performRest:s,updateCharacterData:i,isLoading:l,error:o,isSaving:u,saveError:c,setActiveStatusMessage:d}=ur(),[h,f]=w.useState(!1),[g,p]=w.useState(!1),[b,E]=w.useState(!1),[x,y]=w.useState(!1),[v,k]=w.useState(!1),[_,S]=w.useState(!1),[I,j]=w.useState(!1);if(l)return a.jsx("div",{className:"p-4 text-center",children:"Loading character..."});if(o)return a.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading character: ",o]});if(!t)return a.jsx("div",{className:"p-4 text-center",children:"Character data is not available. Please select a character."});const D=Z=>{n(Z)},T=async Z=>{p(!1),await s(Z,Z==="stretch"?I:void 0),j(!1)},B=(Z,be,ee,de)=>{var Pe;const _e=be??10,je=((Pe=t.conditions)==null?void 0:Pe[de])??!1;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:Z}),a.jsx("span",{className:"text-xl",children:_e})]}),a.jsx("div",{className:"text-sm h-5",children:(Z==="STR"||Z==="AGL")&&_e>12&&a.jsxs("div",{className:"text-blue-400",children:["Damage Bonus: ",_e<=15?"+D4":"+D6"]})})]}),a.jsx("button",{onClick:()=>D(de),className:`absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${je?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${u?"opacity-50 cursor-not-allowed":""}`,disabled:u,title:`Toggle ${de.charAt(0).toUpperCase()+de.slice(1)}`,children:de.toUpperCase().substring(0,3)})]})},O=()=>g?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(fy,{className:"w-6 h-6"})," Choose Rest Type"]}),a.jsx("button",{onClick:()=>{p(!1),j(!1)},className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("shift"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(hh,{className:"w-5 h-5"}),u?"Resting...":"Take Shift Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Shift Rest (~6 hours):"})," Requires a safe location. Recovers all HP & WP, heals all standard conditions. Resets death roll state. Interruption negates effects."]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("stretch"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition-colors",disabled:u||((t==null?void 0:t.current_hp)??0)<=0,children:[a.jsx(Y2,{className:"w-5 h-5"}),u?"Resting...":"Take Stretch Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Stretch Rest (~15 mins):"})," Heal ",I?"2d6":"1d6"," HP, recover 1d6 WP, heal one standard condition. Can only be done once per Shift. Cannot be taken while dying. Interruption negates effects."]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:I,onChange:Z=>j(Z.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:"Healer present for Stretch Rest (requires successful HEALING roll)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Check this if another character is tending to you and succeeds on a HEALING roll during a Stretch Rest."})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("round"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(B2,{className:"w-5 h-5"}),u?"Resting...":"Take Round Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Round Rest (~10 secs):"})," Recover 1d6 WP. No HP recovery. Can only be done once per Shift."]})]})]}),u&&a.jsx("div",{className:"mt-4 text-sm text-center text-gray-500",children:"Saving..."}),c&&a.jsxs("div",{className:"mt-4 text-sm text-center text-red-500",children:["Error: ",c]})]})}):null,Y=()=>{const Z=Array.isArray(t==null?void 0:t.trainedSkills)?t.trainedSkills:[];return(t==null?void 0:t.profession)==="Mage"||Z.some(be=>typeof be=="string"&&["ELEMENTALISM","ANIMISM","MENTALISM"].includes(be.toUpperCase()))},G=(t==null?void 0:t.current_hp)??0,z=(t==null?void 0:t.current_wp)??0,H=(t==null?void 0:t.max_hp)??((M=t==null?void 0:t.attributes)==null?void 0:M.CON)??10,A=(t==null?void 0:t.max_wp)??((Q=t==null?void 0:t.attributes)==null?void 0:Q.WIL)??10;return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:t.name}),a.jsxs("p",{className:"text-gray-600 text-lg",children:[t.kin||"Unknown Kin"," ",t.profession||"Unknown Profession"," - Age: ",t.age||"Unknown"]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(iu,{className:"w-4 h-4"}),"Inventory"]}),a.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm transition-colors",children:[a.jsx(fy,{className:"w-4 h-4"}),"Rest"]}),a.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-black rounded-lg hover:bg-yellow-600 text-sm transition-colors",children:[a.jsx(A2,{className:"w-4 h-4"}),"Session"]})]})]}),a.jsx(HI,{}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-x-4 gap-y-6",children:[B("STR",(N=t.attributes)==null?void 0:N.STR,a.jsx(CA,{}),"exhausted"),B("CON",(K=t.attributes)==null?void 0:K.CON,a.jsx(V0,{}),"sickly"),B("AGL",($=t.attributes)==null?void 0:$.AGL,a.jsx(jA,{}),"dazed"),B("INT",(R=t.attributes)==null?void 0:R.INT,a.jsx(O2,{}),"angry"),B("WIL",(me=t.attributes)==null?void 0:me.WIL,a.jsx(Fn,{}),"scared"),B("CHA",(ce=t.attributes)==null?void 0:ce.CHA,a.jsx(JA,{}),"disheartened")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start",children:[a.jsxs("div",{className:"md:col-span-6 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(Du,{className:"w-4 h-4"}),"Skills"]}),Y()&&a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm transition-colors",children:[a.jsx($i,{className:"w-4 h-4"}),"Spells"]}),a.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm transition-colors",children:[a.jsx(GA,{className:"w-4 h-4"}),"Abilities"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 text-white rounded-lg text-sm self-start",children:[a.jsx("span",{className:"font-medium",children:"Movement:"}),a.jsxs("span",{className:"font-bold text-lg",children:[hI(t.kin,(we=t.attributes)==null?void 0:we.AGL),"m"]})]})]}),a.jsxs("div",{className:"md:col-span-6 grid grid-cols-2 gap-4",children:[G>0?a.jsxs("div",{className:"p-3 rounded-lg shadow bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(q0,{className:"w-4 h-4 text-red-600"}),"HP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[G," / ",H]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_hp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:u||G<=0,title:"Decrease HP",children:"-"}),a.jsx("button",{onClick:()=>r("current_hp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:G>=H||u,title:"Increase HP",children:"+"})]})]}):a.jsx(BI,{character:t}),a.jsxs("div",{className:"p-3 bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(Fn,{className:"w-4 h-4 text-blue-600"}),"WP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[z," / ",A]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_wp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:z===0||u,title:"Decrease WP",children:"-"}),a.jsx("button",{onClick:()=>r("current_wp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:z>=A||u,title:"Increase WP",children:"+"})]})]})]})]}),a.jsx(AI,{character:t}),b&&a.jsx(yI,{onClose:()=>E(!1)}),h&&a.jsx(EI,{onClose:()=>f(!1)}),x&&a.jsx(NI,{onClose:()=>y(!1)}),v&&a.jsx(UI,{character:t,onClose:()=>k(!1)}),_&&a.jsx(OI,{onClose:()=>S(!1)}),O(),u&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50 animate-pulse",children:"Saving..."}),c&&a.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50",children:["Save Error: ",c]})]})}function zI(){const{character:e,activeEncounter:t,currentCombatant:r,isLoadingEncounter:n,encounterError:s,drawInitiative:i,isSaving:l,fetchActiveEncounter:o}=ur(),[u,c]=w.useState(!1);if(w.useEffect(()=>{e!=null&&e.party_id&&(e!=null&&e.id)&&o(e.party_id,e.id)},[e==null?void 0:e.party_id,e==null?void 0:e.id,o]),w.useEffect(()=>{if(!(t!=null&&t.id)||!(e!=null&&e.party_id)||!(e!=null&&e.id))return;const g=te.channel(`player-encounter-updates-${e.id}`).on("postgres_changes",{event:"*",schema:"public",table:"encounters",filter:`id=eq.${t.id}`},()=>{o(e.party_id,e.id)}).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${t.id}`},()=>{o(e.party_id,e.id)}).subscribe();return()=>{te.removeChannel(g)}},[t==null?void 0:t.id,e==null?void 0:e.party_id,e==null?void 0:e.id,o]),!(e!=null&&e.party_id))return null;const d=(t==null?void 0:t.status)==="active",h=d?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",f=d?"Encounter Active":"Party Chat";return a.jsxs(a.Fragment,{children:[a.jsx("button",{className:`fixed bottom-4 right-4 p-4 rounded-full shadow-lg text-white transition-colors duration-200 z-40 ${h}`,onClick:()=>c(!u),"aria-label":f,children:d?a.jsx(en,{size:24}):a.jsx(BA,{size:24})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-end z-30",onClick:()=>c(!1),children:a.jsxs("div",{className:"bg-white w-full max-w-sm h-full shadow-xl flex flex-col",onClick:g=>g.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:d?"Active Encounter":"Party Chat"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{size:24})})]}),a.jsx("div",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:n&&!t?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Os,{className:"w-8 h-8 animate-spin text-gray-500"})}):s?a.jsx("div",{className:"text-red-600 text-center",children:s}):t?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-semibold",children:t.name}),t.description&&a.jsx("p",{className:"text-gray-600 text-sm",children:t.description}),a.jsxs("p",{className:"text-sm",children:["Status: ",a.jsx("span",{className:"font-medium",children:t.status})]}),t.current_round!=null&&a.jsxs("p",{className:"text-sm",children:["Round: ",a.jsx("span",{className:"font-medium",children:t.current_round})]}),r?a.jsxs("div",{className:"border p-3 rounded-md bg-blue-50 space-y-2",children:[a.jsx("p",{className:"font-semibold",children:"Your Combatant:"}),a.jsxs("p",{className:"text-sm",children:["Name: ",r.display_name]}),a.jsxs("p",{className:"text-sm",children:["Initiative: ",a.jsx("span",{className:"font-medium",children:r.initiative_roll??"Not Set"})]}),d&&r.initiative_roll===null&&a.jsx(q,{onClick:i,disabled:l,loading:l,Icon:en,size:"sm",children:"Draw Initiative (1-10)"})]}):a.jsx("p",{className:"text-yellow-600 text-sm",children:"You are in a party with an active encounter, but your character is not yet added as a combatant."}),a.jsxs("div",{className:"border-t pt-4 mt-4",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Chat (Coming Soon)"}),a.jsx("p",{className:"text-gray-500 text-sm italic",children:"Real-time chat functionality will be available here."})]})]}):a.jsx("div",{className:"text-gray-600 text-center",children:"No active encounter for this party."})}),a.jsx("div",{className:"p-4 border-t bg-gray-50",children:a.jsx("input",{type:"text",placeholder:"Chat is coming soon...",className:"w-full px-3 py-2 border rounded-md bg-gray-200 cursor-not-allowed",disabled:!0})})]})})]})}function qI(){const{id:e}=P0(),{user:t}=Mt(),{character:r,isLoading:n,error:s,fetchCharacter:i,setCharacter:l}=ur();return w.useEffect(()=>{let o=!0;return(async()=>{if(e&&(t!=null&&t.id))try{await i(e,t.id)}catch(c){console.error("Error loading character in CharacterPage:",c)}else e?t!=null&&t.id||(console.warn("CharacterPage: User ID is missing, cannot load character."),o&&l(null)):(console.warn("CharacterPage: ID is missing, cannot load character."),o&&l(null))})(),()=>{o=!1,l(null)}},[e,t==null?void 0:t.id,i,l]),n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(Ge,{size:"lg"})}):s?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:s})}):r?a.jsxs(a.Fragment,{children:[a.jsx($I,{}),a.jsx(zI,{})]}):a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:"Character not found, does not exist, or you may not have permission to view it."})})}function Uy(e){const t=[],r=String(e||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const l=r.slice(s,n).trim();(l||!i)&&t.push(l),s=n+1,n=r.indexOf(",",s)}return t}function kE(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const VI=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,WI=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,GI={};function By(e,t){return(GI.jsx?WI:VI).test(e)}const YI=/[ \t\n\f\r]/g;function QI(e){return typeof e=="object"?e.type==="text"?Hy(e.value):!1:Hy(e)}function Hy(e){return e.replace(YI,"")===""}class Fu{constructor(t,r,n){this.property=t,this.normal=r,n&&(this.space=n)}}Fu.prototype.property={};Fu.prototype.normal={};Fu.prototype.space=null;function SE(e,t){const r={},n={};let s=-1;for(;++s<e.length;)Object.assign(r,e[s].property),Object.assign(n,e[s].normal);return new Fu(r,n,t)}function ou(e){return e.toLowerCase()}class nn{constructor(t,r){this.property=t,this.attribute=r}}nn.prototype.space=null;nn.prototype.boolean=!1;nn.prototype.booleanish=!1;nn.prototype.overloadedBoolean=!1;nn.prototype.number=!1;nn.prototype.commaSeparated=!1;nn.prototype.spaceSeparated=!1;nn.prototype.commaOrSpaceSeparated=!1;nn.prototype.mustUseProperty=!1;nn.prototype.defined=!1;let KI=0;const De=oi(),At=oi(),TE=oi(),ue=oi(),dt=oi(),Vi=oi(),jr=oi();function oi(){return 2**++KI}const fp=Object.freeze(Object.defineProperty({__proto__:null,boolean:De,booleanish:At,commaOrSpaceSeparated:jr,commaSeparated:Vi,number:ue,overloadedBoolean:TE,spaceSeparated:dt},Symbol.toStringTag,{value:"Module"})),kf=Object.keys(fp);class X0 extends nn{constructor(t,r,n,s){let i=-1;if(super(t,r),$y(this,"space",s),typeof n=="number")for(;++i<kf.length;){const l=kf[i];$y(this,kf[i],(n&fp[l])===fp[l])}}}X0.prototype.defined=!0;function $y(e,t,r){r&&(e[t]=r)}const ZI={}.hasOwnProperty;function Ol(e){const t={},r={};let n;for(n in e.properties)if(ZI.call(e.properties,n)){const s=e.properties[n],i=new X0(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[ou(n)]=n,r[ou(i.attribute)]=n}return new Fu(t,r,e.space)}const CE=Ol({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),jE=Ol({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function AE(e,t){return t in e?e[t]:t}function IE(e,t){return AE(e,t.toLowerCase())}const RE=Ol({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:IE,properties:{xmlns:null,xmlnsXLink:null}}),LE=Ol({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:At,ariaAutoComplete:null,ariaBusy:At,ariaChecked:At,ariaColCount:ue,ariaColIndex:ue,ariaColSpan:ue,ariaControls:dt,ariaCurrent:null,ariaDescribedBy:dt,ariaDetails:null,ariaDisabled:At,ariaDropEffect:dt,ariaErrorMessage:null,ariaExpanded:At,ariaFlowTo:dt,ariaGrabbed:At,ariaHasPopup:null,ariaHidden:At,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:dt,ariaLevel:ue,ariaLive:null,ariaModal:At,ariaMultiLine:At,ariaMultiSelectable:At,ariaOrientation:null,ariaOwns:dt,ariaPlaceholder:null,ariaPosInSet:ue,ariaPressed:At,ariaReadOnly:At,ariaRelevant:null,ariaRequired:At,ariaRoleDescription:dt,ariaRowCount:ue,ariaRowIndex:ue,ariaRowSpan:ue,ariaSelected:At,ariaSetSize:ue,ariaSort:null,ariaValueMax:ue,ariaValueMin:ue,ariaValueNow:ue,ariaValueText:null,role:null}}),XI=Ol({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:IE,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Vi,acceptCharset:dt,accessKey:dt,action:null,allow:null,allowFullScreen:De,allowPaymentRequest:De,allowUserMedia:De,alt:null,as:null,async:De,autoCapitalize:null,autoComplete:dt,autoFocus:De,autoPlay:De,blocking:dt,capture:null,charSet:null,checked:De,cite:null,className:dt,cols:ue,colSpan:null,content:null,contentEditable:At,controls:De,controlsList:dt,coords:ue|Vi,crossOrigin:null,data:null,dateTime:null,decoding:null,default:De,defer:De,dir:null,dirName:null,disabled:De,download:TE,draggable:At,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:De,formTarget:null,headers:dt,height:ue,hidden:De,high:ue,href:null,hrefLang:null,htmlFor:dt,httpEquiv:dt,id:null,imageSizes:null,imageSrcSet:null,inert:De,inputMode:null,integrity:null,is:null,isMap:De,itemId:null,itemProp:dt,itemRef:dt,itemScope:De,itemType:dt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:De,low:ue,manifest:null,max:null,maxLength:ue,media:null,method:null,min:null,minLength:ue,multiple:De,muted:De,name:null,nonce:null,noModule:De,noValidate:De,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:De,optimum:ue,pattern:null,ping:dt,placeholder:null,playsInline:De,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:De,referrerPolicy:null,rel:dt,required:De,reversed:De,rows:ue,rowSpan:ue,sandbox:dt,scope:null,scoped:De,seamless:De,selected:De,shadowRootClonable:De,shadowRootDelegatesFocus:De,shadowRootMode:null,shape:null,size:ue,sizes:null,slot:null,span:ue,spellCheck:At,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ue,step:null,style:null,tabIndex:ue,target:null,title:null,translate:null,type:null,typeMustMatch:De,useMap:null,value:At,width:ue,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:dt,axis:null,background:null,bgColor:null,border:ue,borderColor:null,bottomMargin:ue,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:De,declare:De,event:null,face:null,frame:null,frameBorder:null,hSpace:ue,leftMargin:ue,link:null,longDesc:null,lowSrc:null,marginHeight:ue,marginWidth:ue,noResize:De,noHref:De,noShade:De,noWrap:De,object:null,profile:null,prompt:null,rev:null,rightMargin:ue,rules:null,scheme:null,scrolling:At,standby:null,summary:null,text:null,topMargin:ue,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ue,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:De,disableRemotePlayback:De,prefix:null,property:null,results:ue,security:null,unselectable:null}}),JI=Ol({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:AE,properties:{about:jr,accentHeight:ue,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ue,amplitude:ue,arabicForm:null,ascent:ue,attributeName:null,attributeType:null,azimuth:ue,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ue,by:null,calcMode:null,capHeight:ue,className:dt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ue,diffuseConstant:ue,direction:null,display:null,dur:null,divisor:ue,dominantBaseline:null,download:De,dx:null,dy:null,edgeMode:null,editable:null,elevation:ue,enableBackground:null,end:null,event:null,exponent:ue,externalResourcesRequired:null,fill:null,fillOpacity:ue,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Vi,g2:Vi,glyphName:Vi,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ue,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ue,horizOriginX:ue,horizOriginY:ue,id:null,ideographic:ue,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ue,k:ue,k1:ue,k2:ue,k3:ue,k4:ue,kernelMatrix:jr,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ue,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ue,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ue,overlineThickness:ue,paintOrder:null,panose1:null,path:null,pathLength:ue,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:dt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ue,pointsAtY:ue,pointsAtZ:ue,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:jr,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:jr,rev:jr,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:jr,requiredFeatures:jr,requiredFonts:jr,requiredFormats:jr,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ue,specularExponent:ue,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ue,strikethroughThickness:ue,string:null,stroke:null,strokeDashArray:jr,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ue,strokeOpacity:ue,strokeWidth:null,style:null,surfaceScale:ue,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:jr,tabIndex:ue,tableValues:null,target:null,targetX:ue,targetY:ue,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:jr,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ue,underlineThickness:ue,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ue,values:null,vAlphabetic:ue,vMathematical:ue,vectorEffect:null,vHanging:ue,vIdeographic:ue,version:null,vertAdvY:ue,vertOriginX:ue,vertOriginY:ue,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ue,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),e5=/^data[-\w.:]+$/i,zy=/-[a-z]/g,t5=/[A-Z]/g;function yh(e,t){const r=ou(t);let n=t,s=nn;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&e5.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(zy,n5);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!zy.test(i)){let l=i.replace(t5,r5);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}s=X0}return new s(n,t)}function r5(e){return"-"+e.toLowerCase()}function n5(e){return e.charAt(1).toUpperCase()}const s5={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Uu=SE([jE,CE,RE,LE,XI],"html"),ya=SE([jE,CE,RE,LE,JI],"svg");function qy(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function OE(e){return e.join(" ").trim()}var PE={},Vy=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,a5=/\n/g,i5=/^\s*/,l5=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,o5=/^:\s*/,u5=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,c5=/^[;\s]*/,d5=/^\s+|\s+$/g,h5=`
`,Wy="/",Gy="*",ja="",f5="comment",m5="declaration",p5=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(p){var b=p.match(a5);b&&(r+=b.length);var E=p.lastIndexOf(h5);n=~E?p.length-E:n+p.length}function i(){var p={line:r,column:n};return function(b){return b.position=new l(p),c(),b}}function l(p){this.start=p,this.end={line:r,column:n},this.source=t.source}l.prototype.content=e;function o(p){var b=new Error(t.source+":"+r+":"+n+": "+p);if(b.reason=p,b.filename=t.source,b.line=r,b.column=n,b.source=e,!t.silent)throw b}function u(p){var b=p.exec(e);if(b){var E=b[0];return s(E),e=e.slice(E.length),b}}function c(){u(i5)}function d(p){var b;for(p=p||[];b=h();)b!==!1&&p.push(b);return p}function h(){var p=i();if(!(Wy!=e.charAt(0)||Gy!=e.charAt(1))){for(var b=2;ja!=e.charAt(b)&&(Gy!=e.charAt(b)||Wy!=e.charAt(b+1));)++b;if(b+=2,ja===e.charAt(b-1))return o("End of comment missing");var E=e.slice(2,b-2);return n+=2,s(E),e=e.slice(b),n+=2,p({type:f5,comment:E})}}function f(){var p=i(),b=u(l5);if(b){if(h(),!u(o5))return o("property missing ':'");var E=u(u5),x=p({type:m5,property:Yy(b[0].replace(Vy,ja)),value:E?Yy(E[0].replace(Vy,ja)):ja});return u(c5),x}}function g(){var p=[];d(p);for(var b;b=f();)b!==!1&&(p.push(b),d(p));return p}return c(),g()};function Yy(e){return e?e.replace(d5,ja):ja}var g5=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PE,"__esModule",{value:!0});var Qy=PE.default=y5,x5=g5(p5);function y5(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,x5.default)(e),s=typeof t=="function";return n.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;s?t(l,o,i):o&&(r=r||{},r[l]=o)}}),r}const b5=Qy.default||Qy,bh=DE("end"),Hn=DE("start");function DE(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function ME(e){const t=Hn(e),r=bh(e);if(t&&r)return{start:t,end:r}}function Ao(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Ky(e.position):"start"in e||"end"in e?Ky(e):"line"in e||"column"in e?mp(e):""}function mp(e){return Zy(e&&e.line)+":"+Zy(e&&e.column)}function Ky(e){return mp(e&&e.start)+"-"+mp(e&&e.end)}function Zy(e){return e&&typeof e=="number"?e:1}class tr extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},l=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof t=="string"?s=t:!i.cause&&t&&(l=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=o?o.line:void 0,this.name=Ao(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}tr.prototype.file="";tr.prototype.name="";tr.prototype.reason="";tr.prototype.message="";tr.prototype.stack="";tr.prototype.column=void 0;tr.prototype.line=void 0;tr.prototype.ancestors=void 0;tr.prototype.cause=void 0;tr.prototype.fatal=void 0;tr.prototype.place=void 0;tr.prototype.ruleId=void 0;tr.prototype.source=void 0;const J0={}.hasOwnProperty,v5=new Map,w5=/[A-Z]/g,E5=/-([a-z])/g,_5=new Set(["table","tbody","thead","tfoot","tr"]),N5=new Set(["td","th"]),FE="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function k5(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=L5(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=R5(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?ya:Uu,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=UE(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function UE(e,t,r){if(t.type==="element")return S5(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return T5(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return j5(e,t,r);if(t.type==="mdxjsEsm")return C5(e,t);if(t.type==="root")return A5(e,t,r);if(t.type==="text")return I5(e,t)}function S5(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=ya,e.schema=s),e.ancestors.push(t);const i=HE(e,t.tagName,!1),l=O5(e,t);let o=tg(e,t);return _5.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!QI(u):!0})),BE(e,l,i,t),eg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function T5(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}uu(e,t.position)}function C5(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);uu(e,t.position)}function j5(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=ya,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:HE(e,t.name,!0),l=P5(e,t),o=tg(e,t);return BE(e,l,i,t),eg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function A5(e,t,r){const n={};return eg(n,tg(e,t)),e.create(t,e.Fragment,n,r)}function I5(e,t){return t.value}function BE(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function eg(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function R5(e,t,r){return n;function n(s,i,l,o){const c=Array.isArray(l.children)?r:t;return o?c(i,l,o):c(i,l)}}function L5(e,t){return r;function r(n,s,i,l){const o=Array.isArray(i.children),u=Hn(n);return t(s,i,l,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function O5(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&J0.call(t.properties,s)){const i=D5(e,s,t.properties[s]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&N5.has(t.tagName)?n=o:r[l]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function P5(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else uu(e,t.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else uu(e,t.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function tg(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:v5;for(;++n<t.children.length;){const i=t.children[n];let l;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const c=s.get(u)||0;l=u+"-"+c,s.set(u,c+1)}}const o=UE(e,i,l);o!==void 0&&r.push(o)}return r}function D5(e,t,r){const n=yh(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?kE(r):OE(r)),n.property==="style"){let s=typeof r=="object"?r:M5(e,String(r));return e.stylePropertyNameCase==="css"&&(s=F5(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?s5[n.property]||n.property:n.attribute,r]}}function M5(e,t){const r={};try{b5(t,n)}catch(s){if(!e.ignoreInvalidStyle){const i=s,l=new tr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=FE+"#cannot-parse-style-attribute",l}}return r;function n(s,i){let l=s;l.slice(0,2)!=="--"&&(l.slice(0,4)==="-ms-"&&(l="ms-"+l.slice(4)),l=l.replace(E5,B5)),r[l]=i}}function HE(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,l;for(;++i<s.length;){const o=By(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}n=l}else n=By(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return J0.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);uu(e)}function uu(e,t){const r=new tr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=FE+"#cannot-handle-mdx-estrees-without-createevaluater",r}function F5(e){const t={};let r;for(r in e)J0.call(e,r)&&(t[U5(r)]=e[r]);return t}function U5(e){let t=e.replace(w5,H5);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function B5(e,t){return t.toUpperCase()}function H5(e){return"-"+e.toLowerCase()}const Sf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},$5={};function rg(e,t){const r=$5,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return $E(e,n,s)}function $E(e,t,r){if(z5(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Xy(e.children,t,r)}return Array.isArray(e)?Xy(e,t,r):""}function Xy(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=$E(e[s],t,r);return n.join("")}function z5(e){return!!(e&&typeof e=="object")}const Jy=document.createElement("i");function ng(e){const t="&"+e+";";Jy.innerHTML=t;const r=Jy.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Pr(e,t,r,n){const s=e.length;let i=0,l;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)l=Array.from(n),l.unshift(t,r),e.splice(...l);else for(r&&e.splice(t,r);i<n.length;)l=n.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function Gr(e,t){return e.length>0?(Pr(e,e.length,0,t),e):t}const eb={}.hasOwnProperty;function zE(e){const t={};let r=-1;for(;++r<e.length;)q5(t,e[r]);return t}function q5(e,t){let r;for(r in t){const s=(eb.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let l;if(i)for(l in i){eb.call(s,l)||(s[l]=[]);const o=i[l];V5(s[l],Array.isArray(o)?o:o?[o]:[])}}}function V5(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Pr(e,0,0,n)}function qE(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function yn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const lr=ba(/[A-Za-z]/),Xt=ba(/[\dA-Za-z]/),W5=ba(/[#-'*+\--9=?A-Z^-~]/);function Sd(e){return e!==null&&(e<32||e===127)}const pp=ba(/\d/),G5=ba(/[\dA-Fa-f]/),Y5=ba(/[!-/:-@[-`{-~]/);function Ce(e){return e!==null&&e<-2}function ot(e){return e!==null&&(e<0||e===32)}function Ye(e){return e===-2||e===-1||e===32}const vh=ba(new RegExp("\\p{P}|\\p{S}","u")),ei=ba(/\s/);function ba(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Pl(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const i=e.charCodeAt(r);let l="";if(i===37&&Xt(e.charCodeAt(r+1))&&Xt(e.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),s=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(n,r),encodeURIComponent(l)),n=r+s+1,l=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function Je(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(u){return Ye(u)?(e.enter(r),o(u)):t(u)}function o(u){return Ye(u)&&i++<s?(e.consume(u),o):(e.exit(r),t(u))}}const Q5={tokenize:K5};function K5(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Je(e,t,"linePrefix")}function s(o){return e.enter("paragraph"),i(o)}function i(o){const u=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=u),r=u,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Ce(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const Z5={tokenize:X5},tb={tokenize:J5};function X5(e){const t=this,r=[];let n=0,s,i,l;return o;function o(v){if(n<r.length){const k=r[n];return t.containerState=k[1],e.attempt(k[0].continuation,u,c)(v)}return c(v)}function u(v){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&y();const k=t.events.length;let _=k,S;for(;_--;)if(t.events[_][0]==="exit"&&t.events[_][1].type==="chunkFlow"){S=t.events[_][1].end;break}x(n);let I=k;for(;I<t.events.length;)t.events[I][1].end={...S},I++;return Pr(t.events,_+1,0,t.events.slice(k)),t.events.length=I,c(v)}return o(v)}function c(v){if(n===r.length){if(!s)return f(v);if(s.currentConstruct&&s.currentConstruct.concrete)return p(v);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(tb,d,h)(v)}function d(v){return s&&y(),x(n),f(v)}function h(v){return t.parser.lazy[t.now().line]=n!==r.length,l=t.now().offset,p(v)}function f(v){return t.containerState={},e.attempt(tb,g,p)(v)}function g(v){return n++,r.push([t.currentConstruct,t.containerState]),f(v)}function p(v){if(v===null){s&&y(),x(0),e.consume(v);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),b(v)}function b(v){if(v===null){E(e.exit("chunkFlow"),!0),x(0),e.consume(v);return}return Ce(v)?(e.consume(v),E(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(v),b)}function E(v,k){const _=t.sliceStream(v);if(k&&_.push(null),v.previous=i,i&&(i.next=v),i=v,s.defineSkip(v.start),s.write(_),t.parser.lazy[v.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<l&&(!s.events[S][1].end||s.events[S][1].end.offset>l))return;const I=t.events.length;let j=I,D,T;for(;j--;)if(t.events[j][0]==="exit"&&t.events[j][1].type==="chunkFlow"){if(D){T=t.events[j][1].end;break}D=!0}for(x(n),S=I;S<t.events.length;)t.events[S][1].end={...T},S++;Pr(t.events,j+1,0,t.events.slice(I)),t.events.length=S}}function x(v){let k=r.length;for(;k-- >v;){const _=r[k];t.containerState=_[1],_[0].exit.call(t,e)}r.length=v}function y(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function J5(e,t,r){return Je(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function yl(e){if(e===null||ot(e)||ei(e))return 1;if(vh(e))return 2}function wh(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const gp={name:"attention",resolveAll:eR,tokenize:tR};function eR(e,t){let r=-1,n,s,i,l,o,u,c,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h={...e[n][1].end},f={...e[r][1].start};rb(h,-u),rb(f,u),l={type:u>1?"strongSequence":"emphasisSequence",start:h,end:{...e[n][1].end}},o={type:u>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},i={type:u>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:u>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[n][1].end={...l.start},e[r][1].start={...o.end},c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=Gr(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=Gr(c,[["enter",s,t],["enter",l,t],["exit",l,t],["enter",i,t]]),c=Gr(c,wh(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=Gr(c,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,c=Gr(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,Pr(e,n-1,r-n+3,c),r=n+c.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function tR(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=yl(n);let i;return l;function l(u){return i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const c=e.exit("attentionSequence"),d=yl(u),h=!d||d===2&&s||r.includes(u),f=!s||s===2&&d||r.includes(n);return c._open=!!(i===42?h:h&&(s||!f)),c._close=!!(i===42?f:f&&(d||!h)),t(u)}}function rb(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const rR={name:"autolink",tokenize:nR};function nR(e,t,r){let n=0;return s;function s(g){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(g){return lr(g)?(e.consume(g),l):g===64?r(g):c(g)}function l(g){return g===43||g===45||g===46||Xt(g)?(n=1,o(g)):c(g)}function o(g){return g===58?(e.consume(g),n=0,u):(g===43||g===45||g===46||Xt(g))&&n++<32?(e.consume(g),o):(n=0,c(g))}function u(g){return g===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):g===null||g===32||g===60||Sd(g)?r(g):(e.consume(g),u)}function c(g){return g===64?(e.consume(g),d):W5(g)?(e.consume(g),c):r(g)}function d(g){return Xt(g)?h(g):r(g)}function h(g){return g===46?(e.consume(g),n=0,d):g===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):f(g)}function f(g){if((g===45||Xt(g))&&n++<63){const p=g===45?f:h;return e.consume(g),p}return r(g)}}const Bu={partial:!0,tokenize:sR};function sR(e,t,r){return n;function n(i){return Ye(i)?Je(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||Ce(i)?t(i):r(i)}}const VE={continuation:{tokenize:iR},exit:lR,name:"blockQuote",tokenize:aR};function aR(e,t,r){const n=this;return s;function s(l){if(l===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return r(l)}function i(l){return Ye(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function iR(e,t,r){const n=this;return s;function s(l){return Ye(l)?Je(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(VE,t,r)(l)}}function lR(e){e.exit("blockQuote")}const WE={name:"characterEscape",tokenize:oR};function oR(e,t,r){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return Y5(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(i)}}const GE={name:"characterReference",tokenize:uR};function uR(e,t,r){const n=this;let s=0,i,l;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),u}function u(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,l=Xt,d(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=G5,d):(e.enter("characterReferenceValue"),i=7,l=pp,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return l===Xt&&!ng(n.sliceSerialize(f))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(h)&&s++<i?(e.consume(h),d):r(h)}}const nb={partial:!0,tokenize:dR},sb={concrete:!0,name:"codeFenced",tokenize:cR};function cR(e,t,r){const n=this,s={partial:!0,tokenize:_};let i=0,l=0,o;return u;function u(S){return c(S)}function c(S){const I=n.events[n.events.length-1];return i=I&&I[1].type==="linePrefix"?I[2].sliceSerialize(I[1],!0).length:0,o=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===o?(l++,e.consume(S),d):l<3?r(S):(e.exit("codeFencedFenceSequence"),Ye(S)?Je(e,h,"whitespace")(S):h(S))}function h(S){return S===null||Ce(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(nb,b,k)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||Ce(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(S)):Ye(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Je(e,g,"whitespace")(S)):S===96&&S===o?r(S):(e.consume(S),f)}function g(S){return S===null||Ce(S)?h(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),p(S))}function p(S){return S===null||Ce(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(S)):S===96&&S===o?r(S):(e.consume(S),p)}function b(S){return e.attempt(s,k,E)(S)}function E(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&Ye(S)?Je(e,y,"linePrefix",i+1)(S):y(S)}function y(S){return S===null||Ce(S)?e.check(nb,b,k)(S):(e.enter("codeFlowValue"),v(S))}function v(S){return S===null||Ce(S)?(e.exit("codeFlowValue"),y(S)):(e.consume(S),v)}function k(S){return e.exit("codeFenced"),t(S)}function _(S,I,j){let D=0;return T;function T(z){return S.enter("lineEnding"),S.consume(z),S.exit("lineEnding"),B}function B(z){return S.enter("codeFencedFence"),Ye(z)?Je(S,O,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(z):O(z)}function O(z){return z===o?(S.enter("codeFencedFenceSequence"),Y(z)):j(z)}function Y(z){return z===o?(D++,S.consume(z),Y):D>=l?(S.exit("codeFencedFenceSequence"),Ye(z)?Je(S,G,"whitespace")(z):G(z)):j(z)}function G(z){return z===null||Ce(z)?(S.exit("codeFencedFence"),I(z)):j(z)}}}function dR(e,t,r){const n=this;return s;function s(l){return l===null?r(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}const Tf={name:"codeIndented",tokenize:fR},hR={partial:!0,tokenize:mR};function fR(e,t,r){const n=this;return s;function s(c){return e.enter("codeIndented"),Je(e,i,"linePrefix",5)(c)}function i(c){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?l(c):r(c)}function l(c){return c===null?u(c):Ce(c)?e.attempt(hR,l,u)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||Ce(c)?(e.exit("codeFlowValue"),l(c)):(e.consume(c),o)}function u(c){return e.exit("codeIndented"),t(c)}}function mR(e,t,r){const n=this;return s;function s(l){return n.parser.lazy[n.now().line]?r(l):Ce(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):Je(e,i,"linePrefix",5)(l)}function i(l){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):Ce(l)?s(l):r(l)}}const pR={name:"codeText",previous:xR,resolve:gR,tokenize:yR};function gR(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function xR(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function yR(e,t,r){let n=0,s,i;return l;function l(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),u(h))}function u(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),u):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):Ce(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Ce(h)?(e.exit("codeTextData"),u(h)):(e.consume(h),c)}function d(h){return h===96?(e.consume(h),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",c(h))}}class bR{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&eo(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),eo(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),eo(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);eo(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);eo(this.left,r.reverse())}}}function eo(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function YE(e){const t={};let r=-1,n,s,i,l,o,u,c;const d=new bR(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,vR(d,r)),r=t[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--;)if(l=d.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),l[1].type="lineEnding",s=i);else if(l[1].type!=="linePrefix")break;s&&(n[1].end={...d.get(s)[1].start},o=d.slice(s,r),o.unshift(n),d.splice(s,r-s+1,o))}}return Pr(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function vR(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const i=[],l=r._tokenizer||n.parser[r.contentType](r.start),o=l.events,u=[],c={};let d,h,f=-1,g=r,p=0,b=0;const E=[b];for(;g;){for(;e.get(++s)[1]!==g;);i.push(s),g._tokenizer||(d=n.sliceStream(g),g.next||d.push(null),h&&l.defineSkip(g.start),g._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(d),g._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),h=g,g=g.next}for(g=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(b=f+1,E.push(b),g._tokenizer=void 0,g.previous=void 0,g=g.next);for(l.events=[],g?(g._tokenizer=void 0,g.previous=void 0):E.pop(),f=E.length;f--;){const x=o.slice(E[f],E[f+1]),y=i.pop();u.push([y,y+x.length-1]),e.splice(y,2,x)}for(u.reverse(),f=-1;++f<u.length;)c[p+u[f][0]]=p+u[f][1],p+=u[f][1]-u[f][0]-1;return c}const wR={resolve:_R,tokenize:NR},ER={partial:!0,tokenize:kR};function _R(e){return YE(e),e}function NR(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(o)}function s(o){return o===null?i(o):Ce(o)?e.check(ER,l,i)(o):(e.consume(o),s)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function kR(e,t,r){const n=this;return s;function s(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Je(e,i,"linePrefix")}function i(l){if(l===null||Ce(l))return r(l);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(n.parser.constructs.flow,r,t)(l)}}function QE(e,t,r,n,s,i,l,o,u){const c=u||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(n),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||Sd(x)?r(x):(e.enter(n),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),b(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),g(x))}function g(x){return x===62?(e.exit("chunkString"),e.exit(o),f(x)):x===null||x===60||Ce(x)?r(x):(e.consume(x),x===92?p:g)}function p(x){return x===60||x===62||x===92?(e.consume(x),g):g(x)}function b(x){return!d&&(x===null||x===41||ot(x))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(n),t(x)):d<c&&x===40?(e.consume(x),d++,b):x===41?(e.consume(x),d--,b):x===null||x===32||x===40||Sd(x)?r(x):(e.consume(x),x===92?E:b)}function E(x){return x===40||x===41||x===92?(e.consume(x),b):b(x)}}function KE(e,t,r,n,s,i){const l=this;let o=0,u;return c;function c(g){return e.enter(n),e.enter(s),e.consume(g),e.exit(s),e.enter(i),d}function d(g){return o>999||g===null||g===91||g===93&&!u||g===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?r(g):g===93?(e.exit(i),e.enter(s),e.consume(g),e.exit(s),e.exit(n),t):Ce(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(g))}function h(g){return g===null||g===91||g===93||Ce(g)||o++>999?(e.exit("chunkString"),d(g)):(e.consume(g),u||(u=!Ye(g)),g===92?f:h)}function f(g){return g===91||g===92||g===93?(e.consume(g),o++,h):h(g)}}function ZE(e,t,r,n,s,i){let l;return o;function o(f){return f===34||f===39||f===40?(e.enter(n),e.enter(s),e.consume(f),e.exit(s),l=f===40?41:f,u):r(f)}function u(f){return f===l?(e.enter(s),e.consume(f),e.exit(s),e.exit(n),t):(e.enter(i),c(f))}function c(f){return f===l?(e.exit(i),u(l)):f===null?r(f):Ce(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Je(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===l||f===null||Ce(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?h:d)}function h(f){return f===l||f===92?(e.consume(f),d):d(f)}}function Io(e,t){let r;return n;function n(s){return Ce(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):Ye(s)?Je(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const SR={name:"definition",tokenize:CR},TR={partial:!0,tokenize:jR};function CR(e,t,r){const n=this;let s;return i;function i(g){return e.enter("definition"),l(g)}function l(g){return KE.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(g)}function o(g){return s=yn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),u):r(g)}function u(g){return ot(g)?Io(e,c)(g):c(g)}function c(g){return QE(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(g)}function d(g){return e.attempt(TR,h,h)(g)}function h(g){return Ye(g)?Je(e,f,"whitespace")(g):f(g)}function f(g){return g===null||Ce(g)?(e.exit("definition"),n.parser.defined.push(s),t(g)):r(g)}}function jR(e,t,r){return n;function n(o){return ot(o)?Io(e,s)(o):r(o)}function s(o){return ZE(e,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return Ye(o)?Je(e,l,"whitespace")(o):l(o)}function l(o){return o===null||Ce(o)?t(o):r(o)}}const AR={name:"hardBreakEscape",tokenize:IR};function IR(e,t,r){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return Ce(i)?(e.exit("hardBreakEscape"),t(i)):r(i)}}const RR={name:"headingAtx",resolve:LR,tokenize:OR};function LR(e,t){let r=e.length-2,n=3,s,i;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},i={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Pr(e,n,r-n+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function OR(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),l(d)}function l(d){return d===35&&n++<6?(e.consume(d),l):d===null||ot(d)?(e.exit("atxHeadingSequence"),o(d)):r(d)}function o(d){return d===35?(e.enter("atxHeadingSequence"),u(d)):d===null||Ce(d)?(e.exit("atxHeading"),t(d)):Ye(d)?Je(e,o,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function u(d){return d===35?(e.consume(d),u):(e.exit("atxHeadingSequence"),o(d))}function c(d){return d===null||d===35||ot(d)?(e.exit("atxHeadingText"),o(d)):(e.consume(d),c)}}const PR=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ab=["pre","script","style","textarea"],DR={concrete:!0,name:"htmlFlow",resolveTo:UR,tokenize:BR},MR={partial:!0,tokenize:$R},FR={partial:!0,tokenize:HR};function UR(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function BR(e,t,r){const n=this;let s,i,l,o,u;return c;function c(R){return d(R)}function d(R){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(R),h}function h(R){return R===33?(e.consume(R),f):R===47?(e.consume(R),i=!0,b):R===63?(e.consume(R),s=3,n.interrupt?t:N):lr(R)?(e.consume(R),l=String.fromCharCode(R),E):r(R)}function f(R){return R===45?(e.consume(R),s=2,g):R===91?(e.consume(R),s=5,o=0,p):lr(R)?(e.consume(R),s=4,n.interrupt?t:N):r(R)}function g(R){return R===45?(e.consume(R),n.interrupt?t:N):r(R)}function p(R){const me="CDATA[";return R===me.charCodeAt(o++)?(e.consume(R),o===me.length?n.interrupt?t:O:p):r(R)}function b(R){return lr(R)?(e.consume(R),l=String.fromCharCode(R),E):r(R)}function E(R){if(R===null||R===47||R===62||ot(R)){const me=R===47,ce=l.toLowerCase();return!me&&!i&&ab.includes(ce)?(s=1,n.interrupt?t(R):O(R)):PR.includes(l.toLowerCase())?(s=6,me?(e.consume(R),x):n.interrupt?t(R):O(R)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(R):i?y(R):v(R))}return R===45||Xt(R)?(e.consume(R),l+=String.fromCharCode(R),E):r(R)}function x(R){return R===62?(e.consume(R),n.interrupt?t:O):r(R)}function y(R){return Ye(R)?(e.consume(R),y):T(R)}function v(R){return R===47?(e.consume(R),T):R===58||R===95||lr(R)?(e.consume(R),k):Ye(R)?(e.consume(R),v):T(R)}function k(R){return R===45||R===46||R===58||R===95||Xt(R)?(e.consume(R),k):_(R)}function _(R){return R===61?(e.consume(R),S):Ye(R)?(e.consume(R),_):v(R)}function S(R){return R===null||R===60||R===61||R===62||R===96?r(R):R===34||R===39?(e.consume(R),u=R,I):Ye(R)?(e.consume(R),S):j(R)}function I(R){return R===u?(e.consume(R),u=null,D):R===null||Ce(R)?r(R):(e.consume(R),I)}function j(R){return R===null||R===34||R===39||R===47||R===60||R===61||R===62||R===96||ot(R)?_(R):(e.consume(R),j)}function D(R){return R===47||R===62||Ye(R)?v(R):r(R)}function T(R){return R===62?(e.consume(R),B):r(R)}function B(R){return R===null||Ce(R)?O(R):Ye(R)?(e.consume(R),B):r(R)}function O(R){return R===45&&s===2?(e.consume(R),H):R===60&&s===1?(e.consume(R),A):R===62&&s===4?(e.consume(R),K):R===63&&s===3?(e.consume(R),N):R===93&&s===5?(e.consume(R),Q):Ce(R)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(MR,$,Y)(R)):R===null||Ce(R)?(e.exit("htmlFlowData"),Y(R)):(e.consume(R),O)}function Y(R){return e.check(FR,G,$)(R)}function G(R){return e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),z}function z(R){return R===null||Ce(R)?Y(R):(e.enter("htmlFlowData"),O(R))}function H(R){return R===45?(e.consume(R),N):O(R)}function A(R){return R===47?(e.consume(R),l="",M):O(R)}function M(R){if(R===62){const me=l.toLowerCase();return ab.includes(me)?(e.consume(R),K):O(R)}return lr(R)&&l.length<8?(e.consume(R),l+=String.fromCharCode(R),M):O(R)}function Q(R){return R===93?(e.consume(R),N):O(R)}function N(R){return R===62?(e.consume(R),K):R===45&&s===2?(e.consume(R),N):O(R)}function K(R){return R===null||Ce(R)?(e.exit("htmlFlowData"),$(R)):(e.consume(R),K)}function $(R){return e.exit("htmlFlow"),t(R)}}function HR(e,t,r){const n=this;return s;function s(l){return Ce(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):r(l)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}function $R(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(Bu,t,r)}}const zR={name:"htmlText",tokenize:qR};function qR(e,t,r){const n=this;let s,i,l;return o;function o(N){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(N),u}function u(N){return N===33?(e.consume(N),c):N===47?(e.consume(N),_):N===63?(e.consume(N),v):lr(N)?(e.consume(N),j):r(N)}function c(N){return N===45?(e.consume(N),d):N===91?(e.consume(N),i=0,p):lr(N)?(e.consume(N),y):r(N)}function d(N){return N===45?(e.consume(N),g):r(N)}function h(N){return N===null?r(N):N===45?(e.consume(N),f):Ce(N)?(l=h,A(N)):(e.consume(N),h)}function f(N){return N===45?(e.consume(N),g):h(N)}function g(N){return N===62?H(N):N===45?f(N):h(N)}function p(N){const K="CDATA[";return N===K.charCodeAt(i++)?(e.consume(N),i===K.length?b:p):r(N)}function b(N){return N===null?r(N):N===93?(e.consume(N),E):Ce(N)?(l=b,A(N)):(e.consume(N),b)}function E(N){return N===93?(e.consume(N),x):b(N)}function x(N){return N===62?H(N):N===93?(e.consume(N),x):b(N)}function y(N){return N===null||N===62?H(N):Ce(N)?(l=y,A(N)):(e.consume(N),y)}function v(N){return N===null?r(N):N===63?(e.consume(N),k):Ce(N)?(l=v,A(N)):(e.consume(N),v)}function k(N){return N===62?H(N):v(N)}function _(N){return lr(N)?(e.consume(N),S):r(N)}function S(N){return N===45||Xt(N)?(e.consume(N),S):I(N)}function I(N){return Ce(N)?(l=I,A(N)):Ye(N)?(e.consume(N),I):H(N)}function j(N){return N===45||Xt(N)?(e.consume(N),j):N===47||N===62||ot(N)?D(N):r(N)}function D(N){return N===47?(e.consume(N),H):N===58||N===95||lr(N)?(e.consume(N),T):Ce(N)?(l=D,A(N)):Ye(N)?(e.consume(N),D):H(N)}function T(N){return N===45||N===46||N===58||N===95||Xt(N)?(e.consume(N),T):B(N)}function B(N){return N===61?(e.consume(N),O):Ce(N)?(l=B,A(N)):Ye(N)?(e.consume(N),B):D(N)}function O(N){return N===null||N===60||N===61||N===62||N===96?r(N):N===34||N===39?(e.consume(N),s=N,Y):Ce(N)?(l=O,A(N)):Ye(N)?(e.consume(N),O):(e.consume(N),G)}function Y(N){return N===s?(e.consume(N),s=void 0,z):N===null?r(N):Ce(N)?(l=Y,A(N)):(e.consume(N),Y)}function G(N){return N===null||N===34||N===39||N===60||N===61||N===96?r(N):N===47||N===62||ot(N)?D(N):(e.consume(N),G)}function z(N){return N===47||N===62||ot(N)?D(N):r(N)}function H(N){return N===62?(e.consume(N),e.exit("htmlTextData"),e.exit("htmlText"),t):r(N)}function A(N){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),M}function M(N){return Ye(N)?Je(e,Q,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):Q(N)}function Q(N){return e.enter("htmlTextData"),l(N)}}const sg={name:"labelEnd",resolveAll:YR,resolveTo:QR,tokenize:KR},VR={tokenize:ZR},WR={tokenize:XR},GR={tokenize:JR};function YR(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&Pr(e,0,e.length,r),e}function QR(e,t){let r=e.length,n=0,s,i,l,o;for(;r--;)if(s=e[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(l){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(l=r);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},d={type:"labelText",start:{...e[i+n+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",u,t],["enter",c,t]],o=Gr(o,e.slice(i+1,i+n+3)),o=Gr(o,[["enter",d,t]]),o=Gr(o,wh(t.parser.constructs.insideSpan.null,e.slice(i+n+4,l-3),t)),o=Gr(o,[["exit",d,t],e[l-2],e[l-1],["exit",c,t]]),o=Gr(o,e.slice(l+1)),o=Gr(o,[["exit",u,t]]),Pr(e,i,e.length,o),e}function KR(e,t,r){const n=this;let s=n.events.length,i,l;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return o;function o(f){return i?i._inactive?h(f):(l=n.parser.defined.includes(yn(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),u):r(f)}function u(f){return f===40?e.attempt(VR,d,l?d:h)(f):f===91?e.attempt(WR,d,l?c:h)(f):l?d(f):h(f)}function c(f){return e.attempt(GR,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,r(f)}}function ZR(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return ot(h)?Io(e,i)(h):i(h)}function i(h){return h===41?d(h):QE(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function l(h){return ot(h)?Io(e,u)(h):d(h)}function o(h){return r(h)}function u(h){return h===34||h===39||h===40?ZE(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function c(h){return ot(h)?Io(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function XR(e,t,r){const n=this;return s;function s(o){return KE.call(n,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return n.parser.defined.includes(yn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function l(o){return r(o)}}function JR(e,t,r){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):r(i)}}const eL={name:"labelStartImage",resolveAll:sg.resolveAll,tokenize:tL};function tL(e,t,r){const n=this;return s;function s(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):r(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const rL={name:"labelStartLink",resolveAll:sg.resolveAll,tokenize:nL};function nL(e,t,r){const n=this;return s;function s(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const Cf={name:"lineEnding",tokenize:sL};function sL(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Je(e,t,"linePrefix")}}const $c={name:"thematicBreak",tokenize:aL};function aL(e,t,r){let n=0,s;return i;function i(c){return e.enter("thematicBreak"),l(c)}function l(c){return s=c,o(c)}function o(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):n>=3&&(c===null||Ce(c))?(e.exit("thematicBreak"),t(c)):r(c)}function u(c){return c===s?(e.consume(c),n++,u):(e.exit("thematicBreakSequence"),Ye(c)?Je(e,o,"whitespace")(c):o(c))}}const gr={continuation:{tokenize:uL},exit:dL,name:"list",tokenize:oL},iL={partial:!0,tokenize:hL},lL={partial:!0,tokenize:cL};function oL(e,t,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,l=0;return o;function o(g){const p=n.containerState.type||(g===42||g===43||g===45?"listUnordered":"listOrdered");if(p==="listUnordered"?!n.containerState.marker||g===n.containerState.marker:pp(g)){if(n.containerState.type||(n.containerState.type=p,e.enter(p,{_container:!0})),p==="listUnordered")return e.enter("listItemPrefix"),g===42||g===45?e.check($c,r,c)(g):c(g);if(!n.interrupt||g===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(g)}return r(g)}function u(g){return pp(g)&&++l<10?(e.consume(g),u):(!n.interrupt||l<2)&&(n.containerState.marker?g===n.containerState.marker:g===41||g===46)?(e.exit("listItemValue"),c(g)):r(g)}function c(g){return e.enter("listItemMarker"),e.consume(g),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||g,e.check(Bu,n.interrupt?r:d,e.attempt(iL,f,h))}function d(g){return n.containerState.initialBlankLine=!0,i++,f(g)}function h(g){return Ye(g)?(e.enter("listItemPrefixWhitespace"),e.consume(g),e.exit("listItemPrefixWhitespace"),f):r(g)}function f(g){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(g)}}function uL(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(Bu,s,i);function s(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Je(e,t,"listItemIndent",n.containerState.size+1)(o)}function i(o){return n.containerState.furtherBlankLines||!Ye(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,l(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(lL,t,l)(o))}function l(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,Je(e,e.attempt(gr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function cL(e,t,r){const n=this;return Je(e,s,"listItemIndent",n.containerState.size+1);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===n.containerState.size?t(i):r(i)}}function dL(e){e.exit(this.containerState.type)}function hL(e,t,r){const n=this;return Je(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const l=n.events[n.events.length-1];return!Ye(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):r(i)}}const ib={name:"setextUnderline",resolveTo:fL,tokenize:mL};function fL(e,t){let r=e.length,n,s,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!i&&e[r][1].type==="definition"&&(i=r);const l={type:"setextHeading",start:{...e[s][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",l,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=l,e.push(["exit",l,t]),e}function mL(e,t,r){const n=this;let s;return i;function i(c){let d=n.events.length,h;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){h=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),s=c,l(c)):r(c)}function l(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===s?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),Ye(c)?Je(e,u,"lineSuffix")(c):u(c))}function u(c){return c===null||Ce(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const pL={tokenize:gL};function gL(e){const t=this,r=e.attempt(Bu,n,e.attempt(this.parser.constructs.flowInitial,s,Je(e,e.attempt(this.parser.constructs.flow,s,e.attempt(wR,s)),"linePrefix")));return r;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const xL={resolveAll:JE()},yL=XE("string"),bL=XE("text");function XE(e){return{resolveAll:JE(e==="text"?vL:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],i=r.attempt(s,l,o);return l;function l(d){return c(d)?i(d):o(d)}function o(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),u}function u(d){return c(d)?(r.exit("data"),i(d)):(r.consume(d),u)}function c(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const g=h[f];if(!g.previous||g.previous.call(n,n.previous))return!0}return!1}}}function JE(e){return t;function t(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(r,n):r}}function vL(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let i=s.length,l=-1,o=0,u;for(;i--;){const c=s[i];if(typeof c=="string"){for(l=c.length;c.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(c===-2)u=!0,o++;else if(c!==-1){i++;break}}if(o){const c={type:r===e.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:n.start._bufferIndex+l,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const wL={42:gr,43:gr,45:gr,48:gr,49:gr,50:gr,51:gr,52:gr,53:gr,54:gr,55:gr,56:gr,57:gr,62:VE},EL={91:SR},_L={[-2]:Tf,[-1]:Tf,32:Tf},NL={35:RR,42:$c,45:[ib,$c],60:DR,61:ib,95:$c,96:sb,126:sb},kL={38:GE,92:WE},SL={[-5]:Cf,[-4]:Cf,[-3]:Cf,33:eL,38:GE,42:gp,60:[rR,zR],91:rL,92:[AR,WE],93:sg,95:gp,96:pR},TL={null:[gp,xL]},CL={null:[42,95]},jL={null:[]},AL=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:CL,contentInitial:EL,disable:jL,document:wL,flow:NL,flowInitial:_L,insideSpan:TL,string:kL,text:SL},Symbol.toStringTag,{value:"Module"}));function IL(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let l=[],o=[];const u={attempt:I(_),check:I(S),consume:y,enter:v,exit:k,interrupt:I(S,{interrupt:!0})},c={code:null,containerState:{},defineSkip:b,events:[],now:p,parser:e,previous:null,sliceSerialize:f,sliceStream:g,write:h};let d=t.tokenize.call(c,u);return t.resolveAll&&i.push(t),c;function h(B){return l=Gr(l,B),E(),l[l.length-1]!==null?[]:(j(t,0),c.events=wh(i,c.events,c),c.events)}function f(B,O){return LL(g(B),O)}function g(B){return RL(l,B)}function p(){const{_bufferIndex:B,_index:O,line:Y,column:G,offset:z}=n;return{_bufferIndex:B,_index:O,line:Y,column:G,offset:z}}function b(B){s[B.line]=B.column,T()}function E(){let B;for(;n._index<l.length;){const O=l[n._index];if(typeof O=="string")for(B=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===B&&n._bufferIndex<O.length;)x(O.charCodeAt(n._bufferIndex));else x(O)}}function x(B){d=d(B)}function y(B){Ce(B)?(n.line++,n.column=1,n.offset+=B===-3?2:1,T()):B!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=B}function v(B,O){const Y=O||{};return Y.type=B,Y.start=p(),c.events.push(["enter",Y,c]),o.push(Y),Y}function k(B){const O=o.pop();return O.end=p(),c.events.push(["exit",O,c]),O}function _(B,O){j(B,O.from)}function S(B,O){O.restore()}function I(B,O){return Y;function Y(G,z,H){let A,M,Q,N;return Array.isArray(G)?$(G):"tokenize"in G?$([G]):K(G);function K(we){return Z;function Z(be){const ee=be!==null&&we[be],de=be!==null&&we.null,_e=[...Array.isArray(ee)?ee:ee?[ee]:[],...Array.isArray(de)?de:de?[de]:[]];return $(_e)(be)}}function $(we){return A=we,M=0,we.length===0?H:R(we[M])}function R(we){return Z;function Z(be){return N=D(),Q=we,we.partial||(c.currentConstruct=we),we.name&&c.parser.constructs.disable.null.includes(we.name)?ce():we.tokenize.call(O?Object.assign(Object.create(c),O):c,u,me,ce)(be)}}function me(we){return B(Q,N),z}function ce(we){return N.restore(),++M<A.length?R(A[M]):H}}}function j(B,O){B.resolveAll&&!i.includes(B)&&i.push(B),B.resolve&&Pr(c.events,O,c.events.length-O,B.resolve(c.events.slice(O),c)),B.resolveTo&&(c.events=B.resolveTo(c.events,c))}function D(){const B=p(),O=c.previous,Y=c.currentConstruct,G=c.events.length,z=Array.from(o);return{from:G,restore:H};function H(){n=B,c.previous=O,c.currentConstruct=Y,c.events.length=G,o=z,T()}}function T(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function RL(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let l;if(r===s)l=[e[r].slice(n,i)];else{if(l=e.slice(r,s),n>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(n):l.shift()}i>0&&l.push(e[s].slice(0,i))}return l}function LL(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const i=e[r];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&s)continue;l=" ";break}default:l=String.fromCharCode(i)}s=i===-2,n.push(l)}return n.join("")}function OL(e){const n={constructs:zE([AL,...(e||{}).extensions||[]]),content:s(Q5),defined:[],document:s(Z5),flow:s(pL),lazy:{},string:s(yL),text:s(bL)};return n;function s(i){return l;function l(o){return IL(n,i,o)}}}function PL(e){for(;!YE(e););return e}const lb=/[\0\t\n\r]/g;function DL(){let e=1,t="",r=!0,n;return s;function s(i,l,o){const u=[];let c,d,h,f,g;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),h=0,t="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if(lb.lastIndex=h,c=lb.exec(i),f=c&&c.index!==void 0?c.index:i.length,g=i.charCodeAt(f),!c){t=i.slice(h);break}if(g===10&&h===f&&n)u.push(-3),n=void 0;else switch(n&&(u.push(-5),n=void 0),h<f&&(u.push(i.slice(h,f)),e+=f-h),g){case 0:{u.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,u.push(-2);e++<d;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:n=!0,e=1}h=f+1}return o&&(n&&u.push(-5),t&&u.push(t),u.push(null)),u}}const ML=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function FL(e){return e.replace(ML,UL)}function UL(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return qE(r.slice(i?2:1),i?16:10)}return ng(r)||e}const e_={}.hasOwnProperty;function BL(e,t,r){return typeof t!="string"&&(r=t,t=void 0),HL(r)(PL(OL(r).document().write(DL()(e,t,!0))))}function HL(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Le),autolinkProtocol:D,autolinkEmail:D,atxHeading:i(V),blockQuote:i(de),characterEscape:D,characterReference:D,codeFenced:i(_e),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(_e,l),codeText:i(je,l),codeTextData:D,data:D,codeFlowValue:D,definition:i(Pe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Fe),hardBreakEscape:i(ye),hardBreakTrailing:i(ye),htmlFlow:i(ie,l),htmlFlowData:D,htmlText:i(ie,l),htmlTextData:D,image:i(ke),label:l,link:i(Le),listItem:i(tt),listItemValue:f,listOrdered:i($e,h),listUnordered:i($e),paragraph:i(ut),reference:R,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i(V),strong:i(jt),thematicBreak:i(sn)},exit:{atxHeading:u(),atxHeadingSequence:_,autolink:u(),autolinkEmail:ee,autolinkProtocol:be,blockQuote:u(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:ce,characterReferenceMarkerNumeric:ce,characterReferenceValue:we,characterReference:Z,codeFenced:u(E),codeFencedFence:b,codeFencedFenceInfo:g,codeFencedFenceMeta:p,codeFlowValue:T,codeIndented:u(x),codeText:u(z),codeTextData:T,data:T,definition:u(),definitionDestinationString:k,definitionLabelString:y,definitionTitleString:v,emphasis:u(),hardBreakEscape:u(O),hardBreakTrailing:u(O),htmlFlow:u(Y),htmlFlowData:T,htmlText:u(G),htmlTextData:T,image:u(A),label:Q,labelText:M,lineEnding:B,link:u(H),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:me,resourceDestinationString:N,resourceTitleString:K,resource:$,setextHeading:u(j),setextHeadingLineSequence:I,setextHeadingText:S,strong:u(),thematicBreak:u()}};t_(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(J){let oe={type:"root",children:[]};const Se={stack:[oe],tokenStack:[],config:t,enter:o,exit:c,buffer:l,resume:d,data:r},Ue=[];let nt=-1;for(;++nt<J.length;)if(J[nt][1].type==="listOrdered"||J[nt][1].type==="listUnordered")if(J[nt][0]==="enter")Ue.push(nt);else{const nr=Ue.pop();nt=s(J,nr,nt)}for(nt=-1;++nt<J.length;){const nr=t[J[nt][0]];e_.call(nr,J[nt][1].type)&&nr[J[nt][1].type].call(Object.assign({sliceSerialize:J[nt][2].sliceSerialize},Se),J[nt][1])}if(Se.tokenStack.length>0){const nr=Se.tokenStack[Se.tokenStack.length-1];(nr[1]||ob).call(Se,void 0,nr[0])}for(oe.position={start:ws(J.length>0?J[0][1].start:{line:1,column:1,offset:0}),end:ws(J.length>0?J[J.length-2][1].end:{line:1,column:1,offset:0})},nt=-1;++nt<t.transforms.length;)oe=t.transforms[nt](oe)||oe;return oe}function s(J,oe,Se){let Ue=oe-1,nt=-1,nr=!1,Hr,Cr,zn,qn;for(;++Ue<=Se;){const zt=J[Ue];switch(zt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{zt[0]==="enter"?nt++:nt--,qn=void 0;break}case"lineEndingBlank":{zt[0]==="enter"&&(Hr&&!qn&&!nt&&!zn&&(zn=Ue),qn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:qn=void 0}if(!nt&&zt[0]==="enter"&&zt[1].type==="listItemPrefix"||nt===-1&&zt[0]==="exit"&&(zt[1].type==="listUnordered"||zt[1].type==="listOrdered")){if(Hr){let fr=Ue;for(Cr=void 0;fr--;){const at=J[fr];if(at[1].type==="lineEnding"||at[1].type==="lineEndingBlank"){if(at[0]==="exit")continue;Cr&&(J[Cr][1].type="lineEndingBlank",nr=!0),at[1].type="lineEnding",Cr=fr}else if(!(at[1].type==="linePrefix"||at[1].type==="blockQuotePrefix"||at[1].type==="blockQuotePrefixWhitespace"||at[1].type==="blockQuoteMarker"||at[1].type==="listItemIndent"))break}zn&&(!Cr||zn<Cr)&&(Hr._spread=!0),Hr.end=Object.assign({},Cr?J[Cr][1].start:zt[1].end),J.splice(Cr||Ue,0,["exit",Hr,zt[2]]),Ue++,Se++}if(zt[1].type==="listItemPrefix"){const fr={type:"listItem",_spread:!1,start:Object.assign({},zt[1].start),end:void 0};Hr=fr,J.splice(Ue,0,["enter",fr,zt[2]]),Ue++,Se++,zn=void 0,qn=!0}}}return J[oe][1]._spread=nr,Se}function i(J,oe){return Se;function Se(Ue){o.call(this,J(Ue),Ue),oe&&oe.call(this,Ue)}}function l(){this.stack.push({type:"fragment",children:[]})}function o(J,oe,Se){this.stack[this.stack.length-1].children.push(J),this.stack.push(J),this.tokenStack.push([oe,Se||void 0]),J.position={start:ws(oe.start),end:void 0}}function u(J){return oe;function oe(Se){J&&J.call(this,Se),c.call(this,Se)}}function c(J,oe){const Se=this.stack.pop(),Ue=this.tokenStack.pop();if(Ue)Ue[0].type!==J.type&&(oe?oe.call(this,J,Ue[0]):(Ue[1]||ob).call(this,J,Ue[0]));else throw new Error("Cannot close `"+J.type+"` ("+Ao({start:J.start,end:J.end})+"): its not open");Se.position.end=ws(J.end)}function d(){return rg(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(J){if(this.data.expectingFirstListItemValue){const oe=this.stack[this.stack.length-2];oe.start=Number.parseInt(this.sliceSerialize(J),10),this.data.expectingFirstListItemValue=void 0}}function g(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.lang=J}function p(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.meta=J}function b(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.value=J.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.value=J.replace(/(\r?\n|\r)$/g,"")}function y(J){const oe=this.resume(),Se=this.stack[this.stack.length-1];Se.label=oe,Se.identifier=yn(this.sliceSerialize(J)).toLowerCase()}function v(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.title=J}function k(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.url=J}function _(J){const oe=this.stack[this.stack.length-1];if(!oe.depth){const Se=this.sliceSerialize(J).length;oe.depth=Se}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function I(J){const oe=this.stack[this.stack.length-1];oe.depth=this.sliceSerialize(J).codePointAt(0)===61?1:2}function j(){this.data.setextHeadingSlurpLineEnding=void 0}function D(J){const Se=this.stack[this.stack.length-1].children;let Ue=Se[Se.length-1];(!Ue||Ue.type!=="text")&&(Ue=Tr(),Ue.position={start:ws(J.start),end:void 0},Se.push(Ue)),this.stack.push(Ue)}function T(J){const oe=this.stack.pop();oe.value+=this.sliceSerialize(J),oe.position.end=ws(J.end)}function B(J){const oe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Se=oe.children[oe.children.length-1];Se.position.end=ws(J.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(oe.type)&&(D.call(this,J),T.call(this,J))}function O(){this.data.atHardBreak=!0}function Y(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.value=J}function G(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.value=J}function z(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.value=J}function H(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const oe=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=oe,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function A(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const oe=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=oe,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function M(J){const oe=this.sliceSerialize(J),Se=this.stack[this.stack.length-2];Se.label=FL(oe),Se.identifier=yn(oe).toLowerCase()}function Q(){const J=this.stack[this.stack.length-1],oe=this.resume(),Se=this.stack[this.stack.length-1];if(this.data.inReference=!0,Se.type==="link"){const Ue=J.children;Se.children=Ue}else Se.alt=oe}function N(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.url=J}function K(){const J=this.resume(),oe=this.stack[this.stack.length-1];oe.title=J}function $(){this.data.inReference=void 0}function R(){this.data.referenceType="collapsed"}function me(J){const oe=this.resume(),Se=this.stack[this.stack.length-1];Se.label=oe,Se.identifier=yn(this.sliceSerialize(J)).toLowerCase(),this.data.referenceType="full"}function ce(J){this.data.characterReferenceType=J.type}function we(J){const oe=this.sliceSerialize(J),Se=this.data.characterReferenceType;let Ue;Se?(Ue=qE(oe,Se==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ue=ng(oe);const nt=this.stack[this.stack.length-1];nt.value+=Ue}function Z(J){const oe=this.stack.pop();oe.position.end=ws(J.end)}function be(J){T.call(this,J);const oe=this.stack[this.stack.length-1];oe.url=this.sliceSerialize(J)}function ee(J){T.call(this,J);const oe=this.stack[this.stack.length-1];oe.url="mailto:"+this.sliceSerialize(J)}function de(){return{type:"blockquote",children:[]}}function _e(){return{type:"code",lang:null,meta:null,value:""}}function je(){return{type:"inlineCode",value:""}}function Pe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Fe(){return{type:"emphasis",children:[]}}function V(){return{type:"heading",depth:0,children:[]}}function ye(){return{type:"break"}}function ie(){return{type:"html",value:""}}function ke(){return{type:"image",title:null,url:"",alt:null}}function Le(){return{type:"link",title:null,url:"",children:[]}}function $e(J){return{type:"list",ordered:J.type==="listOrdered",start:null,spread:J._spread,children:[]}}function tt(J){return{type:"listItem",spread:J._spread,checked:null,children:[]}}function ut(){return{type:"paragraph",children:[]}}function jt(){return{type:"strong",children:[]}}function Tr(){return{type:"text",value:""}}function sn(){return{type:"thematicBreak"}}}function ws(e){return{line:e.line,column:e.column,offset:e.offset}}function t_(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?t_(e,n):$L(e,n)}}function $L(e,t){let r;for(r in t)if(e_.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function ob(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Ao({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Ao({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Ao({start:t.start,end:t.end})+") is still open")}function zL(e){const t=this;t.parser=r;function r(n){return BL(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function qL(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function VL(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function WL(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function GL(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function YL(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function QL(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=Pl(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let l,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,u);const c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)}function KL(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function ZL(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function r_(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const l=s[s.length-1];return l&&l.type==="text"?l.value+=n:s.push({type:"text",value:n}),s}function XL(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return r_(e,t);const s={src:Pl(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function JL(e,t){const r={src:Pl(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function eO(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function tO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return r_(e,t);const s={href:Pl(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function rO(e,t){const r={href:Pl(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function nO(e,t,r){const n=e.all(t),s=r?sO(r):n_(t),i={},l=[];if(typeof t.checked=="boolean"){const d=n[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const d=n[o];(s||o!==0||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?l.push(...d.children):l.push(d)}const u=n[n.length-1];u&&(s||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,c),e.applyData(t,c)}function sO(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=n_(r[n])}return t}function n_(e){const t=e.spread;return t??e.children.length>1}function aO(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const l=n[s];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function iO(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function lO(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function oO(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function uO(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],l),s.push(l)}if(r.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=Hn(t.children[1]),u=bh(t.children[t.children.length-1]);o&&u&&(l.position={start:o,end:u}),s.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function cO(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",l=r&&r.type==="table"?r.align:void 0,o=l?l.length:t.children.length;let u=-1;const c=[];for(;++u<o;){const h=t.children[u],f={},g=l?l[u]:void 0;g&&(f.align=g);let p={type:"element",tagName:i,properties:f,children:[]};h&&(p.children=e.all(h),e.patch(h,p),p=e.applyData(h,p)),c.push(p)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,d),e.applyData(t,d)}function dO(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const ub=9,cb=32;function hO(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const i=[];for(;n;)i.push(db(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return i.push(db(t.slice(s),s>0,!1)),i.join("")}function db(e,t,r){let n=0,s=e.length;if(t){let i=e.codePointAt(n);for(;i===ub||i===cb;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(s-1);for(;i===ub||i===cb;)s--,i=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function fO(e,t){const r={type:"text",value:hO(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function mO(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const pO={blockquote:qL,break:VL,code:WL,delete:GL,emphasis:YL,footnoteReference:QL,heading:KL,html:ZL,imageReference:XL,image:JL,inlineCode:eO,linkReference:tO,link:rO,listItem:nO,list:aO,paragraph:iO,root:lO,strong:oO,table:uO,tableCell:dO,tableRow:cO,text:fO,thematicBreak:mO,toml:_c,yaml:_c,definition:_c,footnoteDefinition:_c};function _c(){}const s_=-1,Eh=0,Ro=1,Td=2,ag=3,ig=4,lg=5,og=6,a_=7,i_=8,hb=typeof self=="object"?self:globalThis,gO=(e,t)=>{const r=(s,i)=>(e.set(i,s),s),n=s=>{if(e.has(s))return e.get(s);const[i,l]=t[s];switch(i){case Eh:case s_:return r(l,s);case Ro:{const o=r([],s);for(const u of l)o.push(n(u));return o}case Td:{const o=r({},s);for(const[u,c]of l)o[n(u)]=n(c);return o}case ag:return r(new Date(l),s);case ig:{const{source:o,flags:u}=l;return r(new RegExp(o,u),s)}case lg:{const o=r(new Map,s);for(const[u,c]of l)o.set(n(u),n(c));return o}case og:{const o=r(new Set,s);for(const u of l)o.add(n(u));return o}case a_:{const{name:o,message:u}=l;return r(new hb[o](u),s)}case i_:return r(BigInt(l),s);case"BigInt":return r(Object(BigInt(l)),s);case"ArrayBuffer":return r(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return r(new DataView(o),l)}}return r(new hb[i](l),s)};return n},fb=e=>gO(new Map,e)(0),pi="",{toString:xO}={},{keys:yO}=Object,to=e=>{const t=typeof e;if(t!=="object"||!e)return[Eh,t];const r=xO.call(e).slice(8,-1);switch(r){case"Array":return[Ro,pi];case"Object":return[Td,pi];case"Date":return[ag,pi];case"RegExp":return[ig,pi];case"Map":return[lg,pi];case"Set":return[og,pi];case"DataView":return[Ro,r]}return r.includes("Array")?[Ro,r]:r.includes("Error")?[a_,r]:[Td,r]},Nc=([e,t])=>e===Eh&&(t==="function"||t==="symbol"),bO=(e,t,r,n)=>{const s=(l,o)=>{const u=n.push(l)-1;return r.set(o,u),u},i=l=>{if(r.has(l))return r.get(l);let[o,u]=to(l);switch(o){case Eh:{let d=l;switch(u){case"bigint":o=i_,d=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);d=null;break;case"undefined":return s([s_],l)}return s([o,d],l)}case Ro:{if(u){let f=l;return u==="DataView"?f=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(f=new Uint8Array(l)),s([u,[...f]],l)}const d=[],h=s([o,d],l);for(const f of l)d.push(i(f));return h}case Td:{if(u)switch(u){case"BigInt":return s([u,l.toString()],l);case"Boolean":case"Number":case"String":return s([u,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const d=[],h=s([o,d],l);for(const f of yO(l))(e||!Nc(to(l[f])))&&d.push([i(f),i(l[f])]);return h}case ag:return s([o,l.toISOString()],l);case ig:{const{source:d,flags:h}=l;return s([o,{source:d,flags:h}],l)}case lg:{const d=[],h=s([o,d],l);for(const[f,g]of l)(e||!(Nc(to(f))||Nc(to(g))))&&d.push([i(f),i(g)]);return h}case og:{const d=[],h=s([o,d],l);for(const f of l)(e||!Nc(to(f)))&&d.push(i(f));return h}}const{message:c}=l;return s([o,{name:u,message:c}],l)};return i},mb=(e,{json:t,lossy:r}={})=>{const n=[];return bO(!(t||r),!!t,new Map,n)(e),n},ti=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?fb(mb(e,t)):structuredClone(e):(e,t)=>fb(mb(e,t));function vO(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function wO(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function EO(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||vO,n=e.options.footnoteBackLabel||wO,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[u]);if(!c)continue;const d=e.all(c),h=String(c.identifier).toUpperCase(),f=Pl(h.toLowerCase());let g=0;const p=[],b=e.footnoteCounts.get(h);for(;b!==void 0&&++g<=b;){p.length>0&&p.push({type:"text",value:" "});let y=typeof r=="string"?r:r(u,g);typeof y=="string"&&(y={type:"text",value:y}),p.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,g),className:["data-footnote-backref"]},children:Array.isArray(y)?y:[y]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const y=E.children[E.children.length-1];y&&y.type==="text"?y.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...p)}else d.push(...p);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(c,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...ti(l),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const _h=function(e){if(e==null)return SO;if(typeof e=="function")return Nh(e);if(typeof e=="object")return Array.isArray(e)?_O(e):NO(e);if(typeof e=="string")return kO(e);throw new Error("Expected function, string, or object as test")};function _O(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=_h(e[r]);return Nh(n);function n(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function NO(e){const t=e;return Nh(r);function r(n){const s=n;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function kO(e){return Nh(t);function t(r){return r&&r.type===e}}function Nh(e){return t;function t(r,n,s){return!!(TO(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function SO(){return!0}function TO(e){return e!==null&&typeof e=="object"&&"type"in e}const l_=[],CO=!0,xp=!1,jO="skip";function o_(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const i=_h(s),l=n?-1:1;o(e,void 0,[])();function o(u,c,d){const h=u&&typeof u=="object"?u:{};if(typeof h.type=="string"){const g=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(u.type+(g?"<"+g+">":""))+")"})}return f;function f(){let g=l_,p,b,E;if((!t||i(u,c,d[d.length-1]||void 0))&&(g=AO(r(u,d)),g[0]===xp))return g;if("children"in u&&u.children){const x=u;if(x.children&&g[0]!==jO)for(b=(n?x.children.length:-1)+l,E=d.concat(x);b>-1&&b<x.children.length;){const y=x.children[b];if(p=o(y,b,E)(),p[0]===xp)return p;b=typeof p[1]=="number"?p[1]:b+l}}return g}}}function AO(e){return Array.isArray(e)?e:typeof e=="number"?[CO,e]:e==null?l_:[e]}function kh(e,t,r,n){let s,i,l;typeof t=="function"&&typeof r!="function"?(i=void 0,l=t,s=r):(i=t,l=r,s=n),o_(e,i,o,s);function o(u,c){const d=c[c.length-1],h=d?d.children.indexOf(u):void 0;return l(u,h,d)}}const yp={}.hasOwnProperty,IO={};function RO(e,t){const r=t||IO,n=new Map,s=new Map,i=new Map,l={...pO,...r.handlers},o={all:c,applyData:OO,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:u,options:r,patch:LO,wrap:DO};return kh(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?n:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),o;function u(d,h){const f=d.type,g=o.handlers[f];if(yp.call(o.handlers,f)&&g)return g(o,d,h);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in d){const{children:b,...E}=d,x=ti(E);return x.children=o.all(d),x}return ti(d)}return(o.options.unknownHandler||PO)(o,d,h)}function c(d){const h=[];if("children"in d){const f=d.children;let g=-1;for(;++g<f.length;){const p=o.one(f[g],d);if(p){if(g&&f[g-1].type==="break"&&(!Array.isArray(p)&&p.type==="text"&&(p.value=pb(p.value)),!Array.isArray(p)&&p.type==="element")){const b=p.children[0];b&&b.type==="text"&&(b.value=pb(b.value))}Array.isArray(p)?h.push(...p):h.push(p)}}}return h}}function LO(e,t){e.position&&(t.position=ME(e))}function OO(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const l="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:l}}r.type==="element"&&i&&Object.assign(r.properties,ti(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function PO(e,t){const r=t.data||{},n="value"in t&&!(yp.call(r,"hProperties")||yp.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function DO(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function pb(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function gb(e,t){const r=RO(e,t),n=r.one(e,void 0),s=EO(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function MO(e,t){return e&&"run"in e?async function(r,n){const s=gb(r,{file:n,...t});await e.run(s,n)}:function(r,n){return gb(r,{file:n,...e||t})}}function xb(e){if(e)throw e}var zc=Object.prototype.hasOwnProperty,u_=Object.prototype.toString,yb=Object.defineProperty,bb=Object.getOwnPropertyDescriptor,vb=function(t){return typeof Array.isArray=="function"?Array.isArray(t):u_.call(t)==="[object Array]"},wb=function(t){if(!t||u_.call(t)!=="[object Object]")return!1;var r=zc.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&zc.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||zc.call(t,s)},Eb=function(t,r){yb&&r.name==="__proto__"?yb(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},_b=function(t,r){if(r==="__proto__")if(zc.call(t,r)){if(bb)return bb(t,r).value}else return;return t[r]},FO=function e(){var t,r,n,s,i,l,o=arguments[0],u=1,c=arguments.length,d=!1;for(typeof o=="boolean"&&(d=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=_b(o,r),s=_b(t,r),o!==s&&(d&&s&&(wb(s)||(i=vb(s)))?(i?(i=!1,l=n&&vb(n)?n:[]):l=n&&wb(n)?n:{},Eb(o,{name:r,newValue:e(d,l,s)})):typeof s<"u"&&Eb(o,{name:r,newValue:s}));return o};const jf=Ud(FO);function bp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function UO(){const e=[],t={run:r,use:n};return t;function r(...s){let i=-1;const l=s.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...s);function o(u,...c){const d=e[++i];let h=-1;if(u){l(u);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,d?BO(d,o)(...c):l(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function BO(e,t){let r;return n;function n(...l){const o=e.length>l.length;let u;o&&l.push(s);try{u=e.apply(this,l)}catch(c){const d=c;if(o&&r)throw d;return s(d)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,s):u instanceof Error?s(u):i(u))}function s(l,...o){r||(r=!0,t(l,...o))}function i(l){s(null,l)}}const Tn={basename:HO,dirname:$O,extname:zO,join:qO,sep:"/"};function HO(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Hu(e);let r=0,n=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let l=-1,o=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else l<0&&(i=!0,l=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(n=s):(o=-1,n=l));return r===n?n=l:n<0&&(n=e.length),e.slice(r,n)}function $O(e){if(Hu(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function zO(e){Hu(e);let t=e.length,r=-1,n=0,s=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){n=t+1;break}continue}r<0&&(l=!0,r=t+1),o===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function qO(...e){let t=-1,r;for(;++t<e.length;)Hu(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":VO(r)}function VO(e){Hu(e);const t=e.codePointAt(0)===47;let r=WO(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function WO(e,t){let r="",n=0,s=-1,i=0,l=-1,o,u;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(u=r.lastIndexOf("/"),u!==r.length-1){u<0?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf("/")),s=l,i=0;continue}}else if(r.length>0){r="",n=0,s=l,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),n=l-s-1;s=l,i=0}else o===46&&i>-1?i++:i=-1}return r}function Hu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const GO={cwd:YO};function YO(){return"/"}function vp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function QO(e){if(typeof e=="string")e=new URL(e);else if(!vp(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return KO(e)}function KO(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const Af=["history","path","basename","stem","extname","dirname"];class c_{constructor(t){let r;t?vp(t)?r={path:t}:typeof t=="string"||ZO(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":GO.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Af.length;){const i=Af[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)Af.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?Tn.basename(this.path):void 0}set basename(t){Rf(t,"basename"),If(t,"basename"),this.path=Tn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Tn.dirname(this.path):void 0}set dirname(t){Nb(this.basename,"dirname"),this.path=Tn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Tn.extname(this.path):void 0}set extname(t){if(If(t,"extname"),Nb(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Tn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){vp(t)&&(t=QO(t)),Rf(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Tn.basename(this.path,this.extname):void 0}set stem(t){Rf(t,"stem"),If(t,"stem"),this.path=Tn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new tr(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function If(e,t){if(e&&e.includes(Tn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Tn.sep+"`")}function Rf(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Nb(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function ZO(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const XO=function(e){const n=this.constructor.prototype,s=n[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},JO={}.hasOwnProperty;class ug extends XO{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=UO()}copy(){const t=new ug;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(jf(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(Pf("data",this.frozen),this.namespace[t]=r,this):JO.call(this.namespace,t)&&this.namespace[t]||void 0:t?(Pf("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=kc(t),n=this.parser||this.Parser;return Lf("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),Lf("process",this.parser||this.Parser),Of("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,l){const o=kc(t),u=n.parse(o);n.run(u,o,function(d,h,f){if(d||!h||!f)return c(d);const g=h,p=n.stringify(g,f);rP(p)?f.value=p:f.result=p,c(d,f)});function c(d,h){d||!h?l(d):i?i(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),Lf("processSync",this.parser||this.Parser),Of("processSync",this.compiler||this.Compiler),this.process(t,s),Sb("processSync","process",r),n;function s(i,l){r=!0,xb(i),n=l}}run(t,r,n){kb(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(l,o){const u=kc(r);s.run(t,u,c);function c(d,h,f){const g=h||t;d?o(d):l?l(g):n(void 0,g,f)}}}runSync(t,r){let n=!1,s;return this.run(t,r,i),Sb("runSync","run",n),s;function i(l,o){xb(l),s=o,n=!0}}stringify(t,r){this.freeze();const n=kc(r),s=this.compiler||this.Compiler;return Of("stringify",s),kb(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(Pf("use",this.frozen),t!=null)if(typeof t=="function")u(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")u(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...h]=c;u(d,h)}else l(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function l(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(s.settings=jf(!0,s.settings,c.settings))}function o(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const h=c[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function u(c,d){let h=-1,f=-1;for(;++h<n.length;)if(n[h][0]===c){f=h;break}if(f===-1)n.push([c,...d]);else if(d.length>0){let[g,...p]=d;const b=n[f][1];bp(b)&&bp(g)&&(g=jf(!0,b,g)),n[f]=[c,g,...p]}}}}const eP=new ug().freeze();function Lf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Of(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Pf(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function kb(e){if(!bp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Sb(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function kc(e){return tP(e)?e:new c_(e)}function tP(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function rP(e){return typeof e=="string"||nP(e)}function nP(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const sP="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Tb=[],Cb={allowDangerousHtml:!0},aP=/^(https?|ircs?|mailto|xmpp)$/i,iP=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function d_(e){const t=e.allowedElements,r=e.allowElement,n=e.children||"",s=e.className,i=e.components,l=e.disallowedElements,o=e.rehypePlugins||Tb,u=e.remarkPlugins||Tb,c=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Cb}:Cb,d=e.skipHtml,h=e.unwrapDisallowed,f=e.urlTransform||lP,g=eP().use(zL).use(u).use(MO,c).use(o),p=new c_;typeof n=="string"&&(p.value=n);for(const y of iP)Object.hasOwn(e,y.from)&&(""+y.from+(y.to?"use `"+y.to+"` instead":"remove it")+sP+y.id,void 0);const b=g.parse(p);let E=g.runSync(b,p);return s&&(E={type:"element",tagName:"div",properties:{className:s},children:E.type==="root"?E.children:[E]}),kh(E,x),k5(E,{Fragment:a.Fragment,components:i,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function x(y,v,k){if(y.type==="raw"&&k&&typeof v=="number")return d?k.children.splice(v,1):k.children[v]={type:"text",value:y.value},v;if(y.type==="element"){let _;for(_ in Sf)if(Object.hasOwn(Sf,_)&&Object.hasOwn(y.properties,_)){const S=y.properties[_],I=Sf[_];(I===null||I.includes(y.tagName))&&(y.properties[_]=f(String(S||""),_,y))}}if(y.type==="element"){let _=t?!t.includes(y.tagName):l?l.includes(y.tagName):!1;if(!_&&r&&typeof v=="number"&&(_=!r(y,v,k)),_&&k&&typeof v=="number")return h&&y.children?k.children.splice(v,1,...y.children):k.children.splice(v,1),v}}}function lP(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||aP.test(e.slice(0,t))?e:""}function jb(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(t);for(;s!==-1;)n++,s=r.indexOf(t,s+t.length);return n}function oP(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function uP(e,t,r){const s=_h((r||{}).ignore||[]),i=cP(t);let l=-1;for(;++l<i.length;)o_(e,"text",o);function o(c,d){let h=-1,f;for(;++h<d.length;){const g=d[h],p=f?f.children:void 0;if(s(g,p?p.indexOf(g):void 0,f))return;f=g}if(f)return u(c,d)}function u(c,d){const h=d[d.length-1],f=i[l][0],g=i[l][1];let p=0;const E=h.children.indexOf(c);let x=!1,y=[];f.lastIndex=0;let v=f.exec(c.value);for(;v;){const k=v.index,_={index:v.index,input:v.input,stack:[...d,c]};let S=g(...v,_);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?f.lastIndex=k+1:(p!==k&&y.push({type:"text",value:c.value.slice(p,k)}),Array.isArray(S)?y.push(...S):S&&y.push(S),p=k+v[0].length,x=!0),!f.global)break;v=f.exec(c.value)}return x?(p<c.value.length&&y.push({type:"text",value:c.value.slice(p)}),h.children.splice(E,1,...y)):y=[c],E+y.length}}function cP(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let n=-1;for(;++n<r.length;){const s=r[n];t.push([dP(s[0]),hP(s[1])])}return t}function dP(e){return typeof e=="string"?new RegExp(oP(e),"g"):e}function hP(e){return typeof e=="function"?e:function(){return e}}const Df="phrasing",Mf=["autolink","link","image","label"];function fP(){return{transforms:[vP],enter:{literalAutolink:pP,literalAutolinkEmail:Ff,literalAutolinkHttp:Ff,literalAutolinkWww:Ff},exit:{literalAutolink:bP,literalAutolinkEmail:yP,literalAutolinkHttp:gP,literalAutolinkWww:xP}}}function mP(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Df,notInConstruct:Mf},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Df,notInConstruct:Mf},{character:":",before:"[ps]",after:"\\/",inConstruct:Df,notInConstruct:Mf}]}}function pP(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Ff(e){this.config.enter.autolinkProtocol.call(this,e)}function gP(e){this.config.exit.autolinkProtocol.call(this,e)}function xP(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function yP(e){this.config.exit.autolinkEmail.call(this,e)}function bP(e){this.exit(e)}function vP(e){uP(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,wP],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),EP]],{ignore:["link","linkReference"]})}function wP(e,t,r,n,s){let i="";if(!h_(s)||(/^w/i.test(t)&&(r=t+r,t="",i="http://"),!_P(r)))return!1;const l=NP(r+n);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function EP(e,t,r,n){return!h_(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function _P(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function NP(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],n=r.indexOf(")");const s=jb(e,"(");let i=jb(e,")");for(;n!==-1&&s>i;)e+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[e,r]}function h_(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||ei(r)||vh(r))&&(!t||r!==47)}f_.peek=PP;function kP(){return{enter:{gfmFootnoteDefinition:TP,gfmFootnoteDefinitionLabelString:CP,gfmFootnoteCall:IP,gfmFootnoteCallString:RP},exit:{gfmFootnoteDefinition:AP,gfmFootnoteDefinitionLabelString:jP,gfmFootnoteCall:OP,gfmFootnoteCallString:LP}}}function SP(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:DP,footnoteReference:f_}}}function TP(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function CP(){this.buffer()}function jP(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=yn(this.sliceSerialize(e)).toLowerCase()}function AP(e){this.exit(e)}function IP(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function RP(){this.buffer()}function LP(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=yn(this.sliceSerialize(e)).toLowerCase()}function OP(e){this.exit(e)}function f_(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteReference"),o=r.enter("reference");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),l(),i+=s.move("]"),i}function PP(){return"["}function DP(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteDefinition"),o=r.enter("label");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),i+=s.move("]:"+(e.children&&e.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(e,s.current()),MP)),l(),i}function MP(e,t,r){return t===0?e:(r?"":"    ")+e}const FP=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];m_.peek=zP;function UP(){return{canContainEols:["delete"],enter:{strikethrough:HP},exit:{strikethrough:$P}}}function BP(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:FP}],handlers:{delete:m_}}}function HP(e){this.enter({type:"delete",children:[]},e)}function $P(e){this.exit(e)}function m_(e,t,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let l=s.move("~~");return l+=r.containerPhrasing(e,{...s.current(),before:l,after:"~"}),l+=s.move("~~"),i(),l}function zP(){return"~"}function qP(e){return e.length}function VP(e,t){const r=t||{},n=(r.align||[]).concat(),s=r.stringLength||qP,i=[],l=[],o=[],u=[];let c=0,d=-1;for(;++d<e.length;){const b=[],E=[];let x=-1;for(e[d].length>c&&(c=e[d].length);++x<e[d].length;){const y=WP(e[d][x]);if(r.alignDelimiters!==!1){const v=s(y);E[x]=v,(u[x]===void 0||v>u[x])&&(u[x]=v)}b.push(y)}l[d]=b,o[d]=E}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=Ab(n[h]);else{const b=Ab(n);for(;++h<c;)i[h]=b}h=-1;const f=[],g=[];for(;++h<c;){const b=i[h];let E="",x="";b===99?(E=":",x=":"):b===108?E=":":b===114&&(x=":");let y=r.alignDelimiters===!1?1:Math.max(1,u[h]-E.length-x.length);const v=E+"-".repeat(y)+x;r.alignDelimiters!==!1&&(y=E.length+y+x.length,y>u[h]&&(u[h]=y),g[h]=y),f[h]=v}l.splice(1,0,f),o.splice(1,0,g),d=-1;const p=[];for(;++d<l.length;){const b=l[d],E=o[d];h=-1;const x=[];for(;++h<c;){const y=b[h]||"";let v="",k="";if(r.alignDelimiters!==!1){const _=u[h]-(E[h]||0),S=i[h];S===114?v=" ".repeat(_):S===99?_%2?(v=" ".repeat(_/2+.5),k=" ".repeat(_/2-.5)):(v=" ".repeat(_/2),k=v):k=" ".repeat(_)}r.delimiterStart!==!1&&!h&&x.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&y==="")&&(r.delimiterStart!==!1||h)&&x.push(" "),r.alignDelimiters!==!1&&x.push(v),x.push(y),r.alignDelimiters!==!1&&x.push(k),r.padding!==!1&&x.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&x.push("|")}p.push(r.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return p.join(`
`)}function WP(e){return e==null?"":String(e)}function Ab(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const Ib={}.hasOwnProperty;function p_(e,t){const r=t||{};function n(s,...i){let l=n.invalid;const o=n.handlers;if(s&&Ib.call(s,e)){const u=String(s[e]);l=Ib.call(o,u)?o[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function GP(e,t,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const l=r.indentLines(r.containerFlow(e,i.current()),YP);return s(),l}function YP(e,t,r){return">"+(r?"":" ")+e}function QP(e,t){return Rb(e,t.inConstruct,!0)&&!Rb(e,t.notInConstruct,!1)}function Rb(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function Lb(e,t,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&QP(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function KP(e,t){const r=String(e);let n=r.indexOf(t),s=n,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>l&&(l=i):i=1,s=n+t.length,n=r.indexOf(t,s);return l}function ZP(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function XP(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function JP(e,t,r,n){const s=XP(r),i=e.value||"",l=s==="`"?"GraveAccent":"Tilde";if(ZP(e,r)){const h=r.enter("codeIndented"),f=r.indentLines(i,eD);return h(),f}const o=r.createTracker(n),u=s.repeat(Math.max(KP(i,s)+1,3)),c=r.enter("codeFenced");let d=o.move(u);if(e.lang){const h=r.enter(`codeFencedLang${l}`);d+=o.move(r.safe(e.lang,{before:d,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=r.enter(`codeFencedMeta${l}`);d+=o.move(" "),d+=o.move(r.safe(e.meta,{before:d,after:`
`,encode:["`"],...o.current()})),h()}return d+=o.move(`
`),i&&(d+=o.move(i+`
`)),d+=o.move(u),c(),d}function eD(e,t,r){return(r?"":"    ")+e}function cg(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function tD(e,t,r,n){const s=cg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("definition");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("[");return c+=u.move(r.safe(r.associationId(e),{before:c,after:"]",...u.current()})),c+=u.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),l(),c}function rD(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function cu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Cd(e,t,r){const n=yl(e),s=yl(t);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}g_.peek=nD;function g_(e,t,r,n){const s=rD(r),i=r.enter("emphasis"),l=r.createTracker(n),o=l.move(s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Cd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=cu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Cd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+cu(h));const g=l.move(s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+g}function nD(e,t,r){return r.options.emphasis||"*"}function sD(e,t){let r=!1;return kh(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,xp}),!!((!e.depth||e.depth<3)&&rg(e)&&(t.options.setext||r))}function aD(e,t,r,n){const s=Math.max(Math.min(6,e.depth||1),1),i=r.createTracker(n);if(sD(e,r)){const d=r.enter("headingSetext"),h=r.enter("phrasing"),f=r.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const l="#".repeat(s),o=r.enter("headingAtx"),u=r.enter("phrasing");i.move(l+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=cu(c.charCodeAt(0))+c.slice(1)),c=c?l+" "+c:l,r.options.closeAtx&&(c+=" "+l),u(),o(),c}x_.peek=iD;function x_(e){return e.value||""}function iD(){return"<"}y_.peek=lD;function y_(e,t,r,n){const s=cg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("image");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("![");return c+=u.move(r.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),l(),c}function lD(){return"!"}b_.peek=oD;function b_(e,t,r,n){const s=e.referenceType,i=r.enter("imageReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("![");const c=r.safe(e.alt,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function oD(){return"!"}v_.peek=uD;function v_(e,t,r){let n=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const l=r.unsafe[i],o=r.compilePattern(l);let u;if(l.atBreak)for(;u=o.exec(n);){let c=u.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(u.index+1)}}return s+n+s}function uD(){return"`"}function w_(e,t){const r=rg(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}E_.peek=cD;function E_(e,t,r,n){const s=cg(r),i=s==='"'?"Quote":"Apostrophe",l=r.createTracker(n);let o,u;if(w_(e,r)){const d=r.stack;r.stack=[],o=r.enter("autolink");let h=l.move("<");return h+=l.move(r.containerPhrasing(e,{before:h,after:">",...l.current()})),h+=l.move(">"),o(),r.stack=d,h}o=r.enter("link"),u=r.enter("label");let c=l.move("[");return c+=l.move(r.containerPhrasing(e,{before:c,after:"](",...l.current()})),c+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(u=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(e.title,{before:c,after:s,...l.current()})),c+=l.move(s),u()),c+=l.move(")"),o(),c}function cD(e,t,r){return w_(e,r)?"<":"["}__.peek=dD;function __(e,t,r,n){const s=e.referenceType,i=r.enter("linkReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("[");const c=r.containerPhrasing(e,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function dD(){return"["}function dg(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function hD(e){const t=dg(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function fD(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function N_(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function mD(e,t,r,n){const s=r.enter("list"),i=r.bulletCurrent;let l=e.ordered?fD(r):dg(r);const o=e.ordered?l==="."?")":".":hD(r);let u=t&&r.bulletLastUsed?l===r.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&d&&(!d.children||!d.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(u=!0),N_(r)===l&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=o),r.bulletCurrent=l;const c=r.containerFlow(e,n);return r.bulletLastUsed=l,r.bulletCurrent=i,s(),c}function pD(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function gD(e,t,r,n){const s=pD(r);let i=r.bulletCurrent||dg(r);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=r.createTracker(n);o.move(i+" ".repeat(l-i.length)),o.shift(l);const u=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),d);return u(),c;function d(h,f,g){return f?(g?"":" ".repeat(l))+h:(g?i:i+" ".repeat(l-i.length))+h}}function xD(e,t,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),l=r.containerPhrasing(e,n);return i(),s(),l}const yD=_h(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function bD(e,t,r,n){return(e.children.some(function(l){return yD(l)})?r.containerPhrasing:r.containerFlow).call(r,e,n)}function vD(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}k_.peek=wD;function k_(e,t,r,n){const s=vD(r),i=r.enter("strong"),l=r.createTracker(n),o=l.move(s+s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Cd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=cu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Cd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+cu(h));const g=l.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+g}function wD(e,t,r){return r.options.strong||"*"}function ED(e,t,r,n){return r.safe(e.value,n)}function _D(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function ND(e,t,r){const n=(N_(r)+(r.options.ruleSpaces?" ":"")).repeat(_D(r));return r.options.ruleSpaces?n.slice(0,-1):n}const S_={blockquote:GP,break:Lb,code:JP,definition:tD,emphasis:g_,hardBreak:Lb,heading:aD,html:x_,image:y_,imageReference:b_,inlineCode:v_,link:E_,linkReference:__,list:mD,listItem:gD,paragraph:xD,root:bD,strong:k_,text:ED,thematicBreak:ND};function kD(){return{enter:{table:SD,tableData:Ob,tableHeader:Ob,tableRow:CD},exit:{codeText:jD,table:TD,tableData:Uf,tableHeader:Uf,tableRow:Uf}}}function SD(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function TD(e){this.exit(e),this.data.inTable=void 0}function CD(e){this.enter({type:"tableRow",children:[]},e)}function Uf(e){this.exit(e)}function Ob(e){this.enter({type:"tableCell",children:[]},e)}function jD(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,AD));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function AD(e,t){return t==="|"?t:e}function ID(e){const t=e||{},r=t.tableCellPadding,n=t.tablePipeAlign,s=t.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:l,tableCell:u,tableRow:o}};function l(g,p,b,E){return c(d(g,b,E),g.align)}function o(g,p,b,E){const x=h(g,b,E),y=c([x]);return y.slice(0,y.indexOf(`
`))}function u(g,p,b,E){const x=b.enter("tableCell"),y=b.enter("phrasing"),v=b.containerPhrasing(g,{...E,before:i,after:i});return y(),x(),v}function c(g,p){return VP(g,{align:p,alignDelimiters:n,padding:r,stringLength:s})}function d(g,p,b){const E=g.children;let x=-1;const y=[],v=p.enter("table");for(;++x<E.length;)y[x]=h(E[x],p,b);return v(),y}function h(g,p,b){const E=g.children;let x=-1;const y=[],v=p.enter("tableRow");for(;++x<E.length;)y[x]=u(E[x],g,p,b);return v(),y}function f(g,p,b){let E=S_.inlineCode(g,p,b);return b.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function RD(){return{exit:{taskListCheckValueChecked:Pb,taskListCheckValueUnchecked:Pb,paragraph:OD}}}function LD(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:PD}}}function Pb(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function OD(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=t.children;let i=-1,l;for(;++i<s.length;){const o=s[i];if(o.type==="paragraph"){l=o;break}}l===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function PD(e,t,r,n){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=r.createTracker(n);i&&o.move(l);let u=S_.listItem(e,t,r,{...n,...o.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(d){return d+l}}function DD(){return[fP(),kP(),UP(),kD(),RD()]}function MD(e){return{extensions:[mP(),SP(),BP(),ID(e),LD()]}}const FD={tokenize:qD,partial:!0},T_={tokenize:VD,partial:!0},C_={tokenize:WD,partial:!0},j_={tokenize:GD,partial:!0},UD={tokenize:YD,partial:!0},A_={name:"wwwAutolink",tokenize:$D,previous:R_},I_={name:"protocolAutolink",tokenize:zD,previous:L_},xs={name:"emailAutolink",tokenize:HD,previous:O_},$n={};function BD(){return{text:$n}}let Ea=48;for(;Ea<123;)$n[Ea]=xs,Ea++,Ea===58?Ea=65:Ea===91&&(Ea=97);$n[43]=xs;$n[45]=xs;$n[46]=xs;$n[95]=xs;$n[72]=[xs,I_];$n[104]=[xs,I_];$n[87]=[xs,A_];$n[119]=[xs,A_];function HD(e,t,r){const n=this;let s,i;return l;function l(h){return!wp(h)||!O_.call(n,n.previous)||hg(n.events)?r(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return wp(h)?(e.consume(h),o):h===64?(e.consume(h),u):r(h)}function u(h){return h===46?e.check(UD,d,c)(h):h===45||h===95||Xt(h)?(i=!0,e.consume(h),u):d(h)}function c(h){return e.consume(h),s=!0,u}function d(h){return i&&s&&lr(n.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):r(h)}}function $D(e,t,r){const n=this;return s;function s(l){return l!==87&&l!==119||!R_.call(n,n.previous)||hg(n.events)?r(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(FD,e.attempt(T_,e.attempt(C_,i),r),r)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function zD(e,t,r){const n=this;let s="",i=!1;return l;function l(h){return(h===72||h===104)&&L_.call(n,n.previous)&&!hg(n.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),o):r(h)}function o(h){if(lr(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),u}return r(h)}function u(h){return h===47?(e.consume(h),i?c:(i=!0,u)):r(h)}function c(h){return h===null||Sd(h)||ot(h)||ei(h)||vh(h)?r(h):e.attempt(T_,e.attempt(C_,d),r)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function qD(e,t,r){let n=0;return s;function s(l){return(l===87||l===119)&&n<3?(n++,e.consume(l),s):l===46&&n===3?(e.consume(l),i):r(l)}function i(l){return l===null?r(l):t(l)}}function VD(e,t,r){let n,s,i;return l;function l(c){return c===46||c===95?e.check(j_,u,o)(c):c===null||ot(c)||ei(c)||c!==45&&vh(c)?u(c):(i=!0,e.consume(c),l)}function o(c){return c===95?n=!0:(s=n,n=void 0),e.consume(c),l}function u(c){return s||n||!i?r(c):t(c)}}function WD(e,t){let r=0,n=0;return s;function s(l){return l===40?(r++,e.consume(l),s):l===41&&n<r?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(j_,t,i)(l):l===null||ot(l)||ei(l)?t(l):(e.consume(l),s)}function i(l){return l===41&&n++,e.consume(l),s}}function GD(e,t,r){return n;function n(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),n):o===38?(e.consume(o),i):o===93?(e.consume(o),s):o===60||o===null||ot(o)||ei(o)?t(o):r(o)}function s(o){return o===null||o===40||o===91||ot(o)||ei(o)?t(o):n(o)}function i(o){return lr(o)?l(o):r(o)}function l(o){return o===59?(e.consume(o),n):lr(o)?(e.consume(o),l):r(o)}}function YD(e,t,r){return n;function n(i){return e.consume(i),s}function s(i){return Xt(i)?r(i):t(i)}}function R_(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||ot(e)}function L_(e){return!lr(e)}function O_(e){return!(e===47||wp(e))}function wp(e){return e===43||e===45||e===46||e===95||Xt(e)}function hg(e){let t=e.length,r=!1;for(;t--;){const n=e[t][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const QD={tokenize:nM,partial:!0};function KD(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:eM,continuation:{tokenize:tM},exit:rM}},text:{91:{name:"gfmFootnoteCall",tokenize:JD},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:ZD,resolveTo:XD}}}}function ZD(e,t,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let l;for(;s--;){const u=n.events[s][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return o;function o(u){if(!l||!l._balanced)return r(u);const c=yn(n.sliceSerialize({start:l.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function XD(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[r+1],e[r+2],["enter",n,t],e[r+3],e[r+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",n,t]];return e.splice(r,e.length-r+1,...o),e}function JD(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,l;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),u}function u(h){return h!==94?r(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!l||h===null||h===91||ot(h))return r(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(yn(n.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(h)}return ot(h)||(l=!0),i++,e.consume(h),h===92?d:c}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,c):c(h)}}function eM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,l=0,o;return u;function u(p){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(p){return p===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):r(p)}function d(p){if(l>999||p===93&&!o||p===null||p===91||ot(p))return r(p);if(p===93){e.exit("chunkString");const b=e.exit("gfmFootnoteDefinitionLabelString");return i=yn(n.sliceSerialize(b)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return ot(p)||(o=!0),l++,e.consume(p),p===92?h:d}function h(p){return p===91||p===92||p===93?(e.consume(p),l++,d):d(p)}function f(p){return p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),s.includes(i)||s.push(i),Je(e,g,"gfmFootnoteDefinitionWhitespace")):r(p)}function g(p){return t(p)}}function tM(e,t,r){return e.check(Bu,t,e.attempt(QD,t,r))}function rM(e){e.exit("gfmFootnoteDefinition")}function nM(e,t,r){const n=this;return Je(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):r(i)}}function sM(e){let r=(e||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(l,o){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let c=u;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[u][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[u][1].end)},h={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[u][1].start)},f=[["enter",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["enter",h,o]],g=o.parser.constructs.insideSpan.null;g&&Pr(f,f.length,0,wh(g,l.slice(c+1,u),o)),Pr(f,f.length,0,[["exit",h,o],["enter",l[u][1],o],["exit",l[u][1],o],["exit",d,o]]),Pr(l,c-1,u-c+3,f),u=c+f.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function i(l,o,u){const c=this.previous,d=this.events;let h=0;return f;function f(p){return c===126&&d[d.length-1][1].type!=="characterEscape"?u(p):(l.enter("strikethroughSequenceTemporary"),g(p))}function g(p){const b=yl(c);if(p===126)return h>1?u(p):(l.consume(p),h++,g);if(h<2&&!r)return u(p);const E=l.exit("strikethroughSequenceTemporary"),x=yl(p);return E._open=!x||x===2&&!!b,E._close=!b||b===2&&!!x,o(p)}}}class aM{constructor(){this.map=[]}add(t,r,n){iM(this,t,r,n)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];n.push(t.slice()),t.length=0;let s=n.pop();for(;s;){for(const i of s)t.push(i);s=n.pop()}this.map.length=0}}function iM(e,t,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=r,e.map[s][2].push(...n);return}s+=1}e.map.push([t,r,n])}}function lM(e,t){let r=!1;const n=[];for(;t<e.length;){const s=e[t];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return n}function oM(){return{flow:{null:{name:"table",tokenize:uM,resolveAll:cM}}}}function uM(e,t,r){const n=this;let s=0,i=0,l;return o;function o(T){let B=n.events.length-1;for(;B>-1;){const G=n.events[B][1].type;if(G==="lineEnding"||G==="linePrefix")B--;else break}const O=B>-1?n.events[B][1].type:null,Y=O==="tableHead"||O==="tableRow"?S:u;return Y===S&&n.parser.lazy[n.now().line]?r(T):Y(T)}function u(T){return e.enter("tableHead"),e.enter("tableRow"),c(T)}function c(T){return T===124||(l=!0,i+=1),d(T)}function d(T){return T===null?r(T):Ce(T)?i>1?(i=0,n.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),g):r(T):Ye(T)?Je(e,d,"whitespace")(T):(i+=1,l&&(l=!1,s+=1),T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),l=!0,d):(e.enter("data"),h(T)))}function h(T){return T===null||T===124||ot(T)?(e.exit("data"),d(T)):(e.consume(T),T===92?f:h)}function f(T){return T===92||T===124?(e.consume(T),h):h(T)}function g(T){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(T):(e.enter("tableDelimiterRow"),l=!1,Ye(T)?Je(e,p,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):p(T))}function p(T){return T===45||T===58?E(T):T===124?(l=!0,e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),b):_(T)}function b(T){return Ye(T)?Je(e,E,"whitespace")(T):E(T)}function E(T){return T===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),x):T===45?(i+=1,x(T)):T===null||Ce(T)?k(T):_(T)}function x(T){return T===45?(e.enter("tableDelimiterFiller"),y(T)):_(T)}function y(T){return T===45?(e.consume(T),y):T===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),v):(e.exit("tableDelimiterFiller"),v(T))}function v(T){return Ye(T)?Je(e,k,"whitespace")(T):k(T)}function k(T){return T===124?p(T):T===null||Ce(T)?!l||s!==i?_(T):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(T)):_(T)}function _(T){return r(T)}function S(T){return e.enter("tableRow"),I(T)}function I(T){return T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),I):T===null||Ce(T)?(e.exit("tableRow"),t(T)):Ye(T)?Je(e,I,"whitespace")(T):(e.enter("data"),j(T))}function j(T){return T===null||T===124||ot(T)?(e.exit("data"),I(T)):(e.consume(T),T===92?D:j)}function D(T){return T===92||T===124?(e.consume(T),j):j(T)}}function cM(e,t){let r=-1,n=!0,s=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,u=0,c,d,h;const f=new aM;for(;++r<e.length;){const g=e[r],p=g[1];g[0]==="enter"?p.type==="tableHead"?(o=!1,u!==0&&(Db(f,t,u,c,d),d=void 0,u=0),c={type:"table",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(r,0,[["enter",c,t]])):p.type==="tableRow"||p.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],l=[0,r+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(r,0,[["enter",d,t]])),s=p.type==="tableDelimiterRow"?2:d?3:1):s&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")?(n=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],h=Sc(f,t,i,s,void 0,h),i=[0,0,0,0]),l[2]=r)):p.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(l[0]=l[1],h=Sc(f,t,i,s,void 0,h)),i=l,l=[i[1],r,0,0])):p.type==="tableHead"?(o=!0,u=r):p.type==="tableRow"||p.type==="tableDelimiterRow"?(u=r,i[1]!==0?(l[0]=l[1],h=Sc(f,t,i,s,r,h)):l[1]!==0&&(h=Sc(f,t,l,s,r,h)),s=0):s&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")&&(l[3]=r)}for(u!==0&&Db(f,t,u,c,d),f.consume(t.events),r=-1;++r<t.events.length;){const g=t.events[r];g[0]==="enter"&&g[1].type==="table"&&(g[1]._align=lM(t.events,r))}return e}function Sc(e,t,r,n,s,i){const l=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(i.end=Object.assign({},xi(t.events,r[0])),e.add(r[0],0,[["exit",i,t]]));const u=xi(t.events,r[1]);if(i={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(r[1],0,[["enter",i,t]]),r[2]!==0){const c=xi(t.events,r[2]),d=xi(t.events,r[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(r[2],0,[["enter",h,t]]),n!==2){const f=t.events[r[2]],g=t.events[r[3]];if(f[1].end=Object.assign({},g[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const p=r[2]+1,b=r[3]-r[2]-1;e.add(p,b,[])}}e.add(r[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},xi(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function Db(e,t,r,n,s){const i=[],l=xi(t.events,r);s&&(s.end=Object.assign({},l),i.push(["exit",s,t])),n.end=Object.assign({},l),i.push(["exit",n,t]),e.add(r+1,0,i)}function xi(e,t){const r=e[t],n=r[0]==="enter"?"start":"end";return r[1][n]}const dM={name:"tasklistCheck",tokenize:fM};function hM(){return{text:{91:dM}}}function fM(e,t,r){const n=this;return s;function s(u){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return ot(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):r(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(u)}function o(u){return Ce(u)?t(u):Ye(u)?e.check({tokenize:mM},t,r)(u):r(u)}}function mM(e,t,r){return Je(e,n,"whitespace");function n(s){return s===null?r(s):t(s)}}function pM(e){return zE([BD(),KD(),sM(e),oM(),hM()])}const gM={};function P_(e){const t=this,r=e||gM,n=t.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),l=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(pM(r)),i.push(DD()),l.push(MD(r))}const Mb=/[#.]/g;function xM(e,t){const r=e||"",n={};let s=0,i,l;for(;s<r.length;){Mb.lastIndex=s;const o=Mb.exec(r),u=r.slice(s,o?o.index:r.length);u&&(i?i==="#"?n.id=u:Array.isArray(n.className)?n.className.push(u):n.className=[u]:l=u,s+=u.length),o&&(i=o[0],s++)}return{type:"element",tagName:l||t||"div",properties:n,children:[]}}const Ep={}.hasOwnProperty;function D_(e,t,r){const n=r&&wM(r);function s(i,l,...o){let u=-1,c;if(i==null){c={type:"root",children:[]};const d=l;o.unshift(d)}else if(c=xM(i,t),c.tagName=c.tagName.toLowerCase(),n&&Ep.call(n,c.tagName)&&(c.tagName=n[c.tagName]),yM(l))o.unshift(l);else{let d;for(d in l)Ep.call(l,d)&&bM(e,c.properties,d,l[d])}for(;++u<o.length;)_p(c.children,o[u]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function yM(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,r=Object.keys(e);for(const n of r){const s=t[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function bM(e,t,r,n){const s=yh(e,r);let i=-1,l;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;l=n}else typeof n=="boolean"?l=n:typeof n=="string"?s.spaceSeparated?l=qy(n):s.commaSeparated?l=Uy(n):s.commaOrSpaceSeparated?l=qy(Uy(n).join(" ")):l=Fb(s,s.property,n):Array.isArray(n)?l=n.concat():l=s.property==="style"?vM(n):String(n);if(Array.isArray(l)){const o=[];for(;++i<l.length;){const u=Fb(s,s.property,l[i]);o[i]=u}l=o}if(s.property==="className"&&Array.isArray(t.className)){const o=l;l=t.className.concat(o)}t[s.property]=l}}function _p(e,t){let r=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)_p(e,t[r]);else if(typeof t=="object"&&"type"in t)t.type==="root"?_p(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function Fb(e,t,r){if(typeof r=="string"){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(r===""||ou(r)===ou(t)))return!0}return r}function vM(e){const t=[];let r;for(r in e)Ep.call(e,r)&&t.push([r,e[r]].join(": "));return t.join("; ")}function wM(e){const t={};let r=-1;for(;++r<e.length;)t[e[r].toLowerCase()]=e[r];return t}const EM=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],_M=D_(Uu,"div"),NM=D_(ya,"g",EM);function kM(e){const t=String(e),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=r[l];if(o===void 0){const u=Ub(t,r[l-1]);o=u===-1?t.length+1:u+1,r[l]=o}if(o>i)return{line:l+1,column:i-(l>0?r[l-1]:0)+1,offset:i};l++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const o=r[r.length-1],u=Ub(t,o),c=u===-1?t.length+1:u+1;if(o===c)break;r.push(c)}const l=(i.line>1?r[i.line-2]:0)+i.column-1;if(l<r[i.line-1])return l}}}function Ub(e,t){const r=e.indexOf("\r",t),n=e.indexOf(`
`,t);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const La={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},M_={}.hasOwnProperty,SM=Object.prototype;function TM(e,t){const r=t||{};return fg({file:r.file||void 0,location:!1,schema:r.space==="svg"?ya:Uu,verbose:r.verbose||!1},e)}function fg(e,t){let r;switch(t.nodeName){case"#comment":{const n=t;return r={type:"comment",value:n.data},qc(e,n,r),r}case"#document":case"#document-fragment":{const n=t,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:F_(e,t.childNodes),data:{quirksMode:s}},e.file&&e.location){const i=String(e.file),l=kM(i),o=l.toPoint(0),u=l.toPoint(i.length);r.position={start:o,end:u}}return r}case"#documentType":{const n=t;return r={type:"doctype"},qc(e,n,r),r}case"#text":{const n=t;return r={type:"text",value:n.value},qc(e,n,r),r}default:return r=CM(e,t),r}}function F_(e,t){let r=-1;const n=[];for(;++r<t.length;){const s=fg(e,t[r]);n.push(s)}return n}function CM(e,t){const r=e.schema;e.schema=t.namespaceURI===La.svg?ya:Uu;let n=-1;const s={};for(;++n<t.attrs.length;){const o=t.attrs[n],u=(o.prefix?o.prefix+":":"")+o.name;M_.call(SM,u)||(s[u]=o.value)}const l=(e.schema.space==="svg"?NM:_M)(t.tagName,s,F_(e,t.childNodes));if(qc(e,t,l),l.tagName==="template"){const o=t,u=o.sourceCodeLocation,c=u&&u.startTag&&Ii(u.startTag),d=u&&u.endTag&&Ii(u.endTag),h=fg(e,o.content);c&&d&&e.file&&(h.position={start:c.end,end:d.start}),l.content=h}return e.schema=r,l}function qc(e,t,r){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const n=jM(e,r,t.sourceCodeLocation);n&&(e.location=!0,r.position=n)}}function jM(e,t,r){const n=Ii(r);if(t.type==="element"){const s=t.children[t.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),e.verbose){const i={};let l;if(r.attrs)for(l in r.attrs)M_.call(r.attrs,l)&&(i[yh(e.schema,l).property]=Ii(r.attrs[l]));r.startTag;const o=Ii(r.startTag),u=r.endTag?Ii(r.endTag):void 0,c={opening:o};u&&(c.closing=u),c.properties=i,t.data={position:c}}}return n}function Ii(e){const t=Bb({line:e.startLine,column:e.startCol,offset:e.startOffset}),r=Bb({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||r?{start:t,end:r}:void 0}function Bb(e){return e.line&&e.column?e:void 0}const AM={},IM={}.hasOwnProperty,U_=p_("type",{handlers:{root:LM,element:FM,text:DM,comment:MM,doctype:PM}});function RM(e,t){const n=(t||AM).space;return U_(e,n==="svg"?ya:Uu)}function LM(e,t){const r={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=mg(e.children,r,t),Dl(e,r),r}function OM(e,t){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=mg(e.children,r,t),Dl(e,r),r}function PM(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return Dl(e,t),t}function DM(e){const t={nodeName:"#text",value:e.value,parentNode:null};return Dl(e,t),t}function MM(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return Dl(e,t),t}function FM(e,t){const r=t;let n=r;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=ya);const s=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&IM.call(e.properties,i)){const u=UM(n,i,e.properties[i]);u&&s.push(u)}}const l=n.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:s,namespaceURI:La[l],childNodes:[],parentNode:null};return o.childNodes=mg(e.children,o,n),Dl(e,o),e.tagName==="template"&&e.content&&(o.content=OM(e.content,n)),o}function UM(e,t,r){const n=yh(e,t);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?kE(r):OE(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=La[n.space]}return s}function mg(e,t,r){let n=-1;const s=[];if(e)for(;++n<e.length;){const i=U_(e[n],r);i.parentNode=t,s.push(i)}return s}function Dl(e,t){const r=e.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,t.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const BM=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],HM=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),gt="";var C;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(C||(C={}));const pr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function B_(e){return e>=55296&&e<=57343}function $M(e){return e>=56320&&e<=57343}function zM(e,t){return(e-55296)*1024+9216+t}function H_(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function $_(e){return e>=64976&&e<=65007||HM.has(e)}var X;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(X||(X={}));const qM=65536;class VM{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=qM,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,r){const{line:n,col:s,offset:i}=this,l=s+r,o=i+r;return{code:t,startLine:n,endLine:n,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if($M(r))return this.pos++,this._addGap(),zM(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,C.EOF;return this._err(X.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;const n=this.html.charCodeAt(r);return n===C.CARRIAGE_RETURN?C.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;let t=this.html.charCodeAt(this.pos);return t===C.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,C.LINE_FEED):t===C.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,B_(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===C.LINE_FEED||t===C.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){H_(t)?this._err(X.controlCharacterInInputStream):$_(t)&&this._err(X.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var We;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(We||(We={}));function z_(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}const q_=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),WM=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var Bf;const GM=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),YM=(Bf=String.fromCodePoint)!==null&&Bf!==void 0?Bf:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function QM(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=GM.get(e))!==null&&t!==void 0?t:e}var Ht;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Ht||(Ht={}));const KM=32;var Ys;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Ys||(Ys={}));function Np(e){return e>=Ht.ZERO&&e<=Ht.NINE}function ZM(e){return e>=Ht.UPPER_A&&e<=Ht.UPPER_F||e>=Ht.LOWER_A&&e<=Ht.LOWER_F}function XM(e){return e>=Ht.UPPER_A&&e<=Ht.UPPER_Z||e>=Ht.LOWER_A&&e<=Ht.LOWER_Z||Np(e)}function JM(e){return e===Ht.EQUALS||XM(e)}var Ft;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Ft||(Ft={}));var rs;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(rs||(rs={}));class V_{constructor(t,r,n){this.decodeTree=t,this.emitCodePoint=r,this.errors=n,this.state=Ft.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=rs.Strict}startEntity(t){this.decodeMode=t,this.state=Ft.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,r){switch(this.state){case Ft.EntityStart:return t.charCodeAt(r)===Ht.NUM?(this.state=Ft.NumericStart,this.consumed+=1,this.stateNumericStart(t,r+1)):(this.state=Ft.NamedEntity,this.stateNamedEntity(t,r));case Ft.NumericStart:return this.stateNumericStart(t,r);case Ft.NumericDecimal:return this.stateNumericDecimal(t,r);case Ft.NumericHex:return this.stateNumericHex(t,r);case Ft.NamedEntity:return this.stateNamedEntity(t,r)}}stateNumericStart(t,r){return r>=t.length?-1:(t.charCodeAt(r)|KM)===Ht.LOWER_X?(this.state=Ft.NumericHex,this.consumed+=1,this.stateNumericHex(t,r+1)):(this.state=Ft.NumericDecimal,this.stateNumericDecimal(t,r))}addToNumericResult(t,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(r,i),s),this.consumed+=i}}stateNumericHex(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(Np(s)||ZM(s))r+=1;else return this.addToNumericResult(t,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,n,r,16),-1}stateNumericDecimal(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(Np(s))r+=1;else return this.addToNumericResult(t,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,n,r,10),-1}emitNumericEntity(t,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Ht.SEMI)this.consumed+=1;else if(this.decodeMode===rs.Strict)return 0;return this.emitCodePoint(QM(this.result),this.consumed),this.errors&&(t!==Ht.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&Ys.VALUE_LENGTH)>>14;for(;r<t.length;r++,this.excess++){const l=t.charCodeAt(r);if(this.treeIndex=e8(n,s,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===rs.Attribute&&(i===0||JM(l))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&Ys.VALUE_LENGTH)>>14,i!==0){if(l===Ht.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==rs.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:r,decodeTree:n}=this,s=(n[r]&Ys.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[t]&~Ys.VALUE_LENGTH:s[t+1],n),r===3&&this.emitCodePoint(s[t+2],n),n}end(){var t;switch(this.state){case Ft.NamedEntity:return this.result!==0&&(this.decodeMode!==rs.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Ft.NumericDecimal:return this.emitNumericEntity(0,2);case Ft.NumericHex:return this.emitNumericEntity(0,3);case Ft.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Ft.EntityStart:return 0}}}function W_(e){let t="";const r=new V_(e,n=>t+=YM(n));return function(s,i){let l=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(l,o),r.startEntity(i);const c=r.write(s,o+1);if(c<0){l=o+r.end();break}l=o+c,o=c===0?l+1:l}const u=t+s.slice(l);return t="",u}}function e8(e,t,r,n){const s=(t&Ys.BRANCH_LENGTH)>>7,i=t&Ys.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const u=n-i;return u<0||u>=s?-1:e[r+u]-1}let l=r,o=l+s-1;for(;l<=o;){const u=l+o>>>1,c=e[u];if(c<n)l=u+1;else if(c>n)o=u-1;else return e[u+s]}return-1}W_(q_);W_(WM);var ne;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(ne||(ne={}));var qa;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(qa||(qa={}));var Yr;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(Yr||(Yr={}));var W;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(W||(W={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(m||(m={}));const t8=new Map([[W.A,m.A],[W.ADDRESS,m.ADDRESS],[W.ANNOTATION_XML,m.ANNOTATION_XML],[W.APPLET,m.APPLET],[W.AREA,m.AREA],[W.ARTICLE,m.ARTICLE],[W.ASIDE,m.ASIDE],[W.B,m.B],[W.BASE,m.BASE],[W.BASEFONT,m.BASEFONT],[W.BGSOUND,m.BGSOUND],[W.BIG,m.BIG],[W.BLOCKQUOTE,m.BLOCKQUOTE],[W.BODY,m.BODY],[W.BR,m.BR],[W.BUTTON,m.BUTTON],[W.CAPTION,m.CAPTION],[W.CENTER,m.CENTER],[W.CODE,m.CODE],[W.COL,m.COL],[W.COLGROUP,m.COLGROUP],[W.DD,m.DD],[W.DESC,m.DESC],[W.DETAILS,m.DETAILS],[W.DIALOG,m.DIALOG],[W.DIR,m.DIR],[W.DIV,m.DIV],[W.DL,m.DL],[W.DT,m.DT],[W.EM,m.EM],[W.EMBED,m.EMBED],[W.FIELDSET,m.FIELDSET],[W.FIGCAPTION,m.FIGCAPTION],[W.FIGURE,m.FIGURE],[W.FONT,m.FONT],[W.FOOTER,m.FOOTER],[W.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[W.FORM,m.FORM],[W.FRAME,m.FRAME],[W.FRAMESET,m.FRAMESET],[W.H1,m.H1],[W.H2,m.H2],[W.H3,m.H3],[W.H4,m.H4],[W.H5,m.H5],[W.H6,m.H6],[W.HEAD,m.HEAD],[W.HEADER,m.HEADER],[W.HGROUP,m.HGROUP],[W.HR,m.HR],[W.HTML,m.HTML],[W.I,m.I],[W.IMG,m.IMG],[W.IMAGE,m.IMAGE],[W.INPUT,m.INPUT],[W.IFRAME,m.IFRAME],[W.KEYGEN,m.KEYGEN],[W.LABEL,m.LABEL],[W.LI,m.LI],[W.LINK,m.LINK],[W.LISTING,m.LISTING],[W.MAIN,m.MAIN],[W.MALIGNMARK,m.MALIGNMARK],[W.MARQUEE,m.MARQUEE],[W.MATH,m.MATH],[W.MENU,m.MENU],[W.META,m.META],[W.MGLYPH,m.MGLYPH],[W.MI,m.MI],[W.MO,m.MO],[W.MN,m.MN],[W.MS,m.MS],[W.MTEXT,m.MTEXT],[W.NAV,m.NAV],[W.NOBR,m.NOBR],[W.NOFRAMES,m.NOFRAMES],[W.NOEMBED,m.NOEMBED],[W.NOSCRIPT,m.NOSCRIPT],[W.OBJECT,m.OBJECT],[W.OL,m.OL],[W.OPTGROUP,m.OPTGROUP],[W.OPTION,m.OPTION],[W.P,m.P],[W.PARAM,m.PARAM],[W.PLAINTEXT,m.PLAINTEXT],[W.PRE,m.PRE],[W.RB,m.RB],[W.RP,m.RP],[W.RT,m.RT],[W.RTC,m.RTC],[W.RUBY,m.RUBY],[W.S,m.S],[W.SCRIPT,m.SCRIPT],[W.SEARCH,m.SEARCH],[W.SECTION,m.SECTION],[W.SELECT,m.SELECT],[W.SOURCE,m.SOURCE],[W.SMALL,m.SMALL],[W.SPAN,m.SPAN],[W.STRIKE,m.STRIKE],[W.STRONG,m.STRONG],[W.STYLE,m.STYLE],[W.SUB,m.SUB],[W.SUMMARY,m.SUMMARY],[W.SUP,m.SUP],[W.TABLE,m.TABLE],[W.TBODY,m.TBODY],[W.TEMPLATE,m.TEMPLATE],[W.TEXTAREA,m.TEXTAREA],[W.TFOOT,m.TFOOT],[W.TD,m.TD],[W.TH,m.TH],[W.THEAD,m.THEAD],[W.TITLE,m.TITLE],[W.TR,m.TR],[W.TRACK,m.TRACK],[W.TT,m.TT],[W.U,m.U],[W.UL,m.UL],[W.SVG,m.SVG],[W.VAR,m.VAR],[W.WBR,m.WBR],[W.XMP,m.XMP]]);function Ml(e){var t;return(t=t8.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const se=m,r8={[ne.HTML]:new Set([se.ADDRESS,se.APPLET,se.AREA,se.ARTICLE,se.ASIDE,se.BASE,se.BASEFONT,se.BGSOUND,se.BLOCKQUOTE,se.BODY,se.BR,se.BUTTON,se.CAPTION,se.CENTER,se.COL,se.COLGROUP,se.DD,se.DETAILS,se.DIR,se.DIV,se.DL,se.DT,se.EMBED,se.FIELDSET,se.FIGCAPTION,se.FIGURE,se.FOOTER,se.FORM,se.FRAME,se.FRAMESET,se.H1,se.H2,se.H3,se.H4,se.H5,se.H6,se.HEAD,se.HEADER,se.HGROUP,se.HR,se.HTML,se.IFRAME,se.IMG,se.INPUT,se.LI,se.LINK,se.LISTING,se.MAIN,se.MARQUEE,se.MENU,se.META,se.NAV,se.NOEMBED,se.NOFRAMES,se.NOSCRIPT,se.OBJECT,se.OL,se.P,se.PARAM,se.PLAINTEXT,se.PRE,se.SCRIPT,se.SECTION,se.SELECT,se.SOURCE,se.STYLE,se.SUMMARY,se.TABLE,se.TBODY,se.TD,se.TEMPLATE,se.TEXTAREA,se.TFOOT,se.TH,se.THEAD,se.TITLE,se.TR,se.TRACK,se.UL,se.WBR,se.XMP]),[ne.MATHML]:new Set([se.MI,se.MO,se.MN,se.MS,se.MTEXT,se.ANNOTATION_XML]),[ne.SVG]:new Set([se.TITLE,se.FOREIGN_OBJECT,se.DESC]),[ne.XLINK]:new Set,[ne.XML]:new Set,[ne.XMLNS]:new Set},kp=new Set([se.H1,se.H2,se.H3,se.H4,se.H5,se.H6]);W.STYLE,W.SCRIPT,W.XMP,W.IFRAME,W.NOEMBED,W.NOFRAMES,W.PLAINTEXT;var L;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(L||(L={}));const Tt={DATA:L.DATA,RCDATA:L.RCDATA,RAWTEXT:L.RAWTEXT,SCRIPT_DATA:L.SCRIPT_DATA,PLAINTEXT:L.PLAINTEXT,CDATA_SECTION:L.CDATA_SECTION};function n8(e){return e>=C.DIGIT_0&&e<=C.DIGIT_9}function fo(e){return e>=C.LATIN_CAPITAL_A&&e<=C.LATIN_CAPITAL_Z}function s8(e){return e>=C.LATIN_SMALL_A&&e<=C.LATIN_SMALL_Z}function ks(e){return s8(e)||fo(e)}function Hb(e){return ks(e)||n8(e)}function Tc(e){return e+32}function G_(e){return e===C.SPACE||e===C.LINE_FEED||e===C.TABULATION||e===C.FORM_FEED}function $b(e){return G_(e)||e===C.SOLIDUS||e===C.GREATER_THAN_SIGN}function a8(e){return e===C.NULL?X.nullCharacterReference:e>1114111?X.characterReferenceOutsideUnicodeRange:B_(e)?X.surrogateCharacterReference:$_(e)?X.noncharacterCharacterReference:H_(e)||e===C.CARRIAGE_RETURN?X.controlCharacterReference:null}class i8{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=L.DATA,this.returnState=L.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new VM(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new V_(q_,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(X.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(X.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=a8(n);s&&this._err(s,1)}}:void 0)}_err(t,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(t,r))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:We.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:We.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:We.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:We.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(z_(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(X.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=Ml(t.tagName),t.type===We.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(X.endTagWithAttributes),t.selfClosing&&this._err(X.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case We.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case We.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case We.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:We.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,r)}_emitCodePoint(t){const r=G_(t)?We.WHITESPACE_CHARACTER:t===C.NULL?We.NULL_CHARACTER:We.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(We.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=L.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?rs.Attribute:rs.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===L.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===L.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===L.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case L.DATA:{this._stateData(t);break}case L.RCDATA:{this._stateRcdata(t);break}case L.RAWTEXT:{this._stateRawtext(t);break}case L.SCRIPT_DATA:{this._stateScriptData(t);break}case L.PLAINTEXT:{this._statePlaintext(t);break}case L.TAG_OPEN:{this._stateTagOpen(t);break}case L.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case L.TAG_NAME:{this._stateTagName(t);break}case L.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case L.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case L.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case L.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case L.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case L.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case L.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case L.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case L.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case L.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case L.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case L.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case L.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case L.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case L.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case L.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case L.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case L.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case L.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case L.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case L.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case L.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case L.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case L.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case L.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case L.BOGUS_COMMENT:{this._stateBogusComment(t);break}case L.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case L.COMMENT_START:{this._stateCommentStart(t);break}case L.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case L.COMMENT:{this._stateComment(t);break}case L.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case L.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case L.COMMENT_END:{this._stateCommentEnd(t);break}case L.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case L.DOCTYPE:{this._stateDoctype(t);break}case L.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case L.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case L.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case L.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case L.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case L.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case L.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case L.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case L.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case L.CDATA_SECTION:{this._stateCdataSection(t);break}case L.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case L.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case L.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case L.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.TAG_OPEN;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitCodePoint(t);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case C.AMPERSAND:{this._startCharacterReference();break}case C.LESS_THAN_SIGN:{this.state=L.RCDATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.RAWTEXT_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(ks(t))this._createStartTagToken(),this.state=L.TAG_NAME,this._stateTagName(t);else switch(t){case C.EXCLAMATION_MARK:{this.state=L.MARKUP_DECLARATION_OPEN;break}case C.SOLIDUS:{this.state=L.END_TAG_OPEN;break}case C.QUESTION_MARK:{this._err(X.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t);break}case C.EOF:{this._err(X.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(X.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=L.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(ks(t))this._createEndTagToken(),this.state=L.TAG_NAME,this._stateTagName(t);else switch(t){case C.GREATER_THAN_SIGN:{this._err(X.missingEndTagName),this.state=L.DATA;break}case C.EOF:{this._err(X.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(X.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this.state=L.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.tagName+=gt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(fo(t)?Tc(t):t)}}_stateRcdataLessThanSign(t){t===C.SOLIDUS?this.state=L.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=L.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){ks(t)?(this.state=L.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=L.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=L.BEFORE_ATTRIBUTE_NAME,!1;case C.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=L.SELF_CLOSING_START_TAG,!1;case C.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=L.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===C.SOLIDUS?this.state=L.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){ks(t)?(this.state=L.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case C.SOLIDUS:{this.state=L.SCRIPT_DATA_END_TAG_OPEN;break}case C.EXCLAMATION_MARK:{this.state=L.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=L.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){ks(t)?(this.state=L.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===C.HYPHEN_MINUS?(this.state=L.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===C.HYPHEN_MINUS?(this.state=L.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_ESCAPED,this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.GREATER_THAN_SIGN:{this.state=L.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_ESCAPED,this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===C.SOLIDUS?this.state=L.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:ks(t)?(this._emitChars("<"),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){ks(t)?(this.state=L.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(pr.SCRIPT,!1)&&$b(this.preprocessor.peek(pr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<pr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.GREATER_THAN_SIGN:{this.state=L.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(gt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===C.SOLIDUS?(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(pr.SCRIPT,!1)&&$b(this.preprocessor.peek(pr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<pr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=L.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this.state=L.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._err(X.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=L.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=L.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this._leaveAttrName(),this.state=L.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._leaveAttrName(),this.state=L.BEFORE_ATTRIBUTE_VALUE;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:{this._err(X.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.name+=gt;break}default:this.currentAttr.name+=String.fromCodePoint(fo(t)?Tc(t):t)}}_stateAfterAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:{this.state=L.SELF_CLOSING_START_TAG;break}case C.EQUALS_SIGN:{this.state=L.BEFORE_ATTRIBUTE_VALUE;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=L.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{this.state=L.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this.state=L.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingAttributeValue),this.state=L.DATA,this.emitCurrentTagToken();break}default:this.state=L.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=gt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case C.APOSTROPHE:{this.state=L.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=gt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=L.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=gt;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:case C.EQUALS_SIGN:case C.GRAVE_ACCENT:{this._err(X.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this._leaveAttrValue(),this.state=L.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._err(X.missingWhitespaceBetweenAttributes),this.state=L.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case C.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._err(X.unexpectedSolidusInTag),this.state=L.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.data+=gt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(pr.DASH_DASH,!0)?(this._createCommentToken(pr.DASH_DASH.length+1),this.state=L.COMMENT_START):this._consumeSequenceIfMatch(pr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(pr.DOCTYPE.length+1),this.state=L.DOCTYPE):this._consumeSequenceIfMatch(pr.CDATA_START,!0)?this.inForeignNode?this.state=L.CDATA_SECTION:(this._err(X.cdataInHtmlContent),this._createCommentToken(pr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=L.BOGUS_COMMENT):this._ensureHibernation()||(this._err(X.incorrectlyOpenedComment),this._createCommentToken(2),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_START_DASH;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptClosingOfEmptyComment),this.state=L.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=L.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptClosingOfEmptyComment),this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=L.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END_DASH;break}case C.LESS_THAN_SIGN:{r.data+="<",this.state=L.COMMENT_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.data+=gt;break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case C.EXCLAMATION_MARK:{r.data+="!",this.state=L.COMMENT_LESS_THAN_SIGN_BANG;break}case C.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=L.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===C.HYPHEN_MINUS?this.state=L.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=L.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===C.HYPHEN_MINUS?this.state=L.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=L.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==C.GREATER_THAN_SIGN&&t!==C.EOF&&this._err(X.nestedComment),this.state=L.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END;break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=L.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentComment(r);break}case C.EXCLAMATION_MARK:{this.state=L.COMMENT_END_BANG;break}case C.HYPHEN_MINUS:{r.data+="-";break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=L.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{r.data+="--!",this.state=L.COMMENT_END_DASH;break}case C.GREATER_THAN_SIGN:{this._err(X.incorrectlyClosedComment),this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=L.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=L.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case C.EOF:{this._err(X.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingWhitespaceBeforeDoctypeName),this.state=L.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(fo(t))this._createDoctypeToken(String.fromCharCode(Tc(t))),this.state=L.DOCTYPE_NAME;else switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.NULL:{this._err(X.unexpectedNullCharacter),this._createDoctypeToken(gt),this.state=L.DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=L.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.AFTER_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.name+=gt;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(fo(t)?Tc(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(pr.PUBLIC,!1)?this.state=L.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(pr.SYSTEM,!1)?this.state=L.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(X.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.publicId+=gt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.publicId+=gt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.QUOTATION_MARK:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.systemId+=gt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.systemId+=gt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.NULL:{this._err(X.unexpectedNullCharacter);break}case C.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case C.RIGHT_SQUARE_BRACKET:{this.state=L.CDATA_SECTION_BRACKET;break}case C.EOF:{this._err(X.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===C.RIGHT_SQUARE_BRACKET?this.state=L.CDATA_SECTION_END:(this._emitChars("]"),this.state=L.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA;break}case C.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=L.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(C.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&Hb(this.preprocessor.peek(1))?L.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){Hb(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===C.SEMICOLON&&this._err(X.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const Y_=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),zb=new Set([...Y_,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),jd=new Set([m.APPLET,m.CAPTION,m.HTML,m.MARQUEE,m.OBJECT,m.TABLE,m.TD,m.TEMPLATE,m.TH]),l8=new Set([...jd,m.OL,m.UL]),o8=new Set([...jd,m.BUTTON]),qb=new Set([m.ANNOTATION_XML,m.MI,m.MN,m.MO,m.MS,m.MTEXT]),Vb=new Set([m.DESC,m.FOREIGN_OBJECT,m.TITLE]),u8=new Set([m.TR,m.TEMPLATE,m.HTML]),c8=new Set([m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML]),d8=new Set([m.TABLE,m.TEMPLATE,m.HTML]),h8=new Set([m.TD,m.TH]);class f8{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===ne.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const s=this._indexOf(t)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==ne.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(kp,ne.HTML)}popUntilTableCellPopped(){this.popUntilPopped(h8,ne.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(d8,ne.HTML)}clearBackToTableBodyContext(){this.clearBackTo(c8,ne.HTML)}clearBackToTableRowContext(){this.clearBackTo(u8,ne.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInDynamicScope(t,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case ne.HTML:{if(s===t)return!0;if(r.has(s))return!1;break}case ne.SVG:{if(Vb.has(s))return!1;break}case ne.MATHML:{if(qb.has(s))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,jd)}hasInListItemScope(t){return this.hasInDynamicScope(t,l8)}hasInButtonScope(t){return this.hasInDynamicScope(t,o8)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case ne.HTML:{if(kp.has(r))return!0;if(jd.has(r))return!1;break}case ne.SVG:{if(Vb.has(r))return!1;break}case ne.MATHML:{if(qb.has(r))return!1;break}}}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ne.HTML)switch(this.tagIDs[r]){case t:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===ne.HTML)switch(this.tagIDs[t]){case m.TBODY:case m.THEAD:case m.TFOOT:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ne.HTML)switch(this.tagIDs[r]){case t:return!0;case m.OPTION:case m.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Y_.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;zb.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&zb.has(this.currentTagId);)this.pop()}}const Hf=3;var Rn;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Rn||(Rn={}));const Wb={type:Rn.Marker};class m8{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const u=this.entries[o];if(u.type===Rn.Marker)break;const{element:c}=u;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===l){const d=this.treeAdapter.getAttrList(c);d.length===s&&n.push({idx:o,attrs:d})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<Hf)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<Hf)return;const s=new Map(r.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<n.length;l++){const o=n[l];o.attrs.every(u=>s.get(u.name)===u.value)&&(i+=1,i>=Hf&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(Wb)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:Rn.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:Rn.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(Wb);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===Rn.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===Rn.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===Rn.Element&&r.element===t)}}const Ss={createDocument(){return{nodeName:"#document",mode:Yr.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const s=e.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=t,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Ss.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Ss.isTextNode(r)){r.value+=t;return}}Ss.appendChild(e,Ss.createTextNode(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Ss.isTextNode(n)?n.value+=t:Ss.insertBefore(e,Ss.createTextNode(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},Q_="html",p8="about:legacy-compat",g8="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",K_=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],x8=[...K_,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],y8=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Z_=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],b8=[...Z_,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Gb(e,t){return t.some(r=>e.startsWith(r))}function v8(e){return e.name===Q_&&e.publicId===null&&(e.systemId===null||e.systemId===p8)}function w8(e){if(e.name!==Q_)return Yr.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===g8)return Yr.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),y8.has(r))return Yr.QUIRKS;let n=t===null?x8:K_;if(Gb(r,n))return Yr.QUIRKS;if(n=t===null?Z_:b8,Gb(r,n))return Yr.LIMITED_QUIRKS}return Yr.NO_QUIRKS}const Yb={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},E8="definitionurl",_8="definitionURL",N8=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),k8=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:ne.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:ne.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:ne.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:ne.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:ne.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:ne.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:ne.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:ne.XML}],["xml:space",{prefix:"xml",name:"space",namespace:ne.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:ne.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:ne.XMLNS}]]),S8=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),T8=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function C8(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===qa.COLOR||n===qa.SIZE||n===qa.FACE)||T8.has(t)}function X_(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===E8){e.attrs[t].name=_8;break}}function J_(e){for(let t=0;t<e.attrs.length;t++){const r=N8.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function pg(e){for(let t=0;t<e.attrs.length;t++){const r=k8.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function j8(e){const t=S8.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=Ml(e.tagName))}function A8(e,t){return t===ne.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function I8(e,t,r){if(t===ne.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===qa.ENCODING){const s=r[n].value.toLowerCase();return s===Yb.TEXT_HTML||s===Yb.APPLICATION_XML}}return t===ne.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function R8(e,t,r,n){return(!n||n===ne.HTML)&&I8(e,t,r)||(!n||n===ne.MATHML)&&A8(e,t)}const L8="hidden",O8=8,P8=3;var P;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(P||(P={}));const D8={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},eN=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),Qb={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Ss,onParseError:null};class Kb{constructor(t,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=P.INITIAL,this.originalInsertionMode=P.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...Qb,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new i8(this.options,this),this.activeFormattingElements=new m8(this.treeAdapter),this.fragmentContextID=n?Ml(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new f8(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...Qb,...r};t??(t=n.treeAdapter.createElement(W.TEMPLATE,ne.HTML,[]));const s=n.treeAdapter.createElement("documentmock",ne.HTML,[]),i=new this(n,s,t);return i.fragmentContextID===m.TEMPLATE&&i.tmplInsertionModeStack.unshift(P.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var s;if(!this.onParseError)return;const i=(s=t.location)!==null&&s!==void 0?s:D8,l={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,t,this.openElements.current),r){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===ne.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,ne.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=P.TEXT}switchToPlaintextParsing(){this.insertionMode=P.TEXT,this.originalInsertionMode=P.IN_BODY,this.tokenizer.state=Tt.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===W.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==ne.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=Tt.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=Tt.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=Tt.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=Tt.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",s=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,ne.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,ne.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(W.HTML,ne.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,l=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:u,endCol:c,endOffset:d}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(t),i=r.type===We.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===W.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===ne.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,ne.HTML)}_processToken(t){switch(t.type){case We.CHARACTER:{this.onCharacter(t);break}case We.NULL_CHARACTER:{this.onNullCharacter(t);break}case We.COMMENT:{this.onComment(t);break}case We.DOCTYPE:{this.onDoctype(t);break}case We.START_TAG:{this._processStartTag(t);break}case We.END_TAG:{this.onEndTag(t);break}case We.EOF:{this.onEof(t);break}case We.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return R8(t,s,i,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===Rn.Marker||this.openElements.contains(s.element)),n=r<0?t-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=P.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=P.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=P.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=P.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=P.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=P.IN_TABLE;return}case m.BODY:{this.insertionMode=P.IN_BODY;return}case m.FRAMESET:{this.insertionMode=P.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?P.AFTER_HEAD:P.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=P.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=P.IN_HEAD;return}break}}this.insertionMode=P.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=P.IN_SELECT_IN_TABLE;return}}this.insertionMode=P.IN_SELECT}_isElementCausesFosterParenting(t){return eN.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===ne.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return r8[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){h7(this,t);return}switch(this.insertionMode){case P.INITIAL:{ro(this,t);break}case P.BEFORE_HTML:{Lo(this,t);break}case P.BEFORE_HEAD:{Oo(this,t);break}case P.IN_HEAD:{Po(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Do(this,t);break}case P.AFTER_HEAD:{Mo(this,t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:{rN(this,t);break}case P.TEXT:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{$f(this,t);break}case P.IN_TABLE_TEXT:{oN(this,t);break}case P.IN_COLUMN_GROUP:{Ad(this,t);break}case P.AFTER_BODY:{Id(this,t);break}case P.AFTER_AFTER_BODY:{Vc(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){d7(this,t);return}switch(this.insertionMode){case P.INITIAL:{ro(this,t);break}case P.BEFORE_HTML:{Lo(this,t);break}case P.BEFORE_HEAD:{Oo(this,t);break}case P.IN_HEAD:{Po(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Do(this,t);break}case P.AFTER_HEAD:{Mo(this,t);break}case P.TEXT:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{$f(this,t);break}case P.IN_COLUMN_GROUP:{Ad(this,t);break}case P.AFTER_BODY:{Id(this,t);break}case P.AFTER_AFTER_BODY:{Vc(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){Sp(this,t);return}switch(this.insertionMode){case P.INITIAL:case P.BEFORE_HTML:case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_TEMPLATE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{Sp(this,t);break}case P.IN_TABLE_TEXT:{no(this,t);break}case P.AFTER_BODY:{z8(this,t);break}case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{q8(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case P.INITIAL:{V8(this,t);break}case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:{this._err(t,X.misplacedDoctype);break}case P.IN_TABLE_TEXT:{no(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,X.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?f7(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{ro(this,t);break}case P.BEFORE_HTML:{W8(this,t);break}case P.BEFORE_HEAD:{Y8(this,t);break}case P.IN_HEAD:{En(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Z8(this,t);break}case P.AFTER_HEAD:{J8(this,t);break}case P.IN_BODY:{rr(this,t);break}case P.IN_TABLE:{bl(this,t);break}case P.IN_TABLE_TEXT:{no(this,t);break}case P.IN_CAPTION:{Q9(this,t);break}case P.IN_COLUMN_GROUP:{yg(this,t);break}case P.IN_TABLE_BODY:{Ch(this,t);break}case P.IN_ROW:{jh(this,t);break}case P.IN_CELL:{X9(this,t);break}case P.IN_SELECT:{dN(this,t);break}case P.IN_SELECT_IN_TABLE:{e7(this,t);break}case P.IN_TEMPLATE:{r7(this,t);break}case P.AFTER_BODY:{s7(this,t);break}case P.IN_FRAMESET:{a7(this,t);break}case P.AFTER_FRAMESET:{l7(this,t);break}case P.AFTER_AFTER_BODY:{u7(this,t);break}case P.AFTER_AFTER_FRAMESET:{c7(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?m7(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{ro(this,t);break}case P.BEFORE_HTML:{G8(this,t);break}case P.BEFORE_HEAD:{Q8(this,t);break}case P.IN_HEAD:{K8(this,t);break}case P.IN_HEAD_NO_SCRIPT:{X8(this,t);break}case P.AFTER_HEAD:{e9(this,t);break}case P.IN_BODY:{Th(this,t);break}case P.TEXT:{U9(this,t);break}case P.IN_TABLE:{du(this,t);break}case P.IN_TABLE_TEXT:{no(this,t);break}case P.IN_CAPTION:{K9(this,t);break}case P.IN_COLUMN_GROUP:{Z9(this,t);break}case P.IN_TABLE_BODY:{Tp(this,t);break}case P.IN_ROW:{cN(this,t);break}case P.IN_CELL:{J9(this,t);break}case P.IN_SELECT:{hN(this,t);break}case P.IN_SELECT_IN_TABLE:{t7(this,t);break}case P.IN_TEMPLATE:{n7(this,t);break}case P.AFTER_BODY:{mN(this,t);break}case P.IN_FRAMESET:{i7(this,t);break}case P.AFTER_FRAMESET:{o7(this,t);break}case P.AFTER_AFTER_BODY:{Vc(this,t);break}}}onEof(t){switch(this.insertionMode){case P.INITIAL:{ro(this,t);break}case P.BEFORE_HTML:{Lo(this,t);break}case P.BEFORE_HEAD:{Oo(this,t);break}case P.IN_HEAD:{Po(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Do(this,t);break}case P.AFTER_HEAD:{Mo(this,t);break}case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{iN(this,t);break}case P.TEXT:{B9(this,t);break}case P.IN_TABLE_TEXT:{no(this,t);break}case P.IN_TEMPLATE:{fN(this,t);break}case P.AFTER_BODY:case P.IN_FRAMESET:case P.AFTER_FRAMESET:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{xg(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===C.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.TEXT:case P.IN_COLUMN_GROUP:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{this._insertCharacters(t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:case P.AFTER_BODY:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{tN(this,t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{$f(this,t);break}case P.IN_TABLE_TEXT:{lN(this,t);break}}}}function M8(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):aN(e,t),r}function F8(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const s=e.openElements.items[n];if(s===t.element)break;e._isSpecialElement(s,e.openElements.tagIDs[n])&&(r=s)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function U8(e,t,r){let n=t,s=e.openElements.getCommonAncestor(t);for(let i=0,l=s;l!==r;i++,l=s){s=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),u=o&&i>=P8;!o||u?(u&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=B8(e,o),n===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function B8(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function H8(e,t,r){const n=e.treeAdapter.getTagName(t),s=Ml(n);if(e._isElementCausesFosterParenting(s))e._fosterParentElement(r);else{const i=e.treeAdapter.getNamespaceURI(t);s===m.TEMPLATE&&i===ne.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function $8(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=e.treeAdapter.createElement(s.tagName,n,s.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,s),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,i,s.tagID)}function gg(e,t){for(let r=0;r<O8;r++){const n=M8(e,t);if(!n)break;const s=F8(e,n);if(!s)break;e.activeFormattingElements.bookmark=n;const i=U8(e,s,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),l&&H8(e,l,i),$8(e,s,n)}}function Sp(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function z8(e,t){e._appendCommentNode(t,e.openElements.items[0])}function q8(e,t){e._appendCommentNode(t,e.document)}function xg(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],s=e.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function V8(e,t){e._setDocumentType(t);const r=t.forceQuirks?Yr.QUIRKS:w8(t);v8(t)||e._err(t,X.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=P.BEFORE_HTML}function ro(e,t){e._err(t,X.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,Yr.QUIRKS),e.insertionMode=P.BEFORE_HTML,e._processToken(t)}function W8(e,t){t.tagID===m.HTML?(e._insertElement(t,ne.HTML),e.insertionMode=P.BEFORE_HEAD):Lo(e,t)}function G8(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&Lo(e,t)}function Lo(e,t){e._insertFakeRootElement(),e.insertionMode=P.BEFORE_HEAD,e._processToken(t)}function Y8(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.HEAD:{e._insertElement(t,ne.HTML),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD;break}default:Oo(e,t)}}function Q8(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?Oo(e,t):e._err(t,X.endTagWithoutMatchingOpenElement)}function Oo(e,t){e._insertFakeElement(W.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD,e._processToken(t)}function En(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,Tt.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Tt.RAWTEXT):(e._insertElement(t,ne.HTML),e.insertionMode=P.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,Tt.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,Tt.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=P.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(P.IN_TEMPLATE);break}case m.HEAD:{e._err(t,X.misplacedStartTagForHeadElement);break}default:Po(e,t)}}function K8(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=P.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{Po(e,t);break}case m.TEMPLATE:{ui(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function ui(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,X.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,X.endTagWithoutMatchingOpenElement)}function Po(e,t){e.openElements.pop(),e.insertionMode=P.AFTER_HEAD,e._processToken(t)}function Z8(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{En(e,t);break}case m.NOSCRIPT:{e._err(t,X.nestedNoscriptInHead);break}default:Do(e,t)}}function X8(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=P.IN_HEAD;break}case m.BR:{Do(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function Do(e,t){const r=t.type===We.EOF?X.openElementsLeftAfterEof:X.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=P.IN_HEAD,e._processToken(t)}function J8(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.BODY:{e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=P.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,ne.HTML),e.insertionMode=P.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,X.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),En(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,X.misplacedStartTagForHeadElement);break}default:Mo(e,t)}}function e9(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{Mo(e,t);break}case m.TEMPLATE:{ui(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function Mo(e,t){e._insertFakeElement(W.BODY,m.BODY),e.insertionMode=P.IN_BODY,Sh(e,t)}function Sh(e,t){switch(t.type){case We.CHARACTER:{rN(e,t);break}case We.WHITESPACE_CHARACTER:{tN(e,t);break}case We.COMMENT:{Sp(e,t);break}case We.START_TAG:{rr(e,t);break}case We.END_TAG:{Th(e,t);break}case We.EOF:{iN(e,t);break}}}function tN(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function rN(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function t9(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function r9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function n9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_FRAMESET)}function s9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML)}function a9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),kp.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,ne.HTML)}function i9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function l9(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),r||(e.formElement=e.openElements.current))}function o9(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const s=e.openElements.tagIDs[n];if(r===m.LI&&s===m.LI||(r===m.DD||r===m.DT)&&(s===m.DD||s===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s);break}if(s!==m.ADDRESS&&s!==m.DIV&&s!==m.P&&e._isSpecialElement(e.openElements.items[n],s))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML)}function u9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.tokenizer.state=Tt.PLAINTEXT}function c9(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.framesetOk=!1}function d9(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(W.A);r&&(gg(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function h9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function f9(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(gg(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function m9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function p9(e,t){e.treeAdapter.getDocumentMode(e.document)!==Yr.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=P.IN_TABLE}function nN(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ne.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function sN(e){const t=z_(e,qa.TYPE);return t!=null&&t.toLowerCase()===L8}function g9(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ne.HTML),sN(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function x9(e,t){e._appendElement(t,ne.HTML),t.ackSelfClosing=!0}function y9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,ne.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function b9(e,t){t.tagName=W.IMG,t.tagID=m.IMG,nN(e,t)}function v9(e,t){e._insertElement(t,ne.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Tt.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=P.TEXT}function w9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Tt.RAWTEXT)}function E9(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Tt.RAWTEXT)}function Zb(e,t){e._switchToTextParsing(t,Tt.RAWTEXT)}function _9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===P.IN_TABLE||e.insertionMode===P.IN_CAPTION||e.insertionMode===P.IN_TABLE_BODY||e.insertionMode===P.IN_ROW||e.insertionMode===P.IN_CELL?P.IN_SELECT_IN_TABLE:P.IN_SELECT}function N9(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML)}function k9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,ne.HTML)}function S9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,ne.HTML)}function T9(e,t){e._reconstructActiveFormattingElements(),X_(t),pg(t),t.selfClosing?e._appendElement(t,ne.MATHML):e._insertElement(t,ne.MATHML),t.ackSelfClosing=!0}function C9(e,t){e._reconstructActiveFormattingElements(),J_(t),pg(t),t.selfClosing?e._appendElement(t,ne.SVG):e._insertElement(t,ne.SVG),t.ackSelfClosing=!0}function Xb(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML)}function rr(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{h9(e,t);break}case m.A:{d9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{a9(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{s9(e,t);break}case m.LI:case m.DD:case m.DT:{o9(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{nN(e,t);break}case m.HR:{y9(e,t);break}case m.RB:case m.RTC:{k9(e,t);break}case m.RT:case m.RP:{S9(e,t);break}case m.PRE:case m.LISTING:{i9(e,t);break}case m.XMP:{w9(e,t);break}case m.SVG:{C9(e,t);break}case m.HTML:{t9(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{En(e,t);break}case m.BODY:{r9(e,t);break}case m.FORM:{l9(e,t);break}case m.NOBR:{f9(e,t);break}case m.MATH:{T9(e,t);break}case m.TABLE:{p9(e,t);break}case m.INPUT:{g9(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{x9(e,t);break}case m.IMAGE:{b9(e,t);break}case m.BUTTON:{c9(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{m9(e,t);break}case m.IFRAME:{E9(e,t);break}case m.SELECT:{_9(e,t);break}case m.OPTION:case m.OPTGROUP:{N9(e,t);break}case m.NOEMBED:case m.NOFRAMES:{Zb(e,t);break}case m.FRAMESET:{n9(e,t);break}case m.TEXTAREA:{v9(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?Zb(e,t):Xb(e,t);break}case m.PLAINTEXT:{u9(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:Xb(e,t)}}function j9(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function A9(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,mN(e,t))}function I9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function R9(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function L9(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(W.P,m.P),e._closePElement()}function O9(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function P9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function D9(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function M9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function F9(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(W.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function aN(e,t){const r=t.tagName,n=t.tagID;for(let s=e.openElements.stackTop;s>0;s--){const i=e.openElements.items[s],l=e.openElements.tagIDs[s];if(n===l&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(i)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=s&&e.openElements.shortenToLength(s);break}if(e._isSpecialElement(i,l))break}}function Th(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{gg(e,t);break}case m.P:{L9(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{I9(e,t);break}case m.LI:{O9(e);break}case m.DD:case m.DT:{P9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{D9(e);break}case m.BR:{F9(e);break}case m.BODY:{j9(e,t);break}case m.HTML:{A9(e,t);break}case m.FORM:{R9(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{M9(e,t);break}case m.TEMPLATE:{ui(e,t);break}default:aN(e,t)}}function iN(e,t){e.tmplInsertionModeStack.length>0?fN(e,t):xg(e,t)}function U9(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function B9(e,t){e._err(t,X.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function $f(e,t){if(eN.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=P.IN_TABLE_TEXT,t.type){case We.CHARACTER:{oN(e,t);break}case We.WHITESPACE_CHARACTER:{lN(e,t);break}}else $u(e,t)}function H9(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_CAPTION}function $9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_COLUMN_GROUP}function z9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(W.COLGROUP,m.COLGROUP),e.insertionMode=P.IN_COLUMN_GROUP,yg(e,t)}function q9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_TABLE_BODY}function V9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(W.TBODY,m.TBODY),e.insertionMode=P.IN_TABLE_BODY,Ch(e,t)}function W9(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function G9(e,t){sN(t)?e._appendElement(t,ne.HTML):$u(e,t),t.ackSelfClosing=!0}function Y9(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,ne.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function bl(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{V9(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{En(e,t);break}case m.COL:{z9(e,t);break}case m.FORM:{Y9(e,t);break}case m.TABLE:{W9(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{q9(e,t);break}case m.INPUT:{G9(e,t);break}case m.CAPTION:{H9(e,t);break}case m.COLGROUP:{$9(e,t);break}default:$u(e,t)}}function du(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{ui(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:$u(e,t)}}function $u(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Sh(e,t),e.fosterParentingEnabled=r}function lN(e,t){e.pendingCharacterTokens.push(t)}function oN(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function no(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)$u(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const uN=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function Q9(e,t){const r=t.tagID;uN.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,bl(e,t)):rr(e,t)}function K9(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,r===m.TABLE&&du(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Th(e,t)}}function yg(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.COL:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{En(e,t);break}default:Ad(e,t)}}function Z9(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TEMPLATE:{ui(e,t);break}case m.COL:break;default:Ad(e,t)}}function Ad(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE,e._processToken(t))}function Ch(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(W.TR,m.TR),e.insertionMode=P.IN_ROW,jh(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,bl(e,t));break}default:bl(e,t)}}function Tp(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,du(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:du(e,t)}}function jh(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,ne.HTML),e.insertionMode=P.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,Ch(e,t));break}default:bl(e,t)}}function cN(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,Tp(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,Tp(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:du(e,t)}}function X9(e,t){const r=t.tagID;uN.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),jh(e,t)):rr(e,t)}function J9(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),cN(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:Th(e,t)}}function dN(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,ne.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,ne.HTML);break}case m.HR:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{En(e,t);break}}}function hN(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{ui(e,t);break}}}function e7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):dN(e,t)}function t7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):hN(e,t)}function r7(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{En(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=P.IN_TABLE,e.insertionMode=P.IN_TABLE,bl(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=P.IN_COLUMN_GROUP,e.insertionMode=P.IN_COLUMN_GROUP,yg(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=P.IN_TABLE_BODY,e.insertionMode=P.IN_TABLE_BODY,Ch(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=P.IN_ROW,e.insertionMode=P.IN_ROW,jh(e,t);break}default:e.tmplInsertionModeStack[0]=P.IN_BODY,e.insertionMode=P.IN_BODY,rr(e,t)}}function n7(e,t){t.tagID===m.TEMPLATE&&ui(e,t)}function fN(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):xg(e,t)}function s7(e,t){t.tagID===m.HTML?rr(e,t):Id(e,t)}function mN(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=P.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else Id(e,t)}function Id(e,t){e.insertionMode=P.IN_BODY,Sh(e,t)}function a7(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.FRAMESET:{e._insertElement(t,ne.HTML);break}case m.FRAME:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{En(e,t);break}}}function i7(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=P.AFTER_FRAMESET))}function l7(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.NOFRAMES:{En(e,t);break}}}function o7(e,t){t.tagID===m.HTML&&(e.insertionMode=P.AFTER_AFTER_FRAMESET)}function u7(e,t){t.tagID===m.HTML?rr(e,t):Vc(e,t)}function Vc(e,t){e.insertionMode=P.IN_BODY,Sh(e,t)}function c7(e,t){switch(t.tagID){case m.HTML:{rr(e,t);break}case m.NOFRAMES:{En(e,t);break}}}function d7(e,t){t.chars=gt,e._insertCharacters(t)}function h7(e,t){e._insertCharacters(t),e.framesetOk=!1}function pN(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==ne.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function f7(e,t){if(C8(t))pN(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===ne.MATHML?X_(t):n===ne.SVG&&(j8(t),J_(t)),pg(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function m7(e,t){if(t.tagID===m.P||t.tagID===m.BR){pN(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===ne.HTML){e._endTagOutsideForeignContent(t);break}const s=e.treeAdapter.getTagName(n);if(s.toLowerCase()===t.tagName){t.tagName=s,e.openElements.shortenToLength(r);break}}}W.AREA,W.BASE,W.BASEFONT,W.BGSOUND,W.BR,W.COL,W.EMBED,W.FRAME,W.HR,W.IMG,W.INPUT,W.KEYGEN,W.LINK,W.META,W.PARAM,W.SOURCE,W.TRACK,W.WBR;const p7=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,g7=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),Jb={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function gN(e,t){const r=S7(e),n=p_("type",{handlers:{root:x7,element:y7,text:b7,comment:yN,doctype:v7,raw:E7},unknown:_7}),s={parser:r?new Kb(Jb):Kb.getFragmentParser(void 0,Jb),handle(o){n(o,s)},stitches:!1,options:t||{}};n(e,s),Fl(s,Hn());const i=r?s.parser.document:s.parser.getFragment(),l=TM(i,{file:s.options.file});return s.stitches&&kh(l,"comment",function(o,u,c){const d=o;if(d.value.stitch&&c&&u!==void 0){const h=c.children;return h[u]=d.value.stitch,u}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function xN(e,t){let r=-1;if(e)for(;++r<e.length;)t.handle(e[r])}function x7(e,t){xN(e.children,t)}function y7(e,t){N7(e,t),xN(e.children,t),k7(e,t)}function b7(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const r={type:We.CHARACTER,chars:e.value,location:zu(e)};Fl(t,Hn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function v7(e,t){const r={type:We.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:zu(e)};Fl(t,Hn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function w7(e,t){t.stitches=!0;const r=T7(e);if("children"in e&&"children"in r){const n=gN({type:"root",children:e.children},t.options);r.children=n.children}yN({type:"comment",value:{stitch:r}},t)}function yN(e,t){const r=e.value,n={type:We.COMMENT,data:r,location:zu(e)};Fl(t,Hn(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function E7(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,bN(t,Hn(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(p7,"&lt;$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=t.parser.tokenizer._consume();t.parser.tokenizer._callState(r)}}function _7(e,t){const r=e;if(t.options.passThrough&&t.options.passThrough.includes(r.type))w7(r,t);else{let n="";throw g7.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function Fl(e,t){bN(e,t);const r=e.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=e.parser.tokenizer.preprocessor.line,r.location.endCol=e.parser.tokenizer.preprocessor.col+1,r.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Tt.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function bN(e,t){if(t&&t.offset!==void 0){const r={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=r}}function N7(e,t){const r=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Tt.PLAINTEXT)return;Fl(t,Hn(e));const n=t.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:La.html;s===La.html&&r==="svg"&&(s=La.svg);const i=RM({...e,children:[]},{space:s===La.svg?"svg":"html"}),l={type:We.START_TAG,tagName:r,tagID:Ml(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:zu(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=r}function k7(e,t){const r=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&BM.includes(r)||t.parser.tokenizer.state===Tt.PLAINTEXT)return;Fl(t,bh(e));const n={type:We.END_TAG,tagName:r,tagID:Ml(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:zu(e)};t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken),r===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Tt.RCDATA||t.parser.tokenizer.state===Tt.RAWTEXT||t.parser.tokenizer.state===Tt.SCRIPT_DATA)&&(t.parser.tokenizer.state=Tt.DATA)}function S7(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function zu(e){const t=Hn(e)||{line:void 0,column:void 0,offset:void 0},r=bh(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function T7(e){return"children"in e?ti({...e,children:[]}):ti(e)}function vN(e){return function(t,r){return gN(t,{...e,file:r})}}const _a=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],e1={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[..._a,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[..._a],h2:[["className","sr-only"]],img:[..._a,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[..._a,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[..._a],table:[..._a],ul:[..._a,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},As={}.hasOwnProperty;function C7(e,t){let r={type:"root",children:[]};const n={schema:t?{...e1,...t}:e1,stack:[]},s=wN(n,e);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function wN(e,t){if(t&&typeof t=="object"){const r=t;switch(typeof r.type=="string"?r.type:""){case"comment":return j7(e,r);case"doctype":return A7(e,r);case"element":return I7(e,r);case"root":return R7(e,r);case"text":return L7(e,r)}}}function j7(e,t){if(e.schema.allowComments){const r=typeof t.value=="string"?t.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return qu(i,t),i}}function A7(e,t){if(e.schema.allowDoctypes){const r={type:"doctype"};return qu(r,t),r}}function I7(e,t){const r=typeof t.tagName=="string"?t.tagName:"";e.stack.push(r);const n=EN(e,t.children),s=O7(e,t.properties);e.stack.pop();let i=!1;if(r&&r!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(r))&&(i=!0,e.schema.ancestors&&As.call(e.schema.ancestors,r))){const o=e.schema.ancestors[r];let u=-1;for(i=!1;++u<o.length;)e.stack.includes(o[u])&&(i=!0)}if(!i)return e.schema.strip&&!e.schema.strip.includes(r)?n:void 0;const l={type:"element",tagName:r,properties:s,children:n};return qu(l,t),l}function R7(e,t){const n={type:"root",children:EN(e,t.children)};return qu(n,t),n}function L7(e,t){const n={type:"text",value:typeof t.value=="string"?t.value:""};return qu(n,t),n}function EN(e,t){const r=[];if(Array.isArray(t)){const n=t;let s=-1;for(;++s<n.length;){const i=wN(e,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function O7(e,t){const r=e.stack[e.stack.length-1],n=e.schema.attributes,s=e.schema.required,i=n&&As.call(n,r)?n[r]:void 0,l=n&&As.call(n,"*")?n["*"]:void 0,o=t&&typeof t=="object"?t:{},u={};let c;for(c in o)if(As.call(o,c)){const d=o[c];let h=t1(e,r1(i,c),c,d);h==null&&(h=t1(e,r1(l,c),c,d)),h!=null&&(u[c]=h)}if(s&&As.call(s,r)){const d=s[r];for(c in d)As.call(d,c)&&!As.call(u,c)&&(u[c]=d[c])}return u}function t1(e,t,r,n){return t?Array.isArray(n)?P7(e,t,r,n):_N(e,t,r,n):void 0}function P7(e,t,r,n){let s=-1;const i=[];for(;++s<n.length;){const l=_N(e,t,r,n[s]);(typeof l=="number"||typeof l=="string")&&i.push(l)}return i}function _N(e,t,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&D7(e,r,n)){if(typeof t=="object"&&t.length>1){let s=!1,i=0;for(;++i<t.length;){const l=t[i];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(n))){s=!0;break}}else if(l===n){s=!0;break}}if(!s)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(r)?e.schema.clobberPrefix+n:n}}function D7(e,t,r){const n=e.schema.protocols&&As.call(e.schema.protocols,t)?e.schema.protocols[t]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),l=s.indexOf("?"),o=s.indexOf("#"),u=s.indexOf("/");if(i<0||u>-1&&i>u||l>-1&&i>l||o>-1&&i>o)return!0;let c=-1;for(;++c<n.length;){const d=n[c];if(i===d.length&&s.slice(0,d.length)===d)return!0}return!1}function qu(e,t){const r=ME(t);t.data&&(e.data=ti(t.data)),r&&(e.position=r)}function r1(e,t){let r,n=-1;if(e)for(;++n<e.length;){const s=e[n],i=typeof s=="string"?s:s[0];if(i===t)return s;i==="data*"&&(r=s)}if(t.length>4&&t.slice(0,4).toLowerCase()==="data")return r}function NN(e){return function(t){return C7(t,e)}}function Wc({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(d_,{remarkPlugins:[P_],rehypePlugins:[vN,NN],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function M7({onClose:e,onSelectImage:t}){const[r,n]=w.useState("upload"),[s,i]=w.useState(null),[l,o]=w.useState([]),[u,c]=w.useState(!1),[d,h]=w.useState(null),[f,g]=w.useState(""),[p,b]=w.useState(""),E=async()=>{if(!s)return;c(!0);const y=`${Date.now()}-${s.name}`,{error:v}=await te.storage.from("images").upload(y,s);if(v){alert("Upload error: "+v.message),c(!1);return}const{publicURL:k,error:_}=te.storage.from("images").getPublicUrl(y);if(_){alert("Error getting public URL: "+_.message),c(!1);return}t(k,f,p),c(!1),e()},x=async()=>{c(!0);const{data:y,error:v}=await te.storage.from("images").list("",{limit:100});if(v){alert("Error listing images: "+v.message),c(!1);return}const k=y.map(_=>{const{publicURL:S}=te.storage.from("images").getPublicUrl(_.name);return S});o(k),c(!1)};return Kr.useEffect(()=>{r==="select"&&x()},[r]),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Select an Image"}),a.jsx("button",{onClick:e,children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex gap-4 mb-4",children:[a.jsx(q,{variant:"secondary",size:"sm",onClick:()=>n("upload"),children:"Upload"}),a.jsx(q,{variant:"secondary",size:"sm",onClick:()=>n("select"),children:"Select"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Width (e.g., 300px or 100%)"}),a.jsx("input",{type:"text",value:f,onChange:y=>g(y.target.value),className:"w-full px-3 py-2 border rounded"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Height (e.g., 200px)"}),a.jsx("input",{type:"text",value:p,onChange:y=>b(y.target.value),className:"w-full px-3 py-2 border rounded"})]}),r==="upload"?a.jsxs("div",{children:[a.jsx("input",{type:"file",accept:"image/*",onChange:y=>{y.target.files&&y.target.files[0]&&i(y.target.files[0])}}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(q,{variant:"primary",onClick:E,loading:u,children:"Upload Image"})})]}):a.jsxs("div",{children:[u?a.jsx("p",{children:"Loading images..."}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((y,v)=>a.jsx("img",{src:y,alt:"Stored",className:`cursor-pointer border ${d===y?"border-blue-500":"border-gray-200"}`,onClick:()=>h(y)},v))}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx(q,{variant:"secondary",onClick:()=>n("upload"),children:"Back to Upload"}),a.jsx(q,{variant:"primary",onClick:()=>{d&&(t(d,f,p),e())},disabled:!d,children:"Select Image"})]})]})]})})}function F7({entry:e,onClose:t,onSave:r,onSaveAsTemplate:n}){const[s,i]=w.useState(e),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState(!1),f=async()=>{c(!0);try{await r(s)}finally{c(!1)}},g=async()=>{if(n){c(!0);try{await n(s)}finally{c(!1)}}},p=(b,E,x)=>{let y=`![Image description](${b})`;if(E||x){const v=[];E&&v.push(`width="${E}"`),x&&v.push(`height="${x}"`),y+=`{${v.join(" ")}}`}i({...s,content:s.content+`
`+y+`
`})};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"border-b p-4 flex items-center justify-between bg-white",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(q,{variant:"secondary",icon:H0,onClick:t,children:"Back"}),a.jsx("h2",{className:"text-xl font-bold",children:s.title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{variant:"secondary",icon:l?P2:M2,onClick:()=>o(!l),children:l?"Edit":"Preview"}),n&&a.jsx(q,{variant:"secondary",onClick:g,loading:u,children:"Save as Template"}),a.jsx(q,{variant:"primary",icon:Fr,onClick:f,loading:u,children:"Save"})]})]}),!l&&a.jsxs("div",{className:"border-b p-2 flex items-center gap-2 bg-white",children:[a.jsx(q,{variant:"secondary",size:"sm",icon:wA,onClick:()=>{const b=document.querySelector("textarea");if(b){const E=b.selectionStart,x=b.selectionEnd,y=b.value,v=y.substring(0,E),k=y.substring(E,x),_=y.substring(x);i({...s,content:`${v}**${k}**${_}`})}},children:"Bold"}),a.jsx(q,{variant:"secondary",size:"sm",icon:OA,onClick:()=>{const b=document.querySelector("textarea");if(b){const E=b.selectionStart,x=b.selectionEnd,y=b.value,v=y.substring(0,E),k=y.substring(E,x),_=y.substring(x);i({...s,content:`${v}_${k}_${_}`})}},children:"Italic"}),a.jsx("div",{className:"w-px h-6 bg-gray-300"}),a.jsx(q,{variant:"secondary",size:"sm",icon:ZA,onClick:()=>{i({...s,content:s.content+`
| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
`})},children:"Table"}),a.jsx(q,{variant:"secondary",size:"sm",icon:LA,onClick:()=>h(!0),children:"Image"}),a.jsx(q,{variant:"secondary",size:"sm",icon:DA,onClick:()=>{i({...s,content:s.content+"[Link text](https://example.com)"})},children:"Link"}),a.jsx(q,{variant:"secondary",size:"sm",icon:pl,onClick:()=>{i({...s,content:s.content+`
> ### Note
> This is a note block for important information.
`})},children:"Note"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs("div",{className:"h-full flex",children:[!l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:s.title,onChange:b=>i({...s,title:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:s.category,onChange:b=>i({...s,category:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx("textarea",{value:s.content,onChange:b=>i({...s,content:b.target.value}),rows:20,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono bg-white"})]})]})}),l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50 homebrew",children:a.jsxs("div",{className:"max-w-4xl mx-auto prose",children:[a.jsx("h1",{children:s.title}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.category})}),a.jsx(Wc,{content:s.content})]})})]})}),d&&a.jsx(M7,{onClose:()=>h(!1),onSelectImage:(b,E,x)=>{p(b,E,x)}})]})}async function U7(){const{data:e,error:t}=await te.from("compendium").select("*").order("category").order("title");if(t)throw console.error("Error fetching compendium entries:",t),new Error(t.message||"Failed to load compendium entries");return e||[]}async function B7(){const{data:e,error:t}=await te.from("compendium_templates").select("*").order("category").order("name");if(t)throw console.error("Error fetching compendium templates:",t),new Error(t.message||"Failed to load compendium templates");return e||[]}function H7(){const{user:e,isAdmin:t}=Mt(),r=tn(),[n,s]=w.useState(""),[i,l]=w.useState(null),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState([]),[g,p]=w.useState(new Set),{data:b=[],isLoading:E,error:x}=Rt({queryKey:["compendiumEntries"],queryFn:U7}),{data:y=[],isLoading:v,error:k}=Rt({queryKey:["compendiumTemplates"],queryFn:B7}),_=E||v,S=(x==null?void 0:x.message)||(k==null?void 0:k.message)||null;w.useEffect(()=>{I()},[]);const I=()=>{const H=localStorage.getItem("compendium_bookmarks");H&&f(JSON.parse(H))},j=H=>{const A=H.content.slice(0,100)+"...";f(M=>{const N=M.some(K=>K.id===H.id)?M.filter(K=>K.id!==H.id):[...M,{...H,preview:A}];return localStorage.setItem("compendium_bookmarks",JSON.stringify(N)),N})},D=H=>{p(A=>{const M=new Set(A);return M.has(H)?M.delete(H):M.add(H),M})},T=w.useMemo(()=>{if(n)return[];const H=b.reduce((A,M)=>{const Q=M.category??"Uncategorized";return A[Q]||(A[Q]=[]),A[Q].push(M),A},{});return Object.entries(H).sort(([A],[M])=>A.localeCompare(M))},[b,n]),B=w.useMemo(()=>n?b.filter(H=>H.title.toLowerCase().includes(n.toLowerCase())||H.content.toLowerCase().includes(n.toLowerCase())):[],[b,n]),O=kt({mutationFn:async H=>{if(H.id){const{error:A}=await te.from("compendium").update({title:H.title,content:H.content,category:H.category,updated_at:new Date().toISOString()}).eq("id",H.id);if(A)throw A}else{const{error:A}=await te.from("compendium").insert([{title:H.title,content:H.content,category:H.category,created_by:e==null?void 0:e.id}]);if(A)throw A}},onSuccess:()=>{r.invalidateQueries({queryKey:["compendiumEntries"]}),d(null)},onError:H=>{console.error("Save error:",H)}}),Y=H=>{O.mutate(H)},G=()=>{d({title:"",content:"",category:i||"",created_by:e==null?void 0:e.id})},z=()=>{u(null),s("")};return _?a.jsx(Ge,{size:"lg",className:"mx-auto mt-12"}):S?a.jsx(Ie,{message:S,className:"m-8"}):a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsx("div",{className:"w-80 bg-white border-r flex flex-col",children:a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Compendium"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(q,{variant:"secondary",size:"sm",onClick:z,children:"Home"}),t()&&a.jsx(q,{variant:"primary",size:"sm",icon:Wt,onClick:G,children:"New Entry"})]})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search compendium...",value:n,onChange:H=>s(H.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n===""&&a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(([H,A])=>a.jsxs("div",{className:"border-b",children:[a.jsxs("div",{onClick:()=>D(H),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[g.has(H)?a.jsx(z0,{className:"w-4 h-4 text-gray-500"}):a.jsx(Ca,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:H})]}),a.jsx("span",{className:"text-sm text-gray-500",children:A.length})]}),g.has(H)&&a.jsx("div",{className:"bg-gray-50",children:A.map(M=>a.jsx("div",{onClick:()=>u(M),className:`px-8 py-2 cursor-pointer hover:bg-gray-100 ${(o==null?void 0:o.id)===M.id?"bg-blue-50":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:M.title}),h.some(Q=>Q.id===M.id)&&a.jsx(my,{className:"w-4 h-4 text-blue-500"})]})},M.id))})]},H))})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-95 z-10 p-6 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Search Results"}),a.jsx(q,{variant:"secondary",size:"sm",onClick:()=>s(""),children:"Clear Search"})]}),B.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:B.map(H=>a.jsxs("div",{onClick:()=>{u(H),s("")},className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:H.title}),a.jsx("div",{className:"homebrew",children:a.jsx(Wc,{content:H.content.slice(0,200)+"..."})})]},H.id))}):a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-gray-500",children:['No results found for "',n,'".']})})]}),o&&!n?a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{variant:"secondary",size:"sm",icon:h.some(H=>H.id===o.id)?my:EA,onClick:()=>j(o),children:h.some(H=>H.id===o.id)?"Bookmarked":"Bookmark"}),t()&&a.jsx(q,{variant:"secondary",size:"sm",icon:Mu,onClick:()=>d(o),children:"Edit"})]})]}),a.jsx("div",{className:"homebrew",children:a.jsx(Wc,{content:o.content})})]}):!o&&!n&&a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bookmarked Entries"}),h.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(H=>a.jsxs("div",{onClick:()=>u(H),className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:H.title}),a.jsx("div",{className:"homebrew",children:a.jsx(Wc,{content:H.preview})})]},H.id))}):a.jsxs("div",{className:"text-center",children:[a.jsx(Du,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Welcome to the Compendium"}),a.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Use the sidebar to search and browse entries, or add new ones if you're an admin."})]})]})]}),c&&a.jsx(F7,{entry:c,onClose:()=>d(null),onSave:Y})]})}async function $7(e,t){if(!e)return[];let r=te.from("parties").select(`
    id,
    name,
    description,
    created_by,
    created_at,
    members:party_members!left (
      characters!inner (
        *
      )
    )
  `);t?r=r.eq("created_by",e):r=r.eq("members.characters.user_id",e);const{data:n,error:s}=await r.order("created_at",{ascending:!1});if(s)throw console.error("Error fetching parties:",s),new Error(s.message||"Failed to fetch parties");return(n||[]).map(l=>({...l,members:(l.members||[]).map(o=>o.characters?Ll(o.characters):null).filter(o=>!!o)}))}async function kN(e){if(!e)return[];const{data:t,error:r}=await te.from("party_members").select("character_id");if(r)throw console.error("Error fetching party member IDs:",r),new Error(r.message||"Failed to fetch member data");const n=(t||[]).map(o=>o.character_id);let s=te.from("characters").select("*").eq("user_id",e);n.length>0&&(s=s.not("id","in",`(${n.join(",")})`));const{data:i,error:l}=await s;if(l)throw console.error("Error fetching available characters:",l),new Error(l.message||"Failed to fetch available characters");return(i||[]).map(Ll)}async function z7(e){if(!e)return null;const{data:t,error:r}=await te.from("parties").select(`
      id,
      name,
      description,
      created_by,
      created_at,
      members:party_members (
        characters (
          *
        )
      )
    `).eq("id",e).single();if(r)throw console.error("Error fetching party by ID:",r),r.code==="PGRST116"?new Error("Party not found"):new Error(r.message||"Failed to fetch party");return t?{...t,members:(t.members||[]).map(s=>s.characters?Ll(s.characters):null).filter(s=>!!s)}:null}async function q7(e,t){const{error:r}=await te.from("party_members").delete().match({party_id:e,character_id:t});if(r)throw console.error("Error removing party member:",r),new Error(r.message||"Failed to remove party member")}async function V7(e){const{error:t}=await te.from("parties").delete().eq("id",e);if(t)throw console.error("Error deleting party:",t),new Error(t.message||"Failed to delete party")}function W7(){const{user:e,isDM:t}=Mt(),r=rn(),n=tn(),[s,i]=w.useState(!1),[l,o]=w.useState(""),[u,c]=w.useState([]),{data:d=[],isLoading:h,error:f}=Rt({queryKey:["parties",e==null?void 0:e.id,t()],queryFn:()=>$7(e==null?void 0:e.id,t()),enabled:!!e}),{data:g=[],isLoading:p,error:b}=Rt({queryKey:["availableCharacters",e==null?void 0:e.id],queryFn:()=>kN(e==null?void 0:e.id),enabled:!!e&&s}),E=h||s&&p,x=(f==null?void 0:f.message)||(b==null?void 0:b.message)||null,y=kt({mutationFn:async({name:k,characterIds:_})=>{if(!k.trim())throw new Error("Party name is required");if(!e)throw new Error("User not authenticated");const{data:S,error:I}=await te.from("parties").insert([{name:k,created_by:e.id}]).select().single();if(I)throw I;if(!S)throw new Error("Party creation failed");if(_.length>0){const j=_.map(T=>({party_id:S.id,character_id:T})),{error:D}=await te.from("party_members").insert(j);if(D)throw await te.from("parties").delete().eq("id",S.id),D}return S},onSuccess:()=>{n.invalidateQueries({queryKey:["parties",e==null?void 0:e.id,t()]}),n.invalidateQueries({queryKey:["availableCharacters",e==null?void 0:e.id]}),o(""),c([]),i(!1)}}),v=()=>{y.mutate({name:l,characterIds:u})};return E&&!s?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(Ge,{size:"lg"})}):x&&!s?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:x})}):a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xn,{className:"w-6 h-6 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Adventure Parties"})]}),t()&&a.jsx(q,{variant:"primary",icon:Wt,onClick:()=>i(!0),disabled:s,children:"Create Party"})]}),x&&!y.error&&!s&&a.jsx("div",{className:"mb-6",children:a.jsx(Ie,{message:x})}),s&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Party"}),y.error&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:y.error.message})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partyName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name"}),a.jsx("input",{type:"text",id:"partyName",value:l,onChange:k=>o(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Initial Characters (Optional)"}),p?a.jsx(Ge,{}):b?a.jsx(Ie,{message:b.message}):g.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-60 overflow-y-auto p-2 border rounded-md",children:g.map(k=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer ${u.includes(k.id||"")?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>{k.id&&c(_=>_.includes(k.id)?_.filter(S=>S!==k.id):[..._,k.id])},children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ja,{className:"w-4 h-4 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-sm",children:k.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[k.kin," ",k.profession]})]})]})},k.id))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No available characters to add."})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(q,{variant:"secondary",onClick:()=>i(!1),disabled:y.isPending,children:"Cancel"}),a.jsx(q,{variant:"primary",onClick:v,loading:y.isPending,disabled:!l.trim()||y.isPending,children:"Create Party"})]})]})]}),!s&&(d.length>0?a.jsx("div",{className:"grid gap-6",children:d.map(k=>a.jsxs("div",{onClick:()=>r(`/party/${k.id}`),className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg hover:border-blue-400 border border-transparent transition-all cursor-pointer",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:k.name}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[k.members.map(_=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ja,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:_.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[_.kin," ",_.profession]})]})]})},_.id)),k.members.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic col-span-full",children:"No members yet."})]})]},k.id))}):a.jsx(dp,{icon:xn,title:"No Adventure Parties",description:t()?"You haven't created any parties yet.":"You're not currently in any adventure parties.",action:t()?a.jsx(q,{variant:"primary",icon:Wt,onClick:()=>i(!0),children:"Create Your First Party"}):void 0}))]})}function bg({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(d_,{remarkPlugins:[P_],rehypePlugins:[vN,NN],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function G7(){const{user:e,isDM:t}=Mt(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState([]),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState(null),[p,b]=w.useState(""),[E,x]=w.useState(""),[y,v]=w.useState(""),[k,_]=w.useState(""),[S,I]=w.useState(""),[j,D]=w.useState("all"),[T,B]=w.useState(!0),[O,Y]=w.useState(null),[G,z]=w.useState(null),H=w.useCallback(()=>{b(""),x(""),v(""),_(""),z(null)},[]),A=()=>{H(),h(!0),g(null),c(null)},M=Z=>{c(Z),g(Z.id),h(!1),b(Z.title),x(Z.content),v(Z.character_id||""),_(Z.party_id||""),z(null)},Q=()=>{h(!1),g(null),H(),f&&c(null)},N=w.useCallback(async()=>{if(e){B(!0),Y(null);try{const Z=new Map,{data:be,error:ee}=await te.from("notes").select("*, character:characters(name), party:parties(name)").eq("user_id",e.id);if(ee)throw ee;if((be||[]).forEach(_e=>Z.set(_e.id,_e)),t()){const{data:_e,error:je}=await te.from("parties").select("id").eq("created_by",e.id);if(je)throw je;const Pe=(_e||[]).map(Fe=>Fe.id);if(Pe.length>0){const{data:Fe,error:V}=await te.from("notes").select("*, character:characters(name), party:parties(name)").in("party_id",Pe);if(V)throw V;(Fe||[]).forEach(ye=>Z.set(ye.id,ye))}}const de=Array.from(Z.values()).sort((_e,je)=>new Date(je.created_at).getTime()-new Date(_e.created_at).getTime());n(de)}catch(Z){console.error("Error loading notes:",Z),Y(Z instanceof Error?Z.message:"Failed to load notes"),n([])}finally{B(!1)}}},[e,t]),K=w.useCallback(async()=>{if(e)try{const{data:Z,error:be}=await te.from("characters").select("id, name").eq("user_id",e.id);if(be)throw be;i(Z||[])}catch(Z){console.error("Error loading characters:",Z),Y(be=>be||(Z instanceof Error?Z.message:"Failed to load characters"))}},[e]),$=w.useCallback(async()=>{if(!(!e||!t()))try{const{data:Z,error:be}=await te.from("parties").select("id, name").eq("created_by",e.id);if(be)throw be;o(Z||[])}catch(Z){console.error("Error loading parties:",Z),Y(be=>be||(Z instanceof Error?Z.message:"Failed to load parties"))}},[e,t]);w.useEffect(()=>{e?(N(),K(),t()&&$()):(B(!1),n([]),i([]),o([]),c(null),Q())},[e,t,N,K,$]);async function R(){if(!e){z("User not authenticated.");return}if(!p.trim()){z("Title is required.");return}z(null);const Z=y||null,be=k||null;if(Z&&be){z("A note can be linked to either a character OR a party, not both.");return}const ee={title:p.trim(),content:E,user_id:e.id,character_id:Z,party_id:be,updated_at:new Date().toISOString()};try{let de=null;if(f){const{data:_e,error:je}=await te.from("notes").update(ee).eq("id",f).select("*, character:characters(name), party:parties(name)").single();if(je)throw je;de=_e}else{const{updated_at:_e,...je}=ee,{data:Pe,error:Fe}=await te.from("notes").insert([je]).select("*, character:characters(name), party:parties(name)").single();if(Fe)throw Fe;de=Pe}Q(),await N(),de&&c(de)}catch(de){console.error("Error saving note:",de),z(de instanceof Error?`Failed to save note: ${de.message}`:"An unknown error occurred.")}}async function me(Z){if(window.confirm("Are you sure you want to delete this note?"))try{Y(null);const{error:be}=await te.from("notes").delete().eq("id",Z);if(be)throw be;await N(),(u==null?void 0:u.id)===Z&&c(null),f===Z&&Q()}catch(be){console.error("Error deleting note:",be),Y(be instanceof Error?`Failed to delete note: ${be.message}`:"An unknown error occurred.")}}const ce=r.filter(Z=>{const be=Z.title.toLowerCase().includes(S.toLowerCase())||Z.content.toLowerCase().includes(S.toLowerCase()),ee=j==="all"||j==="personal"&&!Z.character_id&&!Z.party_id||j==="character"&&!!Z.character_id||j==="party"&&!!Z.party_id;return be&&ee});if(T&&r.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[a.jsx(Ge,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading notes..."})]});const we=d||f;return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(Du,{className:"w-6 h-6 text-blue-600"}),"Notes"]}),a.jsx(q,{variant:"primary",size:"sm",icon:Wt,onClick:A,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:S,onChange:Z=>I(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:j,onChange:Z=>D(Z.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white","aria-label":"Filter notes",children:[a.jsx("option",{value:"all",children:"All Notes"}),a.jsx("option",{value:"personal",children:"My Personal Notes"}),a.jsx("option",{value:"character",children:"Character Notes"}),a.jsx("option",{value:"party",children:"Party Notes"})]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(z0,{className:"w-4 h-4 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[O&&!we&&a.jsx("div",{className:"p-4",children:a.jsx(Ie,{message:O,onClose:()=>Y(null)})}),ce.length>0?ce.map(Z=>a.jsxs("div",{onClick:()=>{(!f||f!==Z.id)&&(c(Z),h(!1),g(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(u==null?void 0:u.id)===Z.id&&!we?"bg-blue-50 border-l-4 border-blue-500":""} ${f===Z.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:Z.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:Z.content.substring(0,50)+(Z.content.length>50?"...":"")}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Z.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:["Char: ",Z.character.name]}):Z.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-xs",children:["Party: ",Z.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-xs",children:"Personal"})})]},Z.id)):!T&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(pl,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),S||j!=="all"?"No notes match.":"No notes yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:we?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Note":"Create New Note"}),a.jsx("button",{onClick:Q,className:"text-gray-500 hover:text-gray-700","aria-label":"Close form",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),G&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:G,onClose:()=>z(null)})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"title",value:p,onChange:Z=>b(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter note title",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"character",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Character (Optional)"}),a.jsxs("select",{id:"character",value:y,onChange:Z=>{v(Z.target.value),Z.target.value&&_("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!k,children:[a.jsx("option",{value:"",children:"None"}),s.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),t()&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Party (Optional, DM Only)"}),a.jsxs("select",{id:"party",value:k,onChange:Z=>{_(Z.target.value),Z.target.value&&v("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!y,children:[a.jsx("option",{value:"",children:"None"}),l.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"content",value:E,onChange:Z=>x(Z.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter note content..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use Markdown for formatting."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx(q,{variant:"secondary",onClick:Q,children:"Cancel"}),a.jsx(q,{variant:"primary",icon:Fr,onClick:R,disabled:!p.trim(),children:f?"Update Note":"Save Note"})]})]})]}):u?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:u.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:u.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["Character: ",u.character.name]}):u.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Party: ",u.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Personal"})})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(q,{variant:"secondary",size:"sm",icon:Mu,onClick:()=>M(u),children:"Edit"}),a.jsx(q,{variant:"danger_outline",size:"sm",icon:Sr,onClick:()=>me(u.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(bg,{content:u.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(u.created_at).toLocaleDateString(),u.updated_at&&new Date(u.updated_at).getTime()!==new Date(u.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(u.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(pl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),O&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ie,{message:O,onClose:()=>Y(null)})})]})})]})}var Xe;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const i={};for(const l of s)i[l]=l;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),l={};for(const o of i)l[o]=s[o];return e.objectValues(l)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&i.push(l);return i},e.find=(s,i)=>{for(const l of s)if(i(l))return l},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Xe||(Xe={}));var Cp;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(Cp||(Cp={}));const ge=Xe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jn=e=>{switch(typeof e){case"undefined":return ge.undefined;case"string":return ge.string;case"number":return isNaN(e)?ge.nan:ge.number;case"boolean":return ge.boolean;case"function":return ge.function;case"bigint":return ge.bigint;case"symbol":return ge.symbol;case"object":return Array.isArray(e)?ge.array:e===null?ge.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ge.promise:typeof Map<"u"&&e instanceof Map?ge.map:typeof Set<"u"&&e instanceof Set?ge.set:typeof Date<"u"&&e instanceof Date?ge.date:ge.object;default:return ge.unknown}},ae=Xe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Y7=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Dr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},s=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let o=n,u=0;for(;u<l.path.length;){const c=l.path[u];u===l.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(l))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),n}static assert(t){if(!(t instanceof Dr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Xe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Dr.create=e=>new Dr(e);const vl=(e,t)=>{let r;switch(e.code){case ae.invalid_type:e.received===ge.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case ae.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Xe.jsonStringifyReplacer)}`;break;case ae.unrecognized_keys:r=`Unrecognized key(s) in object: ${Xe.joinValues(e.keys,", ")}`;break;case ae.invalid_union:r="Invalid input";break;case ae.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Xe.joinValues(e.options)}`;break;case ae.invalid_enum_value:r=`Invalid enum value. Expected ${Xe.joinValues(e.options)}, received '${e.received}'`;break;case ae.invalid_arguments:r="Invalid function arguments";break;case ae.invalid_return_type:r="Invalid function return type";break;case ae.invalid_date:r="Invalid date";break;case ae.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Xe.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case ae.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case ae.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case ae.custom:r="Invalid input";break;case ae.invalid_intersection_types:r="Intersection results could not be merged";break;case ae.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ae.not_finite:r="Number must be finite";break;default:r=t.defaultError,Xe.assertNever(e)}return{message:r}};let SN=vl;function Q7(e){SN=e}function Rd(){return SN}const Ld=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],l={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)o=c(l,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},K7=[];function fe(e,t){const r=Rd(),n=Ld({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===vl?void 0:vl].filter(s=>!!s)});e.common.issues.push(n)}class er{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return Oe;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const i=await s.key,l=await s.value;n.push({key:i,value:l})}return er.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:i,value:l}=s;if(i.status==="aborted"||l.status==="aborted")return Oe;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const Oe=Object.freeze({status:"aborted"}),Ri=e=>({status:"dirty",value:e}),cr=e=>({status:"valid",value:e}),jp=e=>e.status==="aborted",Ap=e=>e.status==="dirty",ri=e=>e.status==="valid",hu=e=>typeof Promise<"u"&&e instanceof Promise;function Od(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function TN(e,t,r,n,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var ve;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ve||(ve={}));var mo,po;class Un{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const n1=(e,t)=>{if(ri(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Dr(e.common.issues);return this._error=r,this._error}}};function Me(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(l,o)=>{var u,c;const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}},description:s}}class qe{get description(){return this._def.description}_getType(t){return Jn(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Jn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new er,ctx:{common:t.parent.common,data:t.data,parsedType:Jn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(hu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jn(t)},i=this._parseSync({data:t,path:s.path,parent:s});return n1(s,i)}"~validate"(t){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jn(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return ri(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>ri(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jn(t)},s=this._parse({data:t,path:n.path,parent:n}),i=await(hu(s)?s:Promise.resolve(s));return n1(n,i)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const l=t(s),o=()=>i.addIssue({code:ae.custom,...n(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new wn({schema:this,typeName:Re.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Dn.create(this,this._def)}nullable(){return ca.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bn.create(this)}promise(){return El.create(this,this._def)}or(t){return gu.create([this,t],this._def)}and(t){return xu.create(this,t,this._def)}transform(t){return new wn({...Me(this._def),schema:this,typeName:Re.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Eu({...Me(this._def),innerType:this,defaultValue:r,typeName:Re.ZodDefault})}brand(){return new vg({typeName:Re.ZodBranded,type:this,...Me(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new _u({...Me(this._def),innerType:this,catchValue:r,typeName:Re.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Vu.create(this,t)}readonly(){return Nu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Z7=/^c[^\s-]{8,}$/i,X7=/^[0-9a-z]+$/,J7=/^[0-9A-HJKMNP-TV-Z]{26}$/i,eF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tF=/^[a-z0-9_-]{21}$/i,rF=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,nF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,aF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let zf;const iF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,uF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dF=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,CN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",hF=new RegExp(`^${CN}$`);function jN(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function fF(e){return new RegExp(`^${jN(e)}$`)}function AN(e){let t=`${CN}T${jN(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function mF(e,t){return!!((t==="v4"||!t)&&iF.test(e)||(t==="v6"||!t)&&oF.test(e))}function pF(e,t){if(!rF.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function gF(e,t){return!!((t==="v4"||!t)&&lF.test(e)||(t==="v6"||!t)&&uF.test(e))}class mn extends qe{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ge.string){const i=this._getOrReturnCtx(t);return fe(i,{code:ae.invalid_type,expected:ge.string,received:i.parsedType}),Oe}const n=new er;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(s=this._getOrReturnCtx(t,s),l?fe(s,{code:ae.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&fe(s,{code:ae.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")sF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"email",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")zf||(zf=new RegExp(aF,"u")),zf.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"emoji",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")eF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"uuid",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")tF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"nanoid",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Z7.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"cuid",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")X7.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"cuid2",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")J7.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"ulid",code:ae.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),fe(s,{validation:"url",code:ae.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"regex",code:ae.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?AN(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?hF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?fF(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?nF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"duration",code:ae.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?mF(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"ip",code:ae.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?pF(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"jwt",code:ae.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?gF(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"cidr",code:ae.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?cF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"base64",code:ae.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?dF.test(t.data)||(s=this._getOrReturnCtx(t,s),fe(s,{validation:"base64url",code:ae.invalid_string,message:i.message}),n.dirty()):Xe.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:ae.invalid_string,...ve.errToObj(n)})}_addCheck(t){return new mn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ve.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ve.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ve.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ve.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ve.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ve.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ve.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ve.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ve.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ve.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ve.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ve.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ve.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...ve.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ve.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ve.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ve.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ve.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ve.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ve.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ve.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ve.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ve.errToObj(r)})}nonempty(t){return this.min(1,ve.errToObj(t))}trim(){return new mn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new mn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new mn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}mn.create=e=>{var t;return new mn({checks:[],typeName:Re.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Me(e)})};function xF(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(e.toFixed(s).replace(".","")),l=parseInt(t.toFixed(s).replace(".",""));return i%l/Math.pow(10,s)}class la extends qe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ge.number){const i=this._getOrReturnCtx(t);return fe(i,{code:ae.invalid_type,expected:ge.number,received:i.parsedType}),Oe}let n;const s=new er;for(const i of this._def.checks)i.kind==="int"?Xe.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?xF(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.not_finite,message:i.message}),s.dirty()):Xe.assertNever(i);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new la({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new la({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ve.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ve.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ve.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ve.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Xe.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}la.create=e=>new la({checks:[],typeName:Re.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Me(e)});class oa extends qe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ge.bigint)return this._getInvalidInput(t);let n;const s=new er;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),fe(n,{code:ae.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Xe.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return fe(r,{code:ae.invalid_type,expected:ge.bigint,received:r.parsedType}),Oe}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new oa({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new oa({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}oa.create=e=>{var t;return new oa({checks:[],typeName:Re.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Me(e)})};class fu extends qe{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ge.boolean){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.boolean,received:n.parsedType}),Oe}return cr(t.data)}}fu.create=e=>new fu({typeName:Re.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Me(e)});class ni extends qe{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ge.date){const i=this._getOrReturnCtx(t);return fe(i,{code:ae.invalid_type,expected:ge.date,received:i.parsedType}),Oe}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return fe(i,{code:ae.invalid_date}),Oe}const n=new er;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),fe(s,{code:ae.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Xe.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ni({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ve.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ve.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}ni.create=e=>new ni({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Re.ZodDate,...Me(e)});class Pd extends qe{_parse(t){if(this._getType(t)!==ge.symbol){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.symbol,received:n.parsedType}),Oe}return cr(t.data)}}Pd.create=e=>new Pd({typeName:Re.ZodSymbol,...Me(e)});class mu extends qe{_parse(t){if(this._getType(t)!==ge.undefined){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.undefined,received:n.parsedType}),Oe}return cr(t.data)}}mu.create=e=>new mu({typeName:Re.ZodUndefined,...Me(e)});class pu extends qe{_parse(t){if(this._getType(t)!==ge.null){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.null,received:n.parsedType}),Oe}return cr(t.data)}}pu.create=e=>new pu({typeName:Re.ZodNull,...Me(e)});class wl extends qe{constructor(){super(...arguments),this._any=!0}_parse(t){return cr(t.data)}}wl.create=e=>new wl({typeName:Re.ZodAny,...Me(e)});class Va extends qe{constructor(){super(...arguments),this._unknown=!0}_parse(t){return cr(t.data)}}Va.create=e=>new Va({typeName:Re.ZodUnknown,...Me(e)});class hs extends qe{_parse(t){const r=this._getOrReturnCtx(t);return fe(r,{code:ae.invalid_type,expected:ge.never,received:r.parsedType}),Oe}}hs.create=e=>new hs({typeName:Re.ZodNever,...Me(e)});class Dd extends qe{_parse(t){if(this._getType(t)!==ge.undefined){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.void,received:n.parsedType}),Oe}return cr(t.data)}}Dd.create=e=>new Dd({typeName:Re.ZodVoid,...Me(e)});class bn extends qe{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==ge.array)return fe(r,{code:ae.invalid_type,expected:ge.array,received:r.parsedType}),Oe;if(s.exactLength!==null){const l=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(l||o)&&(fe(r,{code:l?ae.too_big:ae.too_small,minimum:o?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(fe(r,{code:ae.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(fe(r,{code:ae.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>s.type._parseAsync(new Un(r,l,r.path,o)))).then(l=>er.mergeArray(n,l));const i=[...r.data].map((l,o)=>s.type._parseSync(new Un(r,l,r.path,o)));return er.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new bn({...this._def,minLength:{value:t,message:ve.toString(r)}})}max(t,r){return new bn({...this._def,maxLength:{value:t,message:ve.toString(r)}})}length(t,r){return new bn({...this._def,exactLength:{value:t,message:ve.toString(r)}})}nonempty(t){return this.min(1,t)}}bn.create=(e,t)=>new bn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Re.ZodArray,...Me(t)});function yi(e){if(e instanceof yt){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Dn.create(yi(n))}return new yt({...e._def,shape:()=>t})}else return e instanceof bn?new bn({...e._def,type:yi(e.element)}):e instanceof Dn?Dn.create(yi(e.unwrap())):e instanceof ca?ca.create(yi(e.unwrap())):e instanceof Bn?Bn.create(e.items.map(t=>yi(t))):e}class yt extends qe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Xe.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ge.object){const c=this._getOrReturnCtx(t);return fe(c,{code:ae.invalid_type,expected:ge.object,received:c.parsedType}),Oe}const{status:n,ctx:s}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof hs&&this._def.unknownKeys==="strip"))for(const c in s.data)l.includes(c)||o.push(c);const u=[];for(const c of l){const d=i[c],h=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new Un(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof hs){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")o.length>0&&(fe(s,{code:ae.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new Un(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const h=await d.key,f=await d.value;c.push({key:h,value:f,alwaysSet:d.alwaysSet})}return c}).then(c=>er.mergeObjectSync(n,c)):er.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return ve.errToObj,new yt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var s,i,l,o;const u=(l=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&l!==void 0?l:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=ve.errToObj(t).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new yt({...this._def,unknownKeys:"strip"})}passthrough(){return new yt({...this._def,unknownKeys:"passthrough"})}extend(t){return new yt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new yt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Re.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new yt({...this._def,catchall:t})}pick(t){const r={};return Xe.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new yt({...this._def,shape:()=>r})}omit(t){const r={};return Xe.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new yt({...this._def,shape:()=>r})}deepPartial(){return yi(this)}partial(t){const r={};return Xe.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}),new yt({...this._def,shape:()=>r})}required(t){const r={};return Xe.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Dn;)i=i._def.innerType;r[n]=i}}),new yt({...this._def,shape:()=>r})}keyof(){return IN(Xe.objectKeys(this.shape))}}yt.create=(e,t)=>new yt({shape:()=>e,unknownKeys:"strip",catchall:hs.create(),typeName:Re.ZodObject,...Me(t)});yt.strictCreate=(e,t)=>new yt({shape:()=>e,unknownKeys:"strict",catchall:hs.create(),typeName:Re.ZodObject,...Me(t)});yt.lazycreate=(e,t)=>new yt({shape:e,unknownKeys:"strip",catchall:hs.create(),typeName:Re.ZodObject,...Me(t)});class gu extends qe{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Dr(o.ctx.common.issues));return fe(r,{code:ae.invalid_union,unionErrors:l}),Oe}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(s);{let i;const l=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(u=>new Dr(u));return fe(r,{code:ae.invalid_union,unionErrors:o}),Oe}}get options(){return this._def.options}}gu.create=(e,t)=>new gu({options:e,typeName:Re.ZodUnion,...Me(t)});const Qn=e=>e instanceof bu?Qn(e.schema):e instanceof wn?Qn(e.innerType()):e instanceof vu?[e.value]:e instanceof ua?e.options:e instanceof wu?Xe.objectValues(e.enum):e instanceof Eu?Qn(e._def.innerType):e instanceof mu?[void 0]:e instanceof pu?[null]:e instanceof Dn?[void 0,...Qn(e.unwrap())]:e instanceof ca?[null,...Qn(e.unwrap())]:e instanceof vg||e instanceof Nu?Qn(e.unwrap()):e instanceof _u?Qn(e._def.innerType):[];class Ah extends qe{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ge.object)return fe(r,{code:ae.invalid_type,expected:ge.object,received:r.parsedType}),Oe;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(fe(r,{code:ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Oe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const s=new Map;for(const i of r){const l=Qn(i.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of l){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new Ah({typeName:Re.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:s,...Me(n)})}}function Ip(e,t){const r=Jn(e),n=Jn(t);if(e===t)return{valid:!0,data:e};if(r===ge.object&&n===ge.object){const s=Xe.objectKeys(t),i=Xe.objectKeys(e).filter(o=>s.indexOf(o)!==-1),l={...e,...t};for(const o of i){const u=Ip(e[o],t[o]);if(!u.valid)return{valid:!1};l[o]=u.data}return{valid:!0,data:l}}else if(r===ge.array&&n===ge.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const l=e[i],o=t[i],u=Ip(l,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===ge.date&&n===ge.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class xu extends qe{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(i,l)=>{if(jp(i)||jp(l))return Oe;const o=Ip(i.value,l.value);return o.valid?((Ap(i)||Ap(l))&&r.dirty(),{status:r.value,value:o.data}):(fe(n,{code:ae.invalid_intersection_types}),Oe)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>s(i,l)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}xu.create=(e,t,r)=>new xu({left:e,right:t,typeName:Re.ZodIntersection,...Me(r)});class Bn extends qe{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ge.array)return fe(n,{code:ae.invalid_type,expected:ge.array,received:n.parsedType}),Oe;if(n.data.length<this._def.items.length)return fe(n,{code:ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Oe;!this._def.rest&&n.data.length>this._def.items.length&&(fe(n,{code:ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Un(n,l,n.path,o)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>er.mergeArray(r,l)):er.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Bn({...this._def,rest:t})}}Bn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Bn({items:e,typeName:Re.ZodTuple,rest:null,...Me(t)})};class yu extends qe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ge.object)return fe(n,{code:ae.invalid_type,expected:ge.object,received:n.parsedType}),Oe;const s=[],i=this._def.keyType,l=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new Un(n,o,n.path,o)),value:l._parse(new Un(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?er.mergeObjectAsync(r,s):er.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof qe?new yu({keyType:t,valueType:r,typeName:Re.ZodRecord,...Me(n)}):new yu({keyType:mn.create(),valueType:t,typeName:Re.ZodRecord,...Me(r)})}}class Md extends qe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ge.map)return fe(n,{code:ae.invalid_type,expected:ge.map,received:n.parsedType}),Oe;const s=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([o,u],c)=>({key:s._parse(new Un(n,o,n.path,[c,"key"])),value:i._parse(new Un(n,u,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of l){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return Oe;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of l){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return Oe;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}}}}Md.create=(e,t,r)=>new Md({valueType:t,keyType:e,typeName:Re.ZodMap,...Me(r)});class si extends qe{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ge.set)return fe(n,{code:ae.invalid_type,expected:ge.set,received:n.parsedType}),Oe;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(fe(n,{code:ae.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(fe(n,{code:ae.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function l(u){const c=new Set;for(const d of u){if(d.status==="aborted")return Oe;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const o=[...n.data.values()].map((u,c)=>i._parse(new Un(n,u,n.path,c)));return n.common.async?Promise.all(o).then(u=>l(u)):l(o)}min(t,r){return new si({...this._def,minSize:{value:t,message:ve.toString(r)}})}max(t,r){return new si({...this._def,maxSize:{value:t,message:ve.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}si.create=(e,t)=>new si({valueType:e,minSize:null,maxSize:null,typeName:Re.ZodSet,...Me(t)});class Wi extends qe{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ge.function)return fe(r,{code:ae.invalid_type,expected:ge.function,received:r.parsedType}),Oe;function n(o,u){return Ld({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Rd(),vl].filter(c=>!!c),issueData:{code:ae.invalid_arguments,argumentsError:u}})}function s(o,u){return Ld({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Rd(),vl].filter(c=>!!c),issueData:{code:ae.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},l=r.data;if(this._def.returns instanceof El){const o=this;return cr(async function(...u){const c=new Dr([]),d=await o._def.args.parseAsync(u,i).catch(g=>{throw c.addIssue(n(u,g)),c}),h=await Reflect.apply(l,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(g=>{throw c.addIssue(s(h,g)),c})})}else{const o=this;return cr(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Dr([n(u,c.error)]);const d=Reflect.apply(l,this,c.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Dr([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Wi({...this._def,args:Bn.create(t).rest(Va.create())})}returns(t){return new Wi({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new Wi({args:t||Bn.create([]).rest(Va.create()),returns:r||Va.create(),typeName:Re.ZodFunction,...Me(n)})}}class bu extends qe{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}bu.create=(e,t)=>new bu({getter:e,typeName:Re.ZodLazy,...Me(t)});class vu extends qe{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return fe(r,{received:r.data,code:ae.invalid_literal,expected:this._def.value}),Oe}return{status:"valid",value:t.data}}get value(){return this._def.value}}vu.create=(e,t)=>new vu({value:e,typeName:Re.ZodLiteral,...Me(t)});function IN(e,t){return new ua({values:e,typeName:Re.ZodEnum,...Me(t)})}class ua extends qe{constructor(){super(...arguments),mo.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return fe(r,{expected:Xe.joinValues(n),received:r.parsedType,code:ae.invalid_type}),Oe}if(Od(this,mo)||TN(this,mo,new Set(this._def.values)),!Od(this,mo).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return fe(r,{received:r.data,code:ae.invalid_enum_value,options:n}),Oe}return cr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return ua.create(t,{...this._def,...r})}exclude(t,r=this._def){return ua.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}mo=new WeakMap;ua.create=IN;class wu extends qe{constructor(){super(...arguments),po.set(this,void 0)}_parse(t){const r=Xe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==ge.string&&n.parsedType!==ge.number){const s=Xe.objectValues(r);return fe(n,{expected:Xe.joinValues(s),received:n.parsedType,code:ae.invalid_type}),Oe}if(Od(this,po)||TN(this,po,new Set(Xe.getValidEnumValues(this._def.values))),!Od(this,po).has(t.data)){const s=Xe.objectValues(r);return fe(n,{received:n.data,code:ae.invalid_enum_value,options:s}),Oe}return cr(t.data)}get enum(){return this._def.values}}po=new WeakMap;wu.create=(e,t)=>new wu({values:e,typeName:Re.ZodNativeEnum,...Me(t)});class El extends qe{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ge.promise&&r.common.async===!1)return fe(r,{code:ae.invalid_type,expected:ge.promise,received:r.parsedType}),Oe;const n=r.parsedType===ge.promise?r.data:Promise.resolve(r.data);return cr(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}El.create=(e,t)=>new El({type:e,typeName:Re.ZodPromise,...Me(t)});class wn extends qe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Re.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:l=>{fe(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const l=s.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return Oe;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?Oe:u.status==="dirty"||r.value==="dirty"?Ri(u.value):u});{if(r.value==="aborted")return Oe;const o=this._def.schema._parseSync({data:l,path:n.path,parent:n});return o.status==="aborted"?Oe:o.status==="dirty"||r.value==="dirty"?Ri(o.value):o}}if(s.type==="refinement"){const l=o=>{const u=s.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Oe:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Oe:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ri(l))return l;const o=s.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>ri(l)?Promise.resolve(s.transform(l.value,i)).then(o=>({status:r.value,value:o})):l);Xe.assertNever(s)}}wn.create=(e,t,r)=>new wn({schema:e,typeName:Re.ZodEffects,effect:t,...Me(r)});wn.createWithPreprocess=(e,t,r)=>new wn({schema:t,effect:{type:"preprocess",transform:e},typeName:Re.ZodEffects,...Me(r)});class Dn extends qe{_parse(t){return this._getType(t)===ge.undefined?cr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Dn.create=(e,t)=>new Dn({innerType:e,typeName:Re.ZodOptional,...Me(t)});class ca extends qe{_parse(t){return this._getType(t)===ge.null?cr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ca.create=(e,t)=>new ca({innerType:e,typeName:Re.ZodNullable,...Me(t)});class Eu extends qe{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===ge.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Eu.create=(e,t)=>new Eu({innerType:e,typeName:Re.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Me(t)});class _u extends qe{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return hu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Dr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Dr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}_u.create=(e,t)=>new _u({innerType:e,typeName:Re.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Me(t)});class Fd extends qe{_parse(t){if(this._getType(t)!==ge.nan){const n=this._getOrReturnCtx(t);return fe(n,{code:ae.invalid_type,expected:ge.nan,received:n.parsedType}),Oe}return{status:"valid",value:t.data}}}Fd.create=e=>new Fd({typeName:Re.ZodNaN,...Me(e)});const yF=Symbol("zod_brand");class vg extends qe{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Vu extends qe{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Oe:i.status==="dirty"?(r.dirty(),Ri(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Oe:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new Vu({in:t,out:r,typeName:Re.ZodPipeline})}}class Nu extends qe{_parse(t){const r=this._def.innerType._parse(t),n=s=>(ri(s)&&(s.value=Object.freeze(s.value)),s);return hu(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Nu.create=(e,t)=>new Nu({innerType:e,typeName:Re.ZodReadonly,...Me(t)});function s1(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function RN(e,t={},r){return e?wl.create().superRefine((n,s)=>{var i,l;const o=e(n);if(o instanceof Promise)return o.then(u=>{var c,d;if(!u){const h=s1(t,n),f=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;s.addIssue({code:"custom",...h,fatal:f})}});if(!o){const u=s1(t,n),c=(l=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...u,fatal:c})}}):wl.create()}const bF={object:yt.lazycreate};var Re;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Re||(Re={}));const vF=(e,t={message:`Input not instance of ${e.name}`})=>RN(r=>r instanceof e,t),LN=mn.create,ON=la.create,wF=Fd.create,EF=oa.create,PN=fu.create,_F=ni.create,NF=Pd.create,kF=mu.create,SF=pu.create,TF=wl.create,CF=Va.create,jF=hs.create,AF=Dd.create,IF=bn.create,RF=yt.create,LF=yt.strictCreate,OF=gu.create,PF=Ah.create,DF=xu.create,MF=Bn.create,FF=yu.create,UF=Md.create,BF=si.create,HF=Wi.create,$F=bu.create,zF=vu.create,qF=ua.create,VF=wu.create,WF=El.create,a1=wn.create,GF=Dn.create,YF=ca.create,QF=wn.createWithPreprocess,KF=Vu.create,ZF=()=>LN().optional(),XF=()=>ON().optional(),JF=()=>PN().optional(),eU={string:e=>mn.create({...e,coerce:!0}),number:e=>la.create({...e,coerce:!0}),boolean:e=>fu.create({...e,coerce:!0}),bigint:e=>oa.create({...e,coerce:!0}),date:e=>ni.create({...e,coerce:!0})},tU=Oe;var Rr=Object.freeze({__proto__:null,defaultErrorMap:vl,setErrorMap:Q7,getErrorMap:Rd,makeIssue:Ld,EMPTY_PATH:K7,addIssueToContext:fe,ParseStatus:er,INVALID:Oe,DIRTY:Ri,OK:cr,isAborted:jp,isDirty:Ap,isValid:ri,isAsync:hu,get util(){return Xe},get objectUtil(){return Cp},ZodParsedType:ge,getParsedType:Jn,ZodType:qe,datetimeRegex:AN,ZodString:mn,ZodNumber:la,ZodBigInt:oa,ZodBoolean:fu,ZodDate:ni,ZodSymbol:Pd,ZodUndefined:mu,ZodNull:pu,ZodAny:wl,ZodUnknown:Va,ZodNever:hs,ZodVoid:Dd,ZodArray:bn,ZodObject:yt,ZodUnion:gu,ZodDiscriminatedUnion:Ah,ZodIntersection:xu,ZodTuple:Bn,ZodRecord:yu,ZodMap:Md,ZodSet:si,ZodFunction:Wi,ZodLazy:bu,ZodLiteral:vu,ZodEnum:ua,ZodNativeEnum:wu,ZodPromise:El,ZodEffects:wn,ZodTransformer:wn,ZodOptional:Dn,ZodNullable:ca,ZodDefault:Eu,ZodCatch:_u,ZodNaN:Fd,BRAND:yF,ZodBranded:vg,ZodPipeline:Vu,ZodReadonly:Nu,custom:RN,Schema:qe,ZodSchema:qe,late:bF,get ZodFirstPartyTypeKind(){return Re},coerce:eU,any:TF,array:IF,bigint:EF,boolean:PN,date:_F,discriminatedUnion:PF,effect:a1,enum:qF,function:HF,instanceof:vF,intersection:DF,lazy:$F,literal:zF,map:UF,nan:wF,nativeEnum:VF,never:jF,null:SF,nullable:YF,number:ON,object:RF,oboolean:JF,onumber:XF,optional:GF,ostring:ZF,pipeline:KF,preprocess:QF,promise:WF,record:FF,set:BF,strictObject:LF,string:LN,symbol:NF,transformer:a1,tuple:MF,undefined:kF,union:OF,unknown:CF,void:AF,NEVER:tU,ZodIssueCode:ae,quotelessJson:Y7,ZodError:Dr});const rU=Rr.object({email:Rr.string().email({message:"Invalid email address"}),password:Rr.string().min(1,{message:"Password is required"})}),nU=Rr.object({username:Rr.string().min(3,{message:"Username must be at least 3 characters long"}).max(50,{message:"Username cannot exceed 50 characters"}),email:Rr.string().email({message:"Invalid email address"}),password:Rr.string().min(8,{message:"Password must be at least 8 characters long"}),confirmPassword:Rr.string(),role:Rr.enum(["player","dm"],{required_error:"Please select a role"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),sU=Rr.object({currentPassword:Rr.string().min(1,"Current password is required"),newPassword:Rr.string().min(8,"New password must be at least 8 characters"),confirmNewPassword:Rr.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"New passwords don't match",path:["confirmNewPassword"]});function aU(){const[e,t]=w.useState(""),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(null),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState({}),{updateUserPassword:p}=Mt(),b=async E=>{E.preventDefault(),o(null),c(null),g({});const x=sU.safeParse({currentPassword:e,newPassword:r,confirmPassword:s});if(!x.success){const y={};x.error.errors.forEach(v=>{const k=v.path[0];k?y[k]=v.message:o(v.message)}),g(y),!l&&Object.keys(y).length>0&&o("Please fix the errors in the form.");return}h(!0);try{const{currentPassword:y,newPassword:v}=x.data;await p(y,v),c("Password updated successfully!"),t(""),n(""),i("")}catch(y){console.error("Password update error:",y),o(y instanceof Error?y.message:"Failed to update password.")}finally{h(!1)}};return a.jsxs("form",{onSubmit:b,className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Change Password"}),l&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Nt,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),u&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(ch,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:u})})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"current-password",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:E=>t(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.currentPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.currentPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.currentPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"new-password",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:E=>n(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.newPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.newPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.newPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirm-password",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s,onChange:E=>i(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.confirmPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.confirmPassword})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{type:"submit",variant:"primary",loading:d,disabled:d,children:"Update Password"})})]})}async function DN(e){if(!e)return console.error("getUserProfile: No user ID provided."),null;try{const{data:t,error:r,status:n}=await te.from("users").select("id, username, first_name, last_name, avatar_url, bio").eq("id",e).single();if(r){if(n===406||r.code==="PGRST116")return console.warn(`No profile found for user ID: ${e}. This might be expected.`),null;throw console.error("Error fetching user profile:",r.message),new Error(`Failed to fetch user profile: ${r.message}`)}return t}catch(t){throw console.error("Unexpected error in getUserProfile:",t),t instanceof Error?t:new Error("An unknown error occurred while fetching the user profile.")}}async function iU(e,t){if(!e)throw new Error("updateUserProfile: No user ID provided.");if(!t||Object.keys(t).length===0)throw new Error("updateUserProfile: No updates provided.");const r={username:t.username,first_name:t.first_name,last_name:t.last_name,avatar_url:t.avatar_url,bio:t.bio};if(Object.keys(r).forEach(n=>{const s=n;r[s]===void 0&&delete r[s]}),Object.keys(r).length===0){console.warn("updateUserProfile: No valid fields to update after filtering.");const n=await DN(e);if(!n)throw new Error("Could not retrieve current profile after filtering updates.");return n}try{const{data:n,error:s}=await te.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select("id, username, first_name, last_name, avatar_url, bio").single();if(s)throw console.error("Error updating user profile:",s.message),s.code==="23505"?s.message.includes("users_username_key")?new Error(`Failed to update profile: Username '${r.username}' is already taken.`):new Error(`Failed to update profile: ${s.details||"A unique value constraint was violated."}`):new Error(`Failed to update user profile: ${s.message}`);if(!n)throw new Error("Failed to update user profile: No data returned.");return n}catch(n){throw console.error("Unexpected error in updateUserProfile:",n),n instanceof Error?n:new Error("An unknown error occurred while updating the user profile.")}}async function lU(e){if(!e)throw new Error("updateUserAuthEmail: No new email provided.");if(!/\S+@\S+\.\S+/.test(e))throw new Error("updateUserAuthEmail: Invalid email format provided.");try{const{data:t,error:r}=await te.auth.updateUser({email:e});if(r)throw console.error("Error updating user auth email:",r.message),r.message.includes("User not found")||r.status===404?new Error("Failed to initiate email update: Could not find the current user."):r.message.includes("Email rate limit exceeded")?new Error("Failed to initiate email update: Please wait before trying again."):r.message.includes("same as the existing email")?new Error("The new email address is the same as the current one."):new Error(`Failed to initiate email update: ${r.message}`);console.log("User auth email update initiated. Verification required.",t)}catch(t){throw console.error("Unexpected error in updateUserAuthEmail:",t),t instanceof Error?t:new Error("An unknown error occurred while updating the user's email.")}}function oU(){var I;const{user:e,session:t}=Mt(),[r,n]=w.useState(null),[s,i]=w.useState({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState(!0),[f,g]=w.useState(!1),[p,b]=w.useState(null),[E,x]=w.useState(null),y=w.useCallback(async j=>{var D,T,B;h(!0),b(null),x(null);try{const O=await DN(j.id),Y=j.email??"";O?(n(O),i({first_name:O.first_name??"",last_name:O.last_name??"",username:O.username??((D=j.user_metadata)==null?void 0:D.username)??"",avatar_url:O.avatar_url??"",bio:O.bio??""})):(console.warn("User profile not found in 'users' table, initializing form with defaults/metadata."),i({first_name:"",last_name:"",username:((T=j.user_metadata)==null?void 0:T.username)??"",avatar_url:"",bio:""})),o(Y),c(Y)}catch(O){console.error("Failed to load profile:",O),b(O instanceof Error?O.message:"Failed to load profile data.");const Y=(e==null?void 0:e.email)??"";o(Y),c(Y),i({first_name:"",last_name:"",username:((B=e==null?void 0:e.user_metadata)==null?void 0:B.username)??"",avatar_url:"",bio:""})}finally{h(!1)}},[]);w.useEffect(()=>{e?y(e):(h(!1),n(null),i({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),o(""),c(""),b(null),x(null))},[e,y]);const v=j=>{const{name:D,value:T}=j.target;i(B=>({...B,[D]:T})),b(null),x(null)},k=j=>{o(j.target.value),b(null),x(null)},_=async j=>{var Y;if(j.preventDefault(),!e){b("You must be logged in to update your profile.");return}g(!0),b(null),x(null);let D=!1,T=!1,B="",O=!1;try{const G={},z=r??{username:((Y=e.user_metadata)==null?void 0:Y.username)??"",first_name:null,last_name:null,avatar_url:null,bio:null};if(s.first_name!==(z.first_name??"")&&(G.first_name=s.first_name),s.last_name!==(z.last_name??"")&&(G.last_name=s.last_name),s.username!==(z.username??"")&&(G.username=s.username),s.avatar_url!==(z.avatar_url??"")&&(G.avatar_url=s.avatar_url),s.bio!==(z.bio??"")&&(G.bio=s.bio),Object.keys(G).length>0){O=!0;const A=await iU(e.id,G);n(M=>M?{...M,...A}:A),i({first_name:A.first_name??"",last_name:A.last_name??"",username:A.username??"",avatar_url:A.avatar_url??"",bio:A.bio??""}),D=!0}else D=!0;const H=l.trim();if(H!==u){if(!H)throw new Error("Email cannot be empty.");O=!0,await lU(H),T=!0,B=" Email update initiated. Please check both your current and new email addresses for a verification link to complete the change."}if(O){let A="";D&&Object.keys(G).length>0&&(A+="Profile fields updated successfully."),A+=B,x(A.trim())}else x("No changes were detected.")}catch(G){console.error("Failed to update profile:",G);const z=G instanceof Error?G.message:"An unknown error occurred during update.";b(z)}finally{g(!1)}},S=j=>{var B;const D=j.currentTarget;D.style.display="none";const T=(B=D.parentElement)==null?void 0:B.querySelector(".fallback-icon");T&&(T.style.display="flex")};return d?a.jsx("div",{className:"flex justify-center items-center h-40",children:a.jsx(Ge,{})}):!e||!t?a.jsx("p",{className:"text-center text-red-600",children:"Please log in to view or edit your profile."}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8",children:[a.jsx("div",{className:"relative w-24 h-24",children:a.jsxs("div",{className:"w-full h-full rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border",children:[s.avatar_url&&a.jsx("img",{src:s.avatar_url,alt:"Profile",className:"w-full h-full object-cover",onError:S,style:{display:"block"}},s.avatar_url),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center fallback-icon",style:{display:s.avatar_url?"none":"flex"},children:a.jsx(Il,{className:"w-12 h-12 text-gray-400"})})]})}),a.jsxs("div",{className:"flex-grow w-full sm:w-auto",children:[a.jsx("h3",{className:"font-medium text-lg text-center sm:text-left",children:s.username||((I=e==null?void 0:e.user_metadata)==null?void 0:I.username)||"User"}),a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center sm:justify-start gap-1",children:[a.jsx(G0,{className:"w-4 h-4"}),l||"No email set"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{htmlFor:"avatar_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar URL"}),a.jsx("input",{id:"avatar_url",name:"avatar_url",type:"url",value:s.avatar_url??"",onChange:v,placeholder:"https://example.com/avatar.png",className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("form",{onSubmit:_,className:"space-y-6",children:[E&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(ch,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Success!"})," ",E]})]}),p&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(Nt,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Error!"})," ",p]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),a.jsx("input",{id:"first_name",name:"first_name",type:"text",value:s.first_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),a.jsx("input",{id:"last_name",name:"last_name",type:"text",value:s.last_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:l,onChange:k,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":"email-description"}),a.jsx("p",{id:"email-description",className:"text-xs text-gray-500 mt-1",children:"Changing your email requires verification via links sent to both addresses."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",value:s.username??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be unique. Used for display and potentially logging in."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),a.jsx("textarea",{id:"bio",name:"bio",value:s.bio??"",onChange:v,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Tell us a little about yourself..."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(q,{type:"submit",variant:"primary",icon:Fr,loading:f,disabled:f||d,children:"Save Changes"})})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-12",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Change Password"}),a.jsx(aU,{})]})]})}function uU(){const[e,t]=w.useState("system"),[r,n]=w.useState("medium"),[s,i]=w.useState(!1),[l,o]=w.useState(!1),u=async c=>{c.preventDefault(),o(!0),await new Promise(d=>setTimeout(d,1e3)),o(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Appearance Settings"}),a.jsxs("form",{onSubmit:u,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("light"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="light"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(Y2,{className:"w-6 h-6 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Light"})]}),a.jsxs("button",{type:"button",onClick:()=>t("dark"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="dark"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(B2,{className:"w-6 h-6 text-blue-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Dark"})]}),a.jsxs("button",{type:"button",onClick:()=>t("system"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="system"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(HA,{className:"w-6 h-6 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"System"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),a.jsxs("select",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"small",children:"Small"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"large",children:"Large"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:c=>i(c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reduce motion"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimize animations and transitions"})]}),a.jsxs("div",{className:"p-6 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsx("div",{className:`p-4 rounded-lg ${e==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:a.jsx("p",{className:`${r==="small"?"text-sm":r==="large"?"text-lg":"text-base"}`,children:"This is how your content will look with the selected theme and font size."})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{type:"submit",variant:"primary",icon:Fr,loading:l,children:"Save Changes"})})]})]})}function cU(){const[e,t]=w.useState({email:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,systemUpdates:!1},desktop:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,diceRolls:!0},sounds:{enabled:!0,volume:80,diceRolls:!0,notifications:!0}}),[r,n]=w.useState(!1),s=async i=>{i.preventDefault(),n(!0),await new Promise(l=>setTimeout(l,1e3)),n(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Notification Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(G0,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Email Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.email).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,email:{...e.email,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(PA,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Desktop Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.desktop).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,desktop:{...e.desktop,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(R2,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Sound Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.enabled,onChange:i=>t({...e,sounds:{...e.sounds,enabled:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Enable Sounds"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Volume (",e.sounds.volume,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",value:e.sounds.volume,onChange:i=>t({...e,sounds:{...e.sounds,volume:parseInt(i.target.value)}}),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.diceRolls,onChange:i=>t({...e,sounds:{...e.sounds,diceRolls:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Dice Roll Sounds"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.notifications,onChange:i=>t({...e,sounds:{...e.sounds,notifications:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Notification Sounds"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{type:"submit",variant:"primary",icon:Fr,loading:r,children:"Save Changes"})})]})]})}const dU=[{value:"en",label:"English"},{value:"et",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"sv",label:"Swedish"}],hU=[{value:"Europe/Tallinn",label:"Europe/Tallinn (UTC+2)"},{value:"Europe/Helsinki",label:"Europe/Helsinki (UTC+2)"},{value:"Europe/Stockholm",label:"Europe/Stockholm (UTC+1)"},{value:"UTC",label:"UTC"}],fU=[{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"YYYY-MM-DD",label:"YYYY-MM-DD"}],mU=[{value:"24h",label:"24-hour (14:30)"},{value:"12h",label:"12-hour (2:30 PM)"}];function pU(){const[e,t]=w.useState({language:"en",timeZone:"Europe/Tallinn",dateFormat:"DD/MM/YYYY",timeFormat:"24h",firstDayOfWeek:1,useMetricSystem:!0}),[r,n]=w.useState(!1),s=async o=>{o.preventDefault(),n(!0),await new Promise(u=>setTimeout(u,1e3)),n(!1)},i=new Date,l=new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"long",timeZone:e.timeZone}).format(i);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Localization Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(F2,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Language & Region"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interface Language"}),a.jsx("select",{value:e.language,onChange:o=>t({...e,language:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:dU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),a.jsx("select",{value:e.timeZone,onChange:o=>t({...e,timeZone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:hU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx($0,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Date & Time Format"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),a.jsx("select",{value:e.dateFormat,onChange:o=>t({...e,dateFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:fU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),a.jsx("select",{value:e.timeFormat,onChange:o=>t({...e,timeFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:mU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Day of Week"}),a.jsxs("select",{value:e.firstDayOfWeek,onChange:o=>t({...e,firstDayOfWeek:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"Monday"}),a.jsx("option",{value:0,children:"Sunday"})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(hh,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Measurement System"})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.useMetricSystem,onChange:o=>t({...e,useMetricSystem:o.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Use Metric System"})]})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current date and time: ",l]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{type:"submit",variant:"primary",icon:Fr,loading:r,children:"Save Changes"})})]})]})}function gU({onClose:e,onUserCreated:t}){const[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState("player"),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState(!1),[p,b]=w.useState(null),[E,x]=w.useState(!1),[y,v]=w.useState([]),[k,_]=w.useState(!1),[S,I]=w.useState(null),j=async()=>{_(!0),I(null);const{data:B,error:O}=await te.from("users").select("*");O?I(O.message):v(B),_(!1)};w.useEffect(()=>{j()},[]);const D=async B=>{B.preventDefault(),c(null),g(!0);try{const O=Math.random().toString(36).slice(-12),{data:Y,error:G}=await te.auth.signUp({email:r,password:O,options:{data:{username:s}}});if(G)throw G;if(!Y.user)throw new Error("Failed to create user");const{error:z}=await te.from("users").update({role:l}).eq("id",Y.user.id);if(z)throw z;const H=new URL(window.location.origin);H.searchParams.set("email",r),H.searchParams.set("password",O),b(H.toString()),h(!0),t(),j()}catch(O){c(O instanceof Error?O.message:"Failed to create user")}finally{g(!1)}},T=async()=>{if(p)try{await navigator.clipboard.writeText(p),x(!0),setTimeout(()=>x(!1),2e3)}catch{c("Failed to copy link to clipboard")}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),u&&a.jsxs("div",{className:"mb-6 flex items-start gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Nt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]}),d&&p?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"User Created Successfully!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Share the following link with the user to let them sign in:"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:p,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50"}),a.jsx(q,{variant:"secondary",icon:E?Hi:Ed,onClick:T,children:E?"Copied!":"Copy"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{variant:"primary",onClick:e,children:"Done"})})]}):a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:r,onChange:B=>n(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{type:"text",required:!0,value:s,onChange:B=>i(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{value:l,onChange:B=>o(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"player",children:"Player"}),a.jsx("option",{value:"dm",children:"Dungeon Master"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(q,{variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(q,{type:"submit",variant:"primary",icon:Il,loading:f,children:"Create User"})]})]})]}),a.jsxs("div",{className:"p-6 border-t",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Created Users"}),k?a.jsx("p",{children:"Loading users..."}):S?a.jsxs("p",{className:"text-red-600",children:["Error loading users: ",S]}):y.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(B=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:B.username}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:B.email}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:B.role}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(B.created_at).toLocaleString()}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:B.account_status||"N/A"})]},B.id))})]})}):a.jsx("p",{children:"No users found."})]})]})})}function xU(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState("all"),[d,h]=w.useState(!1),f=w.useCallback(async()=>{n(!0),i(null);try{const{data:x,error:y}=await te.from("users").select("id, email, username, role, created_at, last_login, first_name, last_name, is_active").order("created_at",{ascending:!1});if(y)throw y;t(x||[])}catch(x){console.error("Error fetching users:",x),i(`Failed to load users: ${x.message||"Unknown error"}`),t([])}finally{n(!1)}},[]);w.useEffect(()=>{f()},[f]);const g=()=>{h(!1),f()},p=e.filter(x=>{const y=l.toLowerCase(),v=x.username&&x.username.toLowerCase().includes(y)||x.email&&x.email.toLowerCase().includes(y)||x.first_name&&x.first_name.toLowerCase().includes(y)||x.last_name&&x.last_name.toLowerCase().includes(y),k=u==="all"||x.role&&x.role.toLowerCase()===u.toLowerCase();return v&&k}),b=x=>{const y=x==null?void 0:x.toLowerCase();return y==="admin"?"bg-purple-100 text-purple-800":y==="dm"||y==="dungeon master"?"bg-blue-100 text-blue-800":y==="player"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},E=x=>x.username?x.username:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.first_name?x.first_name:x.email.split("@")[0];return a.jsxs("div",{className:"space-y-6 p-4 md:p-6 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"User Management"}),a.jsx(q,{variant:"primary",icon:Wt,onClick:()=>h(!0),className:"w-full sm:w-auto",children:"Create User"})]}),s&&a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg shadow-sm",children:[a.jsx(Nt,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Error Loading Users"}),a.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, username...",value:l,onChange:x=>o(x.target.value),className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-colors",disabled:r})]}),a.jsxs("div",{className:"relative md:min-w-[200px]",children:[a.jsx(ps,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:u,onChange:x=>c(x.target.value),className:"w-full pl-11 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white shadow-sm transition-colors",disabled:r,children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"player",children:"Players"}),a.jsx("option",{value:"dm",children:"Dungeon Masters"}),a.jsx("option",{value:"admin",children:"Administrators"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),r&&e.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):!r&&e.length===0&&!s?a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Users,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500",children:"There are currently no users to display. Try creating one!"})]}):a.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold",children:[x.first_name?x.first_name.charAt(0).toUpperCase():x.email.charAt(0).toUpperCase(),x.last_name?x.last_name.charAt(0).toUpperCase():x.username?x.username.charAt(0).toUpperCase():""]}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:E(x)}),a.jsx("div",{className:"text-xs text-gray-500",children:x.email})]})]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${b(x.role||"N/A")}`,children:x.role?x.role.charAt(0).toUpperCase()+x.role.slice(1):"N/A"})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:x.is_active===void 0||x.is_active===null?a.jsx("span",{className:"text-xs text-gray-500",children:"Unknown"}):x.is_active?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:[a.jsx(ch,{className:"w-3.5 h-3.5 mr-1.5"})," Active"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:[a.jsx(dh,{className:"w-3.5 h-3.5 mr-1.5"})," Inactive"]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:x.last_login?new Date(x.last_login).toLocaleString():"Never"}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{variant:"icon",size:"sm",title:"Edit User",className:"text-gray-500 hover:text-blue-600",children:a.jsx($2,{className:"w-4 h-4"})}),a.jsx(q,{variant:"icon",size:"sm",title:"Delete User",className:"text-gray-500 hover:text-red-600",children:a.jsx(Sr,{className:"w-4 h-4"})})]})})]},x.id))})]})}),p.length===0&&!r&&e.length>0&&a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(ia,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Match Your Search"}),a.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term or role filter."})]}),d&&a.jsx(gU,{onClose:()=>h(!1),onUserCreated:g})]})}var MN={exports:{}},yU="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",bU=yU,vU=bU;function FN(){}function UN(){}UN.resetWarningCache=FN;var wU=function(){function e(n,s,i,l,o,u){if(u!==vU){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:UN,resetWarningCache:FN};return r.PropTypes=r,r};MN.exports=wU();var EU=MN.exports;const Cc=Ud(EU);function Rp(){return Rp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(this,arguments)}function _U(e,t){if(e==null)return{};var r=NU(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function NU(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var wg=w.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,s=e.size,i=s===void 0?24:s,l=_U(e,["color","size"]);return Kr.createElement("svg",Rp({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),Kr.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Kr.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});wg.propTypes={color:Cc.string,size:Cc.oneOfType([Cc.string,Cc.number])};wg.displayName="X";function kU({entry:e,onChange:t}){const[r,n]=w.useState(e),[s,i]=w.useState({gold:0,silver:0,copper:0}),[l,o]=w.useState([]);w.useEffect(()=>{if(n(e),e.cost){const d=e.cost.split(",").map(f=>f.trim()),h={gold:0,silver:0,copper:0};d.forEach(f=>{f.includes("gold")?h.gold=parseInt(f.replace("gold","").trim())||0:f.includes("silver")?h.silver=parseInt(f.replace("silver","").trim())||0:f.includes("copper")&&(h.copper=parseInt(f.replace("copper","").trim())||0)}),i(h)}e.features&&o(e.features)},[e]);const u=(d,h)=>{const f=parseInt(h)||0,g={...s,[d]:f};i(g),t("cost",`${g.gold} gold, ${g.silver} silver, ${g.copper} copper`)},c=d=>{const h=l.filter((f,g)=>g!==d);o(h),t("features",h)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:d=>t("name",d.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:r.category||"",onChange:d=>t("category",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"ARMOR & HELMETS",children:"Armor & Helmets"}),a.jsx("option",{value:"MELEE WEAPONS",children:"Melee Weapons"}),a.jsx("option",{value:"RANGED WEAPONS",children:"Ranged Weapons"}),a.jsx("option",{value:"CLOTHES",children:"Clothes"}),a.jsx("option",{value:"MUSICAL INSTRUMENTS",children:"Musical Instruments"}),a.jsx("option",{value:"TRADE GOODS",children:"Trade Goods"}),a.jsx("option",{value:"STUDIES & MAGIC",children:"Studies & Magic"}),a.jsx("option",{value:"LIGHT SOURCES",children:"Light Sources"}),a.jsx("option",{value:"TOOLS",children:"Tools"}),a.jsx("option",{value:"CONTAINERS",children:"Containers"}),a.jsx("option",{value:"MEDICINE",children:"Medicine"}),a.jsx("option",{value:"SERVICES",children:"Services"}),a.jsx("option",{value:"HUNTING & FISHING",children:"Hunting & Fishing"}),a.jsx("option",{value:"MEANS OF TRAVEL",children:"Means of Travel"}),a.jsx("option",{value:"ANIMALS",children:"Animals"})]})]}),r.category==="ARMOR & HELMETS"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor Rating"}),a.jsx("input",{type:"number",value:r.armor_rating||"",onChange:d=>t("armor_rating",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),r.category==="MELEE WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),r.category==="RANGED WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.gold,onChange:d=>u("gold",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Gold"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.silver,onChange:d=>u("silver",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Silver"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.copper,onChange:d=>u("copper",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Copper"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supply"}),a.jsxs("select",{value:r.supply||"",onChange:d=>t("supply",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Supply"}),a.jsx("option",{value:"Common",children:"Common"}),a.jsx("option",{value:"Uncommon",children:"Uncommon"}),a.jsx("option",{value:"Rare",children:"Rare"}),a.jsx("option",{value:"Unique",children:"Unique"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:r.weight||"",onChange:d=>t("weight",parseFloat(d.target.value)),className:"w-full px-3 py-2 border rounded-md",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effect/Description"}),a.jsx("textarea",{value:r.effect||"",onChange:d=>t("effect",d.target.value.toUpperCase()),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((d,h)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md px-2 py-1 text-sm",children:[a.jsx("span",{children:d}),a.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-2 text-red-500 hover:text-red-700",children:a.jsx(wg,{className:"w-4 h-4"})})]},h)),a.jsx("input",{type:"text",onKeyDown:d=>{if(d.key==="Enter"&&d.currentTarget.value.trim()){d.preventDefault();const h=d.currentTarget.value.trim(),f=[...l,h];o(f),t("features",f),d.currentTarget.value=""}},className:"px-3 py-2 border rounded-md",placeholder:"Add feature..."})]})]})]})}const SU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:r=>t("heroic_ability",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abilities"}),(e.abilities||[]).map((r,n)=>a.jsxs("div",{className:"flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",placeholder:"Ability Description",value:r.description||"",onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],description:s.target.value},t("abilities",i)},className:"border rounded-md px-2 py-1 flex-1"}),a.jsx("input",{type:"number",placeholder:"Willpower Points",value:r.willpower_points||0,onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],willpower_points:parseInt(s.target.value)},t("abilities",i)},className:"border rounded-md px-2 py-1 w-20",min:"0"}),a.jsx("button",{onClick:()=>{const s=[...e.abilities||[]];s.splice(n,1),t("abilities",s)},className:"text-red-600",children:"Remove"})]},n)),a.jsx("button",{onClick:()=>{const r=[...e.abilities||[],{description:"",willpower_points:0}];t("abilities",r)},className:"mt-2 text-blue-600",children:"Add Ability"})]})]}),TU=["Acrobatics","Animism","Awareness","Axes","Bartering","Beast Lore","Bluffing","Bows","Brawling","Bushcraft","Crossbows","Crafting","Evade","Elementalism","Healing","Hammers","Hunting & Fishing","Knives","Languages","Mentalism","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Slings","Spears","Spot Hidden","Staves","Swords","Swimming"].sort(),CU=({entry:e,onChange:t})=>{const[r,n]=w.useState("skills"),s=e.starting_equipment||["","",""],i=e.equipment_description||["","",""],l=(o,u,c)=>{if(u==="equipment"){const d=[...s];d[o]=c,t("starting_equipment",d)}else{const d=[...i];d[o]=c,t("equipment_description",d)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:o=>t("name",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:o=>t("description",o.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute"}),a.jsx("input",{type:"text",value:e.key_attribute||"",onChange:o=>t("key_attribute",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:o=>t("heroic_ability",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Magic School"}),a.jsxs("select",{value:e.magic_school_id||"",onChange:o=>t("magic_school_id",o.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"Animist",children:"Animist"}),a.jsx("option",{value:"Elementalist",children:"Elementalist"}),a.jsx("option",{value:"Mentalist",children:"Mentalist"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex border-b",children:[a.jsx("button",{type:"button",onClick:()=>n("skills"),className:`px-4 py-2 -mb-px font-medium ${r==="skills"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Skills"}),a.jsx("button",{type:"button",onClick:()=>n("startingEquipment"),className:`px-4 py-2 -mb-px font-medium ${r==="startingEquipment"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Starting Equipment"})]}),r==="skills"&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:TU.map(o=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:e.skills?e.skills.includes(o):!1,onChange:u=>{let c=e.skills?[...e.skills]:[];u.target.checked?c.push(o):c=c.filter(d=>d!==o),t("skills",c)}}),a.jsx("span",{className:"text-sm",children:o})]},o))})]}),r==="startingEquipment"&&a.jsx("div",{className:"mt-4 space-y-4",children:[0,1,2].map(o=>a.jsxs("div",{className:"border p-2 rounded-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment Option ",o+1]}),a.jsx("input",{type:"text",placeholder:"Enter equipment (e.g., Horn or Flute, knife, torch)",value:s[o]||"",onChange:u=>l(o,"equipment",u.target.value),className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (e.g., D6 food rations, D8 silver)",value:i[o]||"",onChange:u=>l(o,"description",u.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})]},o))})]})]})},jU=({entry:e,onChange:t})=>{const{skills:r,loading:n,error:s}=oE(),[i,l]=w.useState(!1),[o,u]=w.useState(!1),[c,d]=w.useState({}),h=w.useCallback(()=>{if(n||!r||r.length===0)return;u(!0);const p=e.requirement;let b={};if(Z0(p))b=p,console.log("AbilityForm: Initial requirement is already name-based:",p);else if(My(p)){console.log("AbilityForm: Initial requirement is UUID-based, converting:",p);const E=new Map(r.map(x=>[x.id,x.name]));for(const[x,y]of Object.entries(p)){const v=E.get(x);v?b[v]=y:console.warn(`AbilityForm: Could not find skill name for UUID ${x} during initialization.`)}console.log("AbilityForm: Converted to name-based requirements:",b)}else typeof p=="string"||p===null||p===void 0?(console.log("AbilityForm: Initial requirement is simple string, null, or undefined:",p),b={}):(console.warn("AbilityForm: Unrecognized requirement format during initialization:",p),b={});d(b),u(!1)},[e.requirement,r,n]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{t("requirement",c)},[c,t]);const f=(p,b)=>{typeof p=="string"&&d(E=>{const x={...E};return b?x.hasOwnProperty(p)||(x[p]=null):delete x[p],x})},g=(p,b)=>{if(typeof p!="string")return;const E=b===""?null:parseInt(b,10);c.hasOwnProperty(p)&&d(x=>({...x,[p]:isNaN(E)?null:E}))};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{id:"ability-name",type:"text",value:e.name||"",onChange:p=>t("name",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{id:"ability-description",value:e.description||"",onChange:p=>t("description",p.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-willpower_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Willpower Cost"}),a.jsx("input",{id:"ability-willpower_cost",type:"number",value:e.willpower_cost===null||e.willpower_cost===void 0?"":e.willpower_cost,onChange:p=>t("willpower_cost",p.target.value===""?null:parseInt(p.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-profession",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profession (Optional)"}),a.jsx("input",{id:"ability-profession",type:"text",value:e.profession||"",onChange:p=>t("profession",p.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain profession."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-kin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kin (Optional)"}),a.jsx("input",{id:"ability-kin",type:"text",value:e.kin||"",onChange:p=>t("kin",p.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain kin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Requirements (Optional)"}),a.jsxs("details",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden",open:i,onToggle:p=>l(p.target.open),children:[a.jsx("summary",{className:"px-3 py-2 cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-t-md",children:Object.keys(c).length>0?`${Object.keys(c).length} skill(s) selected`:"Select required skills..."}),a.jsx("div",{className:"p-4 border-t border-gray-200 max-h-60 overflow-y-auto",children:n||o?a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(Ge,{size:"md"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading skills..."})]}):s?a.jsx(Ie,{message:`Error loading skills: ${s}`}):r.length===0?a.jsx("p",{className:"text-gray-500",children:"No skills available."}):a.jsx("ul",{className:"space-y-2",children:r.map(p=>{const b=p.name,E=c.hasOwnProperty(b),x=c[b];return a.jsxs("li",{className:"flex items-center space-x-3",children:[" ",a.jsx("input",{id:`skill-req-${p.id}`,type:"checkbox",checked:E,onChange:y=>f(b,y.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`skill-req-${p.id}`,className:"flex-1 text-sm text-gray-700",children:[p.name," ",p.attribute?`(${p.attribute})`:""]}),E&&a.jsx("input",{type:"number",min:"1",placeholder:"Level (Opt.)",value:x??"",onChange:y=>g(b,y.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500"})]},p.id)})})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select skills required for this ability and optionally specify a minimum level. Requirements are now stored by skill name."}),typeof e.requirement=="string"&&e.requirement&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:a.jsxs("p",{className:"text-xs text-yellow-700",children:[a.jsx("strong",{children:"Note:"}),' This ability has a non-skill requirement text: "',e.requirement,'". Saving will overwrite this if skills are selected above.']})}),My(e.requirement)&&o&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded",children:a.jsx("p",{className:"text-xs text-orange-700",children:"Attempting to convert legacy UUID-based requirements..."})})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]})};function BN(e){return typeof e!="object"||e===null||!e.type?!1:e.type==="logical"?(e.operator==="AND"||e.operator==="OR")&&Array.isArray(e.conditions)&&e.conditions.every(BN):["spell","school","skill","attribute"].includes(e.type)?typeof e.name=="string":e.type==="anySchool"}function AU({entry:e,onChange:t,magicSchools:r=[]}){const[n,s]=w.useState(""),[i,l]=w.useState(null);w.useEffect(()=>{if(e.prerequisite)try{typeof e.prerequisite=="object"&&e.prerequisite!==null?s(JSON.stringify(e.prerequisite,null,2)):typeof e.prerequisite=="string"&&(JSON.parse(e.prerequisite),s(JSON.stringify(JSON.parse(e.prerequisite),null,2)))}catch{s(e.prerequisite)}else s("")},[e.prerequisite]);const o=c=>{const d=c.target.value;if(s(d),d.trim()===""){t("prerequisite",null),l(null);return}try{const h=JSON.parse(d);BN(h)?(t("prerequisite",JSON.stringify(h)),l(null)):l("Invalid prerequisite JSON structure. Please check the format.")}catch{l("Invalid JSON. Please ensure correct JSON syntax.")}},u=c=>{const{name:d,value:h,type:f}=c.target;let g=h;f==="number"&&c.target instanceof HTMLInputElement&&(g=h===""?null:parseInt(h,10),isNaN(g)&&(g=null)),d==="school_id"&&h===""&&(g=null),t(d,g)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("input",{type:"text",name:"name",id:"name",value:e.name||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),a.jsx("textarea",{name:"description",id:"description",rows:3,value:e.description||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"school_id",className:"block text-sm font-medium text-gray-700",children:"Magic School"}),a.jsxs("select",{name:"school_id",id:"school_id",value:e.school_id||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white",children:[a.jsx("option",{value:"",children:"General"}),r.map(c=>a.jsx("option",{value:c.id,children:c.name},c.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rank",className:"block text-sm font-medium text-gray-700",children:"Rank (0 for Trick)"}),a.jsx("input",{type:"number",name:"rank",id:"rank",min:"0",max:"5",value:e.rank??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"casting_time",className:"block text-sm font-medium text-gray-700",children:"Casting Time"}),a.jsx("input",{type:"text",name:"casting_time",id:"casting_time",value:e.casting_time||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"range",className:"block text-sm font-medium text-gray-700",children:"Range"}),a.jsx("input",{type:"text",name:"range",id:"range",value:e.range||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),a.jsx("input",{type:"text",name:"duration",id:"duration",value:e.duration||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"willpower_cost",className:"block text-sm font-medium text-gray-700",children:"Willpower Cost"}),a.jsx("input",{type:"number",name:"willpower_cost",id:"willpower_cost",min:"0",value:e.willpower_cost??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"prerequisite",className:"block text-sm font-medium text-gray-700",children:"Learning Prerequisite (JSON or leave empty)"}),a.jsx("textarea",{name:"prerequisite",id:"prerequisite",rows:6,value:n,onChange:o,placeholder:'JSON for learning, e.g., {"type": "spell", "name": "Light"}. Leave empty for no prerequisite.',className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 focus:outline-none sm:text-sm ${i?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),i&&a.jsx("p",{className:"mt-2 text-sm text-red-600",children:i}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Use JSON format for learning prerequisites. Examples: ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "anySchool"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "spell", "name": "Example Spell"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "logical", "operator": "AND", "conditions": [...]}'})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"requirement",className:"block text-sm font-medium text-gray-700",children:"Casting Requirement (Text or leave empty)"}),a.jsx("textarea",{name:"requirement",id:"requirement",rows:3,value:e.requirement||"",onChange:u,placeholder:"e.g., Requires a free hand, or Verbal component only. Leave empty if none.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe any requirements for casting the spell (e.g., components, conditions)."})]})]})}const IU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Name"}),a.jsx("input",{id:"skill-name",type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx("textarea",{id:"skill-description",value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-attribute",className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute (Optional)"}),a.jsx("input",{id:"skill-attribute",type:"text",value:e.attribute||"",onChange:r=>t("attribute",r.target.value||null),placeholder:"e.g., STR, AGL, INT...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The primary attribute associated with this skill."})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]}),RU=["Small","Normal","Large","Huge","Swarm"],i1=()=>({FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0}),LU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:"",effects:[]}),OU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:""});function PU({entry:e,onChange:t}){const[r,n]=w.useState({...e,stats:e.stats||i1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(g=>({...g,id:g.id||crypto.randomUUID()}))}))});w.useEffect(()=>{n({...e,stats:e.stats||i1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(g=>({...g,id:g.id||crypto.randomUUID()}))}))})},[e]);const s=w.useCallback((f,g)=>{const p={...r,[f]:g};n(p),t(f,g)},[r,t]),i=w.useCallback((f,g)=>{const p={...r.stats,[f]:g};s("stats",p)},[r.stats,s]),l=w.useCallback(()=>{const f=[...r.attacks,LU()];s("attacks",f)},[r.attacks,s]),o=w.useCallback((f,g,p)=>{const b=[...r.attacks];b[f]={...b[f],[g]:p},s("attacks",b)},[r.attacks,s]),u=w.useCallback(f=>{const g=r.attacks.filter((p,b)=>b!==f);s("attacks",g)},[r.attacks,s]),c=w.useCallback(f=>{const g=[...r.attacks];g[f].effects=[...g[f].effects||[],OU()],s("attacks",g)},[r.attacks,s]),d=w.useCallback((f,g,p,b)=>{const E=[...r.attacks];E[f].effects&&(E[f].effects[g]={...E[f].effects[g],[p]:b},s("attacks",E))},[r.attacks,s]),h=w.useCallback((f,g)=>{const p=[...r.attacks];p[f].effects&&(p[f].effects=p[f].effects.filter((b,E)=>E!==g),s("attacks",p))},[r.attacks,s]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:f=>s("name",f.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:r.category||"",onChange:f=>s("category",f.target.value),placeholder:"e.g., Beast, Undead, Humanoid",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:r.description||"",onChange:f=>s("description",f.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Statistics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferocity"}),a.jsx("input",{type:"number",value:r.stats.FEROCITY,onChange:f=>i("FEROCITY",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),a.jsx("select",{value:r.stats.SIZE,onChange:f=>i("SIZE",f.target.value),className:"w-full px-3 py-2 border rounded-md",children:RU.map(f=>a.jsx("option",{value:f,children:f},f))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movement"}),a.jsx("input",{type:"number",value:r.stats.MOVEMENT,onChange:f=>i("MOVEMENT",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor"}),a.jsx("input",{type:"number",value:r.stats.ARMOR,onChange:f=>i("ARMOR",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HP"}),a.jsx("input",{type:"number",value:r.stats.HP,onChange:f=>i("HP",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effects Summary"}),a.jsx("textarea",{value:r.effectsSummary||"",onChange:f=>s("effectsSummary",f.target.value),rows:3,placeholder:"Describe any special effects or abilities here...",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attacks (D6 Rollable Table)"}),a.jsx(q,{variant:"secondary",size:"sm",icon:wd,onClick:l,children:"Add Attack"})]}),r.attacks.length===0&&a.jsx("p",{className:"text-gray-500",children:'No attacks defined. Click "Add Attack" to create one.'}),r.attacks.map((f,g)=>a.jsxs("div",{className:"p-3 border rounded-md mb-4 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-2",children:[a.jsx("input",{type:"text",placeholder:"Roll Values (e.g., 1, 2-3)",value:f.roll_values,onChange:p=>o(g,"roll_values",p.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"text",placeholder:"Attack Name",value:f.name,onChange:p=>o(g,"name",p.target.value),className:"md:col-span-2 px-3 py-2 border rounded-md"})]}),a.jsx("textarea",{placeholder:"Attack Description",value:f.description,onChange:p=>o(g,"description",p.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsxs("div",{className:"ml-4 mt-2 p-3 border-l-2 border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Effects (Optional D6 Table)"}),a.jsx(q,{variant:"outline",size:"xs",icon:wd,onClick:()=>c(g),children:"Add Effect"})]}),f.effects.length===0&&a.jsx("p",{className:"text-gray-500",children:'No effects for this attack. Click "Add Effect" to create one.'}),f.effects.map((p,b)=>a.jsxs("div",{className:"p-2 border rounded-md mb-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-1",children:[a.jsx("input",{type:"text",placeholder:"Roll (e.g., 1-2)",value:p.roll_values,onChange:E=>d(g,b,"roll_values",E.target.value),className:"px-2 py-1 border rounded-md text-sm"}),a.jsx("input",{type:"text",placeholder:"Effect Name",value:p.name,onChange:E=>d(g,b,"name",E.target.value),className:"md:col-span-2 px-2 py-1 border rounded-md text-sm"})]}),a.jsx("textarea",{placeholder:"Effect Description",value:p.description,onChange:E=>d(g,b,"description",E.target.value),rows:1,className:"w-full px-2 py-1 border rounded-md text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(q,{variant:"danger",size:"xs",icon:Sr,onClick:()=>h(g,b),children:"Remove Effect"})})]},p.id))]}),a.jsx("div",{className:"text-right",children:a.jsx(q,{variant:"danger",size:"sm",icon:Sr,onClick:()=>u(g),children:"Remove Attack"})})]},f.id))]})]})}function DU(e){const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),[o,u]=w.useState(e),c=w.useCallback(p=>{switch(p){case"spells":return"game_spells";case"items":return"game_items";case"abilities":return"heroic_abilities";case"kin":return"kin";case"profession":return"professions";case"skills":return"game_skills";case"monsters":return"monsters";default:throw console.error(`Invalid data category passed to getTableName: ${p}`),new Error(`Invalid data category: ${p}`)}},[]),d=w.useCallback(async p=>{s(!0),l(null);let b;try{b=c(p),console.log(`[useGameData] Attempting to load category: ${p}, using table: ${b}`);let E=te.from(b);p==="spells"?E=E.select(`
                *,
                magic_schools ( name )
              `):E=E.select("*"),E=E.order("name"),console.log(`[useGameData] Executing query for table: ${b}`);const{data:x,error:y}=await E;if(y)throw console.error(`[useGameData] Supabase fetch error for ${b}:`,y),y;const v=(x||[]).map(k=>{var S;let _={...k};if(p==="spells"&&(_.magic_schools=(S=k.magic_schools)==null?void 0:S.name),p==="abilities"&&typeof k.requirement=="string")try{_.requirement=JSON.parse(k.requirement)}catch{}return _});console.log(`[useGameData] Loaded ${v.length} entries for ${p} from ${b}`),r(v)}catch(E){const x=b||p;console.error(`[useGameData] Error in loadEntries for ${x}:`,E);const y=(E==null?void 0:E.message)||`Failed to load ${x}`,v=E!=null&&E.details?`: ${E.details}`:"";l(`${y}${v}`),r([])}finally{s(!1)}},[c]),h=w.useCallback(async(p,b,E,x)=>{let y="";try{x(null),s(!0),y=c(p);const{id:v,...k}=b;let _={...k};if(!_.name||String(_.name).trim()==="")throw new Error(`Cannot save ${p} without a name.`);if(p==="abilities"&&(_.willpower_cost=_.willpower_cost===""||_.willpower_cost===void 0?null:Number(_.willpower_cost),typeof _.requirement=="object"&&_.requirement!==null?Object.keys(_.requirement).length>0?_.requirement=JSON.stringify(_.requirement):_.requirement=null:(_.requirement===""||_.requirement===void 0)&&(_.requirement=null),_.kin=_.kin||null,_.profession=_.profession||null),p==="spells"&&(_.rank=Number(_.rank??0),_.willpower_cost=Number(_.willpower_cost??0),_.school_id=_.school_id||null,_.requirement=_.requirement||null),p==="skills"&&(_.attribute=_.attribute||null),p==="monsters"){const j=b;if(_.stats=j.stats||{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0},_.attacks=j.attacks||[],Array.isArray(_.attacks)&&(_.attacks=_.attacks.map(D=>{const{id:T,effects:B,...O}=D;return Array.isArray(B)&&(O.effects=B.map(Y=>{const{id:G,...z}=Y;return z})),O})),!v){const{data:D,error:T}=await te.auth.getSession();if(T||!D.session)throw new Error("User not authenticated. Cannot save monster.");_.created_by=D.session.user.id}}console.log(`[useGameData] Saving entry to ${y} (ID: ${v||"new"}):`,_);let S=null,I=null;if(v){const{data:j,error:D}=await te.from(y).update(_).eq("id",v).select().single();S=D,I=j}else{const{data:j,error:D}=await te.from(y).insert([_]).select().single();S=D,I=j}if(S)throw console.error(`[useGameData] Supabase Save Error (${y}):`,S),S;I?(console.log(`[useGameData] Save operation successful for ${p} (ID: ${I.id})`),E(I)):(console.warn(`[useGameData] Save operation for ${p} (ID: ${v||"new"}) did not return data. Using input data for callback.`),E({...b,id:v||(I==null?void 0:I.id)})),await d(p)}catch(v){const k=y||p,_=(v==null?void 0:v.message)||(typeof v=="string"?v:"An unexpected error occurred during save."),S=v!=null&&v.details?` (Details: ${v.details})`:"",I=v!=null&&v.code?` (Code: ${v.code})`:"",j=`Error saving ${k}: ${_}${S}${I}`;console.error(`[useGameData] Error in handleSave for ${k}:`,v),x(j)}finally{s(!1)}},[c,d]),f=w.useCallback(async(p,b)=>{if(!window.confirm(`Are you sure you want to delete this ${p} entry (ID: ${b})? This action cannot be undone.`))return;let E="";try{l(null),s(!0),E=c(p),console.log(`[useGameData] Deleting entry from ${E}, ID: ${b}`);const{error:x}=await te.from(E).delete().eq("id",b);if(x)throw console.error(`[useGameData] Error deleting from ${E}:`,x),x;console.log(`[useGameData] Delete successful for ID: ${b} in ${p}`),await d(p)}catch(x){const y=E||p,v=(x==null?void 0:x.message)||"An unexpected error occurred during deletion.",k=x!=null&&x.details?` (Details: ${x.details})`:"",_=x!=null&&x.code?` (Code: ${x.code})`:"",S=`Error deleting ${y}: ${v}${k}${_}`;console.error(`[useGameData] Error in handleDelete for ${y}:`,x),l(S)}finally{s(!1)}},[c,d]),g=w.useCallback(p=>{console.log(`[useGameData] Switching category from ${o} to ${p}`),u(p),d(p)},[o,d]);return w.useEffect(()=>{console.log(`[useGameData] Initial load effect for category: ${e}`);try{c(e),d(e)}catch(p){console.error(`[useGameData] Invalid initial category: ${e}`,p),l(`Invalid initial category: ${e}`),s(!1)}},[e,c,d]),{entries:t,loading:n,error:i,activeCategory:o,switchCategory:g,handleSave:h,handleDelete:f}}const MU=[{id:"items",label:"Items",icon:Ja},{id:"spells",label:"Spells",icon:kd},{id:"abilities",label:"Abilities",icon:ds},{id:"kin",label:"Kin",icon:xn},{id:"profession",label:"Professions",icon:_A},{id:"skills",label:"Skills",icon:WA},{id:"monsters",label:"Monsters",icon:_d}],FU=e=>{try{if(Z0(e)){const t=Object.entries(e);return t.length===0?"None":t.map(([r,n])=>`${r}${n!==null?` (Lvl ${n})`:""}`).join(", ")||"None"}if(typeof e=="string"&&e)return e;if(typeof e=="object"&&e!==null){const t=Object.keys(e);if(t.length>0)return/^[0-9a-fA-F]{8}-/.test(t[0])?`${t.length} skill(s) (Legacy UUIDs)`:t.length===1&&typeof e[t[0]]=="object"?`Requirement: ${t[0]} (Invalid Format)`:`${t.length} requirement(s) (Unknown format)`}return"None"}catch(t){return console.error("Error formatting requirement:",e,t),"Error: Invalid Format"}};function HN(){const[e,t]=w.useState(null),[r,n]=w.useState(""),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,g]=w.useState([]),{entries:p,loading:b,error:E,handleSave:x,handleDelete:y,switchCategory:v,activeCategory:k}=DU("items"),_=w.useCallback(async()=>{const{data:A,error:M}=await te.from("game_items").select("category",{count:"exact",head:!1});M?console.error("Error fetching item categories:",M):A&&c([...new Set(A.map(Q=>Q.category).filter(Boolean))])},[]),S=w.useCallback(async()=>{const{data:A,error:M}=await te.from("magic_schools").select("id, name").order("name");M?console.error("Error fetching magic schools:",M):A&&h(A)},[]),I=w.useCallback(async()=>{const{data:A,error:M}=await te.from("monsters").select("category",{count:"exact",head:!1});M?console.error("Error fetching monster categories:",M):A&&g([...new Set(A.map(Q=>Q.category).filter(Boolean))])},[]);w.useEffect(()=>{o(""),k==="items"?(_(),h([]),g([])):k==="spells"?(S(),c([]),g([])):k==="monsters"?(I(),c([]),h([])):(c([]),h([]),g([]))},[k,_,S,I]);const j=w.useCallback(A=>{console.log("Save successful, closing modal for:",A),t(null),i(null),k==="items"&&_(),k==="monsters"&&I()},[k,_,I]),D=w.useCallback(async()=>{e&&(console.log(`Calling hook's handleSave for category: ${k}`),await x(k,e,j,i))},[e,k,x,j]),T=w.useCallback(async A=>{A&&(console.log(`Calling hook's handleDelete for category: ${k}, ID: ${A}`),await y(k,A),k==="items"&&_(),k==="monsters"&&I())},[k,y,_,I]),B=w.useCallback((A,M)=>{t(Q=>Q?{...Q,[A]:M}:null)},[]),O=w.useCallback(()=>{i(null);let A={name:""};switch(console.log(`Creating new entry for category: ${k}`),k){case"spells":A={...A,description:"",rank:1,school_id:null,casting_time:"",range:"",duration:"",willpower_cost:0};break;case"items":A={...A,description:"",category:"",cost:0,weight:0};break;case"abilities":A={...A,description:"",willpower_cost:null,requirement:{},profession:null,kin:null};break;case"kin":A={...A,description:"",key_attribute:"",typical_profession:"",kin_abilities:[]};break;case"profession":A={...A,description:"",key_attribute:"",skills:[]};break;case"skills":A={...A,description:"",attribute:null};break;case"monsters":A={name:"",description:"",category:"",stats:{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:10},attacks:[]};break}t(A)},[k]),Y=w.useCallback(()=>{if(!e)return null;switch(k){case"spells":return a.jsx(AU,{entry:e,onChange:B,magicSchools:d});case"items":return a.jsx(kU,{entry:e,onChange:B});case"abilities":return a.jsx(jU,{entry:e,onChange:B});case"kin":return a.jsx(SU,{entry:e,onChange:B});case"profession":return a.jsx(CU,{entry:e,onChange:B});case"skills":return a.jsx(IU,{entry:e,onChange:B});case"monsters":return a.jsx(PU,{entry:e,onChange:B});default:return a.jsx("p",{children:"No form available for this category."})}},[e,k,B,d]),G=p.filter(A=>{var N,K,$;const M=(N=A.name)==null?void 0:N.toLowerCase().includes(r.toLowerCase());let Q=!0;if(l)if(k==="items")Q=((K=A.category)==null?void 0:K.toLowerCase())===l.toLowerCase();else if(k==="spells"){const R=A.magic_schools;l==="General"?Q=!R:Q=(R==null?void 0:R.toLowerCase())===l.toLowerCase()}else k==="monsters"&&(Q=(($=A.category)==null?void 0:$.toLowerCase())===l.toLowerCase());return M&&Q}),z=w.useCallback(()=>{t(null),i(null)},[]),H=k==="items"?u:k==="spells"?["General",...d.map(A=>A.name)].sort():k==="monsters"?f.sort():[];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Game Data Management"}),a.jsx(q,{variant:"primary",icon:Wt,onClick:O,disabled:b,children:"Add Entry"})]}),E&&a.jsx(Ie,{message:`Error loading data: ${E}`}),a.jsx("div",{className:"flex gap-4 border-b overflow-x-auto pb-2",children:MU.map(({id:A,label:M,icon:Q})=>a.jsxs("button",{onClick:()=>v(A),className:`px-4 py-2 font-medium flex items-center gap-2 whitespace-nowrap ${k===A?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:b,children:[a.jsx(Q,{className:"w-5 h-5"}),M]},A))}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:`Search ${k}...`,value:r,onChange:A=>n(A.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg",disabled:b})]}),(k==="items"||k==="spells"||k==="monsters")&&H.length>0&&a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-48",children:[a.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:l,onChange:A=>o(A.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",disabled:b,children:[a.jsxs("option",{value:"",children:["All ",k==="items"?"Categories":k==="spells"?"Schools":k==="monsters"?"Categories":""]}),H.map(A=>a.jsx("option",{value:A,children:A},A))]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),b&&!p.length?a.jsxs("p",{className:"text-center py-4",children:["Loading ",k,"..."]}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Name"}),k==="spells"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"School"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Rank"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"WP Cost"})]}),k==="items"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Category"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Cost"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Weight"})]}),k==="abilities"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"WP Cost"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Requirement"})]}),k==="kin"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Key Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Typical Profession"})]}),k==="profession"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Key Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Skills"})]}),k==="skills"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Description"})]}),k==="monsters"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Category"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"HP"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Armor"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Size"})]}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:G.map(A=>{var N,K,$;let M="N/A";k==="abilities"&&(M=FU(A.requirement));const Q=k==="monsters"?A:null;return a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.name}),k==="spells"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.magic_schools||"General"}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.rank===0?"Trick":`Rank ${A.rank}`}),a.jsxs("td",{className:"px-4 py-2 align-top",children:[A.willpower_cost," WP"]})]}),k==="items"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.category}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.cost}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.weight})]}),k==="abilities"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.willpower_cost??"N/A"}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 max-w-xs truncate",title:typeof M=="string"?M:"Invalid Data",children:M})]}),k==="kin"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.key_attribute}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.typical_profession})]}),k==="profession"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.key_attribute}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 max-w-xs truncate",children:Array.isArray(A.skills)?A.skills.join(", "):""})]}),k==="skills"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.attribute||"N/A"}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 truncate max-w-xs",title:A.description||"",children:A.description})]}),k==="monsters"&&Q&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:Q.category}),a.jsx("td",{className:"px-4 py-2 align-top",children:(N=Q.stats)==null?void 0:N.HP}),a.jsx("td",{className:"px-4 py-2 align-top",children:(K=Q.stats)==null?void 0:K.ARMOR}),a.jsx("td",{className:"px-4 py-2 align-top",children:($=Q.stats)==null?void 0:$.SIZE})]}),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(q,{variant:"secondary",size:"sm",icon:Mu,onClick:()=>{i(null),t(A)},disabled:!A.id,children:"Edit"}),a.jsx(q,{variant:"danger",size:"sm",icon:Sr,onClick:()=>A.id&&T(A.id),disabled:!A.id||b,children:"Delete"})]})})]},A.id||A.name)})})]}),G.length===0&&!b&&!E&&a.jsx("p",{className:"text-center text-gray-500 py-4",children:r||l?`No ${k} found matching filters.`:`No entries for '${k}'.`})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white py-2 z-10 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.id?`Edit ${k}`:`New ${k}`}),a.jsx("button",{onClick:z,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),s&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:s})}),a.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:Y()}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6 sticky bottom-0 bg-white py-3 z-10 border-t",children:[a.jsx(q,{variant:"secondary",onClick:z,disabled:b,children:"Cancel"}),a.jsx(q,{variant:"primary",icon:Fr,onClick:D,disabled:b,children:b?"Saving...":e.id?"Update Entry":"Save Entry"})]})]})})]})}function UU(){const{user:e}=Mt(),[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(""),[h,f]=w.useState(null),[g,p]=w.useState(!1),b=async E=>{E.preventDefault();try{if(!i.trim()||!o.trim()||!c.trim()){f("All fields are required");return}if(!e){f("You must be logged in to create or edit entries");return}if(n){const{error:x}=await te.from("compendium").update({title:i,content:o,category:c}).eq("id",n);if(x)throw x}else{const{error:x}=await te.from("compendium").insert([{title:i,content:o,category:c,created_by:e.id}]);if(x)throw x}l(""),u(""),d(""),r(!1),s(null)}catch(x){f(x instanceof Error?x.message:"Failed to save entry")}};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>p(!1),className:`p-2 rounded-lg ${g?"text-gray-600 hover:bg-gray-100":"bg-blue-100 text-blue-700"}`,children:a.jsx(P2,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>p(!0),className:`p-2 rounded-lg ${g?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(M2,{className:"w-5 h-5"})})]})]}),g?a.jsx("div",{className:"min-h-[300px] p-4 border border-gray-300 rounded-md bg-white overflow-auto",children:a.jsx(bg,{content:o})}):a.jsx("textarea",{value:o,onChange:E=>u(E.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:`# Heading 1
## Heading 2

Regular text with **bold** and *italic* formatting.

> Blockquote for important notes

| Table | Header |
|--------|---------|
| Cell 1 | Cell 2 |`})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null),l(""),u(""),d(""),p(!1)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(Fr,{className:"w-5 h-5"}),n?"Update Entry":"Save Entry"]})]})]})})}function BU(){const[e,t]=w.useState("users"),r=()=>{switch(e){case"users":return a.jsx(xU,{});case"gameData":return a.jsx(HN,{});case"compendium":return a.jsx(UU,{});default:return null}},n=[{key:"users",label:"Users",Icon:mh}];return a.jsxs("div",{className:"",children:[n.length>0&&a.jsx("nav",{className:"border-b",children:a.jsx("ul",{className:"flex -mb-px",children:n.map(({key:s,label:i,Icon:l})=>a.jsx("li",{className:"mr-6",children:a.jsxs("button",{onClick:()=>t(s),className:e===s?"flex items-center py-2 px-4 text-blue-600 border-b-2 border-blue-600 font-semibold":"flex items-center py-2 px-4 text-gray-600 hover:text-gray-800 hover:border-b-2 hover:border-gray-300",children:[a.jsx(l,{className:"w-5 h-5 mr-2"}),i]})},s))})}),a.jsx("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:r()})]})}function l1({children:e,className:t="",onClick:r}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 ${t} ${r?"cursor-pointer":""}`,onClick:r,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:r?n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),r())}:void 0,children:e})}const qf=[{id:"profile",label:"Profile Settings",icon:Il,description:"Manage your personal information and account settings"},{id:"appearance",label:"Appearance",icon:H2,description:"Customize the look and feel of the application"},{id:"notifications",label:"Notifications",icon:R2,description:"Configure your notification preferences"},{id:"localization",label:"Localization",icon:F2,description:"Set your language, timezone and regional preferences"},{id:"game-data",label:"Game Data Editor",icon:Ja,description:"Edit game data such as spells and items",adminOnly:!0},{id:"admin",label:"Admin Panel",icon:ds,description:"System administration and user management",adminOnly:!0}];function HU(){const{isAdmin:e}=Mt(),[t,r]=w.useState(()=>"profile"),n=i=>{const l=qf.find(o=>o.id===i);l&&(!l.adminOnly||e())?r(i):l!=null&&l.adminOnly&&!e()&&(console.warn("Attempted to access admin settings without privileges."),r("profile"))};Kr.useEffect(()=>{const i=qf.find(l=>l.id===t);i!=null&&i.adminOnly&&!e()&&r("profile")},[t,e]);const s=()=>{switch(t){case"profile":return a.jsx(oU,{});case"appearance":return a.jsx(uU,{});case"notifications":return a.jsx(cU,{});case"localization":return a.jsx(pU,{});case"game-data":return e()?a.jsx(HN,{}):a.jsx(ko,{to:"/settings",replace:!0});case"admin":return e()?a.jsx(BU,{}):a.jsx(ko,{to:"/settings",replace:!0});default:return a.jsx(ko,{to:"/settings",replace:!0})}};return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(q2,{className:"w-8 h-8 text-gray-700"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 md:col-span-4 space-y-4",children:qf.filter(i=>!i.adminOnly||e()).map(i=>a.jsx(l1,{onClick:()=>n(i.id),className:`cursor-pointer transition-all ${t===i.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${t===i.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:a.jsx(i.icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium",children:i.label}),a.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),a.jsx(Ca,{className:`w-5 h-5 ${t===i.id?"text-blue-500":"text-gray-400"}`})]})},i.id))}),a.jsx("div",{className:"col-span-12 md:col-span-8",children:a.jsx(l1,{children:s()})})]})]})}function $U(){const[e,t]=w.useState(!0),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState("player"),[f,g]=w.useState(null),[p,b]=w.useState(null),[E,x]=w.useState({}),[y,v]=w.useState(!1),[k,_]=w.useState(navigator.onLine),{signIn:S,signUp:I}=Mt(),j=rn(),D=pa();w.useEffect(()=>{var z;(z=D.state)!=null&&z.message&&(b(D.state.message),j(D.pathname,{replace:!0,state:{}}))},[D,j]),w.useEffect(()=>{const z=()=>_(!0),H=()=>_(!1);return window.addEventListener("online",z),window.addEventListener("offline",H),()=>{window.removeEventListener("online",z),window.removeEventListener("offline",H)}},[]);const T=()=>{n(""),i(""),o(""),c(""),h("player"),g(null),b(null),x({})},B=()=>{t(!e),T()},O=async()=>{const z=rU.safeParse({email:r.trim(),password:s});if(!z.success){const H={};return z.error.errors.forEach(A=>{A.path[0]&&(H[String(A.path[0])]=A.message)}),x(H),g("Please fix the errors in the form."),!1}try{v(!0);const{email:H,password:A}=z.data;return await S(H,A),!0}catch(H){return g(H instanceof Error?H.message:"Login failed. Please try again."),!1}finally{v(!1)}},Y=async()=>{const z=nU.safeParse({username:l.trim(),email:r.trim(),password:s,confirmPassword:u,role:d});if(!z.success){const H={};return z.error.errors.forEach(A=>{A.path[0]&&(H[String(A.path[0])]=A.message)}),x(H),g("Please fix the errors in the form."),!1}try{v(!0);const{email:H,password:A,username:M,role:Q}=z.data;return await I(H,A,M,Q),b("Registration successful! Please check your email to verify your account before logging in."),t(!0),T(),n(H),!0}catch(H){return g(H instanceof Error?H.message:"Signup failed. Please try again."),!1}finally{v(!1)}},G=async z=>{if(z.preventDefault(),g(null),b(null),x({}),!k){g("No internet connection");return}e?await O():await Y()};return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(ds,{className:"mx-auto h-12 w-12 text-blue-600"}),a.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:e?"Log in to DragonBane":"Create your DragonBane Account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e?"Enter your details to access your account":"Fill in the details to register"})]}),!k&&a.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Nt,{className:"h-5 w-5 text-yellow-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No internet connection"}),a.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Please check your internet connection and try again."})]})]})}),f&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Nt,{className:"h-5 w-5 text-red-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:e?"Login Error":"Signup Error"}),a.jsx("p",{className:"mt-2 text-sm text-red-700",children:f})]})]})}),p&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Nt,{className:"h-5 w-5 text-green-400 mr-2"})," ",a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),a.jsx("p",{className:"mt-2 text-sm text-green-700",children:p})]})]})}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:G,noValidate:!0,children:[a.jsxs("div",{className:"space-y-4",children:[!e&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Il,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,autoComplete:"username",value:l,onChange:z=>o(z.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.username?"border-red-500":"border-gray-300"}`,placeholder:"Choose a username",disabled:y})]}),E.username&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.username})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(G0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:r,onChange:z=>n(z.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address",disabled:y})]}),E.email&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.email})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:e?"current-password":"new-password",value:s,onChange:z=>i(z.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password",disabled:y})]}),E.password&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.password})]}),!e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,autoComplete:"new-password",value:u,onChange:z=>c(z.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password",disabled:y})]}),E.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.confirmPassword})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Register as"}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"player",checked:d==="player",onChange:()=>h("player"),disabled:y}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Player"})]}),a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"dm",checked:d==="dm",onChange:()=>h("dm"),disabled:y}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Dungeon Master (DM)"})]})]}),E.role&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.role})]})]})]}),a.jsx(q,{type:"submit",variant:"primary",fullWidth:!0,loading:y,disabled:!k||y,icon:e?W0:mh,iconPosition:"left",children:e?"Log in":"Sign up"})]}),a.jsx("div",{className:"text-sm text-center",children:a.jsx("button",{type:"button",onClick:B,className:"font-medium text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:y,children:e?"Don't have an account? Sign up":"Already have an account? Log in"})})]})})}const o1=({type:e})=>a.jsx("span",{className:"font-mono px-1 border rounded bg-gray-100 text-xs",children:e}),zU={d4:4,d6:6,d8:8,d10:10,d12:12,d20:20};function u1(e){return Math.floor(Math.random()*zU[e])+1}function qU(){const{showDiceRoller:e,toggleDiceRoller:t,currentConfig:r,dicePool:n,addDie:s,removeLastDie:i,clearDicePool:l,isBoonActive:o,isBaneActive:u,setBoon:c,setBane:d,addRollToHistory:h,rollHistory:f,clearHistory:g}=xa(),{markSkillInSession:p}=ur(),[b,E]=w.useState([]),[x,y]=w.useState([]),[v,k]=w.useState(null),[_,S]=w.useState(!1),[I,j]=w.useState(void 0),[D,T]=w.useState(!1),B=(r==null?void 0:r.rollMode)==="skillCheck",O=(r==null?void 0:r.rollMode)==="deathRoll",Y=(r==null?void 0:r.rollMode)==="rallyRoll",G=(r==null?void 0:r.rollMode)==="recoveryRoll",z=(r==null?void 0:r.rollMode)==="advancementRoll",H=w.useCallback(()=>{if(n.length===0)return;const N=n.map(Z=>({type:Z,value:u1(Z)}));let K=[],$=N.reduce((Z,be)=>Z+be.value,0),R=!1,me,ce=r==null?void 0:r.skillName;if((o||u)&&n.length===1&&n[0]==="d20"){K=[{type:"d20",value:u1("d20")}];const Z=N[0].value,be=K[0].value;o?$=Math.min(Z,be):$=Math.max(Z,be)}else n.length===1&&n[0]==="d20"&&($=N[0].value);if(n.length===1&&n[0]==="d20"){const Z=typeof $=="number"?$:N[0].value;Z===1?(R=!0,$="Dragon!",me=!0):Z===20&&(R=!0,$="Demon!",me=!1),(r==null?void 0:r.targetValue)!==void 0&&!R&&(B||Y||z?me=Z<=r.targetValue:O&&(me=Z<=r.targetValue,Z===1&&(R=!0,$="Dragon!",me=!0),Z===20&&(R=!0,$="Demon!",me=!1))),B&&ce&&(Z===1||Z===20)&&p(ce)}else G&&n.length===1&&n[0]==="d6"&&($=N[0].value,me=void 0,R=!1);E(N),y(K),k($),S(R),j(me);const we={description:(r==null?void 0:r.description)||`${n.join(", ")} Roll`,dicePool:[...n],results:N,boonResults:K.length>0?K:void 0,finalOutcome:$,isBoon:o,isBane:u,targetValue:r==null?void 0:r.targetValue,isSuccess:me,isCritical:R,skillName:ce};h(we),r!=null&&r.onRollComplete&&r.onRollComplete(we)},[n,o,u,r,h,p]);if(w.useEffect(()=>{e||(E([]),y([]),k(null),S(!1),j(void 0),T(!1))},[e]),w.useEffect(()=>{E([]),y([]),k(null),S(!1),j(void 0)},[n,o,u]),!e)return null;const A=()=>r!=null&&r.description?r.description:O?"Death Save (d20 vs CON)":Y?"Rally Roll (d20 vs WIL, Bane)":G?"Recovery Roll (1d6 HP)":z?"Advancement Roll (d20 vs Skill)":B?"Skill Check (d20 vs Skill)":"Dice Roller",M=()=>O?a.jsx(_d,{className:"w-5 h-5 mr-2 text-red-500"}):Y?a.jsx(W2,{className:"w-5 h-5 mr-2 text-yellow-500"}):G?a.jsx(q0,{className:"w-5 h-5 mr-2 text-green-500"}):z?a.jsx(co,{className:"w-5 h-5 mr-2 text-blue-500"}):B?a.jsx(Nd,{className:"w-5 h-5 mr-2 text-purple-500"}):a.jsx(en,{className:"w-5 h-5 mr-2"}),Q=O||Y||G||z;return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[M(),A()]}),a.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:D?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Roll History"}),a.jsxs(q,{onClick:g,variant:"danger",size:"xs",disabled:f.length===0,children:[a.jsx(Sr,{className:"w-3 h-3 mr-1"})," Clear"]})]}),f.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No rolls yet."}):a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(N=>a.jsxs("li",{className:"text-xs border-b pb-1",children:[a.jsx("p",{className:"font-medium",children:N.description}),a.jsxs("p",{children:["Pool: ",N.dicePool.join(", ")," ",N.isBoon?"(Boon)":"",N.isBane?"(Bane)":""]}),a.jsxs("p",{children:["Rolls: ",N.results.map(K=>K.value).join(", ")," ",N.boonResults?`| Boon/Bane: ${N.boonResults.map(K=>K.value).join(", ")}`:""]}),a.jsxs("p",{children:["Outcome: ",a.jsx("span",{className:"font-semibold",children:N.finalOutcome}),N.targetValue!==void 0&&` (vs ${N.targetValue})`,N.isSuccess===!0&&a.jsx("span",{className:"text-green-600 ml-1",children:"(Success)"}),N.isSuccess===!1&&a.jsx("span",{className:"text-red-600 ml-1",children:"(Failure)"}),N.isCritical&&a.jsx("span",{className:"text-purple-600 ml-1",children:"(Critical!)"})]}),N.skillName&&a.jsxs("p",{className:"text-gray-500",children:["Skill: ",N.skillName]})]},N.id))})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-3 border rounded bg-gray-50 min-h-[50px] flex flex-wrap gap-2 items-center",children:n.length===0?a.jsx("span",{className:"text-gray-500 italic",children:"Dice pool is empty"}):n.map((N,K)=>a.jsxs("button",{onClick:()=>!Q&&i(N),className:`px-2 py-1 border rounded shadow-sm flex items-center ${Q?"bg-gray-300 cursor-not-allowed":"bg-white hover:bg-red-50 hover:border-red-300"}`,title:Q?void 0:`Remove ${N}`,disabled:Q,children:[a.jsx(o1,{type:N}),!Q&&a.jsx(Lt,{className:"w-3 h-3 ml-1 text-red-500"})]},K))}),!Q&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-4",children:["d4","d6","d8","d10","d12","d20"].map(N=>a.jsx(q,{onClick:()=>s(N),variant:"outline",size:"sm",children:a.jsx(o1,{type:N})},N))}),n.length===1&&n[0]==="d20"&&!Q&&a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsxs(q,{onClick:()=>c(!o),variant:o?"success":"outline",size:"sm",className:`flex items-center ${o?"ring-2 ring-green-400 ring-offset-1":""}`,children:[a.jsx(Nd,{className:`w-4 h-4 mr-1 ${o?"text-white":"text-green-500"}`})," Boon"]}),a.jsxs(q,{onClick:()=>d(!u),variant:u?"danger":"outline",size:"sm",className:`flex items-center ${u?"ring-2 ring-red-400 ring-offset-1":""}`,children:[a.jsx(YA,{className:`w-4 h-4 mr-1 ${u?"text-white":"text-red-500"}`})," Bane"]})]}),b.length>0&&a.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50 border-blue-200 text-center",children:[a.jsxs("p",{className:"text-sm text-blue-700 mb-1",children:["Rolled: ",b.map(N=>N.value).join(", "),x.length>0&&` | Boon/Bane: ${x.map(N=>N.value).join(", ")}`]}),a.jsx("p",{className:`text-2xl font-bold ${_?"text-purple-600":"text-blue-900"}`,children:v}),(r==null?void 0:r.targetValue)!==void 0&&!_&&a.jsxs("p",{className:"text-sm text-gray-600",children:["(Target: ",r.targetValue,")"]}),I===!0&&!_&&a.jsx("p",{className:"text-green-600 font-semibold mt-1",children:"Success!"}),I===!1&&!_&&a.jsx("p",{className:"text-red-600 font-semibold mt-1",children:"Failure!"})]})]})}),a.jsxs("div",{className:"p-4 border-t flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{children:[a.jsxs(q,{onClick:()=>T(!D),variant:"secondary",size:"sm",children:[a.jsx(IA,{className:"w-4 h-4 mr-1"})," ",D?"Roller":"History"]}),!D&&!Q&&a.jsxs(q,{onClick:l,variant:"ghost",size:"sm",className:"ml-2 text-red-600 hover:bg-red-100",disabled:n.length===0,children:[a.jsx(Sr,{className:"w-4 h-4 mr-1"})," Clear Pool"]})]}),!D&&a.jsxs(q,{onClick:H,disabled:n.length===0,size:"lg",children:[a.jsx(en,{className:"w-5 h-5 mr-2"})," Roll"]})]})]})})}function VU({children:e}){const{user:t}=Mt(),r=pa();return t?a.jsx(a.Fragment,{children:e}):a.jsx(ko,{to:"/login",state:{from:r},replace:!0})}function WU({textToCopy:e}){const[t,r]=w.useState(!1),n=async()=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Failed to copy text: ",s)}};return a.jsx(q,{variant:"ghost",size:"icon",onClick:n,"aria-label":t?"Copied":"Copy to clipboard",children:t?a.jsx(Hi,{className:"w-5 h-5 text-green-500"}):a.jsx(Ed,{className:"w-5 h-5 text-gray-500"})})}function GU({partyId:e,isDM:t}){const{user:r}=Mt(),[n,s]=w.useState([]),[i,l]=w.useState([]),[o,u]=w.useState(null),[c,d]=w.useState(!1),[h,f]=w.useState(null),[g,p]=w.useState(""),[b,E]=w.useState(""),[x,y]=w.useState(""),[v,k]=w.useState("all"),[_,S]=w.useState(""),[I,j]=w.useState(!0),[D,T]=w.useState(null),[B,O]=w.useState(null),Y=w.useCallback(()=>{p(""),E(""),y(v==="all"?"":v),O(null)},[v]),G=()=>{Y(),d(!0),f(null),u(null)},z=$=>{u($),f($.id),d(!1),p($.title),E($.content),y($.category),O(null)},H=()=>{d(!1),f(null),Y(),h&&u(null)},A=w.useCallback(async()=>{if(e){j(!0),T(null);try{const{data:$,error:R}=await te.from("notes").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(R)throw R;s($||[]);const me=Array.from(new Set(($==null?void 0:$.map(ce=>ce.category).filter(Boolean))||[]));l(me)}catch($){console.error("Error loading party notes:",$),T($ instanceof Error?$.message:"Failed to load party notes"),s([])}finally{j(!1)}}},[e]);w.useEffect(()=>{A()},[A]);const M=async()=>{if(!r){O("User not authenticated.");return}if(!g.trim()){O("Note title cannot be empty.");return}if(!x.trim()){O("Note category cannot be empty.");return}O(null);const $={title:g.trim(),content:b||"",category:x.trim(),party_id:e,user_id:r.id,updated_at:new Date().toISOString()};try{let R=null;if(h){const{data:me,error:ce}=await te.from("notes").update($).eq("id",h).select().single();if(ce)throw ce;R=me}else{const{updated_at:me,...ce}=$,{data:we,error:Z}=await te.from("notes").insert([ce]).select().single();if(Z)throw Z;R=we}H(),await A(),R&&u(R)}catch(R){console.error("Error saving note:",R);let me="Failed to save note.";R instanceof Error&&(R.message.includes("RLS")?me="Permission denied. Could not save the note due to security policies.":"code"in R&&R.code==="23505"?me="A note with this title might already exist in this party.":me=`Failed to save note: ${R.message}`),O(me)}},Q=async $=>{if(window.confirm("Are you sure you want to delete this note?"))try{T(null);const{error:R}=await te.from("notes").delete().eq("id",$);if(R)throw R;await A(),(o==null?void 0:o.id)===$&&u(null),h===$&&H()}catch(R){console.error("Error deleting note:",R),T(R instanceof Error?`Failed to delete note: ${R.message}`:"An unknown error occurred while deleting.")}},N=n.filter($=>{const R=$.title.toLowerCase().includes(_.toLowerCase())||$.content.toLowerCase().includes(_.toLowerCase()),me=v==="all"||$.category===v;return R&&me});if(I&&n.length===0&&!e)return a.jsx("div",{className:"p-4",children:a.jsx(Ie,{message:"Party ID is missing. Cannot load notes."})});if(I&&n.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:[" ",a.jsx(Ge,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading party notes..."})]});const K=c||h;return a.jsxs("div",{className:"flex h-[calc(100vh-150px)] overflow-hidden bg-gray-50",children:[" ",a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Du,{className:"w-5 h-5 text-indigo-600"}),"Party Notes"]}),a.jsx(q,{variant:"primary",size:"sm",icon:Wt,onClick:G,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:_,onChange:$=>S($.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsxs("select",{id:"category-filter",value:v,onChange:$=>k($.target.value),className:"w-full pl-9 pr-7 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white text-sm","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map($=>a.jsx("option",{value:$,children:$},$))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(z0,{className:"w-3 h-3 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[D&&!K&&a.jsx("div",{className:"p-3",children:a.jsx(Ie,{message:D,onClose:()=>T(null)})}),N.length>0?N.map($=>a.jsxs("div",{onClick:()=>{(!h||h!==$.id)&&(u($),d(!1),f(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(o==null?void 0:o.id)===$.id&&!K?"bg-indigo-50 border-l-4 border-indigo-500":""} ${h===$.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:$.title}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-0.5",children:[a.jsx(wy,{className:"w-2.5 h-2.5"}),a.jsx("span",{className:"truncate",children:$.category})]})]},$.id)):!I&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(pl,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),_||v!=="all"?"No notes match filters.":"No notes in this party yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:K?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Edit Party Note":"Create New Party Note"}),a.jsx("button",{onClick:H,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100","aria-label":"Close form",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),B&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:B,onClose:()=>O(null)})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"note-title",type:"text",value:g,onChange:$=>p($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{id:"note-category",type:"text",value:x,onChange:$=>y($.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Quests, Locations, NPCs",list:"category-suggestions",required:!0}),i.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("datalist",{id:"category-suggestions",children:i.map($=>a.jsx("option",{value:$},$))}),a.jsxs("select",{value:x,onChange:$=>y($.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white text-sm","aria-label":"Select existing category",children:[a.jsx("option",{value:"",disabled:!0,children:"Select existing..."}),i.map($=>a.jsx("option",{value:$,children:$},$))]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"note-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"note-content",value:b,onChange:$=>E($.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your notes here..."})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-3",children:[a.jsx(q,{variant:"secondary",onClick:H,children:"Cancel"}),a.jsx(q,{variant:"primary",icon:Fr,onClick:M,disabled:I||!g.trim()||!x.trim(),children:I?"Saving...":h?"Update Note":"Save Note"})]})]}):o?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx(wy,{className:"w-3 h-3"}),a.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-700",children:o.category})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(q,{variant:"secondary",size:"sm",icon:Mu,onClick:()=>z(o),children:"Edit"}),a.jsx(q,{variant:"danger_outline",size:"sm",icon:Sr,onClick:()=>Q(o.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(bg,{content:o.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(o.created_at).toLocaleDateString(),o.updated_at&&new Date(o.updated_at).getTime()!==new Date(o.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(o.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(pl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a party note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),D&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ie,{message:D,onClose:()=>T(null)})})]})})]})}async function YU(e){if(!e)return console.warn("fetchTasks called without partyId"),[];const{data:t,error:r}=await te.from("party_tasks").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching tasks:",r),new Error(r.message||"Failed to fetch tasks");return t||[]}async function QU(e,t){if(!t)throw new Error("User must be authenticated to create a task.");if(!e.party_id)throw new Error("Party ID is required to create a task.");if(!e.title||e.title.trim()==="")throw new Error("Task title cannot be empty.");const{data:r,error:n}=await te.from("party_tasks").insert({party_id:e.party_id,title:e.title,description:e.description,created_by_user_id:t.id,status:"open"}).select().single();if(n)throw console.error("Error creating task:",n),new Error(n.message||"Failed to create task");if(!r)throw new Error("Task creation did not return data.");return r}async function KU(e,t){if(!e)throw new Error("Task ID is required to update a task.");const r={...t};t.status&&(t.status==="completed"?r.completed_at=new Date().toISOString():t.status==="open"&&(r.completed_at=null));const{data:n,error:s}=await te.from("party_tasks").update(r).eq("id",e).select().single();if(s)throw console.error("Error updating task:",s),new Error(s.message||"Failed to update task");if(!n)throw new Error("Task update did not return data.");return n}async function ZU(e){if(!e)throw new Error("Task ID is required to delete a task.");const{error:t}=await te.from("party_tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),new Error(t.message||"Failed to delete task")}function XU(){const e=rn(),{setGlobalError:t}=K2(),r=w.useCallback((i,l)=>{const o=i instanceof Error?i.message:String(i);zi.handleError(i,{action:l==null?void 0:l.action,additionalData:{critical:l==null?void 0:l.critical}}),(l==null?void 0:l.showError)!==!1&&t(o),l!=null&&l.redirect&&e(l.redirect),l!=null&&l.critical&&e("/error",{state:{error:o}})},[e,t]),n=w.useCallback((i,l)=>{zi.handleAuthError(i,{action:l==null?void 0:l.action});const o=i instanceof Error?i.message:String(i);t(o),e((l==null?void 0:l.redirect)||"/login")},[e,t]),s=w.useCallback((i,l)=>{zi.handleNetworkError(i,{action:l==null?void 0:l.action}),t("Network error. Please check your connection and try again."),l!=null&&l.retry&&setTimeout(l.retry,1e3)},[t]);return{handleError:r,handleAuthError:n,handleNetworkError:s}}function JU({partyId:e,isDM:t}){const{user:r}=Mt(),n=tn(),{handleError:s}=XU(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(!1),{data:h,isLoading:f,error:g}=Rt({queryKey:["partyTasks",e],queryFn:()=>YU(e),enabled:!!e}),p=kt({mutationFn:_=>QU(_,r),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]}),l(""),u(""),d(!1)},onError:_=>{s(_,{action:"creating task"})}}),b=kt({mutationFn:({taskId:_,updates:S})=>KU(_,S),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:_=>{s(_,{action:"updating task"})}}),E=kt({mutationFn:_=>ZU(_),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:_=>{s(_,{action:"deleting task"})}}),x=_=>{if(_.preventDefault(),!i.trim()){s(new Error("Task title cannot be empty."),{action:"adding task",showError:!0});return}p.mutate({party_id:e,title:i.trim(),description:o.trim()||void 0})},y=_=>{b.mutate({taskId:_.id,updates:{status:_.status==="open"?"completed":"open"}})},v=_=>{window.confirm("Are you sure you want to delete this task?")&&E.mutate(_)},k=_=>t||_.created_by_user_id===(r==null?void 0:r.id);return f?a.jsx(Ge,{}):g?a.jsx(Ie,{message:`Failed to load tasks: ${g.message}`}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Party Tasks"}),t&&a.jsx(q,{icon:c?void 0:Wt,onClick:()=>d(!c),variant:c?"secondary":"primary",children:c?"Cancel":"Add Task"})]}),t&&c&&a.jsxs("form",{onSubmit:x,className:"p-4 border rounded-lg bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"newTaskTitle",className:"block text-sm font-medium text-gray-700",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"newTaskTitle",value:i,onChange:_=>l(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g., Clear out the goblin cave",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"newTaskDescription",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),a.jsx("textarea",{id:"newTaskDescription",value:o,onChange:_=>u(_.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Any additional details about the task..."})]}),a.jsx(q,{type:"submit",loading:p.isPending,icon:Wt,children:"Add Task"})]}),h&&h.length>0?a.jsx("ul",{className:"space-y-3",children:h.map(_=>{var S;return a.jsxs("li",{className:`p-4 border rounded-lg flex items-start justify-between gap-4 ${_.status==="completed"?"bg-green-50 border-green-200":"bg-white"}`,children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{variant:"ghost",size:"icon",onClick:()=>y(_),loading:b.isPending&&((S=b.variables)==null?void 0:S.taskId)===_.id,className:_.status==="completed"?"text-green-600 hover:text-green-700":"text-gray-400 hover:text-gray-600","aria-label":_.status==="completed"?"Mark as open":"Mark as completed",children:_.status==="completed"?a.jsx(au,{size:20}):a.jsx(kA,{size:20})}),a.jsx("h3",{className:`text-lg font-medium ${_.status==="completed"?"line-through text-gray-500":""}`,children:_.title})]}),_.description&&a.jsx("p",{className:`mt-1 text-sm ${_.status==="completed"?"text-gray-400":"text-gray-600"}`,children:_.description}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Added on: ",new Date(_.created_at).toLocaleDateString(),_.completed_at&&_.status==="completed"&&a.jsxs("span",{children:[" | Completed on: ",new Date(_.completed_at).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:k(_)&&a.jsx(q,{variant:"ghost",size:"icon",onClick:()=>v(_.id),loading:E.isPending&&E.variables===_.id,className:"text-red-500 hover:text-red-700","aria-label":"Delete task",children:a.jsx(Sr,{size:18})})})]},_.id)})}):a.jsxs("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(fh,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tasks yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t?"Get started by adding a new task for your party.":"The DM hasn't added any tasks yet."}),t&&!c&&a.jsx(q,{onClick:()=>d(!0),className:"mt-4",icon:Wt,children:"Add First Task"})]})]})}function eB({partyId:e,members:t,isDM:r}){var Q;const n=tn(),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null),[d,h]=w.useState(""),[f,g]=w.useState("all"),[p,b]=w.useState(""),[E,x]=w.useState([]),[y,v]=w.useState([]),[k,_]=w.useState(!1),{data:S=[],isLoading:I,error:j}=Rt({queryKey:["gameItems"],queryFn:gh,staleTime:1e3*60*10}),D=N=>{if(N)return S.find(K=>K.name===N)};w.useEffect(()=>{T(),B()},[e]);async function T(){try{o(!0),c(null);const{data:N,error:K}=await te.from("party_inventory").select("*").eq("party_id",e);if(K)throw K;i(N||[])}catch(N){c(N instanceof Error?N.message:"Failed to load inventory"),i([])}finally{o(!1)}}async function B(){try{const{data:N,error:K}=await te.from("party_inventory_log").select("*").eq("party_id",e).order("timestamp",{ascending:!1}).limit(50);if(K)throw K;v(N||[])}catch(N){console.error("Failed to load transaction log:",N),v([])}}const O=async()=>{if(!(!p||E.length===0))try{c(null);const N=t.find(K=>K.id===p);if(!N)throw new Error("Character not found");await Promise.all(E.map(async K=>{const $=s.find(ee=>ee.id===K);if(!$||!$.name||$.quantity<1)return;let R;if($.quantity>1?{error:R}=await te.from("party_inventory").update({quantity:$.quantity-1}).eq("id",$.id):{error:R}=await te.from("party_inventory").delete().eq("id",$.id),R)throw R;const me=N.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},ce=me.inventory||[],we=D($.name);if(we){const ee=ce.findIndex(de=>de.name===we.name);if(ee>-1)ce[ee].quantity+=1;else{const de={...we,id:void 0,quantity:1,originalName:we.name};ce.push(de)}}else{console.warn(`Details not found for item: ${$.name}. Transferring with basic info.`);const ee={name:$.name,quantity:1,originalName:$.name,description:$.description,category:$.category},de=ce.findIndex(_e=>_e.name===ee.name);de>-1?ce[de].quantity+=1:ce.push(ee)}const{error:Z}=await te.from("characters").update({equipment:{...me,inventory:ce}}).eq("id",N.id);if(Z)throw Z;const{error:be}=await te.from("party_inventory_log").insert([{party_id:e,item_name:$.name,quantity:1,from_type:"party",from_id:e,to_type:"character",to_id:N.id}]);if(be)throw be})),await Promise.all([T(),B(),n.invalidateQueries({queryKey:["character",N.id]}),n.invalidateQueries({queryKey:["party",e]})]),x([])}catch(N){c(N instanceof Error?N.message:"Failed to transfer items"),await T()}},Y=async(N,K)=>{try{c(null);const $=t.find(ee=>ee.id===N);if(!$)throw new Error("Character not found");if(!K.name){console.warn("Attempted to transfer an item without a name.");return}const R=$.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}};let me=R.inventory||[];const ce=me.findIndex(ee=>ee.name===K.name);if(ce===-1){console.warn(`Item "${K.name}" not found in character ${N}'s inventory.`);return}me[ce].quantity>1?me[ce].quantity-=1:me=[...me.slice(0,ce),...me.slice(ce+1)];const{error:we}=await te.from("characters").update({equipment:{...R,inventory:me}}).eq("id",$.id);if(we)throw we;const Z=s.find(ee=>ee.name===K.name);if(Z){const{error:ee}=await te.from("party_inventory").update({quantity:Z.quantity+1}).eq("id",Z.id);if(ee)throw ee}else{const{error:ee}=await te.from("party_inventory").insert([{party_id:e,name:K.name,quantity:1,category:K.category||"misc",description:K.description||K.effect}]).select();if(ee)throw ee}const{error:be}=await te.from("party_inventory_log").insert([{party_id:e,item_name:K.name,quantity:1,from_type:"character",from_id:$.id,to_type:"party",to_id:e}]);if(be)throw be;await Promise.all([T(),B(),n.invalidateQueries({queryKey:["character",$.id]}),n.invalidateQueries({queryKey:["party",e]})])}catch($){c($ instanceof Error?$.message:"Failed to transfer item to party")}},G=s.map(N=>N.category).filter(N=>typeof N=="string"&&N.trim()!==""),z=["all",...new Set(G)],H=s.filter(N=>{const $=(N.name||"").toLowerCase().includes(d.toLowerCase()),R=f==="all"||N.category===f;return $&&R}),A=t.find(N=>N.id===p),M=((Q=A==null?void 0:A.equipment)==null?void 0:Q.inventory)??[];return a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 lg:col-span-7",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Party Inventory"}),a.jsx(q,{variant:"secondary",onClick:()=>_(!k),children:k?"Hide History":"Show History"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search items...",value:d,onChange:N=>h(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("select",{value:f,onChange:N=>g(N.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:z.map(N=>a.jsx("option",{value:N,children:N==="all"?"All Categories":N},N))})]})]}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[l?a.jsx(Ge,{}):u?a.jsx(Ie,{message:u}):H.map(N=>a.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer ${E.includes(N.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-100"}`,onClick:()=>{N.id?x(K=>K.includes(N.id)?K.filter($=>$!==N.id):[...K,N.id]):console.warn("Attempted to select an item without an ID:",N)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:N.name||"Unnamed Item"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",N.quantity]})]}),N.category&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100",children:N.category})]}),N.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:N.description})]},N.id)),!l&&H.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:d||f!=="all"?"No items found matching filters.":"Party inventory is empty."})})]})]})}),a.jsxs("div",{className:"col-span-12 lg:col-span-5",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Transfer Items"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Character"}),a.jsxs("select",{value:p,onChange:N=>b(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Choose a character..."}),t.map(N=>a.jsxs("option",{value:N.id,children:[N.name," (",N.kin," ",N.profession,")"]},N.id))]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsx(q,{variant:"secondary",icon:H0,disabled:!p||E.length===0,onClick:O,title:"Transfer selected items from Party to Character",children:"To Character"})}),p&&A&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-4",children:[A.name,"'s Inventory"]}),a.jsxs("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded p-2",children:[M.map((N,K)=>a.jsxs("div",{className:"p-2 border-b flex items-center justify-between text-sm",children:[a.jsxs("span",{children:[N.name||"Unnamed Item"," (Qty: ",N.quantity,")"]}),a.jsx(q,{variant:"secondary",size:"sm",icon:j2,onClick:()=>Y(p,N),disabled:!N.name,title:N.name?`Transfer ${N.name} to Party`:"Cannot transfer unnamed item",children:"Give"})]},N.id||`${N.name||"unknown"}-${K}`)),M.length===0&&a.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Character inventory is empty."})]})]})]}),k&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transaction History"}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[y.map(N=>{var K,$;return a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"font-medium",children:[N.item_name||"Unknown Item"," (Qty: ",N.quantity,")"]}),a.jsx("span",{className:"text-gray-500 text-xs",children:new Date(N.timestamp).toLocaleString()})]}),a.jsxs("p",{className:"text-gray-600 text-xs",children:[N.from_type==="party"?"Party":((K=t.find(R=>R.id===N.from_id))==null?void 0:K.name)||"Unknown Char","  ",N.to_type==="party"?"Party":(($=t.find(R=>R.id===N.to_id))==null?void 0:$.name)||"Unknown Char"]})]},N.id)}),y.length===0&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:"No transactions recorded yet."})]})]})]})]})}async function tB(){const{data:e,error:t}=await te.from("monsters").select("*").order("name");if(t)throw console.error("Error fetching all monsters:",t),t;return e||[]}function rB(e){const t=tn();w.useEffect(()=>{if(!e)return;const r=[],n=te.channel(`encounter:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"encounters",filter:`id=eq.${e}`},i=>{console.log("Encounter updated:",i),t.invalidateQueries({queryKey:["encounterDetails",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter channel error for ${e}:`,l)});r.push(n);const s=te.channel(`encounter_combatants:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${e}`},i=>{console.log("Encounter combatants changed:",i),t.invalidateQueries({queryKey:["encounterCombatants",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter_combatants:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter combatants channel error for ${e}:`,l)});return r.push(s),()=>{console.log(`Unsubscribing from encounter channels for ${e}`),r.forEach(i=>te.removeChannel(i))}},[e,t])}function nB({partyId:e,partyMembers:t,isDM:r}){var Wu,Ul;const n=tn(),[s,i]=w.useState(""),[l,o]=w.useState(""),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState(""),[p,b]=w.useState(""),[E,x]=w.useState(""),[y,v]=w.useState(1),[k,_]=w.useState(""),[S,I]=w.useState(""),[j,D]=w.useState({}),[T,B]=w.useState(!1),[O,Y]=w.useState(""),[G,z]=w.useState(""),[H,A]=w.useState([]),[M,Q]=w.useState(!1),[N,K]=w.useState(null),{data:$,isLoading:R,error:me}=Rt({queryKey:["allEncounters",e],queryFn:()=>tI(e),enabled:!!e}),ce=w.useMemo(()=>u||($&&$.length>0?$[0].id:null),[u,$]),{data:we,isLoading:Z,error:be}=Rt({queryKey:["encounterDetails",ce],queryFn:()=>ce?bE(ce):Promise.resolve(null),enabled:!!ce}),{data:ee,isLoading:de,error:_e}=Rt({queryKey:["encounterCombatants",ce],queryFn:()=>ce?K0(ce):Promise.resolve([]),enabled:!!ce}),{data:je,isLoading:Pe,error:Fe}=Rt({queryKey:["allMonsters"],queryFn:tB});rB(ce);const V=w.useMemo(()=>(ee==null?void 0:ee.slice().sort((U,he)=>{const Te=U.initiative_roll??-1/0,Ve=he.initiative_roll??-1/0;return Te!==Ve?Ve-Te:(U.display_name??"").localeCompare(he.display_name??"")}))||[],[ee]);w.useEffect(()=>{if(!V)return;const U={};V.forEach(he=>{U[he.id]={current_hp:String(he.current_hp??he.max_hp??0),current_wp:he.max_wp!=null?String(he.current_wp??he.max_wp??""):void 0,initiative_roll:he.initiative_roll!=null?String(he.initiative_roll):""}}),D(U)},[V]),w.useEffect(()=>{we&&(Y(we.name),z(we.description||""))},[we]);const ye=kt({mutationFn:U=>vE(e,U.name,U.description),onSuccess:U=>{n.invalidateQueries({queryKey:["allEncounters",e]}),c(U.id),i(""),o("")}}),ie=kt({mutationFn:rI,onSuccess:(U,he)=>{n.invalidateQueries({queryKey:["allEncounters",e]}),u===he&&c(null)}}),ke=kt({mutationFn:({encounterId:U,name:he})=>nI(U,he),onSuccess:U=>{n.invalidateQueries({queryKey:["allEncounters",e]}),c(U.id)}}),Le=kt({mutationFn:U=>{if(!ce)throw new Error("No active encounter");return sI(ce,U)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",ce]}),g(""),b(""),x(""),v(1),_(""),I("")}}),$e=kt({mutationFn:U=>lu(U.id,U.updates),onSuccess:U=>{n.setQueryData(["encounterCombatants",ce],he=>(he==null?void 0:he.map(Te=>Te.id===U.id?U:Te))??[])}}),tt=kt({mutationFn:aI,onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",ce]})}}),ut=kt({mutationFn:U=>{if(!ce)throw new Error("No active encounter to update");return xh(ce,U)},onSuccess:U=>{n.setQueryData(["encounterDetails",ce],U),n.invalidateQueries({queryKey:["allEncounters",e]}),B(!1)}}),jt=kt({mutationFn:U=>{if(!ce)throw new Error("No active encounter");return iI(ce,U)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",ce]}),A([])}}),Tr=kt({mutationFn:({id1:U,id2:he})=>lI(U,he),onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",ce]}),Q(!1),K(null)}}),sn=kt({mutationFn:()=>{if(!ce)throw new Error("No encounter to start");return oI(ce)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",ce]}),n.invalidateQueries({queryKey:["allEncounters",e]})}}),J=kt({mutationFn:()=>{if(!ce)throw new Error("No encounter to end");return uI(ce)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",ce]}),n.invalidateQueries({queryKey:["allEncounters",e]})}}),oe=kt({mutationFn:()=>{if(!ce)throw new Error("No encounter for next round");return cI(ce)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",ce]})}}),Se=U=>{U.preventDefault(),s.trim()&&ye.mutate({name:s.trim(),description:l.trim()||void 0})},Ue=(U,he)=>{const Te=`${he} (Copy)`;ke.mutate({encounterId:U,name:Te})},nt=U=>{c(U),h(!1)},nr=()=>{!f||!ce||Le.mutate({type:"character",characterId:f,initiativeRoll:k?parseInt(k):null})},Hr=()=>{!p||!ce||Le.mutate({type:"monster",monsterId:p,customName:E.trim()||void 0,instanceCount:y,initiativeRoll:S?parseInt(S):null})},Cr=U=>{const he=j[U],Te=V.find(Ae=>Ae.id===U);if(!he||!Te)return;const Ve={},rt=parseInt(he.current_hp,10);if(!isNaN(rt)&&rt!==Te.current_hp&&(Ve.current_hp=rt),he.initiative_roll!=null){const Ae=he.initiative_roll.trim()===""?null:parseInt(he.initiative_roll,10);(Ae===null||!isNaN(Ae))&&Ae!==Te.initiative_roll&&(Ve.initiative_roll=Ae)}if(Te.max_wp!=null&&he.current_wp!=null){const Ae=he.current_wp.trim()===""?null:parseInt(he.current_wp,10);(Ae===null||!isNaN(Ae))&&Ae!==Te.current_wp&&(Ve.current_wp=Ae)}Object.keys(Ve).length>0&&$e.mutate({id:U,updates:Ve})},zn=()=>{H.length!==0&&jt.mutate(H)},qn=U=>{M&&(N?N!==U&&Tr.mutate({id1:N,id2:U}):K(U))},zt=w.useMemo(()=>{const U=new Set(V.map(he=>he.character_id));return t.filter(he=>!U.has(he.id))},[t,V]),fr=w.useMemo(()=>je==null?void 0:je.find(U=>U.id===p),[je,p]);if(!r)return a.jsx("div",{className:"p-4 text-center text-gray-600",children:a.jsx("p",{children:"Only the DM can view and manage encounter details."})});if(R||Pe)return a.jsx(Ge,{});if(me||Fe)return a.jsx(Ie,{message:(me==null?void 0:me.message)||(Fe==null?void 0:Fe.message)||"Error loading data"});const at=we;return a.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[a.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Encounter Management"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(q,{onClick:()=>h(!d),Icon:MA,variant:"secondary",children:[d?"Hide":"Show"," Encounters (",($==null?void 0:$.length)||0,")"]}),a.jsx(q,{onClick:()=>{c(null),i(""),o("")},Icon:wd,children:"New Encounter"})]})]})}),d&&a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow space-y-3",children:[a.jsx("h3",{className:"text-xl font-semibold mb-3",children:"All Encounters"}),$&&$.length>0?$.map(U=>{var he;return a.jsxs("div",{className:`flex flex-col md:flex-row items-start md:items-center justify-between p-3 rounded-lg border ${ce===U.id?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200"}`,children:[a.jsxs("div",{className:"flex-grow mb-3 md:mb-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium",children:U.name}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${U.status==="active"?"bg-green-100 text-green-800":U.status==="planning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:U.status})]}),U.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:U.description})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(q,{size:"sm",onClick:()=>nt(U.id),disabled:ce===U.id,children:ce===U.id?"Current":"Select"}),a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>Ue(U.id,U.name),Icon:Ed,isLoading:ke.isPending&&((he=ke.variables)==null?void 0:he.encounterId)===U.id}),a.jsx(q,{size:"sm",variant:"danger",onClick:()=>ie.mutate(U.id),Icon:Sr,isLoading:ie.isPending&&ie.variables===U.id,disabled:U.status==="active"})]})]},U.id)}):a.jsx("p",{className:"text-gray-600 text-center py-4",children:"No encounters created yet."})]}),!ce&&!ye.isPending?a.jsxs("form",{onSubmit:Se,className:"bg-white p-6 rounded-lg shadow space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create New Encounter"}),a.jsx("input",{type:"text",placeholder:"Encounter Name (e.g., 'Goblin Ambush')",value:s,onChange:U=>i(U.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md"}),a.jsx("textarea",{placeholder:"Description (optional)",value:l,onChange:U=>o(U.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"}),a.jsx(q,{type:"submit",Icon:wd,isLoading:ye.isPending,children:"Create Encounter"})]}):Z||!at?a.jsx(Ge,{}):be?a.jsx(Ie,{message:be.message}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[T?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:O,onChange:U=>Y(U.target.value),className:"w-full px-3 py-2 border rounded-md text-xl font-semibold",placeholder:"Encounter Name"}),a.jsx("textarea",{value:G,onChange:U=>z(U.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md text-gray-600 mt-2",placeholder:"Description (optional)"}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(q,{size:"sm",onClick:()=>ut.mutate({name:O,description:G}),isLoading:ut.isPending,Icon:Fr,children:"Save"}),a.jsx(q,{size:"sm",variant:"secondary",onClick:()=>B(!1),Icon:dh,children:"Cancel"})]})]}):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:at.name}),at.description&&a.jsx("p",{className:"text-gray-600",children:at.description})]}),a.jsx(q,{size:"sm",variant:"ghost",onClick:()=>B(!0),Icon:$2,"aria-label":"Edit Encounter Details"})]}),a.jsxs("div",{className:"text-sm mt-2",children:["Status:"," ",a.jsx("span",{className:`font-medium ${at.status==="active"?"text-green-600":at.status==="planning"?"text-yellow-600":"text-blue-600"}`,children:at.status}),at.current_round>0&&at.status==="active"&&a.jsxs("span",{className:"ml-3",children:["Round: ",at.current_round]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[at.status==="planning"&&a.jsx(q,{onClick:()=>sn.mutate(),isLoading:sn.isPending,Icon:zA,children:"Start Encounter"}),at.status==="active"&&a.jsxs(a.Fragment,{children:[a.jsx(q,{onClick:()=>oe.mutate(),isLoading:oe.isPending,Icon:KA,children:"Next Round"}),a.jsx(q,{onClick:()=>J.mutate(),isLoading:J.isPending,Icon:G2,variant:"secondary",children:"End Encounter"})]}),at.status==="completed"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"text-gray-600 italic",children:"Encounter completed."}),a.jsx(q,{size:"sm",onClick:()=>Ue(at.id,at.name),Icon:Ed,isLoading:ke.isPending,children:"Duplicate"})]})]})]}),at.status!=="completed"&&a.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow space-y-6",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[a.jsx(xn,{className:"w-5 h-5"})," Add Combatants"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Party Member"}),a.jsxs("select",{value:f,onChange:U=>g(U.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Party Member"}),zt.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]}),a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:k,onChange:U=>_(U.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(q,{onClick:nr,Icon:mh,isLoading:Le.isPending,disabled:!f,children:"Add Member"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:p,onChange:U=>b(U.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),je==null?void 0:je.map(U=>a.jsxs("option",{value:U.id,children:[U.name," ",U.category&&`(${U.category})`]},U.id))]}),fr&&a.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-white rounded border",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"HP:"})," ",((Wu=fr.stats)==null?void 0:Wu.HP)||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Ferocity:"})," ",((Ul=fr.stats)==null?void 0:Ul.ferocity)||1]}),fr.effectsSummary&&a.jsxs("p",{children:[a.jsx("strong",{children:"Effects:"})," ",fr.effectsSummary]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:E,onChange:U=>x(U.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:y,onChange:U=>v(Math.max(1,parseInt(U.target.value)||1)),min:"1",className:"px-3 py-2 border rounded-md"})]}),a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:S,onChange:U=>I(U.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsxs(q,{onClick:Hr,Icon:QA,isLoading:Le.isPending,disabled:!p,children:["Add Monster",y>1?`s (${y})`:""]})]})]}),Le.error&&a.jsxs("p",{className:"text-red-600 text-sm mt-4 text-center",children:["Error: ",Le.error.message]})]}),at.status!=="completed"&&V.length>0&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg shadow space-y-4",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[a.jsx(mf,{className:"w-5 h-5"})," Initiative Management"]}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"selectAll",checked:H.length===V.length&&V.length>0,onChange:U=>A(U.target.checked?V.map(he=>he.id):[])}),a.jsx("label",{htmlFor:"selectAll",className:"text-sm font-medium",children:"Select All"})]}),a.jsxs(q,{size:"sm",onClick:zn,Icon:mf,isLoading:jt.isPending,disabled:H.length===0,children:["Roll Initiative (",H.length,")"]}),a.jsx(q,{size:"sm",variant:M?"danger":"secondary",onClick:()=>{Q(!M),K(null)},Icon:vA,children:M?"Cancel Swap":"Swap Initiative"})]}),M&&a.jsx("p",{className:"text-sm text-blue-700",children:N?"Click another combatant to swap initiative values.":"Click a combatant to start swapping initiative."})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-medium mb-4 flex items-center gap-2",children:[a.jsx(xn,{className:"w-5 h-5"})," Combatants ",V.length>0&&`(${V.length})`]}),de?a.jsx(Ge,{}):_e?a.jsx(Ie,{message:_e.message}):V.length===0?a.jsx("p",{className:"text-gray-600 text-center py-8",children:"No combatants added yet. Add them above to begin."}):a.jsx("ul",{className:"space-y-3",children:V.map(U=>{var he,Te,Ve,rt;return a.jsx("li",{className:`p-4 rounded-lg shadow border-l-4 transition-all ${U.is_player_character?"bg-blue-50 border-blue-500":"bg-red-50 border-red-500"} ${M?"cursor-pointer hover:bg-opacity-80":""} ${N===U.id?"ring-2 ring-offset-2 ring-blue-500":""}`,onClick:()=>qn(U.id),children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-grow",children:[at.status!=="completed"&&a.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded","aria-label":`Select ${U.display_name} for initiative roll`,checked:H.includes(U.id),onChange:Ae=>{Ae.target.checked?A(st=>[...st,U.id]):A(st=>st.filter(va=>va!==U.id))},onClick:Ae=>Ae.stopPropagation()}),a.jsx("div",{className:"text-center font-bold text-lg w-8",children:U.initiative_roll??"-"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:U.display_name}),a.jsx("p",{className:"text-xs text-gray-500",children:U.is_player_character?"Player Character":"Monster"})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",onClick:Ae=>Ae.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(V0,{className:"w-4 h-4 text-red-500",title:"Health Points"}),a.jsx("input",{type:"number","aria-label":`${U.display_name} Current HP`,value:((he=j[U.id])==null?void 0:he.current_hp)??"",onChange:Ae=>D(st=>({...st,[U.id]:{...st[U.id],current_hp:Ae.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"HP"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",U.max_hp]})]}),U.max_wp!=null&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Fn,{className:"w-4 h-4 text-yellow-500",title:"Willpower"}),a.jsx("input",{type:"number","aria-label":`${U.display_name} Current WP`,value:((Te=j[U.id])==null?void 0:Te.current_wp)??"",onChange:Ae=>D(st=>({...st,[U.id]:{...st[U.id],current_wp:Ae.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"WP"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",U.max_wp]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(mf,{className:"w-4 h-4 text-gray-500",title:"Initiative"}),a.jsx("input",{type:"number","aria-label":`${U.display_name} Initiative`,value:((Ve=j[U.id])==null?void 0:Ve.initiative_roll)??"",onChange:Ae=>D(st=>({...st,[U.id]:{...st[U.id],initiative_roll:Ae.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"Init"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{size:"sm",onClick:()=>Cr(U.id),Icon:Fr,isLoading:$e.isPending&&((rt=$e.variables)==null?void 0:rt.id)===U.id,"aria-label":`Save stats for ${U.display_name}`}),a.jsx(q,{size:"sm",variant:"danger",onClick:()=>tt.mutate(U.id),Icon:Sr,isLoading:tt.isPending&&tt.variables===U.id,"aria-label":`Remove ${U.display_name}`})]})]})]})},U.id)})})]})]})]})}const $N=w.createContext(void 0);function zN(){const e=w.useContext($N);if(!e)throw new Error("useDropdown must be used within a DropdownMenu");return e}function sB({children:e}){const[t,r]=w.useState(!1),n=w.useRef(null);return w.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&r(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),a.jsx($N.Provider,{value:{isOpen:t,setIsOpen:r},children:a.jsx("div",{className:"relative inline-block text-left",ref:n,children:e})})}function aB({children:e}){const{isOpen:t,setIsOpen:r}=zN();return a.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),r(s=>!s)},className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-expanded":t,"aria-haspopup":"true",children:e||a.jsx(D2,{className:"w-5 h-5"})})}function iB({children:e}){const{isOpen:t,setIsOpen:r}=zN();return t?a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",children:a.jsx("div",{className:"py-1",role:"none",onClick:()=>r(!1),children:e})}):null}function c1({onSelect:e,children:t,className:r}){return a.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),e()},className:`flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 ${r}`,role:"menuitem",children:t})}function lB(){return a.jsx("div",{className:"border-t border-gray-100 my-1"})}function oB(){const{id:e}=P0(),t=rn(),{user:r,isDM:n}=Mt(),s=tn(),[i,l]=w.useState(!1),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState("members"),{data:g,isLoading:p,error:b}=Rt({queryKey:["party",e],queryFn:()=>z7(e),enabled:!!e}),E=kt({mutationFn:j=>{if(!e)throw new Error("Party ID is missing");return q7(e,j)},onSuccess:()=>{s.invalidateQueries({queryKey:["party",e]}),s.invalidateQueries({queryKey:["availableCharacters"]}),u(null),d(null)}}),x=kt({mutationFn:()=>{if(!e)throw new Error("Party ID is missing");return V7(e)},onSuccess:()=>{s.invalidateQueries({queryKey:["parties"]}),t("/adventure-party")}}),y=j=>{d(j),u("removeMember")},v=()=>{c&&E.mutate(c)},k=()=>{x.mutate()},_=r&&g&&r.id===g.created_by&&n(),S=`${window.location.origin}/party/join/${e}`;if(p)return a.jsx("div",{className:"flex justify-center items-center p-8",children:a.jsx(Ge,{size:"lg"})});if(b)return a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:b.message})});if(!g)return a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:"Party not found."})});const I=[{id:"members",label:"Members",icon:xn},{id:"notes",label:"Notes",icon:$A},{id:"tasks",label:"Tasks",icon:SA},{id:"inventory",label:"Inventory",icon:I2},{id:"encounter",label:"Encounter",icon:Y0}];return a.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[a.jsxs("div",{className:"bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:g.name}),a.jsx("p",{className:"text-gray-500 mt-1",children:"A band of brave adventurers."})]}),_&&a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsxs(sB,{children:[a.jsx(aB,{children:a.jsx(q,{variant:"outline",size:"icon","aria-label":"Party Actions",children:a.jsx(D2,{className:"h-5 w-5"})})}),a.jsxs(iB,{children:[a.jsxs(c1,{onSelect:()=>l(j=>!j),children:[a.jsx(mh,{className:"w-4 h-4"}),"Invite Player"]}),a.jsx(lB,{}),a.jsxs(c1,{onSelect:()=>u("deleteParty"),className:"text-red-500 hover:text-red-700 hover:bg-red-50 focus:bg-red-50",children:[a.jsx(Sr,{className:"w-4 h-4"}),"Delete Party"]})]})]})})]}),i&&_&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800",children:"Share this link to invite players:"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-white p-2 rounded-md",children:[a.jsx("input",{type:"text",readOnly:!0,value:S,className:"w-full bg-transparent text-gray-700 focus:outline-none"}),a.jsx(WU,{textToCopy:S})]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-6 px-6","aria-label":"Tabs",children:I.map(j=>a.jsxs("button",{onClick:()=>f(j.id),className:`shrink-0 flex items-center gap-2 px-1 py-4 text-sm font-medium border-b-2 ${h===j.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(j.icon,{className:"w-5 h-5"}),j.label]},j.id))})}),a.jsxs("div",{className:"p-6",children:[h==="members"&&a.jsx("div",{className:"space-y-4",children:g.members.length>0?g.members.map(j=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-2 bg-gray-200 rounded-full",children:a.jsx(Ja,{className:"w-6 h-6 text-gray-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.kin," ",j.profession]})]})]}),_&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(q,{variant:"outline",size:"sm",onClick:()=>t(`/character/${j.id}`),"aria-label":`View ${j.name}'s sheet`,icon:AA,children:"View Sheet"}),a.jsx(q,{variant:"ghost",size:"icon",onClick:()=>y(j.id),"aria-label":`Remove ${j.name}`,children:a.jsx(Ey,{className:"w-5 h-5 text-red-500"})})]})]},j.id)):a.jsx("p",{className:"text-center text-gray-500 py-8",children:"This party has no members yet. Invite someone!"})}),h==="notes"&&a.jsx(GU,{partyId:e,isDM:_}),h==="tasks"&&a.jsx(JU,{partyId:e,isDM:_}),h==="inventory"&&a.jsx(eB,{partyId:e,members:g.members,isDM:_}),h==="encounter"&&a.jsx(nB,{partyId:e,partyMembers:g.members,isDM:_})]})]}),a.jsx(hp,{isOpen:o==="removeMember",onClose:()=>u(null),onConfirm:v,title:"Remove Member",description:"Are you sure you want to remove this character from the party? This action cannot be undone.",confirmText:"Remove",isDestructive:!0,isLoading:E.isPending,icon:a.jsx(Ey,{className:"w-6 h-6 text-red-500"})}),a.jsx(hp,{isOpen:o==="deleteParty",onClose:()=>u(null),onConfirm:k,title:"Delete Party",description:"Are you sure you want to permanently delete this party? All members will be removed. This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:x.isPending,icon:a.jsx(V2,{className:"w-6 h-6 text-red-500"})})]})}function uB(){var g;const{inviteCode:e}=P0(),t=rn(),{user:r}=Mt(),n=tn(),[s,i]=w.useState(""),{data:l=[],isLoading:o,error:u}=Rt({queryKey:["availableCharacters",r==null?void 0:r.id],queryFn:()=>kN(r==null?void 0:r.id),enabled:!!r}),c=kt({mutationFn:async p=>{if(!p)throw new Error("Please select a character");if(!e)throw new Error("Invite code is missing");const{data:b,error:E}=await te.rpc("join_party_with_character",{p_invite_code:e,p_character_id:p});if(E)throw E.message.includes("invalid_invite_code")?new Error("This invite link is invalid or has expired."):E.message.includes("character_already_in_a_party")?new Error("This character is already in a party."):E.message.includes("user_already_in_party")?new Error("You are already a member of this party."):E;return b},onSuccess:p=>{const b=p==null?void 0:p.party_id;b?(n.invalidateQueries({queryKey:["parties"]}),n.invalidateQueries({queryKey:["party",b]}),n.invalidateQueries({queryKey:["availableCharacters",r==null?void 0:r.id]}),t(`/party/${b}`)):t("/adventure-party")}}),d=()=>{s&&c.mutate(s)},h=o,f=(u==null?void 0:u.message)||((g=c.error)==null?void 0:g.message);return h?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsx(Ge,{size:"lg"})}):f?a.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[a.jsx(Ie,{message:f}),a.jsx(q,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(xn,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Join an Adventure"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"You've been invited to join a new party!"})]}),l.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-center text-gray-700",children:"Select one of your available characters to join with."}),a.jsx("div",{className:"space-y-3",children:l.map(p=>a.jsxs("div",{onClick:()=>i(p.id),className:`p-4 border rounded-lg cursor-pointer transition-all flex items-center justify-between ${s===p.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-500":"border-gray-200 hover:border-blue-400"}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:p.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[p.kin," ",p.profession]})]}),s===p.id&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx(Hi,{className:"w-4 h-4 text-white"})})]},p.id))}),a.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[a.jsx(q,{variant:"secondary",onClick:()=>t("/adventure-party"),children:"Cancel"}),a.jsx(q,{variant:"primary",loading:c.isPending,disabled:!s||c.isPending,onClick:d,children:"Join with Selected Character"})]})]}):a.jsxs("div",{className:"text-center py-8 border-t mt-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any available characters to join with."}),a.jsx(q,{variant:"primary",onClick:()=>t("/"),children:"Create a Character"})]})]})})}function cB(){return a.jsxs(a.Fragment,{children:[" ",a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-white focus:text-blue-600",children:"Skip to main content"}),a.jsxs(Yx,{children:[a.jsx($r,{path:"/login",element:a.jsx($U,{})}),a.jsx($r,{path:"*",element:a.jsx(VU,{children:a.jsxs(a.Fragment,{children:[a.jsx(h4,{}),a.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:a.jsxs(Yx,{children:[a.jsx($r,{path:"/",element:a.jsx(J6,{})}),a.jsx($r,{path:"/character/:id",element:a.jsx(qI,{})}),a.jsx($r,{path:"/compendium",element:a.jsx(H7,{})}),a.jsx($r,{path:"/adventure-party",element:a.jsx(W7,{})}),a.jsx($r,{path:"/party/:id",element:a.jsx(oB,{})}),a.jsx($r,{path:"/party/join/:inviteCode",element:a.jsx(uB,{})}),a.jsx($r,{path:"/notes",element:a.jsx(G7,{})}),a.jsx($r,{path:"/settings",element:a.jsx(HU,{})}),a.jsx($r,{path:"*",element:a.jsx(ko,{to:"/",replace:!0})})]})}),a.jsx(qU,{})]})})})]})]})}function dB(){const{showWarning:e,extendSession:t}=o4();return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-amber-100 rounded-full",children:a.jsx(hh,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Session Timeout Warning"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your session will expire in 30 seconds due to inactivity."})]})]}),a.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Nt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-amber-700",children:'Click "Continue Session" to stay logged in, or your session will end automatically.'})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx(q,{variant:"primary",onClick:t,children:"Continue Session"})})]})}):null}function hB(){return a.jsx(KC,{children:a.jsx(u4,{children:a.jsxs(Vw,{client:J2,children:[a.jsx(t4,{children:a.jsx(a4,{children:a.jsx(l4,{children:a.jsx(d4,{children:a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(cB,{}),a.jsx(dB,{})]})})})})}),!1]})})})}Lw(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsxs(Vw,{client:J2,children:[" ",a.jsx(hB,{})]})}));export{Ud as g};
