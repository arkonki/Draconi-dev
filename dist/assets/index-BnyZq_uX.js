var C_=Object.defineProperty;var Jg=e=>{throw TypeError(e)};var j_=(e,t,r)=>t in e?C_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var bc=(e,t,r)=>j_(e,typeof t!="symbol"?t+"":t,r),nf=(e,t,r)=>t.has(e)||Jg("Cannot "+r);var F=(e,t,r)=>(nf(e,t,"read from private field"),r?r.call(e):t.get(e)),ke=(e,t,r)=>t.has(e)?Jg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),xe=(e,t,r,n)=>(nf(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Be=(e,t,r)=>(nf(e,t,"access private method"),r);var vc=(e,t,r,n)=>({set _(s){xe(e,t,s,r)},get _(){return F(e,t,n)}});function A_(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function I_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var uv={exports:{}},uh={},cv={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ku=Symbol.for("react.element"),R_=Symbol.for("react.portal"),L_=Symbol.for("react.fragment"),O_=Symbol.for("react.strict_mode"),P_=Symbol.for("react.profiler"),D_=Symbol.for("react.provider"),M_=Symbol.for("react.context"),F_=Symbol.for("react.forward_ref"),B_=Symbol.for("react.suspense"),U_=Symbol.for("react.memo"),H_=Symbol.for("react.lazy"),ex=Symbol.iterator;function $_(e){return e===null||typeof e!="object"?null:(e=ex&&e[ex]||e["@@iterator"],typeof e=="function"?e:null)}var dv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hv=Object.assign,fv={};function $l(e,t,r){this.props=e,this.context=t,this.refs=fv,this.updater=r||dv}$l.prototype.isReactComponent={};$l.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function mv(){}mv.prototype=$l.prototype;function u0(e,t,r){this.props=e,this.context=t,this.refs=fv,this.updater=r||dv}var c0=u0.prototype=new mv;c0.constructor=u0;hv(c0,$l.prototype);c0.isPureReactComponent=!0;var tx=Array.isArray,pv=Object.prototype.hasOwnProperty,d0={current:null},gv={key:!0,ref:!0,__self:!0,__source:!0};function xv(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)pv.call(t,n)&&!gv.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Ku,type:e,key:i,ref:l,props:s,_owner:d0.current}}function z_(e,t){return{$$typeof:Ku,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function h0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ku}function q_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var rx=/\/+/g;function sf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?q_(""+e.key):t.toString(36)}function Jc(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ku:case R_:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+sf(l,0):n,tx(s)?(r="",e!=null&&(r=e.replace(rx,"$&/")+"/"),Jc(s,t,r,"",function(c){return c})):s!=null&&(h0(s)&&(s=z_(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(rx,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",tx(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+sf(i,o);l+=Jc(i,t,r,u,s)}else if(u=$_(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+sf(i,o++),l+=Jc(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function wc(e,t,r){if(e==null)return e;var n=[],s=0;return Jc(e,n,"","",function(i){return t.call(r,i,s++)}),n}function V_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Er={current:null},ed={transition:null},W_={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:ed,ReactCurrentOwner:d0};function yv(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:wc,forEach:function(e,t,r){wc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return wc(e,function(){t++}),t},toArray:function(e){return wc(e,function(t){return t})||[]},only:function(e){if(!h0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=$l;qe.Fragment=L_;qe.Profiler=P_;qe.PureComponent=u0;qe.StrictMode=O_;qe.Suspense=B_;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W_;qe.act=yv;qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=hv({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=d0.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)pv.call(t,u)&&!gv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Ku,type:e.type,key:s,ref:i,props:n,_owner:l}};qe.createContext=function(e){return e={$$typeof:M_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:D_,_context:e},e.Consumer=e};qe.createElement=xv;qe.createFactory=function(e){var t=xv.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:F_,render:e}};qe.isValidElement=h0;qe.lazy=function(e){return{$$typeof:H_,_payload:{_status:-1,_result:e},_init:V_}};qe.memo=function(e,t){return{$$typeof:U_,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=ed.transition;ed.transition={};try{e()}finally{ed.transition=t}};qe.unstable_act=yv;qe.useCallback=function(e,t){return Er.current.useCallback(e,t)};qe.useContext=function(e){return Er.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return Er.current.useDeferredValue(e)};qe.useEffect=function(e,t){return Er.current.useEffect(e,t)};qe.useId=function(){return Er.current.useId()};qe.useImperativeHandle=function(e,t,r){return Er.current.useImperativeHandle(e,t,r)};qe.useInsertionEffect=function(e,t){return Er.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return Er.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return Er.current.useMemo(e,t)};qe.useReducer=function(e,t,r){return Er.current.useReducer(e,t,r)};qe.useRef=function(e){return Er.current.useRef(e)};qe.useState=function(e){return Er.current.useState(e)};qe.useSyncExternalStore=function(e,t,r){return Er.current.useSyncExternalStore(e,t,r)};qe.useTransition=function(){return Er.current.useTransition()};qe.version="18.3.1";cv.exports=qe;var w=cv.exports;const Sn=oh(w),G_=A_({__proto__:null,default:Sn},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_=w,Q_=Symbol.for("react.element"),K_=Symbol.for("react.fragment"),Z_=Object.prototype.hasOwnProperty,X_=Y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J_={key:!0,ref:!0,__self:!0,__source:!0};function bv(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Z_.call(t,n)&&!J_.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Q_,type:e,key:i,ref:l,props:s,_owner:X_.current}}uh.Fragment=K_;uh.jsx=bv;uh.jsxs=bv;uv.exports=uh;var a=uv.exports,vv={exports:{}},Yr={},wv={exports:{}},Ev={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,Z){var N=O.length;O.push(Z);e:for(;0<N;){var z=N-1>>>1,U=O[z];if(0<s(U,Z))O[z]=Z,O[N]=U,N=z;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var Z=O[0],N=O.pop();if(N!==Z){O[0]=N;e:for(var z=0,U=O.length,j=U>>>1;z<j;){var me=2*(z+1)-1,X=O[me],W=me+1,q=O[W];if(0>s(X,N))W<U&&0>s(q,X)?(O[z]=q,O[W]=N,z=W):(O[z]=X,O[me]=N,z=me);else if(W<U&&0>s(q,N))O[z]=q,O[W]=N,z=W;else break e}}return Z}function s(O,Z){var N=O.sortIndex-Z.sortIndex;return N!==0?N:O.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],d=1,h=null,f=3,g=!1,p=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(O){for(var Z=r(c);Z!==null;){if(Z.callback===null)n(c);else if(Z.startTime<=O)n(c),Z.sortIndex=Z.expirationTime,t(u,Z);else break;Z=r(c)}}function _(O){if(y=!1,E(O),!p)if(r(u)!==null)p=!0,V(k);else{var Z=r(c);Z!==null&&K(_,Z.startTime-O)}}function k(O,Z){p=!1,y&&(y=!1,x(A),A=-1),g=!0;var N=f;try{for(E(Z),h=r(u);h!==null&&(!(h.expirationTime>Z)||O&&!H());){var z=h.callback;if(typeof z=="function"){h.callback=null,f=h.priorityLevel;var U=z(h.expirationTime<=Z);Z=e.unstable_now(),typeof U=="function"?h.callback=U:h===r(u)&&n(u),E(Z)}else n(u);h=r(u)}if(h!==null)var j=!0;else{var me=r(c);me!==null&&K(_,me.startTime-Z),j=!1}return j}finally{h=null,f=N,g=!1}}var S=!1,I=null,A=-1,D=5,T=-1;function H(){return!(e.unstable_now()-T<D)}function L(){if(I!==null){var O=e.unstable_now();T=O;var Z=!0;try{Z=I(!0,O)}finally{Z?G():(S=!1,I=null)}}else S=!1}var G;if(typeof b=="function")G=function(){b(L)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,$=Q.port2;Q.port1.onmessage=L,G=function(){$.postMessage(null)}}else G=function(){v(L,0)};function V(O){I=O,S||(S=!0,G())}function K(O,Z){A=v(function(){O(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){p||g||(p=!0,V(k))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(O){switch(f){case 1:case 2:case 3:var Z=3;break;default:Z=f}var N=f;f=Z;try{return O()}finally{f=N}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,Z){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var N=f;f=O;try{return Z()}finally{f=N}},e.unstable_scheduleCallback=function(O,Z,N){var z=e.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?z+N:z):N=z,O){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=N+U,O={id:d++,callback:Z,priorityLevel:O,startTime:N,expirationTime:U,sortIndex:-1},N>z?(O.sortIndex=N,t(c,O),r(u)===null&&O===r(c)&&(y?(x(A),A=-1):y=!0,K(_,N-z))):(O.sortIndex=U,t(u,O),p||g||(p=!0,V(k))),O},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(O){var Z=f;return function(){var N=f;f=Z;try{return O.apply(this,arguments)}finally{f=N}}}})(Ev);wv.exports=Ev;var eS=wv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tS=w,Gr=eS;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nv=new Set,au={};function vi(e,t){Sl(e,t),Sl(e+"Capture",t)}function Sl(e,t){for(au[e]=t,e=0;e<t.length;e++)Nv.add(t[e])}var bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bm=Object.prototype.hasOwnProperty,rS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nx={},sx={};function nS(e){return bm.call(sx,e)?!0:bm.call(nx,e)?!1:rS.test(e)?sx[e]=!0:(nx[e]=!0,!1)}function sS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aS(e,t,r,n){if(t===null||typeof t>"u"||sS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Nr(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){er[e]=new Nr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];er[t]=new Nr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){er[e]=new Nr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){er[e]=new Nr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){er[e]=new Nr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){er[e]=new Nr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){er[e]=new Nr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){er[e]=new Nr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){er[e]=new Nr(e,5,!1,e.toLowerCase(),null,!1,!1)});var f0=/[\-:]([a-z])/g;function m0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(f0,m0);er[t]=new Nr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(f0,m0);er[t]=new Nr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(f0,m0);er[t]=new Nr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){er[e]=new Nr(e,1,!1,e.toLowerCase(),null,!1,!1)});er.xlinkHref=new Nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){er[e]=new Nr(e,1,!1,e.toLowerCase(),null,!0,!0)});function p0(e,t,r,n){var s=er.hasOwnProperty(t)?er[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aS(t,r,s,n)&&(r=null),n||s===null?nS(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ss=tS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ec=Symbol.for("react.element"),Bi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),g0=Symbol.for("react.strict_mode"),vm=Symbol.for("react.profiler"),kv=Symbol.for("react.provider"),_v=Symbol.for("react.context"),x0=Symbol.for("react.forward_ref"),wm=Symbol.for("react.suspense"),Em=Symbol.for("react.suspense_list"),y0=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),Sv=Symbol.for("react.offscreen"),ax=Symbol.iterator;function lo(e){return e===null||typeof e!="object"?null:(e=ax&&e[ax]||e["@@iterator"],typeof e=="function"?e:null)}var St=Object.assign,af;function So(e){if(af===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);af=t&&t[1]||""}return`
`+af+e}var lf=!1;function of(e,t){if(!e||lf)return"";lf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{lf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?So(e):""}function iS(e){switch(e.tag){case 5:return So(e.type);case 16:return So("Lazy");case 13:return So("Suspense");case 19:return So("SuspenseList");case 0:case 2:case 15:return e=of(e.type,!1),e;case 11:return e=of(e.type.render,!1),e;case 1:return e=of(e.type,!0),e;default:return""}}function Nm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ui:return"Fragment";case Bi:return"Portal";case vm:return"Profiler";case g0:return"StrictMode";case wm:return"Suspense";case Em:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _v:return(e.displayName||"Context")+".Consumer";case kv:return(e._context.displayName||"Context")+".Provider";case x0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case y0:return t=e.displayName||null,t!==null?t:Nm(e.type)||"Memo";case $s:t=e._payload,e=e._init;try{return Nm(e(t))}catch{}}return null}function lS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nm(t);case 8:return t===g0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ba(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Tv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oS(e){var t=Tv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nc(e){e._valueTracker||(e._valueTracker=oS(e))}function Cv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Tv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function xd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function km(e,t){var r=t.checked;return St({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ix(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ba(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jv(e,t){t=t.checked,t!=null&&p0(e,"checked",t,!1)}function _m(e,t){jv(e,t);var r=ba(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Sm(e,t.type,r):t.hasOwnProperty("defaultValue")&&Sm(e,t.type,ba(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lx(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Sm(e,t,r){(t!=="number"||xd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var To=Array.isArray;function Ji(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ba(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Tm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return St({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ox(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(oe(92));if(To(r)){if(1<r.length)throw Error(oe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ba(r)}}function Av(e,t){var r=ba(t.value),n=ba(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ux(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Iv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Iv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var kc,Rv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(kc=kc||document.createElement("div"),kc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=kc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function iu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Do={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uS=["Webkit","ms","Moz","O"];Object.keys(Do).forEach(function(e){uS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Do[t]=Do[e]})});function Lv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Do.hasOwnProperty(e)&&Do[e]?(""+t).trim():t+"px"}function Ov(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Lv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var cS=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jm(e,t){if(t){if(cS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function Am(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Im=null;function b0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Rm=null,el=null,tl=null;function cx(e){if(e=Ju(e)){if(typeof Rm!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=mh(t),Rm(e.stateNode,e.type,t))}}function Pv(e){el?tl?tl.push(e):tl=[e]:el=e}function Dv(){if(el){var e=el,t=tl;if(tl=el=null,cx(e),t)for(e=0;e<t.length;e++)cx(t[e])}}function Mv(e,t){return e(t)}function Fv(){}var uf=!1;function Bv(e,t,r){if(uf)return e(t,r);uf=!0;try{return Mv(e,t,r)}finally{uf=!1,(el!==null||tl!==null)&&(Fv(),Dv())}}function lu(e,t){var r=e.stateNode;if(r===null)return null;var n=mh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(oe(231,t,typeof r));return r}var Lm=!1;if(bs)try{var oo={};Object.defineProperty(oo,"passive",{get:function(){Lm=!0}}),window.addEventListener("test",oo,oo),window.removeEventListener("test",oo,oo)}catch{Lm=!1}function dS(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Mo=!1,yd=null,bd=!1,Om=null,hS={onError:function(e){Mo=!0,yd=e}};function fS(e,t,r,n,s,i,l,o,u){Mo=!1,yd=null,dS.apply(hS,arguments)}function mS(e,t,r,n,s,i,l,o,u){if(fS.apply(this,arguments),Mo){if(Mo){var c=yd;Mo=!1,yd=null}else throw Error(oe(198));bd||(bd=!0,Om=c)}}function wi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Uv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dx(e){if(wi(e)!==e)throw Error(oe(188))}function pS(e){var t=e.alternate;if(!t){if(t=wi(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return dx(s),e;if(i===n)return dx(s),t;i=i.sibling}throw Error(oe(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(oe(189))}}if(r.alternate!==n)throw Error(oe(190))}if(r.tag!==3)throw Error(oe(188));return r.stateNode.current===r?e:t}function Hv(e){return e=pS(e),e!==null?$v(e):null}function $v(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=$v(e);if(t!==null)return t;e=e.sibling}return null}var zv=Gr.unstable_scheduleCallback,hx=Gr.unstable_cancelCallback,gS=Gr.unstable_shouldYield,xS=Gr.unstable_requestPaint,It=Gr.unstable_now,yS=Gr.unstable_getCurrentPriorityLevel,v0=Gr.unstable_ImmediatePriority,qv=Gr.unstable_UserBlockingPriority,vd=Gr.unstable_NormalPriority,bS=Gr.unstable_LowPriority,Vv=Gr.unstable_IdlePriority,ch=null,Yn=null;function vS(e){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(ch,e,void 0,(e.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:NS,wS=Math.log,ES=Math.LN2;function NS(e){return e>>>=0,e===0?32:31-(wS(e)/ES|0)|0}var _c=64,Sc=4194304;function Co(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=Co(o):(i&=l,i!==0&&(n=Co(i)))}else l=r&~s,l!==0?n=Co(l):i!==0&&(n=Co(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Tn(t),s=1<<r,n|=e[r],t&=~s;return n}function kS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _S(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Tn(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=kS(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function Pm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Wv(){var e=_c;return _c<<=1,!(_c&4194240)&&(_c=64),e}function cf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Zu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tn(t),e[t]=r}function SS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Tn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function w0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Tn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var it=0;function Gv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Yv,E0,Qv,Kv,Zv,Dm=!1,Tc=[],ca=null,da=null,ha=null,ou=new Map,uu=new Map,Gs=[],TS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fx(e,t){switch(e){case"focusin":case"focusout":ca=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":ha=null;break;case"pointerover":case"pointerout":ou.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":uu.delete(t.pointerId)}}function uo(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ju(t),t!==null&&E0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function CS(e,t,r,n,s){switch(t){case"focusin":return ca=uo(ca,e,t,r,n,s),!0;case"dragenter":return da=uo(da,e,t,r,n,s),!0;case"mouseover":return ha=uo(ha,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ou.set(i,uo(ou.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,uu.set(i,uo(uu.get(i)||null,e,t,r,n,s)),!0}return!1}function Xv(e){var t=za(e.target);if(t!==null){var r=wi(t);if(r!==null){if(t=r.tag,t===13){if(t=Uv(r),t!==null){e.blockedOn=t,Zv(e.priority,function(){Qv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function td(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Mm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Im=n,r.target.dispatchEvent(n),Im=null}else return t=Ju(r),t!==null&&E0(t),e.blockedOn=r,!1;t.shift()}return!0}function mx(e,t,r){td(e)&&r.delete(t)}function jS(){Dm=!1,ca!==null&&td(ca)&&(ca=null),da!==null&&td(da)&&(da=null),ha!==null&&td(ha)&&(ha=null),ou.forEach(mx),uu.forEach(mx)}function co(e,t){e.blockedOn===t&&(e.blockedOn=null,Dm||(Dm=!0,Gr.unstable_scheduleCallback(Gr.unstable_NormalPriority,jS)))}function cu(e){function t(s){return co(s,e)}if(0<Tc.length){co(Tc[0],e);for(var r=1;r<Tc.length;r++){var n=Tc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ca!==null&&co(ca,e),da!==null&&co(da,e),ha!==null&&co(ha,e),ou.forEach(t),uu.forEach(t),r=0;r<Gs.length;r++)n=Gs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Gs.length&&(r=Gs[0],r.blockedOn===null);)Xv(r),r.blockedOn===null&&Gs.shift()}var rl=Ss.ReactCurrentBatchConfig,Ed=!0;function AS(e,t,r,n){var s=it,i=rl.transition;rl.transition=null;try{it=1,N0(e,t,r,n)}finally{it=s,rl.transition=i}}function IS(e,t,r,n){var s=it,i=rl.transition;rl.transition=null;try{it=4,N0(e,t,r,n)}finally{it=s,rl.transition=i}}function N0(e,t,r,n){if(Ed){var s=Mm(e,t,r,n);if(s===null)vf(e,t,n,Nd,r),fx(e,n);else if(CS(s,e,t,r,n))n.stopPropagation();else if(fx(e,n),t&4&&-1<TS.indexOf(e)){for(;s!==null;){var i=Ju(s);if(i!==null&&Yv(i),i=Mm(e,t,r,n),i===null&&vf(e,t,n,Nd,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else vf(e,t,n,null,r)}}var Nd=null;function Mm(e,t,r,n){if(Nd=null,e=b0(n),e=za(e),e!==null)if(t=wi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Uv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Nd=e,null}function Jv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yS()){case v0:return 1;case qv:return 4;case vd:case bS:return 16;case Vv:return 536870912;default:return 16}default:return 16}}var ia=null,k0=null,rd=null;function ew(){if(rd)return rd;var e,t=k0,r=t.length,n,s="value"in ia?ia.value:ia.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return rd=s.slice(e,1<n?1-n:void 0)}function nd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cc(){return!0}function px(){return!1}function Qr(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cc:px,this.isPropagationStopped=px,this}return St(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cc)},persist:function(){},isPersistent:Cc}),t}var zl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_0=Qr(zl),Xu=St({},zl,{view:0,detail:0}),RS=Qr(Xu),df,hf,ho,dh=St({},Xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:S0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ho&&(ho&&e.type==="mousemove"?(df=e.screenX-ho.screenX,hf=e.screenY-ho.screenY):hf=df=0,ho=e),df)},movementY:function(e){return"movementY"in e?e.movementY:hf}}),gx=Qr(dh),LS=St({},dh,{dataTransfer:0}),OS=Qr(LS),PS=St({},Xu,{relatedTarget:0}),ff=Qr(PS),DS=St({},zl,{animationName:0,elapsedTime:0,pseudoElement:0}),MS=Qr(DS),FS=St({},zl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),BS=Qr(FS),US=St({},zl,{data:0}),xx=Qr(US),HS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$S={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zS[e])?!!t[e]:!1}function S0(){return qS}var VS=St({},Xu,{key:function(e){if(e.key){var t=HS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=nd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?$S[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:S0,charCode:function(e){return e.type==="keypress"?nd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?nd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WS=Qr(VS),GS=St({},dh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yx=Qr(GS),YS=St({},Xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:S0}),QS=Qr(YS),KS=St({},zl,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZS=Qr(KS),XS=St({},dh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),JS=Qr(XS),eT=[9,13,27,32],T0=bs&&"CompositionEvent"in window,Fo=null;bs&&"documentMode"in document&&(Fo=document.documentMode);var tT=bs&&"TextEvent"in window&&!Fo,tw=bs&&(!T0||Fo&&8<Fo&&11>=Fo),bx=" ",vx=!1;function rw(e,t){switch(e){case"keyup":return eT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hi=!1;function rT(e,t){switch(e){case"compositionend":return nw(t);case"keypress":return t.which!==32?null:(vx=!0,bx);case"textInput":return e=t.data,e===bx&&vx?null:e;default:return null}}function nT(e,t){if(Hi)return e==="compositionend"||!T0&&rw(e,t)?(e=ew(),rd=k0=ia=null,Hi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return tw&&t.locale!=="ko"?null:t.data;default:return null}}var sT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sT[e.type]:t==="textarea"}function sw(e,t,r,n){Pv(n),t=kd(t,"onChange"),0<t.length&&(r=new _0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Bo=null,du=null;function aT(e){pw(e,0)}function hh(e){var t=qi(e);if(Cv(t))return e}function iT(e,t){if(e==="change")return t}var aw=!1;if(bs){var mf;if(bs){var pf="oninput"in document;if(!pf){var Ex=document.createElement("div");Ex.setAttribute("oninput","return;"),pf=typeof Ex.oninput=="function"}mf=pf}else mf=!1;aw=mf&&(!document.documentMode||9<document.documentMode)}function Nx(){Bo&&(Bo.detachEvent("onpropertychange",iw),du=Bo=null)}function iw(e){if(e.propertyName==="value"&&hh(du)){var t=[];sw(t,du,e,b0(e)),Bv(aT,t)}}function lT(e,t,r){e==="focusin"?(Nx(),Bo=t,du=r,Bo.attachEvent("onpropertychange",iw)):e==="focusout"&&Nx()}function oT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hh(du)}function uT(e,t){if(e==="click")return hh(t)}function cT(e,t){if(e==="input"||e==="change")return hh(t)}function dT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ln=typeof Object.is=="function"?Object.is:dT;function hu(e,t){if(Ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!bm.call(t,s)||!Ln(e[s],t[s]))return!1}return!0}function kx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _x(e,t){var r=kx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=kx(r)}}function lw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ow(){for(var e=window,t=xd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=xd(e.document)}return t}function C0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function hT(e){var t=ow(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&lw(r.ownerDocument.documentElement,r)){if(n!==null&&C0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=_x(r,i);var l=_x(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fT=bs&&"documentMode"in document&&11>=document.documentMode,$i=null,Fm=null,Uo=null,Bm=!1;function Sx(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bm||$i==null||$i!==xd(n)||(n=$i,"selectionStart"in n&&C0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Uo&&hu(Uo,n)||(Uo=n,n=kd(Fm,"onSelect"),0<n.length&&(t=new _0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$i)))}function jc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var zi={animationend:jc("Animation","AnimationEnd"),animationiteration:jc("Animation","AnimationIteration"),animationstart:jc("Animation","AnimationStart"),transitionend:jc("Transition","TransitionEnd")},gf={},uw={};bs&&(uw=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function fh(e){if(gf[e])return gf[e];if(!zi[e])return e;var t=zi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in uw)return gf[e]=t[r];return e}var cw=fh("animationend"),dw=fh("animationiteration"),hw=fh("animationstart"),fw=fh("transitionend"),mw=new Map,Tx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _a(e,t){mw.set(e,t),vi(t,[e])}for(var xf=0;xf<Tx.length;xf++){var yf=Tx[xf],mT=yf.toLowerCase(),pT=yf[0].toUpperCase()+yf.slice(1);_a(mT,"on"+pT)}_a(cw,"onAnimationEnd");_a(dw,"onAnimationIteration");_a(hw,"onAnimationStart");_a("dblclick","onDoubleClick");_a("focusin","onFocus");_a("focusout","onBlur");_a(fw,"onTransitionEnd");Sl("onMouseEnter",["mouseout","mouseover"]);Sl("onMouseLeave",["mouseout","mouseover"]);Sl("onPointerEnter",["pointerout","pointerover"]);Sl("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gT=new Set("cancel close invalid load scroll toggle".split(" ").concat(jo));function Cx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,mS(n,t,void 0,e),e.currentTarget=null}function pw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;Cx(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;Cx(s,o,c),i=u}}}if(bd)throw e=Om,bd=!1,Om=null,e}function xt(e,t){var r=t[qm];r===void 0&&(r=t[qm]=new Set);var n=e+"__bubble";r.has(n)||(gw(t,e,2,!1),r.add(n))}function bf(e,t,r){var n=0;t&&(n|=4),gw(r,e,n,t)}var Ac="_reactListening"+Math.random().toString(36).slice(2);function fu(e){if(!e[Ac]){e[Ac]=!0,Nv.forEach(function(r){r!=="selectionchange"&&(gT.has(r)||bf(r,!1,e),bf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ac]||(t[Ac]=!0,bf("selectionchange",!1,t))}}function gw(e,t,r,n){switch(Jv(t)){case 1:var s=AS;break;case 4:s=IS;break;default:s=N0}r=s.bind(null,t,r,e),s=void 0,!Lm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function vf(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=za(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}Bv(function(){var c=i,d=b0(r),h=[];e:{var f=mw.get(e);if(f!==void 0){var g=_0,p=e;switch(e){case"keypress":if(nd(r)===0)break e;case"keydown":case"keyup":g=WS;break;case"focusin":p="focus",g=ff;break;case"focusout":p="blur",g=ff;break;case"beforeblur":case"afterblur":g=ff;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=gx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=OS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=QS;break;case cw:case dw:case hw:g=MS;break;case fw:g=ZS;break;case"scroll":g=RS;break;case"wheel":g=JS;break;case"copy":case"cut":case"paste":g=BS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=yx}var y=(t&4)!==0,v=!y&&e==="scroll",x=y?f!==null?f+"Capture":null:f;y=[];for(var b=c,E;b!==null;){E=b;var _=E.stateNode;if(E.tag===5&&_!==null&&(E=_,x!==null&&(_=lu(b,x),_!=null&&y.push(mu(b,_,E)))),v)break;b=b.return}0<y.length&&(f=new g(f,p,null,r,d),h.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",f&&r!==Im&&(p=r.relatedTarget||r.fromElement)&&(za(p)||p[vs]))break e;if((g||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,g?(p=r.relatedTarget||r.toElement,g=c,p=p?za(p):null,p!==null&&(v=wi(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=c),g!==p)){if(y=gx,_="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(y=yx,_="onPointerLeave",x="onPointerEnter",b="pointer"),v=g==null?f:qi(g),E=p==null?f:qi(p),f=new y(_,b+"leave",g,r,d),f.target=v,f.relatedTarget=E,_=null,za(d)===c&&(y=new y(x,b+"enter",p,r,d),y.target=E,y.relatedTarget=v,_=y),v=_,g&&p)t:{for(y=g,x=p,b=0,E=y;E;E=Ci(E))b++;for(E=0,_=x;_;_=Ci(_))E++;for(;0<b-E;)y=Ci(y),b--;for(;0<E-b;)x=Ci(x),E--;for(;b--;){if(y===x||x!==null&&y===x.alternate)break t;y=Ci(y),x=Ci(x)}y=null}else y=null;g!==null&&jx(h,f,g,y,!1),p!==null&&v!==null&&jx(h,v,p,y,!0)}}e:{if(f=c?qi(c):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var k=iT;else if(wx(f))if(aw)k=cT;else{k=oT;var S=lT}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=uT);if(k&&(k=k(e,c))){sw(h,k,r,d);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&Sm(f,"number",f.value)}switch(S=c?qi(c):window,e){case"focusin":(wx(S)||S.contentEditable==="true")&&($i=S,Fm=c,Uo=null);break;case"focusout":Uo=Fm=$i=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,Sx(h,r,d);break;case"selectionchange":if(fT)break;case"keydown":case"keyup":Sx(h,r,d)}var I;if(T0)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Hi?rw(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(tw&&r.locale!=="ko"&&(Hi||A!=="onCompositionStart"?A==="onCompositionEnd"&&Hi&&(I=ew()):(ia=d,k0="value"in ia?ia.value:ia.textContent,Hi=!0)),S=kd(c,A),0<S.length&&(A=new xx(A,e,null,r,d),h.push({event:A,listeners:S}),I?A.data=I:(I=nw(r),I!==null&&(A.data=I)))),(I=tT?rT(e,r):nT(e,r))&&(c=kd(c,"onBeforeInput"),0<c.length&&(d=new xx("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=I))}pw(h,t)})}function mu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function kd(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lu(e,r),i!=null&&n.unshift(mu(e,i,s)),i=lu(e,t),i!=null&&n.push(mu(e,i,s))),e=e.return}return n}function Ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jx(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=lu(r,i),u!=null&&l.unshift(mu(r,u,o))):s||(u=lu(r,i),u!=null&&l.push(mu(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var xT=/\r\n?/g,yT=/\u0000|\uFFFD/g;function Ax(e){return(typeof e=="string"?e:""+e).replace(xT,`
`).replace(yT,"")}function Ic(e,t,r){if(t=Ax(t),Ax(e)!==t&&r)throw Error(oe(425))}function _d(){}var Um=null,Hm=null;function $m(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zm=typeof setTimeout=="function"?setTimeout:void 0,bT=typeof clearTimeout=="function"?clearTimeout:void 0,Ix=typeof Promise=="function"?Promise:void 0,vT=typeof queueMicrotask=="function"?queueMicrotask:typeof Ix<"u"?function(e){return Ix.resolve(null).then(e).catch(wT)}:zm;function wT(e){setTimeout(function(){throw e})}function wf(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),cu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);cu(t)}function fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ql=Math.random().toString(36).slice(2),Gn="__reactFiber$"+ql,pu="__reactProps$"+ql,vs="__reactContainer$"+ql,qm="__reactEvents$"+ql,ET="__reactListeners$"+ql,NT="__reactHandles$"+ql;function za(e){var t=e[Gn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[vs]||r[Gn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Rx(e);e!==null;){if(r=e[Gn])return r;e=Rx(e)}return t}e=r,r=e.parentNode}return null}function Ju(e){return e=e[Gn]||e[vs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function mh(e){return e[pu]||null}var Vm=[],Vi=-1;function Sa(e){return{current:e}}function yt(e){0>Vi||(e.current=Vm[Vi],Vm[Vi]=null,Vi--)}function pt(e,t){Vi++,Vm[Vi]=e.current,e.current=t}var va={},cr=Sa(va),Or=Sa(!1),li=va;function Tl(e,t){var r=e.type.contextTypes;if(!r)return va;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(e){return e=e.childContextTypes,e!=null}function Sd(){yt(Or),yt(cr)}function Lx(e,t,r){if(cr.current!==va)throw Error(oe(168));pt(cr,t),pt(Or,r)}function xw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(oe(108,lS(e)||"Unknown",s));return St({},r,n)}function Td(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||va,li=cr.current,pt(cr,e),pt(Or,Or.current),!0}function Ox(e,t,r){var n=e.stateNode;if(!n)throw Error(oe(169));r?(e=xw(e,t,li),n.__reactInternalMemoizedMergedChildContext=e,yt(Or),yt(cr),pt(cr,e)):yt(Or),pt(Or,r)}var us=null,ph=!1,Ef=!1;function yw(e){us===null?us=[e]:us.push(e)}function kT(e){ph=!0,yw(e)}function Ta(){if(!Ef&&us!==null){Ef=!0;var e=0,t=it;try{var r=us;for(it=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}us=null,ph=!1}catch(s){throw us!==null&&(us=us.slice(e+1)),zv(v0,Ta),s}finally{it=t,Ef=!1}}return null}var Wi=[],Gi=0,Cd=null,jd=0,tn=[],rn=0,oi=null,ps=1,gs="";function Fa(e,t){Wi[Gi++]=jd,Wi[Gi++]=Cd,Cd=e,jd=t}function bw(e,t,r){tn[rn++]=ps,tn[rn++]=gs,tn[rn++]=oi,oi=e;var n=ps;e=gs;var s=32-Tn(n)-1;n&=~(1<<s),r+=1;var i=32-Tn(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,ps=1<<32-Tn(t)+s|r<<s|n,gs=i+e}else ps=1<<i|r<<s|n,gs=e}function j0(e){e.return!==null&&(Fa(e,1),bw(e,1,0))}function A0(e){for(;e===Cd;)Cd=Wi[--Gi],Wi[Gi]=null,jd=Wi[--Gi],Wi[Gi]=null;for(;e===oi;)oi=tn[--rn],tn[rn]=null,gs=tn[--rn],tn[rn]=null,ps=tn[--rn],tn[rn]=null}var qr=null,zr=null,wt=!1,Nn=null;function vw(e,t){var r=an(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Px(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,qr=e,zr=fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,qr=e,zr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=oi!==null?{id:ps,overflow:gs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=an(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,qr=e,zr=null,!0):!1;default:return!1}}function Wm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gm(e){if(wt){var t=zr;if(t){var r=t;if(!Px(e,t)){if(Wm(e))throw Error(oe(418));t=fa(r.nextSibling);var n=qr;t&&Px(e,t)?vw(n,r):(e.flags=e.flags&-4097|2,wt=!1,qr=e)}}else{if(Wm(e))throw Error(oe(418));e.flags=e.flags&-4097|2,wt=!1,qr=e}}}function Dx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qr=e}function Rc(e){if(e!==qr)return!1;if(!wt)return Dx(e),wt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$m(e.type,e.memoizedProps)),t&&(t=zr)){if(Wm(e))throw ww(),Error(oe(418));for(;t;)vw(e,t),t=fa(t.nextSibling)}if(Dx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){zr=fa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}zr=null}}else zr=qr?fa(e.stateNode.nextSibling):null;return!0}function ww(){for(var e=zr;e;)e=fa(e.nextSibling)}function Cl(){zr=qr=null,wt=!1}function I0(e){Nn===null?Nn=[e]:Nn.push(e)}var _T=Ss.ReactCurrentBatchConfig;function fo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(oe(309));var n=r.stateNode}if(!n)throw Error(oe(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(oe(284));if(!r._owner)throw Error(oe(290,e))}return e}function Lc(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Mx(e){var t=e._init;return t(e._payload)}function Ew(e){function t(x,b){if(e){var E=x.deletions;E===null?(x.deletions=[b],x.flags|=16):E.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=xa(x,b),x.index=0,x.sibling=null,x}function i(x,b,E){return x.index=E,e?(E=x.alternate,E!==null?(E=E.index,E<b?(x.flags|=2,b):E):(x.flags|=2,b)):(x.flags|=1048576,b)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,b,E,_){return b===null||b.tag!==6?(b=jf(E,x.mode,_),b.return=x,b):(b=s(b,E),b.return=x,b)}function u(x,b,E,_){var k=E.type;return k===Ui?d(x,b,E.props.children,_,E.key):b!==null&&(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$s&&Mx(k)===b.type)?(_=s(b,E.props),_.ref=fo(x,b,E),_.return=x,_):(_=cd(E.type,E.key,E.props,null,x.mode,_),_.ref=fo(x,b,E),_.return=x,_)}function c(x,b,E,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==E.containerInfo||b.stateNode.implementation!==E.implementation?(b=Af(E,x.mode,_),b.return=x,b):(b=s(b,E.children||[]),b.return=x,b)}function d(x,b,E,_,k){return b===null||b.tag!==7?(b=ni(E,x.mode,_,k),b.return=x,b):(b=s(b,E),b.return=x,b)}function h(x,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return b=jf(""+b,x.mode,E),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ec:return E=cd(b.type,b.key,b.props,null,x.mode,E),E.ref=fo(x,null,b),E.return=x,E;case Bi:return b=Af(b,x.mode,E),b.return=x,b;case $s:var _=b._init;return h(x,_(b._payload),E)}if(To(b)||lo(b))return b=ni(b,x.mode,E,null),b.return=x,b;Lc(x,b)}return null}function f(x,b,E,_){var k=b!==null?b.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return k!==null?null:o(x,b,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ec:return E.key===k?u(x,b,E,_):null;case Bi:return E.key===k?c(x,b,E,_):null;case $s:return k=E._init,f(x,b,k(E._payload),_)}if(To(E)||lo(E))return k!==null?null:d(x,b,E,_,null);Lc(x,E)}return null}function g(x,b,E,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(E)||null,o(b,x,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ec:return x=x.get(_.key===null?E:_.key)||null,u(b,x,_,k);case Bi:return x=x.get(_.key===null?E:_.key)||null,c(b,x,_,k);case $s:var S=_._init;return g(x,b,E,S(_._payload),k)}if(To(_)||lo(_))return x=x.get(E)||null,d(b,x,_,k,null);Lc(b,_)}return null}function p(x,b,E,_){for(var k=null,S=null,I=b,A=b=0,D=null;I!==null&&A<E.length;A++){I.index>A?(D=I,I=null):D=I.sibling;var T=f(x,I,E[A],_);if(T===null){I===null&&(I=D);break}e&&I&&T.alternate===null&&t(x,I),b=i(T,b,A),S===null?k=T:S.sibling=T,S=T,I=D}if(A===E.length)return r(x,I),wt&&Fa(x,A),k;if(I===null){for(;A<E.length;A++)I=h(x,E[A],_),I!==null&&(b=i(I,b,A),S===null?k=I:S.sibling=I,S=I);return wt&&Fa(x,A),k}for(I=n(x,I);A<E.length;A++)D=g(I,x,A,E[A],_),D!==null&&(e&&D.alternate!==null&&I.delete(D.key===null?A:D.key),b=i(D,b,A),S===null?k=D:S.sibling=D,S=D);return e&&I.forEach(function(H){return t(x,H)}),wt&&Fa(x,A),k}function y(x,b,E,_){var k=lo(E);if(typeof k!="function")throw Error(oe(150));if(E=k.call(E),E==null)throw Error(oe(151));for(var S=k=null,I=b,A=b=0,D=null,T=E.next();I!==null&&!T.done;A++,T=E.next()){I.index>A?(D=I,I=null):D=I.sibling;var H=f(x,I,T.value,_);if(H===null){I===null&&(I=D);break}e&&I&&H.alternate===null&&t(x,I),b=i(H,b,A),S===null?k=H:S.sibling=H,S=H,I=D}if(T.done)return r(x,I),wt&&Fa(x,A),k;if(I===null){for(;!T.done;A++,T=E.next())T=h(x,T.value,_),T!==null&&(b=i(T,b,A),S===null?k=T:S.sibling=T,S=T);return wt&&Fa(x,A),k}for(I=n(x,I);!T.done;A++,T=E.next())T=g(I,x,A,T.value,_),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?A:T.key),b=i(T,b,A),S===null?k=T:S.sibling=T,S=T);return e&&I.forEach(function(L){return t(x,L)}),wt&&Fa(x,A),k}function v(x,b,E,_){if(typeof E=="object"&&E!==null&&E.type===Ui&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Ec:e:{for(var k=E.key,S=b;S!==null;){if(S.key===k){if(k=E.type,k===Ui){if(S.tag===7){r(x,S.sibling),b=s(S,E.props.children),b.return=x,x=b;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$s&&Mx(k)===S.type){r(x,S.sibling),b=s(S,E.props),b.ref=fo(x,S,E),b.return=x,x=b;break e}r(x,S);break}else t(x,S);S=S.sibling}E.type===Ui?(b=ni(E.props.children,x.mode,_,E.key),b.return=x,x=b):(_=cd(E.type,E.key,E.props,null,x.mode,_),_.ref=fo(x,b,E),_.return=x,x=_)}return l(x);case Bi:e:{for(S=E.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===E.containerInfo&&b.stateNode.implementation===E.implementation){r(x,b.sibling),b=s(b,E.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=Af(E,x.mode,_),b.return=x,x=b}return l(x);case $s:return S=E._init,v(x,b,S(E._payload),_)}if(To(E))return p(x,b,E,_);if(lo(E))return y(x,b,E,_);Lc(x,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,E),b.return=x,x=b):(r(x,b),b=jf(E,x.mode,_),b.return=x,x=b),l(x)):r(x,b)}return v}var jl=Ew(!0),Nw=Ew(!1),Ad=Sa(null),Id=null,Yi=null,R0=null;function L0(){R0=Yi=Id=null}function O0(e){var t=Ad.current;yt(Ad),e._currentValue=t}function Ym(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function nl(e,t){Id=e,R0=Yi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Lr=!0),e.firstContext=null)}function on(e){var t=e._currentValue;if(R0!==e)if(e={context:e,memoizedValue:t,next:null},Yi===null){if(Id===null)throw Error(oe(308));Yi=e,Id.dependencies={lanes:0,firstContext:e}}else Yi=Yi.next=e;return t}var qa=null;function P0(e){qa===null?qa=[e]:qa.push(e)}function kw(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,P0(t)):(r.next=s.next,s.next=r),t.interleaved=r,ws(e,n)}function ws(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var zs=!1;function D0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _w(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ws(e,r)}return s=n.interleaved,s===null?(t.next=t,P0(n)):(t.next=s.next,s.next=t),n.interleaved=t,ws(e,r)}function sd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,w0(e,r)}}function Fx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Rd(e,t,r,n){var s=e.updateQueue;zs=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;l=0,d=c=u=null,o=i;do{var f=o.lane,g=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,y=o;switch(f=t,g=r,y.tag){case 1:if(p=y.payload,typeof p=="function"){h=p.call(g,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(g,h,f):p,f==null)break e;h=St({},h,f);break e;case 2:zs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else g={eventTime:g,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,u=h):d=d.next=g,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ci|=l,e.lanes=l,e.memoizedState=h}}function Bx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(oe(191,s));s.call(n)}}}var ec={},Qn=Sa(ec),gu=Sa(ec),xu=Sa(ec);function Va(e){if(e===ec)throw Error(oe(174));return e}function M0(e,t){switch(pt(xu,t),pt(gu,e),pt(Qn,ec),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Cm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Cm(t,e)}yt(Qn),pt(Qn,t)}function Al(){yt(Qn),yt(gu),yt(xu)}function Sw(e){Va(xu.current);var t=Va(Qn.current),r=Cm(t,e.type);t!==r&&(pt(gu,e),pt(Qn,r))}function F0(e){gu.current===e&&(yt(Qn),yt(gu))}var kt=Sa(0);function Ld(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Nf=[];function B0(){for(var e=0;e<Nf.length;e++)Nf[e]._workInProgressVersionPrimary=null;Nf.length=0}var ad=Ss.ReactCurrentDispatcher,kf=Ss.ReactCurrentBatchConfig,ui=0,_t=null,Bt=null,Wt=null,Od=!1,Ho=!1,yu=0,ST=0;function nr(){throw Error(oe(321))}function U0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ln(e[r],t[r]))return!1;return!0}function H0(e,t,r,n,s,i){if(ui=i,_t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ad.current=e===null||e.memoizedState===null?AT:IT,e=r(n,s),Ho){i=0;do{if(Ho=!1,yu=0,25<=i)throw Error(oe(301));i+=1,Wt=Bt=null,t.updateQueue=null,ad.current=RT,e=r(n,s)}while(Ho)}if(ad.current=Pd,t=Bt!==null&&Bt.next!==null,ui=0,Wt=Bt=_t=null,Od=!1,t)throw Error(oe(300));return e}function $0(){var e=yu!==0;return yu=0,e}function Un(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?_t.memoizedState=Wt=e:Wt=Wt.next=e,Wt}function un(){if(Bt===null){var e=_t.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=Wt===null?_t.memoizedState:Wt.next;if(t!==null)Wt=t,Bt=e;else{if(e===null)throw Error(oe(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Wt===null?_t.memoizedState=Wt=e:Wt=Wt.next=e}return Wt}function bu(e,t){return typeof t=="function"?t(e):t}function _f(e){var t=un(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=Bt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var d=c.lane;if((ui&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,l=n):u=u.next=h,_t.lanes|=d,ci|=d}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,Ln(n,t.memoizedState)||(Lr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,_t.lanes|=i,ci|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Sf(e){var t=un(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);Ln(i,t.memoizedState)||(Lr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Tw(){}function Cw(e,t){var r=_t,n=un(),s=t(),i=!Ln(n.memoizedState,s);if(i&&(n.memoizedState=s,Lr=!0),n=n.queue,z0(Iw.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Wt!==null&&Wt.memoizedState.tag&1){if(r.flags|=2048,vu(9,Aw.bind(null,r,n,s,t),void 0,null),Qt===null)throw Error(oe(349));ui&30||jw(r,t,s)}return s}function jw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Aw(e,t,r,n){t.value=r,t.getSnapshot=n,Rw(t)&&Lw(e)}function Iw(e,t,r){return r(function(){Rw(t)&&Lw(e)})}function Rw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ln(e,r)}catch{return!0}}function Lw(e){var t=ws(e,1);t!==null&&Cn(t,e,1,-1)}function Ux(e){var t=Un();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:e},t.queue=e,e=e.dispatch=jT.bind(null,_t,e),[t.memoizedState,e]}function vu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Ow(){return un().memoizedState}function id(e,t,r,n){var s=Un();_t.flags|=e,s.memoizedState=vu(1|t,r,void 0,n===void 0?null:n)}function gh(e,t,r,n){var s=un();n=n===void 0?null:n;var i=void 0;if(Bt!==null){var l=Bt.memoizedState;if(i=l.destroy,n!==null&&U0(n,l.deps)){s.memoizedState=vu(t,r,i,n);return}}_t.flags|=e,s.memoizedState=vu(1|t,r,i,n)}function Hx(e,t){return id(8390656,8,e,t)}function z0(e,t){return gh(2048,8,e,t)}function Pw(e,t){return gh(4,2,e,t)}function Dw(e,t){return gh(4,4,e,t)}function Mw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fw(e,t,r){return r=r!=null?r.concat([e]):null,gh(4,4,Mw.bind(null,t,e),r)}function q0(){}function Bw(e,t){var r=un();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&U0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Uw(e,t){var r=un();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&U0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hw(e,t,r){return ui&21?(Ln(r,t)||(r=Wv(),_t.lanes|=r,ci|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=r)}function TT(e,t){var r=it;it=r!==0&&4>r?r:4,e(!0);var n=kf.transition;kf.transition={};try{e(!1),t()}finally{it=r,kf.transition=n}}function $w(){return un().memoizedState}function CT(e,t,r){var n=ga(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},zw(e))qw(t,r);else if(r=kw(e,t,r,n),r!==null){var s=vr();Cn(r,e,n,s),Vw(r,t,n)}}function jT(e,t,r){var n=ga(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(zw(e))qw(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,Ln(o,l)){var u=t.interleaved;u===null?(s.next=s,P0(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=kw(e,t,s,n),r!==null&&(s=vr(),Cn(r,e,n,s),Vw(r,t,n))}}function zw(e){var t=e.alternate;return e===_t||t!==null&&t===_t}function qw(e,t){Ho=Od=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Vw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,w0(e,r)}}var Pd={readContext:on,useCallback:nr,useContext:nr,useEffect:nr,useImperativeHandle:nr,useInsertionEffect:nr,useLayoutEffect:nr,useMemo:nr,useReducer:nr,useRef:nr,useState:nr,useDebugValue:nr,useDeferredValue:nr,useTransition:nr,useMutableSource:nr,useSyncExternalStore:nr,useId:nr,unstable_isNewReconciler:!1},AT={readContext:on,useCallback:function(e,t){return Un().memoizedState=[e,t===void 0?null:t],e},useContext:on,useEffect:Hx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,id(4194308,4,Mw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return id(4194308,4,e,t)},useInsertionEffect:function(e,t){return id(4,2,e,t)},useMemo:function(e,t){var r=Un();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Un();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=CT.bind(null,_t,e),[n.memoizedState,e]},useRef:function(e){var t=Un();return e={current:e},t.memoizedState=e},useState:Ux,useDebugValue:q0,useDeferredValue:function(e){return Un().memoizedState=e},useTransition:function(){var e=Ux(!1),t=e[0];return e=TT.bind(null,e[1]),Un().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=_t,s=Un();if(wt){if(r===void 0)throw Error(oe(407));r=r()}else{if(r=t(),Qt===null)throw Error(oe(349));ui&30||jw(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Hx(Iw.bind(null,n,i,e),[e]),n.flags|=2048,vu(9,Aw.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Un(),t=Qt.identifierPrefix;if(wt){var r=gs,n=ps;r=(n&~(1<<32-Tn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=yu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ST++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},IT={readContext:on,useCallback:Bw,useContext:on,useEffect:z0,useImperativeHandle:Fw,useInsertionEffect:Pw,useLayoutEffect:Dw,useMemo:Uw,useReducer:_f,useRef:Ow,useState:function(){return _f(bu)},useDebugValue:q0,useDeferredValue:function(e){var t=un();return Hw(t,Bt.memoizedState,e)},useTransition:function(){var e=_f(bu)[0],t=un().memoizedState;return[e,t]},useMutableSource:Tw,useSyncExternalStore:Cw,useId:$w,unstable_isNewReconciler:!1},RT={readContext:on,useCallback:Bw,useContext:on,useEffect:z0,useImperativeHandle:Fw,useInsertionEffect:Pw,useLayoutEffect:Dw,useMemo:Uw,useReducer:Sf,useRef:Ow,useState:function(){return Sf(bu)},useDebugValue:q0,useDeferredValue:function(e){var t=un();return Bt===null?t.memoizedState=e:Hw(t,Bt.memoizedState,e)},useTransition:function(){var e=Sf(bu)[0],t=un().memoizedState;return[e,t]},useMutableSource:Tw,useSyncExternalStore:Cw,useId:$w,unstable_isNewReconciler:!1};function yn(e,t){if(e&&e.defaultProps){t=St({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Qm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:St({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var xh={isMounted:function(e){return(e=e._reactInternals)?wi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=vr(),s=ga(e),i=xs(n,s);i.payload=t,r!=null&&(i.callback=r),t=ma(e,i,s),t!==null&&(Cn(t,e,s,n),sd(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=vr(),s=ga(e),i=xs(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ma(e,i,s),t!==null&&(Cn(t,e,s,n),sd(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=vr(),n=ga(e),s=xs(r,n);s.tag=2,t!=null&&(s.callback=t),t=ma(e,s,n),t!==null&&(Cn(t,e,n,r),sd(t,e,n))}};function $x(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!hu(r,n)||!hu(s,i):!0}function Ww(e,t,r){var n=!1,s=va,i=t.contextType;return typeof i=="object"&&i!==null?i=on(i):(s=Pr(t)?li:cr.current,n=t.contextTypes,i=(n=n!=null)?Tl(e,s):va),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=xh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function zx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&xh.enqueueReplaceState(t,t.state,null)}function Km(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},D0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=on(i):(i=Pr(t)?li:cr.current,s.context=Tl(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Qm(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&xh.enqueueReplaceState(s,s.state,null),Rd(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Il(e,t){try{var r="",n=t;do r+=iS(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Tf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Zm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var LT=typeof WeakMap=="function"?WeakMap:Map;function Gw(e,t,r){r=xs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Md||(Md=!0,lp=n),Zm(e,t)},r}function Yw(e,t,r){r=xs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Zm(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Zm(e,t),typeof n!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function qx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new LT;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=GT.bind(null,e,t,r),t.then(e,e))}function Vx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Wx(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=xs(-1,1),t.tag=2,ma(r,t,1))),r.lanes|=1),e)}var OT=Ss.ReactCurrentOwner,Lr=!1;function yr(e,t,r,n){t.child=e===null?Nw(t,null,r,n):jl(t,e.child,r,n)}function Gx(e,t,r,n,s){r=r.render;var i=t.ref;return nl(t,s),n=H0(e,t,r,n,i,s),r=$0(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Es(e,t,s)):(wt&&r&&j0(t),t.flags|=1,yr(e,t,n,s),t.child)}function Yx(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!X0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Qw(e,t,i,n,s)):(e=cd(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:hu,r(l,n)&&e.ref===t.ref)return Es(e,t,s)}return t.flags|=1,e=xa(i,n),e.ref=t.ref,e.return=t,t.child=e}function Qw(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(hu(i,n)&&e.ref===t.ref)if(Lr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Lr=!0);else return t.lanes=e.lanes,Es(e,t,s)}return Xm(e,t,r,n,s)}function Kw(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Ki,Hr),Hr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pt(Ki,Hr),Hr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,pt(Ki,Hr),Hr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,pt(Ki,Hr),Hr|=n;return yr(e,t,s,r),t.child}function Zw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Xm(e,t,r,n,s){var i=Pr(r)?li:cr.current;return i=Tl(t,i),nl(t,s),r=H0(e,t,r,n,i,s),n=$0(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Es(e,t,s)):(wt&&n&&j0(t),t.flags|=1,yr(e,t,r,s),t.child)}function Qx(e,t,r,n,s){if(Pr(r)){var i=!0;Td(t)}else i=!1;if(nl(t,s),t.stateNode===null)ld(e,t),Ww(t,r,n),Km(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=on(c):(c=Pr(r)?li:cr.current,c=Tl(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&zx(t,l,n,c),zs=!1;var f=t.memoizedState;l.state=f,Rd(t,n,l,s),u=t.memoizedState,o!==n||f!==u||Or.current||zs?(typeof d=="function"&&(Qm(t,r,d,n),u=t.memoizedState),(o=zs||$x(t,r,o,n,f,u,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,_w(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:yn(t.type,o),l.props=c,h=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=on(u):(u=Pr(r)?li:cr.current,u=Tl(t,u));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==u)&&zx(t,l,n,u),zs=!1,f=t.memoizedState,l.state=f,Rd(t,n,l,s);var p=t.memoizedState;o!==h||f!==p||Or.current||zs?(typeof g=="function"&&(Qm(t,r,g,n),p=t.memoizedState),(c=zs||$x(t,r,c,n,f,p,u)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Jm(e,t,r,n,i,s)}function Jm(e,t,r,n,s,i){Zw(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&Ox(t,r,!1),Es(e,t,i);n=t.stateNode,OT.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=jl(t,e.child,null,i),t.child=jl(t,null,o,i)):yr(e,t,o,i),t.memoizedState=n.state,s&&Ox(t,r,!0),t.child}function Xw(e){var t=e.stateNode;t.pendingContext?Lx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lx(e,t.context,!1),M0(e,t.containerInfo)}function Kx(e,t,r,n,s){return Cl(),I0(s),t.flags|=256,yr(e,t,r,n),t.child}var ep={dehydrated:null,treeContext:null,retryLane:0};function tp(e){return{baseLanes:e,cachePool:null,transitions:null}}function Jw(e,t,r){var n=t.pendingProps,s=kt.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),pt(kt,s&1),e===null)return Gm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=vh(l,n,0,null),e=ni(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=tp(r),t.memoizedState=ep,e):V0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return PT(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=xa(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=xa(o,i):(i=ni(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?tp(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=ep,n}return i=e.child,e=i.sibling,n=xa(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function V0(e,t){return t=vh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Oc(e,t,r,n){return n!==null&&I0(n),jl(t,e.child,null,r),e=V0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function PT(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=Tf(Error(oe(422))),Oc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=vh({mode:"visible",children:n.children},s,0,null),i=ni(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&jl(t,e.child,null,l),t.child.memoizedState=tp(l),t.memoizedState=ep,i);if(!(t.mode&1))return Oc(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(oe(419)),n=Tf(i,n,void 0),Oc(e,t,l,n)}if(o=(l&e.childLanes)!==0,Lr||o){if(n=Qt,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ws(e,s),Cn(n,e,s,-1))}return Z0(),n=Tf(Error(oe(421))),Oc(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=YT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,zr=fa(s.nextSibling),qr=t,wt=!0,Nn=null,e!==null&&(tn[rn++]=ps,tn[rn++]=gs,tn[rn++]=oi,ps=e.id,gs=e.overflow,oi=t),t=V0(t,n.children),t.flags|=4096,t)}function Zx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ym(e.return,t,r)}function Cf(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function e2(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(yr(e,t,n.children,r),n=kt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zx(e,r,t);else if(e.tag===19)Zx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(pt(kt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ld(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Cf(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ld(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Cf(t,!0,r,null,i);break;case"together":Cf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ld(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Es(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ci|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,r=xa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function DT(e,t,r){switch(t.tag){case 3:Xw(t),Cl();break;case 5:Sw(t);break;case 1:Pr(t.type)&&Td(t);break;case 4:M0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;pt(Ad,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(pt(kt,kt.current&1),t.flags|=128,null):r&t.child.childLanes?Jw(e,t,r):(pt(kt,kt.current&1),e=Es(e,t,r),e!==null?e.sibling:null);pt(kt,kt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return e2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),pt(kt,kt.current),n)break;return null;case 22:case 23:return t.lanes=0,Kw(e,t,r)}return Es(e,t,r)}var t2,rp,r2,n2;t2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};rp=function(){};r2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Va(Qn.current);var i=null;switch(r){case"input":s=km(e,s),n=km(e,n),i=[];break;case"select":s=St({},s,{value:void 0}),n=St({},n,{value:void 0}),i=[];break;case"textarea":s=Tm(e,s),n=Tm(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=_d)}jm(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(au.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(au.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&xt("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};n2=function(e,t,r,n){r!==n&&(t.flags|=4)};function mo(e,t){if(!wt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function sr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function MT(e,t,r){var n=t.pendingProps;switch(A0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(t),null;case 1:return Pr(t.type)&&Sd(),sr(t),null;case 3:return n=t.stateNode,Al(),yt(Or),yt(cr),B0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Rc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nn!==null&&(cp(Nn),Nn=null))),rp(e,t),sr(t),null;case 5:F0(t);var s=Va(xu.current);if(r=t.type,e!==null&&t.stateNode!=null)r2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(oe(166));return sr(t),null}if(e=Va(Qn.current),Rc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Gn]=t,n[pu]=i,e=(t.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(s=0;s<jo.length;s++)xt(jo[s],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":ix(n,i),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},xt("invalid",n);break;case"textarea":ox(n,i),xt("invalid",n)}jm(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Ic(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Ic(n.textContent,o,e),s=["children",""+o]):au.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&xt("scroll",n)}switch(r){case"input":Nc(n),lx(n,i,!0);break;case"textarea":Nc(n),ux(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=_d)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Iv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Gn]=t,e[pu]=n,t2(e,t,!1,!1),t.stateNode=e;e:{switch(l=Am(r,n),r){case"dialog":xt("cancel",e),xt("close",e),s=n;break;case"iframe":case"object":case"embed":xt("load",e),s=n;break;case"video":case"audio":for(s=0;s<jo.length;s++)xt(jo[s],e);s=n;break;case"source":xt("error",e),s=n;break;case"img":case"image":case"link":xt("error",e),xt("load",e),s=n;break;case"details":xt("toggle",e),s=n;break;case"input":ix(e,n),s=km(e,n),xt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=St({},n,{value:void 0}),xt("invalid",e);break;case"textarea":ox(e,n),s=Tm(e,n),xt("invalid",e);break;default:s=n}jm(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?Ov(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Rv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&iu(e,u):typeof u=="number"&&iu(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(au.hasOwnProperty(i)?u!=null&&i==="onScroll"&&xt("scroll",e):u!=null&&p0(e,i,u,l))}switch(r){case"input":Nc(e),lx(e,n,!1);break;case"textarea":Nc(e),ux(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ba(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ji(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ji(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=_d)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return sr(t),null;case 6:if(e&&t.stateNode!=null)n2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(oe(166));if(r=Va(xu.current),Va(Qn.current),Rc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gn]=t,(i=n.nodeValue!==r)&&(e=qr,e!==null))switch(e.tag){case 3:Ic(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ic(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gn]=t,t.stateNode=n}return sr(t),null;case 13:if(yt(kt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(wt&&zr!==null&&t.mode&1&&!(t.flags&128))ww(),Cl(),t.flags|=98560,i=!1;else if(i=Rc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(oe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[Gn]=t}else Cl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;sr(t),i=!1}else Nn!==null&&(cp(Nn),Nn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||kt.current&1?Ht===0&&(Ht=3):Z0())),t.updateQueue!==null&&(t.flags|=4),sr(t),null);case 4:return Al(),rp(e,t),e===null&&fu(t.stateNode.containerInfo),sr(t),null;case 10:return O0(t.type._context),sr(t),null;case 17:return Pr(t.type)&&Sd(),sr(t),null;case 19:if(yt(kt),i=t.memoizedState,i===null)return sr(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)mo(i,!1);else{if(Ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ld(e),l!==null){for(t.flags|=128,mo(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return pt(kt,kt.current&1|2),t.child}e=e.sibling}i.tail!==null&&It()>Rl&&(t.flags|=128,n=!0,mo(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ld(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),mo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!wt)return sr(t),null}else 2*It()-i.renderingStartTime>Rl&&r!==1073741824&&(t.flags|=128,n=!0,mo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=It(),t.sibling=null,r=kt.current,pt(kt,n?r&1|2:r&1),t):(sr(t),null);case 22:case 23:return K0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Hr&1073741824&&(sr(t),t.subtreeFlags&6&&(t.flags|=8192)):sr(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function FT(e,t){switch(A0(t),t.tag){case 1:return Pr(t.type)&&Sd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Al(),yt(Or),yt(cr),B0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return F0(t),null;case 13:if(yt(kt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));Cl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(kt),null;case 4:return Al(),null;case 10:return O0(t.type._context),null;case 22:case 23:return K0(),null;case 24:return null;default:return null}}var Pc=!1,ir=!1,BT=typeof WeakSet=="function"?WeakSet:Set,be=null;function Qi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){jt(e,t,n)}else r.current=null}function np(e,t,r){try{r()}catch(n){jt(e,t,n)}}var Xx=!1;function UT(e,t){if(Um=Ed,e=ow(),C0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var g;h!==r||s!==0&&h.nodeType!==3||(o=l+s),h!==i||n!==0&&h.nodeType!==3||(u=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++d===n&&(u=l),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hm={focusedElem:e,selectionRange:r},Ed=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,v=p.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:yn(t.type,y),v);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(_){jt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return p=Xx,Xx=!1,p}function $o(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&np(t,r,i)}s=s.next}while(s!==n)}}function yh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sp(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function s2(e){var t=e.alternate;t!==null&&(e.alternate=null,s2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gn],delete t[pu],delete t[qm],delete t[ET],delete t[NT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function a2(e){return e.tag===5||e.tag===3||e.tag===4}function Jx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||a2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ap(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=_d));else if(n!==4&&(e=e.child,e!==null))for(ap(e,t,r),e=e.sibling;e!==null;)ap(e,t,r),e=e.sibling}function ip(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ip(e,t,r),e=e.sibling;e!==null;)ip(e,t,r),e=e.sibling}var Xt=null,wn=!1;function Ls(e,t,r){for(r=r.child;r!==null;)i2(e,t,r),r=r.sibling}function i2(e,t,r){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(ch,r)}catch{}switch(r.tag){case 5:ir||Qi(r,t);case 6:var n=Xt,s=wn;Xt=null,Ls(e,t,r),Xt=n,wn=s,Xt!==null&&(wn?(e=Xt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Xt.removeChild(r.stateNode));break;case 18:Xt!==null&&(wn?(e=Xt,r=r.stateNode,e.nodeType===8?wf(e.parentNode,r):e.nodeType===1&&wf(e,r),cu(e)):wf(Xt,r.stateNode));break;case 4:n=Xt,s=wn,Xt=r.stateNode.containerInfo,wn=!0,Ls(e,t,r),Xt=n,wn=s;break;case 0:case 11:case 14:case 15:if(!ir&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&np(r,t,l),s=s.next}while(s!==n)}Ls(e,t,r);break;case 1:if(!ir&&(Qi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){jt(r,t,o)}Ls(e,t,r);break;case 21:Ls(e,t,r);break;case 22:r.mode&1?(ir=(n=ir)||r.memoizedState!==null,Ls(e,t,r),ir=n):Ls(e,t,r);break;default:Ls(e,t,r)}}function ey(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new BT),t.forEach(function(n){var s=QT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function xn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Xt=o.stateNode,wn=!1;break e;case 3:Xt=o.stateNode.containerInfo,wn=!0;break e;case 4:Xt=o.stateNode.containerInfo,wn=!0;break e}o=o.return}if(Xt===null)throw Error(oe(160));i2(i,l,s),Xt=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){jt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)l2(t,e),t=t.sibling}function l2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xn(t,e),Fn(e),n&4){try{$o(3,e,e.return),yh(3,e)}catch(y){jt(e,e.return,y)}try{$o(5,e,e.return)}catch(y){jt(e,e.return,y)}}break;case 1:xn(t,e),Fn(e),n&512&&r!==null&&Qi(r,r.return);break;case 5:if(xn(t,e),Fn(e),n&512&&r!==null&&Qi(r,r.return),e.flags&32){var s=e.stateNode;try{iu(s,"")}catch(y){jt(e,e.return,y)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&jv(s,i),Am(o,l);var c=Am(o,i);for(l=0;l<u.length;l+=2){var d=u[l],h=u[l+1];d==="style"?Ov(s,h):d==="dangerouslySetInnerHTML"?Rv(s,h):d==="children"?iu(s,h):p0(s,d,h,c)}switch(o){case"input":_m(s,i);break;case"textarea":Av(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Ji(s,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ji(s,!!i.multiple,i.defaultValue,!0):Ji(s,!!i.multiple,i.multiple?[]:"",!1))}s[pu]=i}catch(y){jt(e,e.return,y)}}break;case 6:if(xn(t,e),Fn(e),n&4){if(e.stateNode===null)throw Error(oe(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(y){jt(e,e.return,y)}}break;case 3:if(xn(t,e),Fn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{cu(t.containerInfo)}catch(y){jt(e,e.return,y)}break;case 4:xn(t,e),Fn(e);break;case 13:xn(t,e),Fn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Y0=It())),n&4&&ey(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(ir=(c=ir)||d,xn(t,e),ir=c):xn(t,e),Fn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(be=e,d=e.child;d!==null;){for(h=be=d;be!==null;){switch(f=be,g=f.child,f.tag){case 0:case 11:case 14:case 15:$o(4,f,f.return);break;case 1:Qi(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(y){jt(n,r,y)}}break;case 5:Qi(f,f.return);break;case 22:if(f.memoizedState!==null){ry(h);continue}}g!==null?(g.return=f,be=g):ry(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,u=h.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=Lv("display",l))}catch(y){jt(e,e.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(y){jt(e,e.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:xn(t,e),Fn(e),n&4&&ey(e);break;case 21:break;default:xn(t,e),Fn(e)}}function Fn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(a2(r)){var n=r;break e}r=r.return}throw Error(oe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(iu(s,""),n.flags&=-33);var i=Jx(e);ip(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Jx(e);ap(e,o,l);break;default:throw Error(oe(161))}}catch(u){jt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function HT(e,t,r){be=e,o2(e)}function o2(e,t,r){for(var n=(e.mode&1)!==0;be!==null;){var s=be,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||Pc;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||ir;o=Pc;var c=ir;if(Pc=l,(ir=u)&&!c)for(be=s;be!==null;)l=be,u=l.child,l.tag===22&&l.memoizedState!==null?ny(s):u!==null?(u.return=l,be=u):ny(s);for(;i!==null;)be=i,o2(i),i=i.sibling;be=s,Pc=o,ir=c}ty(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,be=i):ty(e)}}function ty(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ir||yh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ir)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:yn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Bx(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Bx(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&cu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}ir||t.flags&512&&sp(t)}catch(f){jt(t,t.return,f)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function ry(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function ny(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{yh(4,t)}catch(u){jt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){jt(t,s,u)}}var i=t.return;try{sp(t)}catch(u){jt(t,i,u)}break;case 5:var l=t.return;try{sp(t)}catch(u){jt(t,l,u)}}}catch(u){jt(t,t.return,u)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var $T=Math.ceil,Dd=Ss.ReactCurrentDispatcher,W0=Ss.ReactCurrentOwner,ln=Ss.ReactCurrentBatchConfig,Je=0,Qt=null,Mt=null,Jt=0,Hr=0,Ki=Sa(0),Ht=0,wu=null,ci=0,bh=0,G0=0,zo=null,Ir=null,Y0=0,Rl=1/0,ls=null,Md=!1,lp=null,pa=null,Dc=!1,la=null,Fd=0,qo=0,op=null,od=-1,ud=0;function vr(){return Je&6?It():od!==-1?od:od=It()}function ga(e){return e.mode&1?Je&2&&Jt!==0?Jt&-Jt:_T.transition!==null?(ud===0&&(ud=Wv()),ud):(e=it,e!==0||(e=window.event,e=e===void 0?16:Jv(e.type)),e):1}function Cn(e,t,r,n){if(50<qo)throw qo=0,op=null,Error(oe(185));Zu(e,r,n),(!(Je&2)||e!==Qt)&&(e===Qt&&(!(Je&2)&&(bh|=r),Ht===4&&Ys(e,Jt)),Dr(e,n),r===1&&Je===0&&!(t.mode&1)&&(Rl=It()+500,ph&&Ta()))}function Dr(e,t){var r=e.callbackNode;_S(e,t);var n=wd(e,e===Qt?Jt:0);if(n===0)r!==null&&hx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&hx(r),t===1)e.tag===0?kT(sy.bind(null,e)):yw(sy.bind(null,e)),vT(function(){!(Je&6)&&Ta()}),r=null;else{switch(Gv(n)){case 1:r=v0;break;case 4:r=qv;break;case 16:r=vd;break;case 536870912:r=Vv;break;default:r=vd}r=g2(r,u2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function u2(e,t){if(od=-1,ud=0,Je&6)throw Error(oe(327));var r=e.callbackNode;if(sl()&&e.callbackNode!==r)return null;var n=wd(e,e===Qt?Jt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Bd(e,n);else{t=n;var s=Je;Je|=2;var i=d2();(Qt!==e||Jt!==t)&&(ls=null,Rl=It()+500,ri(e,t));do try{VT();break}catch(o){c2(e,o)}while(!0);L0(),Dd.current=i,Je=s,Mt!==null?t=0:(Qt=null,Jt=0,t=Ht)}if(t!==0){if(t===2&&(s=Pm(e),s!==0&&(n=s,t=up(e,s))),t===1)throw r=wu,ri(e,0),Ys(e,n),Dr(e,It()),r;if(t===6)Ys(e,n);else{if(s=e.current.alternate,!(n&30)&&!zT(s)&&(t=Bd(e,n),t===2&&(i=Pm(e),i!==0&&(n=i,t=up(e,i))),t===1))throw r=wu,ri(e,0),Ys(e,n),Dr(e,It()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(oe(345));case 2:Ba(e,Ir,ls);break;case 3:if(Ys(e,n),(n&130023424)===n&&(t=Y0+500-It(),10<t)){if(wd(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){vr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=zm(Ba.bind(null,e,Ir,ls),t);break}Ba(e,Ir,ls);break;case 4:if(Ys(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-Tn(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=It()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*$T(n/1960))-n,10<n){e.timeoutHandle=zm(Ba.bind(null,e,Ir,ls),n);break}Ba(e,Ir,ls);break;case 5:Ba(e,Ir,ls);break;default:throw Error(oe(329))}}}return Dr(e,It()),e.callbackNode===r?u2.bind(null,e):null}function up(e,t){var r=zo;return e.current.memoizedState.isDehydrated&&(ri(e,t).flags|=256),e=Bd(e,t),e!==2&&(t=Ir,Ir=r,t!==null&&cp(t)),e}function cp(e){Ir===null?Ir=e:Ir.push.apply(Ir,e)}function zT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ln(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ys(e,t){for(t&=~G0,t&=~bh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Tn(t),n=1<<r;e[r]=-1,t&=~n}}function sy(e){if(Je&6)throw Error(oe(327));sl();var t=wd(e,0);if(!(t&1))return Dr(e,It()),null;var r=Bd(e,t);if(e.tag!==0&&r===2){var n=Pm(e);n!==0&&(t=n,r=up(e,n))}if(r===1)throw r=wu,ri(e,0),Ys(e,t),Dr(e,It()),r;if(r===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ba(e,Ir,ls),Dr(e,It()),null}function Q0(e,t){var r=Je;Je|=1;try{return e(t)}finally{Je=r,Je===0&&(Rl=It()+500,ph&&Ta())}}function di(e){la!==null&&la.tag===0&&!(Je&6)&&sl();var t=Je;Je|=1;var r=ln.transition,n=it;try{if(ln.transition=null,it=1,e)return e()}finally{it=n,ln.transition=r,Je=t,!(Je&6)&&Ta()}}function K0(){Hr=Ki.current,yt(Ki)}function ri(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,bT(r)),Mt!==null)for(r=Mt.return;r!==null;){var n=r;switch(A0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Sd();break;case 3:Al(),yt(Or),yt(cr),B0();break;case 5:F0(n);break;case 4:Al();break;case 13:yt(kt);break;case 19:yt(kt);break;case 10:O0(n.type._context);break;case 22:case 23:K0()}r=r.return}if(Qt=e,Mt=e=xa(e.current,null),Jt=Hr=t,Ht=0,wu=null,G0=bh=ci=0,Ir=zo=null,qa!==null){for(t=0;t<qa.length;t++)if(r=qa[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}qa=null}return e}function c2(e,t){do{var r=Mt;try{if(L0(),ad.current=Pd,Od){for(var n=_t.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Od=!1}if(ui=0,Wt=Bt=_t=null,Ho=!1,yu=0,W0.current=null,r===null||r.return===null){Ht=1,wu=t,Mt=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=Jt,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=Vx(l);if(g!==null){g.flags&=-257,Wx(g,l,o,i,t),g.mode&1&&qx(i,c,t),t=g,u=c;var p=t.updateQueue;if(p===null){var y=new Set;y.add(u),t.updateQueue=y}else p.add(u);break e}else{if(!(t&1)){qx(i,c,t),Z0();break e}u=Error(oe(426))}}else if(wt&&o.mode&1){var v=Vx(l);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Wx(v,l,o,i,t),I0(Il(u,o));break e}}i=u=Il(u,o),Ht!==4&&(Ht=2),zo===null?zo=[i]:zo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Gw(i,u,t);Fx(i,x);break e;case 1:o=u;var b=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(pa===null||!pa.has(E)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Yw(i,o,t);Fx(i,_);break e}}i=i.return}while(i!==null)}f2(r)}catch(k){t=k,Mt===r&&r!==null&&(Mt=r=r.return);continue}break}while(!0)}function d2(){var e=Dd.current;return Dd.current=Pd,e===null?Pd:e}function Z0(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Qt===null||!(ci&268435455)&&!(bh&268435455)||Ys(Qt,Jt)}function Bd(e,t){var r=Je;Je|=2;var n=d2();(Qt!==e||Jt!==t)&&(ls=null,ri(e,t));do try{qT();break}catch(s){c2(e,s)}while(!0);if(L0(),Je=r,Dd.current=n,Mt!==null)throw Error(oe(261));return Qt=null,Jt=0,Ht}function qT(){for(;Mt!==null;)h2(Mt)}function VT(){for(;Mt!==null&&!gS();)h2(Mt)}function h2(e){var t=p2(e.alternate,e,Hr);e.memoizedProps=e.pendingProps,t===null?f2(e):Mt=t,W0.current=null}function f2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=FT(r,t),r!==null){r.flags&=32767,Mt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ht=6,Mt=null;return}}else if(r=MT(r,t,Hr),r!==null){Mt=r;return}if(t=t.sibling,t!==null){Mt=t;return}Mt=t=e}while(t!==null);Ht===0&&(Ht=5)}function Ba(e,t,r){var n=it,s=ln.transition;try{ln.transition=null,it=1,WT(e,t,r,n)}finally{ln.transition=s,it=n}return null}function WT(e,t,r,n){do sl();while(la!==null);if(Je&6)throw Error(oe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(SS(e,i),e===Qt&&(Mt=Qt=null,Jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Dc||(Dc=!0,g2(vd,function(){return sl(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ln.transition,ln.transition=null;var l=it;it=1;var o=Je;Je|=4,W0.current=null,UT(e,r),l2(r,e),hT(Hm),Ed=!!Um,Hm=Um=null,e.current=r,HT(r),xS(),Je=o,it=l,ln.transition=i}else e.current=r;if(Dc&&(Dc=!1,la=e,Fd=s),i=e.pendingLanes,i===0&&(pa=null),vS(r.stateNode),Dr(e,It()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Md)throw Md=!1,e=lp,lp=null,e;return Fd&1&&e.tag!==0&&sl(),i=e.pendingLanes,i&1?e===op?qo++:(qo=0,op=e):qo=0,Ta(),null}function sl(){if(la!==null){var e=Gv(Fd),t=ln.transition,r=it;try{if(ln.transition=null,it=16>e?16:e,la===null)var n=!1;else{if(e=la,la=null,Fd=0,Je&6)throw Error(oe(331));var s=Je;for(Je|=4,be=e.current;be!==null;){var i=be,l=i.child;if(be.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(be=c;be!==null;){var d=be;switch(d.tag){case 0:case 11:case 15:$o(8,d,i)}var h=d.child;if(h!==null)h.return=d,be=h;else for(;be!==null;){d=be;var f=d.sibling,g=d.return;if(s2(d),d===c){be=null;break}if(f!==null){f.return=g,be=f;break}be=g}}}var p=i.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}be=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,be=l;else e:for(;be!==null;){if(i=be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$o(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,be=x;break e}be=i.return}}var b=e.current;for(be=b;be!==null;){l=be;var E=l.child;if(l.subtreeFlags&2064&&E!==null)E.return=l,be=E;else e:for(l=b;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:yh(9,o)}}catch(k){jt(o,o.return,k)}if(o===l){be=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,be=_;break e}be=o.return}}if(Je=s,Ta(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(ch,e)}catch{}n=!0}return n}finally{it=r,ln.transition=t}}return!1}function ay(e,t,r){t=Il(r,t),t=Gw(e,t,1),e=ma(e,t,1),t=vr(),e!==null&&(Zu(e,1,t),Dr(e,t))}function jt(e,t,r){if(e.tag===3)ay(e,e,r);else for(;t!==null;){if(t.tag===3){ay(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(pa===null||!pa.has(n))){e=Il(r,e),e=Yw(t,e,1),t=ma(t,e,1),e=vr(),t!==null&&(Zu(t,1,e),Dr(t,e));break}}t=t.return}}function GT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=vr(),e.pingedLanes|=e.suspendedLanes&r,Qt===e&&(Jt&r)===r&&(Ht===4||Ht===3&&(Jt&130023424)===Jt&&500>It()-Y0?ri(e,0):G0|=r),Dr(e,t)}function m2(e,t){t===0&&(e.mode&1?(t=Sc,Sc<<=1,!(Sc&130023424)&&(Sc=4194304)):t=1);var r=vr();e=ws(e,t),e!==null&&(Zu(e,t,r),Dr(e,r))}function YT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),m2(e,r)}function QT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(oe(314))}n!==null&&n.delete(t),m2(e,r)}var p2;p2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Or.current)Lr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Lr=!1,DT(e,t,r);Lr=!!(e.flags&131072)}else Lr=!1,wt&&t.flags&1048576&&bw(t,jd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ld(e,t),e=t.pendingProps;var s=Tl(t,cr.current);nl(t,r),s=H0(null,t,n,e,s,r);var i=$0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(n)?(i=!0,Td(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,D0(t),s.updater=xh,t.stateNode=s,s._reactInternals=t,Km(t,n,e,r),t=Jm(null,t,n,!0,i,r)):(t.tag=0,wt&&i&&j0(t),yr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ld(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=ZT(n),e=yn(n,e),s){case 0:t=Xm(null,t,n,e,r);break e;case 1:t=Qx(null,t,n,e,r);break e;case 11:t=Gx(null,t,n,e,r);break e;case 14:t=Yx(null,t,n,yn(n.type,e),r);break e}throw Error(oe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yn(n,s),Xm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yn(n,s),Qx(e,t,n,s,r);case 3:e:{if(Xw(t),e===null)throw Error(oe(387));n=t.pendingProps,i=t.memoizedState,s=i.element,_w(e,t),Rd(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Il(Error(oe(423)),t),t=Kx(e,t,n,r,s);break e}else if(n!==s){s=Il(Error(oe(424)),t),t=Kx(e,t,n,r,s);break e}else for(zr=fa(t.stateNode.containerInfo.firstChild),qr=t,wt=!0,Nn=null,r=Nw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Cl(),n===s){t=Es(e,t,r);break e}yr(e,t,n,r)}t=t.child}return t;case 5:return Sw(t),e===null&&Gm(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,$m(n,s)?l=null:i!==null&&$m(n,i)&&(t.flags|=32),Zw(e,t),yr(e,t,l,r),t.child;case 6:return e===null&&Gm(t),null;case 13:return Jw(e,t,r);case 4:return M0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=jl(t,null,n,r):yr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yn(n,s),Gx(e,t,n,s,r);case 7:return yr(e,t,t.pendingProps,r),t.child;case 8:return yr(e,t,t.pendingProps.children,r),t.child;case 12:return yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,pt(Ad,n._currentValue),n._currentValue=l,i!==null)if(Ln(i.value,l)){if(i.children===s.children&&!Or.current){t=Es(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=xs(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Ym(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(oe(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Ym(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}yr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,nl(t,r),s=on(s),n=n(s),t.flags|=1,yr(e,t,n,r),t.child;case 14:return n=t.type,s=yn(n,t.pendingProps),s=yn(n.type,s),Yx(e,t,n,s,r);case 15:return Qw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:yn(n,s),ld(e,t),t.tag=1,Pr(n)?(e=!0,Td(t)):e=!1,nl(t,r),Ww(t,n,s),Km(t,n,s,r),Jm(null,t,n,!0,e,r);case 19:return e2(e,t,r);case 22:return Kw(e,t,r)}throw Error(oe(156,t.tag))};function g2(e,t){return zv(e,t)}function KT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,r,n){return new KT(e,t,r,n)}function X0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ZT(e){if(typeof e=="function")return X0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===x0)return 11;if(e===y0)return 14}return 2}function xa(e,t){var r=e.alternate;return r===null?(r=an(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function cd(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")X0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ui:return ni(r.children,s,i,t);case g0:l=8,s|=8;break;case vm:return e=an(12,r,t,s|2),e.elementType=vm,e.lanes=i,e;case wm:return e=an(13,r,t,s),e.elementType=wm,e.lanes=i,e;case Em:return e=an(19,r,t,s),e.elementType=Em,e.lanes=i,e;case Sv:return vh(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case kv:l=10;break e;case _v:l=9;break e;case x0:l=11;break e;case y0:l=14;break e;case $s:l=16,n=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=an(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function ni(e,t,r,n){return e=an(7,e,n,t),e.lanes=r,e}function vh(e,t,r,n){return e=an(22,e,n,t),e.elementType=Sv,e.lanes=r,e.stateNode={isHidden:!1},e}function jf(e,t,r){return e=an(6,e,null,t),e.lanes=r,e}function Af(e,t,r){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function XT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function J0(e,t,r,n,s,i,l,o,u){return e=new XT(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=an(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},D0(i),e}function JT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function x2(e){if(!e)return va;e=e._reactInternals;e:{if(wi(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var r=e.type;if(Pr(r))return xw(e,r,t)}return t}function y2(e,t,r,n,s,i,l,o,u){return e=J0(r,n,!0,e,s,i,l,o,u),e.context=x2(null),r=e.current,n=vr(),s=ga(r),i=xs(n,s),i.callback=t??null,ma(r,i,s),e.current.lanes=s,Zu(e,s,n),Dr(e,n),e}function wh(e,t,r,n){var s=t.current,i=vr(),l=ga(s);return r=x2(r),t.context===null?t.context=r:t.pendingContext=r,t=xs(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ma(s,t,l),e!==null&&(Cn(e,s,l,i),sd(e,s,l)),l}function Ud(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function iy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function eg(e,t){iy(e,t),(e=e.alternate)&&iy(e,t)}function eC(){return null}var b2=typeof reportError=="function"?reportError:function(e){console.error(e)};function tg(e){this._internalRoot=e}Eh.prototype.render=tg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));wh(e,t,null,null)};Eh.prototype.unmount=tg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;di(function(){wh(null,e,null,null)}),t[vs]=null}};function Eh(e){this._internalRoot=e}Eh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Kv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gs.length&&t!==0&&t<Gs[r].priority;r++);Gs.splice(r,0,e),r===0&&Xv(e)}};function rg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Nh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ly(){}function tC(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Ud(l);i.call(c)}}var l=y2(t,n,e,0,null,!1,!1,"",ly);return e._reactRootContainer=l,e[vs]=l.current,fu(e.nodeType===8?e.parentNode:e),di(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ud(u);o.call(c)}}var u=J0(e,0,!1,null,null,!1,!1,"",ly);return e._reactRootContainer=u,e[vs]=u.current,fu(e.nodeType===8?e.parentNode:e),di(function(){wh(t,u,r,n)}),u}function kh(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=Ud(l);o.call(u)}}wh(t,l,e,s)}else l=tC(r,t,e,s,n);return Ud(l)}Yv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Co(t.pendingLanes);r!==0&&(w0(t,r|1),Dr(t,It()),!(Je&6)&&(Rl=It()+500,Ta()))}break;case 13:di(function(){var n=ws(e,1);if(n!==null){var s=vr();Cn(n,e,1,s)}}),eg(e,1)}};E0=function(e){if(e.tag===13){var t=ws(e,134217728);if(t!==null){var r=vr();Cn(t,e,134217728,r)}eg(e,134217728)}};Qv=function(e){if(e.tag===13){var t=ga(e),r=ws(e,t);if(r!==null){var n=vr();Cn(r,e,t,n)}eg(e,t)}};Kv=function(){return it};Zv=function(e,t){var r=it;try{return it=e,t()}finally{it=r}};Rm=function(e,t,r){switch(t){case"input":if(_m(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=mh(n);if(!s)throw Error(oe(90));Cv(n),_m(n,s)}}}break;case"textarea":Av(e,r);break;case"select":t=r.value,t!=null&&Ji(e,!!r.multiple,t,!1)}};Mv=Q0;Fv=di;var rC={usingClientEntryPoint:!1,Events:[Ju,qi,mh,Pv,Dv,Q0]},po={findFiberByHostInstance:za,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nC={bundleType:po.bundleType,version:po.version,rendererPackageName:po.rendererPackageName,rendererConfig:po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hv(e),e===null?null:e.stateNode},findFiberByHostInstance:po.findFiberByHostInstance||eC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mc.isDisabled&&Mc.supportsFiber)try{ch=Mc.inject(nC),Yn=Mc}catch{}}Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rC;Yr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rg(t))throw Error(oe(200));return JT(e,t,null,r)};Yr.createRoot=function(e,t){if(!rg(e))throw Error(oe(299));var r=!1,n="",s=b2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=J0(e,1,!1,null,null,r,!1,n,s),e[vs]=t.current,fu(e.nodeType===8?e.parentNode:e),new tg(t)};Yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=Hv(t),e=e===null?null:e.stateNode,e};Yr.flushSync=function(e){return di(e)};Yr.hydrate=function(e,t,r){if(!Nh(t))throw Error(oe(200));return kh(null,e,t,!0,r)};Yr.hydrateRoot=function(e,t,r){if(!rg(e))throw Error(oe(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=b2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=y2(t,null,e,1,r??null,s,!1,i,l),e[vs]=t.current,fu(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Eh(t)};Yr.render=function(e,t,r){if(!Nh(t))throw Error(oe(200));return kh(null,e,t,!1,r)};Yr.unmountComponentAtNode=function(e){if(!Nh(e))throw Error(oe(40));return e._reactRootContainer?(di(function(){kh(null,null,e,!1,function(){e._reactRootContainer=null,e[vs]=null})}),!0):!1};Yr.unstable_batchedUpdates=Q0;Yr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Nh(r))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return kh(e,t,r,!1,n)};Yr.version="18.3.1-next-f1338f8080-20240426";function v2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v2)}catch(e){console.error(e)}}v2(),vv.exports=Yr;var sC=vv.exports,w2,oy=sC;w2=oy.createRoot,oy.hydrateRoot;var Vl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hi=typeof window>"u"||"Deno"in globalThis;function en(){}function aC(e,t){return typeof e=="function"?e(t):e}function dp(e){return typeof e=="number"&&e>=0&&e!==1/0}function E2(e,t){return Math.max(e+(t||0)-Date.now(),0)}function al(e,t){return typeof e=="function"?e(t):e}function kn(e,t){return typeof e=="function"?e(t):e}function uy(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==ng(l,t.options))return!1}else if(!Eu(t.queryKey,l))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||i&&!i(t))}function cy(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(fi(t.options.mutationKey)!==fi(i))return!1}else if(!Eu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function ng(e,t){return((t==null?void 0:t.queryKeyHashFn)||fi)(e)}function fi(e){return JSON.stringify(e,(t,r)=>hp(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Eu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Eu(e[r],t[r])):!1}function N2(e,t){if(e===t)return e;const r=dy(e)&&dy(t);if(r||hp(e)&&hp(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{};let u=0;for(let c=0;c<l;c++){const d=r?c:i[c];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=N2(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return s===l&&u===s?e:o}return t}function Hd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function dy(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function hp(e){if(!hy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!hy(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function hy(e){return Object.prototype.toString.call(e)==="[object Object]"}function iC(e){return new Promise(t=>{setTimeout(t,e)})}function fp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?N2(e,t):t}function lC(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function oC(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var sg=Symbol();function k2(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===sg?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Ya,Ks,fl,J1,uC=(J1=class extends Vl{constructor(){super();ke(this,Ya);ke(this,Ks);ke(this,fl);xe(this,fl,t=>{if(!hi&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){F(this,Ks)||this.setEventListener(F(this,fl))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Ks))==null||t.call(this),xe(this,Ks,void 0))}setEventListener(t){var r;xe(this,fl,t),(r=F(this,Ks))==null||r.call(this),xe(this,Ks,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){F(this,Ya)!==t&&(xe(this,Ya,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof F(this,Ya)=="boolean"?F(this,Ya):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ya=new WeakMap,Ks=new WeakMap,fl=new WeakMap,J1),ag=new uC,ml,Zs,pl,ev,cC=(ev=class extends Vl{constructor(){super();ke(this,ml,!0);ke(this,Zs);ke(this,pl);xe(this,pl,t=>{if(!hi&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){F(this,Zs)||this.setEventListener(F(this,pl))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Zs))==null||t.call(this),xe(this,Zs,void 0))}setEventListener(t){var r;xe(this,pl,t),(r=F(this,Zs))==null||r.call(this),xe(this,Zs,t(this.setOnline.bind(this)))}setOnline(t){F(this,ml)!==t&&(xe(this,ml,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return F(this,ml)}},ml=new WeakMap,Zs=new WeakMap,pl=new WeakMap,ev),$d=new cC;function mp(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function dC(e){return Math.min(1e3*2**e,3e4)}function _2(e){return(e??"online")==="online"?$d.isOnline():!0}var S2=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function If(e){return e instanceof S2}function T2(e){let t=!1,r=0,n=!1,s;const i=mp(),l=y=>{var v;n||(f(new S2(y)),(v=e.abort)==null||v.call(e))},o=()=>{t=!0},u=()=>{t=!1},c=()=>ag.isFocused()&&(e.networkMode==="always"||$d.isOnline())&&e.canRun(),d=()=>_2(e.networkMode)&&e.canRun(),h=y=>{var v;n||(n=!0,(v=e.onSuccess)==null||v.call(e,y),s==null||s(),i.resolve(y))},f=y=>{var v;n||(n=!0,(v=e.onError)==null||v.call(e,y),s==null||s(),i.reject(y))},g=()=>new Promise(y=>{var v;s=x=>{(n||c())&&y(x)},(v=e.onPause)==null||v.call(e)}).then(()=>{var y;s=void 0,n||(y=e.onContinue)==null||y.call(e)}),p=()=>{if(n)return;let y;const v=r===0?e.initialPromise:void 0;try{y=v??e.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(h).catch(x=>{var S;if(n)return;const b=e.retry??(hi?0:3),E=e.retryDelay??dC,_=typeof E=="function"?E(r,x):E,k=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,x);if(t||!k){f(x);return}r++,(S=e.onFail)==null||S.call(e,r,x),iC(_).then(()=>c()?void 0:g()).then(()=>{t?f(x):p()})})};return{promise:i,cancel:l,continue:()=>(s==null||s(),i),cancelRetry:o,continueRetry:u,canStart:d,start:()=>(d()?p():g().then(p),i)}}var hC=e=>setTimeout(e,0);function fC(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=hC;const i=o=>{t?e.push(o):s(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||l()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var Ut=fC(),Qa,tv,C2=(tv=class{constructor(){ke(this,Qa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dp(this.gcTime)&&xe(this,Qa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(hi?1/0:5*60*1e3))}clearGcTimeout(){F(this,Qa)&&(clearTimeout(F(this,Qa)),xe(this,Qa,void 0))}},Qa=new WeakMap,tv),gl,xl,Jr,Ka,ar,Wu,Za,bn,ss,rv,mC=(rv=class extends C2{constructor(t){super();ke(this,bn);ke(this,gl);ke(this,xl);ke(this,Jr);ke(this,Ka);ke(this,ar);ke(this,Wu);ke(this,Za);xe(this,Za,!1),xe(this,Wu,t.defaultOptions),this.setOptions(t.options),this.observers=[],xe(this,Ka,t.client),xe(this,Jr,F(this,Ka).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,xe(this,gl,pC(this.options)),this.state=t.state??F(this,gl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=F(this,ar))==null?void 0:t.promise}setOptions(t){this.options={...F(this,Wu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&F(this,Jr).remove(this)}setData(t,r){const n=fp(this.state.data,t,this.options);return Be(this,bn,ss).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Be(this,bn,ss).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=F(this,ar))==null?void 0:n.promise;return(s=F(this,ar))==null||s.cancel(t),r?r.then(en).catch(en):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(F(this,gl))}isActive(){return this.observers.some(t=>kn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===sg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!E2(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,ar))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,ar))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),F(this,Jr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(F(this,ar)&&(F(this,Za)?F(this,ar).cancel({revert:!0}):F(this,ar).cancelRetry()),this.scheduleGc()),F(this,Jr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Be(this,bn,ss).call(this,{type:"invalidate"})}fetch(t,r){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(F(this,ar))return F(this,ar).continueRetry(),F(this,ar).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(xe(this,Za,!0),n.signal)})},i=()=>{const h=k2(this.options,r),f={client:F(this,Ka),queryKey:this.queryKey,meta:this.meta};return s(f),xe(this,Za,!1),this.options.persister?this.options.persister(h,f,this):h(f)},l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:F(this,Ka),state:this.state,fetchFn:i};s(l),(u=this.options.behavior)==null||u.onFetch(l,this),xe(this,xl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=l.fetchOptions)==null?void 0:c.meta))&&Be(this,bn,ss).call(this,{type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta});const o=h=>{var f,g,p,y;If(h)&&h.silent||Be(this,bn,ss).call(this,{type:"error",error:h}),If(h)||((g=(f=F(this,Jr).config).onError)==null||g.call(f,h,this),(y=(p=F(this,Jr).config).onSettled)==null||y.call(p,this.state.data,h,this)),this.scheduleGc()};return xe(this,ar,T2({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,g,p,y;if(h===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(v){o(v);return}(g=(f=F(this,Jr).config).onSuccess)==null||g.call(f,h,this),(y=(p=F(this,Jr).config).onSettled)==null||y.call(p,h,this.state.error,this),this.scheduleGc()},onError:o,onFail:(h,f)=>{Be(this,bn,ss).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{Be(this,bn,ss).call(this,{type:"pause"})},onContinue:()=>{Be(this,bn,ss).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),F(this,ar).start()}},gl=new WeakMap,xl=new WeakMap,Jr=new WeakMap,Ka=new WeakMap,ar=new WeakMap,Wu=new WeakMap,Za=new WeakMap,bn=new WeakSet,ss=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...j2(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return If(s)&&s.revert&&F(this,xl)?{...F(this,xl),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Ut.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),F(this,Jr).notify({query:this,type:"updated",action:t})})},rv);function j2(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_2(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function pC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var zn,nv,gC=(nv=class extends Vl{constructor(t={}){super();ke(this,zn);this.config=t,xe(this,zn,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??ng(s,r);let l=this.get(i);return l||(l=new mC({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){F(this,zn).has(t.queryHash)||(F(this,zn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=F(this,zn).get(t.queryHash);r&&(t.destroy(),r===t&&F(this,zn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return F(this,zn).get(t)}getAll(){return[...F(this,zn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>uy(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>uy(t,n)):r}notify(t){Ut.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},zn=new WeakMap,nv),qn,gr,Xa,Vn,Ms,sv,xC=(sv=class extends C2{constructor(t){super();ke(this,Vn);ke(this,qn);ke(this,gr);ke(this,Xa);this.mutationId=t.mutationId,xe(this,gr,t.mutationCache),xe(this,qn,[]),this.state=t.state||A2(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){F(this,qn).includes(t)||(F(this,qn).push(t),this.clearGcTimeout(),F(this,gr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){xe(this,qn,F(this,qn).filter(r=>r!==t)),this.scheduleGc(),F(this,gr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){F(this,qn).length||(this.state.status==="pending"?this.scheduleGc():F(this,gr).remove(this))}continue(){var t;return((t=F(this,Xa))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,u,c,d,h,f,g,p,y,v,x,b,E,_,k,S,I,A;const r=()=>{Be(this,Vn,Ms).call(this,{type:"continue"})};xe(this,Xa,T2({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(D,T)=>{Be(this,Vn,Ms).call(this,{type:"failed",failureCount:D,error:T})},onPause:()=>{Be(this,Vn,Ms).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>F(this,gr).canRun(this)}));const n=this.state.status==="pending",s=!F(this,Xa).canStart();try{if(n)r();else{Be(this,Vn,Ms).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(i=F(this,gr).config).onMutate)==null?void 0:l.call(i,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&Be(this,Vn,Ms).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const D=await F(this,Xa).start();return await((d=(c=F(this,gr).config).onSuccess)==null?void 0:d.call(c,D,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,D,t,this.state.context)),await((p=(g=F(this,gr).config).onSettled)==null?void 0:p.call(g,D,null,this.state.variables,this.state.context,this)),await((v=(y=this.options).onSettled)==null?void 0:v.call(y,D,null,t,this.state.context)),Be(this,Vn,Ms).call(this,{type:"success",data:D}),D}catch(D){try{throw await((b=(x=F(this,gr).config).onError)==null?void 0:b.call(x,D,t,this.state.context,this)),await((_=(E=this.options).onError)==null?void 0:_.call(E,D,t,this.state.context)),await((S=(k=F(this,gr).config).onSettled)==null?void 0:S.call(k,void 0,D,this.state.variables,this.state.context,this)),await((A=(I=this.options).onSettled)==null?void 0:A.call(I,void 0,D,t,this.state.context)),D}finally{Be(this,Vn,Ms).call(this,{type:"error",error:D})}}finally{F(this,gr).runNext(this)}}},qn=new WeakMap,gr=new WeakMap,Xa=new WeakMap,Vn=new WeakSet,Ms=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ut.batch(()=>{F(this,qn).forEach(n=>{n.onMutationUpdate(t)}),F(this,gr).notify({mutation:this,type:"updated",action:t})})},sv);function A2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var hs,vn,Gu,av,yC=(av=class extends Vl{constructor(t={}){super();ke(this,hs);ke(this,vn);ke(this,Gu);this.config=t,xe(this,hs,new Set),xe(this,vn,new Map),xe(this,Gu,0)}build(t,r,n){const s=new xC({mutationCache:this,mutationId:++vc(this,Gu)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){F(this,hs).add(t);const r=Fc(t);if(typeof r=="string"){const n=F(this,vn).get(r);n?n.push(t):F(this,vn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(F(this,hs).delete(t)){const r=Fc(t);if(typeof r=="string"){const n=F(this,vn).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&F(this,vn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Fc(t);if(typeof r=="string"){const n=F(this,vn).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=Fc(t);if(typeof r=="string"){const s=(n=F(this,vn).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ut.batch(()=>{F(this,hs).forEach(t=>{this.notify({type:"removed",mutation:t})}),F(this,hs).clear(),F(this,vn).clear()})}getAll(){return Array.from(F(this,hs))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>cy(r,n))}findAll(t={}){return this.getAll().filter(r=>cy(t,r))}notify(t){Ut.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ut.batch(()=>Promise.all(t.map(r=>r.continue().catch(en))))}},hs=new WeakMap,vn=new WeakMap,Gu=new WeakMap,av);function Fc(e){var t;return(t=e.options.scope)==null?void 0:t.id}function fy(e){return{onFetch:(t,r)=>{var d,h,f,g,p;const n=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((g=t.state.data)==null?void 0:g.pages)||[],l=((p=t.state.data)==null?void 0:p.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let y=!1;const v=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},x=k2(t.options,t.fetchOptions),b=async(E,_,k)=>{if(y)return Promise.reject();if(_==null&&E.pages.length)return Promise.resolve(E);const S={client:t.client,queryKey:t.queryKey,pageParam:_,direction:k?"backward":"forward",meta:t.options.meta};v(S);const I=await x(S),{maxPages:A}=t.options,D=k?oC:lC;return{pages:D(E.pages,I,A),pageParams:D(E.pageParams,_,A)}};if(s&&i.length){const E=s==="backward",_=E?bC:my,k={pages:i,pageParams:l},S=_(n,k);o=await b(k,S,E)}else{const E=e??i.length;do{const _=u===0?l[0]??n.initialPageParam:my(n,o);if(u>0&&_==null)break;o=await b(o,_),u++}while(u<E)}return o};t.options.persister?t.fetchFn=()=>{var y,v;return(v=(y=t.options).persister)==null?void 0:v.call(y,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function my(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function bC(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Ct,Xs,Js,yl,bl,ea,vl,wl,iv,vC=(iv=class{constructor(e={}){ke(this,Ct);ke(this,Xs);ke(this,Js);ke(this,yl);ke(this,bl);ke(this,ea);ke(this,vl);ke(this,wl);xe(this,Ct,e.queryCache||new gC),xe(this,Xs,e.mutationCache||new yC),xe(this,Js,e.defaultOptions||{}),xe(this,yl,new Map),xe(this,bl,new Map),xe(this,ea,0)}mount(){vc(this,ea)._++,F(this,ea)===1&&(xe(this,vl,ag.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,Ct).onFocus())})),xe(this,wl,$d.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,Ct).onOnline())})))}unmount(){var e,t;vc(this,ea)._--,F(this,ea)===0&&((e=F(this,vl))==null||e.call(this),xe(this,vl,void 0),(t=F(this,wl))==null||t.call(this),xe(this,wl,void 0))}isFetching(e){return F(this,Ct).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return F(this,Xs).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,Ct).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=F(this,Ct).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(al(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return F(this,Ct).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=F(this,Ct).get(n.queryHash),i=s==null?void 0:s.state.data,l=aC(t,i);if(l!==void 0)return F(this,Ct).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return Ut.batch(()=>F(this,Ct).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,Ct).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=F(this,Ct);Ut.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=F(this,Ct);return Ut.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Ut.batch(()=>F(this,Ct).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(en).catch(en)}invalidateQueries(e,t={}){return Ut.batch(()=>(F(this,Ct).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Ut.batch(()=>F(this,Ct).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(en)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(en)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=F(this,Ct).build(this,t);return r.isStaleByTime(al(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(en).catch(en)}fetchInfiniteQuery(e){return e.behavior=fy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(en).catch(en)}ensureInfiniteQueryData(e){return e.behavior=fy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return $d.isOnline()?F(this,Xs).resumePausedMutations():Promise.resolve()}getQueryCache(){return F(this,Ct)}getMutationCache(){return F(this,Xs)}getDefaultOptions(){return F(this,Js)}setDefaultOptions(e){xe(this,Js,e)}setQueryDefaults(e,t){F(this,yl).set(fi(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...F(this,yl).values()],r={};return t.forEach(n=>{Eu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){F(this,bl).set(fi(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...F(this,bl).values()],r={};return t.forEach(n=>{Eu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...F(this,Js).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ng(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===sg&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...F(this,Js).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){F(this,Ct).clear(),F(this,Xs).clear()}},Ct=new WeakMap,Xs=new WeakMap,Js=new WeakMap,yl=new WeakMap,bl=new WeakMap,ea=new WeakMap,vl=new WeakMap,wl=new WeakMap,iv),jr,Ge,Yu,xr,Ja,El,ta,ra,Qu,Nl,kl,ei,ti,na,_l,st,Ao,pp,gp,xp,yp,bp,vp,wp,I2,lv,wC=(lv=class extends Vl{constructor(t,r){super();ke(this,st);ke(this,jr);ke(this,Ge);ke(this,Yu);ke(this,xr);ke(this,Ja);ke(this,El);ke(this,ta);ke(this,ra);ke(this,Qu);ke(this,Nl);ke(this,kl);ke(this,ei);ke(this,ti);ke(this,na);ke(this,_l,new Set);this.options=r,xe(this,jr,t),xe(this,ra,null),xe(this,ta,mp()),this.options.experimental_prefetchInRender||F(this,ta).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(F(this,Ge).addObserver(this),py(F(this,Ge),this.options)?Be(this,st,Ao).call(this):this.updateResult(),Be(this,st,yp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ep(F(this,Ge),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ep(F(this,Ge),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Be(this,st,bp).call(this),Be(this,st,vp).call(this),F(this,Ge).removeObserver(this)}setOptions(t){const r=this.options,n=F(this,Ge);if(this.options=F(this,jr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof kn(this.options.enabled,F(this,Ge))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Be(this,st,wp).call(this),F(this,Ge).setOptions(this.options),r._defaulted&&!Hd(this.options,r)&&F(this,jr).getQueryCache().notify({type:"observerOptionsUpdated",query:F(this,Ge),observer:this});const s=this.hasListeners();s&&gy(F(this,Ge),n,this.options,r)&&Be(this,st,Ao).call(this),this.updateResult(),s&&(F(this,Ge)!==n||kn(this.options.enabled,F(this,Ge))!==kn(r.enabled,F(this,Ge))||al(this.options.staleTime,F(this,Ge))!==al(r.staleTime,F(this,Ge)))&&Be(this,st,pp).call(this);const i=Be(this,st,gp).call(this);s&&(F(this,Ge)!==n||kn(this.options.enabled,F(this,Ge))!==kn(r.enabled,F(this,Ge))||i!==F(this,na))&&Be(this,st,xp).call(this,i)}getOptimisticResult(t){const r=F(this,jr).getQueryCache().build(F(this,jr),t),n=this.createResult(r,t);return NC(this,n)&&(xe(this,xr,n),xe(this,El,this.options),xe(this,Ja,F(this,Ge).state)),n}getCurrentResult(){return F(this,xr)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){F(this,_l).add(t)}getCurrentQuery(){return F(this,Ge)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=F(this,jr).defaultQueryOptions(t),n=F(this,jr).getQueryCache().build(F(this,jr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Be(this,st,Ao).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),F(this,xr)))}createResult(t,r){var D;const n=F(this,Ge),s=this.options,i=F(this,xr),l=F(this,Ja),o=F(this,El),c=t!==n?t.state:F(this,Yu),{state:d}=t;let h={...d},f=!1,g;if(r._optimisticResults){const T=this.hasListeners(),H=!T&&py(t,r),L=T&&gy(t,n,r,s);(H||L)&&(h={...h,...j2(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:y,status:v}=h;g=h.data;let x=!1;if(r.placeholderData!==void 0&&g===void 0&&v==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,x=!0):T=typeof r.placeholderData=="function"?r.placeholderData((D=F(this,kl))==null?void 0:D.state.data,F(this,kl)):r.placeholderData,T!==void 0&&(v="success",g=fp(i==null?void 0:i.data,T,r),f=!0)}if(r.select&&g!==void 0&&!x)if(i&&g===(l==null?void 0:l.data)&&r.select===F(this,Qu))g=F(this,Nl);else try{xe(this,Qu,r.select),g=r.select(g),g=fp(i==null?void 0:i.data,g,r),xe(this,Nl,g),xe(this,ra,null)}catch(T){xe(this,ra,T)}F(this,ra)&&(p=F(this,ra),g=F(this,Nl),y=Date.now(),v="error");const b=h.fetchStatus==="fetching",E=v==="pending",_=v==="error",k=E&&b,S=g!==void 0,A={status:v,fetchStatus:h.fetchStatus,isPending:E,isSuccess:v==="success",isError:_,isInitialLoading:k,isLoading:k,data:g,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:b,isRefetching:b&&!E,isLoadingError:_&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&S,isStale:ig(t,r),refetch:this.refetch,promise:F(this,ta)};if(this.options.experimental_prefetchInRender){const T=G=>{A.status==="error"?G.reject(A.error):A.data!==void 0&&G.resolve(A.data)},H=()=>{const G=xe(this,ta,A.promise=mp());T(G)},L=F(this,ta);switch(L.status){case"pending":t.queryHash===n.queryHash&&T(L);break;case"fulfilled":(A.status==="error"||A.data!==L.value)&&H();break;case"rejected":(A.status!=="error"||A.error!==L.reason)&&H();break}}return A}updateResult(){const t=F(this,xr),r=this.createResult(F(this,Ge),this.options);if(xe(this,Ja,F(this,Ge).state),xe(this,El,this.options),F(this,Ja).data!==void 0&&xe(this,kl,F(this,Ge)),Hd(r,t))return;xe(this,xr,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!F(this,_l).size)return!0;const l=new Set(i??F(this,_l));return this.options.throwOnError&&l.add("error"),Object.keys(F(this,xr)).some(o=>{const u=o;return F(this,xr)[u]!==t[u]&&l.has(u)})};Be(this,st,I2).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Be(this,st,yp).call(this)}},jr=new WeakMap,Ge=new WeakMap,Yu=new WeakMap,xr=new WeakMap,Ja=new WeakMap,El=new WeakMap,ta=new WeakMap,ra=new WeakMap,Qu=new WeakMap,Nl=new WeakMap,kl=new WeakMap,ei=new WeakMap,ti=new WeakMap,na=new WeakMap,_l=new WeakMap,st=new WeakSet,Ao=function(t){Be(this,st,wp).call(this);let r=F(this,Ge).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(en)),r},pp=function(){Be(this,st,bp).call(this);const t=al(this.options.staleTime,F(this,Ge));if(hi||F(this,xr).isStale||!dp(t))return;const n=E2(F(this,xr).dataUpdatedAt,t)+1;xe(this,ei,setTimeout(()=>{F(this,xr).isStale||this.updateResult()},n))},gp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(F(this,Ge)):this.options.refetchInterval)??!1},xp=function(t){Be(this,st,vp).call(this),xe(this,na,t),!(hi||kn(this.options.enabled,F(this,Ge))===!1||!dp(F(this,na))||F(this,na)===0)&&xe(this,ti,setInterval(()=>{(this.options.refetchIntervalInBackground||ag.isFocused())&&Be(this,st,Ao).call(this)},F(this,na)))},yp=function(){Be(this,st,pp).call(this),Be(this,st,xp).call(this,Be(this,st,gp).call(this))},bp=function(){F(this,ei)&&(clearTimeout(F(this,ei)),xe(this,ei,void 0))},vp=function(){F(this,ti)&&(clearInterval(F(this,ti)),xe(this,ti,void 0))},wp=function(){const t=F(this,jr).getQueryCache().build(F(this,jr),this.options);if(t===F(this,Ge))return;const r=F(this,Ge);xe(this,Ge,t),xe(this,Yu,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},I2=function(t){Ut.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(F(this,xr))}),F(this,jr).getQueryCache().notify({query:F(this,Ge),type:"observerResultsUpdated"})})},lv);function EC(e,t){return kn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function py(e,t){return EC(e,t)||e.state.data!==void 0&&Ep(e,t,t.refetchOnMount)}function Ep(e,t,r){if(kn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&ig(e,t)}return!1}function gy(e,t,r,n){return(e!==t||kn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&ig(e,r)}function ig(e,t){return kn(t.enabled,e)!==!1&&e.isStaleByTime(al(t.staleTime,e))}function NC(e,t){return!Hd(e.getCurrentResult(),t)}var sa,aa,Ar,fs,ys,dd,Np,ov,kC=(ov=class extends Vl{constructor(r,n){super();ke(this,ys);ke(this,sa);ke(this,aa);ke(this,Ar);ke(this,fs);xe(this,sa,r),this.setOptions(n),this.bindMethods(),Be(this,ys,dd).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=F(this,sa).defaultMutationOptions(r),Hd(this.options,n)||F(this,sa).getMutationCache().notify({type:"observerOptionsUpdated",mutation:F(this,Ar),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&fi(n.mutationKey)!==fi(this.options.mutationKey)?this.reset():((s=F(this,Ar))==null?void 0:s.state.status)==="pending"&&F(this,Ar).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=F(this,Ar))==null||r.removeObserver(this)}onMutationUpdate(r){Be(this,ys,dd).call(this),Be(this,ys,Np).call(this,r)}getCurrentResult(){return F(this,aa)}reset(){var r;(r=F(this,Ar))==null||r.removeObserver(this),xe(this,Ar,void 0),Be(this,ys,dd).call(this),Be(this,ys,Np).call(this)}mutate(r,n){var s;return xe(this,fs,n),(s=F(this,Ar))==null||s.removeObserver(this),xe(this,Ar,F(this,sa).getMutationCache().build(F(this,sa),this.options)),F(this,Ar).addObserver(this),F(this,Ar).execute(r)}},sa=new WeakMap,aa=new WeakMap,Ar=new WeakMap,fs=new WeakMap,ys=new WeakSet,dd=function(){var n;const r=((n=F(this,Ar))==null?void 0:n.state)??A2();xe(this,aa,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Np=function(r){Ut.batch(()=>{var n,s,i,l,o,u,c,d;if(F(this,fs)&&this.hasListeners()){const h=F(this,aa).variables,f=F(this,aa).context;(r==null?void 0:r.type)==="success"?((s=(n=F(this,fs)).onSuccess)==null||s.call(n,r.data,h,f),(l=(i=F(this,fs)).onSettled)==null||l.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((u=(o=F(this,fs)).onError)==null||u.call(o,r.error,h,f),(d=(c=F(this,fs)).onSettled)==null||d.call(c,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(F(this,aa))})})},ov),R2=w.createContext(void 0),cn=e=>{const t=w.useContext(R2);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},L2=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(R2.Provider,{value:e,children:t})),O2=w.createContext(!1),_C=()=>w.useContext(O2);O2.Provider;function SC(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var TC=w.createContext(SC()),CC=()=>w.useContext(TC);function P2(e,t){return typeof e=="function"?e(...t):!!e}function kp(){}var jC=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},AC=e=>{w.useEffect(()=>{e.clearReset()},[e])},IC=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||P2(r,[e.error,n])),RC=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},LC=(e,t)=>e.isLoading&&e.isFetching&&!t,OC=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,xy=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function PC(e,t,r){var h,f,g,p,y;const n=cn(),s=_C(),i=CC(),l=n.defaultQueryOptions(e);(f=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",RC(l),jC(l,i),AC(i);const o=!n.getQueryCache().get(l.queryHash),[u]=w.useState(()=>new t(n,l)),c=u.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(v=>{const x=d?u.subscribe(Ut.batchCalls(v)):kp;return u.updateResult(),x},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(l)},[l,u]),OC(l,c))throw xy(l,u,i);if(IC({result:c,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((p=(g=n.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||p.call(g,l,c),l.experimental_prefetchInRender&&!hi&&LC(c,s)){const v=o?xy(l,u,i):(y=n.getQueryCache().get(l.queryHash))==null?void 0:y.promise;v==null||v.catch(kp).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function Lt(e,t){return PC(e,wC)}function Et(e,t){const r=cn(),[n]=w.useState(()=>new kC(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const s=w.useSyncExternalStore(w.useCallback(l=>n.subscribe(Ut.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((l,o)=>{n.mutate(l,o).catch(kp)},[n]);if(s.error&&P2(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nu(){return Nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nu.apply(this,arguments)}var oa;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(oa||(oa={}));const yy="popstate";function DC(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return _p("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:zd(s)}return FC(t,r,null,e)}function Ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function D2(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function MC(){return Math.random().toString(36).substr(2,8)}function by(e,t){return{usr:e.state,key:e.key,idx:t}}function _p(e,t,r,n){return r===void 0&&(r=null),Nu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Wl(t):t,{state:r,key:t&&t.key||n||MC()})}function zd(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Wl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function FC(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=oa.Pop,u=null,c=d();c==null&&(c=0,l.replaceState(Nu({},l.state,{idx:c}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=oa.Pop;let v=d(),x=v==null?null:v-c;c=v,u&&u({action:o,location:y.location,delta:x})}function f(v,x){o=oa.Push;let b=_p(y.location,v,x);c=d()+1;let E=by(b,c),_=y.createHref(b);try{l.pushState(E,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(_)}i&&u&&u({action:o,location:y.location,delta:1})}function g(v,x){o=oa.Replace;let b=_p(y.location,v,x);c=d();let E=by(b,c),_=y.createHref(b);l.replaceState(E,"",_),i&&u&&u({action:o,location:y.location,delta:0})}function p(v){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof v=="string"?v:zd(v);return b=b.replace(/ $/,"%20"),Ot(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let y={get action(){return o},get location(){return e(s,l)},listen(v){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(yy,h),u=v,()=>{s.removeEventListener(yy,h),u=null}},createHref(v){return t(s,v)},createURL:p,encodeLocation(v){let x=p(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:g,go(v){return l.go(v)}};return y}var vy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(vy||(vy={}));function BC(e,t,r){return r===void 0&&(r="/"),UC(e,t,r)}function UC(e,t,r,n){let s=typeof t=="string"?Wl(t):t,i=lg(s.pathname||"/",r);if(i==null)return null;let l=M2(e);HC(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=JC(i);o=KC(l[u],c)}return o}function M2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(Ot(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=ya([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(Ot(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),M2(i.children,t,d,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:YC(c,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of F2(i.path))s(i,l,u)}),t}function F2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=F2(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function HC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:QC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const $C=/^:[\w-]+$/,zC=3,qC=2,VC=1,WC=10,GC=-2,wy=e=>e==="*";function YC(e,t){let r=e.split("/"),n=r.length;return r.some(wy)&&(n+=GC),t&&(n+=qC),r.filter(s=>!wy(s)).reduce((s,i)=>s+($C.test(i)?zC:i===""?VC:WC),n)}function QC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function KC(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=ZC({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),l.push({params:s,pathname:ya([i,h.pathname]),pathnameBase:nj(ya([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ya([i,h.pathnameBase]))}return l}function ZC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=XC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:g}=d;if(f==="*"){let y=o[h]||"";l=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const p=o[h];return g&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function XC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),D2(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function JC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return D2(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function lg(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ej(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Wl(e):e;return{pathname:r?r.startsWith("/")?r:tj(r,t):t,search:sj(n),hash:aj(s)}}function tj(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Rf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rj(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function og(e,t){let r=rj(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ug(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Wl(e):(s=Nu({},e),Ot(!s.pathname||!s.pathname.includes("?"),Rf("?","pathname","search",s)),Ot(!s.pathname||!s.pathname.includes("#"),Rf("#","pathname","hash",s)),Ot(!s.search||!s.search.includes("#"),Rf("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let u=ej(s,o),c=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const ya=e=>e.join("/").replace(/\/\/+/g,"/"),nj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,aj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ij(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const B2=["post","put","patch","delete"];new Set(B2);const lj=["get",...B2];new Set(lj);/**
 * React Router v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(this,arguments)}const cg=w.createContext(null),oj=w.createContext(null),Ca=w.createContext(null),_h=w.createContext(null),Ts=w.createContext({outlet:null,matches:[],isDataRoute:!1}),U2=w.createContext(null);function uj(e,t){let{relative:r}=t===void 0?{}:t;Gl()||Ot(!1);let{basename:n,navigator:s}=w.useContext(Ca),{hash:i,pathname:l,search:o}=$2(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:ya([n,l])),s.createHref({pathname:u,search:o,hash:i})}function Gl(){return w.useContext(_h)!=null}function ja(){return Gl()||Ot(!1),w.useContext(_h).location}function H2(e){w.useContext(Ca).static||w.useLayoutEffect(e)}function dn(){let{isDataRoute:e}=w.useContext(Ts);return e?Ej():cj()}function cj(){Gl()||Ot(!1);let e=w.useContext(cg),{basename:t,future:r,navigator:n}=w.useContext(Ca),{matches:s}=w.useContext(Ts),{pathname:i}=ja(),l=JSON.stringify(og(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return H2(()=>{o.current=!0}),w.useCallback(function(c,d){if(d===void 0&&(d={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=ug(c,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ya([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,l,i,e])}function dg(){let{matches:e}=w.useContext(Ts),t=e[e.length-1];return t?t.params:{}}function $2(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(Ca),{matches:s}=w.useContext(Ts),{pathname:i}=ja(),l=JSON.stringify(og(s,n.v7_relativeSplatPath));return w.useMemo(()=>ug(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function dj(e,t){return hj(e,t)}function hj(e,t,r,n){Gl()||Ot(!1);let{navigator:s}=w.useContext(Ca),{matches:i}=w.useContext(Ts),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=ja(),d;if(t){var h;let v=typeof t=="string"?Wl(t):t;u==="/"||(h=v.pathname)!=null&&h.startsWith(u)||Ot(!1),d=v}else d=c;let f=d.pathname||"/",g=f;if(u!=="/"){let v=u.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=BC(e,{pathname:g}),y=xj(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:ya([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:ya([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&y?w.createElement(_h.Provider,{value:{location:ku({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:oa.Pop}},y):y}function fj(){let e=wj(),t=ij(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const mj=w.createElement(fj,null);class pj extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(Ts.Provider,{value:this.props.routeContext},w.createElement(U2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gj(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(cg);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(Ts.Provider,{value:t},n)}function xj(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Ot(!1),l=l.slice(0,Math.min(l.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:g}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||p){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let g,p=!1,y=null,v=null;r&&(g=o&&h.route.id?o[h.route.id]:void 0,y=h.route.errorElement||mj,u&&(c<0&&f===0?(Nj("route-fallback"),p=!0,v=null):c===f&&(p=!0,v=h.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),b=()=>{let E;return g?E=y:p?E=v:h.route.Component?E=w.createElement(h.route.Component,null):h.route.element?E=h.route.element:E=d,w.createElement(gj,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:E})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(pj,{location:r.location,revalidation:r.revalidation,component:y,error:g,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var z2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(z2||{}),q2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(q2||{});function yj(e){let t=w.useContext(cg);return t||Ot(!1),t}function bj(e){let t=w.useContext(oj);return t||Ot(!1),t}function vj(e){let t=w.useContext(Ts);return t||Ot(!1),t}function V2(e){let t=vj(),r=t.matches[t.matches.length-1];return r.route.id||Ot(!1),r.route.id}function wj(){var e;let t=w.useContext(U2),r=bj(),n=V2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Ej(){let{router:e}=yj(z2.UseNavigateStable),t=V2(q2.UseNavigateStable),r=w.useRef(!1);return H2(()=>{r.current=!0}),w.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ku({fromRouteId:t},i)))},[e,t])}const Ey={};function Nj(e,t,r){Ey[e]||(Ey[e]=!0)}const Ny={};function kj(e,t){Ny[t]||(Ny[t]=!0,console.warn(t))}const ky=(e,t,r)=>kj(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function _j(e,t){(e==null?void 0:e.v7_startTransition)===void 0&&ky("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&ky("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Vo(e){let{to:t,replace:r,state:n,relative:s}=e;Gl()||Ot(!1);let{future:i,static:l}=w.useContext(Ca),{matches:o}=w.useContext(Ts),{pathname:u}=ja(),c=dn(),d=ug(t,og(o,i.v7_relativeSplatPath),u,s==="path"),h=JSON.stringify(d);return w.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function Xr(e){Ot(!1)}function Sj(e){let{basename:t="/",children:r=null,location:n,navigationType:s=oa.Pop,navigator:i,static:l=!1,future:o}=e;Gl()&&Ot(!1);let u=t.replace(/^\/*/,"/"),c=w.useMemo(()=>({basename:u,navigator:i,static:l,future:ku({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Wl(n));let{pathname:d="/",search:h="",hash:f="",state:g=null,key:p="default"}=n,y=w.useMemo(()=>{let v=lg(d,u);return v==null?null:{location:{pathname:v,search:h,hash:f,state:g,key:p},navigationType:s}},[u,d,h,f,g,p,s]);return y==null?null:w.createElement(Ca.Provider,{value:c},w.createElement(_h.Provider,{children:r,value:y}))}function _y(e){let{children:t,location:r}=e;return dj(Sp(t),r)}new Promise(()=>{});function Sp(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let i=[...t,s];if(n.type===w.Fragment){r.push.apply(r,Sp(n.props.children,i));return}n.type!==Xr&&Ot(!1),!n.props.index||!n.props.children||Ot(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Sp(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tp(){return Tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tp.apply(this,arguments)}function Tj(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Cj(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jj(e,t){return e.button===0&&(!t||t==="_self")&&!Cj(e)}const Aj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ij="6";try{window.__reactRouterVersion=Ij}catch{}const Rj="startTransition",Sy=G_[Rj];function Lj(e){let{basename:t,children:r,future:n,window:s}=e,i=w.useRef();i.current==null&&(i.current=DC({window:s,v5Compat:!0}));let l=i.current,[o,u]=w.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},d=w.useCallback(h=>{c&&Sy?Sy(()=>u(h)):u(h)},[u,c]);return w.useLayoutEffect(()=>l.listen(d),[l,d]),w.useEffect(()=>_j(n),[n]),w.createElement(Sj,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const Oj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cp=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:d,viewTransition:h}=t,f=Tj(t,Aj),{basename:g}=w.useContext(Ca),p,y=!1;if(typeof c=="string"&&Pj.test(c)&&(p=c,Oj))try{let E=new URL(window.location.href),_=c.startsWith("//")?new URL(E.protocol+c):new URL(c),k=lg(_.pathname,g);_.origin===E.origin&&k!=null?c=k+_.search+_.hash:y=!0}catch{}let v=uj(c,{relative:s}),x=Dj(c,{replace:l,state:o,target:u,preventScrollReset:d,relative:s,viewTransition:h});function b(E){n&&n(E),E.defaultPrevented||x(E)}return w.createElement("a",Tp({},f,{href:p||v,onClick:y||i?n:b,ref:r,target:u}))});var Ty;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ty||(Ty={}));var Cy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Cy||(Cy={}));function Dj(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=dn(),c=ja(),d=$2(e,{relative:l});return w.useCallback(h=>{if(jj(h,r)){h.preventDefault();let f=n!==void 0?n:zd(c)===zd(d);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,d,n,s,r,e,i,l,o])}const Mj="modulepreload",Fj=function(e){return"/"+e},jy={},Ll=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=Fj(u),u in jy)return;jy[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Mj,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Bj=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ll(async()=>{const{default:n}=await Promise.resolve().then(()=>Yl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class hg extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Uj extends hg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Hj extends hg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class $j extends hg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jp;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jp||(jp={}));var zj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class qj{constructor(t,{headers:r={},customFetch:n,region:s=jp.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Bj(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return zj(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:l}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let c;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=l):typeof l=="string"?(o["Content-Type"]="text/plain",c=l):typeof FormData<"u"&&l instanceof FormData?c=l:(o["Content-Type"]="application/json",c=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(p=>{throw new Uj(p)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Hj(d);if(!d.ok)throw new $j(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield d.json():f==="application/octet-stream"?g=yield d.blob():f==="text/event-stream"?g=d:f==="multipart/form-data"?g=yield d.formData():g=yield d.text(),{data:g,error:null}}catch(s){return{data:null,error:s}}})}}var Rr={},fg={},Sh={},tc={},Th={},Ch={},Vj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ol=Vj();const Wj=Ol.fetch,W2=Ol.fetch.bind(Ol),G2=Ol.Headers,Gj=Ol.Request,Yj=Ol.Response,Yl=Object.freeze(Object.defineProperty({__proto__:null,Headers:G2,Request:Gj,Response:Yj,default:W2,fetch:Wj},Symbol.toStringTag,{value:"Module"})),Qj=I_(Yl);var jh={};Object.defineProperty(jh,"__esModule",{value:!0});let Kj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};jh.default=Kj;var Y2=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ch,"__esModule",{value:!0});const Zj=Y2(Qj),Xj=Y2(jh);let Jj=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Zj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,u;let c=null,d=null,h=null,f=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const y=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");y&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,g="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const y=await i.text();try{c=JSON.parse(y),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,g="OK")}catch{i.status===404&&y===""?(f=204,g="No Content"):c={message:y}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,g="OK"),c&&this.shouldThrowOnError)throw new Xj.default(c)}return{error:c,data:d,count:h,status:f,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var l,o,u;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Ch.default=Jj;var e3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Th,"__esModule",{value:!0});const t3=e3(Ch);let r3=class extends t3.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:l="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${c}"; options=${u};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Th.default=r3;var n3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tc,"__esModule",{value:!0});const s3=n3(Th);let a3=class extends s3.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};tc.default=a3;var i3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sh,"__esModule",{value:!0});const go=i3(tc);let l3=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&(this.headers.Prefer=`count=${n}`),new go.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new go.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const l="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new go.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new go.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new go.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Sh.default=l3;var Ah={},Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.version=void 0;Ih.version="0.0.0-automated";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.DEFAULT_HEADERS=void 0;const o3=Ih;Ah.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${o3.version}`};var Q2=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fg,"__esModule",{value:!0});const u3=Q2(Sh),c3=Q2(tc),d3=Ah;let h3=class K2{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},d3.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new u3.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new K2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let l;const o=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new c3.default({method:l,url:o,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};fg.default=h3;var Ql=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.PostgrestError=Rr.PostgrestBuilder=Rr.PostgrestTransformBuilder=Rr.PostgrestFilterBuilder=Rr.PostgrestQueryBuilder=Rr.PostgrestClient=void 0;const Z2=Ql(fg);Rr.PostgrestClient=Z2.default;const X2=Ql(Sh);Rr.PostgrestQueryBuilder=X2.default;const J2=Ql(tc);Rr.PostgrestFilterBuilder=J2.default;const eE=Ql(Th);Rr.PostgrestTransformBuilder=eE.default;const tE=Ql(Ch);Rr.PostgrestBuilder=tE.default;const rE=Ql(jh);Rr.PostgrestError=rE.default;var f3=Rr.default={PostgrestClient:Z2.default,PostgrestQueryBuilder:X2.default,PostgrestFilterBuilder:J2.default,PostgrestTransformBuilder:eE.default,PostgrestBuilder:tE.default,PostgrestError:rE.default};const{PostgrestClient:m3,PostgrestQueryBuilder:dH,PostgrestFilterBuilder:hH,PostgrestTransformBuilder:fH,PostgrestBuilder:mH,PostgrestError:pH}=f3,p3="2.11.2",g3={"X-Client-Info":`realtime-js/${p3}`},x3="1.0.0",nE=1e4,y3=1e3;var il;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(il||(il={}));var Ur;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ur||(Ur={}));var En;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(En||(En={}));var Ap;(function(e){e.websocket="websocket"})(Ap||(Ap={}));var Ha;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ha||(Ha={}));class b3{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const c=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class sE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ft;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ft||(ft={}));const Ay=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,l)=>(i[l]=v3(l,e,t,s),i),{})},v3=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?aE(i,l):Ip(l)},aE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return k3(t,r)}switch(e){case ft.bool:return w3(t);case ft.float4:case ft.float8:case ft.int2:case ft.int4:case ft.int8:case ft.numeric:case ft.oid:return E3(t);case ft.json:case ft.jsonb:return N3(t);case ft.timestamp:return _3(t);case ft.abstime:case ft.date:case ft.daterange:case ft.int4range:case ft.int8range:case ft.money:case ft.reltime:case ft.text:case ft.time:case ft.timestamptz:case ft.timetz:case ft.tsrange:case ft.tstzrange:return Ip(t);default:return Ip(t)}},Ip=e=>e,w3=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},E3=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},N3=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},k3=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>aE(t,o))}return e},_3=e=>typeof e=="string"?e.replace(" ","T"):e,iE=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Lf{constructor(t,r,n={},s=nE){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Iy;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Iy||(Iy={}));class Wo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wo.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=Wo.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Wo.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,d)=>{l[c]||(u[c]=d)}),this.map(l,(c,d)=>{const h=i[c];if(h){const f=d.map(v=>v.presence_ref),g=h.map(v=>v.presence_ref),p=d.filter(v=>g.indexOf(v.presence_ref)<0),y=h.filter(v=>f.indexOf(v.presence_ref)<0);p.length>0&&(o[c]=p),y.length>0&&(u[c]=y)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),d.length>0){const h=t[o].map(g=>g.presence_ref),f=d.filter(g=>h.indexOf(g.presence_ref)<0);t[o].unshift(...f)}n(o,d,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ry;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ry||(Ry={}));var Ly;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ly||(Ly={}));var os;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(os||(os={}));class mg{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ur.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Lf(this,En.join,this.params,this.timeout),this.rejoinTimer=new sE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ur.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ur.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ur.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ur.errored,this.rejoinTimer.scheduleTimeout())}),this._on(En.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Wo(this),this.broadcastEndpointURL=iE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:l,private:o}}=this.params;this._onError(d=>t==null?void 0:t(os.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(os.CLOSED));const u={},c={broadcast:i,presence:l,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(os.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,g=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,p=[];for(let y=0;y<g;y++){const v=f[y],{filter:{event:x,schema:b,table:E,filter:_}}=v,k=d&&d[y];if(k&&k.event===x&&k.schema===b&&k.table===E&&k.filter===_)p.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),t==null||t(os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,t&&t(os.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ur.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(En.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new Lf(this,En.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lf(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:d}=En;if(n&&[o,u,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var p,y,v;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(y=g.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===l}).map(g=>g.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(g=>{var p,y,v,x,b,E;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in g){const _=g.id,k=(p=g.filter)===null||p===void 0?void 0:p.event;return _&&((y=r.ids)===null||y===void 0?void 0:y.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(b=(x=g==null?void 0:g.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return _==="*"||_===((E=r==null?void 0:r.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===l}).map(g=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:y,table:v,commit_timestamp:x,type:b,errors:E}=p;f=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:x,eventType:b,new:{},old:{},errors:E}),this._getPayloadRecords(p))}g.callback(f,n)})}_isClosed(){return this.state===Ur.closed}_isJoined(){return this.state===Ur.joined}_isJoining(){return this.state===Ur.joining}_isLeaving(){return this.state===Ur.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&mg.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(En.close,{},t)}_onError(t){this._on(En.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ur.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ay(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ay(t.columns,t.old_record)),r}}const S3=()=>{},T3=typeof WebSocket<"u",C3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class j3{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=g3,this.params={},this.timeout=nE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=S3,this.conn=null,this.sendBuffer=[],this.serializer=new b3,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...o)=>Ll(async()=>{const{default:u}=await Promise.resolve().then(()=>Yl);return{default:u}},void 0).then(({default:u})=>u(...o)):l=fetch,(...o)=>l(...o)},this.endPoint=`${t}/${Ap.websocket}`,this.httpEndpoint=iE(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,l)=>l(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new sE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(T3){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new A3(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ll(async()=>{const{default:t}=await import("./browser-CNlf5ydY.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:x3}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case il.connecting:return Ha.Connecting;case il.open:return Ha.Open;case il.closing:return Ha.Closing;default:return Ha.Closed}}isConnected(){return this.connectionState()===Ha.Open}channel(t,r={config:{}}){const n=new mg(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(En.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(y3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:l}=r;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${l&&"("+l+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,l)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(En.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([C3],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class A3{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=il.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class pg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Vt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class I3 extends pg{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Rp extends pg{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var R3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const lE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ll(async()=>{const{default:n}=await Promise.resolve().then(()=>Yl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},L3=()=>R3(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ll(()=>Promise.resolve().then(()=>Yl),void 0)).Response:Response}),Lp=e=>{if(Array.isArray(e))return e.map(r=>Lp(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Lp(n)}),t};var Ei=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Of=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),O3=(e,t,r)=>Ei(void 0,void 0,void 0,function*(){const n=yield L3();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new I3(Of(s),e.status||500))}).catch(s=>{t(new Rp(Of(s),s))}):t(new Rp(Of(e),e))}),P3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function rc(e,t,r,n,s,i){return Ei(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,P3(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>O3(u,o,n))})})}function qd(e,t,r,n){return Ei(this,void 0,void 0,function*(){return rc(e,"GET",t,r,n)})}function qs(e,t,r,n,s){return Ei(this,void 0,void 0,function*(){return rc(e,"POST",t,n,s,r)})}function D3(e,t,r,n,s){return Ei(this,void 0,void 0,function*(){return rc(e,"PUT",t,n,s,r)})}function M3(e,t,r,n){return Ei(this,void 0,void 0,function*(){return rc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function oE(e,t,r,n,s){return Ei(this,void 0,void 0,function*(){return rc(e,"DELETE",t,n,s,r)})}var Sr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const F3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Oy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class B3{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=lE(s)}uploadOrUpdate(t,r,n,s){return Sr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Oy),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Sr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:Oy.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(Vt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return Sr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield qs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new pg("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield qs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Sr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield qs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Sr(this,void 0,void 0,function*(){try{const s=yield qs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}download(t,r){return Sr(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield qd(this.fetch,`${this.url}/${s}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Vt(o))return{data:null,error:o};throw o}})}info(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield qd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lp(n),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}exists(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield M3(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Vt(n)&&n instanceof Rp){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Sr(this,void 0,void 0,function*(){try{return{data:yield oE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Sr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},F3),r),{prefix:t||""});return{data:yield qs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const U3="2.7.1",H3={"X-Client-Info":`storage-js/${U3}`};var ji=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class $3{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},H3),r),this.fetch=lE(n)}listBuckets(){return ji(this,void 0,void 0,function*(){try{return{data:yield qd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}getBucket(t){return ji(this,void 0,void 0,function*(){try{return{data:yield qd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ji(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ji(this,void 0,void 0,function*(){try{return{data:yield D3(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ji(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ji(this,void 0,void 0,function*(){try{return{data:yield oE(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}}class z3 extends $3{constructor(t,r={},n){super(t,r,n)}from(t){return new B3(this.url,this.headers,t,this.fetch)}}const q3="2.49.4";let Io="";typeof Deno<"u"?Io="deno":typeof document<"u"?Io="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Io="react-native":Io="node";const V3={"X-Client-Info":`supabase-js-${Io}/${q3}`},W3={headers:V3},G3={schema:"public"},Y3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Q3={};var K3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Z3=e=>{let t;return e?t=e:typeof fetch>"u"?t=W2:t=fetch,(...r)=>t(...r)},X3=()=>typeof Headers>"u"?G2:Headers,J3=(e,t,r)=>{const n=Z3(r),s=X3();return(i,l)=>K3(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},l),{headers:c}))})};var eA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};function tA(e){return e.replace(/\/$/,"")}function rA(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:l,auth:o,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>eA(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const uE="2.69.1",Di=30*1e3,Op=3,Pf=Op*Di,nA="http://localhost:9999",sA="supabase.auth.token",aA={"X-Client-Info":`gotrue-js/${uE}`},Pp="X-Supabase-Api-Version",cE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},iA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,lA=6e5;class gg extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Fe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class oA extends gg{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function uA(e){return Fe(e)&&e.name==="AuthApiError"}class dE extends gg{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Aa extends gg{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Fs extends Aa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cA(e){return Fe(e)&&e.name==="AuthSessionMissingError"}class Df extends Aa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bc extends Aa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Uc extends Aa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function dA(e){return Fe(e)&&e.name==="AuthImplicitGrantRedirectError"}class Py extends Aa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Dp extends Aa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Mf(e){return Fe(e)&&e.name==="AuthRetryableFetchError"}class Dy extends Aa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Go extends Aa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const My="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fy=` 	
\r=`.split(""),hA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Fy.length;t+=1)e[Fy[t].charCodeAt(0)]=-2;for(let t=0;t<My.length;t+=1)e[My[t].charCodeAt(0)]=t;return e})();function hE(e,t,r){const n=hA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function By(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{pA(l,n,r)};for(let l=0;l<e.length;l+=1)hE(e.charCodeAt(l),s,i);return t.join("")}function fA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function mA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}fA(n,t)}}function pA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function gA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)hE(e.charCodeAt(s),r,n);return new Uint8Array(t)}function xA(e){const t=[];return mA(e,r=>t.push(r)),new Uint8Array(t)}function yA(e){return Math.round(Date.now()/1e3)+e}function bA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Bn=()=>typeof window<"u"&&typeof document<"u",Pa={tested:!1,writable:!1},Yo=()=>{if(!Bn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pa.tested)return Pa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Pa.tested=!0,Pa.writable=!0}catch{Pa.tested=!0,Pa.writable=!1}return Pa.writable};function vA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const fE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ll(async()=>{const{default:n}=await Promise.resolve().then(()=>Yl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},wA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",mE=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Hc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},$c=async(e,t)=>{await e.removeItem(t)};class Rh{constructor(){this.promise=new Rh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Rh.promiseConstructor=Promise;function Ff(e){const t=e.split(".");if(t.length!==3)throw new Go("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!iA.test(t[n]))throw new Go("JWT not in base64url format");return{header:JSON.parse(By(t[0])),payload:JSON.parse(By(t[1])),signature:gA(t[2]),raw:{header:t[0],payload:t[1]}}}async function EA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function NA(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function kA(e){return("0"+e.toString(16)).substr(-2)}function _A(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,kA).join("")}async function SA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function TA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await SA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ai(e,t,r=!1){const n=_A();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await mE(e,`${t}-code-verifier`,s);const i=await TA(n);return[i,n===i?"plain":"s256"]}const CA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jA(e){const t=e.headers.get(Pp);if(!t||!t.match(CA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function AA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function IA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var RA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Ua=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),LA=[502,503,504];async function Uy(e){var t;if(!wA(e))throw new Dp(Ua(e),0);if(LA.includes(e.status))throw new Dp(Ua(e),e.status);let r;try{r=await e.json()}catch(i){throw new dE(Ua(i),i)}let n;const s=jA(e);if(s&&s.getTime()>=cE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Dy(Ua(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Fs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Dy(Ua(r),e.status,r.weak_password.reasons);throw new oA(Ua(r),e.status||500,n)}const OA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function We(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Pp]||(i[Pp]=cE["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await PA(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function PA(e,t,r,n,s,i){const l=OA(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new Dp(Ua(u),0)}if(o.ok||await Uy(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await Uy(u)}}function Bs(e){var t;let r=null;BA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=yA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Hy(e){const t=Bs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Qs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function DA(e){return{data:e,error:null}}function MA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=RA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function FA(e){return e}function BA(e){return e.access_token&&e.refresh_token&&e.expires_in}var UA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class HA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=fE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await We(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await We(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Qs})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=UA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await We(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:MA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Fe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await We(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Qs})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:FA});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(u=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(p=>{const y=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);c[`${v}Page`]=y}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Fe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await We(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Qs})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await We(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Qs})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await We(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Qs})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await We(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await We(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}}const $A={getItem:e=>Yo()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Yo()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Yo()&&globalThis.localStorage.removeItem(e)}};function $y(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function zA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ii={debug:!!(globalThis&&Yo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class qA extends pE{}async function VA(e,t,r){Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new qA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ii.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}zA();const WA={url:nA,storageKey:sA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function zy(e,t,r){return await r()}class _u{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_u.nextInstanceID,_u.nextInstanceID+=1,this.instanceID>0&&Bn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},WA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new HA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=fE(s.fetch),this.lock=s.lock||zy,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Bn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=VA:this.lock=zy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Yo()?this.storage=$A:(this.memoryStorage={},this.storage=$y(this.memoryStorage)):(this.memoryStorage={},this.storage=$y(this.memoryStorage)),Bn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${uE}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=vA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Bn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),dA(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Fe(r)?{error:r}:{error:new dE("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Bs}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Fe(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Ai(this.storage,this.storageKey)),i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:p},xform:Bs})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Bs})}else throw new Bc("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Fe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hy})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hy})}else throw new Bc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Df}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Hc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:l}=await We(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Bs});if(await $c(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Df}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(Fe(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bs}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Df}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Ai(this.storage,this.storageKey));const{error:h}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:d}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Bc("You must provide either an email or phone number.")}catch(o){if(Fe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Bs});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Fe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Ai(this.storage,this.storageKey)),await We(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:DA})}catch(i){if(Fe(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Fs;const{error:s}=await We(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Fe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await We(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await We(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new Bc("You must provide either an email or phone number and a type")}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Hc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Pf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!l&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Qs}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fs}:await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Qs})})}catch(r){if(Fe(r))return cA(r)&&(await this._removeSession(),await $c(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Fs;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await Ai(this.storage,this.storageKey));const{data:c,error:d}=await We(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:Qs});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Fs;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=Ff(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Fe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Fs;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Bn())throw new Uc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Uc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Py("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Uc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Py("No code detected.");const{data:b,error:E}=await this._exchangeCodeForSession(t.code);if(E)throw E;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new Uc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;u&&(f=parseInt(u));const g=f-d;g*1e3<=Di&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:y,error:v}=await this._getUser(i);if(v)throw v;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Fe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Hc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(uA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await $c(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=bA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ai(this.storage,this.storageKey,!0));try{return await We(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Fe(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,d;const{data:h,error:f}=i;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await We(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Bn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Fe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await We(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await NA(async s=>(s>0&&await EA(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await We(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bs})),(s,i)=>{const l=200*Math.pow(2,s);return i&&Mf(i)&&Date.now()+l-n<Di})}catch(n){if(this._debug(r,"error",n),Fe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Bn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Hc(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Pf;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Pf}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Mf(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Fs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Rh;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Fs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Fe(i)){const l={session:null,error:i};return Mf(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mE(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await $c(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Bn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Di);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Di);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Di}ms, refresh threshold is ${Op} ticks`),s<=Op&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof pE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await Ai(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await We(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await We(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Ff(s.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n||(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+lA>Date.now()))return n;const{data:s,error:i}=await We(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Go("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(l=>l.kid===t),!n)throw new Go("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:g,error:p}=await this.getSession();if(p||!g.session)return{data:null,error:p};n=g.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=Ff(n);if(AA(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(n);if(g)throw g;return{data:{claims:i,header:s,signature:l},error:null}}const c=IA(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,l,xA(`${o}.${u}`)))throw new Go("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}}_u.nextInstanceID=0;const GA=_u;class YA extends GA{constructor(t){super(t)}}var QA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class KA{constructor(t,r,n){var s,i,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=tA(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:G3,realtime:Q3,auth:Object.assign(Object.assign({},Y3),{storageKey:u}),global:W3},d=rA(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=J3(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new m3(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new qj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new z3(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return QA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:l,lock:o,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:l,lock:o,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new j3(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZA=(e,t,r)=>new KA(e,t,r),XA="https://tkenxulvmzhhkuhfvcpt.supabase.co",JA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrZW54dWx2bXpoaGt1aGZ2Y3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgwOTEwNzgsImV4cCI6MjA1MzY2NzA3OH0.UJPzvtHD6k6rJ09BlFYkdYEyHC3sx3h1rpAG8DULSHI",Bf={maxRetries:3,retryDelay:1e3,retryCondition:e=>{var t,r,n,s,i;return(e==null?void 0:e.status)===500||(e==null?void 0:e.status)===503||(e==null?void 0:e.status)===504||(e==null?void 0:e.status)===429||((t=e==null?void 0:e.message)==null?void 0:t.includes("Database error"))||((r=e==null?void 0:e.message)==null?void 0:r.includes("unexpected_failure"))||((n=e==null?void 0:e.message)==null?void 0:n.includes("schema"))||((s=e==null?void 0:e.message)==null?void 0:s.includes("network"))||((i=e==null?void 0:e.message)==null?void 0:i.includes("timeout"))}},ne=ZA(XA,JA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"dragonbane_auth",flowType:"implicit"},global:{headers:{"X-Client-Info":"dragonbane-character-manager"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}},maxRetries:Bf.maxRetries,retryDelay:Bf.retryDelay,retryCondition:Bf.retryCondition});ne.auth.onAuthStateChange((e,t)=>{(e==="USER_DELETED"||e==="SIGNED_OUT")&&console.log("Auth event:",e),e==="TOKEN_REFRESHED"&&console.log("Token refreshed successfully"),e==="SIGNED_OUT"&&!t&&console.error("Auth error: Session ended unexpectedly")});window.addEventListener("online",()=>{ne.auth.startAutoRefresh()});window.addEventListener("offline",()=>{ne.auth.stopAutoRefresh()});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gE=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var t4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},u)=>w.createElement("svg",{ref:u,...t4,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:gE("lucide",s),...o},[...l.map(([c,d])=>w.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=(e,t)=>{const r=w.forwardRef(({className:n,...s},i)=>w.createElement(r4,{ref:i,iconNode:t,className:gE(`lucide-${e4(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=se("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=se("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=se("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z",key:"wvr1b5"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}],["path",{d:"M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5",key:"xk3gvk"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=se("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=se("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=se("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=se("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=se("BookUser",[["path",{d:"M15 13a3 3 0 1 0-6 0",key:"10j68g"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=se("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=se("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=se("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=se("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=se("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oh=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=se("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=se("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=se("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=se("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=se("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=se("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=se("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=se("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=se("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=se("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=se("Dice4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=se("Dice6",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=se("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=se("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=se("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=se("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=se("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=se("HeartCrack",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"m12 13-1-1 2-2-3-3 2-2",key:"xjdxli"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=se("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=se("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=se("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=se("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=se("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=se("LampDesk",[["path",{d:"m14 5-3 3 2 7 8-8-7-2Z",key:"1b0msb"}],["path",{d:"m14 5-3 3-3-3 3-3 3 3Z",key:"1uemms"}],["path",{d:"M9.5 6.5 4 12l3 6",key:"1bx08v"}],["path",{d:"M3 22v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2H3Z",key:"wap775"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=se("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=se("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=se("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=se("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=se("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=se("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=se("Notebook",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=se("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=se("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=se("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=se("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=se("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=se("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=se("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=se("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=se("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=se("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=se("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=se("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=se("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=se("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=se("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=se("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=se("SquareMinus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=se("SquareUser",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 21v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2",key:"1m6ac2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=se("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=se("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=se("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=se("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=se("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=se("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=se("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=se("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=se("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=se("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=se("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),PE=w.createContext(void 0);function z4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(!1),[i,l]=w.useState(null);return a.jsxs(PE.Provider,{value:{setGlobalError:r,setGlobalLoading:s,setGlobalWarning:l},children:[n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})})}),i&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(ic,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-yellow-700",children:i})}),a.jsx("button",{onClick:()=>l(null),className:"text-yellow-500 hover:text-yellow-700",children:a.jsx(Pt,{className:"w-5 h-5"})})]})})}),t&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ft,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-700",children:t})}),a.jsx("button",{onClick:()=>r(null),className:"text-red-500 hover:text-red-700",children:a.jsx(Pt,{className:"w-5 h-5"})})]})})}),e]})}function DE(){const e=w.useContext(PE);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}async function q4(e,t,r,n){const{data:s,error:i}=await ne.auth.signUp({email:e,password:t,options:{data:{username:r.trim(),role:n}}});if(i)throw i.message.includes("User already registered")?new Error("An account with this email already exists."):(console.error("Sign up error (auth):",i.message),new Error(`Authentication error: ${i.message}`));if(!s.user)throw console.error("Sign up error: User object not returned after sign up."),new Error("Sign up failed: Could not retrieve user information.");const{error:l}=await ne.from("users").insert({id:s.user.id,username:r.trim(),role:n,email:e});if(l)throw console.error("Sign up error (profile creation):",l.message),new Error(`Account created, but failed to set up user profile: ${l.message}. Please contact support.`);return s.user}async function V4(e,t){const{data:r,error:n}=await ne.auth.signInWithPassword({email:e,password:t});if(n)throw n;if(r.user){const{error:s}=await ne.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.user.id);s&&console.error("Failed to update user timestamps on login:",s.message)}if(!r.session){const{data:s,error:i}=await ne.auth.getSession();if(i)throw i;return{user:r.user,session:s.session}}return{user:r.user,session:r.session}}async function W4(){const{error:e}=await ne.auth.signOut();if(e)throw console.error("Sign out error:",e.message),e}const Jy=["player","dm","admin"],ME=w.createContext(void 0);function $t(){const e=w.useContext(ME);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function G4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState(!0),[c,d]=w.useState(!1),h=dn(),{setGlobalError:f}=DE(),g=w.useCallback(async k=>{var S,I,A;try{const{data:D}=await ne.auth.getSession(),T=(A=(I=(S=D==null?void 0:D.session)==null?void 0:S.user)==null?void 0:I.user_metadata)==null?void 0:A.role;if(T&&Jy.includes(T))return T;const{data:H,error:L}=await ne.from("users").select("role").eq("id",k).single();if(L)return console.error("Error fetching user role from table:",L.message),"player";const G=H==null?void 0:H.role;return G&&Jy.includes(G)?G:"player"}catch(D){return console.error("Unexpected error in fetchUserRole:",D),"player"}},[]);w.useEffect(()=>{ne.auth.getSession().then(({data:{session:S}})=>{s(S),r((S==null?void 0:S.user)??null)}).catch(S=>{console.error("Error getting initial session:",S),r(null),s(null),u(!1)});const{data:k}=ne.auth.onAuthStateChange((S,I)=>{s(I),r((I==null?void 0:I.user)??null)});return()=>{var S;(S=k==null?void 0:k.subscription)==null||S.unsubscribe()}},[]),w.useEffect(()=>{t?g(t.id).then(l).finally(()=>{u(!1)}):(l(null),u(!1))},[t,g]);const p=async(k,S,I,A)=>{try{d(!0),f(null),await q4(k,S,I,A)}catch(D){throw f(D instanceof Error?D.message:"Signup failed"),D}finally{d(!1)}},y=async(k,S)=>{try{d(!0),f(null),await V4(k,S),h("/")}catch(I){let A="Authentication failed. Please check your credentials.";throw I instanceof Error&&(I.message.includes("Invalid login credentials")?A="Incorrect email or password.":I.message.includes("Email not confirmed")?A="Please verify your email address before logging in.":I.message.includes("network error")||I.message.includes("Failed to fetch")?A="Network error. Please check your connection and try again.":A=I.message.length>100?"An unexpected authentication error occurred.":I.message),f(A),new Error(A)}finally{d(!1)}},v=w.useCallback(async()=>{if(!c)try{d(!0),await W4(),r(null),s(null),l(null),f(null),h("/login")}catch(k){console.error("Sign out error:",k),f("Failed to sign out")}finally{d(!1)}},[c,h,f]),x=()=>i==="admin",b=()=>i==="dm"||i==="admin",E=()=>i==="player",_=o||c;return a.jsx(ME.Provider,{value:{user:t,session:n,role:i,isLoading:_,signIn:y,signUp:p,signOut:v,isAdmin:x,isDM:b,isPlayer:E},children:e})}const FE=w.createContext(void 0),zc=30*60*1e3,eb=30*1e3,Y4=10*1e3;function Q4({children:e}){const{signOut:t}=$t(),r=dn(),n=w.useRef(Date.now()),s=w.useRef(null),i=w.useRef(null),[l,o]=w.useState(!1),u=w.useCallback(()=>{s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{o(!0)},zc-eb),s.current=setTimeout(async()=>{await t(),r("/login",{state:{message:"Your session has expired due to inactivity."}})},zc),n.current=Date.now(),o(!1)},[t,r]),c=w.useCallback(()=>{u()},[u]);return w.useEffect(()=>{const d=["mousedown","keydown","scroll","mousemove","click","touchstart"];let h;function f(p,y){let v;return function(...b){const E=()=>{clearTimeout(v),p(...b)};clearTimeout(v),v=setTimeout(E,y)}}const g=f(()=>{Date.now()-n.current>1e3&&u()},1e3);return d.forEach(p=>{document.addEventListener(p,g)}),h=window.setInterval(()=>{const p=Date.now()-n.current;p>=zc-eb&&o(!0),p>=zc&&(t(),r("/login",{state:{message:"Your session has expired due to inactivity."}}))},Y4),u(),()=>{d.forEach(p=>{document.removeEventListener(p,g)}),s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),window.clearInterval(h)}},[u,t,r]),a.jsx(FE.Provider,{value:{showWarning:l,extendSession:c},children:e})}function K4(){const e=w.useContext(FE);if(e===void 0)throw new Error("useSessionTimeout must be used within a SessionTimeoutProvider");return e}const $n=class $n{constructor(){bc(this,"environment");this.environment="production"}static getInstance(){return $n.instance||($n.instance=new $n),$n.instance}logError(t,r={},n="medium"){const s={error:t,context:{...r,timestamp:new Date().toISOString(),path:window.location.pathname},severity:n};this.environment==="development"&&console.error("Error Report:",{message:t.message,stack:t.stack,...s.context,severity:n}),this.environment==="production"&&this.sendToErrorTrackingService(s)}async sendToErrorTrackingService(t){try{console.error("Production Error:",t)}catch(r){console.error("Failed to send error report:",r)}}static handleError(t,r){const n=$n.getInstance();t instanceof Error?n.logError(t,r):n.logError(new Error(String(t)),r)}static handleNetworkError(t,r){const n=$n.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("network")||t.message.toLowerCase().includes("connection")||t.message.toLowerCase().includes("offline");n.logError(t,{...r,additionalData:{isNetworkError:s}},s?"high":"medium")}}static handleAuthError(t,r){const n=$n.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("auth")||t.message.toLowerCase().includes("unauthorized")||t.message.toLowerCase().includes("forbidden");n.logError(t,{...r,additionalData:{isAuthError:s}},s?"high":"medium")}}};bc($n,"instance");let ul=$n;class Z4 extends w.Component{constructor(r){super(r);bc(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){ul.handleError(r,{action:"render",additionalData:{componentStack:n.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(ic,{className:"w-8 h-8 text-red-500"}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Something went wrong"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. The application has encountered an unexpected error."}),this.state.error&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-red-700 font-mono break-all",children:this.state.error.message||"No error message available"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(jE,{className:"w-5 h-5"}),"Refresh Page"]}),a.jsxs(Cp,{to:"/",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(x4,{className:"w-5 h-5"}),"Go Home"]})]})]})}):this.props.children}}const BE=new vC({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1,retry:1}}}),X4=/(\d+)?d(\d+)/i;function J4(e){const t=e.match(X4);if(!t){const i=`d${e.replace(/\D/g,"")}`;return["d4","d6","d8","d10","d12","d20"].includes(i)?[i]:(console.warn(`Invalid dice string format: "${e}". Could not parse.`),[])}const r=parseInt(t[1]||"1",10),n=parseInt(t[2],10),s=`d${n}`;return["d4","d6","d8","d10","d12","d20"].includes(s)?Array(r).fill(s):(console.warn(`Invalid die type in string: "d${n}" from "${e}".`),[])}const UE=w.createContext(void 0),e6=20;function t6({children:e}){const[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState(!1),[h,f]=w.useState(!1),g=w.useCallback(k=>{r(S=>{const I=!S;if(I){const A={...k};A.label&&!A.description&&(A.description=A.label),s(A||null);let D=[];k!=null&&k.dice?D=J4(k.dice):k!=null&&k.initialDice&&(D=k.initialDice),(k==null?void 0:k.rollMode)==="deathRoll"?D=["d20"]:(k==null?void 0:k.rollMode)==="recoveryRoll"?D=["d6"]:(k==null?void 0:k.rollMode)==="rallyRoll"?D=["d20"]:(k==null?void 0:k.rollMode)==="skillCheck"&&D.length===0?D=["d20"]:(k==null?void 0:k.rollMode)==="advancementRoll"&&(D=["d20"]),l(D),d(!1),f((k==null?void 0:k.requiresBane)||(k==null?void 0:k.rollMode)==="rallyRoll"||!1)}else s(null),l([]),d(!1),f(!1);return I})},[]),p=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l(S=>[...S,k]),(c||h)&&(d(!1),f(!1)))},[c,h,n]),y=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||l(S=>{if(S.length===0)return[];if(k){const I=S.lastIndexOf(k);if(I!==-1){const A=[...S];return A.splice(I,1),A}}return S.slice(0,-1)})},[n]),v=w.useCallback(()=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l([]),d(!1),f(!1))},[n]),x=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(d(!0),f(!1),l(["d20"])):d(!1))},[n]),b=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(f(!0),d(!1),l(["d20"])):(n==null?void 0:n.rollMode)!=="rallyRoll"&&f(!1))},[n]),E=w.useCallback(k=>{u(S=>{const A=[{...k,id:crypto.randomUUID(),timestamp:Date.now()},...S];return A.length>e6&&A.pop(),A})},[]),_=w.useCallback(()=>{u([])},[]);return a.jsx(UE.Provider,{value:{showDiceRoller:t,currentConfig:n,dicePool:i,rollHistory:o,isBoonActive:c,isBaneActive:h,toggleDiceRoller:g,addDie:p,removeLastDie:y,clearDicePool:v,setBoon:x,setBane:b,addRollToHistory:E,clearHistory:_},children:e})}function Dn(){const e=w.useContext(UE);if(e===void 0)throw new Error("useDice must be used within a DiceProvider");return e}function r6(){const e=ja(),{signOut:t,isAdmin:r,isDM:n,role:s}=$t(),{toggleDiceRoller:i}=Dn(),[l,o]=w.useState(!1),u=w.useRef(null),c=f=>e.pathname===f,d=[{path:"/",label:"Characters",icon:jn,roles:["player","dm","admin"]},{path:"/compendium",label:"Compendium",icon:nc,roles:["player","dm","admin"]},{path:"/adventure-party",label:"Adventure Party",icon:mi,roles:["player","dm","admin"]},{path:"/notes",label:"Notes",icon:Pl,roles:["player","dm","admin"]},{path:"/settings",label:"Settings",icon:AE,roles:["player","dm","admin"]}],h=()=>{l&&o(!1)};return w.useEffect(()=>{const f=g=>{u.current&&!u.current.contains(g.target)&&o(!1)};return l?document.addEventListener("mousedown",f):document.removeEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[l]),a.jsxs("nav",{className:"bg-gray-800 text-white",ref:u,children:[a.jsx("div",{className:"container mx-auto px-4",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0"}),a.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-4",children:d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:g,icon:p})=>a.jsxs(Cp,{to:f,onClick:h,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(p,{className:"w-5 h-5"}),a.jsx("span",{children:g})]},f))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Open Dice Roller",children:[a.jsx(or,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Dice"})]}),a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700",title:`Current role: ${s}`,children:[r()?a.jsx(Wy,{className:"w-5 h-5 text-yellow-400"}):n()?a.jsx(ks,{className:"w-5 h-5 text-blue-400"}):a.jsx(jn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:r()?"Admin":n()?"DM":"Player"})]}),a.jsxs("button",{onClick:()=>{t(),h()},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Log Out",children:[a.jsx(Wd,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Log Out"})]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center",children:[a.jsx("button",{onClick:i,className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white mr-2",title:"Open Dice Roller",children:a.jsx(or,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>o(!l),className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white","aria-expanded":l,"aria-controls":"mobile-menu",children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),l?a.jsx(Pt,{className:"block h-6 w-6"}):a.jsx(N4,{className:"block h-6 w-6"})]})]})]})}),l&&a.jsx("div",{className:"md:hidden absolute top-16 inset-x-0 bg-gray-800 z-50 shadow-lg",id:"mobile-menu",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:g,icon:p})=>a.jsxs(Cp,{to:f,onClick:h,className:`flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(p,{className:"w-6 h-6"}),a.jsx("span",{children:g})]},f)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700 w-full",children:r()?a.jsxs(a.Fragment,{children:[a.jsx(Wy,{className:"w-5 h-5 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}):n()?a.jsxs(a.Fragment,{children:[a.jsx(ks,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-sm font-medium",children:"DM"})]}):a.jsxs(a.Fragment,{children:[a.jsx(jn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Player"})]})})}),a.jsxs("button",{onClick:()=>{t(),h()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:[a.jsx(Wd,{className:"w-6 h-6"}),a.jsx("span",{children:"Log Out"})]})]})})]})}function n6({character:e}){const t=r=>r>=16?"text-purple-600":r>=14?"text-blue-600":r>=12?"text-green-600":r>=10?"text-yellow-600":"text-gray-600";return a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.kin," ",e.profession]})]}),a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.age})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:t(e.attributes.STR),children:e.attributes.STR})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(si,{className:"w-4 h-4 text-pink-600"}),a.jsx("span",{className:t(e.attributes.CON),children:e.attributes.CON})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ng,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{className:t(e.attributes.AGL),children:e.attributes.AGL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(wE,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:t(e.attributes.INT),children:e.attributes.INT})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(An,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:t(e.attributes.WIL),children:e.attributes.WIL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jn,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:t(e.attributes.CHA),children:e.attributes.CHA})]})]}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsx("p",{className:"line-clamp-2",children:e.appearance||"No appearance set"})})]})})}const s6={},tb=e=>{let t;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const g=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(p=>p(t,g))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(s6?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,s,u);return u},a6=e=>e?tb(e):tb;var HE={exports:{}},$E={},zE={exports:{}},qE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dl=w;function i6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var l6=typeof Object.is=="function"?Object.is:i6,o6=Dl.useState,u6=Dl.useEffect,c6=Dl.useLayoutEffect,d6=Dl.useDebugValue;function h6(e,t){var r=t(),n=o6({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return c6(function(){s.value=r,s.getSnapshot=t,Hf(s)&&i({inst:s})},[e,r,t]),u6(function(){return Hf(s)&&i({inst:s}),e(function(){Hf(s)&&i({inst:s})})},[e]),d6(r),r}function Hf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!l6(e,r)}catch{return!0}}function f6(e,t){return t()}var m6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f6:h6;qE.useSyncExternalStore=Dl.useSyncExternalStore!==void 0?Dl.useSyncExternalStore:m6;zE.exports=qE;var p6=zE.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fh=w,g6=p6;function x6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var y6=typeof Object.is=="function"?Object.is:x6,b6=g6.useSyncExternalStore,v6=Fh.useRef,w6=Fh.useEffect,E6=Fh.useMemo,N6=Fh.useDebugValue;$E.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=v6(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=E6(function(){function u(g){if(!c){if(c=!0,d=g,g=n(g),s!==void 0&&l.hasValue){var p=l.value;if(s(p,g))return h=p}return h=g}if(p=h,y6(d,g))return p;var y=n(g);return s!==void 0&&s(p,y)?(d=g,p):(d=g,h=y)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,r,n,s]);var o=b6(e,i[0],i[1]);return w6(function(){l.hasValue=!0,l.value=o},[o]),N6(o),o};HE.exports=$E;var k6=HE.exports;const _6=oh(k6),VE={},{useDebugValue:S6}=Sn,{useSyncExternalStoreWithSelector:T6}=_6;let rb=!1;const C6=e=>e;function j6(e,t=C6,r){(VE?"production":void 0)!=="production"&&r&&!rb&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),rb=!0);const n=T6(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return S6(n),n}const nb=e=>{(VE?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?a6(e):e,r=(n,s)=>j6(t,n,s);return Object.assign(r,t),r},WE=e=>e?nb(e):nb,Zn=WE(e=>({step:0,character:{},setStep:t=>e({step:t}),updateCharacter:t=>e(r=>({character:{...r.character,...t}})),resetCharacter:()=>e({character:{},step:0})}));async function A6(){const{data:e,error:t}=await ne.from("kin").select("id, name, description, heroic_ability");if(t)throw console.error("Error fetching kin list:",t),new Error(t.message||"Failed to fetch kin list");return e||[]}async function I6(e){if(!e||e.length===0)return[];const t=e.map(s=>s.trim()).filter(s=>s);if(t.length===0)return[];const{data:r,error:n}=await ne.from("heroic_abilities").select("id, name, description, willpower_cost, requirement").in("name",t);if(n)throw console.error("Error fetching ability details by names:",n),new Error(n.message||"Failed to fetch ability details");return(r||[]).map(s=>({id:s.id,name:s.name,description:s.description,willpower_cost:s.willpower_cost,requirement:s.requirement}))}function He({size:e="md",className:t=""}){const r={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-4",lg:"w-12 h-12 border-4"};return a.jsx("div",{className:`flex items-center justify-center ${t}`,role:"status",children:a.jsx("div",{className:`${r[e]} animate-spin rounded-full border-gray-200 border-t-blue-600`,"aria-label":"Loading..."})})}function Ne({message:e,onClose:t}){return e?a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 flex items-start justify-between",role:"alert",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ll,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{className:"block sm:inline",children:e})]}),t&&a.jsx("button",{onClick:t,className:"ml-4 p-1 text-red-500 hover:text-red-700 hover:bg-red-200 rounded-full transition-colors","aria-label":"Close error message",children:a.jsx(Pt,{className:"w-4 h-4"})})]}):null}const sb=e=>e?e.split(",").map(t=>t.trim()).filter(t=>t):[];function R6(){const{character:e,updateCharacter:t}=Zn(),[r,n]=w.useState(null),{data:s=[],isLoading:i,error:l}=Lt({queryKey:["kinListWithHeroicAbility"],queryFn:A6,retry:!1});w.useEffect(()=>{if(e.kin&&s.length>0&&!r){const p=s.find(y=>y.name===e.kin);if(p){n(p.id);const y=sb(p.heroic_ability);JSON.stringify(e.kinAbilityNames)!==JSON.stringify(y)&&t({kinAbilityNames:y})}}},[e.kin,s,r,e.kinAbilityNames,t]);const o=p=>{n(p.id);const y=sb(p.heroic_ability);t({kin:p.name,kinAbilityNames:y})},u=w.useMemo(()=>s.find(p=>p.id===r),[s,r]),c=w.useMemo(()=>e.kinAbilityNames||[],[e.kinAbilityNames]),{data:d=[],isLoading:h,error:f}=Lt({queryKey:["abilityDetails",c.sort().join(",")],queryFn:()=>I6(c),enabled:c.length>0,staleTime:10*60*1e3,retry:!1}),g=p=>a.jsxs("div",{className:"mb-4 p-3 border rounded bg-gray-50 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-md text-gray-800",children:p.name}),p.willpower_cost!=null&&a.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:["Willpower Cost: ",p.willpower_cost]}),p.requirement&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requirement: ",p.requirement]}),a.jsx("p",{className:"text-sm text-gray-700 mt-2",children:p.description})]},p.id);if(i)return a.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:a.jsx(He,{size:"lg"})});if(l){const p=l instanceof Error?l.message:"Failed to load Kin options.";return console.error("Error loading Kin:",l),a.jsx(Ne,{title:"Error Loading Kin",message:p})}return a.jsxs("div",{className:"flex space-x-6 h-[60vh]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Kin List"}),a.jsx("ul",{className:"space-y-1",children:s.map(p=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md text-sm ${r===p.id?"bg-blue-100 font-semibold text-blue-800":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>o(p),children:p.name},p.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:u?a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-1",children:u.name}),a.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:u.description}),a.jsx("hr",{className:"my-4 border-gray-300"}),a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Kin Abilities"}),h?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(He,{})}):f?a.jsx(Ne,{title:"Error Loading Abilities",message:f.message||"Failed to load ability details."}):d.length>0?d.map(g):c.length>0&&!h?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-orange-600 italic mb-2",children:"Could not fetch full details for the following abilities (check names in database):"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:c.map(p=>a.jsx("li",{children:p},p))})]}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific heroic abilities listed for this Kin."})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"Select a kin from the list to view details and abilities."})})})]})}async function L6(){const{data:e,error:t}=await ne.from("professions").select("*").order("name");if(t)throw console.error("Error fetching profession list:",t),new Error(t.message||"Failed to fetch profession list");return e||[]}async function O6(e){const{data:t,error:r}=await ne.from("heroic_abilities").select("*").eq("profession",e);if(r)throw console.error("Error fetching heroic abilities:",r),new Error(r.message||"Failed to fetch heroic abilities");return t||[]}async function P6(){const{data:e,error:t}=await ne.from("game_spells").select(`
      *,
      magic_schools ( name )
    `).order("name",{ascending:!0});if(t)throw console.error("Error fetching spells:",t),new Error(t.message||"Failed to fetch spells");return e||[]}async function Bp(){const{data:e,error:t}=await ne.from("magic_schools").select("id, name, description").order("name",{ascending:!0});if(t)throw console.error("Error fetching magic schools:",t),new Error(t.message||"Failed to fetch magic schools");return e||[]}function D6(){const{character:e,updateCharacter:t}=Zn(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(null),[u,c]=w.useState(!1),[d,h]=w.useState(null),{data:f=[],isLoading:g,error:p}=Lt({queryKey:["professions"],queryFn:L6}),{data:y=[],isLoading:v,error:x}=Lt({queryKey:["magicSchools"],queryFn:Bp});w.useEffect(()=>{if(e.profession&&f.length>0){const I=f.find(A=>A.name===e.profession);if(I&&(n(I),I.magic_school_id===null&&e.professionHeroicAbilityName&&b(I.name,e.professionHeroicAbilityName),e.professionHeroicAbilityName&&s.length>0)){const A=s.find(D=>D.name===e.professionHeroicAbilityName);A&&o(A)}}},[e.profession,f,e.professionHeroicAbilityName]);const b=async(I,A)=>{c(!0),h(null);try{const T=await O6(I);i(T);const H=A??e.professionHeroicAbilityName;if(H){const L=T.find(G=>G.name===H);o(L||null)}else o(null)}catch(D){h(D instanceof Error?D.message:"Failed to load heroic abilities"),i([]),o(null)}finally{c(!1)}};w.useEffect(()=>{r&&r.magic_school_id===null?b(r.name):(i([]),o(null),e.professionHeroicAbilityName&&t({professionHeroicAbilityName:null}))},[r]);const E=I=>{var D;n(I),I.magic_school_id!==null&&((D=y.find(T=>T.id===I.magic_school_id))==null||D.name);const A={profession:I.name,key_attribute:I.key_attribute,magicSchool:I.magic_school_id??null,professionHeroicAbilityName:null};I.magic_school_id!==null&&o(null),t(A)},_=I=>{o(I),t({professionHeroicAbilityName:I.name})},k=I=>{var A;return I===null||y.length===0?null:((A=y.find(D=>D.id===I))==null?void 0:A.name)??`ID: ${I}`},S=(I,A)=>{if(!Array.isArray(I)||I.length===0)return a.jsxs("p",{className:"text-sm text-gray-500",children:["No ",A.toLowerCase()," listed."]});const D=I.filter(T=>typeof T=="string");return D.length===0?a.jsxs("p",{className:"text-sm text-gray-500",children:["No valid ",A.toLowerCase()," listed."]}):a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:D.map((T,H)=>a.jsx("li",{children:T},H))})};return g||v?a.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:a.jsx(He,{size:"lg"})}):p||x?a.jsx(Ne,{message:(p==null?void 0:p.message)||(x==null?void 0:x.message)||"Failed to load required data."}):(r&&console.log("Selected Profession Data:",r),a.jsxs("div",{className:"flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6 h-[80vh]",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 overflow-y-auto max-h-[30vh] md:max-h-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Profession List"}),a.jsx("ul",{className:"space-y-2",children:f.map(I=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md border ${(r==null?void 0:r.id)===I.id?"bg-blue-100 border-blue-300 font-semibold":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>E(I),children:I.name},I.id))})]}),a.jsx("div",{className:"w-full md:w-2/3 md:pl-4 overflow-y-auto max-h-[calc(80vh-30vh-2rem)] md:max-h-full",children:r?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:r.description})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Key Attribute"}),a.jsx("p",{className:"text-gray-700",children:r.key_attribute})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Skills"}),S(r.skills,"Skills")]}),r.starting_equipment&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Starting Equipment"}),S(r.starting_equipment,"Starting Equipment")]}),r.equipment_description&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Equipment Notes"}),S(r.equipment_description,"Equipment Notes")]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Heroic Ability / Magic"}),r.magic_school_id!==null?a.jsxs("p",{className:"text-gray-600",children:["As a mage of the ",a.jsx("strong",{children:k(r.magic_school_id)??"Unknown School"})," school, you don't get a starting heroic ability. Instead, you get your magic."]}):a.jsxs(a.Fragment,{children:[u&&a.jsx(He,{size:"sm"}),d&&a.jsx(Ne,{message:d}),!u&&!d&&s.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(I=>a.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${(l==null?void 0:l.id)===I.id?"border-green-500 bg-green-50 ring-2 ring-green-300":"border-gray-200 hover:border-green-300 hover:bg-green-50"}`,onClick:()=>_(I),children:[a.jsx("h5",{className:"font-semibold text-lg mb-2",children:I.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:I.description}),a.jsxs("p",{className:"text-sm text-blue-600",children:["Willpower Cost: ",I.willpower_cost??"N/A"," WP"]}),I.requirement&&typeof I.requirement=="string"&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requirement: ",I.requirement]})]},I.id))}):!u&&!d&&a.jsx("p",{className:"text-gray-600",children:"No specific heroic abilities listed for this profession, or none available."})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg sticky bottom-0",children:[a.jsxs("p",{className:"text-blue-800 font-medium",children:["Selected: ",a.jsx("strong",{children:r.name}),r.magic_school_id!==null&&a.jsxs(a.Fragment,{children:[" (Magic School: ",a.jsx("strong",{children:k(r.magic_school_id)??"N/A"}),")"]}),r.magic_school_id===null&&e.professionHeroicAbilityName&&a.jsxs(a.Fragment,{children:[" with Heroic Ability: ",a.jsx("strong",{children:e.professionHeroicAbilityName})]})]}),r.magic_school_id===null&&!e.professionHeroicAbilityName&&s.length>0&&!u&&a.jsx("p",{className:"text-amber-700 mt-2 text-sm",children:"Please select a heroic ability above to continue."}),r.magic_school_id===null&&s.length===0&&!u&&!d&&a.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"No heroic ability selection required for this profession."})]})]}):a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500 text-lg",children:"Select a profession from the list to view details."})})})]}))}const qc={Young:{attributes:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},skillPoints:8},Adult:{attributes:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},skillPoints:10},Old:{attributes:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0},skillPoints:12}};function M6(){const{character:e,updateCharacter:t}=Zn(),r=n=>n===0?"No change":n>0?`+${n}`:n;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Details"}),a.jsx("p",{className:"text-gray-600",children:"Choose a name that fits your character's background and select their age category. Age affects your starting attributes and the number of skill points available during character creation."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Character Name"}),a.jsxs("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ni,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:e.name||"",onChange:n=>t({name:n.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter character name"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Age Category"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Young","Adult","Old"].map(n=>a.jsxs("div",{className:`relative rounded-lg border p-6 cursor-pointer transition-all ${e.age===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>t({age:n}),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(xg,{className:`h-5 w-5 ${e.age===n?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium",children:n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Attribute Modifiers"}),a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:Object.entries(qc[n].attributes).map(([s,i])=>i!==0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-gray-600",children:[s,":"]}),a.jsx("span",{className:i>0?"text-green-600":"text-red-600",children:r(i)})]},s))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Skill Points"}),a.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[qc[n].skillPoints," points"]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[n==="Young"&&"Quick to learn, physically developing",n==="Adult"&&"Balanced attributes and experience",n==="Old"&&"Wise and knowledgeable, physically declining"]})]})]},n))})]})]}),(e.name||e.age)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[e.name&&a.jsxs("p",{className:"text-green-800",children:["Name: ",a.jsx("strong",{children:e.name})]}),e.age&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-green-800",children:["Age Category: ",a.jsx("strong",{children:e.age})]}),a.jsxs("p",{className:"text-sm text-green-700",children:["Starting Skill Points: ",a.jsx("strong",{children:qc[e.age].skillPoints})]}),Object.entries(qc[e.age].attributes).filter(([n,s])=>s!==0).map(([n,s])=>a.jsxs("p",{className:"text-sm text-green-700",children:[n," Modifier: ",a.jsx("strong",{children:r(s)})]},n))]})]})})]})}const $f=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,zf=e=>e<=12?"None":e<=15?"+D4":"+D6",Oi=()=>{const e=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return e.sort((t,r)=>r-t),e.slice(0,3).reduce((t,r)=>t+r,0)},F6=()=>({STR:Oi(),CON:Oi(),AGL:Oi(),INT:Oi(),WIL:Oi(),CHA:Oi()}),B6={Young:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},Adult:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},Old:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0}};function U6(){var f,g,p,y,v,x;const{character:e,updateCharacter:t}=Zn(),[r,n]=w.useState({STR:{value:((f=e.attributes)==null?void 0:f.STR)||0,baseChance:0},CON:{value:((g=e.attributes)==null?void 0:g.CON)||0,baseChance:0},AGL:{value:((p=e.attributes)==null?void 0:p.AGL)||0,baseChance:0},INT:{value:((y=e.attributes)==null?void 0:y.INT)||0,baseChance:0},WIL:{value:((v=e.attributes)==null?void 0:v.WIL)||0,baseChance:0},CHA:{value:((x=e.attributes)==null?void 0:x.CHA)||0,baseChance:0}}),[s,i]=w.useState(!1),l=b=>e.age?B6[e.age][b]:0,o=(b,E)=>{const _=l(b);return E+_},u=()=>{i(!0);const b=F6(),E=Object.entries(b).reduce((k,[S,I])=>({...k,[S]:o(S,I)}),{}),_=Object.entries(b).reduce((k,[S,I])=>({...k,[S]:{value:I,baseChance:$f(o(S,I))}}),{});n(_),t({attributes:E,current_hp:E.CON,current_wp:E.WIL,magic_school:e.magicSchool??null}),i(!1)},c=(b,E)=>{const _=Math.max(3,Math.min(18,parseInt(E)||0)),k=o(b,_),S={...r,[b]:{value:_,baseChance:$f(k)}};n(S);const I=Object.entries(S).reduce((A,[D,{value:T}])=>({...A,[D]:o(D,T)}),{});t({attributes:I,current_hp:I.CON,current_wp:I.WIL,magic_school:e.magicSchool??null})},d=()=>{if(!e.kin||!r.AGL.value)return 0;const b={Human:10,Halfling:8,Dwarf:8,Elf:10,Mallard:8,Wolfkin:12}[e.kin],E=o("AGL",r.AGL.value);let _=0;return E<=6?_=-4:E<=9?_=-2:E<=12?_=0:E<=15?_=2:_=4,b+_},h=e.key_attribute;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Assign Attributes"}),a.jsxs("p",{className:"text-gray-600",children:["Roll or manually enter your character's attributes. Each attribute is determined by rolling 4D6 and removing the lowest die, giving you a score between 3 and 18. ",e.age&&"Age modifiers will be automatically applied."]}),e.profession&&a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-blue-800",children:["Selected Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&a.jsxs(a.Fragment,{children:[" (Key Attribute: ",a.jsx("strong",{children:e.key_attribute}),")"]})]})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?a.jsx(jE,{className:"w-5 h-5 animate-spin"}):a.jsx(or,{className:"w-5 h-5"}),"Roll All Attributes"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([b,{value:E,baseChance:_}])=>{const k=l(b),S=o(b,E),I=h===b;return a.jsxs("div",{className:`p-4 border rounded-lg shadow-sm bg-white ${I?"bg-yellow-100 border-yellow-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-lg font-medium",children:b}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Base Chance: ",$f(S)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",min:"3",max:"18",value:E||"",onChange:A=>c(b,A.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),k!==0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Age Modifier:"}),a.jsx("span",{className:k>0?"text-green-600":"text-red-600",children:k>0?`+${k}`:k})]}),E>0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Final Value:"}),a.jsx("span",{className:"font-medium text-blue-600",children:S})]})]}),(b==="STR"||b==="AGL")&&S>12&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Damage Bonus: ",zf(S)]})]},b)})}),e.kin&&Object.values(r).every(b=>b.value>0)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"Movement"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d()})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"STR Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:zf(o("STR",r.STR.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"AGL Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:zf(o("AGL",r.AGL.value))})]})]})}),e.age&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Age Modifiers Applied"}),a.jsxs("p",{className:"text-sm text-amber-700",children:[e.age==="Young"&&"Young: +1 CON, +1 AGL",e.age==="Adult"&&"Adult: No attribute modifiers",e.age==="Old"&&"Old: -2 STR, -2 CON, -2 AGL, +1 INT, +1 WIL"]})]})]})]})}function H6(e){const[t,r]=w.useState([]),[n,s]=w.useState([]),[i,l]=w.useState(!0),[o,u]=w.useState(null);return w.useEffect(()=>{async function c(){try{l(!0),u(null);const{data:d,error:h}=await ne.from("game_spells").select("*").eq("rank",0).order("name");if(h)throw h;r(d||[]);let f=ne.from("game_spells").select(`
            *,
            magic_schools ( name )
          `).eq("rank",1).order("name");e?f=f.or(`school_id.is.null,school_id.eq.${e}`):f=f.is("school_id",null);const{data:g,error:p}=await f;if(p)throw p;s(g||[])}catch(d){console.error("Error loading spells:",d),u(d instanceof Error?d.message:"Failed to load spells")}finally{l(!1)}}c()},[e]),{tricks:t,spells:n,loading:i,error:o}}const qf={"6d2d7686-da89-4c42-a763-6b143c1dac60":"Elementalist","b500058b-543f-4c44-a097-911102245236":"Mentalist","e7836c1c-517a-41f8-bd71-92ba20d9c9e1":"Animist"};function $6(){var b;const{character:e,updateCharacter:t}=Zn(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState("all"),[u,c]=w.useState(1),d=(b=e.profession)==null?void 0:b.includes("Mage"),h=d&&e.magicSchool?e.magicSchool:null;if(!d)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Only mages can learn and cast spells. Continue to the next step."})});if(h===null)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please go back to the Profession step and select a magic school before choosing spells."})]})]})});const{tricks:f,spells:g,loading:p}=H6(h),y=(E,_)=>{_==="trick"?r.includes(E)?n(r.filter(k=>k!==E)):r.length<3&&n([...r,E]):s.includes(E)?i(s.filter(k=>k!==E)):s.length<3&&i([...s,E])},v=g.filter(E=>l==="general"?E.school_id===null:l==="school"?E.school_id===h:E.rank===u);if(p)return a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(E4,{className:"w-8 h-8 animate-spin text-blue-600"})});const x=()=>{t({spells:{general:[...r,...s.filter(E=>{var _;return((_=g.find(k=>k.name===E))==null?void 0:_.school_id)===null})],school:{name:qf[h]||"Unknown",spells:s.filter(E=>{var _;return((_=g.find(k=>k.name===E))==null?void 0:_.school_id)===h})}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Magic"}),a.jsxs("p",{className:"text-gray-600",children:["As a newly created mage, you may choose three rank 1 spells and three magic tricks. You can select spells from both General Magic and your chosen school of magic (",qf[h]||"General",")."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Your Magic School"}),a.jsx("p",{className:"text-sm text-blue-700",children:qf[h]||"General Magic"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Magic Tricks"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",r.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(E=>{var _;return a.jsxs("div",{onClick:()=>y(E.name,"trick"),className:`p-4 border rounded-lg cursor-pointer transition-all ${r.includes(E.name)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ol,{className:`w-5 h-5 ${r.includes(E.name)?"text-purple-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:E.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=E.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:E.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",E.casting_time]}),a.jsxs("p",{children:["Duration: ",E.duration]}),E.requirement&&a.jsxs("p",{children:["Requirement: ",E.requirement]})]})]},E.name)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Rank 1 Spells"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("select",{value:u,onChange:E=>c(parseInt(E.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[...Array(10)].map((E,_)=>a.jsxs("option",{value:_+1,children:["Rank ",_+1]},_+1))}),a.jsx(Ia,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:l,onChange:E=>o(E.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Spells"}),a.jsx("option",{value:"general",children:"General Magic"}),a.jsx("option",{value:"school",children:"School Spells"})]})]})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",s.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(E=>{var _;return a.jsxs("div",{onClick:()=>y(E.name,"spell"),className:`p-4 border rounded-lg cursor-pointer transition-all ${s.includes(E.name)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ol,{className:`w-5 h-5 ${s.includes(E.name)?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:E.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=E.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:E.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",E.range]}),a.jsxs("p",{children:["Duration: ",E.duration]}),E.requirement!=="None"&&a.jsxs("p",{children:["Requirement: ",E.requirement]})]})]},E.name)})})]}),(r.length<3||s.length<3)&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select 3 magic tricks and 3 rank 1 spells to continue."})]})]}),a.jsxs("button",{onClick:x,disabled:r.length<3||s.length<3,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(ol,{className:"w-5 h-5"}),"Save Spell Selections"]})]})}function GE(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null);return w.useEffect(()=>{async function l(){n(!0),i(null),console.log("useSkills: Fetching skills...");try{const{data:o,error:u}=await ne.from("game_skills").select("*").order("name");if(u)throw console.error("useSkills: Supabase error fetching skills:",u),new Error(u.message||"Failed to fetch skills from database");if(console.log("useSkills: Raw data received from Supabase:",o),Array.isArray(o)){let d=!1;o.forEach((h,f)=>{if(h&&typeof h=="object"){const g=Object.keys(h);g.length>0&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(g[0])&&(!("id"in h)||!("name"in h))&&(console.warn(`useSkills: Potential problematic object structure found at index ${f}:`,h),d=!0),(typeof h.id!="string"||typeof h.name!="string")&&console.warn(`useSkills: Item at index ${f} missing 'id' or 'name', or they have wrong types:`,h)}else console.warn(`useSkills: Invalid non-object item found in fetched data at index ${f}:`,h),d=!0}),d||console.log("useSkills: Initial check of fetched data structure passed.")}else console.warn("useSkills: Fetched data is not an array:",o);const c=Array.isArray(o)?o:[];t(c),console.log(`useSkills: Successfully processed and set ${c.length} skills.`)}catch(o){console.error("useSkills: Error during fetch or processing:",o);const u=o instanceof Error?o.message:"An unknown error occurred while fetching skills";i(u),t([])}finally{n(!1),console.log("useSkills: Fetch finished.")}}l()},[]),{skills:e,loading:r,error:s}}const Vc=e=>{switch(e){case"Young":return 2;case"Adult":return 4;case"Old":return 6;default:return 0}},z6={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},ab=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],Vf=["Animism","Elementalism","Mentalism"];function q6(){const{character:e,updateCharacter:t}=Zn(),{skills:r,loading:n,error:s}=GE(),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState("profession"),[h,f]=w.useState("all"),[g,p]=w.useState([]),[y,v]=w.useState(!1),[x,b]=w.useState(null),[E,_]=w.useState([]),[k,S]=w.useState(!1),I=w.useMemo(()=>{var z;return(z=e.profession)==null?void 0:z.toLowerCase().includes("mage")},[e.profession]);w.useEffect(()=>{I&&(S(!0),ne.from("magic_schools").select("id, name").then(({data:z,error:U})=>{if(U)throw U;_(z||[])}).catch(z=>console.error("Failed to fetch magic schools:",z)).finally(()=>S(!1)))},[I]);const A=w.useMemo(()=>{const z=e.magicSchool;if(typeof z=="object"&&z!==null&&"name"in z&&typeof z.name=="string")return z.name;if(typeof z=="string"&&E.length>0){const U=E.find(j=>j.id===z);return U?U.name:null}return null},[e.magicSchool,E]);w.useEffect(()=>{async function z(){if(e.profession){v(!0),b(null);try{const{data:U,error:j}=await ne.from("professions").select("skills").eq("name",e.profession).single();if(j)throw j;p(Array.isArray(U==null?void 0:U.skills)?U.skills.filter(me=>typeof me=="string"):[])}catch(U){b(U instanceof Error?U.message:"Failed to load profession skills.")}finally{v(!1)}}}z()},[e.profession]);const D=w.useMemo(()=>n||y||!Array.isArray(r)?[]:r.filter(z=>z&&g.includes(z.name)),[r,n,y,g]),T=w.useMemo(()=>{if(n||!Array.isArray(r))return[];const z=r.filter(U=>U&&!i.includes(U.name));return I&&A?z.filter(U=>!Vf.includes(U.name)||U.name===A):z.filter(U=>!Vf.includes(U.name))},[r,n,i,I,A]),H=w.useMemo(()=>{const z=U=>Vf.includes(U);switch(h){case"combat":return T.filter(U=>ab.includes(U.name));case"general":return T.filter(U=>!ab.includes(U.name)&&!z(U.name));case"magic":return T.filter(U=>z(U.name));default:return T}},[T,h]),L=(z,U)=>{const j=U==="profession"?6:Vc(e.age||"");(U==="profession"?l:u)(X=>X.includes(z)?X.filter(W=>W!==z):X.length<j?[...X,z]:X)},G=()=>{c==="profession"&&i.length===6?d("additional"):c==="additional"&&o.length===Vc(e.age||"")&&t({trainedSkills:[...new Set([...i,...o])]})},Q=(z,U)=>{if(!(z!=null&&z.id)||!z.name)return null;const j=z6[z.name]||"N/A",me=U==="profession"?i.includes(z.name):o.includes(z.name),W=(U==="profession"?i.length>=6:o.length>=Vc(e.age||""))&&!me;return a.jsxs("div",{onClick:()=>!W&&L(z.name,U),className:`p-4 border rounded-lg transition-all ${W?"bg-gray-100 opacity-60 cursor-not-allowed":"cursor-pointer"} ${me?"border-blue-500 bg-blue-50 ring-1 ring-blue-500":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Su,{className:`w-5 h-5 flex-shrink-0 ${me?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h5",{className:"font-medium",children:z.name}),a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:j})]})]}),z.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:z.description})]},z.id)};if(n||k)return a.jsx(He,{size:"lg",className:"my-8"});if(s)return a.jsx(Ne,{message:`Skills Error: ${s}`});if(!e.profession||!e.age)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession and age first."})});if(I&&!A)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"As a Mage, please select a magic school first."})]})]})});const $=i.length,V=o.length,K=6,O=Vc(e.age),Z=$===K,N=V===O;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Select Skills"}),e.profession&&a.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-sm",children:[a.jsxs("p",{className:"text-indigo-800",children:["Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&` (Key Attribute: ${e.key_attribute})`,I&&A&&` (School: ${A})`]}),a.jsxs("p",{className:"text-indigo-700 mt-1",children:["Age: ",a.jsx("strong",{children:e.age})," (Grants ",O," additional skill points)"]})]}),a.jsx("p",{className:"text-gray-600 text-sm",children:c==="profession"?`Choose ${K} skills from your profession's list below.`:`Choose ${O} additional skills based on your age (${e.age}).`})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Selection Progress"}),a.jsx("p",{className:"text-sm text-blue-700",children:c==="profession"?`Professional Skills: ${$}/${K}`:`Additional Skills: ${V}/${O}`})]})]}),c==="additional"&&a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx(Ia,{className:"w-4 h-4 text-gray-500"}),a.jsx("label",{htmlFor:"skillFilter",className:"text-sm font-medium text-gray-700",children:"Filter:"}),a.jsxs("select",{id:"skillFilter",value:h,onChange:z=>f(z.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Available"}),a.jsx("option",{value:"combat",children:"Combat"}),a.jsx("option",{value:"general",children:"General"}),I&&a.jsx("option",{value:"magic",children:"Magic"})]})]}),c==="profession"&&y&&a.jsx(He,{size:"md",className:"my-4"}),c==="profession"&&x&&a.jsx(Ne,{message:`Profession Skills Error: ${x}`}),!y&&!x&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c==="profession"&&D.map(z=>Q(z,"profession")),c==="additional"&&H.map(z=>Q(z,"additional")),c==="profession"&&D.length===0&&!y&&!x&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No specific skills found for this profession."}),c==="additional"&&H.length===0&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No skills match the current filter."})]}),(c==="profession"&&!Z&&$>0||c==="additional"&&!N&&V>0)&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:c==="profession"?`Please select ${K-$} more skill(s).`:`Please select ${O-V} more skill(s).`})]})]}),a.jsxs("button",{onClick:G,disabled:c==="profession"&&!Z||c==="additional"&&!N||y,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[y?a.jsx(cs,{className:"w-5 h-5 animate-spin"}):a.jsx(Su,{className:"w-5 h-5"}),c==="profession"?"Continue to Additional Skills":"Confirm Skill Selections"]})]})}function YE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=YE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function QE(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=YE(e))&&(n&&(n+=" "),n+=t);return n}const ib=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,lb=QE,V6=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return lb(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(c=>{const d=r==null?void 0:r[c],h=i==null?void 0:i[c];if(d===null)return null;const f=ib(d)||ib(h);return s[c][f]}),o=r&&Object.entries(r).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,d)=>{let{class:h,className:f,...g}=d;return Object.entries(g).every(p=>{let[y,v]=p;return Array.isArray(v)?v.includes({...i,...o}[y]):{...i,...o}[y]===v})?[...c,h,f]:c},[]);return lb(e,l,u,r==null?void 0:r.class,r==null?void 0:r.className)},kg="-",W6=e=>{const t=Y6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(kg);return o[0]===""&&o.length!==1&&o.shift(),KE(o,t)||G6(l)},getConflictingClassGroupIds:(l,o)=>{const u=r[l]||[];return o&&n[l]?[...u,...n[l]]:u}}},KE=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?KE(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(kg);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},ob=/^\[(.+)\]$/,G6=e=>{if(ob.test(e)){const t=ob.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Y6=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return K6(Object.entries(e.classGroups),r).forEach(([i,l])=>{Up(l,n,i,t)}),n},Up=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:ub(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(Q6(s)){Up(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{Up(l,ub(t,i),r,n)})})},ub=(e,t)=>{let r=e;return t.split(kg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Q6=e=>e.isThemeGetter,K6=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,Z6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},ZE="!",X6=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const u=[];let c=0,d=0,h;for(let v=0;v<o.length;v++){let x=o[v];if(c===0){if(x===s&&(n||o.slice(v,v+i)===t)){u.push(o.slice(d,v)),d=v+i;continue}if(x==="/"){h=v;continue}}x==="["?c++:x==="]"&&c--}const f=u.length===0?o:o.substring(d),g=f.startsWith(ZE),p=g?f.substring(1):f,y=h&&h>d?h-d:void 0;return{modifiers:u,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:y}};return r?o=>r({className:o,parseClassName:l}):l},J6=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},e5=e=>({cache:Z6(e.cacheSize),parseClassName:X6(e),...W6(e)}),t5=/\s+/,r5=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(t5);let o="";for(let u=l.length-1;u>=0;u-=1){const c=l[u],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:g}=r(c);let p=!!g,y=n(p?f.substring(0,g):f);if(!y){if(!p){o=c+(o.length>0?" "+o:o);continue}if(y=n(f),!y){o=c+(o.length>0?" "+o:o);continue}p=!1}const v=J6(d).join(":"),x=h?v+ZE:v,b=x+y;if(i.includes(b))continue;i.push(b);const E=s(y,p);for(let _=0;_<E.length;++_){const k=E[_];i.push(x+k)}o=c+(o.length>0?" "+o:o)}return o};function n5(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=XE(t))&&(n&&(n+=" "),n+=r);return n}const XE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=XE(e[n]))&&(r&&(r+=" "),r+=t);return r};function s5(e,...t){let r,n,s,i=l;function l(u){const c=t.reduce((d,h)=>h(d),e());return r=e5(c),n=r.cache.get,s=r.cache.set,i=o,o(u)}function o(u){const c=n(u);if(c)return c;const d=r5(u,r);return s(u,d),d}return function(){return i(n5.apply(null,arguments))}}const gt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},JE=/^\[(?:([a-z-]+):)?(.+)\]$/i,a5=/^\d+\/\d+$/,i5=new Set(["px","full","screen"]),l5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,o5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,u5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,c5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,d5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,rs=e=>cl(e)||i5.has(e)||a5.test(e),Os=e=>Kl(e,"length",b5),cl=e=>!!e&&!Number.isNaN(Number(e)),Wf=e=>Kl(e,"number",cl),xo=e=>!!e&&Number.isInteger(Number(e)),h5=e=>e.endsWith("%")&&cl(e.slice(0,-1)),Me=e=>JE.test(e),Ps=e=>l5.test(e),f5=new Set(["length","size","percentage"]),m5=e=>Kl(e,f5,eN),p5=e=>Kl(e,"position",eN),g5=new Set(["image","url"]),x5=e=>Kl(e,g5,w5),y5=e=>Kl(e,"",v5),yo=()=>!0,Kl=(e,t,r)=>{const n=JE.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},b5=e=>o5.test(e)&&!u5.test(e),eN=()=>!1,v5=e=>c5.test(e),w5=e=>d5.test(e),E5=()=>{const e=gt("colors"),t=gt("spacing"),r=gt("blur"),n=gt("brightness"),s=gt("borderColor"),i=gt("borderRadius"),l=gt("borderSpacing"),o=gt("borderWidth"),u=gt("contrast"),c=gt("grayscale"),d=gt("hueRotate"),h=gt("invert"),f=gt("gap"),g=gt("gradientColorStops"),p=gt("gradientColorStopPositions"),y=gt("inset"),v=gt("margin"),x=gt("opacity"),b=gt("padding"),E=gt("saturate"),_=gt("scale"),k=gt("sepia"),S=gt("skew"),I=gt("space"),A=gt("translate"),D=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",Me,t],L=()=>[Me,t],G=()=>["",rs,Os],Q=()=>["auto",cl,Me],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>["start","end","center","between","around","evenly","stretch"],Z=()=>["","0",Me],N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>[cl,Me];return{cacheSize:500,separator:":",theme:{colors:[yo],spacing:[rs,Os],blur:["none","",Ps,Me],brightness:z(),borderColor:[e],borderRadius:["none","","full",Ps,Me],borderSpacing:L(),borderWidth:G(),contrast:z(),grayscale:Z(),hueRotate:z(),invert:Z(),gap:L(),gradientColorStops:[e],gradientColorStopPositions:[h5,Os],inset:H(),margin:H(),opacity:z(),padding:L(),saturate:z(),scale:z(),sepia:Z(),skew:z(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",Me]}],container:["container"],columns:[{columns:[Ps]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),Me]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",xo,Me]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Me]}],grow:[{grow:Z()}],shrink:[{shrink:Z()}],order:[{order:["first","last","none",xo,Me]}],"grid-cols":[{"grid-cols":[yo]}],"col-start-end":[{col:["auto",{span:["full",xo,Me]},Me]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[yo]}],"row-start-end":[{row:["auto",{span:[xo,Me]},Me]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Me]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Me]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...O()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...O(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...O(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Me,t]}],"min-w":[{"min-w":[Me,t,"min","max","fit"]}],"max-w":[{"max-w":[Me,t,"none","full","min","max","fit","prose",{screen:[Ps]},Ps]}],h:[{h:[Me,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Me,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Me,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Me,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ps,Os]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Wf]}],"font-family":[{font:[yo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Me]}],"line-clamp":[{"line-clamp":["none",cl,Wf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",rs,Me]}],"list-image":[{"list-image":["none",Me]}],"list-style-type":[{list:["none","disc","decimal",Me]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",rs,Os]}],"underline-offset":[{"underline-offset":["auto",rs,Me]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Me]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Me]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),p5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",m5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},x5]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:V()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[rs,Me]}],"outline-w":[{outline:[rs,Os]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[rs,Os]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ps,y5]}],"shadow-color":[{shadow:[yo]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Ps,Me]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Me]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",Me]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",Me]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[xo,Me]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Me]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Me]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Me]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[rs,Os,Wf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},N5=s5(E5);function k5(...e){return N5(QE(e))}const _5=V6("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",danger:"bg-red-600 text-white hover:bg-red-700",danger_outline:"border border-red-500 text-red-600 hover:bg-red-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"primary",size:"default"}}),B=Sn.forwardRef(({className:e,variant:t,size:r,icon:n,iconPosition:s="left",fullWidth:i,loading:l,children:o,...u},c)=>{const d=l||u.disabled;return a.jsxs("button",{className:k5(_5({variant:t,size:r,className:e}),i&&"w-full",l&&"relative"),ref:c,disabled:d,...u,children:[l&&a.jsx(cs,{className:`animate-spin h-4 w-4 ${o?s==="left"?"mr-2":"ml-2":""}`}),!l&&n&&s==="left"&&a.jsx(n,{className:`h-4 w-4 ${o?"mr-2":""}`}),!l&&o,!l&&n&&s==="right"&&a.jsx(n,{className:`h-4 w-4 ${o?"ml-2":""}`})]})});B.displayName="Button";async function lc(e){let t=ne.from("game_items").select("*");e&&e!=="all"&&typeof e=="string"&&(t=t.eq("category",e.toUpperCase()));const{data:r,error:n}=await t.order("category").order("name");if(n)throw console.error("Error fetching game items:",n),new Error(n.message||"Failed to fetch game items");return r||[]}function S5(e){const t={gold:0,silver:0,copper:0};if(!e||typeof e!="string")return t;const r=e.toLowerCase().split(/,\s*|\s+/);for(let n=0;n<r.length;n++){const s=parseInt(r[n]);if(!isNaN(s)&&n+1<r.length){const i=r[n+1];i.startsWith("gold")||i.startsWith("g")?(t.gold=s,n++):i.startsWith("silver")||i.startsWith("s")?(t.silver=s,n++):(i.startsWith("copper")||i.startsWith("c"))&&(t.copper=s,n++)}}return _g(t)}function T5(e){if(!e)return"0 copper";const t=[];return e.gold>0&&t.push(`${e.gold} gold`),e.silver>0&&t.push(`${e.silver} silver`),e.copper>0&&t.push(`${e.copper} copper`),t.length>0?t.join(", "):"0 copper"}function _g(e){let{gold:t,silver:r,copper:n}=e;return r+=Math.floor(n/100),n%=100,t+=Math.floor(r/100),r%=100,{gold:t,silver:r,copper:n}}function C5(e,t){const r=e.gold*1e4+e.silver*100+e.copper,n=t.gold*1e4+t.silver*100+t.copper;if(r<n)return{success:!1,newMoney:e};let s=r-n;const i=Math.floor(s/1e4);s%=1e4;const l=Math.floor(s/100);return s%=100,{success:!0,newMoney:{gold:i,silver:l,copper:s}}}function j5(){var T,H;const{character:e,updateCharacter:t}=Zn(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState({}),[f,g]=w.useState(!0),[p,y]=w.useState(""),{data:v=[],isLoading:x,error:b}=Lt({queryKey:["gameItems"],queryFn:lc,staleTime:1e3*60*10});w.useEffect(()=>{async function L(){if(!e.profession){y("Profession not selected."),g(!1);return}try{g(!0),y("");const{data:G,error:Q}=await ne.from("professions").select("starting_equipment, equipment_description").eq("name",e.profession).single();if(Q)throw Q;if(G){const $=G,V=($.starting_equipment||[]).map((K,O)=>({option:O+1,items:K.split(",").map(Z=>Z.trim()).filter(Boolean),description:($.equipment_description||[])[O]||""}));i(V)}}catch{y("Failed to load equipment options.")}finally{g(!1)}}L()},[e.profession]);const E=L=>{const Q=L.split(" or ")[0].trim().replace(/^\d+\s+/,"");return v.find($=>$.name.toLowerCase()===Q.toLowerCase())},_=L=>{const G=L.match(/^(\d*D\d+)/i);if(!G)return null;const Q=G[1],$=Q.toUpperCase().split("D"),V=$[0]===""?1:parseInt($[0]),K=parseInt($[1]),O=L.slice(Q.length).trim();return{count:V,sides:K,rest:O}},k=(L,G)=>{let Q=0;for(let $=0;$<L;$++)Q+=Math.floor(Math.random()*G)+1;return Q},S=L=>{n(L),o(!1)},I=()=>{var Q,$;if(r===null)return;const L=s.find(V=>V.option===r);if(!L)return;if(L.items.some(V=>_(V)||V.toLowerCase().includes(" or "))){const V=L.items.reduce((K,O,Z)=>(O.toLowerCase().includes(" or ")?K[Z]=O.split(/\s+or\s+/i)[0].trim():K[Z]="",K),{});h(V),c(!0)}else t({startingEquipment:{option:r,items:L.items},equipment:{money:((Q=e.equipment)==null?void 0:Q.money)||{gold:0,silver:0,copper:0},equipped:(($=e.equipment)==null?void 0:$.equipped)||{weapons:[]},inventory:[...L.items]}}),o(!0)},A=()=>{var V,K;if(r===null)return;const L=s.find(O=>O.option===r);if(!L)return;const Q={...((V=e.equipment)==null?void 0:V.money)||{gold:0,silver:0,copper:0}},$=[];L.items.forEach((O,Z)=>{if(O.toLowerCase().includes(" or "))$.push(d[Z]||O.split(/\s+or\s+/i)[0].trim());else{const N=_(O);if(N){const z=d[Z]?parseInt(d[Z]):k(N.count,N.sides),U=N.rest.toLowerCase();U.includes("gold")?Q.gold+=z:U.includes("silver")?Q.silver+=z:U.includes("copper")?Q.copper+=z:$.push(`${z} ${N.rest}`)}else $.push(O)}}),t({startingEquipment:{option:r,items:$},equipment:{money:_g(Q),equipped:((K=e.equipment)==null?void 0:K.equipped)||{weapons:[]},inventory:[...$]}}),c(!1),o(!0)},D=r!==null&&((T=s.find(L=>L.option===r))==null?void 0:T.items.every((L,G)=>L.toLowerCase().includes(" or ")||_(L)?!!d[G]:!0));return f||x?a.jsx(He,{}):p||b?a.jsx(Ne,{message:p||(b==null?void 0:b.message)||"Failed to load data."}):e.profession?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Starting Equipment"}),a.jsxs("p",{className:"text-gray-600",children:["Select one of the equipment packages for your ",e.profession,"."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Equipment Selection"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Items with ",a.jsx(Gy,{className:"inline w-4 h-4 text-amber-600"})," require a roll, items with ",a.jsx(Ky,{className:"inline w-4 h-4 text-purple-600"})," offer a choice."]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(L=>a.jsxs("div",{onClick:()=>S(L.option),className:`p-6 border rounded-lg cursor-pointer transition-all ${r===L.option?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Tu,{className:"w-6 h-6 text-gray-500"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold",children:["Option ",L.option]}),a.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Equipment List:"}),a.jsx("ul",{className:"space-y-1.5",children:L.items.map((G,Q)=>{const $=!!_(G),V=G.toLowerCase().includes(" or "),K=E(G);return a.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-600",children:[$?a.jsx(Gy,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):V?a.jsx(Ky,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):a.jsx(Su,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a.jsx("span",{children:G}),(K==null?void 0:K.effect)&&a.jsxs("span",{className:"relative group flex items-center",children:[a.jsx(On,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-xs bg-gray-800 text-white text-xs p-2 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-20 pointer-events-none",children:[a.jsx("p",{className:"font-bold",children:K.name}),a.jsx("p",{children:K.effect}),a.jsxs("p",{className:"mt-1 text-gray-300",children:["Weight: ",K.weight,", Cost: ",K.cost]})]})]})]},Q)})})]}),r===L.option&&a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[a.jsx(Su,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Selected"})]})]},L.option))}),!r&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Equipment Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select a starting equipment package."})]})]}),a.jsxs("button",{onClick:I,disabled:!r||l,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${l?"bg-green-600 text-white cursor-default":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[a.jsx(bE,{className:"w-5 h-5"}),l?"Equipment Confirmed":"Confirm Equipment Selection"]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Resolve Dice Rolls & Selections"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{className:"w-5 h-5"})})]}),(((H=s.find(L=>L.option===r))==null?void 0:H.items)||[]).map((L,G)=>{if(L.toLowerCase().includes(" or ")){const $=L.split(/\s+or\s+/i).map(V=>V.trim());return a.jsxs("div",{className:"mb-4 p-3 border rounded bg-purple-50 border-purple-200",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:L}),a.jsxs("select",{value:d[G]||"",onChange:V=>h(K=>({...K,[G]:V.target.value})),className:"mt-1 w-full border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select one..."}),$.map((V,K)=>a.jsx("option",{value:V,children:V},K))]})]},G)}const Q=_(L);return Q?a.jsxs("div",{className:"mb-4 p-3 border rounded bg-amber-50 border-amber-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium",children:L}),a.jsxs(B,{size:"sm",variant:"secondary",onClick:()=>{const $=k(Q.count,Q.sides);h(V=>({...V,[G]:$.toString()}))},children:["Roll ",Q.count,"D",Q.sides]})]}),a.jsx("input",{type:"number",min:Q.count,max:Q.count*Q.sides,value:d[G]||"",onChange:$=>{const V=$.target.value;if(V==="")h(K=>({...K,[G]:""}));else{const K=parseInt(V);if(!isNaN(K)){const O=Math.max(Q.count,Math.min(Q.count*Q.sides,K));h(Z=>({...Z,[G]:O.toString()}))}}},className:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:`Enter result (${Q.count}-${Q.count*Q.sides})`})]},G):null}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(B,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),a.jsx(B,{variant:"primary",onClick:A,disabled:!D,children:"Confirm Rolls/Choices"})]})]})})]}):a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession first."})})}async function A5(){const{data:e,error:t}=await ne.from("compendium").select("*").order("category").order("title");if(t)throw console.error("Error fetching compendium entries:",t),new Error(t.message||"Failed to load compendium entries");return e||[]}async function I5(){const{data:e,error:t}=await ne.from("compendium_templates").select("*").order("category").order("name");if(t)throw console.error("Error fetching compendium templates:",t),new Error(t.message||"Failed to load compendium templates");return e||[]}async function R5(){const{data:e,error:t}=await ne.from("bio_data").select("appearance, mementos, flaws");if(t)throw console.error("Error fetching bio data:",t),new Error(t.message||"Failed to load bio data");const r=new Set,n=new Set,s=new Set;return(e||[]).forEach(i=>{(i.appearance||[]).forEach(l=>r.add(l)),(i.mementos||[]).forEach(l=>n.add(l)),(i.flaws||[]).forEach(l=>s.add(l))}),{appearance:Array.from(r).sort(),mementos:Array.from(n).sort(),flaws:Array.from(s).sort()}}const cb=["Diminutive","Short","Below Average","Average","Above Average","Tall","Towering"],db=["Gaunt","Slight","Lean","Wiry","Average","Athletic","Muscular","Stocky","Heavy"],hb=["Raven Black","Chestnut Brown","Sandy Blonde","Fiery Red","Ash Gray","Snow White","Auburn"],fb=["Slicked Back","Short & Spiky","Long & Flowing","Ornate Braids","Messy Bun","Curly Mop","Shaved Sides","Tonsure","Bald"],mb=["Chocolate Brown","Sky Blue","Emerald Green","Stormy Gray","Warm Hazel","Amber"],pb=["Pale","Fair","Light","Olive","Ruddy","Tan","Dark","Ebony"],gb=["Deep Blue","Crimson","Silver","Violet","Pastel Pink"],xb=["Lilac","Gold","Silver","Blood Red","All White (No Pupil)"],yb=["Simple traveler's clothes","Ragged commoner's garb","Well-made leather armor","Sturdy chainmail hauberk","Flamboyant noble's attire","Scholar's robes and spectacles","Mysterious hooded cloak","Practical hunter's leathers","Grim ritual vestments","Colorful entertainer's outfit","Tailored city guard uniform","Patched and worn adventurer's gear"],Wc=({label:e,placeholder:t,options:r,value:n,onChange:s,mode:i,onModeChange:l,onRandomize:o,isLoading:u=!1,rows:c=3})=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),a.jsxs("button",{onClick:()=>l(i==="manual"?"select":"manual"),className:"flex items-center gap-1 text-xs text-gray-600 hover:text-blue-600",title:`Switch to ${i==="manual"?"selection":"manual"} mode`,children:[i==="manual"?a.jsx(B4,{className:"w-4 h-4"}):a.jsx(U4,{className:"w-4 h-4"}),a.jsx("span",{children:i==="manual"?"Manual":"Select"})]})]}),i==="manual"?a.jsx("textarea",{value:n,onChange:d=>s(d.target.value),placeholder:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:c}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("select",{value:n,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:u||r.length===0,children:[a.jsx("option",{value:"",children:u?"Loading...":"Select an option..."}),r.map(d=>a.jsx("option",{value:d,children:d},d))]}),a.jsx(B,{variant:"secondary",size:"icon",onClick:o,disabled:u||r.length===0,"aria-label":`Randomize ${e}`,icon:or})]})]});function L5(){const{character:e,updateCharacter:t}=Zn(),{data:r,isLoading:n}=Lt({queryKey:["bioData"],queryFn:R5,staleTime:1e3*60*5}),[s,i]=w.useState({height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",distinctiveFeatures:"",clothing:"",memento:"",flaw:""}),[l,o]=w.useState({distinctiveFeatures:"select",clothing:"select",memento:"select",flaw:"select"}),u=(x,b)=>{i(E=>({...E,[x]:b}))},c=(x,b)=>{o(E=>({...E,[x]:b})),i(E=>({...E,[x]:""}))},d=x=>!x||x.length===0?"":x[Math.floor(Math.random()*x.length)],h=(x,b)=>{b&&b.length>0&&i(E=>({...E,[x]:d(b)}))},f=()=>{i(x=>({...x,height:d(cb),build:d(db)}))},g=()=>{const x=Math.random()<.05?d(gb):d(hb),b=Math.random()<.05?d(xb):d(mb);i(E=>({...E,hairColor:x,hairStyle:d(fb),eyeColor:b,skinTone:d(pb)}))},p=()=>{const x=[];s.height&&s.build&&x.push(`A ${s.height.toLowerCase()}, ${s.build.toLowerCase()} individual`),s.hairStyle&&s.hairColor&&(s.hairStyle.toLowerCase()==="bald"?x.push("with a bald head"):x.push(`with ${s.hairStyle.toLowerCase()} ${s.hairColor.toLowerCase()} hair`)),s.eyeColor&&x.push(`${s.eyeColor.toLowerCase()} eyes`),s.skinTone&&x.push(`and ${s.skinTone.toLowerCase()} skin`);let b=x.join(", ").replace(/,([^,]*)$/," and$1")+".";return s.distinctiveFeatures&&(b+=` They are notable for ${s.distinctiveFeatures.toLowerCase()}.`),s.clothing&&(b+=` They typically wear ${s.clothing.toLowerCase()}.`),b},y=()=>{const x=p();t({appearance:x,mementos:s.memento?[s.memento]:[],weak_spot:s.flaw})},v=()=>Object.values(s).every(x=>x.trim()!=="");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Character Appearance"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Describe your character's physical appearance, clothing, and defining traits."})]}),a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Character Details"}),a.jsxs("p",{className:"text-sm text-blue-700",children:[e.kin,"  ",e.age,"  ",e.profession]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(A4,{className:"w-5 h-5 text-gray-500"}),"Physical Characteristics"]}),a.jsx(B,{variant:"secondary",size:"sm",icon:or,onClick:f,children:"Randomize"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),a.jsxs("select",{value:s.height,onChange:x=>u("height",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select height..."}),cb.map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build"}),a.jsxs("select",{value:s.build,onChange:x=>u("build",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select build..."}),db.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(Ni,{className:"w-5 h-5 text-gray-500"}),"Hair and Face"]}),a.jsx(B,{variant:"secondary",size:"sm",icon:or,onClick:g,children:"Randomize"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Color"}),a.jsxs("select",{value:s.hairColor,onChange:x=>u("hairColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...hb,...gb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Style"}),a.jsxs("select",{value:s.hairStyle,onChange:x=>u("hairStyle",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select style..."}),fb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eye Color"}),a.jsxs("select",{value:s.eyeColor,onChange:x=>u("eyeColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...mb,...xb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skin Tone"}),a.jsxs("select",{value:s.skinTone,onChange:x=>u("skinTone",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select tone..."}),pb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]})]}),a.jsx("div",{className:"space-y-4 md:col-span-2",children:a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800 border-b pb-2",children:[a.jsx(ol,{className:"w-5 h-5 text-gray-500"}),"Traits & Possessions"]})}),a.jsx(Wc,{label:"Distinctive Feature",placeholder:"Scars, tattoos, birthmarks...",options:(r==null?void 0:r.appearance)||[],value:s.distinctiveFeatures,onChange:x=>u("distinctiveFeatures",x),mode:l.distinctiveFeatures,onModeChange:x=>c("distinctiveFeatures",x),onRandomize:()=>h("distinctiveFeatures",r==null?void 0:r.appearance),isLoading:n}),a.jsx(Wc,{label:"Typical Clothing",placeholder:"Describe typical clothing...",options:yb,value:s.clothing,onChange:x=>u("clothing",x),mode:l.clothing,onModeChange:x=>c("clothing",x),onRandomize:()=>h("clothing",yb)}),a.jsx(Wc,{label:"Memento",placeholder:"A locket, a worn coin...",options:(r==null?void 0:r.mementos)||[],value:s.memento,onChange:x=>u("memento",x),mode:l.memento,onModeChange:x=>c("memento",x),onRandomize:()=>h("memento",r==null?void 0:r.mementos),isLoading:n}),a.jsx(Wc,{label:"Flaw / Weak Spot",placeholder:"A fear of heights, a gambling problem...",options:(r==null?void 0:r.flaws)||[],value:s.flaw,onChange:x=>u("flaw",x),mode:l.flaw,onModeChange:x=>c("flaw",x),onRandomize:()=>h("flaw",r==null?void 0:r.flaws),isLoading:n})]}),v()?a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg space-y-3",children:[a.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"Appearance Preview"}),a.jsx("p",{className:"text-sm text-green-700",children:p()})]}):a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Description"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please fill in all appearance details to see a preview and save."})]})]}),a.jsx(B,{onClick:y,disabled:!v(),icon:Gt,className:"w-full justify-center",children:"Save Appearance"})]})}const bo=[{title:"Kin",component:R6},{title:"Profession",component:D6},{title:"Name & Age",component:M6},{title:"Attributes",component:U6},{title:"Magic",component:$6},{title:"Trained Skills",component:q6},{title:"Gear",component:j5},{title:"Appearance",component:L5}],O5=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,bb={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},P5=["Mentalism","Animism","Elementalism"];function D5(){const{user:e}=$t(),{step:t,setStep:r,character:n,resetCharacter:s}=Zn(),[i,l]=Sn.useState(null),[o,u]=Sn.useState(!1),c=dn(),d=cn(),h=bo[t].component,[f,g]=w.useState([]);w.useEffect(()=>{ne.from("magic_schools").select("id, name").then(({data:v,error:x})=>{x?console.error("Failed to fetch magic schools in wizard:",x):g(v||[])})},[]);const p=()=>{var v;switch(t){case 0:return!!n.kin&&n.kinAbilityNames!==void 0&&n.kinAbilityNames.length>0;case 1:const x=n.magicSchool!==null&&n.magicSchool!==void 0;return!!n.profession&&(x||n.professionHeroicAbilityName!==void 0);case 2:return!!n.name&&n.name.trim().length>0&&!!n.age;case 3:return n.attributes&&Object.values(n.attributes).every(b=>b>0);case 4:return n.magicSchool?((v=n.spells)==null?void 0:v.general)&&n.spells.general.length>=3:!0;case 5:return n.trainedSkills&&n.trainedSkills.length>=6&&!!n.attributes;case 6:return n.startingEquipment&&n.startingEquipment.items.length>=0;case 7:return!!n.appearance&&n.appearance.trim().length>0&&!!n.mementos&&n.mementos.length>0&&!!n.weak_spot&&n.weak_spot.trim().length>0;default:return!1}},y=async()=>{var x,b,E,_,k;const v=Zn.getState().character;if(!e||!v.attributes){l("User or attributes missing.");return}if(!p()){l("Please complete all required fields for the final step before saving.");return}try{u(!0),l(null);const S={},I=new Set(v.trainedSkills||[]),A=(x=v.profession)==null?void 0:x.toLowerCase().includes("mage"),D=A&&typeof v.magicSchool=="string"?(b=f.find(Q=>Q.id===v.magicSchool))==null?void 0:b.name:null;for(const Q in bb){const $=bb[Q];if(!P5.includes(Q)||A&&Q===D){const K=v.attributes[$]??10,O=O5(K);S[Q]=I.has(Q)?O*2:O}}const T=[...v.kinAbilityNames||[],...v.professionHeroicAbilityName?[v.professionHeroicAbilityName]:[]].filter(Boolean),H={user_id:e.id,name:(E=v.name)==null?void 0:E.trim(),kin:v.kin,profession:v.profession,magic_school:A?v.magicSchool:null,age:v.age,attributes:v.attributes,trained_skills:v.trainedSkills||[],skill_levels:S,equipment:v.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},appearance:(_=v.appearance)==null?void 0:_.trim(),conditions:{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},spells:v.spells||null,starting_equipment:v.startingEquipment||{items:[],money:{gold:0,silver:0,copper:0}},experience:{marked_skills:[]},max_hp:v.attributes.CON,current_hp:v.attributes.CON,max_wp:v.attributes.WIL,current_wp:v.attributes.WIL,heroic_ability:T,memento:((k=v.mementos)==null?void 0:k[0])||null,weak_spot:v.weak_spot||null},{data:L,error:G}=await ne.from("characters").insert(H).select().single();if(G)throw G;await d.invalidateQueries({queryKey:["characters",e.id]}),s(),c(`/characters/${L.id}`)}catch(S){const I=S instanceof Error?S.message:"Failed to save character";l(`Failed to save character: ${I}`)}finally{u(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-8 my-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Create New Character"}),a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Step ",t+1," of ",bo.length]})]}),a.jsx("div",{className:"flex space-x-1",children:bo.map((v,x)=>a.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden bg-gray-200",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${x<t?"bg-blue-500":x===t?"bg-blue-300":"bg-gray-200"}`,style:{width:x===t?"50%":"100%"}})},v.title))}),a.jsx("p",{className:"text-center text-lg font-semibold mt-3 text-gray-700",children:bo[t].title})]}),i&&a.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-red-50 border border-red-300 rounded-lg shadow-sm",children:[a.jsx(Ft,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Creation Error"}),a.jsx("p",{className:"text-sm text-red-700",children:i})]})]}),a.jsx("div",{className:"min-h-[400px] mb-8",children:a.jsx(h,{})}),a.jsxs("div",{className:"flex justify-between items-center mt-8 border-t pt-6",children:[a.jsx("button",{onClick:()=>r(t-1),disabled:t===0||o,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t===bo.length-1?a.jsxs("button",{onClick:y,disabled:!p()||o,className:`inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":p()?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"}`,children:[a.jsx(Gt,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Saving Character...":"Create Character"]}):a.jsx("button",{onClick:()=>r(t+1),disabled:!p()||o,className:`inline-flex items-center px-5 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ${!p()||o?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Next Step"})]})]})}function Hp({icon:e,title:t,description:r,action:n}){return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 mb-6",children:r}),n]})}const tN="*, magic_school:magic_schools!left(*)",Zl=e=>{const t={STR:10,AGL:10,INT:10,CON:10,WIL:10,CHA:10},r=e.attributes||{},n={STR:r.STR??t.STR,AGL:r.AGL??t.AGL,INT:r.INT??t.INT,CHA:r.CHA??t.CHA,CON:r.CON??t.CON,WIL:r.WIL??t.WIL},s=n.CON,i=n.WIL;let l={};if(typeof e.skill_levels=="string")try{l=JSON.parse(e.skill_levels)}catch{}else typeof e.skill_levels=="object"&&e.skill_levels!==null&&(l=e.skill_levels);const o=e.equipment||{};return{id:e.id,user_id:e.user_id,name:e.name||"Unnamed Character",kin:e.kin||"Unknown",profession:e.profession||"Unknown",age:e.age,appearance:e.appearance||"",background:e.background||"",notes:e.notes||"",portrait_url:e.portrait_url,magicSchool:e.magic_school||null,memento:e.memento||"",flaw:e.weak_spot||"",attributes:n,max_hp:s,current_hp:e.current_hp??s,max_wp:i,current_wp:e.current_wp??i,skill_levels:l,trainedSkills:e.trained_skills||[],spells:e.spells||{known:[]},heroic_abilities:e.heroic_ability||[],equipment:{inventory:o.inventory||[],equipped:o.equipped||{weapons:[]},money:o.money||{gold:0,silver:0,copper:0}},conditions:e.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},is_rallied:e.is_rallied??!1,death_rolls_passed:e.death_rolls_passed??0,death_rolls_failed:e.death_rolls_failed??0,experience:e.experience??0,teacher:e.teacher||null,reputation:e.reputation??0,corruption:e.corruption??0,created_at:e.created_at,updated_at:e.updated_at,party_id:e.party_id,party_info:e.party_info}};async function M5(e){if(!e)return[];const{data:t,error:r}=await ne.from("characters").select(tN).eq("user_id",e).order("created_at",{ascending:!1});if(r)throw new Error(r.message||"Failed to fetch characters");return(t||[]).map(Zl)}async function F5(e,t){if(!e||!t)return console.warn("fetchCharacterById requires both character ID and user ID."),null;try{const{data:r,error:n}=await ne.rpc("get_character_details_with_party",{p_character_id:e,p_user_id:t});return n?(console.error("Error fetching character via RPC:",n),null):r?Zl(r):null}catch(r){return console.error("Unexpected error in fetchCharacterById:",r),null}}async function B5(e,t){const r={...t};r.heroic_abilities&&(r.heroic_ability=r.heroic_abilities,delete r.heroic_abilities),r.trainedSkills&&(r.trained_skills=r.trainedSkills,delete r.trainedSkills),r.magicSchool&&(r.magic_school=r.magicSchool,delete r.magicSchool),r.updated_at=new Date().toISOString();const{data:n,error:s}=await ne.from("characters").update(r).eq("id",e).select(tN).single();if(s)throw new Error(s.message||"Failed to update character");return n?Zl(n):null}async function U5(e){if(e.length===0)return;const{error:t}=await ne.from("characters").delete().in("id",e);if(t)throw new Error(t.message||"Failed to delete characters")}const rN=Sn.forwardRef(({className:e,...t},r)=>a.jsx("input",{ref:r,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed ${e}`,...t}));rN.displayName="Input";function H5({isOpen:e,onClose:t,onJoin:r}){const[n,s]=w.useState(""),[i,l]=w.useState(""),[o,u]=w.useState(!1),c=async()=>{l("");const h=n.match(/party\/join\/([^/?]+)/);if(h&&h[1]){const f=h[1];u(!0);try{await r(f),d()}catch(g){console.error("Join operation failed:",g)}finally{u(!1)}}else l("Invalid party invite link. Please paste the full link.")},d=()=>{s(""),l(""),u(!1),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity","aria-labelledby":"join-party-title",role:"dialog","aria-modal":"true",onClick:d,children:a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md m-4 transform transition-all",onClick:h=>h.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{id:"join-party-title",className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(sc,{className:"w-6 h-6 text-blue-600"}),"Join an Adventure Party"]}),a.jsx("button",{onClick:d,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600","aria-label":"Close dialog",disabled:o,children:a.jsx(Pt,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Paste the invite link you received from your Dungeon Master to join their party."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party-link",className:"sr-only",children:"Party Invite Link"}),a.jsx(rN,{id:"party-link",type:"text",value:n,onChange:h=>s(h.target.value),placeholder:"https://.../party/join/...",className:"w-full","aria-describedby":"link-error",disabled:o}),i&&a.jsx("p",{id:"link-error",className:"text-red-500 text-sm mt-2",children:i})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(B,{variant:"secondary",onClick:d,disabled:o,children:"Cancel"}),a.jsx(B,{variant:"primary",onClick:c,disabled:!n||o,children:o?"Joining...":"Join Party"})]})]})}):null}function $p({isOpen:e,onClose:t,onConfirm:r,title:n,description:s,confirmText:i="Confirm",cancelText:l="Cancel",isLoading:o=!1,isDestructive:u=!1,icon:c}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[c&&a.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${u?"bg-red-100":"bg-blue-100"}`,children:c}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",id:"modal-title",children:n}),a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:s})})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3",children:[a.jsx(B,{variant:"secondary",onClick:t,disabled:o,className:"mt-3 sm:mt-0 w-full sm:w-auto",children:l}),a.jsx(B,{variant:u?"danger":"primary",onClick:r,loading:o,className:"w-full sm:w-auto",children:i})]})]})}):null}function $5(){const{user:e}=$t(),t=dn(),r=cn(),[n,s]=w.useState(!1),[i,l]=w.useState(!1),[o,u]=w.useState([]),[c,d]=w.useState(!1),{data:h=[],isLoading:f,error:g}=Lt({queryKey:["characters",e==null?void 0:e.id],queryFn:()=>M5(e==null?void 0:e.id),enabled:!!e}),p=Et({mutationFn:U5,onSuccess:()=>{r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]}),u([]),d(!1)},onError:v=>{console.error("Failed to delete characters:",v),d(!1)}}),y=(v,x)=>{if(v.shiftKey)v.preventDefault(),u(b=>b.includes(x)?b.filter(E=>E!==x):[...b,x]);else{if(o.length>0)return;t(`/character/${x}`)}};return f?a.jsx("div",{className:"p-8 flex justify-center items-center h-full",children:a.jsx(He,{size:"lg"})}):g?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:g.message||"Failed to load characters"})}):e?a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Characters"}),h.length>0&&!n&&a.jsxs("div",{className:"relative group flex items-center",children:[a.jsx(On,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 cursor-pointer transition-colors"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 z-10 mb-2 w-max max-w-xs -translate-x-1/2 transform rounded-lg bg-gray-900 px-3 py-2 text-center text-sm font-normal text-white opacity-0 transition-opacity duration-300 group-hover:opacity-100 pointer-events-none",children:["Hold ",a.jsx("kbd",{className:"px-2 py-1.5 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg",children:"Shift"})," and click cards to select multiple for deletion.",a.jsx("div",{className:"absolute left-1/2 top-full h-0 w-0 -translate-x-1/2 border-x-4 border-x-transparent border-t-4 border-t-gray-900"})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[o.length>0&&a.jsxs(B,{variant:"danger",icon:ur,onClick:()=>d(!0),loading:p.isPending,children:["Delete (",o.length,")"]}),a.jsx(B,{variant:"secondary",icon:sc,onClick:()=>l(!0),children:"Join Party"}),a.jsx(B,{variant:"primary",icon:Kt,onClick:()=>s(!0),children:"Create Character"})]})]}),n?a.jsx(D5,{onComplete:()=>{s(!1),r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]})}}):h.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(v=>a.jsxs("div",{className:"relative group cursor-pointer",onClick:x=>y(x,v.id),children:[a.jsx("div",{className:`absolute inset-0 rounded-lg border-2 transition-all duration-200 pointer-events-none ${o.includes(v.id)?"border-red-500 shadow-lg":"border-transparent group-hover:border-blue-500"}`}),a.jsx(n6,{character:v})]},v.id))}):a.jsx(Hp,{icon:Kt,title:"No Characters Yet",description:"Create your first character to begin your adventure.",action:a.jsx(B,{variant:"primary",icon:Kt,onClick:()=>s(!0),children:"Create Your First Character"})}),a.jsx(H5,{isOpen:i,onClose:()=>l(!1),onJoin:v=>{l(!1),t(`/party/join/${v}`)}}),a.jsx($p,{isOpen:c,onClose:()=>d(!1),onConfirm:()=>{o.length>0&&p.mutate(o)},title:`Delete ${o.length} ${o.length>1?"Characters":"Character"}?`,description:"Are you sure you want to permanently delete the selected character(s)? All of their data will be lost. This action cannot be undone.",confirmText:`Yes, Delete ${o.length}`,isLoading:p.isPending,isDestructive:!0,icon:a.jsx(ic,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})})]}):a.jsx("div",{className:"p-8",children:a.jsx(Hp,{icon:Ft,title:"Authentication Required",description:"Please sign in to view your characters."})})}async function z5(e){const{data:t,error:r}=await ne.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async function q5(e){const{data:t,error:r}=await ne.from("encounters").select("*").eq("id",e).single();if(r)throw r;return t}async function nN(e){const{data:t,error:r}=await ne.from("encounter_combatants").select("*").eq("encounter_id",e).order("initiative_roll",{ascending:!1,nullsLast:!0}).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching encounter combatants:",r),r;return t||[]}async function V5(e){const{data:t,error:r}=await ne.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1}).limit(1).single();if(r&&r.code!=="PGRST116")throw r;return t}async function W5(e,t,r){const{data:n,error:s}=await ne.from("encounters").insert({party_id:e,name:t,description:r,status:"planning",log:[]}).select().single();if(s)throw s;return n}async function G5(e,t){const{data:r,error:n}=await ne.rpc("duplicate_encounter_with_combatants",{p_encounter_id:e,p_new_name:t});if(n)throw n;return r}async function Y5(e){const{data:t,error:r}=await ne.rpc("add_character_to_encounter",{p_encounter_id:e.encounterId,p_character_id:e.characterId,p_initiative_roll:e.initiativeRoll});if(r)throw r;return t}async function Q5(e){const{data:t,error:r}=await ne.rpc("add_monster_to_encounter",{p_encounter_id:e.encounterId,p_monster_id:e.monsterId,p_custom_name:e.customName,p_initiative_roll:e.initiativeRoll});if(r)throw r;return t}async function Sg(e,t){const{data:r,error:n}=await ne.from("encounters").update(t).eq("id",e).select().single();if(n)throw n;return r}async function sN(e,t){const{data:r,error:n}=await ne.from("encounter_combatants").update(t).eq("id",e).select().single();if(n)throw n;return r}async function K5(e,t){const{error:r}=await ne.rpc("append_to_log",{p_encounter_id:e,p_log_entry:t});if(r)throw r}const Z5=e=>Sg(e,{status:"active",current_round:1}),X5=e=>Sg(e,{status:"completed"});async function J5(e){const{error:t}=await ne.from("encounters").delete().eq("id",e);if(t)throw t}async function eI(e){const{error:t}=await ne.from("encounter_combatants").delete().eq("id",e);if(t)throw t}async function tI(e,t){const{data:r,error:n}=await ne.rpc("roll_initiative_for_combatants",{p_encounter_id:e,p_combatant_ids:t});if(n)throw n;return r}async function rI(e,t){const{data:r,error:n}=await ne.rpc("swap_combatant_initiative",{p_combatant_id_1:e,p_combatant_id_2:t});if(n)throw n;return r}const tr=WE((e,t)=>({character:null,isLoading:!0,isSaving:!1,error:null,saveError:null,markedSkillsThisSession:new Set,allGameItems:[],isLoadingGameItems:!1,allHeroicAbilities:[],isLoadingAbilities:!1,activeStatusMessage:null,statusMessageTimeoutId:null,activeEncounter:null,currentCombatant:null,encounterCombatants:[],isLoadingEncounter:!1,encounterError:null,fetchCharacter:async(r,n)=>{e({isLoading:!0,error:null});try{await Promise.all([t()._loadGameItems(),t()._loadAllHeroicAbilities()]);const s=await F5(r,n);if(!s)throw new Error(`Character with ID ${r} not found.`);e({character:s,isLoading:!1}),s!=null&&s.party_id?(console.log(`%c[Store] Character loaded. Triggering encounter check for party: ${s.party_id}`,"color: cyan;"),t().fetchActiveEncounter(s.party_id,s.id)):(console.log("%c[Store] Character loaded, but they have no party_id. Clearing encounter.","color: orange;"),t().clearActiveEncounter())}catch(s){const i=s instanceof Error?s.message:"Failed to fetch character";e({error:i,isLoading:!1})}},fetchActiveEncounter:async(r,n)=>{e({isLoadingEncounter:!0});try{const s=await V5(r);if(console.log("%c[Store] fetchLatestEncounterForParty returned:","color: magenta;",s),s&&s.status==="active"){console.log("%c[Store] SUCCESS: Encounter is active. Fetching combatants.","color: lightgreen;");const i=await nN(s.id),l=i.find(u=>u.character_id===n),o=i.sort((u,c)=>(u.initiative_roll??100)-(c.initiative_roll??100));e({activeEncounter:s,currentCombatant:l??null,encounterCombatants:o})}else console.log("%c[Store] FAILURE: No active encounter found. Clearing state.","color: red;"),t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch encounter";e({encounterError:i})}finally{e({isLoadingEncounter:!1})}},setCharacter:r=>{e({character:r}),!r||!r.party_id?t().clearActiveEncounter():t().fetchActiveEncounter(r.party_id,r.id)},_saveCharacter:async r=>{const n=t().character;if(!(n!=null&&n.id)){const s="Cannot save: Character ID is missing.";throw e({saveError:s}),new Error(s)}e({isSaving:!0,saveError:null});try{await B5(n.id,r);const s={...n,...r,updated_at:new Date().toISOString()};e({character:s,isSaving:!1})}catch(s){const i=s instanceof Error?s.message:"Failed to save character";throw e({saveError:i,isSaving:!1}),s}},_loadGameItems:async()=>{if(!(t().isLoadingGameItems||t().allGameItems.length>0)){e({isLoadingGameItems:!0});try{const r=await lc();e({allGameItems:r,isLoadingGameItems:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load game items";e({isLoadingGameItems:!1,error:n})}}},_loadAllHeroicAbilities:async()=>{if(!(t().isLoadingAbilities||t().allHeroicAbilities.length>0)){e({isLoadingAbilities:!0});try{const{data:r,error:n}=await ne.from("heroic_abilities").select("*").order("name");if(n)throw n;e({allHeroicAbilities:r||[],isLoadingAbilities:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load heroic abilities";e({isLoadingAbilities:!1,error:n})}}},updateCharacterData:async r=>t()._saveCharacter(r),adjustStat:async(r,n)=>{const s=t().character;if(s){if(r==="current_hp"){const i=s.current_hp??0,l=s.max_hp??0,o=Math.max(0,Math.min(l,i+n));if(o!==i){const u={current_hp:o};i<=0&&o>0&&(u.death_rolls_passed=0,u.death_rolls_failed=0,u.is_rallied=!1),await t()._saveCharacter(u)}}else if(r==="current_wp"){const i=s.current_wp??0,l=s.max_wp??0,o=Math.max(0,Math.min(l,i+n));o!==i&&await t()._saveCharacter({current_wp:o})}}},toggleCondition:async r=>{const n=t().character;if(!n)return;const s=n.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i={...s,[r]:!s[r]};await t()._saveCharacter({conditions:i})},performRest:async(r,n)=>{const s=t().character;if(!s)return;const i={},l=s.current_hp??0,o=s.max_hp??0,u=s.current_wp??0,c=s.max_wp??0,d=()=>Math.floor(Math.random()*6)+1;if(r==="round")i.current_wp=Math.min(c,u+d());else if(r==="stretch"){if(l<=0){t().setActiveStatusMessage("Cannot take Stretch Rest while dying.",3e3);return}const h=n?d()+d():d();i.current_hp=Math.min(o,l+h),i.current_wp=Math.min(c,u+d());const g={...s.conditions??{}};for(const p of Object.keys(g))if(g[p]===!0){g[p]=!1,i.conditions=g;break}}else r==="shift"&&(i.current_hp=o,i.current_wp=c,i.conditions={exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i.death_rolls_failed=0,i.death_rolls_passed=0,i.is_rallied=!1);Object.keys(i).length>0&&await t()._saveCharacter(i)},setDeathRollState:async(r,n,s)=>{const i={death_rolls_passed:r,death_rolls_failed:n};s!==void 0&&(i.is_rallied=s),await t()._saveCharacter(i)},updateAttribute:async(r,n)=>{const s=t().character;if(!s)return;const l={attributes:{...s.attributes||{},[r]:n}};r==="CON"&&(l.max_hp=n,l.current_hp=Math.min(s.current_hp??0,n)),r==="WIL"&&(l.max_wp=n,l.current_wp=Math.min(s.current_wp??0,n)),await t()._saveCharacter(l)},updateCurrentHP:async r=>t()._saveCharacter({current_hp:r}),updateWillpowerPoints:async r=>t()._saveCharacter({current_wp:r}),updateConditions:async r=>t()._saveCharacter({conditions:r}),updateInventory:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,inventory:r}})},updateEquipped:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,equipped:r}})},updateMoney:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,money:r}})},updateNotes:async r=>t()._saveCharacter({notes:r}),updateExperience:async r=>t()._saveCharacter({experience:r}),updateReputation:async r=>t()._saveCharacter({reputation:r}),updateCorruption:async r=>t()._saveCharacter({corruption:r}),updateAppearance:async r=>t()._saveCharacter({appearance:r}),updateDeathRolls:async(r,n)=>{const s=t().character;s&&(r==="failed"?await t().setDeathRollState(s.death_rolls_passed??0,n,s.is_rallied):await t().setDeathRollState(n,s.death_rolls_failed??0,s.is_rallied))},updateSkillLevel:async(r,n)=>{const s=t().character;if(!s)return;const l={...s.skill_levels||{},[r]:n};await t()._saveCharacter({skill_levels:l})},increaseSkillLevel:async r=>{var u;const n=t().character;if(!n)return;const s=n.skill_levels||{},i=s[r]??0;if(i>=18)return;const l=Math.min(i+1,18),o={skill_levels:{...s,[r]:l}};((u=n.teacher)==null?void 0:u.skillUnderStudy)===r&&(o.teacher=null),await t()._saveCharacter(o)},addHeroicAbility:async r=>{const n=t().character;if(!n)return;const s=n.heroic_abilities||[];s.includes(r)||await t()._saveCharacter({heroic_abilities:[...s,r]})},learnSpell:async r=>{const n=t().character;if(!n)return;const s=n.spells??{school:{name:null,spells:[]},general:[]};if(!s.school){const{data:l}=await ne.from("magic_schools").select("name").eq("id",n.magic_school).single();s.school={name:(l==null?void 0:l.name)??null,spells:[]}}let i;if(r.school_id){const l=s.school.spells||[];l.includes(r.name)||(i={...s,school:{...s.school,spells:[...l,r.name]}})}else{const l=s.general||[];l.includes(r.name)||(i={...s,general:[...l,r.name]})}i&&await t()._saveCharacter({spells:i})},addMagicSchool:async(r,n)=>{const s=t().character;if(!s)return;const l={skill_levels:{...s.skill_levels,[r.name]:n}};s.magic_school||(l.magic_school=r.id),await t()._saveCharacter(l)},setSkillUnderStudy:async r=>{await t()._saveCharacter({teacher:r?{skillUnderStudy:r}:null})},markSkillThisSession:r=>{e(n=>({markedSkillsThisSession:new Set(n.markedSkillsThisSession).add(r)}))},clearMarkedSkillsThisSession:()=>e({markedSkillsThisSession:new Set}),setActiveStatusMessage:(r,n=3e4)=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:r});const s=setTimeout(()=>{e({activeStatusMessage:null,statusMessageTimeoutId:null})},n);e({statusMessageTimeoutId:s})},clearActiveStatusMessage:()=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:null,statusMessageTimeoutId:null})},drawInitiative:async()=>{const{currentCombatant:r}=t();if(r){const n=Math.floor(Math.random()*10)+1;await t().setInitiativeForCombatant(r.id,n)}},setInitiativeForCombatant:async(r,n)=>{e({isSaving:!0,saveError:null});try{await sN(r,{initiative_roll:n}),t().setActiveStatusMessage(`Initiative set to ${n}`,4e3)}catch(s){const i=s instanceof Error?s.message:"Failed to set initiative";e({saveError:i})}finally{e({isSaving:!1})}},clearActiveEncounter:()=>{e({activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null,encounterCombatants:[]})}})),nI=[{kin:"Human",movement:10},{kin:"Halfling",movement:8},{kin:"Dwarf",movement:8},{kin:"Elf",movement:10},{kin:"Mallard",movement:8},{kin:"Wolfkin",movement:12}];function sI(e,t){var s;const r=((s=nI.find(i=>i.kin===e))==null?void 0:s.movement)||10;let n=0;return t<=6?n=-4:t<=9?n=-2:t<=12?n=0:t<=15?n=2:n=4,r+n}const Gf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},aI=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming"],iI=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],lI=["Mentalism","Animism","Elementalism"],oI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,uI=(e,t,r)=>{var l,o;console.warn(`[SkillsModal] Calculating fallback level for ${t}.`);const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=oI(s);return n?i*2:i};function cI({onClose:e}){const{toggleDiceRoller:t}=Dn(),{character:r}=tr(),n=!!(r!=null&&r.magicSchool&&typeof r.magicSchool=="object"),s=n?r.magicSchool.name:null;if(!r)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6",children:a.jsx(He,{})})});const i=w.useMemo(()=>s?lI.filter(h=>h===s).map(h=>({name:h,attr:Gf[h]})):[],[s]),l=h=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[h],o=(h,f,g)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:f,description:`${h} Check`,requiresBane:g,skillName:h}),e()},u=aI.map(h=>({name:h,attr:Gf[h]})).sort((h,f)=>h.name.localeCompare(f.name)),c=iI.map(h=>({name:h,attr:Gf[h]})).sort((h,f)=>h.name.localeCompare(f.name)),d=h=>{var v,x,b;const f=((v=r.trainedSkills)==null?void 0:v.includes(h.name))??!1,g=((x=r.skill_levels)==null?void 0:x[h.name])??uI(r,h.name,h.attr),p=l(h.attr),y=((b=r.conditions)==null?void 0:b[p])??!1;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${y?"bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"hover:bg-gray-100"}`,onClick:()=>o(h.name,g,y),title:`Click to roll ${h.name} (Target  ${g}${y?", Bane":""})`,children:[a.jsxs("div",{children:[a.jsx("span",{className:`${f?"font-bold":""} ${y?"text-red-700":"text-gray-800"}`,children:h.name}),a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",h.attr,")"]}),y&&a.jsx("span",{className:"text-xs text-red-600 font-semibold ml-2",children:"(Bane)"})]}),a.jsxs("span",{className:`font-medium text-sm ${y?"text-red-700":"text-gray-600"}`,children:["Target: ",g]})]},h.name)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Skills (d20 Check)"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click a skill to roll a d20 check. Roll  Skill Level for success. 1 is Dragon (Crit Success), 20 is Demon (Crit Fail). Conditions apply Bane (roll 2d20, take highest/worst). Trained skills are bolded."})]}),a.jsxs("div",{className:`grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-6 p-6 overflow-y-auto flex-grow`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"General Skills"}),a.jsx("div",{className:"space-y-1",children:u.map(d)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Weapon Skills"}),a.jsx("div",{className:"space-y-1",children:c.map(d)})]}),n&&s&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold mb-4 text-gray-700",children:["Magic Skill (",s,")"]}),a.jsx("div",{className:"space-y-1",children:i.length>0?i.map(d):a.jsxs("p",{className:"text-sm text-gray-500 italic px-2 py-1",children:['No matching magic skill found for "',s,'".']})})]})]}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(B,{variant:"outline",onClick:e,children:"Close"})})]})})}function dI(e){var h,f;const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),o=tr(g=>g.character),u=w.useMemo(()=>{if(!(o!=null&&o.spells))return[];let g=[];if(o.spells.general&&(Array.isArray(o.spells.general)?g=g.concat(o.spells.general):console.warn("[useSpells] character.spells.general is not an array:",o.spells.general)),o.spells.school&&o.spells.school.spells){const p=o.spells.school.spells;Array.isArray(p)?g=g.concat(p):console.warn("[useSpells] character.spells.school.spells is not an array:",p)}return Array.from(new Set(g))},[o==null?void 0:o.spells]);w.useEffect(()=>{if(!e||u.length===0){s(!1),r([]);return}async function g(){s(!0),l(null);try{const{data:p,error:y}=await ne.from("game_spells").select(`
            *,
            power_level,
            magic_schools ( name )
          `).in("name",u).order("rank",{ascending:!0}).order("name",{ascending:!0});if(y)throw y;r(p||[])}catch(p){console.error("Error loading learned spell details:",p),l(p instanceof Error?p.message:"Failed to load spell details"),r([])}finally{s(!1)}}g()},[e,u]);const c=w.useMemo(()=>t.map(g=>({id:g.id,name:g.name,schoolId:g.school_id,rank:g.rank,requirement:g.requirement,castingTime:g.casting_time,range:g.range,duration:g.duration,description:g.description,willpowerCost:g.willpower_cost,createdAt:g.created_at,powerLevel:g.power_level})),[t]),d=w.useMemo(()=>{var g,p;return((p=(g=o==null?void 0:o.spells)==null?void 0:g.school)==null?void 0:p.name)??null},[(f=(h=o==null?void 0:o.spells)==null?void 0:h.school)==null?void 0:f.name]);return{learnedSpells:c,characterSchoolName:d,loading:n,error:i}}const aN=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,hI=(e,t)=>{var l,o;const r="WIL",n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=aN(s);return n?i*2:i};function fI({onClose:e}){var me;const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState("prepared"),[c,d]=w.useState({}),[h,f]=w.useState("all"),{toggleDiceRoller:g}=Dn(),{character:p,updateCharacterData:y,isSaving:v,setActiveStatusMessage:x}=tr(),{learnedSpells:b,characterSchoolName:E,loading:_,error:k}=dI(p==null?void 0:p.id),S=((me=p==null?void 0:p.attributes)==null?void 0:me.INT)??10,I=aN(S),A=w.useMemo(()=>new Set((p==null?void 0:p.prepared_spells)??[]),[p==null?void 0:p.prepared_spells]),D=w.useMemo(()=>b.filter(X=>X.rank>0&&A.has(X.id)).length,[b,A]),T=D<I,H=async(X,W)=>{const q=b.find(Ae=>Ae.id===X),J=W?"Unprepare":"Prepare";if(console.log(`[SpellcastingView - Prepare] START: Initiating toggle for spell "${(q==null?void 0:q.name)||"Unknown"}". Action: ${J}`),s(null),!p){console.error("[SpellcastingView - Prepare] FAILED: Character object is not available.");return}const te=p.prepared_spells??[];let de;if(W)de=te.filter(Ae=>Ae!==X);else{if(!T){const Ae=`Preparation limit reached (${I} based on INT ${S}).`;console.warn(`[SpellcastingView - Prepare] FAILED (UI Rule): ${Ae}`),s(Ae);return}de=[...te,X]}const ve={prepared_spells:de};console.log("[SpellcastingView - Prepare] BEFORE_SAVE: Calling updateCharacterData with payload:",ve);try{await y(ve),console.log(`[SpellcastingView - Prepare] SUCCESS: updateCharacterData promise resolved for spell "${(q==null?void 0:q.name)||"Unknown"}".`)}catch(Ae){console.error(`[SpellcastingView - Prepare] FAILED (catch block): Caught an error during update for spell "${(q==null?void 0:q.name)||"Unknown"}".`,{wasTryingTo:J.toLowerCase(),intendedUpdatePayload:ve,originalError:Ae}),s(Ae instanceof Error?Ae.message:"Failed to update preparation")}finally{console.log(`[SpellcastingView - Prepare] END: Finished toggle attempt for spell "${(q==null?void 0:q.name)||"Unknown"}".`)}},{preparedSpellsList:L,grimoireSpellsList:G}=w.useMemo(()=>{const X=b.filter(te=>te.rank===0),W=b.filter(te=>te.rank>0&&A.has(te.id)),q=[...X,...W].sort((te,de)=>te.rank-de.rank||te.name.localeCompare(de.name)),J=[...b].sort((te,de)=>te.rank-de.rank||te.name.localeCompare(de.name));return{preparedSpellsList:q,grimoireSpellsList:J}},[b,A]),Q=w.useMemo(()=>{const X=new Set(b.map(W=>W.rank));return Array.from(X).sort((W,q)=>W-q)},[b]),$=w.useMemo(()=>{const X=[{label:"All",value:"all"}];return Q.forEach(W=>{W===0?X.push({label:"Trick",value:0}):W>=1&&W<=9&&X.push({label:`Rank ${W}`,value:W})}),X},[Q]),V=w.useMemo(()=>{const X=o==="prepared"?L:G;return h==="all"?X:X.filter(W=>W.rank===h)},[o,L,G,h]),{actualMagicSkillName:K,magicSkillValue:O,isMagicSkillAffected:Z}=w.useMemo(()=>{var te;if(!p||!E)return{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1};const X=["Animism","Elementalism","Mentalism","Symbolism","General Magic"],W=p.skill_levels||{},q=new Set([...p.trainedSkills||[],...Object.keys(W)]);let J=null;if(E==="Animism"&&q.has("Animism")?J="Animism":E==="Elementalism"&&q.has("Elementalism")?J="Elementalism":E==="Mentalism"&&q.has("Mentalism")?J="Mentalism":(J=X.find(de=>q.has(de))??null,!J&&q.has(E)&&(J=E)),J){const de=W[J],ve=de!==void 0?de:hI(p,J),Ae=((te=p.conditions)==null?void 0:te.scared)??!1;return{actualMagicSkillName:J,magicSkillValue:ve,isMagicSkillAffected:Ae}}return console.warn(`[SpellcastingView] Could not determine actual magic skill for school '${E}'.`),{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1}},[p,E]);if(w.useEffect(()=>{const X={};b.forEach(W=>{W.powerLevel==="yes"&&(X[W.id]=c[W.id]||1)}),d(X)},[b]),!p)return null;const N=async X=>{l(X.id),r(null);try{const W=p.current_wp??p.attributes.WIL,q=Number(X.willpowerCost??0),J=c[X.id]||1,te=X.powerLevel==="yes",de=te?q+(J-1)*2:q;if(W<de)throw new Error(`Insufficient Willpower Points (Need ${de}, Have ${W})`);const ve=W-de;await y({current_wp:ve}),x(`Casted ${X.name}${te?` (Lvl ${J})`:""} for ${de} WP.`)}catch(W){console.error("Error casting spell:",W),r(W instanceof Error?W.message:"Failed to cast spell")}finally{l(null)}},z=(X,W)=>{d(q=>{const J=q[X]||1,te=Math.max(1,Math.min(3,J+W));return{...q,[X]:te}})},U=()=>{!K||O===null||g({initialDice:["d20"],rollMode:"skillCheck",targetValue:O,description:`${K} Check`,requiresBane:Z,skillName:K})},j=({spell:X,isPreparedView:W})=>{const q=A.has(X.id),J=X.rank===0,te=!J&&(q||T),de=X.powerLevel==="yes",ve=c[X.id]||1,Ae=Number(X.willpowerCost??0),we=de?Ae+(ve-1)*2:Ae,Ze=(p.current_wp??p.attributes.WIL)<we;let tt=`Rank ${X.rank}`,ct="bg-amber-100",rt="text-amber-800",Zt="border-amber-200";return X.rank===0?(tt="Trick",ct="bg-gray-100",rt="text-gray-800",Zt="border-gray-300"):X.rank<=1?(ct="bg-blue-100",rt="text-blue-800",Zt="border-blue-200"):X.rank<=3&&(ct="bg-purple-100",rt="text-purple-800",Zt="border-purple-200"),a.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm flex flex-col justify-between ${!W&&!J?"opacity-70":""}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-base text-gray-900",children:X.name}),!W&&a.jsx("div",{className:"ml-2 flex-shrink-0",children:J?a.jsx(Fp,{className:"w-5 h-5 text-green-500",title:"Tricks are always prepared"}):a.jsx("button",{onClick:()=>H(X.id,q),disabled:!te||v,className:"disabled:opacity-50 disabled:cursor-not-allowed",title:q?"Unprepare":T?"Prepare":`Limit reached (${I})`,children:q?a.jsx(Fp,{className:"w-5 h-5 text-blue-600 hover:text-blue-800"}):a.jsx(LE,{className:`w-5 h-5 ${T?"text-gray-400 hover:text-gray-600":"text-gray-300"}`})})})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${ct} ${rt} border ${Zt}`,children:tt}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(An,{size:14,className:"text-gray-400"}),a.jsxs("span",{children:[we," WP",de&&ve>1&&a.jsxs("span",{className:"text-xs text-blue-600",children:[" (Lvl ",ve,")"]})]})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-2 mb-4",children:[X.requirement&&a.jsxs("p",{className:"text-amber-700 bg-amber-50 px-2 py-1 rounded border border-amber-200",children:[a.jsx("span",{className:"font-medium",children:"Requirement:"})," ",X.requirement]}),a.jsxs("p",{className:"whitespace-normal break-words",children:[a.jsx("span",{className:"font-medium",children:"Description:"})," ",X.description||"No description."]}),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1 text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Dh,{size:12})," ",X.castingTime]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(F4,{size:12})," ",X.range]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(xg,{size:12})," ",X.duration]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(An,{size:12})," ",Ae," WP ",de?"(Base)":""]})]})]})]}),W&&a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center justify-center gap-1",children:de?a.jsxs(a.Fragment,{children:[a.jsx(B,{variant:"primary",size:"sm",onClick:()=>z(X.id,-1),disabled:ve<=1||!!i||v,className:"px-2",title:"Decrease level",children:a.jsx(TE,{size:14})}),a.jsx(B,{variant:"primary",size:"sm",onClick:()=>N(X),loading:i===X.id||v,disabled:!!i||v||Ze,className:"flex-grow min-w-[80px]",title:Ze?`Need ${we} WP`:`Cast Lvl ${ve}`,children:i===X.id?"":`Cast Lvl ${ve}`}),a.jsx(B,{variant:"primary",size:"sm",onClick:()=>z(X.id,1),disabled:ve>=3||!!i||v,className:"px-2",title:"Increase level",children:a.jsx(Kt,{size:14})})]}):a.jsx(B,{variant:"primary",size:"sm",onClick:()=>N(X),loading:i===X.id||v,disabled:!!i||v||Ze,className:"w-full",title:Ze?`Need ${we} WP`:`Cast ${X.name}`,children:i===X.id?"":"Cast"})})}),!W&&!J&&a.jsx("div",{className:"mt-auto pt-3 text-center text-xs text-gray-400 italic",children:q?"Prepared":"Prepare in Grimoire"})]})};return _?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:[a.jsx(He,{}),a.jsx("p",{className:"text-center mt-2 text-gray-600",children:"Loading spells..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-7xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 text-gray-800 mb-1",children:[a.jsx(ol,{className:"w-6 h-6 text-purple-600"}),"Spellcasting"]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Current WP: ",a.jsx("strong",{className:"font-semibold",children:p.current_wp??p.attributes.WIL})," / ",p.attributes.WIL]}),K&&O!==null&&a.jsxs("div",{className:`flex items-center gap-1 cursor-pointer px-2 py-0.5 rounded transition-colors ${Z?"text-red-700 bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 ring-1 ring-indigo-200"}`,onClick:U,title:`Click to roll ${K} (Target  ${O}${Z?", Bane":""})`,children:[a.jsx(or,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"font-medium",children:[K,":"]}),a.jsx("span",{children:O}),Z&&a.jsx("span",{className:"text-xs font-semibold",children:"(Bane)"})]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none focus:outline-none mt-[-4px]",children:""})]}),t&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Casting Error"}),a.jsx("p",{className:"text-xs text-red-700",children:t})]}),n&&a.jsxs("div",{className:"mb-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Preparation Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:n})]}),k&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Spell Data Error"}),a.jsx("p",{className:"text-xs text-red-700",children:k})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-6",children:[a.jsxs("button",{onClick:()=>{u("prepared"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="prepared"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Yd,{size:16})," Prepared (",L.length,")"]}),a.jsxs("button",{onClick:()=>{u("grimoire"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="grimoire"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Qo,{size:16})," Grimoire (",b.length,")"]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"py-3 px-1 text-sm text-gray-500",children:["Preparation Slots: ",a.jsxs("span",{className:"font-medium",children:[D," / ",I]})," (INT ",S,")"]})]})}),b.length>0&&$.length>1&&a.jsxs("div",{className:"pt-4 flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-600 flex items-center gap-1 mr-1 shrink-0",children:[a.jsx(Ia,{size:14})," Filter:"]}),$.map(X=>a.jsx(B,{variant:h===X.value?"primary":"outline",size:"xs",onClick:()=>f(X.value),className:`px-2.5 py-1 ${h===X.value?"":"text-gray-600 bg-white hover:bg-gray-50"}`,children:X.label},X.value))]})]}),a.jsx("div",{className:"overflow-y-auto flex-grow p-6 bg-gray-50",children:V.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:V.map(X=>a.jsx(j,{spell:X,isPreparedView:o==="prepared"},X.id))}):a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[_&&a.jsx("p",{children:"Loading spells..."}),!_&&k&&a.jsx("p",{children:"Could not load spell details."}),!_&&!k&&a.jsxs(a.Fragment,{children:[o==="prepared"&&L.length===0&&a.jsx("p",{children:"No spells prepared. Go to the Grimoire tab. Tricks are always prepared."}),o==="grimoire"&&G.length===0&&a.jsx("p",{children:"Character has not learned any spells."}),V.length===0&&a.jsx("p",{children:"No spells match the selected rank filter."})]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(B,{variant:"outline",onClick:e,disabled:!!i||v,children:"Close"})})]})})}const vo=(e,t)=>{const r=/(?:(\d+)\s*x\s+)|(?:x\s*(\d+))|(?:[(\[]x?(\d+)[)\]])|^(\d+)\s+/,n=e.match(r);let s=1,i=e.trim();if(n){const o=n[1]||n[2]||n[3]||n[4];o&&(s=parseInt(o,10)),i=e.replace(n[0],"").trim()}const l=t.find(o=>o.name.toLowerCase()===i.toLowerCase());return{id:`item-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:i,quantity:s,originalName:e,...l}},vb=e=>{let t=e.name;return e.quantity>1&&(t+=` (x${e.quantity})`),e.unit&&(t+=` (${e.unit})`),t},wo=(e,t)=>{const r=e.findIndex(s=>s.name===t.name&&!s.unit&&!t.unit),n=[...e];return r>-1?n[r].quantity+=t.quantity:n.push(t),n},mI=["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS","CLOTHES","MUSICAL INSTRUMENTS","TRADE GOODS","STUDIES & MAGIC","LIGHT SOURCES","TOOLS","CONTAINERS","MEDICINE","SERVICES","HUNTING & FISHING","MEANS OF TRAVEL","ANIMALS"],pI=[{name:"Armor & Weapons",categories:["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS"],Icon:ks},{name:"Clothing & Accessories",categories:["CLOTHES"],Icon:Tu},{name:"Musical & Trade Goods",categories:["MUSICAL INSTRUMENTS","TRADE GOODS"],Icon:Qy},{name:"Magic & Studies",categories:["STUDIES & MAGIC"],Icon:I4},{name:"Light & Tools",categories:["LIGHT SOURCES","TOOLS"],Icon:$4},{name:"Containers & Medicine",categories:["CONTAINERS","MEDICINE"],Icon:Tu},{name:"Services",categories:["SERVICES"],Icon:Qy},{name:"Hunting & Travel",categories:["HUNTING & FISHING","MEANS OF TRAVEL"],Icon:xE},{name:"Animals",categories:["ANIMALS"],Icon:ac}];function gI({onClose:e}){var K,O,Z,N,z,U,j,me,X;const{isAdmin:t,isDM:r}=$t(),[n,s]=w.useState(null),[i,l]=w.useState("inventory"),[o,u]=w.useState({search:"",category:"all"}),[c,d]=w.useState({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""}),[h,f]=w.useState(!1),[g,p]=w.useState(null),{character:y,updateCharacterData:v,updateInventory:x,isSaving:b,saveError:E}=tr(),{data:_=[],isLoading:k}=Lt({queryKey:["gameItems"],queryFn:lc,staleTime:1/0});if(w.useEffect(()=>{var W;if(y&&_.length>0){const q=(W=y.equipment)==null?void 0:W.inventory;if(q&&q.length>0&&typeof q[0]=="string"){let J=[];for(const te of q)J=wo(J,vo(te,_));x(J)}}},[y,_,x]),!y)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 text-center",children:a.jsx(He,{})})});const S=W=>_.find(q=>{var J;return((J=q.name)==null?void 0:J.toLowerCase())===W.toLowerCase()}),I=(W,q)=>{var de;const J=((de=y.equipment)==null?void 0:de.money)||{gold:0,silver:0,copper:0},te=Math.max(0,(J[W]||0)+q);v({equipment:{...y.equipment,money:_g({...J,[W]:te})}})},A=()=>{var q,J;if(!c.name||!c.cost){s("Name and cost are required");return}const W={id:`custom-${Date.now()}`,name:c.name.trim(),quantity:c.quantity,unit:((q=c.unit)==null?void 0:q.trim())||void 0,originalName:vb(c),...c};x(wo(((J=y.equipment)==null?void 0:J.inventory)||[],W)),f(!1),d({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""})},D=W=>{var te;const q=[...((te=y.equipment)==null?void 0:te.inventory)||[]],J={...q[W]};J.quantity>1?(J.quantity-=1,q[W]=J):q.splice(W,1),x(q)},T=(W,q)=>{var ct,rt;const J=S(W.name);if(!J){s(`Details not found for: ${W.name}`);return}const te=structuredClone(y.equipment),de=te.inventory[q];de.quantity>1?de.quantity-=1:te.inventory.splice(q,1);const ve=((ct=J.category)==null?void 0:ct.toUpperCase())||"",Ae=ve.includes("WEAPON")||J.name.toLowerCase().includes("shield"),we=ve==="ARMOR & HELMETS"&&!Ae&&!J.name.toLowerCase().includes("helmet"),Ze=ve==="ARMOR & HELMETS"&&!Ae&&!we;let tt=null;if(Ae){if((((rt=te.equipped.weapons)==null?void 0:rt.length)||0)>=3){s("Max 3 weapons/shields at hand.");return}const Zt={name:W.name,grip:J.grip||"1H",range:J.range,damage:J.damage,durability:J.durability,features:J.features||[]};te.equipped.weapons||(te.equipped.weapons=[]),te.equipped.weapons.push(Zt)}else we?(te.equipped.armor&&(tt=vo(te.equipped.armor,_)),te.equipped.armor=W.name):Ze&&(te.equipped.helmet&&(tt=vo(te.equipped.helmet,_)),te.equipped.helmet=W.name);tt&&(te.inventory=wo(te.inventory,tt)),v({equipment:te})},H=(W,q)=>{var de,ve,Ae;const J=structuredClone(y.equipment);let te=null;W==="armor"?(te=J.equipped.armor||null,J.equipped.armor=void 0):W==="helmet"?(te=J.equipped.helmet||null,J.equipped.helmet=void 0):W==="weapon"&&typeof q=="number"&&(te=((ve=(de=J.equipped.weapons)==null?void 0:de[q])==null?void 0:ve.name)||null,(Ae=J.equipped.weapons)==null||Ae.splice(q,1)),te&&(J.inventory=wo(J.inventory,vo(te,_)),v({equipment:J}))},L=W=>{const q=S5(W.cost);if(!q){s("Invalid item cost.");return}const{success:J,newMoney:te}=C5(y.equipment.money,q);if(!J){s("Not enough money.");return}const de=wo(y.equipment.inventory,vo(W.name,_));v({equipment:{...y.equipment,inventory:de,money:te}})},G=W=>{const q=[...y.equipment.inventory||[]];q.splice(W,1),x(q)},Q=(((K=y.equipment)==null?void 0:K.inventory)||[]).filter(W=>{var q;return typeof W=="object"&&((q=W.name)==null?void 0:q.toLowerCase().includes(o.search.toLowerCase()))}),$=_.filter(W=>{if(!g)return!1;const q=g.categories.includes(W.category||"");return W.name.toLowerCase().includes(o.search.toLowerCase())&&q}),V=()=>{var q,J;const W=(q=y.equipment)==null?void 0:q.equipped;return!W||!W.armor&&!W.helmet&&(!W.weapons||W.weapons.length===0)?null:a.jsxs("div",{className:"mt-6 pt-4 border-t",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-600 mb-3",children:"Equipped Items"}),a.jsxs("div",{className:"space-y-2",children:[W.armor&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[W.armor," (Armor)"]}),a.jsx(B,{variant:"secondary",size:"xs",icon:Uf,onClick:()=>H("armor",W.armor),disabled:b,children:"Unequip"})]}),W.helmet&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[W.helmet," (Helmet)"]}),a.jsx(B,{variant:"secondary",size:"xs",icon:Uf,onClick:()=>H("helmet",W.helmet),disabled:b,children:"Unequip"})]}),(J=W.weapons)==null?void 0:J.map((te,de)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[te.name," (",te.grip==="Shield"?"Shield":`${te.grip} Weapon`,")"]}),a.jsx(B,{variant:"secondary",size:"xs",icon:Uf,onClick:()=>H("weapon",de),disabled:b,children:"Unequip"})]},`${te.name}-${de}`))]})]})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-4 md:p-6 border-b flex-shrink-0 bg-gray-50 rounded-t-lg",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800",children:i.charAt(0).toUpperCase()+i.slice(1)}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:[a.jsx(h4,{className:"w-4 h-4"}),T5(((O=y.equipment)==null?void 0:O.money)||{gold:0,silver:0,copper:0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(B,{size:"sm",variant:i==="inventory"?"primary":"secondary",onClick:()=>l("inventory"),children:"Inventory"}),a.jsx(B,{size:"sm",variant:i==="shop"?"primary":"secondary",onClick:()=>l("shop"),children:"Shop"}),a.jsx(B,{size:"sm",variant:i==="money"?"primary":"secondary",onClick:()=>l("money"),children:"Money"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-800 rounded-full hover:bg-gray-200",children:a.jsx(Pt,{className:"w-5 h-5"})})]})]}),i==="inventory"&&a.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search inventory...",value:o.search,onChange:W=>u({...o,search:W.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]}),(t()||r())&&a.jsx(B,{variant:"secondary",size:"sm",icon:Kt,onClick:()=>f(!0),children:"Custom Item"})]}),i==="shop"&&g&&a.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:Lh,onClick:()=>p(null),children:"Back"}),a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:`Search in ${g.name}...`,value:o.search,onChange:W=>u({...o,search:W.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]})]})]}),a.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto flex-1 bg-white",children:[(k||b)&&a.jsxs("div",{className:"flex justify-center items-center py-10",children:[a.jsx(He,{}),a.jsx("span",{className:"ml-2",children:b?"Saving...":"Loading..."})]}),i==="money"&&!b&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Gold"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("gold",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((N=(Z=y.equipment)==null?void 0:Z.money)==null?void 0:N.gold)||0}),a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("gold",1),children:"+"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Silver"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("silver",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((U=(z=y.equipment)==null?void 0:z.money)==null?void 0:U.silver)||0}),a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("silver",1),children:"+"})]})]}),a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Copper"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("copper",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((me=(j=y.equipment)==null?void 0:j.money)==null?void 0:me.copper)||0}),a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>I("copper",1),children:"+"})]})]})]})}),i==="shop"&&!b&&(g?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(W=>a.jsxs("div",{className:"flex flex-col p-3 border rounded-lg",children:[a.jsxs("div",{className:"flex-1 mb-2",children:[a.jsx("h4",{className:"font-medium text-sm",children:W.name}),a.jsx("p",{className:"text-xs text-gray-500",children:W.category})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t",children:[a.jsx("span",{className:"text-xs font-semibold text-green-700",children:W.cost||"N/A"}),a.jsx(B,{variant:"primary",size:"xs",onClick:()=>L(W),disabled:!W.cost,children:"Buy"})]})]},W.id))}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:pI.map(W=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-4 border rounded-lg hover:shadow-lg cursor-pointer",onClick:()=>p(W),children:[a.jsx(W.Icon,{className:"w-10 h-10 text-blue-600 mb-2"}),a.jsx("span",{className:"font-medium text-center text-sm",children:W.name})]},W.name))})),i==="inventory"&&!b&&a.jsxs(a.Fragment,{children:[V(),a.jsx("h3",{className:"font-medium text-sm text-gray-600 mt-6 mb-3 pt-4 border-t",children:"Inventory Items"}),a.jsxs("div",{className:"space-y-3",children:[Q.map((W,q)=>{var Ae,we,Ze,tt;const J=y.equipment.inventory.findIndex(ct=>ct.id===W.id),te=S(W.name),de=te&&(((Ae=te.category)==null?void 0:Ae.toUpperCase().includes("WEAPON"))||((we=te.category)==null?void 0:we.toUpperCase().includes("ARMOR"))),ve=W.quantity>0&&te&&(((Ze=te.category)==null?void 0:Ze.toUpperCase())==="MEDICINE"||((tt=te.category)==null?void 0:tt.toUpperCase())==="TRADE GOODS");return a.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between gap-2",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("h3",{className:"font-medium text-sm truncate",children:vb(W)})}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[ve&&a.jsx(B,{variant:"outline",size:"xs",icon:c4,onClick:()=>D(J),children:"Use"}),de&&a.jsx(B,{variant:"secondary",size:"xs",icon:Fp,onClick:()=>T(W,J),children:"Equip"}),a.jsx(B,{variant:"dangerOutline",size:"xs",icon:ur,onClick:()=>G(J),children:"Drop"}),((te==null?void 0:te.effect)||(te==null?void 0:te.description))&&a.jsxs("span",{className:"relative group flex items-center",children:[a.jsx(On,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full right-0 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity z-20 pointer-events-none",children:[a.jsx("h5",{className:"font-bold mb-1 border-b pb-1",children:te.name}),a.jsx("p",{children:te.effect||te.description}),a.jsxs("p",{className:"mt-1 text-gray-300",children:["W: ",te.weight||"N/A",", Cost: ",te.cost||"N/A"]})]})]})]})]},W.id||`${W.name}-${q}`)}),(((X=y.equipment)==null?void 0:X.inventory)||[]).length===0&&!V()&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Tu,{className:"w-12 h-12 mx-auto text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"Inventory is empty."}),a.jsx(B,{variant:"link",size:"sm",onClick:()=>l("shop"),children:"Go to Shop"})]})]}),h&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-medium",children:"Create Custom Item"}),a.jsx("button",{onClick:()=>f(!1),className:"p-1",children:a.jsx(Pt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1",children:"Name"}),a.jsx("input",{type:"text",value:c.name,onChange:W=>d({...c,name:W.target.value}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Category"}),a.jsx("select",{value:c.category,onChange:W=>d({...c,category:W.target.value}),className:"w-full p-1.5 border rounded text-sm",children:mI.map(W=>a.jsx("option",{value:W,children:W},W))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Cost"}),a.jsx("input",{type:"text",value:c.cost,onChange:W=>d({...c,cost:W.target.value}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:c.weight,onChange:W=>d({...c,weight:Number(W.target.value)}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Quantity"}),a.jsx("input",{type:"number",value:c.quantity,onChange:W=>d({...c,quantity:Math.max(1,Number(W.target.value))}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{className:"md:col-span-3",children:[a.jsx("label",{className:"block text-xs mb-1",children:"Effect"}),a.jsx("textarea",{value:c.effect,onChange:W=>d({...c,effect:W.target.value}),className:"w-full p-1.5 border rounded text-sm",rows:2})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[a.jsx(B,{variant:"secondary",size:"sm",onClick:()=>f(!1),children:"Cancel"}),a.jsx(B,{variant:"primary",size:"sm",icon:Kt,onClick:A,children:"Add"})]})]})]})]})]})})}const Yf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},xI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,yI=(e,t,r)=>{var l,o;const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=xI(s);return n?i*2:i},bI=e=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[e],vI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}else if(typeof e=="object"&&e!==null)return e;return{}},wb=e=>e?e.split("(")[0].trim():null,wI=e=>["d4","d6","d8","d10","d12","d20"].includes(e),Qf=e=>e?Array.isArray(e)?e.join(", "):e:"-";function EI({character:e}){var b,E,_,k,S,I;const{toggleDiceRoller:t}=Dn(),{data:r=[],isLoading:n,error:s}=Lt({queryKey:["gameItems"],queryFn:lc,staleTime:1e3*60*10}),i=A=>{if(A)return r.find(D=>{var T;return((T=D.name)==null?void 0:T.toLowerCase())===A.toLowerCase()})},l=()=>{var H,L,G,Q;let A=0;const D=(L=(H=e.equipment)==null?void 0:H.equipped)==null?void 0:L.armor,T=(Q=(G=e.equipment)==null?void 0:G.equipped)==null?void 0:Q.helmet;if(D){const $=i(D);A+=Number($==null?void 0:$.armor_rating)||0}if(T){const $=i(T);A+=Number($==null?void 0:$.armor_rating)||0}return A},o=(A,D)=>{const T=D==null?void 0:D.match(/(\d+)?d(\d+)/i);let H=["d6"],L="1d6";if(T){const z=T[1]?parseInt(T[1],10):1,U=`d${T[2]}`;wI(U)&&(H=Array(z).fill(U),L=`${z}d${T[2]}`)}let G="",Q=null;const $=i(A),V=$==null?void 0:$.skill,K=wb(V),O=K?Yf[K]:null;O==="STR"?e.attributes.STR>15?(G="d6",Q="d6"):e.attributes.STR>12&&(G="d4",Q="d4"):O==="AGL"&&(e.attributes.AGL>15?(G="d6",Q="d6"):e.attributes.AGL>12&&(G="d4",Q="d4"));let Z=L;G&&(Z+=` + ${G}`);const N=[...H];Q&&N.push(Q),t({rollMode:"attackDamage",initialDice:N,description:`Damage roll for ${A} (${Z})`})},u=(A,D,T)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:D,description:`${A} Check`,requiresBane:T,skillName:A})},c=l(),d=((E=(b=e.equipment)==null?void 0:b.equipped)==null?void 0:E.weapons)||[],h=vI(e.skill_levels),f=(k=(_=e.equipment)==null?void 0:_.equipped)==null?void 0:k.armor,g=(I=(S=e.equipment)==null?void 0:S.equipped)==null?void 0:I.helmet,p=f?i(f):void 0,y=g?i(g):void 0,v=p?Qf(p.features):"-",x=y?Qf(y.features):"-";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[" ",a.jsx(ks,{className:"w-5 h-5 text-blue-600"})," Armor"]}),n?a.jsx(He,{size:"sm"}):s?a.jsx(Ne,{message:"Could not load item details for armor."}):a.jsxs("div",{className:"space-y-3",children:[" ",a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Body:"})," ",(p==null?void 0:p.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(p==null?void 0:p.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",p.armor_rating,")"]})]}),p&&p.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(Yy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:v})]})]}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Helmet:"})," ",(y==null?void 0:y.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(y==null?void 0:y.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",y.armor_rating,")"]})]}),y&&y.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(Yy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:x})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium mt-2",children:[a.jsx(ks,{className:"w-4 h-4"}),a.jsxs("span",{children:["Total Armor Rating: ",c]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[a.jsx(mi,{className:"w-5 h-5 text-red-600"})," Weapons"]}),n?a.jsx(He,{size:"sm"}):s?a.jsx(Ne,{message:"Could not load item details for weapons."}):d.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No weapons equipped."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Weapon / Shield"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Grip"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Range"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Damage"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Features"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:d.map((A,D)=>{var K;const T=i(A.name),H=T==null?void 0:T.skill,L=wb(H);let G=null,Q=!1,$=null;if(L&&Yf[L]){$=Yf[L],G=(h==null?void 0:h[L])??yI(e,L,$);const O=bI($);Q=((K=e.conditions)==null?void 0:K[O])??!1}const V=Qf(A.features);return a.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:A.name}),a.jsx("td",{className:"px-4 py-2",children:A.grip||"-"}),a.jsx("td",{className:"px-4 py-2",children:A.range||"-"}),a.jsx("td",{className:"px-4 py-2",children:A.damage||"-"}),a.jsx("td",{className:"px-4 py-2",children:V}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[A.damage?a.jsxs(B,{variant:"link",size:"xs",onClick:()=>o(A.name,A.damage),className:"text-red-600 hover:text-red-800 font-medium p-0 flex items-center gap-1",title:`Roll damage for ${A.name} (${A.damage})`,children:[a.jsx(or,{className:"w-3 h-3"}),"Damage"]}):null,L&&G!==null?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(B,{variant:"link",size:"xs",onClick:()=>u(L,G,Q),className:`${Q?"text-red-600 hover:text-red-800":"text-indigo-600 hover:text-indigo-800"} font-medium p-0 flex items-center gap-1`,title:`Roll ${L} check (Target  ${G}${Q?", Bane":""})`,children:[a.jsx(or,{className:"w-3 h-3"}),L,": ",G]}),Q&&a.jsx("span",{className:"text-xs text-red-500 font-semibold",children:"(Bane)"})]}):H?a.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Skill '${H}' not found or level unavailable.`,children:["(",L||H," N/A)"]}):null]})})]},`${A.name}-${D}`)})})]})})]})]})}function Tg(e){return typeof e!="object"||e===null||Array.isArray(e)?!1:Object.values(e).every(t=>typeof t=="number"||t===null)}function Eb(e){return typeof e!="object"||e===null?!1:typeof e.skill_id=="string"&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}const NI=e=>Object.entries(e).map(([t,r])=>r!==null?`${t} (Level ${r})`:t).join(", "),kI=e=>e?typeof e=="string"?e:Tg(e)?NI(e):typeof e=="object"?(console.warn("Unexpected requirement object format:",e),`Requires: ${Object.keys(e).join(", ")}`):(console.warn("Unexpected requirement type:",typeof e,e),"Unknown requirement format"):null;function _I({onClose:e}){const{character:t,allHeroicAbilities:r,isLoading:n,error:s,updateCharacterData:i,isSaving:l,setActiveStatusMessage:o}=tr(),[u,c]=w.useState(null);if(!t)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6",children:[a.jsx(He,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]})});const d=w.useMemo(()=>{if(!r||!t||!t.heroic_abilities)return[];const p=new Set(Array.isArray(t.heroic_abilities)?t.heroic_abilities:[]);return r.filter(y=>p.has(y.name))},[r,t]),h=async p=>{c(null);const y=p.willpower_cost,v=t.current_wp;if(y===null||y<=0){o(`Used Heroic Ability: ${p.name}`);return}if(typeof v!="number"){const x=`Cannot activate ${p.name}: Current Willpower is invalid.`;c(x);return}if(v>=y){const x=v-y;try{await i({current_wp:x}),o(`Used Heroic Ability: ${p.name} for ${y} WP.`)}catch(b){c(`Failed to update Willpower: ${b.message}`)}}else c(`Not enough Willpower. Required: ${y}, Available: ${v}`)},f=()=>n?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx(He,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]}):s?a.jsx("div",{className:"p-6",children:a.jsx(Ne,{message:`Failed to load required data: ${s}`})}):t.profession==="Mage"?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Magic Instead of Heroic Abilities"}),a.jsx("p",{className:"text-sm text-blue-700",children:"As a mage, you use magic instead of heroic abilities. Check the Spells tab to manage your capabilities."})]})]})}):d.length===0?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx(On,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"No Heroic Abilities Assigned"}),a.jsx("p",{className:"text-sm text-gray-700",children:"This character does not currently have any heroic abilities assigned."})]})]})}):a.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[u&&a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(IE,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800",children:"Activation Failed"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(p=>{const y=p.willpower_cost,v=t.current_wp,x=y===null||y<=0||typeof v=="number"&&v>=y,b=kI(p.requirement);return a.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:p.name}),a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded-full",children:y!==null&&y>0?a.jsxs(a.Fragment,{children:[a.jsx(Mh,{className:"w-4 h-4 text-amber-500"}),a.jsxs("span",{children:[y," WP"]})]}):a.jsx("span",{className:"text-green-600",children:"Free"})})]}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:p.description}),b&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Requirement: ",b]})]}),a.jsxs(B,{onClick:()=>h(p),disabled:!x||l,loading:l,variant:x?"default":"secondary",size:"sm",className:"w-full mt-4",children:[a.jsx(An,{className:"w-4 h-4 mr-2"}),"Activate ",y!==null&&y>0?`(${y} WP)`:""]})]},p.id)})})]}),g=typeof t.current_wp=="number"?t.current_wp:"N/A";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(Ng,{className:"w-6 h-6 text-blue-600"}),"Heroic Abilities"]}),a.jsxs("p",{className:"text-gray-600",children:["Available Willpower: ",g," WP"]})]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-3xl leading-none","aria-label":"Close",children:""})]}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:f()}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(B,{variant:"outline",onClick:e,children:"Close"})})]})})}async function SI(){const{data:e,error:t}=await ne.from("heroic_abilities").select(`
      id,
      name,
      description,
      willpower_cost,
      requirement,
      kin,        
      profession  
    `);if(t)throw console.error("Error fetching heroic abilities:",t),new Error(t.message||"Failed to fetch heroic abilities");return(e||[]).map(n=>({id:n.id,name:n.name,description:n.description,willpower_cost:n.willpower_cost,requirement:n.requirement,kin:n.kin,profession:n.profession}))}const iN={Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},ns=e=>{const t=tr.getState().character,r=(t==null?void 0:t.skill_levels)||{};return(r==null?void 0:r[e])??0};function TI(e){var s;const t={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",...iN},r=[],n=e.skill_levels||{};for(const i in n){const l=t[i];if(!l){console.warn(`[AdvancementSystem] Skill "${i}" exists on character but is missing from the attribute map.`);continue}const o=n[i],u=((s=e.trainedSkills)==null?void 0:s.includes(i))??!1;r.push({name:i,attribute:l,level:o,isTrained:u})}return r.sort((i,l)=>i.name.localeCompare(l.name)),r}const CI=(e,t)=>{var l,o;if(!t)return!1;if(!e.requirement)return!0;const r=e.requirement,n=t.attributes,s=t.skill_levels||{},i=Object.fromEntries(Object.entries(n).map(([u,c])=>[u.toUpperCase(),c]));if(typeof r=="string"){const u=r.split(" ");if(u.length===2){const c=u[0].toUpperCase(),d=parseInt(u[1],10);if(!isNaN(d)){if(c in i)return i[c]>=d;const h=(l=Object.entries(s).find(([f])=>f.toUpperCase()===c))==null?void 0:l[1];if(h!==void 0)return h>=d}}return!1}else if(typeof r=="object"&&r!==null){for(const[u,c]of Object.entries(r)){if(c==null)continue;const d=u.toUpperCase();if(d in i){if(i[d]<c)return!1}else{const h=(o=Object.entries(s).find(([f])=>f.toUpperCase()===d))==null?void 0:o[1];if(h===void 0||h<c)return!1}}return!0}return!1},lN=e=>{var n;if(!e)return[];const t=((n=e.school)==null?void 0:n.spells)??[],r=e.general??[];return Array.from(new Set([...t,...r].map(s=>s.toUpperCase())))},jI=(e,t,r,n)=>{if(!e)return!0;const s=lN(t.spells),i=t.skill_levels||{},l=t.attributes,o=y=>{let v=!1;switch(y.type){case"spell":v=s.includes(y.name.toUpperCase());break;case"school":v=(r==null?void 0:r.toUpperCase())===y.name.toUpperCase();break;case"anySchool":v=!!t.magicSchool;break;case"skill":const x=i[y.name];v=x!==void 0&&x>=y.value;break;case"attribute":const b=l[y.name.toUpperCase()];v=b!==void 0&&b>=y.value;break}return y.negate?!v:v};let u;const c=y=>{const v=y.operator.toUpperCase();if(v==="AND"){const x=y.conditions.every(b=>u(b));return y.negate?!x:x}else if(v==="OR"){const x=y.conditions.some(b=>u(b));return y.negate?!x:x}return!1};u=y=>"operator"in y?c(y):o(y);let d=null;try{e.trim().startsWith("{")&&(d=JSON.parse(e))}catch{}if(d)return u(d);const h=n.map(y=>y.name.toUpperCase()),f=r,g=y=>{const v=y.trim().toUpperCase();if(v==="ANY SCHOOL OF MAGIC")return!!t.magicSchool;if(s.includes(v))return!0;if(h.includes(v))return(f==null?void 0:f.toUpperCase())===v;const x=v.split(" ");if(x.length===2){const[b,E]=x,_=parseInt(E,10);if(!isNaN(_)){const k=Object.keys(l).find(I=>I.toUpperCase()===b);if(k)return l[k]>=_;const S=Object.keys(i).find(I=>I.toUpperCase()===b);if(S)return i[S]>=_}}return!1},p=y=>y.trim().split(/ AND /i).every(g);return e.trim().split(/ OR /i).some(p)};function AI({character:e,onClose:t}){var ht;const{character:r,markedSkillsThisSession:n,clearMarkedSkillsThisSession:s,increaseSkillLevel:i,addHeroicAbility:l,setSkillUnderStudy:o,learnSpell:u,addMagicSchool:c,isSaving:d,saveError:h}=tr(),{toggleDiceRoller:f}=Dn(),[g,p]=w.useState("initial"),[y,v]=w.useState(null),[x,b]=w.useState(0),[E,_]=w.useState(new Set),[k,S]=w.useState([]),[I,A]=w.useState(0),[D,T]=w.useState(null),[H,L]=w.useState(null),[G,Q]=w.useState([]),[$,V]=w.useState(!1),[K,O]=w.useState(null),[Z,N]=w.useState(null),[z,U]=w.useState(null),[j,me]=w.useState(null),[X,W]=w.useState([]),[q,J]=w.useState([]),[te,de]=w.useState([]),[ve,Ae]=w.useState(null),[we,Ze]=w.useState(null),[tt,ct]=w.useState(!1),rt=r||e,Zt=w.useMemo(()=>rt?TI(rt):[],[rt]),mr=(ht=r==null?void 0:r.teacher)==null?void 0:ht.skillUnderStudy,At=()=>{v(null),T(null),U(null),b(0),_(new Set),S([]),A(0),L(null),O(null),N(null),de([]),Ae(null),Ze(null),ct(!1),V(!1)},no=()=>{At(),p("enterMarks")},js=()=>{At(),p("selectStudyType")},Re=async()=>{if(!r||!r.magicSchool){v("Character has no magic school assigned."),p("selectStudyType");return}ct(!0),v(null);try{let he=q.length>0?q:await Bp();q.length===0&&J(he);let Oe=X.length>0?X:await P6();X.length===0&&W(Oe);const Ie=he.find(zt=>zt.id===r.magicSchool.id),nt=Ie?Ie.name:null;me(nt);const Ye=lN(r.spells),lt=Oe.filter(zt=>!Ye.includes(zt.name.toUpperCase())&&jI(zt.prerequisite,r,nt,he));de(lt),p("studyMagicSelectSpell")}catch(he){console.error("Error loading magic data:",he),v(he instanceof Error?he.message:"Failed to load magic study data."),p("selectStudyType")}finally{ct(!1)}},dt=async he=>{if(he==="teacher")p("studyTeacherSelectSkill");else if(he==="magic")Re();else if(he==="learnSchool"){ct(!0),v(null);try{const Oe=await Bp();J(Oe),p("studyMagicSelectSchool")}catch(Oe){console.error("Error loading magic schools:",Oe),v(Oe instanceof Error?Oe.message:"Failed to load magic schools.")}finally{ct(!1)}}},so=he=>{if(he.preventDefault(),x>0){const Oe=new Set;let Ie=0;const nt=Zt.map(Ye=>Ye.name);for(const Ye of n)Ie<x&&nt.includes(Ye)&&(Oe.add(Ye),Ie++);_(Oe),v(null),p("selectSkills")}else v("Please enter at least one Advancement Mark.")},re=he=>{_(Oe=>{const Ie=new Set(Oe);return Ie.has(he)?Ie.delete(he):Ie.size<x&&Ie.add(he),Ie})},ce=()=>{if(E.size!==x){v(`Please select exactly ${x} skill(s).`);return}v(null),S(Array.from(E)),A(0),T(null),p("rollSkills")},Ce=w.useCallback(async he=>{if(!r||!he.results||he.results.length===0){T("Error: Roll failed due to missing data."),f();return}const{value:Oe}=he.results[0],{skillName:Ie,targetValue:nt}=he;if(!Ie||nt===void 0){T("Error: Roll context missing skill information."),f();return}const Ye=Oe>nt;let lt=`Rolled ${Oe} vs ${Ie} (Target > ${nt}). `;if(Ye){lt+="Success! Skill increased.",await i(Ie);const zt=ns(Ie);lt+=` New Level: ${zt}.`,zt===18&&nt<18&&(L(Ie),lt+=" Reached level 18!")}else lt+="Failed to increase skill.";T(lt),f()},[r,i,f]),Le=(he,Oe)=>{const Ie=ns(he),nt=Oe==="study"?U:T;if(Ie>=18){nt(`Skill ${he} is already at max level (18).`);return}nt(null),f({rollMode:"advancementRoll",targetValue:Ie,skillName:he,description:`Advancement Roll: ${he} (d20 vs > ${Ie})`,onRollComplete:Oe==="study"?_r:Ce})},Xe=async(he,Oe)=>{const Ie=Oe==="study"?U:T;if(!r){Ie("Error: Character data not available.");return}const nt=ns(he);if(nt>=18){Ie(`Skill ${he} is already at max level (18).`);return}Ie(null);let Ye=`Manually advanced ${he}. Skill increased.`;await i(he);const lt=ns(he);Ye+=` New Level: ${lt}.`,lt===18&&nt<18&&(Oe==="endSession"&&L(he),Ye+=" Reached level 18!"),Ie(Ye)},pr=()=>{T(null),H?(fn(),p("selectAbility")):I<k.length-1?A(he=>he+1):rr()},fn=async()=>{V(!0),v(null);try{const he=await SI(),Oe=tr.getState().character;if(!Oe)throw new Error("Character data not available for ability filtering.");const Ie=new Set((Oe.heroic_abilities||[]).map(Ye=>Ye.toUpperCase())),nt=he.filter(Ye=>{var lt,zt;return!Ie.has(Ye.name.toUpperCase())&&(!Ye.kin||Ye.kin.toLowerCase()===((lt=Oe.kin)==null?void 0:lt.toLowerCase()))&&(!Ye.profession||Ye.profession.toLowerCase()===((zt=Oe.profession)==null?void 0:zt.toLowerCase()))&&CI(Ye,Oe)});Q(nt)}catch(he){console.error("Error fetching abilities:",he),v(he instanceof Error?he.message:"Failed to load heroic abilities.")}finally{V(!1)}},kr=he=>{O(he)},mn=async()=>{if(!K){v("Please select a heroic ability.");return}v(null),await l(K.name),L(null),O(null),I<k.length-1?(A(he=>he+1),p("rollSkills")):rr()},rr=()=>{s(),p("finished")},Tt=he=>{N(he)},pn=async()=>{if(!Z){v("Please select a skill to study.");return}v(null),U(null),await o(Z),p("studyTeacherRollSkill")},_r=w.useCallback(async he=>{if(!r||!he.results||!he.results.length){U("Error: Roll failed due to missing data."),f();return}const{value:Oe}=he.results[0],{skillName:Ie,targetValue:nt}=he;if(!Ie||nt===void 0){U("Error: Roll context missing skill information."),f();return}const Ye=Oe>nt;let lt=`Studied ${Ie}. Rolled ${Oe} vs Target > ${nt}. `;if(Ye){lt+="Success! Skill increased.",await i(Ie);const zt=ns(Ie);lt+=` New Level: ${zt}.`,zt===18&&nt<18&&(lt+=" Reached level 18!")}else lt+="Failed to increase skill this time.";U(lt),f()},[r,i,f]),Xh=w.useCallback(async he=>{var lt;if(!r||!((lt=he.results)!=null&&lt.length)||!we){U("Error: Roll failed due to missing data."),f();return}const{value:Oe}=he.results[0],Ie=he.targetValue;if(Ie===void 0){U("Error: Character INT value not found for roll."),f();return}const nt=Oe>Ie;let Ye=`Attempting to learn ${we.name}. Rolled ${Oe} vs INT > ${Ie}. `;nt?(Ye+=`Success! You have learned the basics of ${we.name}. The skill is added at your base chance of ${Ie}.`,await c(we,Ie)):Ye+="Failure. You must study for another week to try again.",U(Ye),f()},[r,we,c,f]),Jh=()=>{if(!r||!we)return;const he=r.attributes.INT;U(null),f({rollMode:"advancementRoll",targetValue:he,skillName:`Learn ${we.name}`,description:`Learn Magic School: ${we.name} (d20 vs > ${he})`,onRollComplete:Xh})},ef=async()=>{if(!r||!we)return;const he=r.attributes.INT;U(null);let Oe=`Manually learned ${we.name}. Success! The skill is added at your base chance of ${he}.`;await c(we,he),U(Oe)},gn=he=>{Ae(he)},gc=async()=>{if(!ve){v("Please select a spell to learn.");return}v(null);try{await u(ve),t()}catch(he){console.error("Error learning spell:",he),v(he instanceof Error?he.message:"Failed to learn the spell.")}},As=()=>{N(null),U(null),Ae(null),Ze(null),de([]),t()},et=()=>{var he;if(!rt&&g!=="initial")return a.jsx(He,{text:"Loading character data..."});switch(g){case"initial":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Choose an action to proceed."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(B,{onClick:no,className:"flex-1",children:[a.jsx(Ro,{className:"w-5 h-5 mr-2"})," End Session & Advance"]}),a.jsxs(B,{onClick:js,variant:"outline",className:"flex-1",children:[a.jsx(Qo,{className:"w-5 h-5 mr-2"})," Study"]})]})]});case"enterMarks":return a.jsxs("form",{onSubmit:so,className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"End Session Advancement"}),a.jsx("label",{htmlFor:"advancementMarks",className:"block font-medium text-gray-700",children:"How many Advancement Marks did you gain this session?"}),a.jsx("input",{type:"number",id:"advancementMarks",name:"advancementMarks",min:"1",value:x===0?"":x,onChange:ge=>b(parseInt(ge.target.value,10)||0),className:"w-full p-2 border rounded focus:ring-blue-500 focus:border-blue-500",required:!0}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(B,{type:"submit",disabled:x<=0,children:["Next ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]});case"selectSkills":return rt?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Select ",x," skill(s) to attempt advancement:"]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:Zt.length===0?a.jsx("p",{className:"text-gray-500 italic",children:"No skills found for this character."}):Zt.map(ge=>{const Fr=ns(ge.name),Zr=Fr>=18,M=ge.name===mr;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Zr?"opacity-60 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",checked:E.has(ge.name),onChange:()=>re(ge.name),disabled:Zr||!E.has(ge.name)&&E.size>=x,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${ge.isTrained?"font-semibold":""}`,children:ge.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",ge.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Fr]}),Zr&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"}),n.has(ge.name)&&!Zr&&a.jsx(Mh,{className:"w-4 h-4 text-yellow-500 flex-shrink-0",title:"Marked this session (rolled 1 or 20)"}),M&&a.jsx(Ro,{className:"w-4 h-4 text-purple-600 flex-shrink-0 ml-1",title:"Currently studying with teacher"})]},ge.name)})}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",E.size," / ",x]}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>p("enterMarks"),children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(B,{onClick:ce,disabled:E.size!==x,children:["Confirm Selection ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]}):a.jsx(He,{});case"rollSkills":if(k.length===0||!rt)return a.jsx(He,{text:"Preparing skill roll..."});const Oe=k[I],Ie=ns(Oe),nt=Ie>=18,Ye=!!D;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Attempting Advancement (",I+1," / ",k.length,")"]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Oe}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Ie]}),nt&&!Ye&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Skipped."})]}),D&&a.jsx("div",{className:`p-3 rounded border text-center ${D.includes("Success")||D.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":D.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:D}),h&&a.jsx(Ne,{message:h}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Ye&&!nt&&a.jsxs(a.Fragment,{children:[a.jsxs(B,{onClick:()=>Le(Oe,"endSession"),disabled:d,loading:d,children:[a.jsx(or,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Ie,")"]}),a.jsxs(B,{variant:"outline",onClick:()=>Xe(Oe,"endSession"),disabled:d,loading:d,children:[a.jsx(An,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(Ye||nt&&!Ye)&&a.jsxs(B,{onClick:pr,disabled:d,loading:d,children:[H?"Select Heroic Ability":I<k.length-1?"Next Skill":"Finish Session"," ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectAbility":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 flex items-center gap-2",children:[a.jsx(yE,{className:"w-5 h-5"})," Skill ",a.jsx("span",{className:"font-bold",children:H})," reached level 18!"]}),a.jsx("p",{className:"text-gray-700",children:"Select a new Heroic Ability:"}),$&&a.jsx(He,{text:"Loading available abilities..."}),y&&a.jsx(Ne,{message:y}),!$&&G.length===0&&!y&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No eligible heroic abilities found for this character."}),!$&&G.length>0&&a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:G.map(ge=>a.jsxs("div",{onClick:()=>kr(ge),className:`p-3 rounded border cursor-pointer ${(K==null?void 0:K.id)===ge.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("p",{className:"font-semibold",children:ge.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ge.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[ge.willpower_cost&&a.jsxs("span",{children:["WP: ",ge.willpower_cost]}),ge.requirement&&typeof ge.requirement=="object"&&Object.keys(ge.requirement).length>0&&a.jsxs("span",{children:["Req: ",Object.entries(ge.requirement).filter(([,Fr])=>Fr!=null).map(([Fr,Zr])=>`${Fr} ${Zr}`).join(", ")]}),ge.requirement&&typeof ge.requirement=="string"&&a.jsxs("span",{children:["Req: ",ge.requirement]})]})]},ge.id))}),h&&a.jsx(Ne,{message:h}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsxs(B,{onClick:mn,disabled:!K||$||d||G.length===0&&!y&&!$,loading:d,children:["Confirm Ability & Continue ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectStudyType":const lt=!!(r!=null&&r.magicSchool),zt=((he=r==null?void 0:r.heroic_abilities)==null?void 0:he.filter(ge=>ge.toUpperCase()==="MAGIC TALENT").length)??0,Si=Object.keys((r==null?void 0:r.skill_levels)??{}).filter(ge=>iN[ge]).length,xc=zt>Si;return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Choose Study Method"}),a.jsx("p",{className:"text-gray-600",children:"How would you like to study to improve a skill or learn magic?"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs(B,{onClick:()=>dt("teacher"),className:"w-full",children:[a.jsx(Ro,{className:"w-5 h-5 mr-2"})," Find a Teacher (Skills)"]}),a.jsxs(B,{onClick:()=>dt("magic"),variant:"outline",className:"w-full",disabled:!lt||tt,loading:tt,children:[a.jsx(Yd,{className:"w-5 h-5 mr-2"})," Study Magic (Spells)"]}),a.jsxs(B,{onClick:()=>dt("learnSchool"),variant:"outline",className:"w-full sm:col-span-2",disabled:!xc||tt,loading:tt,children:[a.jsx(Qo,{className:"w-5 h-5 mr-2"})," Learn a New Magic School"]})]}),!lt&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Ft,{className:"w-4 h-4 flex-shrink-0"})," Character must belong to a Magic School to study its spells."]}),!xc&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Ft,{className:"w-4 h-4 flex-shrink-0"})," Requires the 'Magic Talent' heroic ability. You must have one use of this ability for each school you wish to learn."]}),y&&a.jsx(Ne,{message:y}),a.jsx("div",{className:"flex justify-start",children:a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]})})]});case"studyTeacherSelectSkill":return rt?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Study with a Teacher"}),a.jsx("p",{className:"text-gray-600",children:"Select one skill to focus on improving. You cannot study a skill currently being studied until it has been advanced or study is completed."}),mr&&a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded text-purple-800 text-sm flex items-center gap-2",children:[a.jsx(On,{className:"w-4 h-4 flex-shrink-0"}),"Currently studying: ",a.jsx("span",{className:"font-semibold",children:mr}),". Complete or advance this study first to pick another skill."]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:Zt.map(ge=>{const Fr=ns(ge.name),Zr=Fr>=18,M=Zr||!!mr&&mr!==ge.name;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${M?"opacity-60 cursor-not-allowed":Z===ge.name?"bg-blue-100 border border-blue-300":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"radio",name:"studySkill",checked:Z===ge.name,onChange:()=>Tt(ge.name),disabled:M,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${ge.isTrained?"font-semibold":""}`,children:ge.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",ge.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Fr]}),Zr&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"})]},ge.name)})}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>p("selectStudyType"),children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(B,{onClick:pn,disabled:!Z||!!mr||d,loading:d,children:["Confirm Study Skill ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]}):a.jsx(He,{});case"studyTeacherRollSkill":const Is=mr||Z;if(!Is||!rt)return a.jsx(Ne,{message:"Error: No skill selected or found for study, or character data missing."});const ao=ns(Is),Ti=ao>=18,Oa=!!z;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: ",Is]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Is}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",ao]}),Ti&&!Oa&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Study complete."})]}),z&&a.jsx("div",{className:`p-3 rounded border text-center ${z.includes("Success")||z.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":z.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:z}),h&&a.jsx(Ne,{message:h}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Oa&&!Ti&&a.jsxs(a.Fragment,{children:[a.jsxs(B,{onClick:()=>Le(Is,"study"),disabled:d,loading:d,children:[a.jsx(or,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",ao,")"]}),a.jsxs(B,{variant:"outline",onClick:()=>Xe(Is,"study"),disabled:d,loading:d,children:[a.jsx(An,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(Oa||Ti&&!Oa)&&a.jsxs(B,{onClick:As,disabled:d,loading:d,children:["Finish Study ",a.jsx(Wa,{className:"w-4 h-4 ml-1"})]})]}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSpell":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(Yd,{className:"w-5 h-5 text-purple-600"})," Study Magic (Spells)"]}),j&&a.jsxs("p",{className:"text-gray-600",children:["School: ",a.jsx("span",{className:"font-semibold",children:j})]}),a.jsx("p",{className:"text-gray-600",children:"Select a spell to learn:"}),tt&&a.jsx(He,{text:"Loading spells..."}),y&&a.jsx(Ne,{message:y}),!tt&&te.length===0&&!y&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No new spells available to learn at this time, or prerequisites not met."}),!tt&&te.length>0&&a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:te.map(ge=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(ve==null?void 0:ve.id)===ge.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSpell",checked:(ve==null?void 0:ve.id)===ge.id,onChange:()=>gn(ge),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-semibold",children:[ge.name," ",a.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(Rank ",ge.rank??"N/A",")"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ge.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[ge.casting_time&&a.jsxs("span",{children:["Cast: ",ge.casting_time]}),ge.range&&a.jsxs("span",{children:["Range: ",ge.range]}),ge.duration&&a.jsxs("span",{children:["Duration: ",ge.duration]}),ge.willpower_cost&&a.jsxs("span",{children:["WP: ",ge.willpower_cost]}),ge.prerequisite&&a.jsxs("span",{className:"italic",children:["(Learn Req: ",ge.prerequisite,")"]}),ge.casting_requirement&&a.jsxs("span",{className:"italic",children:["(Cast Req: ",ge.casting_requirement,")"]})]})]})]},ge.id))}),h&&a.jsx(Ne,{message:h}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>{p("selectStudyType"),v(null)},children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(B,{onClick:gc,disabled:!ve||tt||d||te.length===0&&!y&&!tt,loading:d,children:["Learn Selected Spell ",a.jsx(Wa,{className:"w-4 h-4 ml-1"})]})]}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSchool":const tf=Object.keys((r==null?void 0:r.skill_levels)??{}),io=q.filter(ge=>!tf.includes(ge.name));return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(Qo,{className:"w-5 h-5 text-purple-600"})," Learn a New Magic School"]}),a.jsx("p",{className:"text-gray-600",children:"Select a school of magic to study for a week. At the end of the week, you will roll against your INT to learn it."}),y&&a.jsx(Ne,{message:y}),!tt&&io.length===0&&!y&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"There are no new magic schools available for you to learn."}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:io.map(ge=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(we==null?void 0:we.id)===ge.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSchool",checked:(we==null?void 0:we.id)===ge.id,onChange:()=>Ze(ge),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("p",{className:"font-semibold",children:ge.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ge.description})]})]},ge.id))}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(B,{type:"button",variant:"secondary",onClick:()=>{p("selectStudyType"),v(null)},children:[a.jsx(Ri,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(B,{onClick:()=>p("studyMagicRollSchool"),disabled:!we||d,loading:d,children:["Begin Study ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]});case"studyMagicRollSchool":if(!we||!r)return a.jsx(Ne,{message:"Error: No magic school selected or character data missing."});const Kr=r.attributes.INT,at=!!z;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: Learn ",we.name]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:we.name}),a.jsxs("p",{className:"text-gray-600",children:["You must roll greater than your Intelligence (",Kr,") on a d20 to succeed."]})]}),z&&a.jsx("div",{className:`p-3 rounded border text-center ${z.includes("Success")?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:z}),h&&a.jsx(Ne,{message:h}),y&&a.jsx(Ne,{message:y}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!at&&a.jsxs(a.Fragment,{children:[a.jsxs(B,{onClick:Jh,disabled:d,loading:d,children:[a.jsx(or,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Kr,")"]}),a.jsxs(B,{variant:"outline",onClick:ef,disabled:d,loading:d,children:[a.jsx(An,{className:"w-4 h-4 mr-1"})," Succeed Manually"]})]}),at&&a.jsxs(B,{onClick:As,disabled:d,loading:d,children:["Finish ",a.jsx(Wa,{className:"w-4 h-4 ml-1"})]})]}),d&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(cs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"finished":return a.jsxs("div",{className:"text-center space-y-4 p-6 bg-green-50 rounded border border-green-200",children:[a.jsx(Wa,{className:"w-12 h-12 text-green-500 mx-auto"}),a.jsx("h4",{className:"text-xl font-semibold text-green-800",children:"Session Ended & Advancement Complete!"}),a.jsx("p",{className:"text-gray-700",children:"Character data has been updated. Marked skills for this session have been cleared."}),a.jsx(B,{onClick:t,children:"Done"})]});default:const yc=g;return a.jsxs("p",{children:["Unknown step: ",yc]})}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4 sticky top-0 bg-white z-10",children:[a.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(Ro,{className:"w-6 h-6 text-blue-600"}),"Character Advancement"]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600","aria-label":"Close advancement modal",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-6",children:et()})]})})}function II({character:e}){const{toggleDiceRoller:t}=Dn(),{setDeathRollState:r,adjustStat:n,isSaving:s}=tr(),[i,l]=w.useState(!1),[o,u]=w.useState(null),c=e.death_rolls_passed??0,d=e.death_rolls_failed??0,h=e.is_rallied??!1,f=e.attributes.CON,g=e.attributes.WIL,p=c>=3,y=d>=3,v=D=>{l(!1);const T=D.results[0].value,H=D.isCritical&&D.isSuccess,L=D.isCritical&&!D.isSuccess,G=D.isSuccess;let Q=c,$=d;H?(Q+=2,u(`Rolled ${T} (Dragon! +2 Successes)`)):L?($+=2,u(`Rolled ${T} (Demon! +2 Failures)`)):G?(Q+=1,u(`Rolled ${T} (Success vs CON ${f})`)):($+=1,u(`Rolled ${T} (Failure vs CON ${f})`)),r(Q,$,h),t()},x=D=>{l(!1);const T=D.results[0].value;D.isSuccess?(r(c,d,!0),u(`Rallied! (Rolled ${T} vs WIL ${g} w/ Bane)`)):(r(c,d,!1),u(`Rally Failed (Rolled ${T} vs WIL ${g} w/ Bane)`)),t()},b=D=>{l(!1);const T=D.results[0].value;u(`Recovered ${T} HP!`),n("current_hp",T),t()},E=()=>{i||p||y||(l(!0),u(null),t({rollMode:"deathRoll",targetValue:f,description:`Death Save (d20 vs CON ${f})`,onRollComplete:v}))},_=()=>{i||h||p||y||(l(!0),u(null),t({rollMode:"rallyRoll",targetValue:g,requiresBane:!0,description:`Rally Self (d20 vs WIL ${g}, Bane)`,onRollComplete:x}))},k=()=>{i||!p||y||(l(!0),u(null),t({rollMode:"recoveryRoll",description:"Recovery Roll (1d6 HP)",onRollComplete:b}))},S=D=>{if(p||y||s)return;const T=Math.max(0,Math.min(3,c+D));r(T,d,h)},I=D=>{if(p||y||s)return;const T=Math.max(0,Math.min(3,d+D));r(c,T,h)},A=(D,T,H,L,G,Q)=>a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(L,{className:`w-4 h-4 sm:w-5 sm:h-5 ${G}`}),a.jsxs("span",{className:"font-medium text-xs sm:text-sm w-16 sm:w-20",children:[D,":"]}),a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{onClick:()=>Q(-1),disabled:T===0||p||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Decrease ${D}`,children:a.jsx(TE,{className:"w-3 h-3"})}),[...Array(H)].map(($,V)=>a.jsx("div",{className:`w-3 h-3 sm:w-4 sm:h-4 rounded-full border ${V<T?D==="Successes"?"bg-green-500 border-green-600":"bg-red-500 border-red-600":"bg-gray-200 border-gray-300"}`},V)),a.jsx("button",{onClick:()=>Q(1),disabled:T===H||p||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Increase ${D}`,children:a.jsx(Kt,{className:"w-3 h-3"})})]})]});return a.jsxs("div",{className:"p-3 rounded-lg shadow bg-red-50 border border-red-300 space-y-2",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm text-red-700",children:[a.jsx(Gd,{className:"w-4 h-4 text-red-600 animate-pulse"}),"DYING (",e.current_hp," HP)"]}),a.jsxs("div",{className:"space-y-1",children:[A("Successes",c,3,Ph,"text-green-500",S),A("Failures",d,3,ll,"text-red-500",I)]}),o&&a.jsx("p",{className:"text-xs text-center text-gray-700 italic",children:o}),h&&!p&&!y&&a.jsxs("p",{className:"text-xs text-center text-yellow-800 bg-yellow-100 p-1 rounded border border-yellow-200 flex items-center justify-center gap-1",children:[a.jsx(On,{className:"w-3 h-3"})," Rallied! Can act, but still dying."]}),a.jsx("div",{className:"pt-1 space-y-2",children:y?a.jsx("div",{className:"text-center font-bold text-lg text-red-800 p-2 bg-red-200 rounded",children:"CHARACTER DIED"}):p?a.jsxs(B,{onClick:k,disabled:i||s,loading:i||s,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[a.jsx(vg,{className:"w-4 h-4 mr-1"})," Roll Recovery (1d6 HP)"]}):a.jsxs(a.Fragment,{children:[a.jsxs(B,{onClick:E,disabled:i||s,loading:i||s,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"sm",children:[a.jsx(Gd,{className:"w-4 h-4 mr-1"})," Roll Death Save (d20)"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(B,{onClick:_,disabled:i||s||h,loading:i||s,className:`w-full text-black ${h?"bg-gray-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,size:"sm",children:[a.jsx(RE,{className:"w-4 h-4 mr-1"})," ",h?"Rallied!":"Attempt Rally (Self)"]}),!h&&a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 p-2 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none",children:["Roll d20 vs WIL (",g,") with Bane. Success lets you act while dying.",a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-black rotate-45"})]})]})]})}),s&&a.jsx("div",{className:"text-xs text-center text-blue-600 italic mt-1",children:"Saving..."})]})}function RI(){const e=tr(r=>r.activeStatusMessage),t=tr(r=>r.clearActiveStatusMessage);return e?a.jsxs("div",{className:"my-3 p-3 bg-blue-100 border border-blue-300 rounded-lg shadow-sm flex items-center justify-between animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(An,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsxs("p",{className:"text-sm text-blue-800",children:["Activated: ",a.jsx("span",{className:"font-semibold",children:e})]})]}),a.jsx("button",{onClick:t,className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full transition-colors","aria-label":"Dismiss status message",children:a.jsx(Pt,{className:"w-4 h-4"})})]}):null}const Kf=({label:e,value:t})=>a.jsxs("div",{children:[a.jsx("dt",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:e}),a.jsx("dd",{className:"text-base text-gray-900",children:t||a.jsx("span",{className:"text-gray-400 italic",children:"N/A"})})]}),Zf=({label:e,children:t,icon:r})=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[a.jsx(r,{className:"w-4 h-4 text-gray-500"}),e]}),t]});function LI({onClose:e}){const{character:t,updateCharacterData:r,isSaving:n,saveError:s}=tr(),[i,l]=w.useState("bio"),[o,u]=w.useState(!1),[c,d]=w.useState(!1),[h,f]=w.useState(!1),g=w.useRef(null),[p,y]=w.useState(""),[v,x]=w.useState(""),[b,E]=w.useState(""),[_,k]=w.useState(""),[S,I]=w.useState(""),[A,D]=w.useState(!1),T=()=>{t&&(y(t.portrait_url||""),x(t.appearance||""),E(t.memento||""),k(t.flaw||""),I(t.notes||""))};w.useEffect(()=>{T()},[t]),w.useEffect(()=>{const $=V=>{g.current&&!g.current.contains(V.target)&&f(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[]);const H=async $=>{t&&(await r($),u(!1),d(!1),D(!1))},L=()=>{T(),u(!1),d(!1)},G=()=>a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"absolute top-0 right-0",ref:g,children:[a.jsx(B,{variant:"ghost",size:"icon",onClick:()=>f(!h),children:a.jsx(bg,{className:"w-5 h-5"})}),h&&a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:a.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[a.jsxs("button",{onClick:()=>{u(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx(C4,{className:"w-4 h-4"})," Edit Bio Details"]}),a.jsxs("button",{onClick:()=>{d(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx(Mp,{className:"w-4 h-4"})," Edit Portrait URL"]})]})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-6 p-4 border rounded-lg shadow-sm bg-slate-50",children:[a.jsx("div",{className:"w-full md:w-1/3 flex-shrink-0",children:c?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"portraitUrl",className:"block text-sm font-medium text-gray-700",children:"Portrait URL"}),a.jsx("input",{id:"portraitUrl",type:"text",value:p,onChange:$=>y($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://..."}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(B,{variant:"secondary",size:"sm",onClick:()=>{d(!1),T()},children:"Cancel"}),a.jsx(B,{size:"sm",onClick:()=>H({portrait_url:p}),disabled:n,children:n?"...":"Save"})]})]}):p?a.jsx("img",{src:p,alt:"Character Portrait",className:"w-full h-auto object-cover rounded-md border",onError:$=>{$.currentTarget.src="https://via.placeholder.com/150/CCCCCC/FFFFFF?text=Invalid+Image"}}):a.jsxs("button",{onClick:()=>d(!0),className:"w-full h-48 border-2 border-dashed rounded-md flex flex-col items-center justify-center text-gray-500 hover:bg-gray-100 hover:border-gray-400 transition-colors",children:[a.jsx(Mp,{className:"w-8 h-8 mb-2"}),a.jsx("span",{children:"Add Portrait"})]})}),a.jsxs("div",{className:"flex-grow space-y-4",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 border-b pb-2",children:t==null?void 0:t.name}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx(Kf,{label:"Kin",value:t==null?void 0:t.kin}),a.jsx(Kf,{label:"Profession",value:t==null?void 0:t.profession}),a.jsx(Kf,{label:"Age",value:t==null?void 0:t.age})]}),o?a.jsxs(a.Fragment,{children:[a.jsx(Zf,{label:"Appearance",icon:_E,children:a.jsx("textarea",{value:v,onChange:$=>x($.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A brief description..."})}),a.jsx(Zf,{label:"Memento",icon:Mh,children:a.jsx("input",{type:"text",value:b,onChange:$=>E($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A cherished item..."})}),a.jsx(Zf,{label:"Flaw",icon:p4,children:a.jsx("input",{type:"text",value:_,onChange:$=>k($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A personal weakness..."})})]}):a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Appearance"}),a.jsx("p",{className:"text-gray-800 text-sm",children:v||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Memento"}),a.jsx("p",{className:"text-gray-800 text-sm",children:b||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Flaw"}),a.jsx("p",{className:"text-gray-800 text-sm",children:_||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]})]})]})]}),o&&a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx(B,{variant:"secondary",onClick:L,children:"Cancel"}),a.jsx(B,{icon:Gt,onClick:()=>H({appearance:v,memento:b,flaw:_}),disabled:n,children:n?"Saving...":"Save Changes"})]})]}),Q=()=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-end mb-4 gap-2",children:A?a.jsxs(a.Fragment,{children:[a.jsx(B,{variant:"secondary",onClick:()=>{I((t==null?void 0:t.notes)||""),D(!1)},children:"Cancel"}),a.jsx(B,{onClick:()=>H({notes:S}),disabled:n,icon:Gt,children:n?"Saving...":"Save Backstory"})]}):a.jsx(B,{onClick:()=>D(!0),icon:Eg,children:"Edit Backstory"})}),A?a.jsx("textarea",{value:S,onChange:$=>I($.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"Write your character's life story here..."}):a.jsx("div",{className:"p-4 bg-gray-50 rounded-md border min-h-[200px]",children:S?a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:S}):a.jsx("p",{className:"text-gray-500 italic",children:"No backstory has been written yet."})})]});return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:e,children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex flex-col",onClick:$=>$.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Character Biography"}),a.jsx("p",{className:"text-sm text-gray-500",children:"View and edit personal details and history."})]}),a.jsx(B,{variant:"ghost",size:"icon",onClick:e,"aria-label":"Close modal",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-gray-200 px-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>l("bio"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="bio"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Ni,{className:"w-5 h-5"})," Bio"]}),a.jsxs("button",{onClick:()=>l("backstory"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="backstory"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Qo,{className:"w-5 h-5"})," Backstory"]})]})}),a.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[s&&a.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-800 rounded-md flex items-center gap-2",children:[a.jsx(ic,{className:"w-5 h-5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Save Error"}),a.jsx("p",{className:"text-sm",children:s})]})]}),i==="bio"?G():Q()]})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex items-center justify-center",children:[a.jsx(He,{}),a.jsx("span",{className:"ml-2",children:"Loading character data..."})]})})}function OI({}){var z,U,j,me,X,W,q,J,te;dn();const{toggleDiceRoller:e}=Dn(),{character:t,fetchCharacter:r,adjustStat:n,toggleCondition:s,performRest:i,updateCharacterData:l,isLoading:o,error:u,isSaving:c,saveError:d,setActiveStatusMessage:h}=tr(),[f,g]=w.useState(!1),[p,y]=w.useState(!1),[v,x]=w.useState(!1),[b,E]=w.useState(!1),[_,k]=w.useState(!1),[S,I]=w.useState(!1),[A,D]=w.useState(!1),[T,H]=w.useState(!1);if(o)return a.jsx("div",{className:"p-4 text-center",children:"Loading character..."});if(u)return a.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading character: ",u]});if(!t)return a.jsx("div",{className:"p-4 text-center",children:"Character data is not available. Please select a character."});const L=de=>{s(de)},G=async de=>{y(!1),await i(de,de==="stretch"?T:void 0),H(!1)},Q=(de,ve,Ae,we)=>{var ct;const Ze=ve??10,tt=((ct=t.conditions)==null?void 0:ct[we])??!1;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:de}),a.jsx("span",{className:"text-xl",children:Ze})]}),a.jsx("div",{className:"text-sm h-5",children:(de==="STR"||de==="AGL")&&Ze>12&&a.jsxs("div",{className:"text-blue-400",children:["Damage Bonus: ",Ze<=15?"+D4":"+D6"]})})]}),a.jsx("button",{onClick:()=>L(we),className:`absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${tt?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${c?"opacity-50 cursor-not-allowed":""}`,disabled:c,title:`Toggle ${we.charAt(0).toUpperCase()+we.slice(1)}`,children:we.toUpperCase().substring(0,3)})]})},$=()=>p?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(qy,{className:"w-6 h-6"})," Choose Rest Type"]}),a.jsx("button",{onClick:()=>{y(!1),H(!1)},className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>G("shift"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:c,children:[a.jsx(Dh,{className:"w-5 h-5"}),c?"Resting...":"Take Shift Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Shift Rest (~6 hours):"})," Requires a safe location. Recovers all HP & WP, heals all standard conditions. Resets death roll state. Interruption negates effects."]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>G("stretch"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition-colors",disabled:c||((t==null?void 0:t.current_hp)??0)<=0,children:[a.jsx(OE,{className:"w-5 h-5"}),c?"Resting...":"Take Stretch Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Stretch Rest (~15 mins):"})," Heal ",T?"2d6":"1d6"," HP, recover 1d6 WP, heal one standard condition. Can only be done once per Shift. Cannot be taken while dying. Interruption negates effects."]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:de=>H(de.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:"Healer present for Stretch Rest (requires successful HEALING roll)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Check this if another character is tending to you and succeeds on a HEALING roll during a Stretch Rest."})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>G("round"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",disabled:c,children:[a.jsx(CE,{className:"w-5 h-5"}),c?"Resting...":"Take Round Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Round Rest (~10 secs):"})," Recover 1d6 WP. No HP recovery. Can only be done once per Shift."]})]})]}),c&&a.jsx("div",{className:"mt-4 text-sm text-center text-gray-500",children:"Saving..."}),d&&a.jsxs("div",{className:"mt-4 text-sm text-center text-red-500",children:["Error: ",d]})]})}):null,V=()=>{var ve;const de=Object.keys((t==null?void 0:t.skill_levels)||{});return((ve=t==null?void 0:t.profession)==null?void 0:ve.endsWith("Mage"))||de.some(Ae=>["ELEMENTALISM","ANIMISM","MENTALISM"].includes(Ae.toUpperCase()))},K=(t==null?void 0:t.current_hp)??0,O=(t==null?void 0:t.current_wp)??0,Z=(t==null?void 0:t.max_hp)??((z=t==null?void 0:t.attributes)==null?void 0:z.CON)??10,N=(t==null?void 0:t.max_wp)??((U=t==null?void 0:t.attributes)==null?void 0:U.WIL)??10;return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:t.name}),a.jsxs("p",{className:"text-gray-600 text-lg",children:[t.kin||"Unknown Kin"," ",t.profession||"Unknown Profession"," - Age: ",t.age||"Unknown"]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm transition-colors",children:[a.jsx(D4,{className:"w-4 h-4"}),"Bio"]}),a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(Tu,{className:"w-4 h-4"}),"Inventory"]}),a.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm transition-colors",children:[a.jsx(qy,{className:"w-4 h-4"}),"Rest"]}),a.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-black rounded-lg hover:bg-yellow-600 text-sm transition-colors",children:[a.jsx(yE,{className:"w-4 h-4"}),"Session"]})]})]}),a.jsx(RI,{}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-x-4 gap-y-6",children:[Q("STR",(j=t.attributes)==null?void 0:j.STR,a.jsx(f4,{}),"exhausted"),Q("CON",(me=t.attributes)==null?void 0:me.CON,a.jsx(si,{}),"sickly"),Q("AGL",(X=t.attributes)==null?void 0:X.AGL,a.jsx(m4,{}),"dazed"),Q("INT",(W=t.attributes)==null?void 0:W.INT,a.jsx(wE,{}),"angry"),Q("WIL",(q=t.attributes)==null?void 0:q.WIL,a.jsx(An,{}),"scared"),Q("CHA",(J=t.attributes)==null?void 0:J.CHA,a.jsx(H4,{}),"disheartened")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start",children:[a.jsxs("div",{className:"md:col-span-6 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(nc,{className:"w-4 h-4"}),"Skills"]}),V()&&a.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm transition-colors",children:[a.jsx(ol,{className:"w-4 h-4"}),"Spells"]}),a.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm transition-colors",children:[a.jsx(L4,{className:"w-4 h-4"}),"Abilities"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 text-white rounded-lg text-sm self-start",children:[a.jsx("span",{className:"font-medium",children:"Movement:"}),a.jsxs("span",{className:"font-bold text-lg",children:[sI(t.kin,(te=t.attributes)==null?void 0:te.AGL),"m"]})]})]}),a.jsxs("div",{className:"md:col-span-6 grid grid-cols-2 gap-4",children:[K>0?a.jsxs("div",{className:"p-3 rounded-lg shadow bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(vg,{className:"w-4 h-4 text-red-600"}),"HP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[K," / ",Z]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>n("current_hp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:c||K<=0,title:"Decrease HP",children:"-"}),a.jsx("button",{onClick:()=>n("current_hp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:K>=Z||c,title:"Increase HP",children:"+"})]})]}):a.jsx(II,{character:t}),a.jsxs("div",{className:"p-3 bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(An,{className:"w-4 h-4 text-blue-600"}),"WP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[O," / ",N]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>n("current_wp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:O===0||c,title:"Decrease WP",children:"-"}),a.jsx("button",{onClick:()=>n("current_wp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:O>=N||c,title:"Increase WP",children:"+"})]})]})]})]}),a.jsx(EI,{character:t}),A&&a.jsx(LI,{onClose:()=>D(!1)}),v&&a.jsx(cI,{onClose:()=>x(!1)}),f&&a.jsx(fI,{onClose:()=>g(!1)}),b&&a.jsx(gI,{onClose:()=>E(!1)}),_&&a.jsx(AI,{character:t,onClose:()=>{k(!1),t!=null&&t.id&&(t!=null&&t.user_id)&&r(t.id,t.user_id)}}),S&&a.jsx(_I,{onClose:()=>I(!1)}),$(),c&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50 animate-pulse",children:"Saving..."}),d&&a.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50",children:["Save Error: ",d]})]})}const PI=({combatant:e})=>{var o;const{setInitiativeForCombatant:t,isSaving:r}=tr(),[n,s]=w.useState(((o=e.initiative_roll)==null?void 0:o.toString())??""),i=()=>{const u=parseInt(n,10);!isNaN(u)&&u>=1&&u<=10?t(e.id,u):alert("Please enter a number between 1 and 10.")};w.useEffect(()=>{var u;s(((u=e.initiative_roll)==null?void 0:u.toString())??"")},[e.initiative_roll]);const l=!!e.character_id;return a.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${l?"border-blue-500 bg-blue-50":"border-red-500 bg-red-50"}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"font-bold",children:e.display_name}),a.jsx("div",{className:"flex items-center gap-2 text-sm",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(si,{className:"w-4 h-4 text-red-600"}),a.jsxs("span",{children:[e.current_hp," / ",e.max_hp]})]})})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[a.jsx("input",{type:"number",value:n,onChange:u=>s(u.target.value),placeholder:"1-10",className:"w-20 px-2 py-1 border rounded-md",min:"1",max:"10",disabled:r}),a.jsx(B,{onClick:i,size:"sm",disabled:r,children:"Set"})]}),e.conditions&&Object.entries(e.conditions).filter(([,u])=>u).length>0&&a.jsxs("div",{className:"mt-2 text-xs text-red-700",children:["Conditions: ",Object.entries(e.conditions).filter(([,u])=>u).map(([u])=>u).join(", ")]})]})};function oN(){const{character:e,activeEncounter:t,encounterCombatants:r,isLoadingEncounter:n,fetchActiveEncounter:s}=tr(),[i,l]=w.useState(!1);if(w.useEffect(()=>{if(!(e!=null&&e.party_id)||!(e!=null&&e.id))return;const f=e.party_id,g=e.id;console.log(`Attempting to subscribe to real-time updates for Party ID: ${f}`);const p=ne.channel(`party-encounter-updates-${f}`);return p.on("postgres_changes",{event:"*",schema:"public",table:"encounters",filter:`party_id=eq.${f}`},y=>{console.log("%cREAL-TIME UPDATE (Encounters): Refetching encounter.","color: cyan;",y),s(f,g)}),p.on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=in.(select id from encounters where party_id=eq.${f})`},y=>{console.log("%cREAL-TIME UPDATE (Combatants): Refetching encounter.","color: lightgreen;",y),s(f,g)}),p.subscribe((y,v)=>{y==="SUBSCRIBED"&&console.log("%cSuccessfully subscribed to real-time channel!","color: green; font-weight: bold;"),y==="CHANNEL_ERROR"&&console.error("%cCHANNEL_ERROR: Failed to subscribe.","color: red; font-weight: bold;",v)}),()=>{console.log(`Unsubscribing from party updates: ${f}`),ne.removeChannel(p)}},[e,s]),!e)return null;const o=(t==null?void 0:t.status)==="active",u=o?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",c=o?"Encounter Active":"Party Chat",d=[...r].sort((f,g)=>(g.initiative_roll??0)-(f.initiative_roll??0)),h=o&&d.every(f=>f.initiative_roll!==null);return a.jsxs(a.Fragment,{children:[a.jsx("button",{className:`fixed bottom-4 right-4 p-4 rounded-full shadow-lg text-white transition-colors duration-200 z-40 ${u}`,onClick:()=>l(!i),"aria-label":c,children:o?a.jsx(or,{size:24}):a.jsx(k4,{size:24})}),i&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-end z-30",onClick:()=>l(!1),children:a.jsxs("div",{className:"bg-white w-full max-w-sm h-full shadow-xl flex flex-col",onClick:f=>f.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:o?"Active Encounter":"Party Chat"}),a.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{size:24})})]}),a.jsx("div",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:n&&!t?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(cs,{className:"w-8 h-8 animate-spin text-gray-500"})}):t?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:t.name}),a.jsxs("p",{className:"text-sm",children:["Round: ",a.jsx("span",{className:"font-medium",children:t.current_round})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:h?"Turn Order":"Set Initiative"}),a.jsx("div",{className:"space-y-3",children:d.length>0?d.map(f=>a.jsx(PI,{combatant:f},f.id)):a.jsx("p",{className:"text-sm text-gray-500",children:"No combatants in this encounter yet."})})]})]}):a.jsx("div",{className:"text-gray-600 text-center",children:"No active encounter for your party."})})]})})]})}function DI(){const{id:e}=dg(),{user:t}=$t(),{character:r,isLoading:n,error:s,fetchCharacter:i,setCharacter:l}=tr();return w.useEffect(()=>{(async()=>{e&&(t!=null&&t.id)?await i(e,t.id):(l(null),console.warn("CharacterPage: Character ID or User ID is missing. Cannot load character."))})()},[e,t==null?void 0:t.id,i,l]),n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(He,{size:"lg"})}):s?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:s})}):r?a.jsxs(a.Fragment,{children:[a.jsx(OI,{}),a.jsx(oN,{})]}):a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:"Character not found, does not exist, or you may not have permission to view it."})})}function Nb(e){const t=[],r=String(e||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const l=r.slice(s,n).trim();(l||!i)&&t.push(l),s=n+1,n=r.indexOf(",",s)}return t}function uN(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const MI=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,FI=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,BI={};function kb(e,t){return(BI.jsx?FI:MI).test(e)}const UI=/[ \t\n\f\r]/g;function HI(e){return typeof e=="object"?e.type==="text"?_b(e.value):!1:_b(e)}function _b(e){return e.replace(UI,"")===""}class oc{constructor(t,r,n){this.property=t,this.normal=r,n&&(this.space=n)}}oc.prototype.property={};oc.prototype.normal={};oc.prototype.space=null;function cN(e,t){const r={},n={};let s=-1;for(;++s<e.length;)Object.assign(r,e[s].property),Object.assign(n,e[s].normal);return new oc(r,n,t)}function ju(e){return e.toLowerCase()}class hn{constructor(t,r){this.property=t,this.attribute=r}}hn.prototype.space=null;hn.prototype.boolean=!1;hn.prototype.booleanish=!1;hn.prototype.overloadedBoolean=!1;hn.prototype.number=!1;hn.prototype.commaSeparated=!1;hn.prototype.spaceSeparated=!1;hn.prototype.commaOrSpaceSeparated=!1;hn.prototype.mustUseProperty=!1;hn.prototype.defined=!1;let $I=0;const Pe=ki(),Dt=ki(),dN=ki(),ue=ki(),mt=ki(),dl=ki(),Br=ki();function ki(){return 2**++$I}const zp=Object.freeze(Object.defineProperty({__proto__:null,boolean:Pe,booleanish:Dt,commaOrSpaceSeparated:Br,commaSeparated:dl,number:ue,overloadedBoolean:dN,spaceSeparated:mt},Symbol.toStringTag,{value:"Module"})),Xf=Object.keys(zp);class Cg extends hn{constructor(t,r,n,s){let i=-1;if(super(t,r),Sb(this,"space",s),typeof n=="number")for(;++i<Xf.length;){const l=Xf[i];Sb(this,Xf[i],(n&zp[l])===zp[l])}}}Cg.prototype.defined=!0;function Sb(e,t,r){r&&(e[t]=r)}const zI={}.hasOwnProperty;function Xl(e){const t={},r={};let n;for(n in e.properties)if(zI.call(e.properties,n)){const s=e.properties[n],i=new Cg(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[ju(n)]=n,r[ju(i.attribute)]=n}return new oc(t,r,e.space)}const hN=Xl({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),fN=Xl({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function mN(e,t){return t in e?e[t]:t}function pN(e,t){return mN(e,t.toLowerCase())}const gN=Xl({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:pN,properties:{xmlns:null,xmlnsXLink:null}}),xN=Xl({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Dt,ariaAutoComplete:null,ariaBusy:Dt,ariaChecked:Dt,ariaColCount:ue,ariaColIndex:ue,ariaColSpan:ue,ariaControls:mt,ariaCurrent:null,ariaDescribedBy:mt,ariaDetails:null,ariaDisabled:Dt,ariaDropEffect:mt,ariaErrorMessage:null,ariaExpanded:Dt,ariaFlowTo:mt,ariaGrabbed:Dt,ariaHasPopup:null,ariaHidden:Dt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:mt,ariaLevel:ue,ariaLive:null,ariaModal:Dt,ariaMultiLine:Dt,ariaMultiSelectable:Dt,ariaOrientation:null,ariaOwns:mt,ariaPlaceholder:null,ariaPosInSet:ue,ariaPressed:Dt,ariaReadOnly:Dt,ariaRelevant:null,ariaRequired:Dt,ariaRoleDescription:mt,ariaRowCount:ue,ariaRowIndex:ue,ariaRowSpan:ue,ariaSelected:Dt,ariaSetSize:ue,ariaSort:null,ariaValueMax:ue,ariaValueMin:ue,ariaValueNow:ue,ariaValueText:null,role:null}}),qI=Xl({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:pN,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:dl,acceptCharset:mt,accessKey:mt,action:null,allow:null,allowFullScreen:Pe,allowPaymentRequest:Pe,allowUserMedia:Pe,alt:null,as:null,async:Pe,autoCapitalize:null,autoComplete:mt,autoFocus:Pe,autoPlay:Pe,blocking:mt,capture:null,charSet:null,checked:Pe,cite:null,className:mt,cols:ue,colSpan:null,content:null,contentEditable:Dt,controls:Pe,controlsList:mt,coords:ue|dl,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Pe,defer:Pe,dir:null,dirName:null,disabled:Pe,download:dN,draggable:Dt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Pe,formTarget:null,headers:mt,height:ue,hidden:Pe,high:ue,href:null,hrefLang:null,htmlFor:mt,httpEquiv:mt,id:null,imageSizes:null,imageSrcSet:null,inert:Pe,inputMode:null,integrity:null,is:null,isMap:Pe,itemId:null,itemProp:mt,itemRef:mt,itemScope:Pe,itemType:mt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Pe,low:ue,manifest:null,max:null,maxLength:ue,media:null,method:null,min:null,minLength:ue,multiple:Pe,muted:Pe,name:null,nonce:null,noModule:Pe,noValidate:Pe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Pe,optimum:ue,pattern:null,ping:mt,placeholder:null,playsInline:Pe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Pe,referrerPolicy:null,rel:mt,required:Pe,reversed:Pe,rows:ue,rowSpan:ue,sandbox:mt,scope:null,scoped:Pe,seamless:Pe,selected:Pe,shadowRootClonable:Pe,shadowRootDelegatesFocus:Pe,shadowRootMode:null,shape:null,size:ue,sizes:null,slot:null,span:ue,spellCheck:Dt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ue,step:null,style:null,tabIndex:ue,target:null,title:null,translate:null,type:null,typeMustMatch:Pe,useMap:null,value:Dt,width:ue,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:mt,axis:null,background:null,bgColor:null,border:ue,borderColor:null,bottomMargin:ue,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Pe,declare:Pe,event:null,face:null,frame:null,frameBorder:null,hSpace:ue,leftMargin:ue,link:null,longDesc:null,lowSrc:null,marginHeight:ue,marginWidth:ue,noResize:Pe,noHref:Pe,noShade:Pe,noWrap:Pe,object:null,profile:null,prompt:null,rev:null,rightMargin:ue,rules:null,scheme:null,scrolling:Dt,standby:null,summary:null,text:null,topMargin:ue,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ue,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Pe,disableRemotePlayback:Pe,prefix:null,property:null,results:ue,security:null,unselectable:null}}),VI=Xl({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:mN,properties:{about:Br,accentHeight:ue,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ue,amplitude:ue,arabicForm:null,ascent:ue,attributeName:null,attributeType:null,azimuth:ue,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ue,by:null,calcMode:null,capHeight:ue,className:mt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ue,diffuseConstant:ue,direction:null,display:null,dur:null,divisor:ue,dominantBaseline:null,download:Pe,dx:null,dy:null,edgeMode:null,editable:null,elevation:ue,enableBackground:null,end:null,event:null,exponent:ue,externalResourcesRequired:null,fill:null,fillOpacity:ue,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:dl,g2:dl,glyphName:dl,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ue,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ue,horizOriginX:ue,horizOriginY:ue,id:null,ideographic:ue,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ue,k:ue,k1:ue,k2:ue,k3:ue,k4:ue,kernelMatrix:Br,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ue,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ue,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ue,overlineThickness:ue,paintOrder:null,panose1:null,path:null,pathLength:ue,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:mt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ue,pointsAtY:ue,pointsAtZ:ue,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Br,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Br,rev:Br,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Br,requiredFeatures:Br,requiredFonts:Br,requiredFormats:Br,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ue,specularExponent:ue,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ue,strikethroughThickness:ue,string:null,stroke:null,strokeDashArray:Br,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ue,strokeOpacity:ue,strokeWidth:null,style:null,surfaceScale:ue,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Br,tabIndex:ue,tableValues:null,target:null,targetX:ue,targetY:ue,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Br,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ue,underlineThickness:ue,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ue,values:null,vAlphabetic:ue,vMathematical:ue,vectorEffect:null,vHanging:ue,vIdeographic:ue,version:null,vertAdvY:ue,vertOriginX:ue,vertOriginY:ue,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ue,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),WI=/^data[-\w.:]+$/i,Tb=/-[a-z]/g,GI=/[A-Z]/g;function Bh(e,t){const r=ju(t);let n=t,s=hn;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&WI.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(Tb,QI);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!Tb.test(i)){let l=i.replace(GI,YI);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}s=Cg}return new s(n,t)}function YI(e){return"-"+e.toLowerCase()}function QI(e){return e.charAt(1).toUpperCase()}const KI={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},uc=cN([fN,hN,gN,xN,qI],"html"),Ra=cN([fN,hN,gN,xN,VI],"svg");function Cb(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function yN(e){return e.join(" ").trim()}var bN={},jb=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,ZI=/\n/g,XI=/^\s*/,JI=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,eR=/^:\s*/,tR=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,rR=/^[;\s]*/,nR=/^\s+|\s+$/g,sR=`
`,Ab="/",Ib="*",$a="",aR="comment",iR="declaration",lR=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(p){var y=p.match(ZI);y&&(r+=y.length);var v=p.lastIndexOf(sR);n=~v?p.length-v:n+p.length}function i(){var p={line:r,column:n};return function(y){return y.position=new l(p),c(),y}}function l(p){this.start=p,this.end={line:r,column:n},this.source=t.source}l.prototype.content=e;function o(p){var y=new Error(t.source+":"+r+":"+n+": "+p);if(y.reason=p,y.filename=t.source,y.line=r,y.column=n,y.source=e,!t.silent)throw y}function u(p){var y=p.exec(e);if(y){var v=y[0];return s(v),e=e.slice(v.length),y}}function c(){u(XI)}function d(p){var y;for(p=p||[];y=h();)y!==!1&&p.push(y);return p}function h(){var p=i();if(!(Ab!=e.charAt(0)||Ib!=e.charAt(1))){for(var y=2;$a!=e.charAt(y)&&(Ib!=e.charAt(y)||Ab!=e.charAt(y+1));)++y;if(y+=2,$a===e.charAt(y-1))return o("End of comment missing");var v=e.slice(2,y-2);return n+=2,s(v),e=e.slice(y),n+=2,p({type:aR,comment:v})}}function f(){var p=i(),y=u(JI);if(y){if(h(),!u(eR))return o("property missing ':'");var v=u(tR),x=p({type:iR,property:Rb(y[0].replace(jb,$a)),value:v?Rb(v[0].replace(jb,$a)):$a});return u(rR),x}}function g(){var p=[];d(p);for(var y;y=f();)y!==!1&&(p.push(y),d(p));return p}return c(),g()};function Rb(e){return e?e.replace(nR,$a):$a}var oR=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bN,"__esModule",{value:!0});var Lb=bN.default=cR,uR=oR(lR);function cR(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,uR.default)(e),s=typeof t=="function";return n.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;s?t(l,o,i):o&&(r=r||{},r[l]=o)}}),r}const dR=Lb.default||Lb,Uh=vN("end"),es=vN("start");function vN(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function wN(e){const t=es(e),r=Uh(e);if(t&&r)return{start:t,end:r}}function Zo(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Ob(e.position):"start"in e||"end"in e?Ob(e):"line"in e||"column"in e?qp(e):""}function qp(e){return Pb(e&&e.line)+":"+Pb(e&&e.column)}function Ob(e){return qp(e&&e.start)+"-"+qp(e&&e.end)}function Pb(e){return e&&typeof e=="number"?e:1}class hr extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},l=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof t=="string"?s=t:!i.cause&&t&&(l=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=o?o.line:void 0,this.name=Zo(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}hr.prototype.file="";hr.prototype.name="";hr.prototype.reason="";hr.prototype.message="";hr.prototype.stack="";hr.prototype.column=void 0;hr.prototype.line=void 0;hr.prototype.ancestors=void 0;hr.prototype.cause=void 0;hr.prototype.fatal=void 0;hr.prototype.place=void 0;hr.prototype.ruleId=void 0;hr.prototype.source=void 0;const jg={}.hasOwnProperty,hR=new Map,fR=/[A-Z]/g,mR=/-([a-z])/g,pR=new Set(["table","tbody","thead","tfoot","tr"]),gR=new Set(["td","th"]),EN="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function xR(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=_R(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=kR(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Ra:uc,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=NN(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function NN(e,t,r){if(t.type==="element")return yR(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return bR(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return wR(e,t,r);if(t.type==="mdxjsEsm")return vR(e,t);if(t.type==="root")return ER(e,t,r);if(t.type==="text")return NR(e,t)}function yR(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=Ra,e.schema=s),e.ancestors.push(t);const i=_N(e,t.tagName,!1),l=SR(e,t);let o=Ig(e,t);return pR.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!HI(u):!0})),kN(e,l,i,t),Ag(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function bR(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}Au(e,t.position)}function vR(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Au(e,t.position)}function wR(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=Ra,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:_N(e,t.name,!0),l=TR(e,t),o=Ig(e,t);return kN(e,l,i,t),Ag(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function ER(e,t,r){const n={};return Ag(n,Ig(e,t)),e.create(t,e.Fragment,n,r)}function NR(e,t){return t.value}function kN(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Ag(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function kR(e,t,r){return n;function n(s,i,l,o){const c=Array.isArray(l.children)?r:t;return o?c(i,l,o):c(i,l)}}function _R(e,t){return r;function r(n,s,i,l){const o=Array.isArray(i.children),u=es(n);return t(s,i,l,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function SR(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&jg.call(t.properties,s)){const i=CR(e,s,t.properties[s]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&gR.has(t.tagName)?n=o:r[l]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function TR(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else Au(e,t.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else Au(e,t.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function Ig(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:hR;for(;++n<t.children.length;){const i=t.children[n];let l;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const c=s.get(u)||0;l=u+"-"+c,s.set(u,c+1)}}const o=NN(e,i,l);o!==void 0&&r.push(o)}return r}function CR(e,t,r){const n=Bh(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?uN(r):yN(r)),n.property==="style"){let s=typeof r=="object"?r:jR(e,String(r));return e.stylePropertyNameCase==="css"&&(s=AR(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?KI[n.property]||n.property:n.attribute,r]}}function jR(e,t){const r={};try{dR(t,n)}catch(s){if(!e.ignoreInvalidStyle){const i=s,l=new hr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=EN+"#cannot-parse-style-attribute",l}}return r;function n(s,i){let l=s;l.slice(0,2)!=="--"&&(l.slice(0,4)==="-ms-"&&(l="ms-"+l.slice(4)),l=l.replace(mR,RR)),r[l]=i}}function _N(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,l;for(;++i<s.length;){const o=kb(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}n=l}else n=kb(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return jg.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);Au(e)}function Au(e,t){const r=new hr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=EN+"#cannot-handle-mdx-estrees-without-createevaluater",r}function AR(e){const t={};let r;for(r in e)jg.call(e,r)&&(t[IR(r)]=e[r]);return t}function IR(e){let t=e.replace(fR,LR);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function RR(e,t){return t.toUpperCase()}function LR(e){return"-"+e.toLowerCase()}const Jf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},OR={};function Rg(e,t){const r=OR,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return SN(e,n,s)}function SN(e,t,r){if(PR(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Db(e.children,t,r)}return Array.isArray(e)?Db(e,t,r):""}function Db(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=SN(e[s],t,r);return n.join("")}function PR(e){return!!(e&&typeof e=="object")}const Mb=document.createElement("i");function Lg(e){const t="&"+e+";";Mb.innerHTML=t;const r=Mb.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Vr(e,t,r,n){const s=e.length;let i=0,l;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)l=Array.from(n),l.unshift(t,r),e.splice(...l);else for(r&&e.splice(t,r);i<n.length;)l=n.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function nn(e,t){return e.length>0?(Vr(e,e.length,0,t),e):t}const Fb={}.hasOwnProperty;function TN(e){const t={};let r=-1;for(;++r<e.length;)DR(t,e[r]);return t}function DR(e,t){let r;for(r in t){const s=(Fb.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let l;if(i)for(l in i){Fb.call(s,l)||(s[l]=[]);const o=i[l];MR(s[l],Array.isArray(o)?o:o?[o]:[])}}}function MR(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Vr(e,0,0,n)}function CN(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function In(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const br=La(/[A-Za-z]/),lr=La(/[\dA-Za-z]/),FR=La(/[#-'*+\--9=?A-Z^-~]/);function Qd(e){return e!==null&&(e<32||e===127)}const Vp=La(/\d/),BR=La(/[\dA-Fa-f]/),UR=La(/[!-/:-@[-`{-~]/);function Se(e){return e!==null&&e<-2}function ut(e){return e!==null&&(e<0||e===32)}function ze(e){return e===-2||e===-1||e===32}const Hh=La(new RegExp("\\p{P}|\\p{S}","u")),pi=La(/\s/);function La(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Jl(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const i=e.charCodeAt(r);let l="";if(i===37&&lr(e.charCodeAt(r+1))&&lr(e.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),s=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(n,r),encodeURIComponent(l)),n=r+s+1,l=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function Ke(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(u){return ze(u)?(e.enter(r),o(u)):t(u)}function o(u){return ze(u)&&i++<s?(e.consume(u),o):(e.exit(r),t(u))}}const HR={tokenize:$R};function $R(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Ke(e,t,"linePrefix")}function s(o){return e.enter("paragraph"),i(o)}function i(o){const u=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=u),r=u,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Se(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const zR={tokenize:qR},Bb={tokenize:VR};function qR(e){const t=this,r=[];let n=0,s,i,l;return o;function o(E){if(n<r.length){const _=r[n];return t.containerState=_[1],e.attempt(_[0].continuation,u,c)(E)}return c(E)}function u(E){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&b();const _=t.events.length;let k=_,S;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){S=t.events[k][1].end;break}x(n);let I=_;for(;I<t.events.length;)t.events[I][1].end={...S},I++;return Vr(t.events,k+1,0,t.events.slice(_)),t.events.length=I,c(E)}return o(E)}function c(E){if(n===r.length){if(!s)return f(E);if(s.currentConstruct&&s.currentConstruct.concrete)return p(E);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Bb,d,h)(E)}function d(E){return s&&b(),x(n),f(E)}function h(E){return t.parser.lazy[t.now().line]=n!==r.length,l=t.now().offset,p(E)}function f(E){return t.containerState={},e.attempt(Bb,g,p)(E)}function g(E){return n++,r.push([t.currentConstruct,t.containerState]),f(E)}function p(E){if(E===null){s&&b(),x(0),e.consume(E);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),y(E)}function y(E){if(E===null){v(e.exit("chunkFlow"),!0),x(0),e.consume(E);return}return Se(E)?(e.consume(E),v(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(E),y)}function v(E,_){const k=t.sliceStream(E);if(_&&k.push(null),E.previous=i,i&&(i.next=E),i=E,s.defineSkip(E.start),s.write(k),t.parser.lazy[E.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<l&&(!s.events[S][1].end||s.events[S][1].end.offset>l))return;const I=t.events.length;let A=I,D,T;for(;A--;)if(t.events[A][0]==="exit"&&t.events[A][1].type==="chunkFlow"){if(D){T=t.events[A][1].end;break}D=!0}for(x(n),S=I;S<t.events.length;)t.events[S][1].end={...T},S++;Vr(t.events,A+1,0,t.events.slice(I)),t.events.length=S}}function x(E){let _=r.length;for(;_-- >E;){const k=r[_];t.containerState=k[1],k[0].exit.call(t,e)}r.length=E}function b(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function VR(e,t,r){return Ke(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ml(e){if(e===null||ut(e)||pi(e))return 1;if(Hh(e))return 2}function $h(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const Wp={name:"attention",resolveAll:WR,tokenize:GR};function WR(e,t){let r=-1,n,s,i,l,o,u,c,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h={...e[n][1].end},f={...e[r][1].start};Ub(h,-u),Ub(f,u),l={type:u>1?"strongSequence":"emphasisSequence",start:h,end:{...e[n][1].end}},o={type:u>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},i={type:u>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:u>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[n][1].end={...l.start},e[r][1].start={...o.end},c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=nn(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=nn(c,[["enter",s,t],["enter",l,t],["exit",l,t],["enter",i,t]]),c=nn(c,$h(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=nn(c,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,c=nn(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,Vr(e,n-1,r-n+3,c),r=n+c.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function GR(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=Ml(n);let i;return l;function l(u){return i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const c=e.exit("attentionSequence"),d=Ml(u),h=!d||d===2&&s||r.includes(u),f=!s||s===2&&d||r.includes(n);return c._open=!!(i===42?h:h&&(s||!f)),c._close=!!(i===42?f:f&&(d||!h)),t(u)}}function Ub(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const YR={name:"autolink",tokenize:QR};function QR(e,t,r){let n=0;return s;function s(g){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(g){return br(g)?(e.consume(g),l):g===64?r(g):c(g)}function l(g){return g===43||g===45||g===46||lr(g)?(n=1,o(g)):c(g)}function o(g){return g===58?(e.consume(g),n=0,u):(g===43||g===45||g===46||lr(g))&&n++<32?(e.consume(g),o):(n=0,c(g))}function u(g){return g===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):g===null||g===32||g===60||Qd(g)?r(g):(e.consume(g),u)}function c(g){return g===64?(e.consume(g),d):FR(g)?(e.consume(g),c):r(g)}function d(g){return lr(g)?h(g):r(g)}function h(g){return g===46?(e.consume(g),n=0,d):g===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):f(g)}function f(g){if((g===45||lr(g))&&n++<63){const p=g===45?f:h;return e.consume(g),p}return r(g)}}const cc={partial:!0,tokenize:KR};function KR(e,t,r){return n;function n(i){return ze(i)?Ke(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||Se(i)?t(i):r(i)}}const jN={continuation:{tokenize:XR},exit:JR,name:"blockQuote",tokenize:ZR};function ZR(e,t,r){const n=this;return s;function s(l){if(l===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return r(l)}function i(l){return ze(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function XR(e,t,r){const n=this;return s;function s(l){return ze(l)?Ke(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(jN,t,r)(l)}}function JR(e){e.exit("blockQuote")}const AN={name:"characterEscape",tokenize:eL};function eL(e,t,r){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return UR(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(i)}}const IN={name:"characterReference",tokenize:tL};function tL(e,t,r){const n=this;let s=0,i,l;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),u}function u(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,l=lr,d(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=BR,d):(e.enter("characterReferenceValue"),i=7,l=Vp,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return l===lr&&!Lg(n.sliceSerialize(f))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(h)&&s++<i?(e.consume(h),d):r(h)}}const Hb={partial:!0,tokenize:nL},$b={concrete:!0,name:"codeFenced",tokenize:rL};function rL(e,t,r){const n=this,s={partial:!0,tokenize:k};let i=0,l=0,o;return u;function u(S){return c(S)}function c(S){const I=n.events[n.events.length-1];return i=I&&I[1].type==="linePrefix"?I[2].sliceSerialize(I[1],!0).length:0,o=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===o?(l++,e.consume(S),d):l<3?r(S):(e.exit("codeFencedFenceSequence"),ze(S)?Ke(e,h,"whitespace")(S):h(S))}function h(S){return S===null||Se(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(Hb,y,_)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||Se(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(S)):ze(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Ke(e,g,"whitespace")(S)):S===96&&S===o?r(S):(e.consume(S),f)}function g(S){return S===null||Se(S)?h(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),p(S))}function p(S){return S===null||Se(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(S)):S===96&&S===o?r(S):(e.consume(S),p)}function y(S){return e.attempt(s,_,v)(S)}function v(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&ze(S)?Ke(e,b,"linePrefix",i+1)(S):b(S)}function b(S){return S===null||Se(S)?e.check(Hb,y,_)(S):(e.enter("codeFlowValue"),E(S))}function E(S){return S===null||Se(S)?(e.exit("codeFlowValue"),b(S)):(e.consume(S),E)}function _(S){return e.exit("codeFenced"),t(S)}function k(S,I,A){let D=0;return T;function T($){return S.enter("lineEnding"),S.consume($),S.exit("lineEnding"),H}function H($){return S.enter("codeFencedFence"),ze($)?Ke(S,L,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):L($)}function L($){return $===o?(S.enter("codeFencedFenceSequence"),G($)):A($)}function G($){return $===o?(D++,S.consume($),G):D>=l?(S.exit("codeFencedFenceSequence"),ze($)?Ke(S,Q,"whitespace")($):Q($)):A($)}function Q($){return $===null||Se($)?(S.exit("codeFencedFence"),I($)):A($)}}}function nL(e,t,r){const n=this;return s;function s(l){return l===null?r(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}const em={name:"codeIndented",tokenize:aL},sL={partial:!0,tokenize:iL};function aL(e,t,r){const n=this;return s;function s(c){return e.enter("codeIndented"),Ke(e,i,"linePrefix",5)(c)}function i(c){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?l(c):r(c)}function l(c){return c===null?u(c):Se(c)?e.attempt(sL,l,u)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||Se(c)?(e.exit("codeFlowValue"),l(c)):(e.consume(c),o)}function u(c){return e.exit("codeIndented"),t(c)}}function iL(e,t,r){const n=this;return s;function s(l){return n.parser.lazy[n.now().line]?r(l):Se(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):Ke(e,i,"linePrefix",5)(l)}function i(l){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):Se(l)?s(l):r(l)}}const lL={name:"codeText",previous:uL,resolve:oL,tokenize:cL};function oL(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function uL(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function cL(e,t,r){let n=0,s,i;return l;function l(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),u(h))}function u(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),u):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):Se(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Se(h)?(e.exit("codeTextData"),u(h)):(e.consume(h),c)}function d(h){return h===96?(e.consume(h),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",c(h))}}class dL{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&Eo(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Eo(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Eo(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);Eo(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Eo(this.left,r.reverse())}}}function Eo(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function RN(e){const t={};let r=-1,n,s,i,l,o,u,c;const d=new dL(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,hL(d,r)),r=t[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--;)if(l=d.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),l[1].type="lineEnding",s=i);else if(l[1].type!=="linePrefix")break;s&&(n[1].end={...d.get(s)[1].start},o=d.slice(s,r),o.unshift(n),d.splice(s,r-s+1,o))}}return Vr(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function hL(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const i=[],l=r._tokenizer||n.parser[r.contentType](r.start),o=l.events,u=[],c={};let d,h,f=-1,g=r,p=0,y=0;const v=[y];for(;g;){for(;e.get(++s)[1]!==g;);i.push(s),g._tokenizer||(d=n.sliceStream(g),g.next||d.push(null),h&&l.defineSkip(g.start),g._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(d),g._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),h=g,g=g.next}for(g=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(y=f+1,v.push(y),g._tokenizer=void 0,g.previous=void 0,g=g.next);for(l.events=[],g?(g._tokenizer=void 0,g.previous=void 0):v.pop(),f=v.length;f--;){const x=o.slice(v[f],v[f+1]),b=i.pop();u.push([b,b+x.length-1]),e.splice(b,2,x)}for(u.reverse(),f=-1;++f<u.length;)c[p+u[f][0]]=p+u[f][1],p+=u[f][1]-u[f][0]-1;return c}const fL={resolve:pL,tokenize:gL},mL={partial:!0,tokenize:xL};function pL(e){return RN(e),e}function gL(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(o)}function s(o){return o===null?i(o):Se(o)?e.check(mL,l,i)(o):(e.consume(o),s)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function xL(e,t,r){const n=this;return s;function s(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Ke(e,i,"linePrefix")}function i(l){if(l===null||Se(l))return r(l);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(n.parser.constructs.flow,r,t)(l)}}function LN(e,t,r,n,s,i,l,o,u){const c=u||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(n),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||Qd(x)?r(x):(e.enter(n),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),y(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),g(x))}function g(x){return x===62?(e.exit("chunkString"),e.exit(o),f(x)):x===null||x===60||Se(x)?r(x):(e.consume(x),x===92?p:g)}function p(x){return x===60||x===62||x===92?(e.consume(x),g):g(x)}function y(x){return!d&&(x===null||x===41||ut(x))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(n),t(x)):d<c&&x===40?(e.consume(x),d++,y):x===41?(e.consume(x),d--,y):x===null||x===32||x===40||Qd(x)?r(x):(e.consume(x),x===92?v:y)}function v(x){return x===40||x===41||x===92?(e.consume(x),y):y(x)}}function ON(e,t,r,n,s,i){const l=this;let o=0,u;return c;function c(g){return e.enter(n),e.enter(s),e.consume(g),e.exit(s),e.enter(i),d}function d(g){return o>999||g===null||g===91||g===93&&!u||g===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?r(g):g===93?(e.exit(i),e.enter(s),e.consume(g),e.exit(s),e.exit(n),t):Se(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(g))}function h(g){return g===null||g===91||g===93||Se(g)||o++>999?(e.exit("chunkString"),d(g)):(e.consume(g),u||(u=!ze(g)),g===92?f:h)}function f(g){return g===91||g===92||g===93?(e.consume(g),o++,h):h(g)}}function PN(e,t,r,n,s,i){let l;return o;function o(f){return f===34||f===39||f===40?(e.enter(n),e.enter(s),e.consume(f),e.exit(s),l=f===40?41:f,u):r(f)}function u(f){return f===l?(e.enter(s),e.consume(f),e.exit(s),e.exit(n),t):(e.enter(i),c(f))}function c(f){return f===l?(e.exit(i),u(l)):f===null?r(f):Se(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Ke(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===l||f===null||Se(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?h:d)}function h(f){return f===l||f===92?(e.consume(f),d):d(f)}}function Xo(e,t){let r;return n;function n(s){return Se(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):ze(s)?Ke(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const yL={name:"definition",tokenize:vL},bL={partial:!0,tokenize:wL};function vL(e,t,r){const n=this;let s;return i;function i(g){return e.enter("definition"),l(g)}function l(g){return ON.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(g)}function o(g){return s=In(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),u):r(g)}function u(g){return ut(g)?Xo(e,c)(g):c(g)}function c(g){return LN(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(g)}function d(g){return e.attempt(bL,h,h)(g)}function h(g){return ze(g)?Ke(e,f,"whitespace")(g):f(g)}function f(g){return g===null||Se(g)?(e.exit("definition"),n.parser.defined.push(s),t(g)):r(g)}}function wL(e,t,r){return n;function n(o){return ut(o)?Xo(e,s)(o):r(o)}function s(o){return PN(e,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return ze(o)?Ke(e,l,"whitespace")(o):l(o)}function l(o){return o===null||Se(o)?t(o):r(o)}}const EL={name:"hardBreakEscape",tokenize:NL};function NL(e,t,r){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return Se(i)?(e.exit("hardBreakEscape"),t(i)):r(i)}}const kL={name:"headingAtx",resolve:_L,tokenize:SL};function _L(e,t){let r=e.length-2,n=3,s,i;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},i={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Vr(e,n,r-n+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function SL(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),l(d)}function l(d){return d===35&&n++<6?(e.consume(d),l):d===null||ut(d)?(e.exit("atxHeadingSequence"),o(d)):r(d)}function o(d){return d===35?(e.enter("atxHeadingSequence"),u(d)):d===null||Se(d)?(e.exit("atxHeading"),t(d)):ze(d)?Ke(e,o,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function u(d){return d===35?(e.consume(d),u):(e.exit("atxHeadingSequence"),o(d))}function c(d){return d===null||d===35||ut(d)?(e.exit("atxHeadingText"),o(d)):(e.consume(d),c)}}const TL=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],zb=["pre","script","style","textarea"],CL={concrete:!0,name:"htmlFlow",resolveTo:IL,tokenize:RL},jL={partial:!0,tokenize:OL},AL={partial:!0,tokenize:LL};function IL(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function RL(e,t,r){const n=this;let s,i,l,o,u;return c;function c(j){return d(j)}function d(j){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(j),h}function h(j){return j===33?(e.consume(j),f):j===47?(e.consume(j),i=!0,y):j===63?(e.consume(j),s=3,n.interrupt?t:N):br(j)?(e.consume(j),l=String.fromCharCode(j),v):r(j)}function f(j){return j===45?(e.consume(j),s=2,g):j===91?(e.consume(j),s=5,o=0,p):br(j)?(e.consume(j),s=4,n.interrupt?t:N):r(j)}function g(j){return j===45?(e.consume(j),n.interrupt?t:N):r(j)}function p(j){const me="CDATA[";return j===me.charCodeAt(o++)?(e.consume(j),o===me.length?n.interrupt?t:L:p):r(j)}function y(j){return br(j)?(e.consume(j),l=String.fromCharCode(j),v):r(j)}function v(j){if(j===null||j===47||j===62||ut(j)){const me=j===47,X=l.toLowerCase();return!me&&!i&&zb.includes(X)?(s=1,n.interrupt?t(j):L(j)):TL.includes(l.toLowerCase())?(s=6,me?(e.consume(j),x):n.interrupt?t(j):L(j)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(j):i?b(j):E(j))}return j===45||lr(j)?(e.consume(j),l+=String.fromCharCode(j),v):r(j)}function x(j){return j===62?(e.consume(j),n.interrupt?t:L):r(j)}function b(j){return ze(j)?(e.consume(j),b):T(j)}function E(j){return j===47?(e.consume(j),T):j===58||j===95||br(j)?(e.consume(j),_):ze(j)?(e.consume(j),E):T(j)}function _(j){return j===45||j===46||j===58||j===95||lr(j)?(e.consume(j),_):k(j)}function k(j){return j===61?(e.consume(j),S):ze(j)?(e.consume(j),k):E(j)}function S(j){return j===null||j===60||j===61||j===62||j===96?r(j):j===34||j===39?(e.consume(j),u=j,I):ze(j)?(e.consume(j),S):A(j)}function I(j){return j===u?(e.consume(j),u=null,D):j===null||Se(j)?r(j):(e.consume(j),I)}function A(j){return j===null||j===34||j===39||j===47||j===60||j===61||j===62||j===96||ut(j)?k(j):(e.consume(j),A)}function D(j){return j===47||j===62||ze(j)?E(j):r(j)}function T(j){return j===62?(e.consume(j),H):r(j)}function H(j){return j===null||Se(j)?L(j):ze(j)?(e.consume(j),H):r(j)}function L(j){return j===45&&s===2?(e.consume(j),V):j===60&&s===1?(e.consume(j),K):j===62&&s===4?(e.consume(j),z):j===63&&s===3?(e.consume(j),N):j===93&&s===5?(e.consume(j),Z):Se(j)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(jL,U,G)(j)):j===null||Se(j)?(e.exit("htmlFlowData"),G(j)):(e.consume(j),L)}function G(j){return e.check(AL,Q,U)(j)}function Q(j){return e.enter("lineEnding"),e.consume(j),e.exit("lineEnding"),$}function $(j){return j===null||Se(j)?G(j):(e.enter("htmlFlowData"),L(j))}function V(j){return j===45?(e.consume(j),N):L(j)}function K(j){return j===47?(e.consume(j),l="",O):L(j)}function O(j){if(j===62){const me=l.toLowerCase();return zb.includes(me)?(e.consume(j),z):L(j)}return br(j)&&l.length<8?(e.consume(j),l+=String.fromCharCode(j),O):L(j)}function Z(j){return j===93?(e.consume(j),N):L(j)}function N(j){return j===62?(e.consume(j),z):j===45&&s===2?(e.consume(j),N):L(j)}function z(j){return j===null||Se(j)?(e.exit("htmlFlowData"),U(j)):(e.consume(j),z)}function U(j){return e.exit("htmlFlow"),t(j)}}function LL(e,t,r){const n=this;return s;function s(l){return Se(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):r(l)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}function OL(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(cc,t,r)}}const PL={name:"htmlText",tokenize:DL};function DL(e,t,r){const n=this;let s,i,l;return o;function o(N){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(N),u}function u(N){return N===33?(e.consume(N),c):N===47?(e.consume(N),k):N===63?(e.consume(N),E):br(N)?(e.consume(N),A):r(N)}function c(N){return N===45?(e.consume(N),d):N===91?(e.consume(N),i=0,p):br(N)?(e.consume(N),b):r(N)}function d(N){return N===45?(e.consume(N),g):r(N)}function h(N){return N===null?r(N):N===45?(e.consume(N),f):Se(N)?(l=h,K(N)):(e.consume(N),h)}function f(N){return N===45?(e.consume(N),g):h(N)}function g(N){return N===62?V(N):N===45?f(N):h(N)}function p(N){const z="CDATA[";return N===z.charCodeAt(i++)?(e.consume(N),i===z.length?y:p):r(N)}function y(N){return N===null?r(N):N===93?(e.consume(N),v):Se(N)?(l=y,K(N)):(e.consume(N),y)}function v(N){return N===93?(e.consume(N),x):y(N)}function x(N){return N===62?V(N):N===93?(e.consume(N),x):y(N)}function b(N){return N===null||N===62?V(N):Se(N)?(l=b,K(N)):(e.consume(N),b)}function E(N){return N===null?r(N):N===63?(e.consume(N),_):Se(N)?(l=E,K(N)):(e.consume(N),E)}function _(N){return N===62?V(N):E(N)}function k(N){return br(N)?(e.consume(N),S):r(N)}function S(N){return N===45||lr(N)?(e.consume(N),S):I(N)}function I(N){return Se(N)?(l=I,K(N)):ze(N)?(e.consume(N),I):V(N)}function A(N){return N===45||lr(N)?(e.consume(N),A):N===47||N===62||ut(N)?D(N):r(N)}function D(N){return N===47?(e.consume(N),V):N===58||N===95||br(N)?(e.consume(N),T):Se(N)?(l=D,K(N)):ze(N)?(e.consume(N),D):V(N)}function T(N){return N===45||N===46||N===58||N===95||lr(N)?(e.consume(N),T):H(N)}function H(N){return N===61?(e.consume(N),L):Se(N)?(l=H,K(N)):ze(N)?(e.consume(N),H):D(N)}function L(N){return N===null||N===60||N===61||N===62||N===96?r(N):N===34||N===39?(e.consume(N),s=N,G):Se(N)?(l=L,K(N)):ze(N)?(e.consume(N),L):(e.consume(N),Q)}function G(N){return N===s?(e.consume(N),s=void 0,$):N===null?r(N):Se(N)?(l=G,K(N)):(e.consume(N),G)}function Q(N){return N===null||N===34||N===39||N===60||N===61||N===96?r(N):N===47||N===62||ut(N)?D(N):(e.consume(N),Q)}function $(N){return N===47||N===62||ut(N)?D(N):r(N)}function V(N){return N===62?(e.consume(N),e.exit("htmlTextData"),e.exit("htmlText"),t):r(N)}function K(N){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),O}function O(N){return ze(N)?Ke(e,Z,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):Z(N)}function Z(N){return e.enter("htmlTextData"),l(N)}}const Og={name:"labelEnd",resolveAll:UL,resolveTo:HL,tokenize:$L},ML={tokenize:zL},FL={tokenize:qL},BL={tokenize:VL};function UL(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&Vr(e,0,e.length,r),e}function HL(e,t){let r=e.length,n=0,s,i,l,o;for(;r--;)if(s=e[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(l){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(l=r);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},d={type:"labelText",start:{...e[i+n+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",u,t],["enter",c,t]],o=nn(o,e.slice(i+1,i+n+3)),o=nn(o,[["enter",d,t]]),o=nn(o,$h(t.parser.constructs.insideSpan.null,e.slice(i+n+4,l-3),t)),o=nn(o,[["exit",d,t],e[l-2],e[l-1],["exit",c,t]]),o=nn(o,e.slice(l+1)),o=nn(o,[["exit",u,t]]),Vr(e,i,e.length,o),e}function $L(e,t,r){const n=this;let s=n.events.length,i,l;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return o;function o(f){return i?i._inactive?h(f):(l=n.parser.defined.includes(In(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),u):r(f)}function u(f){return f===40?e.attempt(ML,d,l?d:h)(f):f===91?e.attempt(FL,d,l?c:h)(f):l?d(f):h(f)}function c(f){return e.attempt(BL,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,r(f)}}function zL(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return ut(h)?Xo(e,i)(h):i(h)}function i(h){return h===41?d(h):LN(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function l(h){return ut(h)?Xo(e,u)(h):d(h)}function o(h){return r(h)}function u(h){return h===34||h===39||h===40?PN(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function c(h){return ut(h)?Xo(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function qL(e,t,r){const n=this;return s;function s(o){return ON.call(n,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return n.parser.defined.includes(In(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function l(o){return r(o)}}function VL(e,t,r){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):r(i)}}const WL={name:"labelStartImage",resolveAll:Og.resolveAll,tokenize:GL};function GL(e,t,r){const n=this;return s;function s(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):r(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const YL={name:"labelStartLink",resolveAll:Og.resolveAll,tokenize:QL};function QL(e,t,r){const n=this;return s;function s(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const tm={name:"lineEnding",tokenize:KL};function KL(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Ke(e,t,"linePrefix")}}const hd={name:"thematicBreak",tokenize:ZL};function ZL(e,t,r){let n=0,s;return i;function i(c){return e.enter("thematicBreak"),l(c)}function l(c){return s=c,o(c)}function o(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):n>=3&&(c===null||Se(c))?(e.exit("thematicBreak"),t(c)):r(c)}function u(c){return c===s?(e.consume(c),n++,u):(e.exit("thematicBreakSequence"),ze(c)?Ke(e,o,"whitespace")(c):o(c))}}const Cr={continuation:{tokenize:tO},exit:nO,name:"list",tokenize:eO},XL={partial:!0,tokenize:sO},JL={partial:!0,tokenize:rO};function eO(e,t,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,l=0;return o;function o(g){const p=n.containerState.type||(g===42||g===43||g===45?"listUnordered":"listOrdered");if(p==="listUnordered"?!n.containerState.marker||g===n.containerState.marker:Vp(g)){if(n.containerState.type||(n.containerState.type=p,e.enter(p,{_container:!0})),p==="listUnordered")return e.enter("listItemPrefix"),g===42||g===45?e.check(hd,r,c)(g):c(g);if(!n.interrupt||g===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(g)}return r(g)}function u(g){return Vp(g)&&++l<10?(e.consume(g),u):(!n.interrupt||l<2)&&(n.containerState.marker?g===n.containerState.marker:g===41||g===46)?(e.exit("listItemValue"),c(g)):r(g)}function c(g){return e.enter("listItemMarker"),e.consume(g),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||g,e.check(cc,n.interrupt?r:d,e.attempt(XL,f,h))}function d(g){return n.containerState.initialBlankLine=!0,i++,f(g)}function h(g){return ze(g)?(e.enter("listItemPrefixWhitespace"),e.consume(g),e.exit("listItemPrefixWhitespace"),f):r(g)}function f(g){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(g)}}function tO(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(cc,s,i);function s(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Ke(e,t,"listItemIndent",n.containerState.size+1)(o)}function i(o){return n.containerState.furtherBlankLines||!ze(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,l(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(JL,t,l)(o))}function l(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,Ke(e,e.attempt(Cr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function rO(e,t,r){const n=this;return Ke(e,s,"listItemIndent",n.containerState.size+1);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===n.containerState.size?t(i):r(i)}}function nO(e){e.exit(this.containerState.type)}function sO(e,t,r){const n=this;return Ke(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const l=n.events[n.events.length-1];return!ze(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):r(i)}}const qb={name:"setextUnderline",resolveTo:aO,tokenize:iO};function aO(e,t){let r=e.length,n,s,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!i&&e[r][1].type==="definition"&&(i=r);const l={type:"setextHeading",start:{...e[s][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",l,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=l,e.push(["exit",l,t]),e}function iO(e,t,r){const n=this;let s;return i;function i(c){let d=n.events.length,h;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){h=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),s=c,l(c)):r(c)}function l(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===s?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),ze(c)?Ke(e,u,"lineSuffix")(c):u(c))}function u(c){return c===null||Se(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const lO={tokenize:oO};function oO(e){const t=this,r=e.attempt(cc,n,e.attempt(this.parser.constructs.flowInitial,s,Ke(e,e.attempt(this.parser.constructs.flow,s,e.attempt(fL,s)),"linePrefix")));return r;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const uO={resolveAll:MN()},cO=DN("string"),dO=DN("text");function DN(e){return{resolveAll:MN(e==="text"?hO:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],i=r.attempt(s,l,o);return l;function l(d){return c(d)?i(d):o(d)}function o(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),u}function u(d){return c(d)?(r.exit("data"),i(d)):(r.consume(d),u)}function c(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const g=h[f];if(!g.previous||g.previous.call(n,n.previous))return!0}return!1}}}function MN(e){return t;function t(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(r,n):r}}function hO(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let i=s.length,l=-1,o=0,u;for(;i--;){const c=s[i];if(typeof c=="string"){for(l=c.length;c.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(c===-2)u=!0,o++;else if(c!==-1){i++;break}}if(o){const c={type:r===e.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:n.start._bufferIndex+l,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const fO={42:Cr,43:Cr,45:Cr,48:Cr,49:Cr,50:Cr,51:Cr,52:Cr,53:Cr,54:Cr,55:Cr,56:Cr,57:Cr,62:jN},mO={91:yL},pO={[-2]:em,[-1]:em,32:em},gO={35:kL,42:hd,45:[qb,hd],60:CL,61:qb,95:hd,96:$b,126:$b},xO={38:IN,92:AN},yO={[-5]:tm,[-4]:tm,[-3]:tm,33:WL,38:IN,42:Wp,60:[YR,PL],91:YL,92:[EL,AN],93:Og,95:Wp,96:lL},bO={null:[Wp,uO]},vO={null:[42,95]},wO={null:[]},EO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:vO,contentInitial:mO,disable:wO,document:fO,flow:gO,flowInitial:pO,insideSpan:bO,string:xO,text:yO},Symbol.toStringTag,{value:"Module"}));function NO(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let l=[],o=[];const u={attempt:I(k),check:I(S),consume:b,enter:E,exit:_,interrupt:I(S,{interrupt:!0})},c={code:null,containerState:{},defineSkip:y,events:[],now:p,parser:e,previous:null,sliceSerialize:f,sliceStream:g,write:h};let d=t.tokenize.call(c,u);return t.resolveAll&&i.push(t),c;function h(H){return l=nn(l,H),v(),l[l.length-1]!==null?[]:(A(t,0),c.events=$h(i,c.events,c),c.events)}function f(H,L){return _O(g(H),L)}function g(H){return kO(l,H)}function p(){const{_bufferIndex:H,_index:L,line:G,column:Q,offset:$}=n;return{_bufferIndex:H,_index:L,line:G,column:Q,offset:$}}function y(H){s[H.line]=H.column,T()}function v(){let H;for(;n._index<l.length;){const L=l[n._index];if(typeof L=="string")for(H=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===H&&n._bufferIndex<L.length;)x(L.charCodeAt(n._bufferIndex));else x(L)}}function x(H){d=d(H)}function b(H){Se(H)?(n.line++,n.column=1,n.offset+=H===-3?2:1,T()):H!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=H}function E(H,L){const G=L||{};return G.type=H,G.start=p(),c.events.push(["enter",G,c]),o.push(G),G}function _(H){const L=o.pop();return L.end=p(),c.events.push(["exit",L,c]),L}function k(H,L){A(H,L.from)}function S(H,L){L.restore()}function I(H,L){return G;function G(Q,$,V){let K,O,Z,N;return Array.isArray(Q)?U(Q):"tokenize"in Q?U([Q]):z(Q);function z(W){return q;function q(J){const te=J!==null&&W[J],de=J!==null&&W.null,ve=[...Array.isArray(te)?te:te?[te]:[],...Array.isArray(de)?de:de?[de]:[]];return U(ve)(J)}}function U(W){return K=W,O=0,W.length===0?V:j(W[O])}function j(W){return q;function q(J){return N=D(),Z=W,W.partial||(c.currentConstruct=W),W.name&&c.parser.constructs.disable.null.includes(W.name)?X():W.tokenize.call(L?Object.assign(Object.create(c),L):c,u,me,X)(J)}}function me(W){return H(Z,N),$}function X(W){return N.restore(),++O<K.length?j(K[O]):V}}}function A(H,L){H.resolveAll&&!i.includes(H)&&i.push(H),H.resolve&&Vr(c.events,L,c.events.length-L,H.resolve(c.events.slice(L),c)),H.resolveTo&&(c.events=H.resolveTo(c.events,c))}function D(){const H=p(),L=c.previous,G=c.currentConstruct,Q=c.events.length,$=Array.from(o);return{from:Q,restore:V};function V(){n=H,c.previous=L,c.currentConstruct=G,c.events.length=Q,o=$,T()}}function T(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function kO(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let l;if(r===s)l=[e[r].slice(n,i)];else{if(l=e.slice(r,s),n>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(n):l.shift()}i>0&&l.push(e[s].slice(0,i))}return l}function _O(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const i=e[r];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&s)continue;l=" ";break}default:l=String.fromCharCode(i)}s=i===-2,n.push(l)}return n.join("")}function SO(e){const n={constructs:TN([EO,...(e||{}).extensions||[]]),content:s(HR),defined:[],document:s(zR),flow:s(lO),lazy:{},string:s(cO),text:s(dO)};return n;function s(i){return l;function l(o){return NO(n,i,o)}}}function TO(e){for(;!RN(e););return e}const Vb=/[\0\t\n\r]/g;function CO(){let e=1,t="",r=!0,n;return s;function s(i,l,o){const u=[];let c,d,h,f,g;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),h=0,t="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if(Vb.lastIndex=h,c=Vb.exec(i),f=c&&c.index!==void 0?c.index:i.length,g=i.charCodeAt(f),!c){t=i.slice(h);break}if(g===10&&h===f&&n)u.push(-3),n=void 0;else switch(n&&(u.push(-5),n=void 0),h<f&&(u.push(i.slice(h,f)),e+=f-h),g){case 0:{u.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,u.push(-2);e++<d;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:n=!0,e=1}h=f+1}return o&&(n&&u.push(-5),t&&u.push(t),u.push(null)),u}}const jO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function AO(e){return e.replace(jO,IO)}function IO(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return CN(r.slice(i?2:1),i?16:10)}return Lg(r)||e}const FN={}.hasOwnProperty;function RO(e,t,r){return typeof t!="string"&&(r=t,t=void 0),LO(r)(TO(SO(r).document().write(CO()(e,t,!0))))}function LO(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(mr),autolinkProtocol:D,autolinkEmail:D,atxHeading:i(tt),blockQuote:i(de),characterEscape:D,characterReference:D,codeFenced:i(ve),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(ve,l),codeText:i(Ae,l),codeTextData:D,data:D,codeFlowValue:D,definition:i(we),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Ze),hardBreakEscape:i(ct),hardBreakTrailing:i(ct),htmlFlow:i(rt,l),htmlFlowData:D,htmlText:i(rt,l),htmlTextData:D,image:i(Zt),label:l,link:i(mr),listItem:i(no),listItemValue:f,listOrdered:i(At,h),listUnordered:i(At),paragraph:i(js),reference:j,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i(tt),strong:i(Re),thematicBreak:i(so)},exit:{atxHeading:u(),atxHeadingSequence:k,autolink:u(),autolinkEmail:te,autolinkProtocol:J,blockQuote:u(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:X,characterReferenceMarkerNumeric:X,characterReferenceValue:W,characterReference:q,codeFenced:u(v),codeFencedFence:y,codeFencedFenceInfo:g,codeFencedFenceMeta:p,codeFlowValue:T,codeIndented:u(x),codeText:u($),codeTextData:T,data:T,definition:u(),definitionDestinationString:_,definitionLabelString:b,definitionTitleString:E,emphasis:u(),hardBreakEscape:u(L),hardBreakTrailing:u(L),htmlFlow:u(G),htmlFlowData:T,htmlText:u(Q),htmlTextData:T,image:u(K),label:Z,labelText:O,lineEnding:H,link:u(V),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:me,resourceDestinationString:N,resourceTitleString:z,resource:U,setextHeading:u(A),setextHeadingLineSequence:I,setextHeadingText:S,strong:u(),thematicBreak:u()}};BN(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(re){let ce={type:"root",children:[]};const Ce={stack:[ce],tokenStack:[],config:t,enter:o,exit:c,buffer:l,resume:d,data:r},Le=[];let Xe=-1;for(;++Xe<re.length;)if(re[Xe][1].type==="listOrdered"||re[Xe][1].type==="listUnordered")if(re[Xe][0]==="enter")Le.push(Xe);else{const pr=Le.pop();Xe=s(re,pr,Xe)}for(Xe=-1;++Xe<re.length;){const pr=t[re[Xe][0]];FN.call(pr,re[Xe][1].type)&&pr[re[Xe][1].type].call(Object.assign({sliceSerialize:re[Xe][2].sliceSerialize},Ce),re[Xe][1])}if(Ce.tokenStack.length>0){const pr=Ce.tokenStack[Ce.tokenStack.length-1];(pr[1]||Wb).call(Ce,void 0,pr[0])}for(ce.position={start:Ds(re.length>0?re[0][1].start:{line:1,column:1,offset:0}),end:Ds(re.length>0?re[re.length-2][1].end:{line:1,column:1,offset:0})},Xe=-1;++Xe<t.transforms.length;)ce=t.transforms[Xe](ce)||ce;return ce}function s(re,ce,Ce){let Le=ce-1,Xe=-1,pr=!1,fn,kr,mn,rr;for(;++Le<=Ce;){const Tt=re[Le];switch(Tt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Tt[0]==="enter"?Xe++:Xe--,rr=void 0;break}case"lineEndingBlank":{Tt[0]==="enter"&&(fn&&!rr&&!Xe&&!mn&&(mn=Le),rr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:rr=void 0}if(!Xe&&Tt[0]==="enter"&&Tt[1].type==="listItemPrefix"||Xe===-1&&Tt[0]==="exit"&&(Tt[1].type==="listUnordered"||Tt[1].type==="listOrdered")){if(fn){let pn=Le;for(kr=void 0;pn--;){const _r=re[pn];if(_r[1].type==="lineEnding"||_r[1].type==="lineEndingBlank"){if(_r[0]==="exit")continue;kr&&(re[kr][1].type="lineEndingBlank",pr=!0),_r[1].type="lineEnding",kr=pn}else if(!(_r[1].type==="linePrefix"||_r[1].type==="blockQuotePrefix"||_r[1].type==="blockQuotePrefixWhitespace"||_r[1].type==="blockQuoteMarker"||_r[1].type==="listItemIndent"))break}mn&&(!kr||mn<kr)&&(fn._spread=!0),fn.end=Object.assign({},kr?re[kr][1].start:Tt[1].end),re.splice(kr||Le,0,["exit",fn,Tt[2]]),Le++,Ce++}if(Tt[1].type==="listItemPrefix"){const pn={type:"listItem",_spread:!1,start:Object.assign({},Tt[1].start),end:void 0};fn=pn,re.splice(Le,0,["enter",pn,Tt[2]]),Le++,Ce++,mn=void 0,rr=!0}}}return re[ce][1]._spread=pr,Ce}function i(re,ce){return Ce;function Ce(Le){o.call(this,re(Le),Le),ce&&ce.call(this,Le)}}function l(){this.stack.push({type:"fragment",children:[]})}function o(re,ce,Ce){this.stack[this.stack.length-1].children.push(re),this.stack.push(re),this.tokenStack.push([ce,Ce||void 0]),re.position={start:Ds(ce.start),end:void 0}}function u(re){return ce;function ce(Ce){re&&re.call(this,Ce),c.call(this,Ce)}}function c(re,ce){const Ce=this.stack.pop(),Le=this.tokenStack.pop();if(Le)Le[0].type!==re.type&&(ce?ce.call(this,re,Le[0]):(Le[1]||Wb).call(this,re,Le[0]));else throw new Error("Cannot close `"+re.type+"` ("+Zo({start:re.start,end:re.end})+"): its not open");Ce.position.end=Ds(re.end)}function d(){return Rg(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(re){if(this.data.expectingFirstListItemValue){const ce=this.stack[this.stack.length-2];ce.start=Number.parseInt(this.sliceSerialize(re),10),this.data.expectingFirstListItemValue=void 0}}function g(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.lang=re}function p(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.meta=re}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.value=re.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.value=re.replace(/(\r?\n|\r)$/g,"")}function b(re){const ce=this.resume(),Ce=this.stack[this.stack.length-1];Ce.label=ce,Ce.identifier=In(this.sliceSerialize(re)).toLowerCase()}function E(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.title=re}function _(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.url=re}function k(re){const ce=this.stack[this.stack.length-1];if(!ce.depth){const Ce=this.sliceSerialize(re).length;ce.depth=Ce}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function I(re){const ce=this.stack[this.stack.length-1];ce.depth=this.sliceSerialize(re).codePointAt(0)===61?1:2}function A(){this.data.setextHeadingSlurpLineEnding=void 0}function D(re){const Ce=this.stack[this.stack.length-1].children;let Le=Ce[Ce.length-1];(!Le||Le.type!=="text")&&(Le=dt(),Le.position={start:Ds(re.start),end:void 0},Ce.push(Le)),this.stack.push(Le)}function T(re){const ce=this.stack.pop();ce.value+=this.sliceSerialize(re),ce.position.end=Ds(re.end)}function H(re){const ce=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ce=ce.children[ce.children.length-1];Ce.position.end=Ds(re.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(ce.type)&&(D.call(this,re),T.call(this,re))}function L(){this.data.atHardBreak=!0}function G(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.value=re}function Q(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.value=re}function $(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.value=re}function V(){const re=this.stack[this.stack.length-1];if(this.data.inReference){const ce=this.data.referenceType||"shortcut";re.type+="Reference",re.referenceType=ce,delete re.url,delete re.title}else delete re.identifier,delete re.label;this.data.referenceType=void 0}function K(){const re=this.stack[this.stack.length-1];if(this.data.inReference){const ce=this.data.referenceType||"shortcut";re.type+="Reference",re.referenceType=ce,delete re.url,delete re.title}else delete re.identifier,delete re.label;this.data.referenceType=void 0}function O(re){const ce=this.sliceSerialize(re),Ce=this.stack[this.stack.length-2];Ce.label=AO(ce),Ce.identifier=In(ce).toLowerCase()}function Z(){const re=this.stack[this.stack.length-1],ce=this.resume(),Ce=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ce.type==="link"){const Le=re.children;Ce.children=Le}else Ce.alt=ce}function N(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.url=re}function z(){const re=this.resume(),ce=this.stack[this.stack.length-1];ce.title=re}function U(){this.data.inReference=void 0}function j(){this.data.referenceType="collapsed"}function me(re){const ce=this.resume(),Ce=this.stack[this.stack.length-1];Ce.label=ce,Ce.identifier=In(this.sliceSerialize(re)).toLowerCase(),this.data.referenceType="full"}function X(re){this.data.characterReferenceType=re.type}function W(re){const ce=this.sliceSerialize(re),Ce=this.data.characterReferenceType;let Le;Ce?(Le=CN(ce,Ce==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Le=Lg(ce);const Xe=this.stack[this.stack.length-1];Xe.value+=Le}function q(re){const ce=this.stack.pop();ce.position.end=Ds(re.end)}function J(re){T.call(this,re);const ce=this.stack[this.stack.length-1];ce.url=this.sliceSerialize(re)}function te(re){T.call(this,re);const ce=this.stack[this.stack.length-1];ce.url="mailto:"+this.sliceSerialize(re)}function de(){return{type:"blockquote",children:[]}}function ve(){return{type:"code",lang:null,meta:null,value:""}}function Ae(){return{type:"inlineCode",value:""}}function we(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ze(){return{type:"emphasis",children:[]}}function tt(){return{type:"heading",depth:0,children:[]}}function ct(){return{type:"break"}}function rt(){return{type:"html",value:""}}function Zt(){return{type:"image",title:null,url:"",alt:null}}function mr(){return{type:"link",title:null,url:"",children:[]}}function At(re){return{type:"list",ordered:re.type==="listOrdered",start:null,spread:re._spread,children:[]}}function no(re){return{type:"listItem",spread:re._spread,checked:null,children:[]}}function js(){return{type:"paragraph",children:[]}}function Re(){return{type:"strong",children:[]}}function dt(){return{type:"text",value:""}}function so(){return{type:"thematicBreak"}}}function Ds(e){return{line:e.line,column:e.column,offset:e.offset}}function BN(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?BN(e,n):OO(e,n)}}function OO(e,t){let r;for(r in t)if(FN.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function Wb(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Zo({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Zo({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Zo({start:t.start,end:t.end})+") is still open")}function PO(e){const t=this;t.parser=r;function r(n){return RO(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function DO(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function MO(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function FO(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function BO(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function UO(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function HO(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=Jl(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let l,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,u);const c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)}function $O(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function zO(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function UN(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const l=s[s.length-1];return l&&l.type==="text"?l.value+=n:s.push({type:"text",value:n}),s}function qO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return UN(e,t);const s={src:Jl(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function VO(e,t){const r={src:Jl(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function WO(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function GO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return UN(e,t);const s={href:Jl(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function YO(e,t){const r={href:Jl(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function QO(e,t,r){const n=e.all(t),s=r?KO(r):HN(t),i={},l=[];if(typeof t.checked=="boolean"){const d=n[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const d=n[o];(s||o!==0||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?l.push(...d.children):l.push(d)}const u=n[n.length-1];u&&(s||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,c),e.applyData(t,c)}function KO(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=HN(r[n])}return t}function HN(e){const t=e.spread;return t??e.children.length>1}function ZO(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const l=n[s];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function XO(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function JO(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function eP(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function tP(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],l),s.push(l)}if(r.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=es(t.children[1]),u=Uh(t.children[t.children.length-1]);o&&u&&(l.position={start:o,end:u}),s.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function rP(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",l=r&&r.type==="table"?r.align:void 0,o=l?l.length:t.children.length;let u=-1;const c=[];for(;++u<o;){const h=t.children[u],f={},g=l?l[u]:void 0;g&&(f.align=g);let p={type:"element",tagName:i,properties:f,children:[]};h&&(p.children=e.all(h),e.patch(h,p),p=e.applyData(h,p)),c.push(p)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,d),e.applyData(t,d)}function nP(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const Gb=9,Yb=32;function sP(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const i=[];for(;n;)i.push(Qb(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return i.push(Qb(t.slice(s),s>0,!1)),i.join("")}function Qb(e,t,r){let n=0,s=e.length;if(t){let i=e.codePointAt(n);for(;i===Gb||i===Yb;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(s-1);for(;i===Gb||i===Yb;)s--,i=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function aP(e,t){const r={type:"text",value:sP(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function iP(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const lP={blockquote:DO,break:MO,code:FO,delete:BO,emphasis:UO,footnoteReference:HO,heading:$O,html:zO,imageReference:qO,image:VO,inlineCode:WO,linkReference:GO,link:YO,listItem:QO,list:ZO,paragraph:XO,root:JO,strong:eP,table:tP,tableCell:nP,tableRow:rP,text:aP,thematicBreak:iP,toml:Gc,yaml:Gc,definition:Gc,footnoteDefinition:Gc};function Gc(){}const $N=-1,zh=0,Jo=1,Kd=2,Pg=3,Dg=4,Mg=5,Fg=6,zN=7,qN=8,Kb=typeof self=="object"?self:globalThis,oP=(e,t)=>{const r=(s,i)=>(e.set(i,s),s),n=s=>{if(e.has(s))return e.get(s);const[i,l]=t[s];switch(i){case zh:case $N:return r(l,s);case Jo:{const o=r([],s);for(const u of l)o.push(n(u));return o}case Kd:{const o=r({},s);for(const[u,c]of l)o[n(u)]=n(c);return o}case Pg:return r(new Date(l),s);case Dg:{const{source:o,flags:u}=l;return r(new RegExp(o,u),s)}case Mg:{const o=r(new Map,s);for(const[u,c]of l)o.set(n(u),n(c));return o}case Fg:{const o=r(new Set,s);for(const u of l)o.add(n(u));return o}case zN:{const{name:o,message:u}=l;return r(new Kb[o](u),s)}case qN:return r(BigInt(l),s);case"BigInt":return r(Object(BigInt(l)),s);case"ArrayBuffer":return r(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return r(new DataView(o),l)}}return r(new Kb[i](l),s)};return n},Zb=e=>oP(new Map,e)(0),Pi="",{toString:uP}={},{keys:cP}=Object,No=e=>{const t=typeof e;if(t!=="object"||!e)return[zh,t];const r=uP.call(e).slice(8,-1);switch(r){case"Array":return[Jo,Pi];case"Object":return[Kd,Pi];case"Date":return[Pg,Pi];case"RegExp":return[Dg,Pi];case"Map":return[Mg,Pi];case"Set":return[Fg,Pi];case"DataView":return[Jo,r]}return r.includes("Array")?[Jo,r]:r.includes("Error")?[zN,r]:[Kd,r]},Yc=([e,t])=>e===zh&&(t==="function"||t==="symbol"),dP=(e,t,r,n)=>{const s=(l,o)=>{const u=n.push(l)-1;return r.set(o,u),u},i=l=>{if(r.has(l))return r.get(l);let[o,u]=No(l);switch(o){case zh:{let d=l;switch(u){case"bigint":o=qN,d=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);d=null;break;case"undefined":return s([$N],l)}return s([o,d],l)}case Jo:{if(u){let f=l;return u==="DataView"?f=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(f=new Uint8Array(l)),s([u,[...f]],l)}const d=[],h=s([o,d],l);for(const f of l)d.push(i(f));return h}case Kd:{if(u)switch(u){case"BigInt":return s([u,l.toString()],l);case"Boolean":case"Number":case"String":return s([u,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const d=[],h=s([o,d],l);for(const f of cP(l))(e||!Yc(No(l[f])))&&d.push([i(f),i(l[f])]);return h}case Pg:return s([o,l.toISOString()],l);case Dg:{const{source:d,flags:h}=l;return s([o,{source:d,flags:h}],l)}case Mg:{const d=[],h=s([o,d],l);for(const[f,g]of l)(e||!(Yc(No(f))||Yc(No(g))))&&d.push([i(f),i(g)]);return h}case Fg:{const d=[],h=s([o,d],l);for(const f of l)(e||!Yc(No(f)))&&d.push(i(f));return h}}const{message:c}=l;return s([o,{name:u,message:c}],l)};return i},Xb=(e,{json:t,lossy:r}={})=>{const n=[];return dP(!(t||r),!!t,new Map,n)(e),n},gi=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Zb(Xb(e,t)):structuredClone(e):(e,t)=>Zb(Xb(e,t));function hP(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function fP(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function mP(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||hP,n=e.options.footnoteBackLabel||fP,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[u]);if(!c)continue;const d=e.all(c),h=String(c.identifier).toUpperCase(),f=Jl(h.toLowerCase());let g=0;const p=[],y=e.footnoteCounts.get(h);for(;y!==void 0&&++g<=y;){p.length>0&&p.push({type:"text",value:" "});let b=typeof r=="string"?r:r(u,g);typeof b=="string"&&(b={type:"text",value:b}),p.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,g),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const v=d[d.length-1];if(v&&v.type==="element"&&v.tagName==="p"){const b=v.children[v.children.length-1];b&&b.type==="text"?b.value+=" ":v.children.push({type:"text",value:" "}),v.children.push(...p)}else d.push(...p);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(c,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...gi(l),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const qh=function(e){if(e==null)return yP;if(typeof e=="function")return Vh(e);if(typeof e=="object")return Array.isArray(e)?pP(e):gP(e);if(typeof e=="string")return xP(e);throw new Error("Expected function, string, or object as test")};function pP(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=qh(e[r]);return Vh(n);function n(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function gP(e){const t=e;return Vh(r);function r(n){const s=n;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function xP(e){return Vh(t);function t(r){return r&&r.type===e}}function Vh(e){return t;function t(r,n,s){return!!(bP(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function yP(){return!0}function bP(e){return e!==null&&typeof e=="object"&&"type"in e}const VN=[],vP=!0,Gp=!1,wP="skip";function WN(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const i=qh(s),l=n?-1:1;o(e,void 0,[])();function o(u,c,d){const h=u&&typeof u=="object"?u:{};if(typeof h.type=="string"){const g=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(u.type+(g?"<"+g+">":""))+")"})}return f;function f(){let g=VN,p,y,v;if((!t||i(u,c,d[d.length-1]||void 0))&&(g=EP(r(u,d)),g[0]===Gp))return g;if("children"in u&&u.children){const x=u;if(x.children&&g[0]!==wP)for(y=(n?x.children.length:-1)+l,v=d.concat(x);y>-1&&y<x.children.length;){const b=x.children[y];if(p=o(b,y,v)(),p[0]===Gp)return p;y=typeof p[1]=="number"?p[1]:y+l}}return g}}}function EP(e){return Array.isArray(e)?e:typeof e=="number"?[vP,e]:e==null?VN:[e]}function Wh(e,t,r,n){let s,i,l;typeof t=="function"&&typeof r!="function"?(i=void 0,l=t,s=r):(i=t,l=r,s=n),WN(e,i,o,s);function o(u,c){const d=c[c.length-1],h=d?d.children.indexOf(u):void 0;return l(u,h,d)}}const Yp={}.hasOwnProperty,NP={};function kP(e,t){const r=t||NP,n=new Map,s=new Map,i=new Map,l={...lP,...r.handlers},o={all:c,applyData:SP,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:u,options:r,patch:_P,wrap:CP};return Wh(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?n:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),o;function u(d,h){const f=d.type,g=o.handlers[f];if(Yp.call(o.handlers,f)&&g)return g(o,d,h);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in d){const{children:y,...v}=d,x=gi(v);return x.children=o.all(d),x}return gi(d)}return(o.options.unknownHandler||TP)(o,d,h)}function c(d){const h=[];if("children"in d){const f=d.children;let g=-1;for(;++g<f.length;){const p=o.one(f[g],d);if(p){if(g&&f[g-1].type==="break"&&(!Array.isArray(p)&&p.type==="text"&&(p.value=Jb(p.value)),!Array.isArray(p)&&p.type==="element")){const y=p.children[0];y&&y.type==="text"&&(y.value=Jb(y.value))}Array.isArray(p)?h.push(...p):h.push(p)}}}return h}}function _P(e,t){e.position&&(t.position=wN(e))}function SP(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const l="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:l}}r.type==="element"&&i&&Object.assign(r.properties,gi(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function TP(e,t){const r=t.data||{},n="value"in t&&!(Yp.call(r,"hProperties")||Yp.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function CP(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function Jb(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function e1(e,t){const r=kP(e,t),n=r.one(e,void 0),s=mP(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function jP(e,t){return e&&"run"in e?async function(r,n){const s=e1(r,{file:n,...t});await e.run(s,n)}:function(r,n){return e1(r,{file:n,...e||t})}}function t1(e){if(e)throw e}var fd=Object.prototype.hasOwnProperty,GN=Object.prototype.toString,r1=Object.defineProperty,n1=Object.getOwnPropertyDescriptor,s1=function(t){return typeof Array.isArray=="function"?Array.isArray(t):GN.call(t)==="[object Array]"},a1=function(t){if(!t||GN.call(t)!=="[object Object]")return!1;var r=fd.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&fd.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||fd.call(t,s)},i1=function(t,r){r1&&r.name==="__proto__"?r1(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},l1=function(t,r){if(r==="__proto__")if(fd.call(t,r)){if(n1)return n1(t,r).value}else return;return t[r]},AP=function e(){var t,r,n,s,i,l,o=arguments[0],u=1,c=arguments.length,d=!1;for(typeof o=="boolean"&&(d=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=l1(o,r),s=l1(t,r),o!==s&&(d&&s&&(a1(s)||(i=s1(s)))?(i?(i=!1,l=n&&s1(n)?n:[]):l=n&&a1(n)?n:{},i1(o,{name:r,newValue:e(d,l,s)})):typeof s<"u"&&i1(o,{name:r,newValue:s}));return o};const rm=oh(AP);function Qp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function IP(){const e=[],t={run:r,use:n};return t;function r(...s){let i=-1;const l=s.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...s);function o(u,...c){const d=e[++i];let h=-1;if(u){l(u);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,d?RP(d,o)(...c):l(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function RP(e,t){let r;return n;function n(...l){const o=e.length>l.length;let u;o&&l.push(s);try{u=e.apply(this,l)}catch(c){const d=c;if(o&&r)throw d;return s(d)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,s):u instanceof Error?s(u):i(u))}function s(l,...o){r||(r=!0,t(l,...o))}function i(l){s(null,l)}}const Hn={basename:LP,dirname:OP,extname:PP,join:DP,sep:"/"};function LP(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');dc(e);let r=0,n=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let l=-1,o=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else l<0&&(i=!0,l=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(n=s):(o=-1,n=l));return r===n?n=l:n<0&&(n=e.length),e.slice(r,n)}function OP(e){if(dc(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function PP(e){dc(e);let t=e.length,r=-1,n=0,s=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){n=t+1;break}continue}r<0&&(l=!0,r=t+1),o===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function DP(...e){let t=-1,r;for(;++t<e.length;)dc(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":MP(r)}function MP(e){dc(e);const t=e.codePointAt(0)===47;let r=FP(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function FP(e,t){let r="",n=0,s=-1,i=0,l=-1,o,u;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(u=r.lastIndexOf("/"),u!==r.length-1){u<0?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf("/")),s=l,i=0;continue}}else if(r.length>0){r="",n=0,s=l,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),n=l-s-1;s=l,i=0}else o===46&&i>-1?i++:i=-1}return r}function dc(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const BP={cwd:UP};function UP(){return"/"}function Kp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function HP(e){if(typeof e=="string")e=new URL(e);else if(!Kp(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return $P(e)}function $P(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const nm=["history","path","basename","stem","extname","dirname"];class YN{constructor(t){let r;t?Kp(t)?r={path:t}:typeof t=="string"||zP(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":BP.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<nm.length;){const i=nm[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)nm.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?Hn.basename(this.path):void 0}set basename(t){am(t,"basename"),sm(t,"basename"),this.path=Hn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Hn.dirname(this.path):void 0}set dirname(t){o1(this.basename,"dirname"),this.path=Hn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Hn.extname(this.path):void 0}set extname(t){if(sm(t,"extname"),o1(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Hn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Kp(t)&&(t=HP(t)),am(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Hn.basename(this.path,this.extname):void 0}set stem(t){am(t,"stem"),sm(t,"stem"),this.path=Hn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new hr(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function sm(e,t){if(e&&e.includes(Hn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Hn.sep+"`")}function am(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function o1(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function zP(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const qP=function(e){const n=this.constructor.prototype,s=n[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},VP={}.hasOwnProperty;class Bg extends qP{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=IP()}copy(){const t=new Bg;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(rm(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(om("data",this.frozen),this.namespace[t]=r,this):VP.call(this.namespace,t)&&this.namespace[t]||void 0:t?(om("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=Qc(t),n=this.parser||this.Parser;return im("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),im("process",this.parser||this.Parser),lm("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,l){const o=Qc(t),u=n.parse(o);n.run(u,o,function(d,h,f){if(d||!h||!f)return c(d);const g=h,p=n.stringify(g,f);YP(p)?f.value=p:f.result=p,c(d,f)});function c(d,h){d||!h?l(d):i?i(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),im("processSync",this.parser||this.Parser),lm("processSync",this.compiler||this.Compiler),this.process(t,s),c1("processSync","process",r),n;function s(i,l){r=!0,t1(i),n=l}}run(t,r,n){u1(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(l,o){const u=Qc(r);s.run(t,u,c);function c(d,h,f){const g=h||t;d?o(d):l?l(g):n(void 0,g,f)}}}runSync(t,r){let n=!1,s;return this.run(t,r,i),c1("runSync","run",n),s;function i(l,o){t1(l),s=o,n=!0}}stringify(t,r){this.freeze();const n=Qc(r),s=this.compiler||this.Compiler;return lm("stringify",s),u1(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(om("use",this.frozen),t!=null)if(typeof t=="function")u(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")u(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...h]=c;u(d,h)}else l(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function l(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(s.settings=rm(!0,s.settings,c.settings))}function o(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const h=c[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function u(c,d){let h=-1,f=-1;for(;++h<n.length;)if(n[h][0]===c){f=h;break}if(f===-1)n.push([c,...d]);else if(d.length>0){let[g,...p]=d;const y=n[f][1];Qp(y)&&Qp(g)&&(g=rm(!0,y,g)),n[f]=[c,g,...p]}}}}const WP=new Bg().freeze();function im(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function lm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function om(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function u1(e){if(!Qp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function c1(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Qc(e){return GP(e)?e:new YN(e)}function GP(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function YP(e){return typeof e=="string"||QP(e)}function QP(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const KP="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",d1=[],h1={allowDangerousHtml:!0},ZP=/^(https?|ircs?|mailto|xmpp)$/i,XP=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function QN(e){const t=e.allowedElements,r=e.allowElement,n=e.children||"",s=e.className,i=e.components,l=e.disallowedElements,o=e.rehypePlugins||d1,u=e.remarkPlugins||d1,c=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...h1}:h1,d=e.skipHtml,h=e.unwrapDisallowed,f=e.urlTransform||JP,g=WP().use(PO).use(u).use(jP,c).use(o),p=new YN;typeof n=="string"&&(p.value=n);for(const b of XP)Object.hasOwn(e,b.from)&&(""+b.from+(b.to?"use `"+b.to+"` instead":"remove it")+KP+b.id,void 0);const y=g.parse(p);let v=g.runSync(y,p);return s&&(v={type:"element",tagName:"div",properties:{className:s},children:v.type==="root"?v.children:[v]}),Wh(v,x),xR(v,{Fragment:a.Fragment,components:i,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function x(b,E,_){if(b.type==="raw"&&_&&typeof E=="number")return d?_.children.splice(E,1):_.children[E]={type:"text",value:b.value},E;if(b.type==="element"){let k;for(k in Jf)if(Object.hasOwn(Jf,k)&&Object.hasOwn(b.properties,k)){const S=b.properties[k],I=Jf[k];(I===null||I.includes(b.tagName))&&(b.properties[k]=f(String(S||""),k,b))}}if(b.type==="element"){let k=t?!t.includes(b.tagName):l?l.includes(b.tagName):!1;if(!k&&r&&typeof E=="number"&&(k=!r(b,E,_)),k&&_&&typeof E=="number")return h&&b.children?_.children.splice(E,1,...b.children):_.children.splice(E,1),E}}}function JP(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||ZP.test(e.slice(0,t))?e:""}function f1(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(t);for(;s!==-1;)n++,s=r.indexOf(t,s+t.length);return n}function eD(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function tD(e,t,r){const s=qh((r||{}).ignore||[]),i=rD(t);let l=-1;for(;++l<i.length;)WN(e,"text",o);function o(c,d){let h=-1,f;for(;++h<d.length;){const g=d[h],p=f?f.children:void 0;if(s(g,p?p.indexOf(g):void 0,f))return;f=g}if(f)return u(c,d)}function u(c,d){const h=d[d.length-1],f=i[l][0],g=i[l][1];let p=0;const v=h.children.indexOf(c);let x=!1,b=[];f.lastIndex=0;let E=f.exec(c.value);for(;E;){const _=E.index,k={index:E.index,input:E.input,stack:[...d,c]};let S=g(...E,k);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?f.lastIndex=_+1:(p!==_&&b.push({type:"text",value:c.value.slice(p,_)}),Array.isArray(S)?b.push(...S):S&&b.push(S),p=_+E[0].length,x=!0),!f.global)break;E=f.exec(c.value)}return x?(p<c.value.length&&b.push({type:"text",value:c.value.slice(p)}),h.children.splice(v,1,...b)):b=[c],v+b.length}}function rD(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let n=-1;for(;++n<r.length;){const s=r[n];t.push([nD(s[0]),sD(s[1])])}return t}function nD(e){return typeof e=="string"?new RegExp(eD(e),"g"):e}function sD(e){return typeof e=="function"?e:function(){return e}}const um="phrasing",cm=["autolink","link","image","label"];function aD(){return{transforms:[hD],enter:{literalAutolink:lD,literalAutolinkEmail:dm,literalAutolinkHttp:dm,literalAutolinkWww:dm},exit:{literalAutolink:dD,literalAutolinkEmail:cD,literalAutolinkHttp:oD,literalAutolinkWww:uD}}}function iD(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:um,notInConstruct:cm},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:um,notInConstruct:cm},{character:":",before:"[ps]",after:"\\/",inConstruct:um,notInConstruct:cm}]}}function lD(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function dm(e){this.config.enter.autolinkProtocol.call(this,e)}function oD(e){this.config.exit.autolinkProtocol.call(this,e)}function uD(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function cD(e){this.config.exit.autolinkEmail.call(this,e)}function dD(e){this.exit(e)}function hD(e){tD(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,fD],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),mD]],{ignore:["link","linkReference"]})}function fD(e,t,r,n,s){let i="";if(!KN(s)||(/^w/i.test(t)&&(r=t+r,t="",i="http://"),!pD(r)))return!1;const l=gD(r+n);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function mD(e,t,r,n){return!KN(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function pD(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function gD(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],n=r.indexOf(")");const s=f1(e,"(");let i=f1(e,")");for(;n!==-1&&s>i;)e+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[e,r]}function KN(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||pi(r)||Hh(r))&&(!t||r!==47)}ZN.peek=TD;function xD(){return{enter:{gfmFootnoteDefinition:bD,gfmFootnoteDefinitionLabelString:vD,gfmFootnoteCall:ND,gfmFootnoteCallString:kD},exit:{gfmFootnoteDefinition:ED,gfmFootnoteDefinitionLabelString:wD,gfmFootnoteCall:SD,gfmFootnoteCallString:_D}}}function yD(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:CD,footnoteReference:ZN}}}function bD(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function vD(){this.buffer()}function wD(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=In(this.sliceSerialize(e)).toLowerCase()}function ED(e){this.exit(e)}function ND(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function kD(){this.buffer()}function _D(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=In(this.sliceSerialize(e)).toLowerCase()}function SD(e){this.exit(e)}function ZN(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteReference"),o=r.enter("reference");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),l(),i+=s.move("]"),i}function TD(){return"["}function CD(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteDefinition"),o=r.enter("label");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),i+=s.move("]:"+(e.children&&e.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(e,s.current()),jD)),l(),i}function jD(e,t,r){return t===0?e:(r?"":"    ")+e}const AD=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];XN.peek=PD;function ID(){return{canContainEols:["delete"],enter:{strikethrough:LD},exit:{strikethrough:OD}}}function RD(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:AD}],handlers:{delete:XN}}}function LD(e){this.enter({type:"delete",children:[]},e)}function OD(e){this.exit(e)}function XN(e,t,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let l=s.move("~~");return l+=r.containerPhrasing(e,{...s.current(),before:l,after:"~"}),l+=s.move("~~"),i(),l}function PD(){return"~"}function DD(e){return e.length}function MD(e,t){const r=t||{},n=(r.align||[]).concat(),s=r.stringLength||DD,i=[],l=[],o=[],u=[];let c=0,d=-1;for(;++d<e.length;){const y=[],v=[];let x=-1;for(e[d].length>c&&(c=e[d].length);++x<e[d].length;){const b=FD(e[d][x]);if(r.alignDelimiters!==!1){const E=s(b);v[x]=E,(u[x]===void 0||E>u[x])&&(u[x]=E)}y.push(b)}l[d]=y,o[d]=v}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=m1(n[h]);else{const y=m1(n);for(;++h<c;)i[h]=y}h=-1;const f=[],g=[];for(;++h<c;){const y=i[h];let v="",x="";y===99?(v=":",x=":"):y===108?v=":":y===114&&(x=":");let b=r.alignDelimiters===!1?1:Math.max(1,u[h]-v.length-x.length);const E=v+"-".repeat(b)+x;r.alignDelimiters!==!1&&(b=v.length+b+x.length,b>u[h]&&(u[h]=b),g[h]=b),f[h]=E}l.splice(1,0,f),o.splice(1,0,g),d=-1;const p=[];for(;++d<l.length;){const y=l[d],v=o[d];h=-1;const x=[];for(;++h<c;){const b=y[h]||"";let E="",_="";if(r.alignDelimiters!==!1){const k=u[h]-(v[h]||0),S=i[h];S===114?E=" ".repeat(k):S===99?k%2?(E=" ".repeat(k/2+.5),_=" ".repeat(k/2-.5)):(E=" ".repeat(k/2),_=E):_=" ".repeat(k)}r.delimiterStart!==!1&&!h&&x.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&b==="")&&(r.delimiterStart!==!1||h)&&x.push(" "),r.alignDelimiters!==!1&&x.push(E),x.push(b),r.alignDelimiters!==!1&&x.push(_),r.padding!==!1&&x.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&x.push("|")}p.push(r.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return p.join(`
`)}function FD(e){return e==null?"":String(e)}function m1(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const p1={}.hasOwnProperty;function JN(e,t){const r=t||{};function n(s,...i){let l=n.invalid;const o=n.handlers;if(s&&p1.call(s,e)){const u=String(s[e]);l=p1.call(o,u)?o[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function BD(e,t,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const l=r.indentLines(r.containerFlow(e,i.current()),UD);return s(),l}function UD(e,t,r){return">"+(r?"":" ")+e}function HD(e,t){return g1(e,t.inConstruct,!0)&&!g1(e,t.notInConstruct,!1)}function g1(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function x1(e,t,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&HD(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function $D(e,t){const r=String(e);let n=r.indexOf(t),s=n,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>l&&(l=i):i=1,s=n+t.length,n=r.indexOf(t,s);return l}function zD(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function qD(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function VD(e,t,r,n){const s=qD(r),i=e.value||"",l=s==="`"?"GraveAccent":"Tilde";if(zD(e,r)){const h=r.enter("codeIndented"),f=r.indentLines(i,WD);return h(),f}const o=r.createTracker(n),u=s.repeat(Math.max($D(i,s)+1,3)),c=r.enter("codeFenced");let d=o.move(u);if(e.lang){const h=r.enter(`codeFencedLang${l}`);d+=o.move(r.safe(e.lang,{before:d,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=r.enter(`codeFencedMeta${l}`);d+=o.move(" "),d+=o.move(r.safe(e.meta,{before:d,after:`
`,encode:["`"],...o.current()})),h()}return d+=o.move(`
`),i&&(d+=o.move(i+`
`)),d+=o.move(u),c(),d}function WD(e,t,r){return(r?"":"    ")+e}function Ug(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function GD(e,t,r,n){const s=Ug(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("definition");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("[");return c+=u.move(r.safe(r.associationId(e),{before:c,after:"]",...u.current()})),c+=u.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),l(),c}function YD(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function Iu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Zd(e,t,r){const n=Ml(e),s=Ml(t);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}ek.peek=QD;function ek(e,t,r,n){const s=YD(r),i=r.enter("emphasis"),l=r.createTracker(n),o=l.move(s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Zd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Iu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Zd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Iu(h));const g=l.move(s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+g}function QD(e,t,r){return r.options.emphasis||"*"}function KD(e,t){let r=!1;return Wh(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,Gp}),!!((!e.depth||e.depth<3)&&Rg(e)&&(t.options.setext||r))}function ZD(e,t,r,n){const s=Math.max(Math.min(6,e.depth||1),1),i=r.createTracker(n);if(KD(e,r)){const d=r.enter("headingSetext"),h=r.enter("phrasing"),f=r.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const l="#".repeat(s),o=r.enter("headingAtx"),u=r.enter("phrasing");i.move(l+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=Iu(c.charCodeAt(0))+c.slice(1)),c=c?l+" "+c:l,r.options.closeAtx&&(c+=" "+l),u(),o(),c}tk.peek=XD;function tk(e){return e.value||""}function XD(){return"<"}rk.peek=JD;function rk(e,t,r,n){const s=Ug(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("image");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("![");return c+=u.move(r.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),l(),c}function JD(){return"!"}nk.peek=eM;function nk(e,t,r,n){const s=e.referenceType,i=r.enter("imageReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("![");const c=r.safe(e.alt,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function eM(){return"!"}sk.peek=tM;function sk(e,t,r){let n=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const l=r.unsafe[i],o=r.compilePattern(l);let u;if(l.atBreak)for(;u=o.exec(n);){let c=u.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(u.index+1)}}return s+n+s}function tM(){return"`"}function ak(e,t){const r=Rg(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}ik.peek=rM;function ik(e,t,r,n){const s=Ug(r),i=s==='"'?"Quote":"Apostrophe",l=r.createTracker(n);let o,u;if(ak(e,r)){const d=r.stack;r.stack=[],o=r.enter("autolink");let h=l.move("<");return h+=l.move(r.containerPhrasing(e,{before:h,after:">",...l.current()})),h+=l.move(">"),o(),r.stack=d,h}o=r.enter("link"),u=r.enter("label");let c=l.move("[");return c+=l.move(r.containerPhrasing(e,{before:c,after:"](",...l.current()})),c+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(u=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(e.title,{before:c,after:s,...l.current()})),c+=l.move(s),u()),c+=l.move(")"),o(),c}function rM(e,t,r){return ak(e,r)?"<":"["}lk.peek=nM;function lk(e,t,r,n){const s=e.referenceType,i=r.enter("linkReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("[");const c=r.containerPhrasing(e,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function nM(){return"["}function Hg(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function sM(e){const t=Hg(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function aM(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function ok(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function iM(e,t,r,n){const s=r.enter("list"),i=r.bulletCurrent;let l=e.ordered?aM(r):Hg(r);const o=e.ordered?l==="."?")":".":sM(r);let u=t&&r.bulletLastUsed?l===r.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&d&&(!d.children||!d.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(u=!0),ok(r)===l&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=o),r.bulletCurrent=l;const c=r.containerFlow(e,n);return r.bulletLastUsed=l,r.bulletCurrent=i,s(),c}function lM(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function oM(e,t,r,n){const s=lM(r);let i=r.bulletCurrent||Hg(r);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=r.createTracker(n);o.move(i+" ".repeat(l-i.length)),o.shift(l);const u=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),d);return u(),c;function d(h,f,g){return f?(g?"":" ".repeat(l))+h:(g?i:i+" ".repeat(l-i.length))+h}}function uM(e,t,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),l=r.containerPhrasing(e,n);return i(),s(),l}const cM=qh(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function dM(e,t,r,n){return(e.children.some(function(l){return cM(l)})?r.containerPhrasing:r.containerFlow).call(r,e,n)}function hM(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}uk.peek=fM;function uk(e,t,r,n){const s=hM(r),i=r.enter("strong"),l=r.createTracker(n),o=l.move(s+s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Zd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Iu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Zd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Iu(h));const g=l.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+g}function fM(e,t,r){return r.options.strong||"*"}function mM(e,t,r,n){return r.safe(e.value,n)}function pM(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function gM(e,t,r){const n=(ok(r)+(r.options.ruleSpaces?" ":"")).repeat(pM(r));return r.options.ruleSpaces?n.slice(0,-1):n}const ck={blockquote:BD,break:x1,code:VD,definition:GD,emphasis:ek,hardBreak:x1,heading:ZD,html:tk,image:rk,imageReference:nk,inlineCode:sk,link:ik,linkReference:lk,list:iM,listItem:oM,paragraph:uM,root:dM,strong:uk,text:mM,thematicBreak:gM};function xM(){return{enter:{table:yM,tableData:y1,tableHeader:y1,tableRow:vM},exit:{codeText:wM,table:bM,tableData:hm,tableHeader:hm,tableRow:hm}}}function yM(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function bM(e){this.exit(e),this.data.inTable=void 0}function vM(e){this.enter({type:"tableRow",children:[]},e)}function hm(e){this.exit(e)}function y1(e){this.enter({type:"tableCell",children:[]},e)}function wM(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,EM));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function EM(e,t){return t==="|"?t:e}function NM(e){const t=e||{},r=t.tableCellPadding,n=t.tablePipeAlign,s=t.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:l,tableCell:u,tableRow:o}};function l(g,p,y,v){return c(d(g,y,v),g.align)}function o(g,p,y,v){const x=h(g,y,v),b=c([x]);return b.slice(0,b.indexOf(`
`))}function u(g,p,y,v){const x=y.enter("tableCell"),b=y.enter("phrasing"),E=y.containerPhrasing(g,{...v,before:i,after:i});return b(),x(),E}function c(g,p){return MD(g,{align:p,alignDelimiters:n,padding:r,stringLength:s})}function d(g,p,y){const v=g.children;let x=-1;const b=[],E=p.enter("table");for(;++x<v.length;)b[x]=h(v[x],p,y);return E(),b}function h(g,p,y){const v=g.children;let x=-1;const b=[],E=p.enter("tableRow");for(;++x<v.length;)b[x]=u(v[x],g,p,y);return E(),b}function f(g,p,y){let v=ck.inlineCode(g,p,y);return y.stack.includes("tableCell")&&(v=v.replace(/\|/g,"\\$&")),v}}function kM(){return{exit:{taskListCheckValueChecked:b1,taskListCheckValueUnchecked:b1,paragraph:SM}}}function _M(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:TM}}}function b1(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function SM(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=t.children;let i=-1,l;for(;++i<s.length;){const o=s[i];if(o.type==="paragraph"){l=o;break}}l===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function TM(e,t,r,n){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=r.createTracker(n);i&&o.move(l);let u=ck.listItem(e,t,r,{...n,...o.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(d){return d+l}}function CM(){return[aD(),xD(),ID(),xM(),kM()]}function jM(e){return{extensions:[iD(),yD(),RD(),NM(e),_M()]}}const AM={tokenize:DM,partial:!0},dk={tokenize:MM,partial:!0},hk={tokenize:FM,partial:!0},fk={tokenize:BM,partial:!0},IM={tokenize:UM,partial:!0},mk={name:"wwwAutolink",tokenize:OM,previous:gk},pk={name:"protocolAutolink",tokenize:PM,previous:xk},Cs={name:"emailAutolink",tokenize:LM,previous:yk},ts={};function RM(){return{text:ts}}let Da=48;for(;Da<123;)ts[Da]=Cs,Da++,Da===58?Da=65:Da===91&&(Da=97);ts[43]=Cs;ts[45]=Cs;ts[46]=Cs;ts[95]=Cs;ts[72]=[Cs,pk];ts[104]=[Cs,pk];ts[87]=[Cs,mk];ts[119]=[Cs,mk];function LM(e,t,r){const n=this;let s,i;return l;function l(h){return!Zp(h)||!yk.call(n,n.previous)||$g(n.events)?r(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return Zp(h)?(e.consume(h),o):h===64?(e.consume(h),u):r(h)}function u(h){return h===46?e.check(IM,d,c)(h):h===45||h===95||lr(h)?(i=!0,e.consume(h),u):d(h)}function c(h){return e.consume(h),s=!0,u}function d(h){return i&&s&&br(n.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):r(h)}}function OM(e,t,r){const n=this;return s;function s(l){return l!==87&&l!==119||!gk.call(n,n.previous)||$g(n.events)?r(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(AM,e.attempt(dk,e.attempt(hk,i),r),r)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function PM(e,t,r){const n=this;let s="",i=!1;return l;function l(h){return(h===72||h===104)&&xk.call(n,n.previous)&&!$g(n.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),o):r(h)}function o(h){if(br(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),u}return r(h)}function u(h){return h===47?(e.consume(h),i?c:(i=!0,u)):r(h)}function c(h){return h===null||Qd(h)||ut(h)||pi(h)||Hh(h)?r(h):e.attempt(dk,e.attempt(hk,d),r)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function DM(e,t,r){let n=0;return s;function s(l){return(l===87||l===119)&&n<3?(n++,e.consume(l),s):l===46&&n===3?(e.consume(l),i):r(l)}function i(l){return l===null?r(l):t(l)}}function MM(e,t,r){let n,s,i;return l;function l(c){return c===46||c===95?e.check(fk,u,o)(c):c===null||ut(c)||pi(c)||c!==45&&Hh(c)?u(c):(i=!0,e.consume(c),l)}function o(c){return c===95?n=!0:(s=n,n=void 0),e.consume(c),l}function u(c){return s||n||!i?r(c):t(c)}}function FM(e,t){let r=0,n=0;return s;function s(l){return l===40?(r++,e.consume(l),s):l===41&&n<r?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(fk,t,i)(l):l===null||ut(l)||pi(l)?t(l):(e.consume(l),s)}function i(l){return l===41&&n++,e.consume(l),s}}function BM(e,t,r){return n;function n(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),n):o===38?(e.consume(o),i):o===93?(e.consume(o),s):o===60||o===null||ut(o)||pi(o)?t(o):r(o)}function s(o){return o===null||o===40||o===91||ut(o)||pi(o)?t(o):n(o)}function i(o){return br(o)?l(o):r(o)}function l(o){return o===59?(e.consume(o),n):br(o)?(e.consume(o),l):r(o)}}function UM(e,t,r){return n;function n(i){return e.consume(i),s}function s(i){return lr(i)?r(i):t(i)}}function gk(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||ut(e)}function xk(e){return!br(e)}function yk(e){return!(e===47||Zp(e))}function Zp(e){return e===43||e===45||e===46||e===95||lr(e)}function $g(e){let t=e.length,r=!1;for(;t--;){const n=e[t][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const HM={tokenize:QM,partial:!0};function $M(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:WM,continuation:{tokenize:GM},exit:YM}},text:{91:{name:"gfmFootnoteCall",tokenize:VM},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:zM,resolveTo:qM}}}}function zM(e,t,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let l;for(;s--;){const u=n.events[s][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return o;function o(u){if(!l||!l._balanced)return r(u);const c=In(n.sliceSerialize({start:l.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function qM(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[r+1],e[r+2],["enter",n,t],e[r+3],e[r+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",n,t]];return e.splice(r,e.length-r+1,...o),e}function VM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,l;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),u}function u(h){return h!==94?r(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!l||h===null||h===91||ut(h))return r(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(In(n.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(h)}return ut(h)||(l=!0),i++,e.consume(h),h===92?d:c}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,c):c(h)}}function WM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,l=0,o;return u;function u(p){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(p){return p===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):r(p)}function d(p){if(l>999||p===93&&!o||p===null||p===91||ut(p))return r(p);if(p===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return i=In(n.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return ut(p)||(o=!0),l++,e.consume(p),p===92?h:d}function h(p){return p===91||p===92||p===93?(e.consume(p),l++,d):d(p)}function f(p){return p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),s.includes(i)||s.push(i),Ke(e,g,"gfmFootnoteDefinitionWhitespace")):r(p)}function g(p){return t(p)}}function GM(e,t,r){return e.check(cc,t,e.attempt(HM,t,r))}function YM(e){e.exit("gfmFootnoteDefinition")}function QM(e,t,r){const n=this;return Ke(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):r(i)}}function KM(e){let r=(e||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(l,o){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let c=u;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[u][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[u][1].end)},h={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[u][1].start)},f=[["enter",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["enter",h,o]],g=o.parser.constructs.insideSpan.null;g&&Vr(f,f.length,0,$h(g,l.slice(c+1,u),o)),Vr(f,f.length,0,[["exit",h,o],["enter",l[u][1],o],["exit",l[u][1],o],["exit",d,o]]),Vr(l,c-1,u-c+3,f),u=c+f.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function i(l,o,u){const c=this.previous,d=this.events;let h=0;return f;function f(p){return c===126&&d[d.length-1][1].type!=="characterEscape"?u(p):(l.enter("strikethroughSequenceTemporary"),g(p))}function g(p){const y=Ml(c);if(p===126)return h>1?u(p):(l.consume(p),h++,g);if(h<2&&!r)return u(p);const v=l.exit("strikethroughSequenceTemporary"),x=Ml(p);return v._open=!x||x===2&&!!y,v._close=!y||y===2&&!!x,o(p)}}}class ZM{constructor(){this.map=[]}add(t,r,n){XM(this,t,r,n)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];n.push(t.slice()),t.length=0;let s=n.pop();for(;s;){for(const i of s)t.push(i);s=n.pop()}this.map.length=0}}function XM(e,t,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=r,e.map[s][2].push(...n);return}s+=1}e.map.push([t,r,n])}}function JM(e,t){let r=!1;const n=[];for(;t<e.length;){const s=e[t];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return n}function e8(){return{flow:{null:{name:"table",tokenize:t8,resolveAll:r8}}}}function t8(e,t,r){const n=this;let s=0,i=0,l;return o;function o(T){let H=n.events.length-1;for(;H>-1;){const Q=n.events[H][1].type;if(Q==="lineEnding"||Q==="linePrefix")H--;else break}const L=H>-1?n.events[H][1].type:null,G=L==="tableHead"||L==="tableRow"?S:u;return G===S&&n.parser.lazy[n.now().line]?r(T):G(T)}function u(T){return e.enter("tableHead"),e.enter("tableRow"),c(T)}function c(T){return T===124||(l=!0,i+=1),d(T)}function d(T){return T===null?r(T):Se(T)?i>1?(i=0,n.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),g):r(T):ze(T)?Ke(e,d,"whitespace")(T):(i+=1,l&&(l=!1,s+=1),T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),l=!0,d):(e.enter("data"),h(T)))}function h(T){return T===null||T===124||ut(T)?(e.exit("data"),d(T)):(e.consume(T),T===92?f:h)}function f(T){return T===92||T===124?(e.consume(T),h):h(T)}function g(T){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(T):(e.enter("tableDelimiterRow"),l=!1,ze(T)?Ke(e,p,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):p(T))}function p(T){return T===45||T===58?v(T):T===124?(l=!0,e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),y):k(T)}function y(T){return ze(T)?Ke(e,v,"whitespace")(T):v(T)}function v(T){return T===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),x):T===45?(i+=1,x(T)):T===null||Se(T)?_(T):k(T)}function x(T){return T===45?(e.enter("tableDelimiterFiller"),b(T)):k(T)}function b(T){return T===45?(e.consume(T),b):T===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),E):(e.exit("tableDelimiterFiller"),E(T))}function E(T){return ze(T)?Ke(e,_,"whitespace")(T):_(T)}function _(T){return T===124?p(T):T===null||Se(T)?!l||s!==i?k(T):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(T)):k(T)}function k(T){return r(T)}function S(T){return e.enter("tableRow"),I(T)}function I(T){return T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),I):T===null||Se(T)?(e.exit("tableRow"),t(T)):ze(T)?Ke(e,I,"whitespace")(T):(e.enter("data"),A(T))}function A(T){return T===null||T===124||ut(T)?(e.exit("data"),I(T)):(e.consume(T),T===92?D:A)}function D(T){return T===92||T===124?(e.consume(T),A):A(T)}}function r8(e,t){let r=-1,n=!0,s=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,u=0,c,d,h;const f=new ZM;for(;++r<e.length;){const g=e[r],p=g[1];g[0]==="enter"?p.type==="tableHead"?(o=!1,u!==0&&(v1(f,t,u,c,d),d=void 0,u=0),c={type:"table",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(r,0,[["enter",c,t]])):p.type==="tableRow"||p.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],l=[0,r+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(r,0,[["enter",d,t]])),s=p.type==="tableDelimiterRow"?2:d?3:1):s&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")?(n=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],h=Kc(f,t,i,s,void 0,h),i=[0,0,0,0]),l[2]=r)):p.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(l[0]=l[1],h=Kc(f,t,i,s,void 0,h)),i=l,l=[i[1],r,0,0])):p.type==="tableHead"?(o=!0,u=r):p.type==="tableRow"||p.type==="tableDelimiterRow"?(u=r,i[1]!==0?(l[0]=l[1],h=Kc(f,t,i,s,r,h)):l[1]!==0&&(h=Kc(f,t,l,s,r,h)),s=0):s&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")&&(l[3]=r)}for(u!==0&&v1(f,t,u,c,d),f.consume(t.events),r=-1;++r<t.events.length;){const g=t.events[r];g[0]==="enter"&&g[1].type==="table"&&(g[1]._align=JM(t.events,r))}return e}function Kc(e,t,r,n,s,i){const l=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(i.end=Object.assign({},Mi(t.events,r[0])),e.add(r[0],0,[["exit",i,t]]));const u=Mi(t.events,r[1]);if(i={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(r[1],0,[["enter",i,t]]),r[2]!==0){const c=Mi(t.events,r[2]),d=Mi(t.events,r[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(r[2],0,[["enter",h,t]]),n!==2){const f=t.events[r[2]],g=t.events[r[3]];if(f[1].end=Object.assign({},g[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const p=r[2]+1,y=r[3]-r[2]-1;e.add(p,y,[])}}e.add(r[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},Mi(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function v1(e,t,r,n,s){const i=[],l=Mi(t.events,r);s&&(s.end=Object.assign({},l),i.push(["exit",s,t])),n.end=Object.assign({},l),i.push(["exit",n,t]),e.add(r+1,0,i)}function Mi(e,t){const r=e[t],n=r[0]==="enter"?"start":"end";return r[1][n]}const n8={name:"tasklistCheck",tokenize:a8};function s8(){return{text:{91:n8}}}function a8(e,t,r){const n=this;return s;function s(u){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return ut(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):r(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(u)}function o(u){return Se(u)?t(u):ze(u)?e.check({tokenize:i8},t,r)(u):r(u)}}function i8(e,t,r){return Ke(e,n,"whitespace");function n(s){return s===null?r(s):t(s)}}function l8(e){return TN([RM(),$M(),KM(e),e8(),s8()])}const o8={};function bk(e){const t=this,r=e||o8,n=t.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),l=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(l8(r)),i.push(CM()),l.push(jM(r))}const w1=/[#.]/g;function u8(e,t){const r=e||"",n={};let s=0,i,l;for(;s<r.length;){w1.lastIndex=s;const o=w1.exec(r),u=r.slice(s,o?o.index:r.length);u&&(i?i==="#"?n.id=u:Array.isArray(n.className)?n.className.push(u):n.className=[u]:l=u,s+=u.length),o&&(i=o[0],s++)}return{type:"element",tagName:l||t||"div",properties:n,children:[]}}const Xp={}.hasOwnProperty;function vk(e,t,r){const n=r&&f8(r);function s(i,l,...o){let u=-1,c;if(i==null){c={type:"root",children:[]};const d=l;o.unshift(d)}else if(c=u8(i,t),c.tagName=c.tagName.toLowerCase(),n&&Xp.call(n,c.tagName)&&(c.tagName=n[c.tagName]),c8(l))o.unshift(l);else{let d;for(d in l)Xp.call(l,d)&&d8(e,c.properties,d,l[d])}for(;++u<o.length;)Jp(c.children,o[u]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function c8(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,r=Object.keys(e);for(const n of r){const s=t[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function d8(e,t,r,n){const s=Bh(e,r);let i=-1,l;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;l=n}else typeof n=="boolean"?l=n:typeof n=="string"?s.spaceSeparated?l=Cb(n):s.commaSeparated?l=Nb(n):s.commaOrSpaceSeparated?l=Cb(Nb(n).join(" ")):l=E1(s,s.property,n):Array.isArray(n)?l=n.concat():l=s.property==="style"?h8(n):String(n);if(Array.isArray(l)){const o=[];for(;++i<l.length;){const u=E1(s,s.property,l[i]);o[i]=u}l=o}if(s.property==="className"&&Array.isArray(t.className)){const o=l;l=t.className.concat(o)}t[s.property]=l}}function Jp(e,t){let r=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)Jp(e,t[r]);else if(typeof t=="object"&&"type"in t)t.type==="root"?Jp(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function E1(e,t,r){if(typeof r=="string"){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(r===""||ju(r)===ju(t)))return!0}return r}function h8(e){const t=[];let r;for(r in e)Xp.call(e,r)&&t.push([r,e[r]].join(": "));return t.join("; ")}function f8(e){const t={};let r=-1;for(;++r<e.length;)t[e[r].toLowerCase()]=e[r];return t}const m8=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],p8=vk(uc,"div"),g8=vk(Ra,"g",m8);function x8(e){const t=String(e),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=r[l];if(o===void 0){const u=N1(t,r[l-1]);o=u===-1?t.length+1:u+1,r[l]=o}if(o>i)return{line:l+1,column:i-(l>0?r[l-1]:0)+1,offset:i};l++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const o=r[r.length-1],u=N1(t,o),c=u===-1?t.length+1:u+1;if(o===c)break;r.push(c)}const l=(i.line>1?r[i.line-2]:0)+i.column-1;if(l<r[i.line-1])return l}}}function N1(e,t){const r=e.indexOf("\r",t),n=e.indexOf(`
`,t);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const Ga={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},wk={}.hasOwnProperty,y8=Object.prototype;function b8(e,t){const r=t||{};return zg({file:r.file||void 0,location:!1,schema:r.space==="svg"?Ra:uc,verbose:r.verbose||!1},e)}function zg(e,t){let r;switch(t.nodeName){case"#comment":{const n=t;return r={type:"comment",value:n.data},md(e,n,r),r}case"#document":case"#document-fragment":{const n=t,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:Ek(e,t.childNodes),data:{quirksMode:s}},e.file&&e.location){const i=String(e.file),l=x8(i),o=l.toPoint(0),u=l.toPoint(i.length);r.position={start:o,end:u}}return r}case"#documentType":{const n=t;return r={type:"doctype"},md(e,n,r),r}case"#text":{const n=t;return r={type:"text",value:n.value},md(e,n,r),r}default:return r=v8(e,t),r}}function Ek(e,t){let r=-1;const n=[];for(;++r<t.length;){const s=zg(e,t[r]);n.push(s)}return n}function v8(e,t){const r=e.schema;e.schema=t.namespaceURI===Ga.svg?Ra:uc;let n=-1;const s={};for(;++n<t.attrs.length;){const o=t.attrs[n],u=(o.prefix?o.prefix+":":"")+o.name;wk.call(y8,u)||(s[u]=o.value)}const l=(e.schema.space==="svg"?g8:p8)(t.tagName,s,Ek(e,t.childNodes));if(md(e,t,l),l.tagName==="template"){const o=t,u=o.sourceCodeLocation,c=u&&u.startTag&&Zi(u.startTag),d=u&&u.endTag&&Zi(u.endTag),h=zg(e,o.content);c&&d&&e.file&&(h.position={start:c.end,end:d.start}),l.content=h}return e.schema=r,l}function md(e,t,r){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const n=w8(e,r,t.sourceCodeLocation);n&&(e.location=!0,r.position=n)}}function w8(e,t,r){const n=Zi(r);if(t.type==="element"){const s=t.children[t.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),e.verbose){const i={};let l;if(r.attrs)for(l in r.attrs)wk.call(r.attrs,l)&&(i[Bh(e.schema,l).property]=Zi(r.attrs[l]));r.startTag;const o=Zi(r.startTag),u=r.endTag?Zi(r.endTag):void 0,c={opening:o};u&&(c.closing=u),c.properties=i,t.data={position:c}}}return n}function Zi(e){const t=k1({line:e.startLine,column:e.startCol,offset:e.startOffset}),r=k1({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||r?{start:t,end:r}:void 0}function k1(e){return e.line&&e.column?e:void 0}const E8={},N8={}.hasOwnProperty,Nk=JN("type",{handlers:{root:_8,element:A8,text:C8,comment:j8,doctype:T8}});function k8(e,t){const n=(t||E8).space;return Nk(e,n==="svg"?Ra:uc)}function _8(e,t){const r={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=qg(e.children,r,t),eo(e,r),r}function S8(e,t){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=qg(e.children,r,t),eo(e,r),r}function T8(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return eo(e,t),t}function C8(e){const t={nodeName:"#text",value:e.value,parentNode:null};return eo(e,t),t}function j8(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return eo(e,t),t}function A8(e,t){const r=t;let n=r;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=Ra);const s=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&N8.call(e.properties,i)){const u=I8(n,i,e.properties[i]);u&&s.push(u)}}const l=n.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:s,namespaceURI:Ga[l],childNodes:[],parentNode:null};return o.childNodes=qg(e.children,o,n),eo(e,o),e.tagName==="template"&&e.content&&(o.content=S8(e.content,n)),o}function I8(e,t,r){const n=Bh(e,t);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?uN(r):yN(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=Ga[n.space]}return s}function qg(e,t,r){let n=-1;const s=[];if(e)for(;++n<e.length;){const i=Nk(e[n],r);i.parentNode=t,s.push(i)}return s}function eo(e,t){const r=e.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,t.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const R8=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],L8=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),vt="";var C;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(C||(C={}));const Tr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function kk(e){return e>=55296&&e<=57343}function O8(e){return e>=56320&&e<=57343}function P8(e,t){return(e-55296)*1024+9216+t}function _k(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function Sk(e){return e>=64976&&e<=65007||L8.has(e)}var ee;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ee||(ee={}));const D8=65536;class M8{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=D8,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,r){const{line:n,col:s,offset:i}=this,l=s+r,o=i+r;return{code:t,startLine:n,endLine:n,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(O8(r))return this.pos++,this._addGap(),P8(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,C.EOF;return this._err(ee.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;const n=this.html.charCodeAt(r);return n===C.CARRIAGE_RETURN?C.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;let t=this.html.charCodeAt(this.pos);return t===C.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,C.LINE_FEED):t===C.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,kk(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===C.LINE_FEED||t===C.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){_k(t)?this._err(ee.controlCharacterInInputStream):Sk(t)&&this._err(ee.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var $e;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})($e||($e={}));function Tk(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}const Ck=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),F8=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var fm;const B8=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),U8=(fm=String.fromCodePoint)!==null&&fm!==void 0?fm:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function H8(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=B8.get(e))!==null&&t!==void 0?t:e}var Yt;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Yt||(Yt={}));const $8=32;var ua;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(ua||(ua={}));function e0(e){return e>=Yt.ZERO&&e<=Yt.NINE}function z8(e){return e>=Yt.UPPER_A&&e<=Yt.UPPER_F||e>=Yt.LOWER_A&&e<=Yt.LOWER_F}function q8(e){return e>=Yt.UPPER_A&&e<=Yt.UPPER_Z||e>=Yt.LOWER_A&&e<=Yt.LOWER_Z||e0(e)}function V8(e){return e===Yt.EQUALS||q8(e)}var qt;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(qt||(qt={}));var ms;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(ms||(ms={}));class jk{constructor(t,r,n){this.decodeTree=t,this.emitCodePoint=r,this.errors=n,this.state=qt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ms.Strict}startEntity(t){this.decodeMode=t,this.state=qt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,r){switch(this.state){case qt.EntityStart:return t.charCodeAt(r)===Yt.NUM?(this.state=qt.NumericStart,this.consumed+=1,this.stateNumericStart(t,r+1)):(this.state=qt.NamedEntity,this.stateNamedEntity(t,r));case qt.NumericStart:return this.stateNumericStart(t,r);case qt.NumericDecimal:return this.stateNumericDecimal(t,r);case qt.NumericHex:return this.stateNumericHex(t,r);case qt.NamedEntity:return this.stateNamedEntity(t,r)}}stateNumericStart(t,r){return r>=t.length?-1:(t.charCodeAt(r)|$8)===Yt.LOWER_X?(this.state=qt.NumericHex,this.consumed+=1,this.stateNumericHex(t,r+1)):(this.state=qt.NumericDecimal,this.stateNumericDecimal(t,r))}addToNumericResult(t,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(r,i),s),this.consumed+=i}}stateNumericHex(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(e0(s)||z8(s))r+=1;else return this.addToNumericResult(t,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,n,r,16),-1}stateNumericDecimal(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(e0(s))r+=1;else return this.addToNumericResult(t,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,n,r,10),-1}emitNumericEntity(t,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Yt.SEMI)this.consumed+=1;else if(this.decodeMode===ms.Strict)return 0;return this.emitCodePoint(H8(this.result),this.consumed),this.errors&&(t!==Yt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&ua.VALUE_LENGTH)>>14;for(;r<t.length;r++,this.excess++){const l=t.charCodeAt(r);if(this.treeIndex=W8(n,s,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===ms.Attribute&&(i===0||V8(l))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&ua.VALUE_LENGTH)>>14,i!==0){if(l===Yt.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ms.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:r,decodeTree:n}=this,s=(n[r]&ua.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[t]&~ua.VALUE_LENGTH:s[t+1],n),r===3&&this.emitCodePoint(s[t+2],n),n}end(){var t;switch(this.state){case qt.NamedEntity:return this.result!==0&&(this.decodeMode!==ms.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case qt.NumericDecimal:return this.emitNumericEntity(0,2);case qt.NumericHex:return this.emitNumericEntity(0,3);case qt.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case qt.EntityStart:return 0}}}function Ak(e){let t="";const r=new jk(e,n=>t+=U8(n));return function(s,i){let l=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(l,o),r.startEntity(i);const c=r.write(s,o+1);if(c<0){l=o+r.end();break}l=o+c,o=c===0?l+1:l}const u=t+s.slice(l);return t="",u}}function W8(e,t,r,n){const s=(t&ua.BRANCH_LENGTH)>>7,i=t&ua.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const u=n-i;return u<0||u>=s?-1:e[r+u]-1}let l=r,o=l+s-1;for(;l<=o;){const u=l+o>>>1,c=e[u];if(c<n)l=u+1;else if(c>n)o=u-1;else return e[u+s]}return-1}Ak(Ck);Ak(F8);var ae;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(ae||(ae={}));var ai;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(ai||(ai={}));var sn;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(sn||(sn={}));var Y;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(Y||(Y={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(m||(m={}));const G8=new Map([[Y.A,m.A],[Y.ADDRESS,m.ADDRESS],[Y.ANNOTATION_XML,m.ANNOTATION_XML],[Y.APPLET,m.APPLET],[Y.AREA,m.AREA],[Y.ARTICLE,m.ARTICLE],[Y.ASIDE,m.ASIDE],[Y.B,m.B],[Y.BASE,m.BASE],[Y.BASEFONT,m.BASEFONT],[Y.BGSOUND,m.BGSOUND],[Y.BIG,m.BIG],[Y.BLOCKQUOTE,m.BLOCKQUOTE],[Y.BODY,m.BODY],[Y.BR,m.BR],[Y.BUTTON,m.BUTTON],[Y.CAPTION,m.CAPTION],[Y.CENTER,m.CENTER],[Y.CODE,m.CODE],[Y.COL,m.COL],[Y.COLGROUP,m.COLGROUP],[Y.DD,m.DD],[Y.DESC,m.DESC],[Y.DETAILS,m.DETAILS],[Y.DIALOG,m.DIALOG],[Y.DIR,m.DIR],[Y.DIV,m.DIV],[Y.DL,m.DL],[Y.DT,m.DT],[Y.EM,m.EM],[Y.EMBED,m.EMBED],[Y.FIELDSET,m.FIELDSET],[Y.FIGCAPTION,m.FIGCAPTION],[Y.FIGURE,m.FIGURE],[Y.FONT,m.FONT],[Y.FOOTER,m.FOOTER],[Y.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[Y.FORM,m.FORM],[Y.FRAME,m.FRAME],[Y.FRAMESET,m.FRAMESET],[Y.H1,m.H1],[Y.H2,m.H2],[Y.H3,m.H3],[Y.H4,m.H4],[Y.H5,m.H5],[Y.H6,m.H6],[Y.HEAD,m.HEAD],[Y.HEADER,m.HEADER],[Y.HGROUP,m.HGROUP],[Y.HR,m.HR],[Y.HTML,m.HTML],[Y.I,m.I],[Y.IMG,m.IMG],[Y.IMAGE,m.IMAGE],[Y.INPUT,m.INPUT],[Y.IFRAME,m.IFRAME],[Y.KEYGEN,m.KEYGEN],[Y.LABEL,m.LABEL],[Y.LI,m.LI],[Y.LINK,m.LINK],[Y.LISTING,m.LISTING],[Y.MAIN,m.MAIN],[Y.MALIGNMARK,m.MALIGNMARK],[Y.MARQUEE,m.MARQUEE],[Y.MATH,m.MATH],[Y.MENU,m.MENU],[Y.META,m.META],[Y.MGLYPH,m.MGLYPH],[Y.MI,m.MI],[Y.MO,m.MO],[Y.MN,m.MN],[Y.MS,m.MS],[Y.MTEXT,m.MTEXT],[Y.NAV,m.NAV],[Y.NOBR,m.NOBR],[Y.NOFRAMES,m.NOFRAMES],[Y.NOEMBED,m.NOEMBED],[Y.NOSCRIPT,m.NOSCRIPT],[Y.OBJECT,m.OBJECT],[Y.OL,m.OL],[Y.OPTGROUP,m.OPTGROUP],[Y.OPTION,m.OPTION],[Y.P,m.P],[Y.PARAM,m.PARAM],[Y.PLAINTEXT,m.PLAINTEXT],[Y.PRE,m.PRE],[Y.RB,m.RB],[Y.RP,m.RP],[Y.RT,m.RT],[Y.RTC,m.RTC],[Y.RUBY,m.RUBY],[Y.S,m.S],[Y.SCRIPT,m.SCRIPT],[Y.SEARCH,m.SEARCH],[Y.SECTION,m.SECTION],[Y.SELECT,m.SELECT],[Y.SOURCE,m.SOURCE],[Y.SMALL,m.SMALL],[Y.SPAN,m.SPAN],[Y.STRIKE,m.STRIKE],[Y.STRONG,m.STRONG],[Y.STYLE,m.STYLE],[Y.SUB,m.SUB],[Y.SUMMARY,m.SUMMARY],[Y.SUP,m.SUP],[Y.TABLE,m.TABLE],[Y.TBODY,m.TBODY],[Y.TEMPLATE,m.TEMPLATE],[Y.TEXTAREA,m.TEXTAREA],[Y.TFOOT,m.TFOOT],[Y.TD,m.TD],[Y.TH,m.TH],[Y.THEAD,m.THEAD],[Y.TITLE,m.TITLE],[Y.TR,m.TR],[Y.TRACK,m.TRACK],[Y.TT,m.TT],[Y.U,m.U],[Y.UL,m.UL],[Y.SVG,m.SVG],[Y.VAR,m.VAR],[Y.WBR,m.WBR],[Y.XMP,m.XMP]]);function to(e){var t;return(t=G8.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const ie=m,Y8={[ae.HTML]:new Set([ie.ADDRESS,ie.APPLET,ie.AREA,ie.ARTICLE,ie.ASIDE,ie.BASE,ie.BASEFONT,ie.BGSOUND,ie.BLOCKQUOTE,ie.BODY,ie.BR,ie.BUTTON,ie.CAPTION,ie.CENTER,ie.COL,ie.COLGROUP,ie.DD,ie.DETAILS,ie.DIR,ie.DIV,ie.DL,ie.DT,ie.EMBED,ie.FIELDSET,ie.FIGCAPTION,ie.FIGURE,ie.FOOTER,ie.FORM,ie.FRAME,ie.FRAMESET,ie.H1,ie.H2,ie.H3,ie.H4,ie.H5,ie.H6,ie.HEAD,ie.HEADER,ie.HGROUP,ie.HR,ie.HTML,ie.IFRAME,ie.IMG,ie.INPUT,ie.LI,ie.LINK,ie.LISTING,ie.MAIN,ie.MARQUEE,ie.MENU,ie.META,ie.NAV,ie.NOEMBED,ie.NOFRAMES,ie.NOSCRIPT,ie.OBJECT,ie.OL,ie.P,ie.PARAM,ie.PLAINTEXT,ie.PRE,ie.SCRIPT,ie.SECTION,ie.SELECT,ie.SOURCE,ie.STYLE,ie.SUMMARY,ie.TABLE,ie.TBODY,ie.TD,ie.TEMPLATE,ie.TEXTAREA,ie.TFOOT,ie.TH,ie.THEAD,ie.TITLE,ie.TR,ie.TRACK,ie.UL,ie.WBR,ie.XMP]),[ae.MATHML]:new Set([ie.MI,ie.MO,ie.MN,ie.MS,ie.MTEXT,ie.ANNOTATION_XML]),[ae.SVG]:new Set([ie.TITLE,ie.FOREIGN_OBJECT,ie.DESC]),[ae.XLINK]:new Set,[ae.XML]:new Set,[ae.XMLNS]:new Set},t0=new Set([ie.H1,ie.H2,ie.H3,ie.H4,ie.H5,ie.H6]);Y.STYLE,Y.SCRIPT,Y.XMP,Y.IFRAME,Y.NOEMBED,Y.NOFRAMES,Y.PLAINTEXT;var R;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(R||(R={}));const Rt={DATA:R.DATA,RCDATA:R.RCDATA,RAWTEXT:R.RAWTEXT,SCRIPT_DATA:R.SCRIPT_DATA,PLAINTEXT:R.PLAINTEXT,CDATA_SECTION:R.CDATA_SECTION};function Q8(e){return e>=C.DIGIT_0&&e<=C.DIGIT_9}function Lo(e){return e>=C.LATIN_CAPITAL_A&&e<=C.LATIN_CAPITAL_Z}function K8(e){return e>=C.LATIN_SMALL_A&&e<=C.LATIN_SMALL_Z}function Us(e){return K8(e)||Lo(e)}function _1(e){return Us(e)||Q8(e)}function Zc(e){return e+32}function Ik(e){return e===C.SPACE||e===C.LINE_FEED||e===C.TABULATION||e===C.FORM_FEED}function S1(e){return Ik(e)||e===C.SOLIDUS||e===C.GREATER_THAN_SIGN}function Z8(e){return e===C.NULL?ee.nullCharacterReference:e>1114111?ee.characterReferenceOutsideUnicodeRange:kk(e)?ee.surrogateCharacterReference:Sk(e)?ee.noncharacterCharacterReference:_k(e)||e===C.CARRIAGE_RETURN?ee.controlCharacterReference:null}class X8{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=R.DATA,this.returnState=R.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new M8(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new jk(Ck,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(ee.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(ee.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=Z8(n);s&&this._err(s,1)}}:void 0)}_err(t,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(t,r))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:$e.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:$e.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:$e.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:$e.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(Tk(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ee.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=to(t.tagName),t.type===$e.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(ee.endTagWithAttributes),t.selfClosing&&this._err(ee.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case $e.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case $e.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case $e.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:$e.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,r)}_emitCodePoint(t){const r=Ik(t)?$e.WHITESPACE_CHARACTER:t===C.NULL?$e.NULL_CHARACTER:$e.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken($e.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=R.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?ms.Attribute:ms.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===R.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===R.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===R.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case R.DATA:{this._stateData(t);break}case R.RCDATA:{this._stateRcdata(t);break}case R.RAWTEXT:{this._stateRawtext(t);break}case R.SCRIPT_DATA:{this._stateScriptData(t);break}case R.PLAINTEXT:{this._statePlaintext(t);break}case R.TAG_OPEN:{this._stateTagOpen(t);break}case R.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case R.TAG_NAME:{this._stateTagName(t);break}case R.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case R.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case R.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case R.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case R.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case R.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case R.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case R.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case R.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case R.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case R.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case R.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case R.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case R.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case R.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case R.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case R.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case R.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case R.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case R.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case R.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case R.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case R.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case R.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case R.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case R.BOGUS_COMMENT:{this._stateBogusComment(t);break}case R.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case R.COMMENT_START:{this._stateCommentStart(t);break}case R.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case R.COMMENT:{this._stateComment(t);break}case R.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case R.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case R.COMMENT_END:{this._stateCommentEnd(t);break}case R.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case R.DOCTYPE:{this._stateDoctype(t);break}case R.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case R.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case R.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case R.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case R.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case R.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case R.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case R.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case R.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case R.CDATA_SECTION:{this._stateCdataSection(t);break}case R.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case R.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case R.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case R.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.TAG_OPEN;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitCodePoint(t);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case C.AMPERSAND:{this._startCharacterReference();break}case C.LESS_THAN_SIGN:{this.state=R.RCDATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.RAWTEXT_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(Us(t))this._createStartTagToken(),this.state=R.TAG_NAME,this._stateTagName(t);else switch(t){case C.EXCLAMATION_MARK:{this.state=R.MARKUP_DECLARATION_OPEN;break}case C.SOLIDUS:{this.state=R.END_TAG_OPEN;break}case C.QUESTION_MARK:{this._err(ee.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t);break}case C.EOF:{this._err(ee.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ee.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=R.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(Us(t))this._createEndTagToken(),this.state=R.TAG_NAME,this._stateTagName(t);else switch(t){case C.GREATER_THAN_SIGN:{this._err(ee.missingEndTagName),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ee.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this.state=R.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.tagName+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(Lo(t)?Zc(t):t)}}_stateRcdataLessThanSign(t){t===C.SOLIDUS?this.state=R.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=R.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){Us(t)?(this.state=R.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=R.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=R.BEFORE_ATTRIBUTE_NAME,!1;case C.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=R.SELF_CLOSING_START_TAG,!1;case C.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=R.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===C.SOLIDUS?this.state=R.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){Us(t)?(this.state=R.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case C.SOLIDUS:{this.state=R.SCRIPT_DATA_END_TAG_OPEN;break}case C.EXCLAMATION_MARK:{this.state=R.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=R.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){Us(t)?(this.state=R.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===C.HYPHEN_MINUS?(this.state=R.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===C.HYPHEN_MINUS?(this.state=R.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.GREATER_THAN_SIGN:{this.state=R.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===C.SOLIDUS?this.state=R.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Us(t)?(this._emitChars("<"),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){Us(t)?(this.state=R.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(Tr.SCRIPT,!1)&&S1(this.preprocessor.peek(Tr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Tr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.GREATER_THAN_SIGN:{this.state=R.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===C.SOLIDUS?(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(Tr.SCRIPT,!1)&&S1(this.preprocessor.peek(Tr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Tr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=R.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this.state=R.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._err(ee.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=R.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=R.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this._leaveAttrName(),this.state=R.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._leaveAttrName(),this.state=R.BEFORE_ATTRIBUTE_VALUE;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:{this._err(ee.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.name+=vt;break}default:this.currentAttr.name+=String.fromCodePoint(Lo(t)?Zc(t):t)}}_stateAfterAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:{this.state=R.SELF_CLOSING_START_TAG;break}case C.EQUALS_SIGN:{this.state=R.BEFORE_ATTRIBUTE_VALUE;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=R.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{this.state=R.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this.state=R.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingAttributeValue),this.state=R.DATA,this.emitCurrentTagToken();break}default:this.state=R.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case C.APOSTROPHE:{this.state=R.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=R.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:case C.EQUALS_SIGN:case C.GRAVE_ACCENT:{this._err(ee.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this._leaveAttrValue(),this.state=R.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._err(ee.missingWhitespaceBetweenAttributes),this.state=R.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case C.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._err(ee.unexpectedSolidusInTag),this.state=R.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.data+=vt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(Tr.DASH_DASH,!0)?(this._createCommentToken(Tr.DASH_DASH.length+1),this.state=R.COMMENT_START):this._consumeSequenceIfMatch(Tr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Tr.DOCTYPE.length+1),this.state=R.DOCTYPE):this._consumeSequenceIfMatch(Tr.CDATA_START,!0)?this.inForeignNode?this.state=R.CDATA_SECTION:(this._err(ee.cdataInHtmlContent),this._createCommentToken(Tr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=R.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ee.incorrectlyOpenedComment),this._createCommentToken(2),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_START_DASH;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptClosingOfEmptyComment),this.state=R.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=R.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptClosingOfEmptyComment),this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=R.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END_DASH;break}case C.LESS_THAN_SIGN:{r.data+="<",this.state=R.COMMENT_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.data+=vt;break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case C.EXCLAMATION_MARK:{r.data+="!",this.state=R.COMMENT_LESS_THAN_SIGN_BANG;break}case C.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=R.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===C.HYPHEN_MINUS?this.state=R.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=R.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===C.HYPHEN_MINUS?this.state=R.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=R.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==C.GREATER_THAN_SIGN&&t!==C.EOF&&this._err(ee.nestedComment),this.state=R.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END;break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=R.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentComment(r);break}case C.EXCLAMATION_MARK:{this.state=R.COMMENT_END_BANG;break}case C.HYPHEN_MINUS:{r.data+="-";break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=R.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{r.data+="--!",this.state=R.COMMENT_END_DASH;break}case C.GREATER_THAN_SIGN:{this._err(ee.incorrectlyClosedComment),this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=R.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=R.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case C.EOF:{this._err(ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingWhitespaceBeforeDoctypeName),this.state=R.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Lo(t))this._createDoctypeToken(String.fromCharCode(Zc(t))),this.state=R.DOCTYPE_NAME;else switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.NULL:{this._err(ee.unexpectedNullCharacter),this._createDoctypeToken(vt),this.state=R.DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=R.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.AFTER_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.name+=vt;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(Lo(t)?Zc(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Tr.PUBLIC,!1)?this.state=R.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Tr.SYSTEM,!1)?this.state=R.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ee.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.publicId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.publicId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.QUOTATION_MARK:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.systemId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.systemId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.NULL:{this._err(ee.unexpectedNullCharacter);break}case C.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case C.RIGHT_SQUARE_BRACKET:{this.state=R.CDATA_SECTION_BRACKET;break}case C.EOF:{this._err(ee.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===C.RIGHT_SQUARE_BRACKET?this.state=R.CDATA_SECTION_END:(this._emitChars("]"),this.state=R.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA;break}case C.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=R.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(C.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&_1(this.preprocessor.peek(1))?R.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){_1(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===C.SEMICOLON&&this._err(ee.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const Rk=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),T1=new Set([...Rk,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),Xd=new Set([m.APPLET,m.CAPTION,m.HTML,m.MARQUEE,m.OBJECT,m.TABLE,m.TD,m.TEMPLATE,m.TH]),J8=new Set([...Xd,m.OL,m.UL]),e9=new Set([...Xd,m.BUTTON]),C1=new Set([m.ANNOTATION_XML,m.MI,m.MN,m.MO,m.MS,m.MTEXT]),j1=new Set([m.DESC,m.FOREIGN_OBJECT,m.TITLE]),t9=new Set([m.TR,m.TEMPLATE,m.HTML]),r9=new Set([m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML]),n9=new Set([m.TABLE,m.TEMPLATE,m.HTML]),s9=new Set([m.TD,m.TH]);class a9{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===ae.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const s=this._indexOf(t)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==ae.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(t0,ae.HTML)}popUntilTableCellPopped(){this.popUntilPopped(s9,ae.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(n9,ae.HTML)}clearBackToTableBodyContext(){this.clearBackTo(r9,ae.HTML)}clearBackToTableRowContext(){this.clearBackTo(t9,ae.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInDynamicScope(t,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case ae.HTML:{if(s===t)return!0;if(r.has(s))return!1;break}case ae.SVG:{if(j1.has(s))return!1;break}case ae.MATHML:{if(C1.has(s))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,Xd)}hasInListItemScope(t){return this.hasInDynamicScope(t,J8)}hasInButtonScope(t){return this.hasInDynamicScope(t,e9)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case ae.HTML:{if(t0.has(r))return!0;if(Xd.has(r))return!1;break}case ae.SVG:{if(j1.has(r))return!1;break}case ae.MATHML:{if(C1.has(r))return!1;break}}}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ae.HTML)switch(this.tagIDs[r]){case t:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===ae.HTML)switch(this.tagIDs[t]){case m.TBODY:case m.THEAD:case m.TFOOT:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ae.HTML)switch(this.tagIDs[r]){case t:return!0;case m.OPTION:case m.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Rk.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;T1.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&T1.has(this.currentTagId);)this.pop()}}const mm=3;var Wn;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Wn||(Wn={}));const A1={type:Wn.Marker};class i9{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const u=this.entries[o];if(u.type===Wn.Marker)break;const{element:c}=u;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===l){const d=this.treeAdapter.getAttrList(c);d.length===s&&n.push({idx:o,attrs:d})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<mm)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<mm)return;const s=new Map(r.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<n.length;l++){const o=n[l];o.attrs.every(u=>s.get(u.name)===u.value)&&(i+=1,i>=mm&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(A1)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:Wn.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:Wn.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(A1);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===Wn.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===Wn.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===Wn.Element&&r.element===t)}}const Hs={createDocument(){return{nodeName:"#document",mode:sn.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const s=e.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=t,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Hs.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Hs.isTextNode(r)){r.value+=t;return}}Hs.appendChild(e,Hs.createTextNode(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Hs.isTextNode(n)?n.value+=t:Hs.insertBefore(e,Hs.createTextNode(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},Lk="html",l9="about:legacy-compat",o9="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Ok=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],u9=[...Ok,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],c9=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Pk=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],d9=[...Pk,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function I1(e,t){return t.some(r=>e.startsWith(r))}function h9(e){return e.name===Lk&&e.publicId===null&&(e.systemId===null||e.systemId===l9)}function f9(e){if(e.name!==Lk)return sn.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===o9)return sn.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),c9.has(r))return sn.QUIRKS;let n=t===null?u9:Ok;if(I1(r,n))return sn.QUIRKS;if(n=t===null?Pk:d9,I1(r,n))return sn.LIMITED_QUIRKS}return sn.NO_QUIRKS}const R1={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},m9="definitionurl",p9="definitionURL",g9=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),x9=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:ae.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:ae.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:ae.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:ae.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:ae.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:ae.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:ae.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:ae.XML}],["xml:space",{prefix:"xml",name:"space",namespace:ae.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:ae.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:ae.XMLNS}]]),y9=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),b9=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function v9(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===ai.COLOR||n===ai.SIZE||n===ai.FACE)||b9.has(t)}function Dk(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===m9){e.attrs[t].name=p9;break}}function Mk(e){for(let t=0;t<e.attrs.length;t++){const r=g9.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function Vg(e){for(let t=0;t<e.attrs.length;t++){const r=x9.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function w9(e){const t=y9.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=to(e.tagName))}function E9(e,t){return t===ae.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function N9(e,t,r){if(t===ae.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===ai.ENCODING){const s=r[n].value.toLowerCase();return s===R1.TEXT_HTML||s===R1.APPLICATION_XML}}return t===ae.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function k9(e,t,r,n){return(!n||n===ae.HTML)&&N9(e,t,r)||(!n||n===ae.MATHML)&&E9(e,t)}const _9="hidden",S9=8,T9=3;var P;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(P||(P={}));const C9={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Fk=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),L1={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Hs,onParseError:null};class O1{constructor(t,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=P.INITIAL,this.originalInsertionMode=P.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...L1,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new X8(this.options,this),this.activeFormattingElements=new i9(this.treeAdapter),this.fragmentContextID=n?to(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new a9(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...L1,...r};t??(t=n.treeAdapter.createElement(Y.TEMPLATE,ae.HTML,[]));const s=n.treeAdapter.createElement("documentmock",ae.HTML,[]),i=new this(n,s,t);return i.fragmentContextID===m.TEMPLATE&&i.tmplInsertionModeStack.unshift(P.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var s;if(!this.onParseError)return;const i=(s=t.location)!==null&&s!==void 0?s:C9,l={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,t,this.openElements.current),r){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===ae.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,ae.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=P.TEXT}switchToPlaintextParsing(){this.insertionMode=P.TEXT,this.originalInsertionMode=P.IN_BODY,this.tokenizer.state=Rt.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===Y.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==ae.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=Rt.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=Rt.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=Rt.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=Rt.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",s=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,ae.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,ae.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(Y.HTML,ae.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,l=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:u,endCol:c,endOffset:d}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(t),i=r.type===$e.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===Y.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===ae.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,ae.HTML)}_processToken(t){switch(t.type){case $e.CHARACTER:{this.onCharacter(t);break}case $e.NULL_CHARACTER:{this.onNullCharacter(t);break}case $e.COMMENT:{this.onComment(t);break}case $e.DOCTYPE:{this.onDoctype(t);break}case $e.START_TAG:{this._processStartTag(t);break}case $e.END_TAG:{this.onEndTag(t);break}case $e.EOF:{this.onEof(t);break}case $e.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return k9(t,s,i,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===Wn.Marker||this.openElements.contains(s.element)),n=r<0?t-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=P.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=P.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=P.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=P.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=P.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=P.IN_TABLE;return}case m.BODY:{this.insertionMode=P.IN_BODY;return}case m.FRAMESET:{this.insertionMode=P.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?P.AFTER_HEAD:P.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=P.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=P.IN_HEAD;return}break}}this.insertionMode=P.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=P.IN_SELECT_IN_TABLE;return}}this.insertionMode=P.IN_SELECT}_isElementCausesFosterParenting(t){return Fk.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===ae.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return Y8[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){sF(this,t);return}switch(this.insertionMode){case P.INITIAL:{ko(this,t);break}case P.BEFORE_HTML:{eu(this,t);break}case P.BEFORE_HEAD:{tu(this,t);break}case P.IN_HEAD:{ru(this,t);break}case P.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case P.AFTER_HEAD:{su(this,t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:{Uk(this,t);break}case P.TEXT:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{pm(this,t);break}case P.IN_TABLE_TEXT:{Wk(this,t);break}case P.IN_COLUMN_GROUP:{Jd(this,t);break}case P.AFTER_BODY:{eh(this,t);break}case P.AFTER_AFTER_BODY:{pd(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){nF(this,t);return}switch(this.insertionMode){case P.INITIAL:{ko(this,t);break}case P.BEFORE_HTML:{eu(this,t);break}case P.BEFORE_HEAD:{tu(this,t);break}case P.IN_HEAD:{ru(this,t);break}case P.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case P.AFTER_HEAD:{su(this,t);break}case P.TEXT:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{pm(this,t);break}case P.IN_COLUMN_GROUP:{Jd(this,t);break}case P.AFTER_BODY:{eh(this,t);break}case P.AFTER_AFTER_BODY:{pd(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){r0(this,t);return}switch(this.insertionMode){case P.INITIAL:case P.BEFORE_HTML:case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_TEMPLATE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{r0(this,t);break}case P.IN_TABLE_TEXT:{_o(this,t);break}case P.AFTER_BODY:{P9(this,t);break}case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{D9(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case P.INITIAL:{M9(this,t);break}case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:{this._err(t,ee.misplacedDoctype);break}case P.IN_TABLE_TEXT:{_o(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,ee.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?aF(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{ko(this,t);break}case P.BEFORE_HTML:{F9(this,t);break}case P.BEFORE_HEAD:{U9(this,t);break}case P.IN_HEAD:{Mn(this,t);break}case P.IN_HEAD_NO_SCRIPT:{z9(this,t);break}case P.AFTER_HEAD:{V9(this,t);break}case P.IN_BODY:{fr(this,t);break}case P.IN_TABLE:{Fl(this,t);break}case P.IN_TABLE_TEXT:{_o(this,t);break}case P.IN_CAPTION:{H7(this,t);break}case P.IN_COLUMN_GROUP:{Yg(this,t);break}case P.IN_TABLE_BODY:{Qh(this,t);break}case P.IN_ROW:{Kh(this,t);break}case P.IN_CELL:{q7(this,t);break}case P.IN_SELECT:{Qk(this,t);break}case P.IN_SELECT_IN_TABLE:{W7(this,t);break}case P.IN_TEMPLATE:{Y7(this,t);break}case P.AFTER_BODY:{K7(this,t);break}case P.IN_FRAMESET:{Z7(this,t);break}case P.AFTER_FRAMESET:{J7(this,t);break}case P.AFTER_AFTER_BODY:{tF(this,t);break}case P.AFTER_AFTER_FRAMESET:{rF(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?iF(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{ko(this,t);break}case P.BEFORE_HTML:{B9(this,t);break}case P.BEFORE_HEAD:{H9(this,t);break}case P.IN_HEAD:{$9(this,t);break}case P.IN_HEAD_NO_SCRIPT:{q9(this,t);break}case P.AFTER_HEAD:{W9(this,t);break}case P.IN_BODY:{Yh(this,t);break}case P.TEXT:{I7(this,t);break}case P.IN_TABLE:{Ru(this,t);break}case P.IN_TABLE_TEXT:{_o(this,t);break}case P.IN_CAPTION:{$7(this,t);break}case P.IN_COLUMN_GROUP:{z7(this,t);break}case P.IN_TABLE_BODY:{n0(this,t);break}case P.IN_ROW:{Yk(this,t);break}case P.IN_CELL:{V7(this,t);break}case P.IN_SELECT:{Kk(this,t);break}case P.IN_SELECT_IN_TABLE:{G7(this,t);break}case P.IN_TEMPLATE:{Q7(this,t);break}case P.AFTER_BODY:{Xk(this,t);break}case P.IN_FRAMESET:{X7(this,t);break}case P.AFTER_FRAMESET:{eF(this,t);break}case P.AFTER_AFTER_BODY:{pd(this,t);break}}}onEof(t){switch(this.insertionMode){case P.INITIAL:{ko(this,t);break}case P.BEFORE_HTML:{eu(this,t);break}case P.BEFORE_HEAD:{tu(this,t);break}case P.IN_HEAD:{ru(this,t);break}case P.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case P.AFTER_HEAD:{su(this,t);break}case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{qk(this,t);break}case P.TEXT:{R7(this,t);break}case P.IN_TABLE_TEXT:{_o(this,t);break}case P.IN_TEMPLATE:{Zk(this,t);break}case P.AFTER_BODY:case P.IN_FRAMESET:case P.AFTER_FRAMESET:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{Gg(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===C.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.TEXT:case P.IN_COLUMN_GROUP:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{this._insertCharacters(t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:case P.AFTER_BODY:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{Bk(this,t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{pm(this,t);break}case P.IN_TABLE_TEXT:{Vk(this,t);break}}}}function j9(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):zk(e,t),r}function A9(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const s=e.openElements.items[n];if(s===t.element)break;e._isSpecialElement(s,e.openElements.tagIDs[n])&&(r=s)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function I9(e,t,r){let n=t,s=e.openElements.getCommonAncestor(t);for(let i=0,l=s;l!==r;i++,l=s){s=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),u=o&&i>=T9;!o||u?(u&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=R9(e,o),n===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function R9(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function L9(e,t,r){const n=e.treeAdapter.getTagName(t),s=to(n);if(e._isElementCausesFosterParenting(s))e._fosterParentElement(r);else{const i=e.treeAdapter.getNamespaceURI(t);s===m.TEMPLATE&&i===ae.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function O9(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=e.treeAdapter.createElement(s.tagName,n,s.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,s),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,i,s.tagID)}function Wg(e,t){for(let r=0;r<S9;r++){const n=j9(e,t);if(!n)break;const s=A9(e,n);if(!s)break;e.activeFormattingElements.bookmark=n;const i=I9(e,s,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),l&&L9(e,l,i),O9(e,s,n)}}function r0(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function P9(e,t){e._appendCommentNode(t,e.openElements.items[0])}function D9(e,t){e._appendCommentNode(t,e.document)}function Gg(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],s=e.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function M9(e,t){e._setDocumentType(t);const r=t.forceQuirks?sn.QUIRKS:f9(t);h9(t)||e._err(t,ee.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=P.BEFORE_HTML}function ko(e,t){e._err(t,ee.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,sn.QUIRKS),e.insertionMode=P.BEFORE_HTML,e._processToken(t)}function F9(e,t){t.tagID===m.HTML?(e._insertElement(t,ae.HTML),e.insertionMode=P.BEFORE_HEAD):eu(e,t)}function B9(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&eu(e,t)}function eu(e,t){e._insertFakeRootElement(),e.insertionMode=P.BEFORE_HEAD,e._processToken(t)}function U9(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.HEAD:{e._insertElement(t,ae.HTML),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD;break}default:tu(e,t)}}function H9(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?tu(e,t):e._err(t,ee.endTagWithoutMatchingOpenElement)}function tu(e,t){e._insertFakeElement(Y.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD,e._processToken(t)}function Mn(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,Rt.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Rt.RAWTEXT):(e._insertElement(t,ae.HTML),e.insertionMode=P.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,Rt.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,Rt.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=P.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(P.IN_TEMPLATE);break}case m.HEAD:{e._err(t,ee.misplacedStartTagForHeadElement);break}default:ru(e,t)}}function $9(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=P.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{ru(e,t);break}case m.TEMPLATE:{_i(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function _i(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,ee.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,ee.endTagWithoutMatchingOpenElement)}function ru(e,t){e.openElements.pop(),e.insertionMode=P.AFTER_HEAD,e._processToken(t)}function z9(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{Mn(e,t);break}case m.NOSCRIPT:{e._err(t,ee.nestedNoscriptInHead);break}default:nu(e,t)}}function q9(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=P.IN_HEAD;break}case m.BR:{nu(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function nu(e,t){const r=t.type===$e.EOF?ee.openElementsLeftAfterEof:ee.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=P.IN_HEAD,e._processToken(t)}function V9(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.BODY:{e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=P.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,ae.HTML),e.insertionMode=P.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,ee.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),Mn(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,ee.misplacedStartTagForHeadElement);break}default:su(e,t)}}function W9(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{su(e,t);break}case m.TEMPLATE:{_i(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function su(e,t){e._insertFakeElement(Y.BODY,m.BODY),e.insertionMode=P.IN_BODY,Gh(e,t)}function Gh(e,t){switch(t.type){case $e.CHARACTER:{Uk(e,t);break}case $e.WHITESPACE_CHARACTER:{Bk(e,t);break}case $e.COMMENT:{r0(e,t);break}case $e.START_TAG:{fr(e,t);break}case $e.END_TAG:{Yh(e,t);break}case $e.EOF:{qk(e,t);break}}}function Bk(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Uk(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function G9(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function Y9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function Q9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_FRAMESET)}function K9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML)}function Z9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),t0.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,ae.HTML)}function X9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function J9(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),r||(e.formElement=e.openElements.current))}function e7(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const s=e.openElements.tagIDs[n];if(r===m.LI&&s===m.LI||(r===m.DD||r===m.DT)&&(s===m.DD||s===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s);break}if(s!==m.ADDRESS&&s!==m.DIV&&s!==m.P&&e._isSpecialElement(e.openElements.items[n],s))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML)}function t7(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.tokenizer.state=Rt.PLAINTEXT}function r7(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.framesetOk=!1}function n7(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(Y.A);r&&(Wg(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function s7(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function a7(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(Wg(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function i7(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function l7(e,t){e.treeAdapter.getDocumentMode(e.document)!==sn.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=P.IN_TABLE}function Hk(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ae.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function $k(e){const t=Tk(e,ai.TYPE);return t!=null&&t.toLowerCase()===_9}function o7(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ae.HTML),$k(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function u7(e,t){e._appendElement(t,ae.HTML),t.ackSelfClosing=!0}function c7(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,ae.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function d7(e,t){t.tagName=Y.IMG,t.tagID=m.IMG,Hk(e,t)}function h7(e,t){e._insertElement(t,ae.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Rt.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=P.TEXT}function f7(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Rt.RAWTEXT)}function m7(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Rt.RAWTEXT)}function P1(e,t){e._switchToTextParsing(t,Rt.RAWTEXT)}function p7(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===P.IN_TABLE||e.insertionMode===P.IN_CAPTION||e.insertionMode===P.IN_TABLE_BODY||e.insertionMode===P.IN_ROW||e.insertionMode===P.IN_CELL?P.IN_SELECT_IN_TABLE:P.IN_SELECT}function g7(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML)}function x7(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,ae.HTML)}function y7(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,ae.HTML)}function b7(e,t){e._reconstructActiveFormattingElements(),Dk(t),Vg(t),t.selfClosing?e._appendElement(t,ae.MATHML):e._insertElement(t,ae.MATHML),t.ackSelfClosing=!0}function v7(e,t){e._reconstructActiveFormattingElements(),Mk(t),Vg(t),t.selfClosing?e._appendElement(t,ae.SVG):e._insertElement(t,ae.SVG),t.ackSelfClosing=!0}function D1(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML)}function fr(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{s7(e,t);break}case m.A:{n7(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{Z9(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{K9(e,t);break}case m.LI:case m.DD:case m.DT:{e7(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{Hk(e,t);break}case m.HR:{c7(e,t);break}case m.RB:case m.RTC:{x7(e,t);break}case m.RT:case m.RP:{y7(e,t);break}case m.PRE:case m.LISTING:{X9(e,t);break}case m.XMP:{f7(e,t);break}case m.SVG:{v7(e,t);break}case m.HTML:{G9(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{Mn(e,t);break}case m.BODY:{Y9(e,t);break}case m.FORM:{J9(e,t);break}case m.NOBR:{a7(e,t);break}case m.MATH:{b7(e,t);break}case m.TABLE:{l7(e,t);break}case m.INPUT:{o7(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{u7(e,t);break}case m.IMAGE:{d7(e,t);break}case m.BUTTON:{r7(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{i7(e,t);break}case m.IFRAME:{m7(e,t);break}case m.SELECT:{p7(e,t);break}case m.OPTION:case m.OPTGROUP:{g7(e,t);break}case m.NOEMBED:case m.NOFRAMES:{P1(e,t);break}case m.FRAMESET:{Q9(e,t);break}case m.TEXTAREA:{h7(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?P1(e,t):D1(e,t);break}case m.PLAINTEXT:{t7(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:D1(e,t)}}function w7(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function E7(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,Xk(e,t))}function N7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function k7(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function _7(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(Y.P,m.P),e._closePElement()}function S7(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function T7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function C7(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function j7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function A7(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(Y.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function zk(e,t){const r=t.tagName,n=t.tagID;for(let s=e.openElements.stackTop;s>0;s--){const i=e.openElements.items[s],l=e.openElements.tagIDs[s];if(n===l&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(i)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=s&&e.openElements.shortenToLength(s);break}if(e._isSpecialElement(i,l))break}}function Yh(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{Wg(e,t);break}case m.P:{_7(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{N7(e,t);break}case m.LI:{S7(e);break}case m.DD:case m.DT:{T7(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{C7(e);break}case m.BR:{A7(e);break}case m.BODY:{w7(e,t);break}case m.HTML:{E7(e,t);break}case m.FORM:{k7(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{j7(e,t);break}case m.TEMPLATE:{_i(e,t);break}default:zk(e,t)}}function qk(e,t){e.tmplInsertionModeStack.length>0?Zk(e,t):Gg(e,t)}function I7(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function R7(e,t){e._err(t,ee.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function pm(e,t){if(Fk.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=P.IN_TABLE_TEXT,t.type){case $e.CHARACTER:{Wk(e,t);break}case $e.WHITESPACE_CHARACTER:{Vk(e,t);break}}else hc(e,t)}function L7(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_CAPTION}function O7(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_COLUMN_GROUP}function P7(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(Y.COLGROUP,m.COLGROUP),e.insertionMode=P.IN_COLUMN_GROUP,Yg(e,t)}function D7(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_TABLE_BODY}function M7(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(Y.TBODY,m.TBODY),e.insertionMode=P.IN_TABLE_BODY,Qh(e,t)}function F7(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function B7(e,t){$k(t)?e._appendElement(t,ae.HTML):hc(e,t),t.ackSelfClosing=!0}function U7(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,ae.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function Fl(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{M7(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{Mn(e,t);break}case m.COL:{P7(e,t);break}case m.FORM:{U7(e,t);break}case m.TABLE:{F7(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{D7(e,t);break}case m.INPUT:{B7(e,t);break}case m.CAPTION:{L7(e,t);break}case m.COLGROUP:{O7(e,t);break}default:hc(e,t)}}function Ru(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{_i(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:hc(e,t)}}function hc(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Gh(e,t),e.fosterParentingEnabled=r}function Vk(e,t){e.pendingCharacterTokens.push(t)}function Wk(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function _o(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)hc(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Gk=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function H7(e,t){const r=t.tagID;Gk.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,Fl(e,t)):fr(e,t)}function $7(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,r===m.TABLE&&Ru(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Yh(e,t)}}function Yg(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.COL:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{Mn(e,t);break}default:Jd(e,t)}}function z7(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TEMPLATE:{_i(e,t);break}case m.COL:break;default:Jd(e,t)}}function Jd(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE,e._processToken(t))}function Qh(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(Y.TR,m.TR),e.insertionMode=P.IN_ROW,Kh(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,Fl(e,t));break}default:Fl(e,t)}}function n0(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,Ru(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:Ru(e,t)}}function Kh(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,ae.HTML),e.insertionMode=P.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,Qh(e,t));break}default:Fl(e,t)}}function Yk(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,n0(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,n0(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:Ru(e,t)}}function q7(e,t){const r=t.tagID;Gk.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),Kh(e,t)):fr(e,t)}function V7(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),Yk(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:Yh(e,t)}}function Qk(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,ae.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,ae.HTML);break}case m.HR:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{Mn(e,t);break}}}function Kk(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{_i(e,t);break}}}function W7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Qk(e,t)}function G7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):Kk(e,t)}function Y7(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{Mn(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=P.IN_TABLE,e.insertionMode=P.IN_TABLE,Fl(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=P.IN_COLUMN_GROUP,e.insertionMode=P.IN_COLUMN_GROUP,Yg(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=P.IN_TABLE_BODY,e.insertionMode=P.IN_TABLE_BODY,Qh(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=P.IN_ROW,e.insertionMode=P.IN_ROW,Kh(e,t);break}default:e.tmplInsertionModeStack[0]=P.IN_BODY,e.insertionMode=P.IN_BODY,fr(e,t)}}function Q7(e,t){t.tagID===m.TEMPLATE&&_i(e,t)}function Zk(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):Gg(e,t)}function K7(e,t){t.tagID===m.HTML?fr(e,t):eh(e,t)}function Xk(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=P.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else eh(e,t)}function eh(e,t){e.insertionMode=P.IN_BODY,Gh(e,t)}function Z7(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.FRAMESET:{e._insertElement(t,ae.HTML);break}case m.FRAME:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{Mn(e,t);break}}}function X7(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=P.AFTER_FRAMESET))}function J7(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.NOFRAMES:{Mn(e,t);break}}}function eF(e,t){t.tagID===m.HTML&&(e.insertionMode=P.AFTER_AFTER_FRAMESET)}function tF(e,t){t.tagID===m.HTML?fr(e,t):pd(e,t)}function pd(e,t){e.insertionMode=P.IN_BODY,Gh(e,t)}function rF(e,t){switch(t.tagID){case m.HTML:{fr(e,t);break}case m.NOFRAMES:{Mn(e,t);break}}}function nF(e,t){t.chars=vt,e._insertCharacters(t)}function sF(e,t){e._insertCharacters(t),e.framesetOk=!1}function Jk(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==ae.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function aF(e,t){if(v9(t))Jk(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===ae.MATHML?Dk(t):n===ae.SVG&&(w9(t),Mk(t)),Vg(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function iF(e,t){if(t.tagID===m.P||t.tagID===m.BR){Jk(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===ae.HTML){e._endTagOutsideForeignContent(t);break}const s=e.treeAdapter.getTagName(n);if(s.toLowerCase()===t.tagName){t.tagName=s,e.openElements.shortenToLength(r);break}}}Y.AREA,Y.BASE,Y.BASEFONT,Y.BGSOUND,Y.BR,Y.COL,Y.EMBED,Y.FRAME,Y.HR,Y.IMG,Y.INPUT,Y.KEYGEN,Y.LINK,Y.META,Y.PARAM,Y.SOURCE,Y.TRACK,Y.WBR;const lF=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,oF=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),M1={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function e_(e,t){const r=yF(e),n=JN("type",{handlers:{root:uF,element:cF,text:dF,comment:r_,doctype:hF,raw:mF},unknown:pF}),s={parser:r?new O1(M1):O1.getFragmentParser(void 0,M1),handle(o){n(o,s)},stitches:!1,options:t||{}};n(e,s),ro(s,es());const i=r?s.parser.document:s.parser.getFragment(),l=b8(i,{file:s.options.file});return s.stitches&&Wh(l,"comment",function(o,u,c){const d=o;if(d.value.stitch&&c&&u!==void 0){const h=c.children;return h[u]=d.value.stitch,u}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function t_(e,t){let r=-1;if(e)for(;++r<e.length;)t.handle(e[r])}function uF(e,t){t_(e.children,t)}function cF(e,t){gF(e,t),t_(e.children,t),xF(e,t)}function dF(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const r={type:$e.CHARACTER,chars:e.value,location:fc(e)};ro(t,es(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function hF(e,t){const r={type:$e.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:fc(e)};ro(t,es(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function fF(e,t){t.stitches=!0;const r=bF(e);if("children"in e&&"children"in r){const n=e_({type:"root",children:e.children},t.options);r.children=n.children}r_({type:"comment",value:{stitch:r}},t)}function r_(e,t){const r=e.value,n={type:$e.COMMENT,data:r,location:fc(e)};ro(t,es(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function mF(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,n_(t,es(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(lF,"&lt;$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=t.parser.tokenizer._consume();t.parser.tokenizer._callState(r)}}function pF(e,t){const r=e;if(t.options.passThrough&&t.options.passThrough.includes(r.type))fF(r,t);else{let n="";throw oF.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function ro(e,t){n_(e,t);const r=e.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=e.parser.tokenizer.preprocessor.line,r.location.endCol=e.parser.tokenizer.preprocessor.col+1,r.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Rt.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function n_(e,t){if(t&&t.offset!==void 0){const r={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=r}}function gF(e,t){const r=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Rt.PLAINTEXT)return;ro(t,es(e));const n=t.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:Ga.html;s===Ga.html&&r==="svg"&&(s=Ga.svg);const i=k8({...e,children:[]},{space:s===Ga.svg?"svg":"html"}),l={type:$e.START_TAG,tagName:r,tagID:to(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:fc(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=r}function xF(e,t){const r=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&R8.includes(r)||t.parser.tokenizer.state===Rt.PLAINTEXT)return;ro(t,Uh(e));const n={type:$e.END_TAG,tagName:r,tagID:to(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:fc(e)};t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken),r===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Rt.RCDATA||t.parser.tokenizer.state===Rt.RAWTEXT||t.parser.tokenizer.state===Rt.SCRIPT_DATA)&&(t.parser.tokenizer.state=Rt.DATA)}function yF(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function fc(e){const t=es(e)||{line:void 0,column:void 0,offset:void 0},r=Uh(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function bF(e){return"children"in e?gi({...e,children:[]}):gi(e)}function s_(e){return function(t,r){return e_(t,{...e,file:r})}}const Ma=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],F1={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ma,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ma],h2:[["className","sr-only"]],img:[...Ma,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ma,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ma],table:[...Ma],ul:[...Ma,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Ws={}.hasOwnProperty;function vF(e,t){let r={type:"root",children:[]};const n={schema:t?{...F1,...t}:F1,stack:[]},s=a_(n,e);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function a_(e,t){if(t&&typeof t=="object"){const r=t;switch(typeof r.type=="string"?r.type:""){case"comment":return wF(e,r);case"doctype":return EF(e,r);case"element":return NF(e,r);case"root":return kF(e,r);case"text":return _F(e,r)}}}function wF(e,t){if(e.schema.allowComments){const r=typeof t.value=="string"?t.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return mc(i,t),i}}function EF(e,t){if(e.schema.allowDoctypes){const r={type:"doctype"};return mc(r,t),r}}function NF(e,t){const r=typeof t.tagName=="string"?t.tagName:"";e.stack.push(r);const n=i_(e,t.children),s=SF(e,t.properties);e.stack.pop();let i=!1;if(r&&r!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(r))&&(i=!0,e.schema.ancestors&&Ws.call(e.schema.ancestors,r))){const o=e.schema.ancestors[r];let u=-1;for(i=!1;++u<o.length;)e.stack.includes(o[u])&&(i=!0)}if(!i)return e.schema.strip&&!e.schema.strip.includes(r)?n:void 0;const l={type:"element",tagName:r,properties:s,children:n};return mc(l,t),l}function kF(e,t){const n={type:"root",children:i_(e,t.children)};return mc(n,t),n}function _F(e,t){const n={type:"text",value:typeof t.value=="string"?t.value:""};return mc(n,t),n}function i_(e,t){const r=[];if(Array.isArray(t)){const n=t;let s=-1;for(;++s<n.length;){const i=a_(e,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function SF(e,t){const r=e.stack[e.stack.length-1],n=e.schema.attributes,s=e.schema.required,i=n&&Ws.call(n,r)?n[r]:void 0,l=n&&Ws.call(n,"*")?n["*"]:void 0,o=t&&typeof t=="object"?t:{},u={};let c;for(c in o)if(Ws.call(o,c)){const d=o[c];let h=B1(e,U1(i,c),c,d);h==null&&(h=B1(e,U1(l,c),c,d)),h!=null&&(u[c]=h)}if(s&&Ws.call(s,r)){const d=s[r];for(c in d)Ws.call(d,c)&&!Ws.call(u,c)&&(u[c]=d[c])}return u}function B1(e,t,r,n){return t?Array.isArray(n)?TF(e,t,r,n):l_(e,t,r,n):void 0}function TF(e,t,r,n){let s=-1;const i=[];for(;++s<n.length;){const l=l_(e,t,r,n[s]);(typeof l=="number"||typeof l=="string")&&i.push(l)}return i}function l_(e,t,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&CF(e,r,n)){if(typeof t=="object"&&t.length>1){let s=!1,i=0;for(;++i<t.length;){const l=t[i];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(n))){s=!0;break}}else if(l===n){s=!0;break}}if(!s)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(r)?e.schema.clobberPrefix+n:n}}function CF(e,t,r){const n=e.schema.protocols&&Ws.call(e.schema.protocols,t)?e.schema.protocols[t]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),l=s.indexOf("?"),o=s.indexOf("#"),u=s.indexOf("/");if(i<0||u>-1&&i>u||l>-1&&i>l||o>-1&&i>o)return!0;let c=-1;for(;++c<n.length;){const d=n[c];if(i===d.length&&s.slice(0,d.length)===d)return!0}return!1}function mc(e,t){const r=wN(t);t.data&&(e.data=gi(t.data)),r&&(e.position=r)}function U1(e,t){let r,n=-1;if(e)for(;++n<e.length;){const s=e[n],i=typeof s=="string"?s:s[0];if(i===t)return s;i==="data*"&&(r=s)}if(t.length>4&&t.slice(0,4).toLowerCase()==="data")return r}function o_(e){return function(t){return vF(t,e)}}function gd({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(QN,{remarkPlugins:[bk],rehypePlugins:[s_,o_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function jF({onClose:e,onSelectImage:t}){const[r,n]=w.useState("upload"),[s,i]=w.useState(null),[l,o]=w.useState([]),[u,c]=w.useState(!1),[d,h]=w.useState(null),[f,g]=w.useState(""),[p,y]=w.useState(""),v=async()=>{if(!s)return;c(!0);const b=`${Date.now()}-${s.name}`,{error:E}=await ne.storage.from("images").upload(b,s);if(E){alert("Upload error: "+E.message),c(!1);return}const{publicURL:_,error:k}=ne.storage.from("images").getPublicUrl(b);if(k){alert("Error getting public URL: "+k.message),c(!1);return}t(_,f,p),c(!1),e()},x=async()=>{c(!0);const{data:b,error:E}=await ne.storage.from("images").list("",{limit:100});if(E){alert("Error listing images: "+E.message),c(!1);return}const _=b.map(k=>{const{publicURL:S}=ne.storage.from("images").getPublicUrl(k.name);return S});o(_),c(!1)};return Sn.useEffect(()=>{r==="select"&&x()},[r]),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Select an Image"}),a.jsx("button",{onClick:e,children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex gap-4 mb-4",children:[a.jsx(B,{variant:"secondary",size:"sm",onClick:()=>n("upload"),children:"Upload"}),a.jsx(B,{variant:"secondary",size:"sm",onClick:()=>n("select"),children:"Select"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Width (e.g., 300px or 100%)"}),a.jsx("input",{type:"text",value:f,onChange:b=>g(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Height (e.g., 200px)"}),a.jsx("input",{type:"text",value:p,onChange:b=>y(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),r==="upload"?a.jsxs("div",{children:[a.jsx("input",{type:"file",accept:"image/*",onChange:b=>{b.target.files&&b.target.files[0]&&i(b.target.files[0])}}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(B,{variant:"primary",onClick:v,loading:u,children:"Upload Image"})})]}):a.jsxs("div",{children:[u?a.jsx("p",{children:"Loading images..."}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((b,E)=>a.jsx("img",{src:b,alt:"Stored",className:`cursor-pointer border ${d===b?"border-blue-500":"border-gray-200"}`,onClick:()=>h(b)},E))}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx(B,{variant:"secondary",onClick:()=>n("upload"),children:"Back to Upload"}),a.jsx(B,{variant:"primary",onClick:()=>{d&&(t(d,f,p),e())},disabled:!d,children:"Select Image"})]})]})]})})}function AF({entry:e,onClose:t,onSave:r,onSaveAsTemplate:n}){const[s,i]=w.useState(e),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState(!1),f=async()=>{c(!0);try{await r(s)}finally{c(!1)}},g=async()=>{if(n){c(!0);try{await n(s)}finally{c(!1)}}},p=(y,v,x)=>{let b=`![Image description](${y})`;if(v||x){const E=[];v&&E.push(`width="${v}"`),x&&E.push(`height="${x}"`),b+=`{${E.join(" ")}}`}i({...s,content:s.content+`
`+b+`
`})};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"border-b p-4 flex items-center justify-between bg-white",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(B,{variant:"secondary",icon:Lh,onClick:t,children:"Back"}),a.jsx("h2",{className:"text-xl font-bold",children:s.title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{variant:"secondary",icon:l?NE:kE,onClick:()=>o(!l),children:l?"Edit":"Preview"}),n&&a.jsx(B,{variant:"secondary",onClick:g,loading:u,children:"Save as Template"}),a.jsx(B,{variant:"primary",icon:Gt,onClick:f,loading:u,children:"Save"})]})]}),!l&&a.jsxs("div",{className:"border-b p-2 flex items-center gap-2 bg-white",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:s4,onClick:()=>{const y=document.querySelector("textarea");if(y){const v=y.selectionStart,x=y.selectionEnd,b=y.value,E=b.substring(0,v),_=b.substring(v,x),k=b.substring(x);i({...s,content:`${E}**${_}**${k}`})}},children:"Bold"}),a.jsx(B,{variant:"secondary",size:"sm",icon:y4,onClick:()=>{const y=document.querySelector("textarea");if(y){const v=y.selectionStart,x=y.selectionEnd,b=y.value,E=b.substring(0,v),_=b.substring(v,x),k=b.substring(x);i({...s,content:`${E}_${_}_${k}`})}},children:"Italic"}),a.jsx("div",{className:"w-px h-6 bg-gray-300"}),a.jsx(B,{variant:"secondary",size:"sm",icon:M4,onClick:()=>{i({...s,content:s.content+`
| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
`})},children:"Table"}),a.jsx(B,{variant:"secondary",size:"sm",icon:Mp,onClick:()=>h(!0),children:"Image"}),a.jsx(B,{variant:"secondary",size:"sm",icon:v4,onClick:()=>{i({...s,content:s.content+"[Link text](https://example.com)"})},children:"Link"}),a.jsx(B,{variant:"secondary",size:"sm",icon:Pl,onClick:()=>{i({...s,content:s.content+`
> ### Note
> This is a note block for important information.
`})},children:"Note"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs("div",{className:"h-full flex",children:[!l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:s.title,onChange:y=>i({...s,title:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:s.category,onChange:y=>i({...s,category:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx("textarea",{value:s.content,onChange:y=>i({...s,content:y.target.value}),rows:20,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono bg-white"})]})]})}),l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50 homebrew",children:a.jsxs("div",{className:"max-w-4xl mx-auto prose",children:[a.jsx("h1",{children:s.title}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.category})}),a.jsx(gd,{content:s.content})]})})]})}),d&&a.jsx(jF,{onClose:()=>h(!1),onSelectImage:(y,v,x)=>{p(y,v,x)}})]})}function IF(){const{user:e,isAdmin:t}=$t(),r=cn(),[n,s]=w.useState(""),[i,l]=w.useState(null),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState([]),[g,p]=w.useState(new Set),{data:y=[],isLoading:v,error:x}=Lt({queryKey:["compendiumEntries"],queryFn:A5}),{data:b=[],isLoading:E,error:_}=Lt({queryKey:["compendiumTemplates"],queryFn:I5}),k=v||E,S=(x==null?void 0:x.message)||(_==null?void 0:_.message)||null;w.useEffect(()=>{I()},[]);const I=()=>{const V=localStorage.getItem("compendium_bookmarks");V&&f(JSON.parse(V))},A=V=>{const K=V.content.slice(0,100)+"...";f(O=>{const N=O.some(z=>z.id===V.id)?O.filter(z=>z.id!==V.id):[...O,{...V,preview:K}];return localStorage.setItem("compendium_bookmarks",JSON.stringify(N)),N})},D=V=>{p(K=>{const O=new Set(K);return O.has(V)?O.delete(V):O.add(V),O})},T=w.useMemo(()=>{if(n)return[];const V=y.reduce((K,O)=>{const Z=O.category??"Uncategorized";return K[Z]||(K[Z]=[]),K[Z].push(O),K},{});return Object.entries(V).sort(([K],[O])=>K.localeCompare(O))},[y,n]),H=w.useMemo(()=>n?y.filter(V=>V.title.toLowerCase().includes(n.toLowerCase())||V.content.toLowerCase().includes(n.toLowerCase())):[],[y,n]),L=Et({mutationFn:async V=>{if(V.id){const{error:K}=await ne.from("compendium").update({title:V.title,content:V.content,category:V.category,updated_at:new Date().toISOString()}).eq("id",V.id);if(K)throw K}else{const{error:K}=await ne.from("compendium").insert([{title:V.title,content:V.content,category:V.category,created_by:e==null?void 0:e.id}]);if(K)throw K}},onSuccess:()=>{r.invalidateQueries({queryKey:["compendiumEntries"]}),d(null)},onError:V=>{console.error("Save error:",V)}}),G=V=>{L.mutate(V)},Q=()=>{d({title:"",content:"",category:i||"",created_by:e==null?void 0:e.id})},$=()=>{u(null),s("")};return k?a.jsx(He,{size:"lg",className:"mx-auto mt-12"}):S?a.jsx(Ne,{message:S,className:"m-8"}):a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsx("div",{className:"w-80 bg-white border-r flex flex-col",children:a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Compendium"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(B,{variant:"secondary",size:"sm",onClick:$,children:"Home"}),t()&&a.jsx(B,{variant:"primary",size:"sm",icon:Kt,onClick:Q,children:"New Entry"})]})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search compendium...",value:n,onChange:V=>s(V.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n===""&&a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(([V,K])=>a.jsxs("div",{className:"border-b",children:[a.jsxs("div",{onClick:()=>D(V),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[g.has(V)?a.jsx(Oh,{className:"w-4 h-4 text-gray-500"}):a.jsx(Vs,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:V})]}),a.jsx("span",{className:"text-sm text-gray-500",children:K.length})]}),g.has(V)&&a.jsx("div",{className:"bg-gray-50",children:K.map(O=>a.jsx("div",{onClick:()=>u(O),className:`px-8 py-2 cursor-pointer hover:bg-gray-100 ${(o==null?void 0:o.id)===O.id?"bg-blue-50":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:O.title}),h.some(Z=>Z.id===O.id)&&a.jsx(Vy,{className:"w-4 h-4 text-blue-500"})]})},O.id))})]},V))})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-95 z-10 p-6 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Search Results"}),a.jsx(B,{variant:"secondary",size:"sm",onClick:()=>s(""),children:"Clear Search"})]}),H.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:H.map(V=>a.jsxs("div",{onClick:()=>{u(V),s("")},className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:V.title}),a.jsx("div",{className:"homebrew",children:a.jsx(gd,{content:V.content.slice(0,200)+"..."})})]},V.id))}):a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-gray-500",children:['No results found for "',n,'".']})})]}),o&&!n?a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:h.some(V=>V.id===o.id)?Vy:i4,onClick:()=>A(o),children:h.some(V=>V.id===o.id)?"Bookmarked":"Bookmark"}),t()&&a.jsx(B,{variant:"secondary",size:"sm",icon:ac,onClick:()=>d(o),children:"Edit"})]})]}),a.jsx("div",{className:"homebrew",children:a.jsx(gd,{content:o.content})})]}):!o&&!n&&a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bookmarked Entries"}),h.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(V=>a.jsxs("div",{onClick:()=>u(V),className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:V.title}),a.jsx("div",{className:"homebrew",children:a.jsx(gd,{content:V.preview})})]},V.id))}):a.jsxs("div",{className:"text-center",children:[a.jsx(nc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Welcome to the Compendium"}),a.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Use the sidebar to search and browse entries, or add new ones if you're an admin."})]})]})]}),c&&a.jsx(AF,{entry:c,onClose:()=>d(null),onSave:G})]})}async function RF(e,t){if(!e)return[];let r=ne.from("parties").select(`
    id,
    name,
    description,
    created_by,
    created_at,
    members:party_members!left (
      characters!inner (
        *
      )
    )
  `);t?r=r.eq("created_by",e):r=r.eq("members.characters.user_id",e);const{data:n,error:s}=await r.order("created_at",{ascending:!1});if(s)throw console.error("Error fetching parties:",s),new Error(s.message||"Failed to fetch parties");return(n||[]).map(l=>({...l,members:(l.members||[]).map(o=>o.characters?Zl(o.characters):null).filter(o=>!!o)}))}async function u_(e){if(!e)return[];const{data:t,error:r}=await ne.from("party_members").select("character_id");if(r)throw console.error("Error fetching party member IDs:",r),new Error(r.message||"Failed to fetch member data");const n=(t||[]).map(o=>o.character_id);let s=ne.from("characters").select("*").eq("user_id",e);n.length>0&&(s=s.not("id","in",`(${n.join(",")})`));const{data:i,error:l}=await s;if(l)throw console.error("Error fetching available characters:",l),new Error(l.message||"Failed to fetch available characters");return(i||[]).map(Zl)}async function LF(e){if(!e)return null;const{data:t,error:r}=await ne.from("parties").select(`
      id,
      name,
      description,
      created_by,
      created_at,
			invite_code,
      members:party_members (
        characters (
          *
        )
      )
    `).eq("id",e).single();if(r)throw console.error("Error fetching party by ID:",r),r.code==="PGRST116"?new Error("Party not found"):new Error(r.message||"Failed to fetch party");return t?{...t,members:(t.members||[]).map(s=>s.characters?Zl(s.characters):null).filter(s=>!!s)}:null}async function OF(e,t){const{error:r}=await ne.from("party_members").delete().match({party_id:e,character_id:t});if(r)throw console.error("Error removing party member:",r),new Error(r.message||"Failed to remove party member");const{error:n}=await ne.from("characters").update({party_id:null}).eq("id",t);n&&console.error("Error clearing character party link:",n)}async function PF(e){const{error:t}=await ne.from("parties").delete().eq("id",e);if(t)throw console.error("Error deleting party:",t),new Error(t.message||"Failed to delete party")}function DF(){const{user:e,isDM:t}=$t(),r=dn(),n=cn(),[s,i]=w.useState(!1),[l,o]=w.useState(""),[u,c]=w.useState([]),{data:d=[],isLoading:h,error:f}=Lt({queryKey:["parties",e==null?void 0:e.id,t()],queryFn:()=>RF(e==null?void 0:e.id,t()),enabled:!!e}),{data:g=[],isLoading:p,error:y}=Lt({queryKey:["availableCharacters",e==null?void 0:e.id],queryFn:()=>u_(e==null?void 0:e.id),enabled:!!e&&s}),v=h||s&&p,x=(f==null?void 0:f.message)||(y==null?void 0:y.message)||null,b=Et({mutationFn:async({name:_,characterIds:k})=>{if(!_.trim())throw new Error("Party name is required");if(!e)throw new Error("User not authenticated");const{data:S,error:I}=await ne.from("parties").insert([{name:_,created_by:e.id}]).select().single();if(I)throw I;if(!S)throw new Error("Party creation failed");if(k.length>0){const A=k.map(T=>({party_id:S.id,character_id:T})),{error:D}=await ne.from("party_members").insert(A);if(D)throw await ne.from("parties").delete().eq("id",S.id),D}return S},onSuccess:()=>{n.invalidateQueries({queryKey:["parties",e==null?void 0:e.id,t()]}),n.invalidateQueries({queryKey:["availableCharacters",e==null?void 0:e.id]}),o(""),c([]),i(!1)}}),E=()=>{b.mutate({name:l,characterIds:u})};return v&&!s?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(He,{size:"lg"})}):x&&!s?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:x})}):a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jn,{className:"w-6 h-6 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Adventure Parties"})]}),t()&&a.jsx(B,{variant:"primary",icon:Kt,onClick:()=>i(!0),disabled:s,children:"Create Party"})]}),x&&!b.error&&!s&&a.jsx("div",{className:"mb-6",children:a.jsx(Ne,{message:x})}),s&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Party"}),b.error&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:b.error.message})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partyName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name"}),a.jsx("input",{type:"text",id:"partyName",value:l,onChange:_=>o(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Initial Characters (Optional)"}),p?a.jsx(He,{}):y?a.jsx(Ne,{message:y.message}):g.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-60 overflow-y-auto p-2 border rounded-md",children:g.map(_=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer ${u.includes(_.id||"")?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>{_.id&&c(k=>k.includes(_.id)?k.filter(S=>S!==_.id):[...k,_.id])},children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mi,{className:"w-4 h-4 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-sm",children:_.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[_.kin," ",_.profession]})]})]})},_.id))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No available characters to add."})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(B,{variant:"secondary",onClick:()=>i(!1),disabled:b.isPending,children:"Cancel"}),a.jsx(B,{variant:"primary",onClick:E,loading:b.isPending,disabled:!l.trim()||b.isPending,children:"Create Party"})]})]})]}),!s&&(d.length>0?a.jsx("div",{className:"grid gap-6",children:d.map(_=>a.jsxs("div",{onClick:()=>r(`/party/${_.id}`),className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg hover:border-blue-400 border border-transparent transition-all cursor-pointer",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:_.name}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[_.members.map(k=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mi,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:k.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[k.kin," ",k.profession]})]})]})},k.id)),_.members.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic col-span-full",children:"No members yet."})]})]},_.id))}):a.jsx(Hp,{icon:jn,title:"No Adventure Parties",description:t()?"You haven't created any parties yet.":"You're not currently in any adventure parties.",action:t()?a.jsx(B,{variant:"primary",icon:Kt,onClick:()=>i(!0),children:"Create Your First Party"}):void 0}))]})}function Qg({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(QN,{remarkPlugins:[bk],rehypePlugins:[s_,o_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function MF(){const{user:e,isDM:t}=$t(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState([]),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState(null),[p,y]=w.useState(""),[v,x]=w.useState(""),[b,E]=w.useState(""),[_,k]=w.useState(""),[S,I]=w.useState(""),[A,D]=w.useState("all"),[T,H]=w.useState(!0),[L,G]=w.useState(null),[Q,$]=w.useState(null),V=w.useCallback(()=>{y(""),x(""),E(""),k(""),$(null)},[]),K=()=>{V(),h(!0),g(null),c(null)},O=q=>{c(q),g(q.id),h(!1),y(q.title),x(q.content),E(q.character_id||""),k(q.party_id||""),$(null)},Z=()=>{h(!1),g(null),V(),f&&c(null)},N=w.useCallback(async()=>{if(e){H(!0),G(null);try{const q=new Map,{data:J,error:te}=await ne.from("notes").select("*, character:characters(name), party:parties(name)").eq("user_id",e.id);if(te)throw te;if((J||[]).forEach(ve=>q.set(ve.id,ve)),t()){const{data:ve,error:Ae}=await ne.from("parties").select("id").eq("created_by",e.id);if(Ae)throw Ae;const we=(ve||[]).map(Ze=>Ze.id);if(we.length>0){const{data:Ze,error:tt}=await ne.from("notes").select("*, character:characters(name), party:parties(name)").in("party_id",we);if(tt)throw tt;(Ze||[]).forEach(ct=>q.set(ct.id,ct))}}const de=Array.from(q.values()).sort((ve,Ae)=>new Date(Ae.created_at).getTime()-new Date(ve.created_at).getTime());n(de)}catch(q){console.error("Error loading notes:",q),G(q instanceof Error?q.message:"Failed to load notes"),n([])}finally{H(!1)}}},[e,t]),z=w.useCallback(async()=>{if(e)try{const{data:q,error:J}=await ne.from("characters").select("id, name").eq("user_id",e.id);if(J)throw J;i(q||[])}catch(q){console.error("Error loading characters:",q),G(J=>J||(q instanceof Error?q.message:"Failed to load characters"))}},[e]),U=w.useCallback(async()=>{if(!(!e||!t()))try{const{data:q,error:J}=await ne.from("parties").select("id, name").eq("created_by",e.id);if(J)throw J;o(q||[])}catch(q){console.error("Error loading parties:",q),G(J=>J||(q instanceof Error?q.message:"Failed to load parties"))}},[e,t]);w.useEffect(()=>{e?(N(),z(),t()&&U()):(H(!1),n([]),i([]),o([]),c(null),Z())},[e,t,N,z,U]);async function j(){if(!e){$("User not authenticated.");return}if(!p.trim()){$("Title is required.");return}$(null);const q=b||null,J=_||null;if(q&&J){$("A note can be linked to either a character OR a party, not both.");return}const te={title:p.trim(),content:v,user_id:e.id,character_id:q,party_id:J,updated_at:new Date().toISOString()};try{let de=null;if(f){const{data:ve,error:Ae}=await ne.from("notes").update(te).eq("id",f).select("*, character:characters(name), party:parties(name)").single();if(Ae)throw Ae;de=ve}else{const{updated_at:ve,...Ae}=te,{data:we,error:Ze}=await ne.from("notes").insert([Ae]).select("*, character:characters(name), party:parties(name)").single();if(Ze)throw Ze;de=we}Z(),await N(),de&&c(de)}catch(de){console.error("Error saving note:",de),$(de instanceof Error?`Failed to save note: ${de.message}`:"An unknown error occurred.")}}async function me(q){if(window.confirm("Are you sure you want to delete this note?"))try{G(null);const{error:J}=await ne.from("notes").delete().eq("id",q);if(J)throw J;await N(),(u==null?void 0:u.id)===q&&c(null),f===q&&Z()}catch(J){console.error("Error deleting note:",J),G(J instanceof Error?`Failed to delete note: ${J.message}`:"An unknown error occurred.")}}const X=r.filter(q=>{const J=q.title.toLowerCase().includes(S.toLowerCase())||q.content.toLowerCase().includes(S.toLowerCase()),te=A==="all"||A==="personal"&&!q.character_id&&!q.party_id||A==="character"&&!!q.character_id||A==="party"&&!!q.party_id;return J&&te});if(T&&r.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[a.jsx(He,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading notes..."})]});const W=d||f;return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(nc,{className:"w-6 h-6 text-blue-600"}),"Notes"]}),a.jsx(B,{variant:"primary",size:"sm",icon:Kt,onClick:K,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:S,onChange:q=>I(q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:A,onChange:q=>D(q.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white","aria-label":"Filter notes",children:[a.jsx("option",{value:"all",children:"All Notes"}),a.jsx("option",{value:"personal",children:"My Personal Notes"}),a.jsx("option",{value:"character",children:"Character Notes"}),a.jsx("option",{value:"party",children:"Party Notes"})]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Oh,{className:"w-4 h-4 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[L&&!W&&a.jsx("div",{className:"p-4",children:a.jsx(Ne,{message:L,onClose:()=>G(null)})}),X.length>0?X.map(q=>a.jsxs("div",{onClick:()=>{(!f||f!==q.id)&&(c(q),h(!1),g(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(u==null?void 0:u.id)===q.id&&!W?"bg-blue-50 border-l-4 border-blue-500":""} ${f===q.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:q.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:q.content.substring(0,50)+(q.content.length>50?"...":"")}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:q.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:["Char: ",q.character.name]}):q.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-xs",children:["Party: ",q.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-xs",children:"Personal"})})]},q.id)):!T&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Pl,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),S||A!=="all"?"No notes match.":"No notes yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:W?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Note":"Create New Note"}),a.jsx("button",{onClick:Z,className:"text-gray-500 hover:text-gray-700","aria-label":"Close form",children:a.jsx(Pt,{className:"w-5 h-5"})})]}),Q&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:Q,onClose:()=>$(null)})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"title",value:p,onChange:q=>y(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter note title",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"character",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Character (Optional)"}),a.jsxs("select",{id:"character",value:b,onChange:q=>{E(q.target.value),q.target.value&&k("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!_,children:[a.jsx("option",{value:"",children:"None"}),s.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]})]}),t()&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Party (Optional, DM Only)"}),a.jsxs("select",{id:"party",value:_,onChange:q=>{k(q.target.value),q.target.value&&E("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!b,children:[a.jsx("option",{value:"",children:"None"}),l.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"content",value:v,onChange:q=>x(q.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter note content..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use Markdown for formatting."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx(B,{variant:"secondary",onClick:Z,children:"Cancel"}),a.jsx(B,{variant:"primary",icon:Gt,onClick:j,disabled:!p.trim(),children:f?"Update Note":"Save Note"})]})]})]}):u?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:u.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:u.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["Character: ",u.character.name]}):u.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Party: ",u.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Personal"})})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:ac,onClick:()=>O(u),children:"Edit"}),a.jsx(B,{variant:"danger_outline",size:"sm",icon:ur,onClick:()=>me(u.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Qg,{content:u.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(u.created_at).toLocaleDateString(),u.updated_at&&new Date(u.updated_at).getTime()!==new Date(u.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(u.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Pl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),L&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ne,{message:L,onClose:()=>G(null)})})]})})]})}var Qe;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const i={};for(const l of s)i[l]=l;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),l={};for(const o of i)l[o]=s[o];return e.objectValues(l)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&i.push(l);return i},e.find=(s,i)=>{for(const l of s)if(i(l))return l},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qe||(Qe={}));var s0;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(s0||(s0={}));const ye=Qe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ds=e=>{switch(typeof e){case"undefined":return ye.undefined;case"string":return ye.string;case"number":return isNaN(e)?ye.nan:ye.number;case"boolean":return ye.boolean;case"function":return ye.function;case"bigint":return ye.bigint;case"symbol":return ye.symbol;case"object":return Array.isArray(e)?ye.array:e===null?ye.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ye.promise:typeof Map<"u"&&e instanceof Map?ye.map:typeof Set<"u"&&e instanceof Set?ye.set:typeof Date<"u"&&e instanceof Date?ye.date:ye.object;default:return ye.unknown}},le=Qe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),FF=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Wr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},s=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let o=n,u=0;for(;u<l.path.length;){const c=l.path[u];u===l.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(l))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),n}static assert(t){if(!(t instanceof Wr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Wr.create=e=>new Wr(e);const Bl=(e,t)=>{let r;switch(e.code){case le.invalid_type:e.received===ye.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case le.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Qe.jsonStringifyReplacer)}`;break;case le.unrecognized_keys:r=`Unrecognized key(s) in object: ${Qe.joinValues(e.keys,", ")}`;break;case le.invalid_union:r="Invalid input";break;case le.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Qe.joinValues(e.options)}`;break;case le.invalid_enum_value:r=`Invalid enum value. Expected ${Qe.joinValues(e.options)}, received '${e.received}'`;break;case le.invalid_arguments:r="Invalid function arguments";break;case le.invalid_return_type:r="Invalid function return type";break;case le.invalid_date:r="Invalid date";break;case le.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Qe.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case le.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case le.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case le.custom:r="Invalid input";break;case le.invalid_intersection_types:r="Intersection results could not be merged";break;case le.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case le.not_finite:r="Number must be finite";break;default:r=t.defaultError,Qe.assertNever(e)}return{message:r}};let c_=Bl;function BF(e){c_=e}function th(){return c_}const rh=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],l={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)o=c(l,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},UF=[];function pe(e,t){const r=th(),n=rh({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Bl?void 0:Bl].filter(s=>!!s)});e.common.issues.push(n)}class dr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return je;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const i=await s.key,l=await s.value;n.push({key:i,value:l})}return dr.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:i,value:l}=s;if(i.status==="aborted"||l.status==="aborted")return je;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const je=Object.freeze({status:"aborted"}),Xi=e=>({status:"dirty",value:e}),wr=e=>({status:"valid",value:e}),a0=e=>e.status==="aborted",i0=e=>e.status==="dirty",xi=e=>e.status==="valid",Lu=e=>typeof Promise<"u"&&e instanceof Promise;function nh(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function d_(e,t,r,n,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var Ee;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ee||(Ee={}));var Oo,Po;class Xn{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const H1=(e,t)=>{if(xi(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Wr(e.common.issues);return this._error=r,this._error}}};function De(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(l,o)=>{var u,c;const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}},description:s}}class Ue{get description(){return this._def.description}_getType(t){return ds(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:ds(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new dr,ctx:{common:t.parent.common,data:t.data,parsedType:ds(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Lu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ds(t)},i=this._parseSync({data:t,path:s.path,parent:s});return H1(s,i)}"~validate"(t){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ds(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return xi(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>xi(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ds(t)},s=this._parse({data:t,path:n.path,parent:n}),i=await(Lu(s)?s:Promise.resolve(s));return H1(n,i)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const l=t(s),o=()=>i.addIssue({code:le.custom,...n(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new Pn({schema:this,typeName:Te.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Kn.create(this,this._def)}nullable(){return ka.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Rn.create(this)}promise(){return Hl.create(this,this._def)}or(t){return Mu.create([this,t],this._def)}and(t){return Fu.create(this,t,this._def)}transform(t){return new Pn({...De(this._def),schema:this,typeName:Te.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new zu({...De(this._def),innerType:this,defaultValue:r,typeName:Te.ZodDefault})}brand(){return new Kg({typeName:Te.ZodBranded,type:this,...De(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new qu({...De(this._def),innerType:this,catchValue:r,typeName:Te.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return pc.create(this,t)}readonly(){return Vu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const HF=/^c[^\s-]{8,}$/i,$F=/^[0-9a-z]+$/,zF=/^[0-9A-HJKMNP-TV-Z]{26}$/i,qF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,VF=/^[a-z0-9_-]{21}$/i,WF=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,GF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,YF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,QF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let gm;const KF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ZF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,XF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,JF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eB=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tB=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,h_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rB=new RegExp(`^${h_}$`);function f_(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function nB(e){return new RegExp(`^${f_(e)}$`)}function m_(e){let t=`${h_}T${f_(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function sB(e,t){return!!((t==="v4"||!t)&&KF.test(e)||(t==="v6"||!t)&&XF.test(e))}function aB(e,t){if(!WF.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function iB(e,t){return!!((t==="v4"||!t)&&ZF.test(e)||(t==="v6"||!t)&&JF.test(e))}class _n extends Ue{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ye.string){const i=this._getOrReturnCtx(t);return pe(i,{code:le.invalid_type,expected:ye.string,received:i.parsedType}),je}const n=new dr;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(s=this._getOrReturnCtx(t,s),l?pe(s,{code:le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&pe(s,{code:le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")YF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"email",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")gm||(gm=new RegExp(QF,"u")),gm.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"emoji",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")qF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"uuid",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")VF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"nanoid",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")HF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")$F.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid2",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")zF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ulid",code:le.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),pe(s,{validation:"url",code:le.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"regex",code:le.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?m_(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?rB.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?nB(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:le.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?GF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"duration",code:le.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?sB(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ip",code:le.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?aB(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"jwt",code:le.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?iB(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cidr",code:le.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?eB.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64",code:le.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?tB.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64url",code:le.invalid_string,message:i.message}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:le.invalid_string,...Ee.errToObj(n)})}_addCheck(t){return new _n({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ee.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ee.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ee.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ee.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ee.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ee.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ee.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ee.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ee.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ee.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ee.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ee.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ee.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...Ee.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ee.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ee.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Ee.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Ee.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Ee.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Ee.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Ee.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Ee.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Ee.errToObj(r)})}nonempty(t){return this.min(1,Ee.errToObj(t))}trim(){return new _n({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _n({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _n({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}_n.create=e=>{var t;return new _n({checks:[],typeName:Te.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...De(e)})};function lB(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(e.toFixed(s).replace(".","")),l=parseInt(t.toFixed(s).replace(".",""));return i%l/Math.pow(10,s)}class wa extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ye.number){const i=this._getOrReturnCtx(t);return pe(i,{code:le.invalid_type,expected:ye.number,received:i.parsedType}),je}let n;const s=new dr;for(const i of this._def.checks)i.kind==="int"?Qe.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:le.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?lB(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:le.not_finite,message:i.message}),s.dirty()):Qe.assertNever(i);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Ee.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ee.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ee.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ee.toString(r))}setLimit(t,r,n,s){return new wa({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Ee.toString(s)}]})}_addCheck(t){return new wa({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ee.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ee.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ee.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ee.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ee.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ee.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Ee.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ee.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ee.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qe.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}wa.create=e=>new wa({checks:[],typeName:Te.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...De(e)});class Ea extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ye.bigint)return this._getInvalidInput(t);let n;const s=new dr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:le.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qe.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return pe(r,{code:le.invalid_type,expected:ye.bigint,received:r.parsedType}),je}gte(t,r){return this.setLimit("min",t,!0,Ee.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ee.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ee.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ee.toString(r))}setLimit(t,r,n,s){return new Ea({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Ee.toString(s)}]})}_addCheck(t){return new Ea({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ee.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ee.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ee.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ee.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ee.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ea.create=e=>{var t;return new Ea({checks:[],typeName:Te.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...De(e)})};class Ou extends Ue{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ye.boolean){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.boolean,received:n.parsedType}),je}return wr(t.data)}}Ou.create=e=>new Ou({typeName:Te.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...De(e)});class yi extends Ue{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ye.date){const i=this._getOrReturnCtx(t);return pe(i,{code:le.invalid_type,expected:ye.date,received:i.parsedType}),je}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pe(i,{code:le.invalid_date}),je}const n=new dr;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:le.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:le.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new yi({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Ee.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Ee.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}yi.create=e=>new yi({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Te.ZodDate,...De(e)});class sh extends Ue{_parse(t){if(this._getType(t)!==ye.symbol){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.symbol,received:n.parsedType}),je}return wr(t.data)}}sh.create=e=>new sh({typeName:Te.ZodSymbol,...De(e)});class Pu extends Ue{_parse(t){if(this._getType(t)!==ye.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.undefined,received:n.parsedType}),je}return wr(t.data)}}Pu.create=e=>new Pu({typeName:Te.ZodUndefined,...De(e)});class Du extends Ue{_parse(t){if(this._getType(t)!==ye.null){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.null,received:n.parsedType}),je}return wr(t.data)}}Du.create=e=>new Du({typeName:Te.ZodNull,...De(e)});class Ul extends Ue{constructor(){super(...arguments),this._any=!0}_parse(t){return wr(t.data)}}Ul.create=e=>new Ul({typeName:Te.ZodAny,...De(e)});class ii extends Ue{constructor(){super(...arguments),this._unknown=!0}_parse(t){return wr(t.data)}}ii.create=e=>new ii({typeName:Te.ZodUnknown,...De(e)});class _s extends Ue{_parse(t){const r=this._getOrReturnCtx(t);return pe(r,{code:le.invalid_type,expected:ye.never,received:r.parsedType}),je}}_s.create=e=>new _s({typeName:Te.ZodNever,...De(e)});class ah extends Ue{_parse(t){if(this._getType(t)!==ye.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.void,received:n.parsedType}),je}return wr(t.data)}}ah.create=e=>new ah({typeName:Te.ZodVoid,...De(e)});class Rn extends Ue{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==ye.array)return pe(r,{code:le.invalid_type,expected:ye.array,received:r.parsedType}),je;if(s.exactLength!==null){const l=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(l||o)&&(pe(r,{code:l?le.too_big:le.too_small,minimum:o?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(pe(r,{code:le.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(pe(r,{code:le.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>s.type._parseAsync(new Xn(r,l,r.path,o)))).then(l=>dr.mergeArray(n,l));const i=[...r.data].map((l,o)=>s.type._parseSync(new Xn(r,l,r.path,o)));return dr.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new Rn({...this._def,minLength:{value:t,message:Ee.toString(r)}})}max(t,r){return new Rn({...this._def,maxLength:{value:t,message:Ee.toString(r)}})}length(t,r){return new Rn({...this._def,exactLength:{value:t,message:Ee.toString(r)}})}nonempty(t){return this.min(1,t)}}Rn.create=(e,t)=>new Rn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Te.ZodArray,...De(t)});function Fi(e){if(e instanceof Nt){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Kn.create(Fi(n))}return new Nt({...e._def,shape:()=>t})}else return e instanceof Rn?new Rn({...e._def,type:Fi(e.element)}):e instanceof Kn?Kn.create(Fi(e.unwrap())):e instanceof ka?ka.create(Fi(e.unwrap())):e instanceof Jn?Jn.create(e.items.map(t=>Fi(t))):e}class Nt extends Ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Qe.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ye.object){const c=this._getOrReturnCtx(t);return pe(c,{code:le.invalid_type,expected:ye.object,received:c.parsedType}),je}const{status:n,ctx:s}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof _s&&this._def.unknownKeys==="strip"))for(const c in s.data)l.includes(c)||o.push(c);const u=[];for(const c of l){const d=i[c],h=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new Xn(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof _s){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")o.length>0&&(pe(s,{code:le.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new Xn(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const h=await d.key,f=await d.value;c.push({key:h,value:f,alwaysSet:d.alwaysSet})}return c}).then(c=>dr.mergeObjectSync(n,c)):dr.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return Ee.errToObj,new Nt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var s,i,l,o;const u=(l=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&l!==void 0?l:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=Ee.errToObj(t).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Nt({...this._def,unknownKeys:"strip"})}passthrough(){return new Nt({...this._def,unknownKeys:"passthrough"})}extend(t){return new Nt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Nt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Te.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Nt({...this._def,catchall:t})}pick(t){const r={};return Qe.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Nt({...this._def,shape:()=>r})}omit(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Nt({...this._def,shape:()=>r})}deepPartial(){return Fi(this)}partial(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}),new Nt({...this._def,shape:()=>r})}required(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Kn;)i=i._def.innerType;r[n]=i}}),new Nt({...this._def,shape:()=>r})}keyof(){return p_(Qe.objectKeys(this.shape))}}Nt.create=(e,t)=>new Nt({shape:()=>e,unknownKeys:"strip",catchall:_s.create(),typeName:Te.ZodObject,...De(t)});Nt.strictCreate=(e,t)=>new Nt({shape:()=>e,unknownKeys:"strict",catchall:_s.create(),typeName:Te.ZodObject,...De(t)});Nt.lazycreate=(e,t)=>new Nt({shape:e,unknownKeys:"strip",catchall:_s.create(),typeName:Te.ZodObject,...De(t)});class Mu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Wr(o.ctx.common.issues));return pe(r,{code:le.invalid_union,unionErrors:l}),je}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(s);{let i;const l=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(u=>new Wr(u));return pe(r,{code:le.invalid_union,unionErrors:o}),je}}get options(){return this._def.options}}Mu.create=(e,t)=>new Mu({options:e,typeName:Te.ZodUnion,...De(t)});const is=e=>e instanceof Uu?is(e.schema):e instanceof Pn?is(e.innerType()):e instanceof Hu?[e.value]:e instanceof Na?e.options:e instanceof $u?Qe.objectValues(e.enum):e instanceof zu?is(e._def.innerType):e instanceof Pu?[void 0]:e instanceof Du?[null]:e instanceof Kn?[void 0,...is(e.unwrap())]:e instanceof ka?[null,...is(e.unwrap())]:e instanceof Kg||e instanceof Vu?is(e.unwrap()):e instanceof qu?is(e._def.innerType):[];class Zh extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.object)return pe(r,{code:le.invalid_type,expected:ye.object,received:r.parsedType}),je;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(pe(r,{code:le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),je)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const s=new Map;for(const i of r){const l=is(i.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of l){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new Zh({typeName:Te.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:s,...De(n)})}}function l0(e,t){const r=ds(e),n=ds(t);if(e===t)return{valid:!0,data:e};if(r===ye.object&&n===ye.object){const s=Qe.objectKeys(t),i=Qe.objectKeys(e).filter(o=>s.indexOf(o)!==-1),l={...e,...t};for(const o of i){const u=l0(e[o],t[o]);if(!u.valid)return{valid:!1};l[o]=u.data}return{valid:!0,data:l}}else if(r===ye.array&&n===ye.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const l=e[i],o=t[i],u=l0(l,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===ye.date&&n===ye.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Fu extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(i,l)=>{if(a0(i)||a0(l))return je;const o=l0(i.value,l.value);return o.valid?((i0(i)||i0(l))&&r.dirty(),{status:r.value,value:o.data}):(pe(n,{code:le.invalid_intersection_types}),je)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>s(i,l)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Fu.create=(e,t,r)=>new Fu({left:e,right:t,typeName:Te.ZodIntersection,...De(r)});class Jn extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.array)return pe(n,{code:le.invalid_type,expected:ye.array,received:n.parsedType}),je;if(n.data.length<this._def.items.length)return pe(n,{code:le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&n.data.length>this._def.items.length&&(pe(n,{code:le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Xn(n,l,n.path,o)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>dr.mergeArray(r,l)):dr.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Jn({...this._def,rest:t})}}Jn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Jn({items:e,typeName:Te.ZodTuple,rest:null,...De(t)})};class Bu extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.object)return pe(n,{code:le.invalid_type,expected:ye.object,received:n.parsedType}),je;const s=[],i=this._def.keyType,l=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new Xn(n,o,n.path,o)),value:l._parse(new Xn(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?dr.mergeObjectAsync(r,s):dr.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Ue?new Bu({keyType:t,valueType:r,typeName:Te.ZodRecord,...De(n)}):new Bu({keyType:_n.create(),valueType:t,typeName:Te.ZodRecord,...De(r)})}}class ih extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.map)return pe(n,{code:le.invalid_type,expected:ye.map,received:n.parsedType}),je;const s=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([o,u],c)=>({key:s._parse(new Xn(n,o,n.path,[c,"key"])),value:i._parse(new Xn(n,u,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of l){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return je;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of l){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return je;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}}}}ih.create=(e,t,r)=>new ih({valueType:t,keyType:e,typeName:Te.ZodMap,...De(r)});class bi extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.set)return pe(n,{code:le.invalid_type,expected:ye.set,received:n.parsedType}),je;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(pe(n,{code:le.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(pe(n,{code:le.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function l(u){const c=new Set;for(const d of u){if(d.status==="aborted")return je;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const o=[...n.data.values()].map((u,c)=>i._parse(new Xn(n,u,n.path,c)));return n.common.async?Promise.all(o).then(u=>l(u)):l(o)}min(t,r){return new bi({...this._def,minSize:{value:t,message:Ee.toString(r)}})}max(t,r){return new bi({...this._def,maxSize:{value:t,message:Ee.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}bi.create=(e,t)=>new bi({valueType:e,minSize:null,maxSize:null,typeName:Te.ZodSet,...De(t)});class hl extends Ue{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.function)return pe(r,{code:le.invalid_type,expected:ye.function,received:r.parsedType}),je;function n(o,u){return rh({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,th(),Bl].filter(c=>!!c),issueData:{code:le.invalid_arguments,argumentsError:u}})}function s(o,u){return rh({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,th(),Bl].filter(c=>!!c),issueData:{code:le.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},l=r.data;if(this._def.returns instanceof Hl){const o=this;return wr(async function(...u){const c=new Wr([]),d=await o._def.args.parseAsync(u,i).catch(g=>{throw c.addIssue(n(u,g)),c}),h=await Reflect.apply(l,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(g=>{throw c.addIssue(s(h,g)),c})})}else{const o=this;return wr(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Wr([n(u,c.error)]);const d=Reflect.apply(l,this,c.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Wr([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new hl({...this._def,args:Jn.create(t).rest(ii.create())})}returns(t){return new hl({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new hl({args:t||Jn.create([]).rest(ii.create()),returns:r||ii.create(),typeName:Te.ZodFunction,...De(n)})}}class Uu extends Ue{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Uu.create=(e,t)=>new Uu({getter:e,typeName:Te.ZodLazy,...De(t)});class Hu extends Ue{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return pe(r,{received:r.data,code:le.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:t.data}}get value(){return this._def.value}}Hu.create=(e,t)=>new Hu({value:e,typeName:Te.ZodLiteral,...De(t)});function p_(e,t){return new Na({values:e,typeName:Te.ZodEnum,...De(t)})}class Na extends Ue{constructor(){super(...arguments),Oo.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{expected:Qe.joinValues(n),received:r.parsedType,code:le.invalid_type}),je}if(nh(this,Oo)||d_(this,Oo,new Set(this._def.values)),!nh(this,Oo).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{received:r.data,code:le.invalid_enum_value,options:n}),je}return wr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Na.create(t,{...this._def,...r})}exclude(t,r=this._def){return Na.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Oo=new WeakMap;Na.create=p_;class $u extends Ue{constructor(){super(...arguments),Po.set(this,void 0)}_parse(t){const r=Qe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==ye.string&&n.parsedType!==ye.number){const s=Qe.objectValues(r);return pe(n,{expected:Qe.joinValues(s),received:n.parsedType,code:le.invalid_type}),je}if(nh(this,Po)||d_(this,Po,new Set(Qe.getValidEnumValues(this._def.values))),!nh(this,Po).has(t.data)){const s=Qe.objectValues(r);return pe(n,{received:n.data,code:le.invalid_enum_value,options:s}),je}return wr(t.data)}get enum(){return this._def.values}}Po=new WeakMap;$u.create=(e,t)=>new $u({values:e,typeName:Te.ZodNativeEnum,...De(t)});class Hl extends Ue{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.promise&&r.common.async===!1)return pe(r,{code:le.invalid_type,expected:ye.promise,received:r.parsedType}),je;const n=r.parsedType===ye.promise?r.data:Promise.resolve(r.data);return wr(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Hl.create=(e,t)=>new Hl({type:e,typeName:Te.ZodPromise,...De(t)});class Pn extends Ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:l=>{pe(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const l=s.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return je;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?je:u.status==="dirty"||r.value==="dirty"?Xi(u.value):u});{if(r.value==="aborted")return je;const o=this._def.schema._parseSync({data:l,path:n.path,parent:n});return o.status==="aborted"?je:o.status==="dirty"||r.value==="dirty"?Xi(o.value):o}}if(s.type==="refinement"){const l=o=>{const u=s.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?je:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?je:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!xi(l))return l;const o=s.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>xi(l)?Promise.resolve(s.transform(l.value,i)).then(o=>({status:r.value,value:o})):l);Qe.assertNever(s)}}Pn.create=(e,t,r)=>new Pn({schema:e,typeName:Te.ZodEffects,effect:t,...De(r)});Pn.createWithPreprocess=(e,t,r)=>new Pn({schema:t,effect:{type:"preprocess",transform:e},typeName:Te.ZodEffects,...De(r)});class Kn extends Ue{_parse(t){return this._getType(t)===ye.undefined?wr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Kn.create=(e,t)=>new Kn({innerType:e,typeName:Te.ZodOptional,...De(t)});class ka extends Ue{_parse(t){return this._getType(t)===ye.null?wr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ka.create=(e,t)=>new ka({innerType:e,typeName:Te.ZodNullable,...De(t)});class zu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===ye.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}zu.create=(e,t)=>new zu({innerType:e,typeName:Te.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...De(t)});class qu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Lu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Wr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Wr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}qu.create=(e,t)=>new qu({innerType:e,typeName:Te.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...De(t)});class lh extends Ue{_parse(t){if(this._getType(t)!==ye.nan){const n=this._getOrReturnCtx(t);return pe(n,{code:le.invalid_type,expected:ye.nan,received:n.parsedType}),je}return{status:"valid",value:t.data}}}lh.create=e=>new lh({typeName:Te.ZodNaN,...De(e)});const oB=Symbol("zod_brand");class Kg extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class pc extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?je:i.status==="dirty"?(r.dirty(),Xi(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?je:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new pc({in:t,out:r,typeName:Te.ZodPipeline})}}class Vu extends Ue{_parse(t){const r=this._def.innerType._parse(t),n=s=>(xi(s)&&(s.value=Object.freeze(s.value)),s);return Lu(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Vu.create=(e,t)=>new Vu({innerType:e,typeName:Te.ZodReadonly,...De(t)});function $1(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function g_(e,t={},r){return e?Ul.create().superRefine((n,s)=>{var i,l;const o=e(n);if(o instanceof Promise)return o.then(u=>{var c,d;if(!u){const h=$1(t,n),f=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;s.addIssue({code:"custom",...h,fatal:f})}});if(!o){const u=$1(t,n),c=(l=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...u,fatal:c})}}):Ul.create()}const uB={object:Nt.lazycreate};var Te;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Te||(Te={}));const cB=(e,t={message:`Input not instance of ${e.name}`})=>g_(r=>r instanceof e,t),x_=_n.create,y_=wa.create,dB=lh.create,hB=Ea.create,b_=Ou.create,fB=yi.create,mB=sh.create,pB=Pu.create,gB=Du.create,xB=Ul.create,yB=ii.create,bB=_s.create,vB=ah.create,wB=Rn.create,EB=Nt.create,NB=Nt.strictCreate,kB=Mu.create,_B=Zh.create,SB=Fu.create,TB=Jn.create,CB=Bu.create,jB=ih.create,AB=bi.create,IB=hl.create,RB=Uu.create,LB=Hu.create,OB=Na.create,PB=$u.create,DB=Hl.create,z1=Pn.create,MB=Kn.create,FB=ka.create,BB=Pn.createWithPreprocess,UB=pc.create,HB=()=>x_().optional(),$B=()=>y_().optional(),zB=()=>b_().optional(),qB={string:e=>_n.create({...e,coerce:!0}),number:e=>wa.create({...e,coerce:!0}),boolean:e=>Ou.create({...e,coerce:!0}),bigint:e=>Ea.create({...e,coerce:!0}),date:e=>yi.create({...e,coerce:!0})},VB=je;var $r=Object.freeze({__proto__:null,defaultErrorMap:Bl,setErrorMap:BF,getErrorMap:th,makeIssue:rh,EMPTY_PATH:UF,addIssueToContext:pe,ParseStatus:dr,INVALID:je,DIRTY:Xi,OK:wr,isAborted:a0,isDirty:i0,isValid:xi,isAsync:Lu,get util(){return Qe},get objectUtil(){return s0},ZodParsedType:ye,getParsedType:ds,ZodType:Ue,datetimeRegex:m_,ZodString:_n,ZodNumber:wa,ZodBigInt:Ea,ZodBoolean:Ou,ZodDate:yi,ZodSymbol:sh,ZodUndefined:Pu,ZodNull:Du,ZodAny:Ul,ZodUnknown:ii,ZodNever:_s,ZodVoid:ah,ZodArray:Rn,ZodObject:Nt,ZodUnion:Mu,ZodDiscriminatedUnion:Zh,ZodIntersection:Fu,ZodTuple:Jn,ZodRecord:Bu,ZodMap:ih,ZodSet:bi,ZodFunction:hl,ZodLazy:Uu,ZodLiteral:Hu,ZodEnum:Na,ZodNativeEnum:$u,ZodPromise:Hl,ZodEffects:Pn,ZodTransformer:Pn,ZodOptional:Kn,ZodNullable:ka,ZodDefault:zu,ZodCatch:qu,ZodNaN:lh,BRAND:oB,ZodBranded:Kg,ZodPipeline:pc,ZodReadonly:Vu,custom:g_,Schema:Ue,ZodSchema:Ue,late:uB,get ZodFirstPartyTypeKind(){return Te},coerce:qB,any:xB,array:wB,bigint:hB,boolean:b_,date:fB,discriminatedUnion:_B,effect:z1,enum:OB,function:IB,instanceof:cB,intersection:SB,lazy:RB,literal:LB,map:jB,nan:dB,nativeEnum:PB,never:bB,null:gB,nullable:FB,number:y_,object:EB,oboolean:zB,onumber:$B,optional:MB,ostring:HB,pipeline:UB,preprocess:BB,promise:DB,record:CB,set:AB,strictObject:NB,string:x_,symbol:mB,transformer:z1,tuple:TB,undefined:pB,union:kB,unknown:yB,void:vB,NEVER:VB,ZodIssueCode:le,quotelessJson:FF,ZodError:Wr});const WB=$r.object({email:$r.string().email({message:"Invalid email address"}),password:$r.string().min(1,{message:"Password is required"})}),GB=$r.object({username:$r.string().min(3,{message:"Username must be at least 3 characters long"}).max(50,{message:"Username cannot exceed 50 characters"}),email:$r.string().email({message:"Invalid email address"}),password:$r.string().min(8,{message:"Password must be at least 8 characters long"}),confirmPassword:$r.string(),role:$r.enum(["player","dm"],{required_error:"Please select a role"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),YB=$r.object({currentPassword:$r.string().min(1,"Current password is required"),newPassword:$r.string().min(8,"New password must be at least 8 characters"),confirmNewPassword:$r.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"New passwords don't match",path:["confirmNewPassword"]});function QB(){const[e,t]=w.useState(""),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(null),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState({}),{updateUserPassword:p}=$t(),y=async v=>{v.preventDefault(),o(null),c(null),g({});const x=YB.safeParse({currentPassword:e,newPassword:r,confirmPassword:s});if(!x.success){const b={};x.error.errors.forEach(E=>{const _=E.path[0];_?b[_]=E.message:o(E.message)}),g(b),!l&&Object.keys(b).length>0&&o("Please fix the errors in the form.");return}h(!0);try{const{currentPassword:b,newPassword:E}=x.data;await p(b,E),c("Password updated successfully!"),t(""),n(""),i("")}catch(b){console.error("Password update error:",b),o(b instanceof Error?b.message:"Failed to update password.")}finally{h(!1)}};return a.jsxs("form",{onSubmit:y,className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Change Password"}),l&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Ft,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),u&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Ph,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:u})})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"current-password",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:v=>t(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.currentPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.currentPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.currentPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"new-password",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:v=>n(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.newPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.newPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.newPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirm-password",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s,onChange:v=>i(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.confirmPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.confirmPassword})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{type:"submit",variant:"primary",loading:d,disabled:d,children:"Update Password"})})]})}async function v_(e){if(!e)return console.error("getUserProfile: No user ID provided."),null;try{const{data:t,error:r,status:n}=await ne.from("users").select("id, username, first_name, last_name, avatar_url, bio").eq("id",e).single();if(r){if(n===406||r.code==="PGRST116")return console.warn(`No profile found for user ID: ${e}. This might be expected.`),null;throw console.error("Error fetching user profile:",r.message),new Error(`Failed to fetch user profile: ${r.message}`)}return t}catch(t){throw console.error("Unexpected error in getUserProfile:",t),t instanceof Error?t:new Error("An unknown error occurred while fetching the user profile.")}}async function KB(e,t){if(!e)throw new Error("updateUserProfile: No user ID provided.");if(!t||Object.keys(t).length===0)throw new Error("updateUserProfile: No updates provided.");const r={username:t.username,first_name:t.first_name,last_name:t.last_name,avatar_url:t.avatar_url,bio:t.bio};if(Object.keys(r).forEach(n=>{const s=n;r[s]===void 0&&delete r[s]}),Object.keys(r).length===0){console.warn("updateUserProfile: No valid fields to update after filtering.");const n=await v_(e);if(!n)throw new Error("Could not retrieve current profile after filtering updates.");return n}try{const{data:n,error:s}=await ne.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select("id, username, first_name, last_name, avatar_url, bio").single();if(s)throw console.error("Error updating user profile:",s.message),s.code==="23505"?s.message.includes("users_username_key")?new Error(`Failed to update profile: Username '${r.username}' is already taken.`):new Error(`Failed to update profile: ${s.details||"A unique value constraint was violated."}`):new Error(`Failed to update user profile: ${s.message}`);if(!n)throw new Error("Failed to update user profile: No data returned.");return n}catch(n){throw console.error("Unexpected error in updateUserProfile:",n),n instanceof Error?n:new Error("An unknown error occurred while updating the user profile.")}}async function ZB(e){if(!e)throw new Error("updateUserAuthEmail: No new email provided.");if(!/\S+@\S+\.\S+/.test(e))throw new Error("updateUserAuthEmail: Invalid email format provided.");try{const{data:t,error:r}=await ne.auth.updateUser({email:e});if(r)throw console.error("Error updating user auth email:",r.message),r.message.includes("User not found")||r.status===404?new Error("Failed to initiate email update: Could not find the current user."):r.message.includes("Email rate limit exceeded")?new Error("Failed to initiate email update: Please wait before trying again."):r.message.includes("same as the existing email")?new Error("The new email address is the same as the current one."):new Error(`Failed to initiate email update: ${r.message}`);console.log("User auth email update initiated. Verification required.",t)}catch(t){throw console.error("Unexpected error in updateUserAuthEmail:",t),t instanceof Error?t:new Error("An unknown error occurred while updating the user's email.")}}function XB(){var I;const{user:e,session:t}=$t(),[r,n]=w.useState(null),[s,i]=w.useState({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState(!0),[f,g]=w.useState(!1),[p,y]=w.useState(null),[v,x]=w.useState(null),b=w.useCallback(async A=>{var D,T,H;h(!0),y(null),x(null);try{const L=await v_(A.id),G=A.email??"";L?(n(L),i({first_name:L.first_name??"",last_name:L.last_name??"",username:L.username??((D=A.user_metadata)==null?void 0:D.username)??"",avatar_url:L.avatar_url??"",bio:L.bio??""})):(console.warn("User profile not found in 'users' table, initializing form with defaults/metadata."),i({first_name:"",last_name:"",username:((T=A.user_metadata)==null?void 0:T.username)??"",avatar_url:"",bio:""})),o(G),c(G)}catch(L){console.error("Failed to load profile:",L),y(L instanceof Error?L.message:"Failed to load profile data.");const G=(e==null?void 0:e.email)??"";o(G),c(G),i({first_name:"",last_name:"",username:((H=e==null?void 0:e.user_metadata)==null?void 0:H.username)??"",avatar_url:"",bio:""})}finally{h(!1)}},[]);w.useEffect(()=>{e?b(e):(h(!1),n(null),i({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),o(""),c(""),y(null),x(null))},[e,b]);const E=A=>{const{name:D,value:T}=A.target;i(H=>({...H,[D]:T})),y(null),x(null)},_=A=>{o(A.target.value),y(null),x(null)},k=async A=>{var G;if(A.preventDefault(),!e){y("You must be logged in to update your profile.");return}g(!0),y(null),x(null);let D=!1,T=!1,H="",L=!1;try{const Q={},$=r??{username:((G=e.user_metadata)==null?void 0:G.username)??"",first_name:null,last_name:null,avatar_url:null,bio:null};if(s.first_name!==($.first_name??"")&&(Q.first_name=s.first_name),s.last_name!==($.last_name??"")&&(Q.last_name=s.last_name),s.username!==($.username??"")&&(Q.username=s.username),s.avatar_url!==($.avatar_url??"")&&(Q.avatar_url=s.avatar_url),s.bio!==($.bio??"")&&(Q.bio=s.bio),Object.keys(Q).length>0){L=!0;const K=await KB(e.id,Q);n(O=>O?{...O,...K}:K),i({first_name:K.first_name??"",last_name:K.last_name??"",username:K.username??"",avatar_url:K.avatar_url??"",bio:K.bio??""}),D=!0}else D=!0;const V=l.trim();if(V!==u){if(!V)throw new Error("Email cannot be empty.");L=!0,await ZB(V),T=!0,H=" Email update initiated. Please check both your current and new email addresses for a verification link to complete the change."}if(L){let K="";D&&Object.keys(Q).length>0&&(K+="Profile fields updated successfully."),K+=H,x(K.trim())}else x("No changes were detected.")}catch(Q){console.error("Failed to update profile:",Q);const $=Q instanceof Error?Q.message:"An unknown error occurred during update.";y($)}finally{g(!1)}},S=A=>{var H;const D=A.currentTarget;D.style.display="none";const T=(H=D.parentElement)==null?void 0:H.querySelector(".fallback-icon");T&&(T.style.display="flex")};return d?a.jsx("div",{className:"flex justify-center items-center h-40",children:a.jsx(He,{})}):!e||!t?a.jsx("p",{className:"text-center text-red-600",children:"Please log in to view or edit your profile."}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8",children:[a.jsx("div",{className:"relative w-24 h-24",children:a.jsxs("div",{className:"w-full h-full rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border",children:[s.avatar_url&&a.jsx("img",{src:s.avatar_url,alt:"Profile",className:"w-full h-full object-cover",onError:S,style:{display:"block"}},s.avatar_url),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center fallback-icon",style:{display:s.avatar_url?"none":"flex"},children:a.jsx(Ni,{className:"w-12 h-12 text-gray-400"})})]})}),a.jsxs("div",{className:"flex-grow w-full sm:w-auto",children:[a.jsx("h3",{className:"font-medium text-lg text-center sm:text-left",children:s.username||((I=e==null?void 0:e.user_metadata)==null?void 0:I.username)||"User"}),a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center sm:justify-start gap-1",children:[a.jsx(wg,{className:"w-4 h-4"}),l||"No email set"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{htmlFor:"avatar_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar URL"}),a.jsx("input",{id:"avatar_url",name:"avatar_url",type:"url",value:s.avatar_url??"",onChange:E,placeholder:"https://example.com/avatar.png",className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("form",{onSubmit:k,className:"space-y-6",children:[v&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(Ph,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Success!"})," ",v]})]}),p&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(Ft,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Error!"})," ",p]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),a.jsx("input",{id:"first_name",name:"first_name",type:"text",value:s.first_name??"",onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),a.jsx("input",{id:"last_name",name:"last_name",type:"text",value:s.last_name??"",onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:l,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":"email-description"}),a.jsx("p",{id:"email-description",className:"text-xs text-gray-500 mt-1",children:"Changing your email requires verification via links sent to both addresses."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",value:s.username??"",onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be unique. Used for display and potentially logging in."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),a.jsx("textarea",{id:"bio",name:"bio",value:s.bio??"",onChange:E,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Tell us a little about yourself..."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(B,{type:"submit",variant:"primary",icon:Gt,loading:f,disabled:f||d,children:"Save Changes"})})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-12",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Change Password"}),a.jsx(QB,{})]})]})}function JB(){const[e,t]=w.useState("system"),[r,n]=w.useState("medium"),[s,i]=w.useState(!1),[l,o]=w.useState(!1),u=async c=>{c.preventDefault(),o(!0),await new Promise(d=>setTimeout(d,1e3)),o(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Appearance Settings"}),a.jsxs("form",{onSubmit:u,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("light"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="light"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(OE,{className:"w-6 h-6 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Light"})]}),a.jsxs("button",{type:"button",onClick:()=>t("dark"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="dark"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(CE,{className:"w-6 h-6 text-blue-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Dark"})]}),a.jsxs("button",{type:"button",onClick:()=>t("system"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="system"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(_4,{className:"w-6 h-6 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"System"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),a.jsxs("select",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"small",children:"Small"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"large",children:"Large"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:c=>i(c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reduce motion"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimize animations and transitions"})]}),a.jsxs("div",{className:"p-6 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsx("div",{className:`p-4 rounded-lg ${e==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:a.jsx("p",{className:`${r==="small"?"text-sm":r==="large"?"text-lg":"text-base"}`,children:"This is how your content will look with the selected theme and font size."})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{type:"submit",variant:"primary",icon:Gt,loading:l,children:"Save Changes"})})]})]})}function eU(){const[e,t]=w.useState({email:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,systemUpdates:!1},desktop:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,diceRolls:!0},sounds:{enabled:!0,volume:80,diceRolls:!0,notifications:!0}}),[r,n]=w.useState(!1),s=async i=>{i.preventDefault(),n(!0),await new Promise(l=>setTimeout(l,1e3)),n(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Notification Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(wg,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Email Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.email).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,email:{...e.email,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(b4,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Desktop Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.desktop).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,desktop:{...e.desktop,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(vE,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Sound Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.enabled,onChange:i=>t({...e,sounds:{...e.sounds,enabled:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Enable Sounds"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Volume (",e.sounds.volume,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",value:e.sounds.volume,onChange:i=>t({...e,sounds:{...e.sounds,volume:parseInt(i.target.value)}}),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.diceRolls,onChange:i=>t({...e,sounds:{...e.sounds,diceRolls:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Dice Roll Sounds"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.notifications,onChange:i=>t({...e,sounds:{...e.sounds,notifications:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Notification Sounds"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{type:"submit",variant:"primary",icon:Gt,loading:r,children:"Save Changes"})})]})]})}const tU=[{value:"en",label:"English"},{value:"et",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"sv",label:"Swedish"}],rU=[{value:"Europe/Tallinn",label:"Europe/Tallinn (UTC+2)"},{value:"Europe/Helsinki",label:"Europe/Helsinki (UTC+2)"},{value:"Europe/Stockholm",label:"Europe/Stockholm (UTC+1)"},{value:"UTC",label:"UTC"}],nU=[{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"YYYY-MM-DD",label:"YYYY-MM-DD"}],sU=[{value:"24h",label:"24-hour (14:30)"},{value:"12h",label:"12-hour (2:30 PM)"}];function aU(){const[e,t]=w.useState({language:"en",timeZone:"Europe/Tallinn",dateFormat:"DD/MM/YYYY",timeFormat:"24h",firstDayOfWeek:1,useMetricSystem:!0}),[r,n]=w.useState(!1),s=async o=>{o.preventDefault(),n(!0),await new Promise(u=>setTimeout(u,1e3)),n(!1)},i=new Date,l=new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"long",timeZone:e.timeZone}).format(i);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Localization Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(SE,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Language & Region"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interface Language"}),a.jsx("select",{value:e.language,onChange:o=>t({...e,language:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:tU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),a.jsx("select",{value:e.timeZone,onChange:o=>t({...e,timeZone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:rU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xg,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Date & Time Format"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),a.jsx("select",{value:e.dateFormat,onChange:o=>t({...e,dateFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:nU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),a.jsx("select",{value:e.timeFormat,onChange:o=>t({...e,timeFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:sU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Day of Week"}),a.jsxs("select",{value:e.firstDayOfWeek,onChange:o=>t({...e,firstDayOfWeek:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"Monday"}),a.jsx("option",{value:0,children:"Sunday"})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Dh,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Measurement System"})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.useMetricSystem,onChange:o=>t({...e,useMetricSystem:o.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Use Metric System"})]})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current date and time: ",l]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{type:"submit",variant:"primary",icon:Gt,loading:r,children:"Save Changes"})})]})]})}function iU({onClose:e,onUserCreated:t}){const[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState("player"),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,g]=w.useState(!1),[p,y]=w.useState(null),[v,x]=w.useState(!1),[b,E]=w.useState([]),[_,k]=w.useState(!1),[S,I]=w.useState(null),A=async()=>{k(!0),I(null);const{data:H,error:L}=await ne.from("users").select("*");L?I(L.message):E(H),k(!1)};w.useEffect(()=>{A()},[]);const D=async H=>{H.preventDefault(),c(null),g(!0);try{const L=Math.random().toString(36).slice(-12),{data:G,error:Q}=await ne.auth.signUp({email:r,password:L,options:{data:{username:s}}});if(Q)throw Q;if(!G.user)throw new Error("Failed to create user");const{error:$}=await ne.from("users").update({role:l}).eq("id",G.user.id);if($)throw $;const V=new URL(window.location.origin);V.searchParams.set("email",r),V.searchParams.set("password",L),y(V.toString()),h(!0),t(),A()}catch(L){c(L instanceof Error?L.message:"Failed to create user")}finally{g(!1)}},T=async()=>{if(p)try{await navigator.clipboard.writeText(p),x(!0),setTimeout(()=>x(!1),2e3)}catch{c("Failed to copy link to clipboard")}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),u&&a.jsxs("div",{className:"mb-6 flex items-start gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Ft,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]}),d&&p?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"User Created Successfully!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Share the following link with the user to let them sign in:"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:p,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50"}),a.jsx(B,{variant:"secondary",icon:v?Wa:yg,onClick:T,children:v?"Copied!":"Copy"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{variant:"primary",onClick:e,children:"Done"})})]}):a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:r,onChange:H=>n(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{type:"text",required:!0,value:s,onChange:H=>i(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{value:l,onChange:H=>o(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"player",children:"Player"}),a.jsx("option",{value:"dm",children:"Dungeon Master"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(B,{variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(B,{type:"submit",variant:"primary",icon:Ni,loading:f,children:"Create User"})]})]})]}),a.jsxs("div",{className:"p-6 border-t",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Created Users"}),_?a.jsx("p",{children:"Loading users..."}):S?a.jsxs("p",{className:"text-red-600",children:["Error loading users: ",S]}):b.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(H=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.username}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.email}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.role}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(H.created_at).toLocaleString()}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.account_status||"N/A"})]},H.id))})]})}):a.jsx("p",{children:"No users found."})]})]})})}function lU(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState("all"),[d,h]=w.useState(!1),f=w.useCallback(async()=>{n(!0),i(null);try{const{data:x,error:b}=await ne.from("users").select("id, email, username, role, created_at, last_login, first_name, last_name, is_active").order("created_at",{ascending:!1});if(b)throw b;t(x||[])}catch(x){console.error("Error fetching users:",x),i(`Failed to load users: ${x.message||"Unknown error"}`),t([])}finally{n(!1)}},[]);w.useEffect(()=>{f()},[f]);const g=()=>{h(!1),f()},p=e.filter(x=>{const b=l.toLowerCase(),E=x.username&&x.username.toLowerCase().includes(b)||x.email&&x.email.toLowerCase().includes(b)||x.first_name&&x.first_name.toLowerCase().includes(b)||x.last_name&&x.last_name.toLowerCase().includes(b),_=u==="all"||x.role&&x.role.toLowerCase()===u.toLowerCase();return E&&_}),y=x=>{const b=x==null?void 0:x.toLowerCase();return b==="admin"?"bg-purple-100 text-purple-800":b==="dm"||b==="dungeon master"?"bg-blue-100 text-blue-800":b==="player"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},v=x=>x.username?x.username:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.first_name?x.first_name:x.email.split("@")[0];return a.jsxs("div",{className:"space-y-6 p-4 md:p-6 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"User Management"}),a.jsx(B,{variant:"primary",icon:Kt,onClick:()=>h(!0),className:"w-full sm:w-auto",children:"Create User"})]}),s&&a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg shadow-sm",children:[a.jsx(Ft,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Error Loading Users"}),a.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(Ns,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, username...",value:l,onChange:x=>o(x.target.value),className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-colors",disabled:r})]}),a.jsxs("div",{className:"relative md:min-w-[200px]",children:[a.jsx(Ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:u,onChange:x=>c(x.target.value),className:"w-full pl-11 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white shadow-sm transition-colors",disabled:r,children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"player",children:"Players"}),a.jsx("option",{value:"dm",children:"Dungeon Masters"}),a.jsx("option",{value:"admin",children:"Administrators"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),r&&e.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):!r&&e.length===0&&!s?a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Users,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500",children:"There are currently no users to display. Try creating one!"})]}):a.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold",children:[x.first_name?x.first_name.charAt(0).toUpperCase():x.email.charAt(0).toUpperCase(),x.last_name?x.last_name.charAt(0).toUpperCase():x.username?x.username.charAt(0).toUpperCase():""]}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:v(x)}),a.jsx("div",{className:"text-xs text-gray-500",children:x.email})]})]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${y(x.role||"N/A")}`,children:x.role?x.role.charAt(0).toUpperCase()+x.role.slice(1):"N/A"})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:x.is_active===void 0||x.is_active===null?a.jsx("span",{className:"text-xs text-gray-500",children:"Unknown"}):x.is_active?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:[a.jsx(Ph,{className:"w-3.5 h-3.5 mr-1.5"})," Active"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:[a.jsx(ll,{className:"w-3.5 h-3.5 mr-1.5"})," Inactive"]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:x.last_login?new Date(x.last_login).toLocaleString():"Never"}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{variant:"icon",size:"sm",title:"Edit User",className:"text-gray-500 hover:text-blue-600",children:a.jsx(Eg,{className:"w-4 h-4"})}),a.jsx(B,{variant:"icon",size:"sm",title:"Delete User",className:"text-gray-500 hover:text-red-600",children:a.jsx(ur,{className:"w-4 h-4"})})]})})]},x.id))})]})}),p.length===0&&!r&&e.length>0&&a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Ns,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Match Your Search"}),a.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term or role filter."})]}),d&&a.jsx(iU,{onClose:()=>h(!1),onUserCreated:g})]})}var w_={exports:{}},oU="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",uU=oU,cU=uU;function E_(){}function N_(){}N_.resetWarningCache=E_;var dU=function(){function e(n,s,i,l,o,u){if(u!==cU){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:N_,resetWarningCache:E_};return r.PropTypes=r,r};w_.exports=dU();var hU=w_.exports;const Xc=oh(hU);function o0(){return o0=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o0.apply(this,arguments)}function fU(e,t){if(e==null)return{};var r=mU(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mU(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var Zg=w.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,s=e.size,i=s===void 0?24:s,l=fU(e,["color","size"]);return Sn.createElement("svg",o0({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),Sn.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Sn.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});Zg.propTypes={color:Xc.string,size:Xc.oneOfType([Xc.string,Xc.number])};Zg.displayName="X";function pU({entry:e,onChange:t}){const[r,n]=w.useState(e),[s,i]=w.useState({gold:0,silver:0,copper:0}),[l,o]=w.useState([]);w.useEffect(()=>{if(n(e),e.cost){const d=e.cost.split(",").map(f=>f.trim()),h={gold:0,silver:0,copper:0};d.forEach(f=>{f.includes("gold")?h.gold=parseInt(f.replace("gold","").trim())||0:f.includes("silver")?h.silver=parseInt(f.replace("silver","").trim())||0:f.includes("copper")&&(h.copper=parseInt(f.replace("copper","").trim())||0)}),i(h)}e.features&&o(e.features)},[e]);const u=(d,h)=>{const f=parseInt(h)||0,g={...s,[d]:f};i(g),t("cost",`${g.gold} gold, ${g.silver} silver, ${g.copper} copper`)},c=d=>{const h=l.filter((f,g)=>g!==d);o(h),t("features",h)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:d=>t("name",d.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:r.category||"",onChange:d=>t("category",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"ARMOR & HELMETS",children:"Armor & Helmets"}),a.jsx("option",{value:"MELEE WEAPONS",children:"Melee Weapons"}),a.jsx("option",{value:"RANGED WEAPONS",children:"Ranged Weapons"}),a.jsx("option",{value:"CLOTHES",children:"Clothes"}),a.jsx("option",{value:"MUSICAL INSTRUMENTS",children:"Musical Instruments"}),a.jsx("option",{value:"TRADE GOODS",children:"Trade Goods"}),a.jsx("option",{value:"STUDIES & MAGIC",children:"Studies & Magic"}),a.jsx("option",{value:"LIGHT SOURCES",children:"Light Sources"}),a.jsx("option",{value:"TOOLS",children:"Tools"}),a.jsx("option",{value:"CONTAINERS",children:"Containers"}),a.jsx("option",{value:"MEDICINE",children:"Medicine"}),a.jsx("option",{value:"SERVICES",children:"Services"}),a.jsx("option",{value:"HUNTING & FISHING",children:"Hunting & Fishing"}),a.jsx("option",{value:"MEANS OF TRAVEL",children:"Means of Travel"}),a.jsx("option",{value:"ANIMALS",children:"Animals"})]})]}),r.category==="ARMOR & HELMETS"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor Rating"}),a.jsx("input",{type:"number",value:r.armor_rating||"",onChange:d=>t("armor_rating",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),r.category==="MELEE WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),r.category==="RANGED WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.gold,onChange:d=>u("gold",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Gold"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.silver,onChange:d=>u("silver",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Silver"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.copper,onChange:d=>u("copper",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Copper"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supply"}),a.jsxs("select",{value:r.supply||"",onChange:d=>t("supply",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Supply"}),a.jsx("option",{value:"Common",children:"Common"}),a.jsx("option",{value:"Uncommon",children:"Uncommon"}),a.jsx("option",{value:"Rare",children:"Rare"}),a.jsx("option",{value:"Unique",children:"Unique"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:r.weight||"",onChange:d=>t("weight",parseFloat(d.target.value)),className:"w-full px-3 py-2 border rounded-md",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effect/Description"}),a.jsx("textarea",{value:r.effect||"",onChange:d=>t("effect",d.target.value.toUpperCase()),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((d,h)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md px-2 py-1 text-sm",children:[a.jsx("span",{children:d}),a.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-2 text-red-500 hover:text-red-700",children:a.jsx(Zg,{className:"w-4 h-4"})})]},h)),a.jsx("input",{type:"text",onKeyDown:d=>{if(d.key==="Enter"&&d.currentTarget.value.trim()){d.preventDefault();const h=d.currentTarget.value.trim(),f=[...l,h];o(f),t("features",f),d.currentTarget.value=""}},className:"px-3 py-2 border rounded-md",placeholder:"Add feature..."})]})]})]})}const gU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:r=>t("heroic_ability",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abilities"}),(e.abilities||[]).map((r,n)=>a.jsxs("div",{className:"flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",placeholder:"Ability Description",value:r.description||"",onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],description:s.target.value},t("abilities",i)},className:"border rounded-md px-2 py-1 flex-1"}),a.jsx("input",{type:"number",placeholder:"Willpower Points",value:r.willpower_points||0,onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],willpower_points:parseInt(s.target.value)},t("abilities",i)},className:"border rounded-md px-2 py-1 w-20",min:"0"}),a.jsx("button",{onClick:()=>{const s=[...e.abilities||[]];s.splice(n,1),t("abilities",s)},className:"text-red-600",children:"Remove"})]},n)),a.jsx("button",{onClick:()=>{const r=[...e.abilities||[],{description:"",willpower_points:0}];t("abilities",r)},className:"mt-2 text-blue-600",children:"Add Ability"})]})]}),xU=({entry:e,onChange:t})=>{const[r,n]=w.useState("skills"),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null);w.useEffect(()=>{(async()=>{o(!0),c(null);const{data:v,error:x}=await ne.from("game_skills").select("id, name, is_magic").order("name",{ascending:!0});x?(console.error("Error fetching skills:",x),c("Failed to load skills from the database.")):i(v||[]),o(!1)})()},[]);const d=w.useMemo(()=>s.filter(y=>y.is_magic===!0),[s]),h=e.starting_equipment||["","",""],f=e.equipment_description||["","",""],g=(y,v,x)=>{if(v==="equipment"){const b=[...h];b[y]=x,t("starting_equipment",b)}else{const b=[...f];b[y]=x,t("equipment_description",b)}},p=y=>{t("is_magic",y),y||t("associated_skill",null)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:y=>t("name",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:y=>t("description",y.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"space-y-4 p-4 border rounded-md bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"is_magic",type:"checkbox",checked:e.is_magic||!1,onChange:y=>p(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_magic",className:"text-sm font-medium text-gray-900",children:"Is this a magic profession?"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"associated_skill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Associated Magic Skill"}),a.jsxs("select",{id:"associated_skill",value:e.associated_skill||"",onChange:y=>t("associated_skill",y.target.value||null),className:"w-full px-3 py-2 border rounded-md disabled:bg-gray-200 disabled:cursor-not-allowed",disabled:!e.is_magic||l||!!u,children:[l&&a.jsx("option",{children:"Loading magic skills..."}),u&&a.jsx("option",{children:"Error loading skills"}),!l&&!u&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"",children:"None"}),d.length>0?d.map(y=>a.jsx("option",{value:y.name,children:y.name},y.id)):a.jsx("option",{disabled:!0,children:"No skills marked as magic were found"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute"}),a.jsx("input",{type:"text",value:e.key_attribute||"",onChange:y=>t("key_attribute",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:y=>t("heroic_ability",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Magic School"}),a.jsxs("select",{value:e.magic_school_id||"",onChange:y=>t("magic_school_id",y.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"Animist",children:"Animist"}),a.jsx("option",{value:"Elementalist",children:"Elementalist"}),a.jsx("option",{value:"Mentalist",children:"Mentalist"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex border-b",children:[a.jsx("button",{type:"button",onClick:()=>n("skills"),className:`px-4 py-2 -mb-px font-medium ${r==="skills"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Skills"}),a.jsx("button",{type:"button",onClick:()=>n("startingEquipment"),className:`px-4 py-2 -mb-px font-medium ${r==="startingEquipment"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Starting Equipment"})]}),r==="skills"&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),l&&a.jsx("p",{className:"text-sm text-gray-500",children:"Loading skills..."}),u&&a.jsx("p",{className:"text-sm text-red-600",children:u}),!l&&!u&&a.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map(y=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:e.skills?e.skills.includes(y.name):!1,onChange:v=>{let x=e.skills?[...e.skills]:[];v.target.checked?x.push(y.name):x=x.filter(b=>b!==y.name),t("skills",x)}}),a.jsx("span",{className:"text-sm",children:y.name})]},y.id))})]}),r==="startingEquipment"&&a.jsx("div",{className:"mt-4 space-y-4",children:[0,1,2].map(y=>a.jsxs("div",{className:"border p-2 rounded-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment Option ",y+1]}),a.jsx("input",{type:"text",placeholder:"Enter equipment (e.g., Horn or Flute, knife, torch)",value:h[y]||"",onChange:v=>g(y,"equipment",v.target.value),className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (e.g., D6 food rations, D8 silver)",value:f[y]||"",onChange:v=>g(y,"description",v.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})]},y))})]})]})},yU=({entry:e,onChange:t})=>{const{skills:r,loading:n,error:s}=GE(),[i,l]=w.useState(!1),[o,u]=w.useState(!1),[c,d]=w.useState({}),h=w.useCallback(()=>{if(n||!r||r.length===0)return;u(!0);const p=e.requirement;let y={};if(Tg(p))y=p,console.log("AbilityForm: Initial requirement is already name-based:",p);else if(Eb(p)){console.log("AbilityForm: Initial requirement is UUID-based, converting:",p);const v=new Map(r.map(x=>[x.id,x.name]));for(const[x,b]of Object.entries(p)){const E=v.get(x);E?y[E]=b:console.warn(`AbilityForm: Could not find skill name for UUID ${x} during initialization.`)}console.log("AbilityForm: Converted to name-based requirements:",y)}else typeof p=="string"||p===null||p===void 0?(console.log("AbilityForm: Initial requirement is simple string, null, or undefined:",p),y={}):(console.warn("AbilityForm: Unrecognized requirement format during initialization:",p),y={});d(y),u(!1)},[e.requirement,r,n]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{t("requirement",c)},[c,t]);const f=(p,y)=>{typeof p=="string"&&d(v=>{const x={...v};return y?x.hasOwnProperty(p)||(x[p]=null):delete x[p],x})},g=(p,y)=>{if(typeof p!="string")return;const v=y===""?null:parseInt(y,10);c.hasOwnProperty(p)&&d(x=>({...x,[p]:isNaN(v)?null:v}))};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{id:"ability-name",type:"text",value:e.name||"",onChange:p=>t("name",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{id:"ability-description",value:e.description||"",onChange:p=>t("description",p.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-willpower_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Willpower Cost"}),a.jsx("input",{id:"ability-willpower_cost",type:"number",value:e.willpower_cost===null||e.willpower_cost===void 0?"":e.willpower_cost,onChange:p=>t("willpower_cost",p.target.value===""?null:parseInt(p.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-profession",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profession (Optional)"}),a.jsx("input",{id:"ability-profession",type:"text",value:e.profession||"",onChange:p=>t("profession",p.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain profession."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-kin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kin (Optional)"}),a.jsx("input",{id:"ability-kin",type:"text",value:e.kin||"",onChange:p=>t("kin",p.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain kin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Requirements (Optional)"}),a.jsxs("details",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden",open:i,onToggle:p=>l(p.target.open),children:[a.jsx("summary",{className:"px-3 py-2 cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-t-md",children:Object.keys(c).length>0?`${Object.keys(c).length} skill(s) selected`:"Select required skills..."}),a.jsx("div",{className:"p-4 border-t border-gray-200 max-h-60 overflow-y-auto",children:n||o?a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(He,{size:"md"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading skills..."})]}):s?a.jsx(Ne,{message:`Error loading skills: ${s}`}):r.length===0?a.jsx("p",{className:"text-gray-500",children:"No skills available."}):a.jsx("ul",{className:"space-y-2",children:r.map(p=>{const y=p.name,v=c.hasOwnProperty(y),x=c[y];return a.jsxs("li",{className:"flex items-center space-x-3",children:[" ",a.jsx("input",{id:`skill-req-${p.id}`,type:"checkbox",checked:v,onChange:b=>f(y,b.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`skill-req-${p.id}`,className:"flex-1 text-sm text-gray-700",children:[p.name," ",p.attribute?`(${p.attribute})`:""]}),v&&a.jsx("input",{type:"number",min:"1",placeholder:"Level (Opt.)",value:x??"",onChange:b=>g(y,b.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500"})]},p.id)})})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select skills required for this ability and optionally specify a minimum level. Requirements are now stored by skill name."}),typeof e.requirement=="string"&&e.requirement&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:a.jsxs("p",{className:"text-xs text-yellow-700",children:[a.jsx("strong",{children:"Note:"}),' This ability has a non-skill requirement text: "',e.requirement,'". Saving will overwrite this if skills are selected above.']})}),Eb(e.requirement)&&o&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded",children:a.jsx("p",{className:"text-xs text-orange-700",children:"Attempting to convert legacy UUID-based requirements..."})})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]})};function k_(e){return typeof e!="object"||e===null||!e.type?!1:e.type==="logical"?(e.operator==="AND"||e.operator==="OR")&&Array.isArray(e.conditions)&&e.conditions.every(k_):["spell","school","skill","attribute"].includes(e.type)?typeof e.name=="string":e.type==="anySchool"}function bU({entry:e,onChange:t,magicSchools:r=[]}){const[n,s]=w.useState(""),[i,l]=w.useState(null);w.useEffect(()=>{if(e.prerequisite)try{typeof e.prerequisite=="object"&&e.prerequisite!==null?s(JSON.stringify(e.prerequisite,null,2)):typeof e.prerequisite=="string"&&(JSON.parse(e.prerequisite),s(JSON.stringify(JSON.parse(e.prerequisite),null,2)))}catch{s(e.prerequisite)}else s("")},[e.prerequisite]);const o=c=>{const d=c.target.value;if(s(d),d.trim()===""){t("prerequisite",null),l(null);return}try{const h=JSON.parse(d);k_(h)?(t("prerequisite",JSON.stringify(h)),l(null)):l("Invalid prerequisite JSON structure. Please check the format.")}catch{l("Invalid JSON. Please ensure correct JSON syntax.")}},u=c=>{const{name:d,value:h,type:f}=c.target;let g=h;f==="number"&&c.target instanceof HTMLInputElement&&(g=h===""?null:parseInt(h,10),isNaN(g)&&(g=null)),d==="school_id"&&h===""&&(g=null),t(d,g)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("input",{type:"text",name:"name",id:"name",value:e.name||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),a.jsx("textarea",{name:"description",id:"description",rows:3,value:e.description||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"school_id",className:"block text-sm font-medium text-gray-700",children:"Magic School"}),a.jsxs("select",{name:"school_id",id:"school_id",value:e.school_id||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white",children:[a.jsx("option",{value:"",children:"General"}),r.map(c=>a.jsx("option",{value:c.id,children:c.name},c.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rank",className:"block text-sm font-medium text-gray-700",children:"Rank (0 for Trick)"}),a.jsx("input",{type:"number",name:"rank",id:"rank",min:"0",max:"5",value:e.rank??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"casting_time",className:"block text-sm font-medium text-gray-700",children:"Casting Time"}),a.jsx("input",{type:"text",name:"casting_time",id:"casting_time",value:e.casting_time||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"range",className:"block text-sm font-medium text-gray-700",children:"Range"}),a.jsx("input",{type:"text",name:"range",id:"range",value:e.range||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),a.jsx("input",{type:"text",name:"duration",id:"duration",value:e.duration||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"willpower_cost",className:"block text-sm font-medium text-gray-700",children:"Willpower Cost"}),a.jsx("input",{type:"number",name:"willpower_cost",id:"willpower_cost",min:"0",value:e.willpower_cost??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"prerequisite",className:"block text-sm font-medium text-gray-700",children:"Learning Prerequisite (JSON or leave empty)"}),a.jsx("textarea",{name:"prerequisite",id:"prerequisite",rows:6,value:n,onChange:o,placeholder:'JSON for learning, e.g., {"type": "spell", "name": "Light"}. Leave empty for no prerequisite.',className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 focus:outline-none sm:text-sm ${i?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),i&&a.jsx("p",{className:"mt-2 text-sm text-red-600",children:i}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Use JSON format for learning prerequisites. Examples: ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "anySchool"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "spell", "name": "Example Spell"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "logical", "operator": "AND", "conditions": [...]}'})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"requirement",className:"block text-sm font-medium text-gray-700",children:"Casting Requirement (Text or leave empty)"}),a.jsx("textarea",{name:"requirement",id:"requirement",rows:3,value:e.requirement||"",onChange:u,placeholder:"e.g., Requires a free hand, or Verbal component only. Leave empty if none.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe any requirements for casting the spell (e.g., components, conditions)."})]})]})}const vU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Name"}),a.jsx("input",{id:"skill-name",type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx("textarea",{id:"skill-description",value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[a.jsx("input",{id:"is_magic_skill",type:"checkbox",checked:e.is_magic||!1,onChange:r=>t("is_magic",r.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"is_magic_skill",className:"text-sm font-medium text-gray-900",children:"Is this a magic skill?"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Check if this skill is related to magic or spellcasting."})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-attribute",className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute (Optional)"}),a.jsx("input",{id:"skill-attribute",type:"text",value:e.attribute||"",onChange:r=>t("attribute",r.target.value||null),placeholder:"e.g., STR, AGL, WIL...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The primary attribute associated with this skill."})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]}),wU=["Small","Normal","Large","Huge","Swarm"],q1=()=>({FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0}),EU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:"",effects:[]}),NU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:""});function kU({entry:e,onChange:t}){const[r,n]=w.useState({...e,stats:e.stats||q1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(g=>({...g,id:g.id||crypto.randomUUID()}))}))});w.useEffect(()=>{n({...e,stats:e.stats||q1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(g=>({...g,id:g.id||crypto.randomUUID()}))}))})},[e]);const s=w.useCallback((f,g)=>{const p={...r,[f]:g};n(p),t(f,g)},[r,t]),i=w.useCallback((f,g)=>{const p={...r.stats,[f]:g};s("stats",p)},[r.stats,s]),l=w.useCallback(()=>{const f=[...r.attacks,EU()];s("attacks",f)},[r.attacks,s]),o=w.useCallback((f,g,p)=>{const y=[...r.attacks];y[f]={...y[f],[g]:p},s("attacks",y)},[r.attacks,s]),u=w.useCallback(f=>{const g=r.attacks.filter((p,y)=>y!==f);s("attacks",g)},[r.attacks,s]),c=w.useCallback(f=>{const g=[...r.attacks];g[f].effects=[...g[f].effects||[],NU()],s("attacks",g)},[r.attacks,s]),d=w.useCallback((f,g,p,y)=>{const v=[...r.attacks];v[f].effects&&(v[f].effects[g]={...v[f].effects[g],[p]:y},s("attacks",v))},[r.attacks,s]),h=w.useCallback((f,g)=>{const p=[...r.attacks];p[f].effects&&(p[f].effects=p[f].effects.filter((y,v)=>v!==g),s("attacks",p))},[r.attacks,s]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:f=>s("name",f.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:r.category||"",onChange:f=>s("category",f.target.value),placeholder:"e.g., Beast, Undead, Humanoid",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:r.description||"",onChange:f=>s("description",f.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Statistics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferocity"}),a.jsx("input",{type:"number",value:r.stats.FEROCITY,onChange:f=>i("FEROCITY",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),a.jsx("select",{value:r.stats.SIZE,onChange:f=>i("SIZE",f.target.value),className:"w-full px-3 py-2 border rounded-md",children:wU.map(f=>a.jsx("option",{value:f,children:f},f))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movement"}),a.jsx("input",{type:"number",value:r.stats.MOVEMENT,onChange:f=>i("MOVEMENT",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor"}),a.jsx("input",{type:"number",value:r.stats.ARMOR,onChange:f=>i("ARMOR",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HP"}),a.jsx("input",{type:"number",value:r.stats.HP,onChange:f=>i("HP",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effects Summary"}),a.jsx("textarea",{value:r.effectsSummary||"",onChange:f=>s("effectsSummary",f.target.value),rows:3,placeholder:"Describe any special effects or abilities here...",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attacks (D6 Rollable Table)"}),a.jsx(B,{variant:"secondary",size:"sm",icon:Vd,onClick:l,children:"Add Attack"})]}),r.attacks.length===0&&a.jsx("p",{className:"text-gray-500",children:'No attacks defined. Click "Add Attack" to create one.'}),r.attacks.map((f,g)=>a.jsxs("div",{className:"p-3 border rounded-md mb-4 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-2",children:[a.jsx("input",{type:"text",placeholder:"Roll Values (e.g., 1, 2-3)",value:f.roll_values,onChange:p=>o(g,"roll_values",p.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"text",placeholder:"Attack Name",value:f.name,onChange:p=>o(g,"name",p.target.value),className:"md:col-span-2 px-3 py-2 border rounded-md"})]}),a.jsx("textarea",{placeholder:"Attack Description",value:f.description,onChange:p=>o(g,"description",p.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsxs("div",{className:"ml-4 mt-2 p-3 border-l-2 border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Effects (Optional D6 Table)"}),a.jsx(B,{variant:"outline",size:"xs",icon:Vd,onClick:()=>c(g),children:"Add Effect"})]}),f.effects.length===0&&a.jsx("p",{className:"text-gray-500",children:'No effects for this attack. Click "Add Effect" to create one.'}),f.effects.map((p,y)=>a.jsxs("div",{className:"p-2 border rounded-md mb-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-1",children:[a.jsx("input",{type:"text",placeholder:"Roll (e.g., 1-2)",value:p.roll_values,onChange:v=>d(g,y,"roll_values",v.target.value),className:"px-2 py-1 border rounded-md text-sm"}),a.jsx("input",{type:"text",placeholder:"Effect Name",value:p.name,onChange:v=>d(g,y,"name",v.target.value),className:"md:col-span-2 px-2 py-1 border rounded-md text-sm"})]}),a.jsx("textarea",{placeholder:"Effect Description",value:p.description,onChange:v=>d(g,y,"description",v.target.value),rows:1,className:"w-full px-2 py-1 border rounded-md text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(B,{variant:"danger",size:"xs",icon:ur,onClick:()=>h(g,y),children:"Remove Effect"})})]},p.id))]}),a.jsx("div",{className:"text-right",children:a.jsx(B,{variant:"danger",size:"sm",icon:ur,onClick:()=>u(g),children:"Remove Attack"})})]},f.id))]})]})}const xm=({title:e,items:t,onAdd:r,onRemove:n,onUpdate:s})=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),t.map((i,l)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:i,onChange:o=>s(l,o.target.value),className:"w-full px-3 py-2 border rounded-md flex-grow",placeholder:`Enter ${e.replace(/s$/,"").toLowerCase()}...`}),a.jsx(B,{variant:"danger",size:"sm",icon:ur,onClick:()=>n(l),"aria-label":`Remove ${e.slice(0,-1)}`})]},l)),a.jsxs(B,{variant:"secondary",size:"sm",icon:Kt,onClick:r,children:["Add ",e.replace(/s$/,"")]})]}),_U=({entry:e,onChange:t})=>{const r=(n,s,i,l)=>{const o=[...e[n]||[]];switch(s){case"add":o.push("");break;case"remove":i!==void 0&&o.splice(i,1);break;case"update":i!==void 0&&l!==void 0&&(o[i]=l);break}t(n,o)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio-name",className:"block text-sm font-medium text-gray-700",children:"Set Name"}),a.jsx("input",{id:"bio-name",type:"text",value:e.name||"",onChange:n=>t("name",n.target.value),className:"mt-1 w-full px-3 py-2 border rounded-md",placeholder:"e.g., General, Human Commoner, Elven Ranger"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"A unique name for this collection of bio options."})]}),a.jsx(xm,{title:"Appearance Options",items:e.appearance||[],onAdd:()=>r("appearance","add"),onRemove:n=>r("appearance","remove",n),onUpdate:(n,s)=>r("appearance","update",n,s)}),a.jsx(xm,{title:"Mementos",items:e.mementos||[],onAdd:()=>r("mementos","add"),onRemove:n=>r("mementos","remove",n),onUpdate:(n,s)=>r("mementos","update",n,s)}),a.jsx(xm,{title:"Flaws / Weak Spots",items:e.flaws||[],onAdd:()=>r("flaws","add"),onRemove:n=>r("flaws","remove",n),onUpdate:(n,s)=>r("flaws","update",n,s)})]})};function SU(e){const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),[o,u]=w.useState(e),c=w.useCallback(p=>{switch(p){case"spells":return"game_spells";case"items":return"game_items";case"abilities":return"heroic_abilities";case"kin":return"kin";case"profession":return"professions";case"skills":return"game_skills";case"monsters":return"monsters";case"bio":return"bio_data";default:throw console.error(`Invalid data category passed to getTableName: ${p}`),new Error(`Invalid data category: ${p}`)}},[]),d=w.useCallback(async p=>{s(!0),l(null);let y;try{y=c(p),console.log(`[useGameData] Attempting to load category: ${p}, using table: ${y}`);let v=ne.from(y);p==="spells"?v=v.select(`
                *,
                magic_schools ( name )
              `):v=v.select("*"),v=v.order("name"),console.log(`[useGameData] Executing query for table: ${y}`);const{data:x,error:b}=await v;if(b)throw console.error(`[useGameData] Supabase fetch error for ${y}:`,b),b;const E=(x||[]).map(_=>{var S;let k={..._};if(p==="spells"&&(k.magic_schools=(S=_.magic_schools)==null?void 0:S.name),p==="abilities"&&typeof _.requirement=="string")try{k.requirement=JSON.parse(_.requirement)}catch{}return k});console.log(`[useGameData] Loaded ${E.length} entries for ${p} from ${y}`),r(E)}catch(v){const x=y||p;console.error(`[useGameData] Error in loadEntries for ${x}:`,v);const b=(v==null?void 0:v.message)||`Failed to load ${x}`,E=v!=null&&v.details?`: ${v.details}`:"";l(`${b}${E}`),r([])}finally{s(!1)}},[c]),h=w.useCallback(async(p,y,v,x)=>{let b="";try{x(null),s(!0),b=c(p);const{id:E,..._}=y;let k={..._};if(!k.name||String(k.name).trim()==="")throw new Error(`Cannot save ${p} without a name.`);if(p==="abilities"&&(k.willpower_cost=k.willpower_cost===""||k.willpower_cost===void 0?null:Number(k.willpower_cost),typeof k.requirement=="object"&&k.requirement!==null?Object.keys(k.requirement).length>0?k.requirement=JSON.stringify(k.requirement):k.requirement=null:(k.requirement===""||k.requirement===void 0)&&(k.requirement=null),k.kin=k.kin||null,k.profession=k.profession||null),p==="spells"&&(k.rank=Number(k.rank??0),k.willpower_cost=Number(k.willpower_cost??0),k.school_id=k.school_id||null,k.requirement=k.requirement||null),p==="skills"&&(k.attribute=k.attribute||null),p==="monsters"){const A=y;if(k.stats=A.stats||{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0},k.attacks=A.attacks||[],Array.isArray(k.attacks)&&(k.attacks=k.attacks.map(D=>{const{id:T,effects:H,...L}=D;return Array.isArray(H)&&(L.effects=H.map(G=>{const{id:Q,...$}=G;return $})),L})),!E){const{data:D,error:T}=await ne.auth.getSession();if(T||!D.session)throw new Error("User not authenticated. Cannot save monster.");k.created_by=D.session.user.id}}console.log(`[useGameData] Saving entry to ${b} (ID: ${E||"new"}):`,k);let S=null,I=null;if(E){const{data:A,error:D}=await ne.from(b).update(k).eq("id",E).select().single();S=D,I=A}else{const{data:A,error:D}=await ne.from(b).insert([k]).select().single();S=D,I=A}if(S)throw console.error(`[useGameData] Supabase Save Error (${b}):`,S),S;I?(console.log(`[useGameData] Save operation successful for ${p} (ID: ${I.id})`),v(I)):(console.warn(`[useGameData] Save operation for ${p} (ID: ${E||"new"}) did not return data. Using input data for callback.`),v({...y,id:E||(I==null?void 0:I.id)})),await d(p)}catch(E){const _=b||p,k=(E==null?void 0:E.message)||(typeof E=="string"?E:"An unexpected error occurred during save."),S=E!=null&&E.details?` (Details: ${E.details})`:"",I=E!=null&&E.code?` (Code: ${E.code})`:"",A=`Error saving ${_}: ${k}${S}${I}`;console.error(`[useGameData] Error in handleSave for ${_}:`,E),x(A)}finally{s(!1)}},[c,d]),f=w.useCallback(async(p,y)=>{if(!window.confirm(`Are you sure you want to delete this ${p} entry (ID: ${y})? This action cannot be undone.`))return;let v="";try{l(null),s(!0),v=c(p),console.log(`[useGameData] Deleting entry from ${v}, ID: ${y}`);const{error:x}=await ne.from(v).delete().eq("id",y);if(x)throw console.error(`[useGameData] Error deleting from ${v}:`,x),x;console.log(`[useGameData] Delete successful for ID: ${y} in ${p}`),await d(p)}catch(x){const b=v||p,E=(x==null?void 0:x.message)||"An unexpected error occurred during deletion.",_=x!=null&&x.details?` (Details: ${x.details})`:"",k=x!=null&&x.code?` (Code: ${x.code})`:"",S=`Error deleting ${b}: ${E}${_}${k}`;console.error(`[useGameData] Error in handleDelete for ${b}:`,x),l(S)}finally{s(!1)}},[c,d]),g=w.useCallback(p=>{console.log(`[useGameData] Switching category from ${o} to ${p}`),u(p),d(p)},[o,d]);return w.useEffect(()=>{console.log(`[useGameData] Initial load effect for category: ${e}`);try{c(e),d(e)}catch(p){console.error(`[useGameData] Invalid initial category: ${e}`,p),l(`Invalid initial category: ${e}`),s(!1)}},[e,c,d]),{entries:t,loading:n,error:i,activeCategory:o,switchCategory:g,handleSave:h,handleDelete:f}}const TU=[{id:"items",label:"Items",icon:mi},{id:"spells",label:"Spells",icon:Yd},{id:"abilities",label:"Abilities",icon:ks},{id:"kin",label:"Kin",icon:jn},{id:"profession",label:"Professions",icon:l4},{id:"skills",label:"Skills",icon:R4},{id:"monsters",label:"Monsters",icon:Gd},{id:"bio",label:"Bio Options",icon:a4}],V1=e=>{try{if(Tg(e)){const t=Object.entries(e);return t.length===0?"None":t.map(([r,n])=>`${r}${n!==null?` (Lvl ${n})`:""}`).join(", ")||"None"}if(typeof e=="string"&&e)return e;if(typeof e=="object"&&e!==null){const t=Object.keys(e);if(t.length>0)return/^[0-9a-fA-F]{8}-/.test(t[0])?`${t.length} skill(s) (Legacy UUIDs)`:t.length===1&&typeof e[t[0]]=="object"?`Requirement: ${t[0]} (Invalid Format)`:`${t.length} requirement(s) (Unknown format)`}return"None"}catch(t){return console.error("Error formatting requirement:",e,t),"Error: Invalid Format"}};function __(){const[e,t]=w.useState(null),[r,n]=w.useState(""),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,g]=w.useState([]),{entries:p,loading:y,error:v,handleSave:x,handleDelete:b,switchCategory:E,activeCategory:_}=SU("items"),k=w.useCallback(async()=>{const{data:O,error:Z}=await ne.from("game_items").select("category");Z?console.error("Error fetching item categories:",Z):O&&c([...new Set(O.map(N=>N.category).filter(Boolean))])},[]),S=w.useCallback(async()=>{const{data:O,error:Z}=await ne.from("magic_schools").select("id, name").order("name");Z?console.error("Error fetching magic schools:",Z):O&&h(O)},[]),I=w.useCallback(async()=>{const{data:O,error:Z}=await ne.from("monsters").select("category");Z?console.error("Error fetching monster categories:",Z):O&&g([...new Set(O.map(N=>N.category).filter(Boolean))])},[]);w.useEffect(()=>{o(""),_==="items"?k():_==="spells"?S():_==="monsters"&&I()},[_,k,S,I]);const A=w.useCallback(O=>{t(null),i(null),_==="items"&&k(),_==="monsters"&&I()},[_,k,I]),D=w.useCallback(async()=>{e&&await x(_,e,A,i)},[e,_,x,A]),T=w.useCallback(async O=>{O&&(await b(_,O),_==="items"&&k(),_==="monsters"&&I())},[_,b,k,I]),H=w.useCallback((O,Z)=>{t(N=>N?{...N,[O]:Z}:null)},[]),L=w.useCallback(()=>{i(null);let O={name:""};switch(_){case"spells":O={...O,description:"",rank:1,school_id:null,casting_time:"",range:"",duration:"",willpower_cost:0};break;case"items":O={...O,description:"",category:"",cost:0,weight:0};break;case"abilities":O={...O,description:"",willpower_cost:null,requirement:{},profession:null,kin:null};break;case"kin":O={...O,description:"",key_attribute:"",typical_profession:"",kin_abilities:[]};break;case"profession":O={...O,description:"",key_attribute:"",skills:[]};break;case"skills":O={...O,description:"",attribute:null};break;case"monsters":O={name:"",description:"",category:"",stats:{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:10},attacks:[]};break;case"bio":O={name:"",appearance:[],mementos:[],flaws:[]};break}t(O)},[_]),G=w.useCallback(()=>{if(!e)return null;switch(_){case"spells":return a.jsx(bU,{entry:e,onChange:H,magicSchools:d});case"items":return a.jsx(pU,{entry:e,onChange:H});case"abilities":return a.jsx(yU,{entry:e,onChange:H});case"kin":return a.jsx(gU,{entry:e,onChange:H});case"profession":return a.jsx(xU,{entry:e,onChange:H});case"skills":return a.jsx(vU,{entry:e,onChange:H});case"monsters":return a.jsx(kU,{entry:e,onChange:H});case"bio":return a.jsx(_U,{entry:e,onChange:H});default:return a.jsx("p",{children:"No form available for this category."})}},[e,_,H,d]),Q=w.useMemo(()=>p.filter(O=>{var N,z,U,j;if(!((N=O.name)==null?void 0:N.toLowerCase().includes(r.toLowerCase())))return!1;if(l){if(_==="items")return((z=O.category)==null?void 0:z.toLowerCase())===l.toLowerCase();if(_==="spells"){const me=O;if(l==="General")return!me.school_id;const X=d.find(W=>W.id===me.school_id);return((U=X==null?void 0:X.name)==null?void 0:U.toLowerCase())===l.toLowerCase()}if(_==="monsters")return((j=O.category)==null?void 0:j.toLowerCase())===l.toLowerCase()}return!0}),[p,r,l,_,d]),$=w.useCallback(()=>{t(null),i(null)},[]),V=w.useMemo(()=>_==="items"?u.sort():_==="spells"?["General",...d.map(O=>O.name)].sort():_==="monsters"?f.sort():[],[_,u,d,f]),K=w.useMemo(()=>{const O=[{header:"Name",accessor:N=>N.name}],Z="text-sm text-gray-600 max-w-xs truncate";switch(_){case"spells":return[...O,{header:"School",accessor:N=>{const z=N;if(!z.school_id)return"General";const U=d.find(j=>j.id===z.school_id);return(U==null?void 0:U.name)||"Unknown School"}},{header:"Rank",accessor:N=>N.rank===0?"Trick":`Rank ${N.rank}`},{header:"WP Cost",accessor:N=>`${N.willpower_cost} WP`}];case"items":return[...O,{header:"Category",accessor:N=>N.category},{header:"Cost",accessor:N=>N.cost},{header:"Weight",accessor:N=>N.weight}];case"abilities":return[...O,{header:"WP Cost",accessor:N=>N.willpower_cost??"N/A"},{header:"Requirement",accessor:N=>V1(N.requirement),className:Z,titleAccessor:N=>V1(N.requirement)}];case"kin":return[...O,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Typical Profession",accessor:N=>N.typical_profession}];case"profession":return[...O,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Skills",accessor:N=>Array.isArray(N.skills)?N.skills.join(", "):"",className:Z}];case"skills":return[...O,{header:"Attribute",accessor:N=>N.attribute||"N/A"},{header:"Description",accessor:N=>N.description,className:Z,titleAccessor:N=>N.description||""}];case"monsters":return[...O,{header:"Category",accessor:N=>N.category},{header:"HP",accessor:N=>{var z;return(z=N.stats)==null?void 0:z.HP}},{header:"Armor",accessor:N=>{var z;return(z=N.stats)==null?void 0:z.ARMOR}},{header:"Size",accessor:N=>{var z;return(z=N.stats)==null?void 0:z.SIZE}}];case"bio":return[...O,{header:"Appearance",accessor:N=>`${(N.appearance||[]).length} options`},{header:"Mementos",accessor:N=>`${(N.mementos||[]).length} options`},{header:"Flaws",accessor:N=>`${(N.flaws||[]).length} options`}];default:return O}},[_,d]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Game Data Management"}),a.jsx(B,{variant:"primary",icon:Kt,onClick:L,disabled:y,children:"Add Entry"})]}),v&&a.jsx(Ne,{message:`Error loading data: ${v}`}),a.jsx("div",{className:"flex gap-4 border-b overflow-x-auto pb-2",children:TU.map(({id:O,label:Z,icon:N})=>a.jsxs("button",{onClick:()=>E(O),className:`px-4 py-2 font-medium flex items-center gap-2 whitespace-nowrap ${_===O?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:y,children:[a.jsx(N,{className:"w-5 h-5"}),Z]},O))}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:`Search ${_}...`,value:r,onChange:O=>n(O.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg",disabled:y})]}),V.length>0&&a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-48",children:[a.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:l,onChange:O=>o(O.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",disabled:y,children:[a.jsxs("option",{value:"",children:["All ",_==="spells"?"Schools":"Categories"]}),V.map(O=>a.jsx("option",{value:O,children:O},O))]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),y&&!p.length?a.jsxs("p",{className:"text-center py-4",children:["Loading ",_,"..."]}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[K.map(O=>a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:O.header},O.header)),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:Q.map(O=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[K.map(Z=>a.jsx("td",{className:`px-4 py-2 align-top ${Z.className||""}`,title:Z.titleAccessor?Z.titleAccessor(O):void 0,children:Z.accessor(O)},Z.header)),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:ac,onClick:()=>{i(null),t(O)},disabled:!O.id,children:"Edit"}),a.jsx(B,{variant:"danger",size:"sm",icon:ur,onClick:()=>O.id&&T(O.id),disabled:!O.id||y,children:"Delete"})]})})]},O.id||O.name))})]}),Q.length===0&&!y&&!v&&a.jsx("p",{className:"text-center text-gray-500 py-4",children:r||l?`No ${_} found matching filters.`:`No entries for '${_}'.`})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white py-2 z-10 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.id?`Edit ${_}`:`New ${_}`}),a.jsx("button",{onClick:$,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),s&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:s})}),a.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:G()}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6 sticky bottom-0 bg-white py-3 z-10 border-t",children:[a.jsx(B,{variant:"secondary",onClick:$,disabled:y,children:"Cancel"}),a.jsx(B,{variant:"primary",icon:Gt,onClick:D,disabled:y,children:y?"Saving...":e.id?"Update Entry":"Save Entry"})]})]})})]})}function CU(){const{user:e}=$t(),[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(""),[h,f]=w.useState(null),[g,p]=w.useState(!1),y=async v=>{v.preventDefault();try{if(!i.trim()||!o.trim()||!c.trim()){f("All fields are required");return}if(!e){f("You must be logged in to create or edit entries");return}if(n){const{error:x}=await ne.from("compendium").update({title:i,content:o,category:c}).eq("id",n);if(x)throw x}else{const{error:x}=await ne.from("compendium").insert([{title:i,content:o,category:c,created_by:e.id}]);if(x)throw x}l(""),u(""),d(""),r(!1),s(null)}catch(x){f(x instanceof Error?x.message:"Failed to save entry")}};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:i,onChange:v=>l(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:c,onChange:v=>d(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>p(!1),className:`p-2 rounded-lg ${g?"text-gray-600 hover:bg-gray-100":"bg-blue-100 text-blue-700"}`,children:a.jsx(NE,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>p(!0),className:`p-2 rounded-lg ${g?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(kE,{className:"w-5 h-5"})})]})]}),g?a.jsx("div",{className:"min-h-[300px] p-4 border border-gray-300 rounded-md bg-white overflow-auto",children:a.jsx(Qg,{content:o})}):a.jsx("textarea",{value:o,onChange:v=>u(v.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:`# Heading 1
## Heading 2

Regular text with **bold** and *italic* formatting.

> Blockquote for important notes

| Table | Header |
|--------|---------|
| Cell 1 | Cell 2 |`})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null),l(""),u(""),d(""),p(!1)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(Gt,{className:"w-5 h-5"}),n?"Update Entry":"Save Entry"]})]})]})})}function jU(){const[e,t]=w.useState("users"),r=()=>{switch(e){case"users":return a.jsx(lU,{});case"gameData":return a.jsx(__,{});case"compendium":return a.jsx(CU,{});default:return null}},n=[{key:"users",label:"Users",Icon:Cu}];return a.jsxs("div",{className:"",children:[n.length>0&&a.jsx("nav",{className:"border-b",children:a.jsx("ul",{className:"flex -mb-px",children:n.map(({key:s,label:i,Icon:l})=>a.jsx("li",{className:"mr-6",children:a.jsxs("button",{onClick:()=>t(s),className:e===s?"flex items-center py-2 px-4 text-blue-600 border-b-2 border-blue-600 font-semibold":"flex items-center py-2 px-4 text-gray-600 hover:text-gray-800 hover:border-b-2 hover:border-gray-300",children:[a.jsx(l,{className:"w-5 h-5 mr-2"}),i]})},s))})}),a.jsx("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:r()})]})}function W1({children:e,className:t="",onClick:r}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 ${t} ${r?"cursor-pointer":""}`,onClick:r,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:r?n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),r())}:void 0,children:e})}const ym=[{id:"profile",label:"Profile Settings",icon:Ni,description:"Manage your personal information and account settings"},{id:"appearance",label:"Appearance",icon:T4,description:"Customize the look and feel of the application"},{id:"notifications",label:"Notifications",icon:vE,description:"Configure your notification preferences"},{id:"localization",label:"Localization",icon:SE,description:"Set your language, timezone and regional preferences"},{id:"game-data",label:"Game Data Editor",icon:mi,description:"Edit game data such as spells and items",adminOnly:!0},{id:"admin",label:"Admin Panel",icon:ks,description:"System administration and user management",adminOnly:!0}];function AU(){const{isAdmin:e}=$t(),[t,r]=w.useState(()=>"profile"),n=i=>{const l=ym.find(o=>o.id===i);l&&(!l.adminOnly||e())?r(i):l!=null&&l.adminOnly&&!e()&&(console.warn("Attempted to access admin settings without privileges."),r("profile"))};Sn.useEffect(()=>{const i=ym.find(l=>l.id===t);i!=null&&i.adminOnly&&!e()&&r("profile")},[t,e]);const s=()=>{switch(t){case"profile":return a.jsx(XB,{});case"appearance":return a.jsx(JB,{});case"notifications":return a.jsx(eU,{});case"localization":return a.jsx(aU,{});case"game-data":return e()?a.jsx(__,{}):a.jsx(Vo,{to:"/settings",replace:!0});case"admin":return e()?a.jsx(jU,{}):a.jsx(Vo,{to:"/settings",replace:!0});default:return a.jsx(Vo,{to:"/settings",replace:!0})}};return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(AE,{className:"w-8 h-8 text-gray-700"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 md:col-span-4 space-y-4",children:ym.filter(i=>!i.adminOnly||e()).map(i=>a.jsx(W1,{onClick:()=>n(i.id),className:`cursor-pointer transition-all ${t===i.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${t===i.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:a.jsx(i.icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium",children:i.label}),a.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),a.jsx(Vs,{className:`w-5 h-5 ${t===i.id?"text-blue-500":"text-gray-400"}`})]})},i.id))}),a.jsx("div",{className:"col-span-12 md:col-span-8",children:a.jsx(W1,{children:s()})})]})]})}function IU(){const[e,t]=w.useState(!0),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState("player"),[f,g]=w.useState(null),[p,y]=w.useState(null),[v,x]=w.useState({}),[b,E]=w.useState(!1),[_,k]=w.useState(navigator.onLine),{signIn:S,signUp:I}=$t(),A=dn(),D=ja();w.useEffect(()=>{var $;($=D.state)!=null&&$.message&&(y(D.state.message),A(D.pathname,{replace:!0,state:{}}))},[D,A]),w.useEffect(()=>{const $=()=>k(!0),V=()=>k(!1);return window.addEventListener("online",$),window.addEventListener("offline",V),()=>{window.removeEventListener("online",$),window.removeEventListener("offline",V)}},[]);const T=()=>{n(""),i(""),o(""),c(""),h("player"),g(null),y(null),x({})},H=()=>{t(!e),T()},L=async()=>{const $=WB.safeParse({email:r.trim(),password:s});if(!$.success){const V={};return $.error.errors.forEach(K=>{K.path[0]&&(V[String(K.path[0])]=K.message)}),x(V),g("Please fix the errors in the form."),!1}try{E(!0);const{email:V,password:K}=$.data;return await S(V,K),!0}catch(V){return g(V instanceof Error?V.message:"Login failed. Please try again."),!1}finally{E(!1)}},G=async()=>{const $=GB.safeParse({username:l.trim(),email:r.trim(),password:s,confirmPassword:u,role:d});if(!$.success){const V={};return $.error.errors.forEach(K=>{K.path[0]&&(V[String(K.path[0])]=K.message)}),x(V),g("Please fix the errors in the form."),!1}try{E(!0);const{email:V,password:K,username:O,role:Z}=$.data;return await I(V,K,O,Z),y("Registration successful! Please check your email to verify your account before logging in."),t(!0),T(),n(V),!0}catch(V){return g(V instanceof Error?V.message:"Signup failed. Please try again."),!1}finally{E(!1)}},Q=async $=>{if($.preventDefault(),g(null),y(null),x({}),!_){g("No internet connection");return}e?await L():await G()};return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(ks,{className:"mx-auto h-12 w-12 text-blue-600"}),a.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:e?"Log in to DragonBane":"Create your DragonBane Account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e?"Enter your details to access your account":"Fill in the details to register"})]}),!_&&a.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ft,{className:"h-5 w-5 text-yellow-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No internet connection"}),a.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Please check your internet connection and try again."})]})]})}),f&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ft,{className:"h-5 w-5 text-red-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:e?"Login Error":"Signup Error"}),a.jsx("p",{className:"mt-2 text-sm text-red-700",children:f})]})]})}),p&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ft,{className:"h-5 w-5 text-green-400 mr-2"})," ",a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),a.jsx("p",{className:"mt-2 text-sm text-green-700",children:p})]})]})}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:Q,noValidate:!0,children:[a.jsxs("div",{className:"space-y-4",children:[!e&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ni,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,autoComplete:"username",value:l,onChange:$=>o($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.username?"border-red-500":"border-gray-300"}`,placeholder:"Choose a username",disabled:b})]}),v.username&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.username})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(wg,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:r,onChange:$=>n($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address",disabled:b})]}),v.email&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.email})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:e?"current-password":"new-password",value:s,onChange:$=>i($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password",disabled:b})]}),v.password&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.password})]}),!e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,autoComplete:"new-password",value:u,onChange:$=>c($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password",disabled:b})]}),v.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.confirmPassword})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Register as"}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"player",checked:d==="player",onChange:()=>h("player"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Player"})]}),a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"dm",checked:d==="dm",onChange:()=>h("dm"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Dungeon Master (DM)"})]})]}),v.role&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.role})]})]})]}),a.jsx(B,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:!_||b,icon:e?sc:Cu,iconPosition:"left",children:e?"Log in":"Sign up"})]}),a.jsx("div",{className:"text-sm text-center",children:a.jsx("button",{type:"button",onClick:H,className:"font-medium text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:b,children:e?"Don't have an account? Sign up":"Already have an account? Log in"})})]})})}const G1=({type:e})=>a.jsx("span",{className:"font-semibold text-xs uppercase",children:e}),RU={d4:4,d6:6,d8:8,d10:10,d12:12,d20:20};function Y1(e){return Math.floor(Math.random()*RU[e])+1}function LU(){const{showDiceRoller:e,toggleDiceRoller:t,currentConfig:r,dicePool:n,addDie:s,removeLastDie:i,clearDicePool:l,isBoonActive:o,isBaneActive:u,setBoon:c,setBane:d,addRollToHistory:h,rollHistory:f,clearHistory:g}=Dn(),{markSkillInSession:p}=tr(),[y,v]=w.useState([]),[x,b]=w.useState([]),[E,_]=w.useState(null),[k,S]=w.useState(!1),[I,A]=w.useState(void 0),[D,T]=w.useState(!1),H=(r==null?void 0:r.rollMode)==="skillCheck",L=(r==null?void 0:r.rollMode)==="deathRoll",G=(r==null?void 0:r.rollMode)==="rallyRoll",Q=(r==null?void 0:r.rollMode)==="recoveryRoll",$=(r==null?void 0:r.rollMode)==="advancementRoll",V=w.useCallback(()=>{if(n.length===0)return;v([]),b([]),_(null),S(!1),A(void 0);const N=n.map(J=>({type:J,value:Y1(J)}));let z=[],U=N.reduce((J,te)=>J+te.value,0),j=U,me=!1,X,W=r==null?void 0:r.skillName;if((o||u)&&n.length===1&&n[0]==="d20"){z=[{type:"d20",value:Y1("d20")}];const J=N[0].value,te=z[0].value;j=o?Math.min(J,te):Math.max(J,te),U=j}else n.length===1&&n[0]==="d20"&&(j=N[0].value,U=j);if(n.length===1&&n[0]==="d20"){const J=j;J===1&&(me=!0,U="Dragon!",X=!0),J===20&&(me=!0,U="Demon!",X=!1),(r==null?void 0:r.targetValue)!==void 0&&!me&&(H||G||$||L)&&(X=J<=r.targetValue),H&&W&&(J===1||J===20)&&p(W)}else Q&&n.length===1&&n[0]==="d6"&&(j=N[0].value,U=j,X=void 0,me=!1);v(N),b(z),_(U),S(me),A(X);const q={description:(r==null?void 0:r.description)||`${n.join(", ")} Roll`,dicePool:[...n],results:N,boonResults:z.length>0?z:void 0,finalOutcome:U,isBoon:o,isBane:u,targetValue:r==null?void 0:r.targetValue,isSuccess:X,isCritical:me,skillName:W};h(q),r!=null&&r.onRollComplete&&r.onRollComplete(q),r!=null&&r.onRoll&&r.onRoll({total:j})},[n,o,u,r,h,p,Q,H,G,$,L]);if(w.useEffect(()=>{e||(v([]),b([]),_(null),S(!1),A(void 0),T(!1))},[e]),!e)return null;const K=()=>r!=null&&r.description?r.description:L?"Death Save (d20 vs CON)":G?"Rally Roll (d20 vs WIL, Bane)":Q?"Recovery Roll (1d6 HP)":$?"Advancement Roll (d20 vs Skill)":H?"Skill Check (d20 vs Skill)":"Dice Roller",O=()=>L?a.jsx(Gd,{className:"w-5 h-5"}):G?a.jsx(RE,{className:"w-5 h-5"}):Q?a.jsx(vg,{className:"w-5 h-5"}):$?a.jsx(Ro,{className:"w-5 h-5"}):H?a.jsx(or,{className:"w-5 h-5"}):a.jsx(or,{className:"w-5 h-5"}),Z=L||G||Q||$;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center text-lg font-semibold",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[O()," ",K()]}),a.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-800",children:a.jsx(Pt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:D?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Roll History"}),a.jsxs(B,{onClick:g,variant:"danger",size:"xs",disabled:f.length===0,children:[a.jsx(ur,{className:"w-3 h-3 mr-1"})," Clear"]})]}),f.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No rolls yet."}):a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(N=>a.jsxs("li",{className:"text-xs border-b pb-1",children:[a.jsx("p",{className:"font-medium",children:N.description}),a.jsxs("p",{children:["Pool: ",N.dicePool.join(", ")," ",N.isBoon?"(Boon)":"",N.isBane?"(Bane)":""]}),a.jsxs("p",{children:["Rolls: ",N.results.map(z=>z.value).join(", ")," ",N.boonResults?`| Boon/Bane: ${N.boonResults.map(z=>z.value).join(", ")}`:""]}),a.jsxs("p",{children:["Outcome: ",a.jsx("span",{className:"font-semibold",children:String(N.finalOutcome)}),N.targetValue!==void 0&&` (vs ${N.targetValue})`,N.isSuccess===!0&&a.jsx("span",{className:"text-green-600 ml-1",children:"(Success)"}),N.isSuccess===!1&&a.jsx("span",{className:"text-red-600 ml-1",children:"(Failure)"}),N.isCritical&&a.jsx("span",{className:"text-purple-600 ml-1",children:"(Critical!)"})]}),N.skillName&&a.jsxs("p",{className:"text-gray-500",children:["Skill: ",N.skillName]})]},N.id))})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-3 border rounded bg-gray-50 min-h-[50px] flex flex-wrap gap-2 items-center",children:n.length===0?a.jsx("span",{className:"text-gray-500 italic",children:"Dice pool is empty"}):n.map((N,z)=>a.jsxs("button",{onClick:()=>!Z&&i(),className:`px-2 py-1 border rounded shadow-sm flex items-center ${Z?"bg-gray-300 cursor-not-allowed":"bg-white hover:bg-red-50 hover:border-red-300"}`,title:Z?void 0:"Remove last die",disabled:Z,children:[a.jsx(G1,{type:N}),!Z&&a.jsx(Pt,{className:"w-3 h-3 ml-1 text-red-500"})]},z))}),!Z&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-4",children:["d4","d6","d8","d10","d12","d20"].map(N=>a.jsx(B,{onClick:()=>s(N),variant:"outline",size:"sm",className:"flex justify-center items-center",children:a.jsx(G1,{type:N})},N))}),n.length===1&&n[0]==="d20"&&!Z&&a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsxs(B,{onClick:()=>c(!o),variant:o?"success":"outline",size:"sm",className:`flex items-center ${o?"ring-2 ring-green-400 ring-offset-1":""}`,children:[a.jsx(Mh,{className:`w-4 h-4 mr-1 ${o?"text-white":"text-green-500"}`})," Boon"]}),a.jsxs(B,{onClick:()=>d(!u),variant:u?"danger":"outline",size:"sm",className:`flex items-center ${u?"ring-2 ring-red-400 ring-offset-1":""}`,children:[a.jsx(O4,{className:`w-4 h-4 mr-1 ${u?"text-white":"text-red-500"}`})," Bane"]})]}),y.length>0&&a.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50 border-blue-200 text-center",children:[a.jsxs("p",{className:"text-sm text-blue-700 mb-1",children:["Rolled: ",y.map(N=>N.value).join(", "),x.length>0&&` | Boon/Bane: ${x.map(N=>N.value).join(", ")}`]}),a.jsx("p",{className:`text-2xl font-bold ${k?"text-purple-600":"text-blue-900"}`,children:String(E)}),(r==null?void 0:r.targetValue)!==void 0&&!k&&a.jsxs("p",{className:"text-sm text-gray-600",children:["(Target: ",r.targetValue,")"]}),I===!0&&!k&&a.jsx("p",{className:"text-green-600 font-semibold mt-1",children:"Success!"}),I===!1&&!k&&a.jsx("p",{className:"text-red-600 font-semibold mt-1",children:"Failure!"})]})]})}),a.jsxs("div",{className:"p-4 border-t flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{children:[a.jsxs(B,{onClick:()=>T(!D),variant:"secondary",size:"sm",children:[a.jsx(g4,{className:"w-4 h-4 mr-1"})," ",D?"Roller":"History"]}),!D&&!Z&&a.jsxs(B,{onClick:l,variant:"ghost",size:"sm",className:"ml-2 text-red-600 hover:bg-red-100",disabled:n.length===0,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Clear Pool"]})]}),!D&&a.jsxs(B,{onClick:V,disabled:n.length===0,size:"lg",children:[a.jsx(or,{className:"w-5 h-5 mr-2"})," Roll"]})]})]})})}function OU({children:e}){const{user:t,isLoading:r}=$t(),n=ja();return console.log("--- PrivateRoute Decision ---",{isLoading:r,user:t?`User ID: ${t.id}`:null}),r?a.jsx("div",{className:"flex h-screen w-full items-center justify-center",children:a.jsx("p",{className:"text-xl text-gray-600",children:"Loading Session..."})}):t?a.jsx(a.Fragment,{children:e}):a.jsx(Vo,{to:"/login",state:{from:n},replace:!0})}function PU({textToCopy:e}){const[t,r]=w.useState(!1),n=async()=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Failed to copy text: ",s)}};return a.jsx(B,{variant:"ghost",size:"icon",onClick:n,"aria-label":t?"Copied":"Copy to clipboard",children:t?a.jsx(Wa,{className:"w-5 h-5 text-green-500"}):a.jsx(yg,{className:"w-5 h-5 text-gray-500"})})}function DU({partyId:e,isDM:t}){const{user:r}=$t(),[n,s]=w.useState([]),[i,l]=w.useState([]),[o,u]=w.useState(null),[c,d]=w.useState(!1),[h,f]=w.useState(null),[g,p]=w.useState(""),[y,v]=w.useState(""),[x,b]=w.useState(""),[E,_]=w.useState("all"),[k,S]=w.useState(""),[I,A]=w.useState(!0),[D,T]=w.useState(null),[H,L]=w.useState(null),G=w.useCallback(()=>{p(""),v(""),b(E==="all"?"":E),L(null)},[E]),Q=()=>{G(),d(!0),f(null),u(null)},$=U=>{u(U),f(U.id),d(!1),p(U.title),v(U.content),b(U.category),L(null)},V=()=>{d(!1),f(null),G(),h&&u(null)},K=w.useCallback(async()=>{if(e){A(!0),T(null);try{const{data:U,error:j}=await ne.from("notes").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(j)throw j;s(U||[]);const me=Array.from(new Set((U==null?void 0:U.map(X=>X.category).filter(Boolean))||[]));l(me)}catch(U){console.error("Error loading party notes:",U),T(U instanceof Error?U.message:"Failed to load party notes"),s([])}finally{A(!1)}}},[e]);w.useEffect(()=>{K()},[K]);const O=async()=>{if(!r){L("User not authenticated.");return}if(!g.trim()){L("Note title cannot be empty.");return}if(!x.trim()){L("Note category cannot be empty.");return}L(null);const U={title:g.trim(),content:y||"",category:x.trim(),party_id:e,user_id:r.id,updated_at:new Date().toISOString()};try{let j=null;if(h){const{data:me,error:X}=await ne.from("notes").update(U).eq("id",h).select().single();if(X)throw X;j=me}else{const{updated_at:me,...X}=U,{data:W,error:q}=await ne.from("notes").insert([X]).select().single();if(q)throw q;j=W}V(),await K(),j&&u(j)}catch(j){console.error("Error saving note:",j);let me="Failed to save note.";j instanceof Error&&(j.message.includes("RLS")?me="Permission denied. Could not save the note due to security policies.":"code"in j&&j.code==="23505"?me="A note with this title might already exist in this party.":me=`Failed to save note: ${j.message}`),L(me)}},Z=async U=>{if(window.confirm("Are you sure you want to delete this note?"))try{T(null);const{error:j}=await ne.from("notes").delete().eq("id",U);if(j)throw j;await K(),(o==null?void 0:o.id)===U&&u(null),h===U&&V()}catch(j){console.error("Error deleting note:",j),T(j instanceof Error?`Failed to delete note: ${j.message}`:"An unknown error occurred while deleting.")}},N=n.filter(U=>{const j=U.title.toLowerCase().includes(k.toLowerCase())||U.content.toLowerCase().includes(k.toLowerCase()),me=E==="all"||U.category===E;return j&&me});if(I&&n.length===0&&!e)return a.jsx("div",{className:"p-4",children:a.jsx(Ne,{message:"Party ID is missing. Cannot load notes."})});if(I&&n.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:[" ",a.jsx(He,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading party notes..."})]});const z=c||h;return a.jsxs("div",{className:"flex h-[calc(100vh-150px)] overflow-hidden bg-gray-50",children:[" ",a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(nc,{className:"w-5 h-5 text-indigo-600"}),"Party Notes"]}),a.jsx(B,{variant:"primary",size:"sm",icon:Kt,onClick:Q,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:k,onChange:U=>S(U.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsxs("select",{id:"category-filter",value:E,onChange:U=>_(U.target.value),className:"w-full pl-9 pr-7 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white text-sm","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(U=>a.jsx("option",{value:U,children:U},U))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Oh,{className:"w-3 h-3 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[D&&!z&&a.jsx("div",{className:"p-3",children:a.jsx(Ne,{message:D,onClose:()=>T(null)})}),N.length>0?N.map(U=>a.jsxs("div",{onClick:()=>{(!h||h!==U.id)&&(u(U),d(!1),f(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(o==null?void 0:o.id)===U.id&&!z?"bg-indigo-50 border-l-4 border-indigo-500":""} ${h===U.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:U.title}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-0.5",children:[a.jsx(Zy,{className:"w-2.5 h-2.5"}),a.jsx("span",{className:"truncate",children:U.category})]})]},U.id)):!I&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Pl,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),k||E!=="all"?"No notes match filters.":"No notes in this party yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:z?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Edit Party Note":"Create New Party Note"}),a.jsx("button",{onClick:V,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100","aria-label":"Close form",children:a.jsx(Pt,{className:"w-5 h-5"})})]}),H&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:H,onClose:()=>L(null)})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"note-title",type:"text",value:g,onChange:U=>p(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{id:"note-category",type:"text",value:x,onChange:U=>b(U.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Quests, Locations, NPCs",list:"category-suggestions",required:!0}),i.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("datalist",{id:"category-suggestions",children:i.map(U=>a.jsx("option",{value:U},U))}),a.jsxs("select",{value:x,onChange:U=>b(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white text-sm","aria-label":"Select existing category",children:[a.jsx("option",{value:"",disabled:!0,children:"Select existing..."}),i.map(U=>a.jsx("option",{value:U,children:U},U))]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"note-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"note-content",value:y,onChange:U=>v(U.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your notes here..."})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-3",children:[a.jsx(B,{variant:"secondary",onClick:V,children:"Cancel"}),a.jsx(B,{variant:"primary",icon:Gt,onClick:O,disabled:I||!g.trim()||!x.trim(),children:I?"Saving...":h?"Update Note":"Save Note"})]})]}):o?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx(Zy,{className:"w-3 h-3"}),a.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-700",children:o.category})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(B,{variant:"secondary",size:"sm",icon:ac,onClick:()=>$(o),children:"Edit"}),a.jsx(B,{variant:"danger_outline",size:"sm",icon:ur,onClick:()=>Z(o.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Qg,{content:o.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(o.created_at).toLocaleDateString(),o.updated_at&&new Date(o.updated_at).getTime()!==new Date(o.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(o.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Pl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a party note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),D&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ne,{message:D,onClose:()=>T(null)})})]})})]})}async function MU(e){if(!e)return console.warn("fetchTasks called without partyId"),[];const{data:t,error:r}=await ne.from("party_tasks").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching tasks:",r),new Error(r.message||"Failed to fetch tasks");return t||[]}async function FU(e,t){if(!t)throw new Error("User must be authenticated to create a task.");if(!e.party_id)throw new Error("Party ID is required to create a task.");if(!e.title||e.title.trim()==="")throw new Error("Task title cannot be empty.");const{data:r,error:n}=await ne.from("party_tasks").insert({party_id:e.party_id,title:e.title,description:e.description,created_by_user_id:t.id,status:"open"}).select().single();if(n)throw console.error("Error creating task:",n),new Error(n.message||"Failed to create task");if(!r)throw new Error("Task creation did not return data.");return r}async function BU(e,t){if(!e)throw new Error("Task ID is required to update a task.");const r={...t};t.status&&(t.status==="completed"?r.completed_at=new Date().toISOString():t.status==="open"&&(r.completed_at=null));const{data:n,error:s}=await ne.from("party_tasks").update(r).eq("id",e).select().single();if(s)throw console.error("Error updating task:",s),new Error(s.message||"Failed to update task");if(!n)throw new Error("Task update did not return data.");return n}async function UU(e){if(!e)throw new Error("Task ID is required to delete a task.");const{error:t}=await ne.from("party_tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),new Error(t.message||"Failed to delete task")}function HU(){const e=dn(),{setGlobalError:t}=DE(),r=w.useCallback((i,l)=>{const o=i instanceof Error?i.message:String(i);ul.handleError(i,{action:l==null?void 0:l.action,additionalData:{critical:l==null?void 0:l.critical}}),(l==null?void 0:l.showError)!==!1&&t(o),l!=null&&l.redirect&&e(l.redirect),l!=null&&l.critical&&e("/error",{state:{error:o}})},[e,t]),n=w.useCallback((i,l)=>{ul.handleAuthError(i,{action:l==null?void 0:l.action});const o=i instanceof Error?i.message:String(i);t(o),e((l==null?void 0:l.redirect)||"/login")},[e,t]),s=w.useCallback((i,l)=>{ul.handleNetworkError(i,{action:l==null?void 0:l.action}),t("Network error. Please check your connection and try again."),l!=null&&l.retry&&setTimeout(l.retry,1e3)},[t]);return{handleError:r,handleAuthError:n,handleNetworkError:s}}function $U({partyId:e,isDM:t}){const{user:r}=$t(),n=cn(),{handleError:s}=HU(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(!1),{data:h,isLoading:f,error:g}=Lt({queryKey:["partyTasks",e],queryFn:()=>MU(e),enabled:!!e}),p=Et({mutationFn:k=>FU(k,r),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]}),l(""),u(""),d(!1)},onError:k=>{s(k,{action:"creating task"})}}),y=Et({mutationFn:({taskId:k,updates:S})=>BU(k,S),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"updating task"})}}),v=Et({mutationFn:k=>UU(k),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"deleting task"})}}),x=k=>{if(k.preventDefault(),!i.trim()){s(new Error("Task title cannot be empty."),{action:"adding task",showError:!0});return}p.mutate({party_id:e,title:i.trim(),description:o.trim()||void 0})},b=k=>{y.mutate({taskId:k.id,updates:{status:k.status==="open"?"completed":"open"}})},E=k=>{window.confirm("Are you sure you want to delete this task?")&&v.mutate(k)},_=k=>t||k.created_by_user_id===(r==null?void 0:r.id);return f?a.jsx(He,{}):g?a.jsx(Ne,{message:`Failed to load tasks: ${g.message}`}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Party Tasks"}),t&&a.jsx(B,{icon:c?void 0:Kt,onClick:()=>d(!c),variant:c?"secondary":"primary",children:c?"Cancel":"Add Task"})]}),t&&c&&a.jsxs("form",{onSubmit:x,className:"p-4 border rounded-lg bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"newTaskTitle",className:"block text-sm font-medium text-gray-700",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"newTaskTitle",value:i,onChange:k=>l(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g., Clear out the goblin cave",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"newTaskDescription",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),a.jsx("textarea",{id:"newTaskDescription",value:o,onChange:k=>u(k.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Any additional details about the task..."})]}),a.jsx(B,{type:"submit",loading:p.isPending,icon:Kt,children:"Add Task"})]}),h&&h.length>0?a.jsx("ul",{className:"space-y-3",children:h.map(k=>{var S;return a.jsxs("li",{className:`p-4 border rounded-lg flex items-start justify-between gap-4 ${k.status==="completed"?"bg-green-50 border-green-200":"bg-white"}`,children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{variant:"ghost",size:"icon",onClick:()=>b(k),loading:y.isPending&&((S=y.variables)==null?void 0:S.taskId)===k.id,className:k.status==="completed"?"text-green-600 hover:text-green-700":"text-gray-400 hover:text-gray-600","aria-label":k.status==="completed"?"Mark as open":"Mark as completed",children:k.status==="completed"?a.jsx(Su,{size:20}):a.jsx(d4,{size:20})}),a.jsx("h3",{className:`text-lg font-medium ${k.status==="completed"?"line-through text-gray-500":""}`,children:k.title})]}),k.description&&a.jsx("p",{className:`mt-1 text-sm ${k.status==="completed"?"text-gray-400":"text-gray-600"}`,children:k.description}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Added on: ",new Date(k.created_at).toLocaleDateString(),k.completed_at&&k.status==="completed"&&a.jsxs("span",{children:[" | Completed on: ",new Date(k.completed_at).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:_(k)&&a.jsx(B,{variant:"ghost",size:"icon",onClick:()=>E(k.id),loading:v.isPending&&v.variables===k.id,className:"text-red-500 hover:text-red-700","aria-label":"Delete task",children:a.jsx(ur,{size:18})})})]},k.id)})}):a.jsxs("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(ic,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tasks yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t?"Get started by adding a new task for your party.":"The DM hasn't added any tasks yet."}),t&&!c&&a.jsx(B,{onClick:()=>d(!0),className:"mt-4",icon:Kt,children:"Add First Task"})]})]})}function zU({partyId:e,members:t,isDM:r}){var Z;const n=cn(),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null),[d,h]=w.useState(""),[f,g]=w.useState("all"),[p,y]=w.useState(""),[v,x]=w.useState([]),[b,E]=w.useState([]),[_,k]=w.useState(!1),{data:S=[],isLoading:I,error:A}=Lt({queryKey:["gameItems"],queryFn:lc,staleTime:1e3*60*10}),D=N=>{if(N)return S.find(z=>z.name===N)};w.useEffect(()=>{T(),H()},[e]);async function T(){try{o(!0),c(null);const{data:N,error:z}=await ne.from("party_inventory").select("*").eq("party_id",e);if(z)throw z;i(N||[])}catch(N){c(N instanceof Error?N.message:"Failed to load inventory"),i([])}finally{o(!1)}}async function H(){try{const{data:N,error:z}=await ne.from("party_inventory_log").select("*").eq("party_id",e).order("timestamp",{ascending:!1}).limit(50);if(z)throw z;E(N||[])}catch(N){console.error("Failed to load transaction log:",N),E([])}}const L=async()=>{if(!(!p||v.length===0))try{c(null);const N=t.find(z=>z.id===p);if(!N)throw new Error("Character not found");await Promise.all(v.map(async z=>{const U=s.find(te=>te.id===z);if(!U||!U.name||U.quantity<1)return;let j;if(U.quantity>1?{error:j}=await ne.from("party_inventory").update({quantity:U.quantity-1}).eq("id",U.id):{error:j}=await ne.from("party_inventory").delete().eq("id",U.id),j)throw j;const me=N.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},X=me.inventory||[],W=D(U.name);if(W){const te=X.findIndex(de=>de.name===W.name);if(te>-1)X[te].quantity+=1;else{const de={...W,id:void 0,quantity:1,originalName:W.name};X.push(de)}}else{console.warn(`Details not found for item: ${U.name}. Transferring with basic info.`);const te={name:U.name,quantity:1,originalName:U.name,description:U.description,category:U.category},de=X.findIndex(ve=>ve.name===te.name);de>-1?X[de].quantity+=1:X.push(te)}const{error:q}=await ne.from("characters").update({equipment:{...me,inventory:X}}).eq("id",N.id);if(q)throw q;const{error:J}=await ne.from("party_inventory_log").insert([{party_id:e,item_name:U.name,quantity:1,from_type:"party",from_id:e,to_type:"character",to_id:N.id}]);if(J)throw J})),await Promise.all([T(),H(),n.invalidateQueries({queryKey:["character",N.id]}),n.invalidateQueries({queryKey:["party",e]})]),x([])}catch(N){c(N instanceof Error?N.message:"Failed to transfer items"),await T()}},G=async(N,z)=>{try{c(null);const U=t.find(te=>te.id===N);if(!U)throw new Error("Character not found");if(!z.name){console.warn("Attempted to transfer an item without a name.");return}const j=U.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}};let me=j.inventory||[];const X=me.findIndex(te=>te.name===z.name);if(X===-1){console.warn(`Item "${z.name}" not found in character ${N}'s inventory.`);return}me[X].quantity>1?me[X].quantity-=1:me=[...me.slice(0,X),...me.slice(X+1)];const{error:W}=await ne.from("characters").update({equipment:{...j,inventory:me}}).eq("id",U.id);if(W)throw W;const q=s.find(te=>te.name===z.name);if(q){const{error:te}=await ne.from("party_inventory").update({quantity:q.quantity+1}).eq("id",q.id);if(te)throw te}else{const{error:te}=await ne.from("party_inventory").insert([{party_id:e,name:z.name,quantity:1,category:z.category||"misc",description:z.description||z.effect}]).select();if(te)throw te}const{error:J}=await ne.from("party_inventory_log").insert([{party_id:e,item_name:z.name,quantity:1,from_type:"character",from_id:U.id,to_type:"party",to_id:e}]);if(J)throw J;await Promise.all([T(),H(),n.invalidateQueries({queryKey:["character",U.id]}),n.invalidateQueries({queryKey:["party",e]})])}catch(U){c(U instanceof Error?U.message:"Failed to transfer item to party")}},Q=s.map(N=>N.category).filter(N=>typeof N=="string"&&N.trim()!==""),$=["all",...new Set(Q)],V=s.filter(N=>{const U=(N.name||"").toLowerCase().includes(d.toLowerCase()),j=f==="all"||N.category===f;return U&&j}),K=t.find(N=>N.id===p),O=((Z=K==null?void 0:K.equipment)==null?void 0:Z.inventory)??[];return a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 lg:col-span-7",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Party Inventory"}),a.jsx(B,{variant:"secondary",onClick:()=>k(!_),children:_?"Hide History":"Show History"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search items...",value:d,onChange:N=>h(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("select",{value:f,onChange:N=>g(N.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:$.map(N=>a.jsx("option",{value:N,children:N==="all"?"All Categories":N},N))})]})]}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[l?a.jsx(He,{}):u?a.jsx(Ne,{message:u}):V.map(N=>a.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer ${v.includes(N.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-100"}`,onClick:()=>{N.id?x(z=>z.includes(N.id)?z.filter(U=>U!==N.id):[...z,N.id]):console.warn("Attempted to select an item without an ID:",N)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:N.name||"Unnamed Item"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",N.quantity]})]}),N.category&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100",children:N.category})]}),N.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:N.description})]},N.id)),!l&&V.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:d||f!=="all"?"No items found matching filters.":"Party inventory is empty."})})]})]})}),a.jsxs("div",{className:"col-span-12 lg:col-span-5",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Transfer Items"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Character"}),a.jsxs("select",{value:p,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Choose a character..."}),t.map(N=>a.jsxs("option",{value:N.id,children:[N.name," (",N.kin," ",N.profession,")"]},N.id))]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsx(B,{variant:"secondary",icon:Lh,disabled:!p||v.length===0,onClick:L,title:"Transfer selected items from Party to Character",children:"To Character"})}),p&&K&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-4",children:[K.name,"'s Inventory"]}),a.jsxs("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded p-2",children:[O.map((N,z)=>a.jsxs("div",{className:"p-2 border-b flex items-center justify-between text-sm",children:[a.jsxs("span",{children:[N.name||"Unnamed Item"," (Qty: ",N.quantity,")"]}),a.jsx(B,{variant:"secondary",size:"sm",icon:xE,onClick:()=>G(p,N),disabled:!N.name,title:N.name?`Transfer ${N.name} to Party`:"Cannot transfer unnamed item",children:"Give"})]},N.id||`${N.name||"unknown"}-${z}`)),O.length===0&&a.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Character inventory is empty."})]})]})]}),_&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transaction History"}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[b.map(N=>{var z,U;return a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"font-medium",children:[N.item_name||"Unknown Item"," (Qty: ",N.quantity,")"]}),a.jsx("span",{className:"text-gray-500 text-xs",children:new Date(N.timestamp).toLocaleString()})]}),a.jsxs("p",{className:"text-gray-600 text-xs",children:[N.from_type==="party"?"Party":((z=t.find(j=>j.id===N.from_id))==null?void 0:z.name)||"Unknown Char","  ",N.to_type==="party"?"Party":((U=t.find(j=>j.id===N.to_id))==null?void 0:U.name)||"Unknown Char"]})]},N.id)}),b.length===0&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:"No transactions recorded yet."})]})]})]})]})}async function qU(){const{data:e,error:t}=await ne.from("monsters").select("*").order("name");if(t)throw console.error("Error fetching all monsters:",t),t;return e||[]}function VU(e){const t=cn();w.useEffect(()=>{if(!e)return;const r=[],n=ne.channel(`encounter:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"encounters",filter:`id=eq.${e}`},i=>{console.log("Encounter updated:",i),t.invalidateQueries({queryKey:["encounterDetails",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter channel error for ${e}:`,l)});r.push(n);const s=ne.channel(`encounter_combatants:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${e}`},i=>{console.log("Encounter combatants changed:",i),t.invalidateQueries({queryKey:["encounterCombatants",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter_combatants:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter combatants channel error for ${e}:`,l)});return r.push(s),()=>{console.log(`Unsubscribing from encounter channels for ${e}`),r.forEach(i=>ne.removeChannel(i))}},[e,t])}const Q1=({stats:e})=>a.jsx("table",{className:"w-full text-sm mt-1",children:a.jsx("tbody",{children:Object.entries(e).map(([t,r])=>a.jsxs("tr",{className:"border-b border-gray-200 last:border-b-0",children:[a.jsx("td",{className:"py-1 pr-2 font-semibold text-gray-600 capitalize",children:t.replace(/_/g," ")}),a.jsx("td",{className:"py-1 text-gray-800",children:String(r)})]},t))})});function K1({description:e,attackName:t}){const{toggleDiceRoller:r}=Dn(),n=/(\d*d\d+\s*[+-]?\s*\d*)/gi,s=e.split(n);return a.jsx("p",{className:"text-gray-800 mt-1",children:s.map((i,l)=>i.match(n)&&i.match(/[dD]/)?a.jsx("button",{className:"font-bold text-blue-600 hover:underline bg-blue-100 px-1 py-0.5 rounded-md mx-0.5",onClick:()=>r==null?void 0:r({dice:i.toLowerCase().replace(/\s/g,""),label:`${t} - Damage Roll`}),children:i},l):a.jsx("span",{children:i},l))})}function Z1({text:e,contextLabel:t}){const{toggleDiceRoller:r}=Dn();if(!e)return null;const n=/(\d*d\d+\s*[+-]?\s*\d*)/gi,s=e.split(n),i=l=>l.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>");return a.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:s.map((l,o)=>{if(l.match(n)&&l.match(/[dD]/))return a.jsx("button",{className:"font-bold text-blue-600 hover:underline bg-blue-100 px-1 py-0.5 rounded-md mx-0.5",onClick:()=>r==null?void 0:r({dice:l.toLowerCase().replace(/\s/g,""),label:`${t} - Effects Roll`}),children:l},o);const u=i(l);return a.jsx("span",{dangerouslySetInnerHTML:{__html:u}},o)})})}function WU({entry:e}){var n;const t=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});let r=null;switch(e.type){case"round_advanced":r=a.jsxs("p",{className:"font-bold text-blue-600 text-center py-1",children:["--- Round ",e.round," ---"]});break;case"turn_start":r=a.jsxs(a.Fragment,{children:[a.jsx(Wd,{className:"w-4 h-4 inline mr-2 text-gray-500"}),"Turn started for ",a.jsx("strong",{children:e.name}),"."]});break;case"turn_end":r=a.jsxs(a.Fragment,{children:[a.jsx(sc,{className:"w-4 h-4 inline mr-2 text-gray-500"}),"Turn ended for ",a.jsx("strong",{children:e.name}),"."]});break;case"hp_change":const s=e.delta<0;r=a.jsxs("span",{className:s?"text-red-700":"text-green-700",children:[a.jsx(si,{className:"w-4 h-4 inline mr-2"}),a.jsx("strong",{children:e.name})," ",s?`took ${Math.abs(e.delta)} damage`:`healed ${e.delta} HP`,". (",e.from,"  ",e.to,")"]});break;case"monster_attack":r=a.jsxs("span",{className:"text-yellow-800",children:[a.jsx(as,{className:"w-4 h-4 inline mr-2"}),a.jsx("strong",{children:e.name})," used ",a.jsx("strong",{children:((n=e.attack)==null?void 0:n.name)||"an attack"})," (Rolled ",e.roll,")."]});break;default:r=a.jsx("span",{children:JSON.stringify(e)})}return e.type==="round_advanced"?a.jsx("div",{className:"w-full",children:r}):a.jsxs("div",{className:"flex items-start gap-2 text-sm py-1.5",children:[a.jsx("time",{className:"text-xs text-gray-400 mt-0.5 whitespace-nowrap",children:t(e.ts)}),a.jsx("div",{className:"flex-grow",children:r})]})}function GU({log:e}){return!e||e.length===0?a.jsx("p",{className:"text-sm text-gray-500 mt-2 px-1",children:"No events have been logged yet."}):a.jsx("div",{className:"space-y-1 divide-y divide-gray-100",children:e.slice().reverse().map((t,r)=>a.jsx(WU,{entry:t},r))})}function YU({partyId:e,partyMembers:t,isDM:r}){var yc,ge,Fr,Zr;const n=cn(),{toggleDiceRoller:s}=Dn(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(null),[h,f]=w.useState(!1),[g,p]=w.useState("details"),[y,v]=w.useState("idle"),[x,b]=w.useState(!1),[E,_]=w.useState([]),[k,S]=w.useState(""),[I,A]=w.useState(""),[D,T]=w.useState(1),[H,L]=w.useState(""),[G,Q]=w.useState(""),[$,V]=w.useState({}),[K,O]=w.useState(!1),[Z,N]=w.useState(""),[z,U]=w.useState(""),[j,me]=w.useState([]),[X,W]=w.useState(!1),[q,J]=w.useState(null),[te,de]=w.useState({}),[ve,Ae]=w.useState({}),[we,Ze]=w.useState(null),[tt,ct]=w.useState(""),{data:rt,isLoading:Zt,error:mr}=Lt({queryKey:["allEncounters",e],queryFn:()=>z5(e),enabled:!!e}),{data:At,isLoading:no,error:js}=Lt({queryKey:["allMonsters"],queryFn:qU}),Re=w.useMemo(()=>c||(rt&&rt.length>0?rt[0].id:null),[c,rt]),{data:dt,isLoading:so,error:re}=Lt({queryKey:["encounterDetails",Re],queryFn:()=>Re?q5(Re):Promise.resolve(null),enabled:!!Re}),{data:ce,isLoading:Ce,error:Le}=Lt({queryKey:["encounterCombatants",Re],queryFn:()=>Re?nN(Re):Promise.resolve([]),enabled:!!Re});VU(Re);const Xe=Et({mutationFn:M=>W5(e,M.name,M.description),onSuccess:M=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(M.id),p("details"),l(""),u("")}}),pr=Et({mutationFn:J5,onSuccess:(M,fe)=>{n.invalidateQueries({queryKey:["allEncounters",e]}),c===fe&&d(null)}}),fn=Et({mutationFn:({encounterId:M,name:fe})=>G5(M,fe),onSuccess:M=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(M.id)}}),kr=Et({mutationFn:M=>{if(!Re)throw new Error("No active encounter");return Y5({encounterId:Re,characterId:M.characterId,initiativeRoll:M.initiativeRoll})},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Re]}),_([]),L("")}}),mn=Et({mutationFn:M=>{if(!Re)throw new Error("No active encounter");return Q5(M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Re]}),S(""),A(""),T(1),Q(""),b(!1)}}),rr=Et({mutationFn:M=>sN(M.id,M.updates),onSuccess:M=>{n.setQueryData(["encounterCombatants",Re],fe=>(fe==null?void 0:fe.map(_e=>_e.id===M.id?M:_e))??[])}}),Tt=Et({mutationFn:eI,onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Re]})}}),pn=Et({mutationFn:M=>{if(!Re)throw new Error("No active encounter to update");return Sg(Re,M)},onSuccess:M=>{n.setQueryData(["encounterDetails",Re],M),n.invalidateQueries({queryKey:["allEncounters",e]}),O(!1)}}),_r=Et({mutationFn:M=>{if(!Re)throw new Error("No active encounter");return tI(Re,M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Re]}),me([])}}),Xh=Et({mutationFn:({id1:M,id2:fe})=>rI(M,fe),onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Re]}),W(!1),J(null)}}),Jh=Et({mutationFn:()=>{if(!Re)throw new Error("No encounter to start");return Z5(Re)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Re],refetchType:"active"}),n.invalidateQueries({queryKey:["allEncounters",e],refetchType:"active"})}}),ef=Et({mutationFn:()=>{if(!Re)throw new Error("No encounter to end");return X5(Re)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Re],refetchType:"active"}),n.invalidateQueries({queryKey:["allEncounters",e],refetchType:"active"})}}),gn=Et({mutationFn:M=>{if(!Re)throw new Error("No encounter to log");return K5(Re,M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Re]})}}),gc=Et({mutationFn:()=>{if(!Re)throw new Error("No encounter for next round");return nextRound(Re)},onSuccess:async()=>{await gn.mutateAsync({type:"round_advanced",ts:Date.now(),round:((dt==null?void 0:dt.current_round)??0)+1}),n.setQueryData(["encounterCombatants",Re],M=>(M==null?void 0:M.map(fe=>({...fe,initiative_roll:null})))??[]),me([]),Ze(null),n.invalidateQueries({queryKey:["encounterDetails",Re]})}}),As=w.useMemo(()=>new Map((At??[]).map(M=>[M.id,M])),[At]),et=w.useMemo(()=>(ce==null?void 0:ce.slice().sort((M,fe)=>{const _e=M.initiative_roll??1e3,Ve=fe.initiative_roll??1e3;return _e!==Ve?_e-Ve:(M.display_name??"").localeCompare(fe.display_name??"")}))||[],[ce]),ht=w.useMemo(()=>et.find(M=>M.id===we),[et,we]),he=w.useMemo(()=>ht!=null&&ht.monster_id?As.get(ht.monster_id):null,[ht,As]);w.useEffect(()=>{Zt||p(!rt||rt.length===0?"create":"details")},[rt,Zt]),w.useEffect(()=>{if(!et)return;const M={};et.forEach(fe=>{M[fe.id]={current_hp:String(fe.current_hp??fe.max_hp??0),current_wp:fe.max_wp!=null?String(fe.current_wp??fe.max_wp??""):void 0,initiative_roll:fe.initiative_roll!=null?String(fe.initiative_roll):""}}),V(M)},[et]),w.useEffect(()=>{dt&&(N(dt.name),U(dt.description||""))},[dt]),w.useEffect(()=>{if((dt==null?void 0:dt.status)==="active"&&et.length>0&&!we){const M=et[0];Ze(M.id),gn.mutate({type:"turn_start",ts:Date.now(),who:M.id,name:M.display_name})}(dt==null?void 0:dt.status)!=="active"&&Ze(null)},[et,dt==null?void 0:dt.status,dt==null?void 0:dt.current_round,gn,we]);const Oe=M=>{M.preventDefault(),i.trim()&&Xe.mutate({name:i.trim(),description:o.trim()||void 0})},Ie=(M,fe)=>fn.mutate({encounterId:M,name:`${fe} (Copy)`}),nt=M=>{d(M),f(!1)},Ye=()=>{E.length!==0&&E.forEach(M=>{kr.mutate({characterId:M,initiativeRoll:H?parseInt(H):null})})},lt=M=>{_(fe=>fe.includes(M)?fe.filter(_e=>_e!==M):[...fe,M])},zt=()=>{var Ve;const M=At==null?void 0:At.find(bt=>bt.id===k);if(!M||!Re)return;const fe=((Ve=M.stats)==null?void 0:Ve.FEROCITY)??1,_e=I.trim()||M.name;for(let bt=1;bt<=D;bt++){const ot=D>1?`${_e} ${bt}`:_e;for(let Rs=1;Rs<=fe;Rs++){const rf=fe>1?`${ot} (Action ${Rs})`:ot;mn.mutate({encounterId:Re,monsterId:k,customName:rf,initiativeRoll:G?parseInt(G):null})}}},Si=M=>{const fe=$[M],_e=et.find(ot=>ot.id===M);if(!fe||!_e)return;const Ve={},bt=parseInt(fe.current_hp,10);if(!isNaN(bt)&&bt!==_e.current_hp){Ve.current_hp=bt;const ot=bt-(_e.current_hp??0);gn.mutate({type:"hp_change",ts:Date.now(),who:M,name:_e.display_name,delta:ot,from:_e.current_hp,to:bt})}if(fe.initiative_roll!=null){const ot=fe.initiative_roll.trim()===""?null:parseInt(fe.initiative_roll,10);(ot===null||!isNaN(ot))&&ot!==_e.initiative_roll&&(Ve.initiative_roll=ot)}if(_e.max_wp!=null&&fe.current_wp!=null){const ot=fe.current_wp.trim()===""?null:parseInt(fe.current_wp,10);if((ot===null||!isNaN(ot))&&ot!==_e.current_wp){Ve.current_wp=ot;const Rs=(ot??0)-(_e.current_wp??0);gn.mutate({type:"wp_change",ts:Date.now(),who:M,name:_e.display_name,delta:Rs,from:_e.current_wp,to:ot})}}Object.keys(Ve).length>0&&rr.mutate({id:M,updates:Ve})},xc=()=>{j.length!==0&&_r.mutate(j)},Is=M=>{X&&(q?q!==M&&Xh.mutate({id1:q,id2:M}):J(M))},ao=M=>de(fe=>({...fe,[M]:!fe[M]})),Ti=(M,fe)=>{if(!fe.attacks||fe.attacks.length===0)return;const _e=Math.floor(Math.random()*6)+1,Ve=fe.attacks.find(bt=>bt.roll_values.split(",").includes(String(_e)));Ae(bt=>({...bt,[M]:Ve||null})),gn.mutate({type:"monster_attack",ts:Date.now(),who:M,name:fe.name,roll:_e,attack:Ve?{name:Ve.name,desc:Ve.description}:null})},Oa=M=>{if(we&&we!==M){const _e=et.find(Ve=>Ve.id===we);_e&&gn.mutate({type:"turn_end",ts:Date.now(),who:we,name:_e.display_name})}Ze(M);const fe=et.find(_e=>_e.id===M);fe&&gn.mutate({type:"turn_start",ts:Date.now(),who:M,name:fe.display_name})},tf=()=>{if(!we||!et||et.length===0)return;const M=et.findIndex(_e=>_e.id===we),fe=M+1;if(fe<et.length)Oa(et[fe].id);else{const _e=et[M];_e&&gn.mutate({type:"turn_end",ts:Date.now(),who:we,name:_e.display_name}),Ze(null)}},io=w.useMemo(()=>{const M=new Set(et.map(fe=>fe.character_id));return t.filter(fe=>!M.has(fe.id))},[t,et]),Kr=w.useMemo(()=>At==null?void 0:At.find(M=>M.id===k),[At,k]);if(!r)return a.jsx("div",{className:"p-4 text-center text-gray-600",children:a.jsx("p",{children:"Only the DM can view and manage encounter details."})});if(Zt||no)return a.jsx(He,{});if(mr||js)return a.jsx(Ne,{message:(mr==null?void 0:mr.message)||(js==null?void 0:js.message)||"Error loading data"});const at=dt;return a.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[a.jsx("div",{className:"sticky top-0 z-30 bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 p-4 shadow-sm rounded-lg",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Encounter"}),at&&a.jsxs("div",{className:"text-sm text-gray-700 mt-1 flex items-center gap-3",children:[a.jsxs("span",{children:["Status: ",a.jsx("span",{className:`font-semibold ${at.status==="active"?"text-green-600":at.status==="planning"?"text-yellow-600":"text-blue-600"}`,children:at.status})]}),at.status==="active"&&at.current_round>0&&a.jsxs("span",{children:["Round: ",a.jsx("span",{className:"font-semibold",children:at.current_round})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{onClick:()=>f(!0),Icon:w4,variant:"secondary",children:"Encounters"}),a.jsx(B,{onClick:()=>s==null?void 0:s(),Icon:as,variant:"outline",children:"Dice"}),a.jsx(B,{onClick:()=>p("create"),Icon:Vd,children:"New"}),(at==null?void 0:at.status)==="planning"&&a.jsx(B,{onClick:()=>Jh.mutate(),Icon:j4,children:"Start"}),(at==null?void 0:at.status)==="active"&&a.jsxs(a.Fragment,{children:[a.jsx(B,{onClick:()=>gc.mutate(),Icon:P4,isLoading:gc.isPending,children:"Next Round"}),a.jsx(B,{onClick:()=>b(!0),Icon:Li,variant:"outline",children:"Reinforcements"}),a.jsx(B,{onClick:()=>ef.mutate(),Icon:LE,variant:"secondary",children:"End"})]})]})]})}),g==="create"?a.jsxs("form",{onSubmit:Oe,className:"bg-white p-6 rounded-lg shadow space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create New Encounter"}),a.jsx("input",{type:"text",placeholder:"Encounter Name",value:i,onChange:M=>l(M.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md"}),a.jsx("textarea",{placeholder:"Description (optional)",value:o,onChange:M=>u(M.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{type:"submit",Icon:Vd,isLoading:Xe.isPending,children:"Create Encounter"}),rt&&rt.length>0&&a.jsx(B,{variant:"secondary",onClick:()=>p("details"),children:"Cancel"})]})]}):so||!at?a.jsx(He,{}):re?a.jsx(Ne,{message:re.message}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:K?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:Z,onChange:M=>N(M.target.value),className:"w-full px-3 py-2 border rounded-md text-xl font-semibold",placeholder:"Encounter Name"}),a.jsx("textarea",{value:z,onChange:M=>U(M.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md text-gray-600 mt-2",placeholder:"Description"}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(B,{size:"sm",onClick:()=>pn.mutate({name:Z,description:z}),isLoading:pn.isPending,Icon:Gt,children:"Save"}),a.jsx(B,{size:"sm",variant:"secondary",onClick:()=>O(!1),Icon:ll,children:"Cancel"})]})]}):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:at.name}),at.description&&a.jsx("p",{className:"text-gray-600",children:at.description})]}),a.jsx(B,{size:"sm",variant:"ghost",onClick:()=>O(!0),Icon:Eg,"aria-label":"Edit"})]}),a.jsxs("div",{className:"text-sm mt-2",children:["Status: ",a.jsx("span",{className:`font-medium ${at.status==="active"?"text-green-600":"text-yellow-600"}`,children:at.status}),at.current_round>0&&at.status==="active"&&a.jsxs("span",{className:"ml-3",children:["Round: ",at.current_round]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("section",{className:"lg:col-span-3 space-y-4",children:at.status==="planning"?a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow lg:sticky lg:top-24 self-start",children:[a.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Build the encounter"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h5",{className:"text-base font-medium flex items-center gap-2",children:[a.jsx(jn,{className:"w-5 h-5"})," Add Combatants"]}),y!=="idle"&&a.jsx(B,{variant:"ghost",size:"sm",onClick:()=>v("idle"),Icon:Lh,children:"Back"})]}),y==="idle"&&a.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2",children:[a.jsx(B,{onClick:()=>v("characters"),Icon:Cu,size:"lg",variant:"outline",children:"Add Party Members"}),a.jsx(B,{onClick:()=>v("monsters"),Icon:Li,size:"lg",variant:"outline",children:"Add Monsters"})]}),y==="characters"&&a.jsxs("div",{className:"space-y-3 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Party Members"}),a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto border rounded-md p-2 bg-gray-50",children:io.length>0?io.map(M=>a.jsxs("div",{className:"flex items-center gap-2 p-1 rounded hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",id:`member-${M.id}`,checked:E.includes(M.id),onChange:()=>lt(M.id),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:`member-${M.id}`,className:"text-sm font-medium text-gray-800",children:M.name})]},M.id)):a.jsx("p",{className:"text-xs text-gray-500 p-2",children:"All party members have been added."})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:H,onChange:M=>L(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(B,{type:"button",variant:"outline",Icon:as,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Party Initiative",onRoll:M=>L(String(M.total))})})]}),a.jsxs(B,{onClick:Ye,Icon:Cu,isLoading:kr.isPending,disabled:E.length===0,children:["Add Members (",E.length,")"]})]}),y==="monsters"&&a.jsxs("div",{className:"space-y-2 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),At==null?void 0:At.map(M=>a.jsxs("option",{value:M.id,children:[M.name," ",M.category&&`(${M.category})`]},M.id))]}),Kr&&a.jsxs("div",{className:"space-y-2 text-xs text-gray-600 p-2 bg-gray-50 rounded border max-h-60 overflow-y-auto",children:[Kr.stats&&a.jsxs(a.Fragment,{children:[a.jsx("h6",{className:"font-bold text-gray-700",children:"Stats:"}),a.jsx(Q1,{stats:Kr.stats})]}),Kr.effectsSummary&&a.jsxs("div",{className:"mt-2 pt-2 border-t",children:[a.jsx("h6",{className:"font-bold text-gray-700",children:"Effects Summary:"}),a.jsx(Z1,{text:Kr.effectsSummary,contextLabel:Kr.name})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:I,onChange:M=>A(M.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:D,onChange:M=>T(Math.max(1,parseInt(M.target.value)||1)),min:"1",className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:G,onChange:M=>Q(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(B,{type:"button",variant:"outline",Icon:as,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Monster Initiative",onRoll:M=>Q(String(M.total))})})]}),a.jsxs(B,{onClick:zt,Icon:Li,isLoading:mn.isPending,disabled:!k,children:["Add Monster",D>1?`s (${D})`:""]})]})]}):a.jsxs("div",{className:"lg:sticky lg:top-24 self-start space-y-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("h4",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(EE,{className:"w-5 h-5"})," Temporary Notes"]}),a.jsx("textarea",{placeholder:"Use this space for temporary notes, conditions, or reminders...",value:tt,onChange:M=>ct(M.target.value),rows:6,className:"w-full px-3 py-2 border rounded-md mt-2 text-sm"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Note: These notes are not saved with the encounter."})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Combat Log"}),a.jsx("div",{className:"max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:a.jsx(GU,{log:at.log||[]})})]})]})}),a.jsxs("section",{className:"lg:col-span-5 space-y-4",children:[at.status==="active"&&a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-400 p-4 rounded-lg shadow-md",children:[a.jsxs("h4",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(sc,{className:"w-5 h-5"})," Now Acting"]}),ht?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"text-xl font-bold mt-1",children:ht.display_name}),a.jsx(B,{size:"sm",Icon:u4,onClick:tf,children:"Next Turn"})]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[ht.monster_id&&As.get(ht.monster_id)&&a.jsx(B,{size:"sm",Icon:as,variant:"danger_outline",onClick:()=>Ti(ht.id,As.get(ht.monster_id)),children:"Roll Attack"}),a.jsx(B,{size:"sm",Icon:Wd,variant:"outline",onClick:()=>Ze(null),children:"Clear Actor"})]}),a.jsxs("div",{className:"mt-3 border-t pt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Combatant Stats:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded-md border",children:[a.jsx(si,{className:"w-5 h-5 text-red-600"}),a.jsx("input",{type:"number",value:((yc=$[ht.id])==null?void 0:yc.current_hp)??"",onChange:M=>V(fe=>({...fe,[ht.id]:{...fe[ht.id],current_hp:M.target.value}})),className:"w-20 px-2 py-1 border rounded-md text-sm font-semibold"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",ht.max_hp," HP"]}),a.jsx(B,{size:"sm",onClick:()=>Si(ht.id),Icon:Gt,isLoading:rr.isPending&&((ge=rr.variables)==null?void 0:ge.id)===ht.id,children:"Save"})]}),(he==null?void 0:he.stats)&&a.jsx("div",{className:"p-2 bg-gray-50 rounded-md border",children:a.jsx(Q1,{stats:Object.fromEntries(Object.entries(he.stats).filter(([M])=>M!=="HP"))})})]})]}),(he==null?void 0:he.effectsSummary)&&a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700 mb-1",children:"Effects Summary:"}),a.jsx("div",{className:"text-sm p-2 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800",children:a.jsx(Z1,{text:he.effectsSummary,contextLabel:ht.display_name})})]})]}),ht.monster_id&&ve[ht.id]&&a.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:ve[ht.id].name}),a.jsx(K1,{description:ve[ht.id].description,attackName:ve[ht.id].name})]})]}):a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:et.length>0?"End of round. Ready for the next round.":"Add combatants to begin."})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-lg font-medium",children:"Turn Order"}),at.status!=="completed"&&et.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"selectAll",checked:j.length===et.length&&et.length>0,onChange:M=>me(M.target.checked?et.map(fe=>fe.id):[])}),a.jsx("label",{htmlFor:"selectAll",className:"text-sm font-medium",children:"All"})]}),a.jsxs(B,{size:"sm",onClick:xc,Icon:as,isLoading:_r.isPending,disabled:j.length===0,children:["Roll (",j.length,")"]}),a.jsx(B,{size:"sm",variant:X?"danger":"secondary",onClick:()=>{W(!X),J(null)},Icon:n4,children:X?"Cancel Swap":"Swap"})]})]}),et.length===0?a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No combatants in the encounter yet."}):a.jsx("ul",{className:"divide-y divide-gray-200",children:et.map(M=>{var fe;return a.jsxs("li",{className:`flex flex-wrap items-center justify-between py-2 px-2 -mx-2 rounded-md transition-all ${X?"cursor-pointer hover:bg-blue-50":"cursor-pointer"} ${q===M.id?"ring-2 ring-blue-500":""} ${we===M.id?"bg-blue-100":""}`,onClick:()=>X?Is(M.id):Oa(M.id),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",className:"ml-1",checked:j.includes(M.id),onChange:_e=>{_e.target.checked?me(Ve=>[...Ve,M.id]):me(Ve=>Ve.filter(bt=>bt!==M.id))},onClick:_e=>_e.stopPropagation()}),a.jsx("span",{className:"w-8 text-center text-lg font-bold text-gray-700",children:M.initiative_roll??"-"}),a.jsx("span",{className:"font-medium",children:M.display_name})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:_e=>_e.stopPropagation(),children:[a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((fe=$[M.id])==null?void 0:fe.initiative_roll)??"",onChange:_e=>V(Ve=>({...Ve,[M.id]:{...Ve[M.id],initiative_roll:_e.target.value}})),placeholder:"Init"}),a.jsx(B,{size:"icon_sm",variant:"ghost",onClick:()=>s==null?void 0:s({dice:"1d20",label:`Initiative for ${M.display_name}`,onRoll:_e=>V(Ve=>({...Ve,[M.id]:{...Ve[M.id],initiative_roll:String(_e.total)}}))}),children:a.jsx(as,{className:"w-4 h-4"})}),a.jsx(B,{size:"icon_sm",onClick:()=>Si(M.id),children:a.jsx(Gt,{className:"w-4 h-4"})})]})]},M.id)})})]})]}),a.jsxs("section",{className:"lg:col-span-4 space-y-5",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-red-700",children:[a.jsx(Li,{className:"w-5 h-5"})," Monsters"]}),Ce?a.jsx(He,{}):Le?a.jsx(Ne,{message:Le.message}):et.filter(M=>M.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No monsters yet."}):et.filter(M=>M.monster_id).map(M=>{var bt,ot,Rs;const fe=M.monster_id?As.get(M.monster_id.trim()):void 0,_e=!!te[M.id],Ve=ve[M.id];return a.jsxs("article",{className:`border-l-4 rounded-r-lg shadow p-3 transition-all ${we===M.id?"border-red-600 bg-red-50":"border-red-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-bold truncate",children:M.display_name}),a.jsx("p",{className:"text-xs text-red-800",children:(fe==null?void 0:fe.name)??"Monster"})]}),a.jsx(B,{size:"sm",variant:"danger",onClick:()=>Tt.mutate(M.id),Icon:ur,isLoading:Tt.isPending&&Tt.variables===M.id})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(si,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",value:((bt=$[M.id])==null?void 0:bt.current_hp)??"",onChange:rf=>V(Xg=>({...Xg,[M.id]:{...Xg[M.id],current_hp:rf.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_hp]})]}),a.jsx(B,{size:"sm",onClick:()=>Si(M.id),Icon:Gt,isLoading:rr.isPending&&((ot=rr.variables)==null?void 0:ot.id)===M.id})]}),a.jsxs("div",{className:"mt-3 border-t pt-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700",children:"Attacks"}),a.jsxs(B,{size:"sm",variant:"ghost",onClick:()=>ao(M.id),children:[_e?"Hide":"Show",_e?a.jsx(o4,{className:"w-4 h-4 ml-1"}):a.jsx(Oh,{className:"w-4 h-4 ml-1"})]})]}),_e&&a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsx(B,{size:"sm",Icon:as,onClick:()=>fe&&Ti(M.id,fe),disabled:!((Rs=fe==null?void 0:fe.attacks)!=null&&Rs.length),children:"Roll Attack"}),Ve&&a.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:Ve.name}),a.jsx(K1,{description:Ve.description,attackName:Ve.name})]})]})]})]},M.id)})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-blue-700",children:[a.jsx(jn,{className:"w-5 h-5"})," Party"]}),Ce?a.jsx(He,{}):Le?a.jsx(Ne,{message:Le.message}):et.filter(M=>!M.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No party members yet."}):et.filter(M=>!M.monster_id).map(M=>{var fe,_e,Ve;return a.jsxs("div",{className:`p-3 rounded-lg border-l-4 shadow transition-all ${we===M.id?"border-blue-600 bg-blue-50":"border-blue-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:M.display_name}),a.jsx("p",{className:"text-xs text-gray-600",children:"Player Character"})]}),a.jsx(B,{size:"sm",variant:"danger",onClick:()=>Tt.mutate(M.id),Icon:ur,isLoading:Tt.isPending&&Tt.variables===M.id})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(si,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((fe=$[M.id])==null?void 0:fe.current_hp)??"",onChange:bt=>V(ot=>({...ot,[M.id]:{...ot[M.id],current_hp:bt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_hp]})]}),M.max_wp!=null&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(An,{className:"w-4 h-4 text-yellow-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((_e=$[M.id])==null?void 0:_e.current_wp)??"",onChange:bt=>V(ot=>({...ot,[M.id]:{...ot[M.id],current_wp:bt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_wp]})]}),a.jsx(B,{size:"sm",onClick:()=>Si(M.id),Icon:Gt,isLoading:rr.isPending&&((Ve=rr.variables)==null?void 0:Ve.id)===M.id})]})]},M.id)})]})]})]}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[a.jsx(Li,{className:"w-5 h-5"})," Add Reinforcements"]}),a.jsx(B,{variant:"ghost",size:"sm",onClick:()=>b(!1),Icon:ll,children:"Cancel"})]}),a.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),At==null?void 0:At.map(M=>a.jsxs("option",{value:M.id,children:[M.name," ",M.category&&`(${M.category})`]},M.id))]}),Kr&&a.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-gray-50 rounded border",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"HP:"})," ",((Fr=Kr.stats)==null?void 0:Fr.HP)||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Ferocity:"})," ",((Zr=Kr.stats)==null?void 0:Zr.FEROCITY)||"N/A"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:I,onChange:M=>A(M.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:D,onChange:M=>T(Math.max(1,parseInt(M.target.value)||1)),min:1,className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:G,onChange:M=>Q(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(B,{type:"button",variant:"outline",Icon:as,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Reinforcement Initiative",onRoll:M=>Q(String(M.total))})})]}),a.jsxs(B,{onClick:zt,Icon:Li,isLoading:mn.isPending,disabled:!k,className:"w-full",children:["Add Monster",D>1?`s (${D})`:""," to Fight"]})]})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl space-y-4 max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"All Encounters"}),a.jsx(B,{variant:"ghost",size:"sm",onClick:()=>f(!1),Icon:ll,children:"Close"})]}),a.jsx("div",{className:"overflow-y-auto space-y-2 border-t pt-4",children:(rt??[]).map(M=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-md ${Re===M.id?"bg-blue-100":"bg-gray-50"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:M.name}),a.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Status: ",M.status]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{size:"sm",onClick:()=>nt(M.id),disabled:Re===M.id,children:"Select"}),a.jsx(B,{size:"sm",variant:"outline",Icon:yg,onClick:()=>Ie(M.id,M.name),children:"Duplicate"}),a.jsx(B,{size:"sm",variant:"danger",Icon:ur,onClick:()=>pr.mutate(M.id),children:"Delete"})]})]},M.id))})]})})]})]})}const S_=w.createContext(void 0);function T_(){const e=w.useContext(S_);if(!e)throw new Error("useDropdown must be used within a DropdownMenu");return e}function QU({children:e}){const[t,r]=w.useState(!1),n=w.useRef(null);return w.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&r(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),a.jsx(S_.Provider,{value:{isOpen:t,setIsOpen:r},children:a.jsx("div",{className:"relative inline-block text-left",ref:n,children:e})})}function KU({children:e}){const{isOpen:t,setIsOpen:r}=T_();return a.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),r(s=>!s)},className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-expanded":t,"aria-haspopup":"true",children:e||a.jsx(bg,{className:"w-5 h-5"})})}function ZU({children:e}){const{isOpen:t,setIsOpen:r}=T_();return t?a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",children:a.jsx("div",{className:"py-1",role:"none",onClick:()=>r(!1),children:e})}):null}function X1({onSelect:e,children:t,className:r}){return a.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),e()},className:`flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 ${r}`,role:"menuitem",children:t})}function XU(){return a.jsx("div",{className:"border-t border-gray-100 my-1"})}function JU(){const{id:e}=dg(),t=dn(),{user:r,isDM:n}=$t(),s=cn(),[i,l]=w.useState(!1),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState("members"),{data:g,isLoading:p,error:y}=Lt({queryKey:["party",e],queryFn:()=>LF(e),enabled:!!e}),v=Et({mutationFn:A=>{if(!e)throw new Error("Party ID is missing");return OF(e,A)},onSuccess:()=>{s.invalidateQueries({queryKey:["party",e]}),s.invalidateQueries({queryKey:["availableCharacters"]}),u(null),d(null)}}),x=Et({mutationFn:()=>{if(!e)throw new Error("Party ID is missing");return PF(e)},onSuccess:()=>{s.invalidateQueries({queryKey:["parties"]}),t("/adventure-party")}}),b=A=>{d(A),u("removeMember")},E=()=>{c&&v.mutate(c)},_=()=>{x.mutate()},k=r&&g&&r.id===g.created_by&&n(),S=g!=null&&g.invite_code?`${window.location.origin}/party/join/${g.invite_code}`:"";if(p)return a.jsx("div",{className:"flex justify-center items-center p-8",children:a.jsx(He,{size:"lg"})});if(y)return a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:y.message})});if(!g)return a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:"Party not found."})});const I=[{id:"members",label:"Members",icon:jn},{id:"notes",label:"Notes",icon:S4},{id:"tasks",label:"Tasks",icon:EE},{id:"inventory",label:"Inventory",icon:bE},{id:"encounter",label:"Encounter",icon:Ng}];return a.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[a.jsxs("div",{className:"bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:g.name}),a.jsx("p",{className:"text-gray-500 mt-1",children:"A band of brave adventurers."})]}),k&&a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsxs(QU,{children:[a.jsx(KU,{children:a.jsx(B,{variant:"outline",size:"icon","aria-label":"Party Actions",children:a.jsx(bg,{className:"h-5 w-5"})})}),a.jsxs(ZU,{children:[a.jsxs(X1,{onSelect:()=>l(A=>!A),children:[a.jsx(Cu,{className:"w-4 h-4"}),"Invite Player"]}),a.jsx(XU,{}),a.jsxs(X1,{onSelect:()=>u("deleteParty"),className:"text-red-500 hover:text-red-700 hover:bg-red-50 focus:bg-red-50",children:[a.jsx(ur,{className:"w-4 h-4"}),"Delete Party"]})]})]})})]}),i&&k&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800",children:"Share this link to invite players:"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-white p-2 rounded-md",children:[a.jsx("input",{type:"text",readOnly:!0,value:S,className:"w-full bg-transparent text-gray-700 focus:outline-none"}),a.jsx(PU,{textToCopy:S})]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-6 px-6","aria-label":"Tabs",children:I.map(A=>a.jsxs("button",{onClick:()=>f(A.id),className:`shrink-0 flex items-center gap-2 px-1 py-4 text-sm font-medium border-b-2 ${h===A.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(A.icon,{className:"w-5 h-5"}),A.label]},A.id))})}),a.jsxs("div",{className:"p-6",children:[h==="members"&&a.jsx("div",{className:"space-y-4",children:g.members.length>0?g.members.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-2 bg-gray-200 rounded-full",children:a.jsx(mi,{className:"w-6 h-6 text-gray-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:A.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[A.kin," ",A.profession]})]})]}),k&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{variant:"outline",size:"sm",onClick:()=>t(`/character/${A.id}`),"aria-label":`View ${A.name}'s sheet`,icon:_E,children:"View Sheet"}),a.jsx(B,{variant:"ghost",size:"icon",onClick:()=>b(A.id),"aria-label":`Remove ${A.name}`,children:a.jsx(Xy,{className:"w-5 h-5 text-red-500"})})]})]},A.id)):a.jsx("p",{className:"text-center text-gray-500 py-8",children:"This party has no members yet. Invite someone!"})}),h==="notes"&&a.jsx(DU,{partyId:e,isDM:k}),h==="tasks"&&a.jsx($U,{partyId:e,isDM:k}),h==="inventory"&&a.jsx(zU,{partyId:e,members:g.members,isDM:k}),h==="encounter"&&a.jsx(YU,{partyId:e,partyMembers:g.members,isDM:k})]})]}),a.jsx($p,{isOpen:o==="removeMember",onClose:()=>u(null),onConfirm:E,title:"Remove Member",description:"Are you sure you want to remove this character from the party? This action cannot be undone.",confirmText:"Remove",isDestructive:!0,isLoading:v.isPending,icon:a.jsx(Xy,{className:"w-6 h-6 text-red-500"})}),a.jsx($p,{isOpen:o==="deleteParty",onClose:()=>u(null),onConfirm:_,title:"Delete Party",description:"Are you sure you want to permanently delete this party? All members will be removed. This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:x.isPending,icon:a.jsx(IE,{className:"w-6 h-6 text-red-500"})})]})}function eH(){var g;const{inviteCode:e}=dg();console.log("Invite Code from URL:",e);const t=dn(),{user:r}=$t(),n=cn(),[s,i]=w.useState(""),{data:l=[],isLoading:o,error:u}=Lt({queryKey:["availableCharacters",r==null?void 0:r.id],queryFn:()=>u_(r==null?void 0:r.id),enabled:!!r}),c=Et({mutationFn:async p=>{if(!p)throw new Error("Please select a character");if(!e)throw new Error("Invite code is missing");const{data:y,error:v}=await ne.rpc("join_party_with_character",{p_invite_code:e,p_character_id:p});if(v)throw v.message.includes("invalid_invite_code")?new Error("This invite link is invalid or has expired."):v.message.includes("character_already_in_a_party")?new Error("This character is already in a party."):v.message.includes("user_already_in_party")?new Error("You are already a member of this party."):v;return y},onSuccess:p=>{const y=p==null?void 0:p.party_id;y?(n.invalidateQueries({queryKey:["parties"]}),n.invalidateQueries({queryKey:["party",y]}),n.invalidateQueries({queryKey:["availableCharacters",r==null?void 0:r.id]}),t(`/party/${y}`)):t("/adventure-party")}}),d=()=>{s&&c.mutate(s)},h=o,f=(u==null?void 0:u.message)||((g=c.error)==null?void 0:g.message);return h?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsx(He,{size:"lg"})}):f?a.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[a.jsx(Ne,{message:f}),a.jsx(B,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(jn,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Join an Adventure"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"You've been invited to join a new party!"})]}),l.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-center text-gray-700",children:"Select one of your available characters to join with."}),a.jsx("div",{className:"space-y-3",children:l.map(p=>a.jsxs("div",{onClick:()=>i(p.id),className:`p-4 border rounded-lg cursor-pointer transition-all flex items-center justify-between ${s===p.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-500":"border-gray-200 hover:border-blue-400"}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:p.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[p.kin," ",p.profession]})]}),s===p.id&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx(Wa,{className:"w-4 h-4 text-white"})})]},p.id))}),a.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[a.jsx(B,{variant:"secondary",onClick:()=>t("/adventure-party"),children:"Cancel"}),a.jsx(B,{variant:"primary",loading:c.isPending,disabled:!s||c.isPending,onClick:d,children:"Join with Selected Character"})]})]}):a.jsxs("div",{className:"text-center py-8 border-t mt-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any available characters to join with."}),a.jsx(B,{variant:"primary",onClick:()=>t("/"),children:"Create a Character"})]})]})})}function tH(){return a.jsxs(a.Fragment,{children:[a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-white focus:text-blue-600",children:"Skip to main content"}),a.jsxs(_y,{children:[a.jsx(Xr,{path:"/login",element:a.jsx(IU,{})}),a.jsx(Xr,{path:"*",element:a.jsx(OU,{children:a.jsxs(a.Fragment,{children:[a.jsx(r6,{}),a.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:a.jsxs(_y,{children:[a.jsx(Xr,{path:"/",element:a.jsx($5,{})}),a.jsx(Xr,{path:"/character/:id",element:a.jsx(DI,{})}),a.jsx(Xr,{path:"/compendium",element:a.jsx(IF,{})}),a.jsx(Xr,{path:"/adventure-party",element:a.jsx(DF,{})}),a.jsx(Xr,{path:"/party/:id",element:a.jsx(JU,{})}),a.jsx(Xr,{path:"/party/join/:inviteCode",element:a.jsx(eH,{})}),a.jsx(Xr,{path:"/notes",element:a.jsx(MF,{})}),a.jsx(Xr,{path:"/settings",element:a.jsx(AU,{})}),a.jsx(Xr,{path:"*",element:a.jsx(Vo,{to:"/",replace:!0})})]})}),a.jsx(LU,{}),a.jsx(oN,{})]})})})]})]})}function rH(){const{showWarning:e,extendSession:t}=K4();return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-amber-100 rounded-full",children:a.jsx(Dh,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Session Timeout Warning"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your session will expire in 30 seconds due to inactivity."})]})]}),a.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ft,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-amber-700",children:'Click "Continue Session" to stay logged in, or your session will end automatically.'})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx(B,{variant:"primary",onClick:t,children:"Continue Session"})})]})}):null}function nH(){return a.jsx(Lj,{children:a.jsx(Z4,{children:a.jsxs(L2,{client:BE,children:[a.jsx(z4,{children:a.jsx(G4,{children:a.jsx(Q4,{children:a.jsx(t6,{children:a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(tH,{}),a.jsx(rH,{})]})})})})}),!1]})})})}w2(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsxs(L2,{client:BE,children:[" ",a.jsx(nH,{})]})}));export{oh as g};
