var k_=Object.defineProperty;var Qg=e=>{throw TypeError(e)};var __=(e,t,r)=>t in e?k_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ic=(e,t,r)=>__(e,typeof t!="symbol"?t+"":t,r),Yh=(e,t,r)=>t.has(e)||Qg("Cannot "+r);var M=(e,t,r)=>(Yh(e,t,"read from private field"),r?r.call(e):t.get(e)),Te=(e,t,r)=>t.has(e)?Qg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),be=(e,t,r,n)=>(Yh(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),He=(e,t,r)=>(Yh(e,t,"access private method"),r);var lc=(e,t,r,n)=>({set _(s){be(e,t,s,r)},get _(){return M(e,t,n)}});function S_(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function T_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var sv={exports:{}},Xd={},av={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hu=Symbol.for("react.element"),C_=Symbol.for("react.portal"),j_=Symbol.for("react.fragment"),A_=Symbol.for("react.strict_mode"),I_=Symbol.for("react.profiler"),R_=Symbol.for("react.provider"),L_=Symbol.for("react.context"),O_=Symbol.for("react.forward_ref"),P_=Symbol.for("react.suspense"),D_=Symbol.for("react.memo"),M_=Symbol.for("react.lazy"),Kg=Symbol.iterator;function F_(e){return e===null||typeof e!="object"?null:(e=Kg&&e[Kg]||e["@@iterator"],typeof e=="function"?e:null)}var iv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lv=Object.assign,ov={};function Ml(e,t,r){this.props=e,this.context=t,this.refs=ov,this.updater=r||iv}Ml.prototype.isReactComponent={};Ml.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ml.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function uv(){}uv.prototype=Ml.prototype;function e0(e,t,r){this.props=e,this.context=t,this.refs=ov,this.updater=r||iv}var t0=e0.prototype=new uv;t0.constructor=e0;lv(t0,Ml.prototype);t0.isPureReactComponent=!0;var Zg=Array.isArray,cv=Object.prototype.hasOwnProperty,r0={current:null},dv={key:!0,ref:!0,__self:!0,__source:!0};function hv(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)cv.call(t,n)&&!dv.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Hu,type:e,key:i,ref:l,props:s,_owner:r0.current}}function U_(e,t){return{$$typeof:Hu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function n0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hu}function B_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Xg=/\/+/g;function Qh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?B_(""+e.key):t.toString(36)}function zc(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Hu:case C_:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+Qh(l,0):n,Zg(s)?(r="",e!=null&&(r=e.replace(Xg,"$&/")+"/"),zc(s,t,r,"",function(c){return c})):s!=null&&(n0(s)&&(s=U_(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Xg,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",Zg(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+Qh(i,o);l+=zc(i,t,r,u,s)}else if(u=F_(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+Qh(i,o++),l+=zc(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function oc(e,t,r){if(e==null)return e;var n=[],s=0;return zc(e,n,"","",function(i){return t.call(r,i,s++)}),n}function H_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Er={current:null},qc={transition:null},$_={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:qc,ReactCurrentOwner:r0};function fv(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:oc,forEach:function(e,t,r){oc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return oc(e,function(){t++}),t},toArray:function(e){return oc(e,function(t){return t})||[]},only:function(e){if(!n0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=Ml;Ye.Fragment=j_;Ye.Profiler=I_;Ye.PureComponent=e0;Ye.StrictMode=A_;Ye.Suspense=P_;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$_;Ye.act=fv;Ye.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=lv({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=r0.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)cv.call(t,u)&&!dv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Hu,type:e.type,key:s,ref:i,props:n,_owner:l}};Ye.createContext=function(e){return e={$$typeof:L_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:R_,_context:e},e.Consumer=e};Ye.createElement=hv;Ye.createFactory=function(e){var t=hv.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:O_,render:e}};Ye.isValidElement=n0;Ye.lazy=function(e){return{$$typeof:M_,_payload:{_status:-1,_result:e},_init:H_}};Ye.memo=function(e,t){return{$$typeof:D_,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=qc.transition;qc.transition={};try{e()}finally{qc.transition=t}};Ye.unstable_act=fv;Ye.useCallback=function(e,t){return Er.current.useCallback(e,t)};Ye.useContext=function(e){return Er.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return Er.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return Er.current.useEffect(e,t)};Ye.useId=function(){return Er.current.useId()};Ye.useImperativeHandle=function(e,t,r){return Er.current.useImperativeHandle(e,t,r)};Ye.useInsertionEffect=function(e,t){return Er.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return Er.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return Er.current.useMemo(e,t)};Ye.useReducer=function(e,t,r){return Er.current.useReducer(e,t,r)};Ye.useRef=function(e){return Er.current.useRef(e)};Ye.useState=function(e){return Er.current.useState(e)};Ye.useSyncExternalStore=function(e,t,r){return Er.current.useSyncExternalStore(e,t,r)};Ye.useTransition=function(){return Er.current.useTransition()};Ye.version="18.3.1";av.exports=Ye;var w=av.exports;const _n=Zd(w),z_=S_({__proto__:null,default:_n},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q_=w,V_=Symbol.for("react.element"),W_=Symbol.for("react.fragment"),G_=Object.prototype.hasOwnProperty,Y_=q_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q_={key:!0,ref:!0,__self:!0,__source:!0};function mv(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)G_.call(t,n)&&!Q_.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:V_,type:e,key:i,ref:l,props:s,_owner:Y_.current}}Xd.Fragment=W_;Xd.jsx=mv;Xd.jsxs=mv;sv.exports=Xd;var a=sv.exports,pv={exports:{}},Qr={},gv={exports:{}},xv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(L,Q){var N=L.length;L.push(Q);e:for(;0<N;){var K=N-1>>>1,Y=L[K];if(0<s(Y,Q))L[K]=Q,L[N]=Y,N=K;else break e}}function r(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var Q=L[0],N=L.pop();if(N!==Q){L[0]=N;e:for(var K=0,Y=L.length,A=Y>>>1;K<A;){var me=2*(K+1)-1,J=L[me],ae=me+1,Z=L[ae];if(0>s(J,N))ae<Y&&0>s(Z,J)?(L[K]=Z,L[ae]=N,K=ae):(L[K]=J,L[me]=N,K=me);else if(ae<Y&&0>s(Z,N))L[K]=Z,L[ae]=N,K=ae;else break e}}return Q}function s(L,Q){var N=L.sortIndex-Q.sortIndex;return N!==0?N:L.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],d=1,h=null,f=3,p=!1,g=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(L){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=L)n(c),Q.sortIndex=Q.expirationTime,t(u,Q);else break;Q=r(c)}}function _(L){if(y=!1,v(L),!g)if(r(u)!==null)g=!0,z(k);else{var Q=r(c);Q!==null&&B(_,Q.startTime-L)}}function k(L,Q){g=!1,y&&(y=!1,x(j),j=-1),p=!0;var N=f;try{for(v(Q),h=r(u);h!==null&&(!(h.expirationTime>Q)||L&&!H());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var Y=K(h.expirationTime<=Q);Q=e.unstable_now(),typeof Y=="function"?h.callback=Y:h===r(u)&&n(u),v(Q)}else n(u);h=r(u)}if(h!==null)var A=!0;else{var me=r(c);me!==null&&B(_,me.startTime-Q),A=!1}return A}finally{h=null,f=N,p=!1}}var S=!1,I=null,j=-1,P=5,T=-1;function H(){return!(e.unstable_now()-T<P)}function O(){if(I!==null){var L=e.unstable_now();T=L;var Q=!0;try{Q=I(!0,L)}finally{Q?q():(S=!1,I=null)}}else S=!1}var q;if(typeof b=="function")q=function(){b(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,$=G.port2;G.port1.onmessage=O,q=function(){$.postMessage(null)}}else q=function(){E(O,0)};function z(L){I=L,S||(S=!0,q())}function B(L,Q){j=E(function(){L(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,z(k))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(L){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var N=f;f=Q;try{return L()}finally{f=N}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,Q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var N=f;f=L;try{return Q()}finally{f=N}},e.unstable_scheduleCallback=function(L,Q,N){var K=e.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?K+N:K):N=K,L){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=N+Y,L={id:d++,callback:Q,priorityLevel:L,startTime:N,expirationTime:Y,sortIndex:-1},N>K?(L.sortIndex=N,t(c,L),r(u)===null&&L===r(c)&&(y?(x(j),j=-1):y=!0,B(_,N-K))):(L.sortIndex=Y,t(u,L),g||p||(g=!0,z(k))),L},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(L){var Q=f;return function(){var N=f;f=Q;try{return L.apply(this,arguments)}finally{f=N}}}})(xv);gv.exports=xv;var K_=gv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_=w,Yr=K_;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yv=new Set,Qo={};function pi(e,t){wl(e,t),wl(e+"Capture",t)}function wl(e,t){for(Qo[e]=t,e=0;e<t.length;e++)yv.add(t[e])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cm=Object.prototype.hasOwnProperty,X_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jg={},ex={};function J_(e){return cm.call(ex,e)?!0:cm.call(Jg,e)?!1:X_.test(e)?ex[e]=!0:(Jg[e]=!0,!1)}function eS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tS(e,t,r,n){if(t===null||typeof t>"u"||eS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Nr(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var nr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nr[e]=new Nr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nr[t]=new Nr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nr[e]=new Nr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nr[e]=new Nr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nr[e]=new Nr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nr[e]=new Nr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nr[e]=new Nr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nr[e]=new Nr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nr[e]=new Nr(e,5,!1,e.toLowerCase(),null,!1,!1)});var s0=/[\-:]([a-z])/g;function a0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(s0,a0);nr[t]=new Nr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(s0,a0);nr[t]=new Nr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(s0,a0);nr[t]=new Nr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nr[e]=new Nr(e,1,!1,e.toLowerCase(),null,!1,!1)});nr.xlinkHref=new Nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nr[e]=new Nr(e,1,!1,e.toLowerCase(),null,!0,!0)});function i0(e,t,r,n){var s=nr.hasOwnProperty(t)?nr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(tS(t,r,s,n)&&(r=null),n||s===null?J_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ws=Z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uc=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Oi=Symbol.for("react.fragment"),l0=Symbol.for("react.strict_mode"),dm=Symbol.for("react.profiler"),bv=Symbol.for("react.provider"),vv=Symbol.for("react.context"),o0=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),fm=Symbol.for("react.suspense_list"),u0=Symbol.for("react.memo"),Fs=Symbol.for("react.lazy"),wv=Symbol.for("react.offscreen"),tx=Symbol.iterator;function Xl(e){return e===null||typeof e!="object"?null:(e=tx&&e[tx]||e["@@iterator"],typeof e=="function"?e:null)}var St=Object.assign,Kh;function go(e){if(Kh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Kh=t&&t[1]||""}return`
`+Kh+e}var Zh=!1;function Xh(e,t){if(!e||Zh)return"";Zh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{Zh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?go(e):""}function rS(e){switch(e.tag){case 5:return go(e.type);case 16:return go("Lazy");case 13:return go("Suspense");case 19:return go("SuspenseList");case 0:case 2:case 15:return e=Xh(e.type,!1),e;case 11:return e=Xh(e.type.render,!1),e;case 1:return e=Xh(e.type,!0),e;default:return""}}function mm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Oi:return"Fragment";case Li:return"Portal";case dm:return"Profiler";case l0:return"StrictMode";case hm:return"Suspense";case fm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vv:return(e.displayName||"Context")+".Consumer";case bv:return(e._context.displayName||"Context")+".Provider";case o0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case u0:return t=e.displayName||null,t!==null?t:mm(e.type)||"Memo";case Fs:t=e._payload,e=e._init;try{return mm(e(t))}catch{}}return null}function nS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mm(t);case 8:return t===l0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function pa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ev(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sS(e){var t=Ev(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cc(e){e._valueTracker||(e._valueTracker=sS(e))}function Nv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Ev(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ld(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pm(e,t){var r=t.checked;return St({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=pa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kv(e,t){t=t.checked,t!=null&&i0(e,"checked",t,!1)}function gm(e,t){kv(e,t);var r=pa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xm(e,t.type,r):t.hasOwnProperty("defaultValue")&&xm(e,t.type,pa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nx(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xm(e,t,r){(t!=="number"||ld(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var xo=Array.isArray;function Gi(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+pa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function ym(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return St({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(oe(92));if(xo(r)){if(1<r.length)throw Error(oe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:pa(r)}}function _v(e,t){var r=pa(t.value),n=pa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ax(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dc,Tv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(dc=dc||document.createElement("div"),dc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=dc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ko(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var So={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aS=["Webkit","ms","Moz","O"];Object.keys(So).forEach(function(e){aS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),So[t]=So[e]})});function Cv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||So.hasOwnProperty(e)&&So[e]?(""+t).trim():t+"px"}function jv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Cv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var iS=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vm(e,t){if(t){if(iS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function wm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Em=null;function c0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nm=null,Yi=null,Qi=null;function ix(e){if(e=qu(e)){if(typeof Nm!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=nh(t),Nm(e.stateNode,e.type,t))}}function Av(e){Yi?Qi?Qi.push(e):Qi=[e]:Yi=e}function Iv(){if(Yi){var e=Yi,t=Qi;if(Qi=Yi=null,ix(e),t)for(e=0;e<t.length;e++)ix(t[e])}}function Rv(e,t){return e(t)}function Lv(){}var Jh=!1;function Ov(e,t,r){if(Jh)return e(t,r);Jh=!0;try{return Rv(e,t,r)}finally{Jh=!1,(Yi!==null||Qi!==null)&&(Lv(),Iv())}}function Zo(e,t){var r=e.stateNode;if(r===null)return null;var n=nh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(oe(231,t,typeof r));return r}var km=!1;if(ps)try{var Jl={};Object.defineProperty(Jl,"passive",{get:function(){km=!0}}),window.addEventListener("test",Jl,Jl),window.removeEventListener("test",Jl,Jl)}catch{km=!1}function lS(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var To=!1,od=null,ud=!1,_m=null,oS={onError:function(e){To=!0,od=e}};function uS(e,t,r,n,s,i,l,o,u){To=!1,od=null,lS.apply(oS,arguments)}function cS(e,t,r,n,s,i,l,o,u){if(uS.apply(this,arguments),To){if(To){var c=od;To=!1,od=null}else throw Error(oe(198));ud||(ud=!0,_m=c)}}function gi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Pv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function lx(e){if(gi(e)!==e)throw Error(oe(188))}function dS(e){var t=e.alternate;if(!t){if(t=gi(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return lx(s),e;if(i===n)return lx(s),t;i=i.sibling}throw Error(oe(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(oe(189))}}if(r.alternate!==n)throw Error(oe(190))}if(r.tag!==3)throw Error(oe(188));return r.stateNode.current===r?e:t}function Dv(e){return e=dS(e),e!==null?Mv(e):null}function Mv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Mv(e);if(t!==null)return t;e=e.sibling}return null}var Fv=Yr.unstable_scheduleCallback,ox=Yr.unstable_cancelCallback,hS=Yr.unstable_shouldYield,fS=Yr.unstable_requestPaint,Lt=Yr.unstable_now,mS=Yr.unstable_getCurrentPriorityLevel,d0=Yr.unstable_ImmediatePriority,Uv=Yr.unstable_UserBlockingPriority,cd=Yr.unstable_NormalPriority,pS=Yr.unstable_LowPriority,Bv=Yr.unstable_IdlePriority,Jd=null,qn=null;function gS(e){if(qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot(Jd,e,void 0,(e.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:bS,xS=Math.log,yS=Math.LN2;function bS(e){return e>>>=0,e===0?32:31-(xS(e)/yS|0)|0}var hc=64,fc=4194304;function yo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=yo(o):(i&=l,i!==0&&(n=yo(i)))}else l=r&~s,l!==0?n=yo(l):i!==0&&(n=yo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Sn(t),s=1<<r,n|=e[r],t&=~s;return n}function vS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Sn(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=vS(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function Sm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Hv(){var e=hc;return hc<<=1,!(hc&4194240)&&(hc=64),e}function ef(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $u(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Sn(t),e[t]=r}function ES(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Sn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function h0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Sn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var lt=0;function $v(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zv,f0,qv,Vv,Wv,Tm=!1,mc=[],ia=null,la=null,oa=null,Xo=new Map,Jo=new Map,$s=[],NS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ux(e,t){switch(e){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":Xo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jo.delete(t.pointerId)}}function eo(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=qu(t),t!==null&&f0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function kS(e,t,r,n,s){switch(t){case"focusin":return ia=eo(ia,e,t,r,n,s),!0;case"dragenter":return la=eo(la,e,t,r,n,s),!0;case"mouseover":return oa=eo(oa,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Xo.set(i,eo(Xo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Jo.set(i,eo(Jo.get(i)||null,e,t,r,n,s)),!0}return!1}function Gv(e){var t=Ba(e.target);if(t!==null){var r=gi(t);if(r!==null){if(t=r.tag,t===13){if(t=Pv(r),t!==null){e.blockedOn=t,Wv(e.priority,function(){qv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Cm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Em=n,r.target.dispatchEvent(n),Em=null}else return t=qu(r),t!==null&&f0(t),e.blockedOn=r,!1;t.shift()}return!0}function cx(e,t,r){Vc(e)&&r.delete(t)}function _S(){Tm=!1,ia!==null&&Vc(ia)&&(ia=null),la!==null&&Vc(la)&&(la=null),oa!==null&&Vc(oa)&&(oa=null),Xo.forEach(cx),Jo.forEach(cx)}function to(e,t){e.blockedOn===t&&(e.blockedOn=null,Tm||(Tm=!0,Yr.unstable_scheduleCallback(Yr.unstable_NormalPriority,_S)))}function eu(e){function t(s){return to(s,e)}if(0<mc.length){to(mc[0],e);for(var r=1;r<mc.length;r++){var n=mc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ia!==null&&to(ia,e),la!==null&&to(la,e),oa!==null&&to(oa,e),Xo.forEach(t),Jo.forEach(t),r=0;r<$s.length;r++)n=$s[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<$s.length&&(r=$s[0],r.blockedOn===null);)Gv(r),r.blockedOn===null&&$s.shift()}var Ki=ws.ReactCurrentBatchConfig,hd=!0;function SS(e,t,r,n){var s=lt,i=Ki.transition;Ki.transition=null;try{lt=1,m0(e,t,r,n)}finally{lt=s,Ki.transition=i}}function TS(e,t,r,n){var s=lt,i=Ki.transition;Ki.transition=null;try{lt=4,m0(e,t,r,n)}finally{lt=s,Ki.transition=i}}function m0(e,t,r,n){if(hd){var s=Cm(e,t,r,n);if(s===null)df(e,t,n,fd,r),ux(e,n);else if(kS(s,e,t,r,n))n.stopPropagation();else if(ux(e,n),t&4&&-1<NS.indexOf(e)){for(;s!==null;){var i=qu(s);if(i!==null&&zv(i),i=Cm(e,t,r,n),i===null&&df(e,t,n,fd,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else df(e,t,n,null,r)}}var fd=null;function Cm(e,t,r,n){if(fd=null,e=c0(n),e=Ba(e),e!==null)if(t=gi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Pv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return fd=e,null}function Yv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mS()){case d0:return 1;case Uv:return 4;case cd:case pS:return 16;case Bv:return 536870912;default:return 16}default:return 16}}var ra=null,p0=null,Wc=null;function Qv(){if(Wc)return Wc;var e,t=p0,r=t.length,n,s="value"in ra?ra.value:ra.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return Wc=s.slice(e,1<n?1-n:void 0)}function Gc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pc(){return!0}function dx(){return!1}function Kr(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?pc:dx,this.isPropagationStopped=dx,this}return St(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=pc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=pc)},persist:function(){},isPersistent:pc}),t}var Fl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},g0=Kr(Fl),zu=St({},Fl,{view:0,detail:0}),CS=Kr(zu),tf,rf,ro,eh=St({},zu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:x0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ro&&(ro&&e.type==="mousemove"?(tf=e.screenX-ro.screenX,rf=e.screenY-ro.screenY):rf=tf=0,ro=e),tf)},movementY:function(e){return"movementY"in e?e.movementY:rf}}),hx=Kr(eh),jS=St({},eh,{dataTransfer:0}),AS=Kr(jS),IS=St({},zu,{relatedTarget:0}),nf=Kr(IS),RS=St({},Fl,{animationName:0,elapsedTime:0,pseudoElement:0}),LS=Kr(RS),OS=St({},Fl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),PS=Kr(OS),DS=St({},Fl,{data:0}),fx=Kr(DS),MS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},US={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=US[e])?!!t[e]:!1}function x0(){return BS}var HS=St({},zu,{key:function(e){if(e.key){var t=MS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Gc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?FS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:x0,charCode:function(e){return e.type==="keypress"?Gc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Gc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$S=Kr(HS),zS=St({},eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mx=Kr(zS),qS=St({},zu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:x0}),VS=Kr(qS),WS=St({},Fl,{propertyName:0,elapsedTime:0,pseudoElement:0}),GS=Kr(WS),YS=St({},eh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),QS=Kr(YS),KS=[9,13,27,32],y0=ps&&"CompositionEvent"in window,Co=null;ps&&"documentMode"in document&&(Co=document.documentMode);var ZS=ps&&"TextEvent"in window&&!Co,Kv=ps&&(!y0||Co&&8<Co&&11>=Co),px=" ",gx=!1;function Zv(e,t){switch(e){case"keyup":return KS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pi=!1;function XS(e,t){switch(e){case"compositionend":return Xv(t);case"keypress":return t.which!==32?null:(gx=!0,px);case"textInput":return e=t.data,e===px&&gx?null:e;default:return null}}function JS(e,t){if(Pi)return e==="compositionend"||!y0&&Zv(e,t)?(e=Qv(),Wc=p0=ra=null,Pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Kv&&t.locale!=="ko"?null:t.data;default:return null}}var eT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!eT[e.type]:t==="textarea"}function Jv(e,t,r,n){Av(n),t=md(t,"onChange"),0<t.length&&(r=new g0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var jo=null,tu=null;function tT(e){cw(e,0)}function th(e){var t=Fi(e);if(Nv(t))return e}function rT(e,t){if(e==="change")return t}var ew=!1;if(ps){var sf;if(ps){var af="oninput"in document;if(!af){var yx=document.createElement("div");yx.setAttribute("oninput","return;"),af=typeof yx.oninput=="function"}sf=af}else sf=!1;ew=sf&&(!document.documentMode||9<document.documentMode)}function bx(){jo&&(jo.detachEvent("onpropertychange",tw),tu=jo=null)}function tw(e){if(e.propertyName==="value"&&th(tu)){var t=[];Jv(t,tu,e,c0(e)),Ov(tT,t)}}function nT(e,t,r){e==="focusin"?(bx(),jo=t,tu=r,jo.attachEvent("onpropertychange",tw)):e==="focusout"&&bx()}function sT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return th(tu)}function aT(e,t){if(e==="click")return th(t)}function iT(e,t){if(e==="input"||e==="change")return th(t)}function lT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:lT;function ru(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!cm.call(t,s)||!In(e[s],t[s]))return!1}return!0}function vx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wx(e,t){var r=vx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=vx(r)}}function rw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nw(){for(var e=window,t=ld();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ld(e.document)}return t}function b0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function oT(e){var t=nw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rw(r.ownerDocument.documentElement,r)){if(n!==null&&b0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=wx(r,i);var l=wx(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var uT=ps&&"documentMode"in document&&11>=document.documentMode,Di=null,jm=null,Ao=null,Am=!1;function Ex(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Am||Di==null||Di!==ld(n)||(n=Di,"selectionStart"in n&&b0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ao&&ru(Ao,n)||(Ao=n,n=md(jm,"onSelect"),0<n.length&&(t=new g0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Di)))}function gc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Mi={animationend:gc("Animation","AnimationEnd"),animationiteration:gc("Animation","AnimationIteration"),animationstart:gc("Animation","AnimationStart"),transitionend:gc("Transition","TransitionEnd")},lf={},sw={};ps&&(sw=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function rh(e){if(lf[e])return lf[e];if(!Mi[e])return e;var t=Mi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in sw)return lf[e]=t[r];return e}var aw=rh("animationend"),iw=rh("animationiteration"),lw=rh("animationstart"),ow=rh("transitionend"),uw=new Map,Nx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ea(e,t){uw.set(e,t),pi(t,[e])}for(var of=0;of<Nx.length;of++){var uf=Nx[of],cT=uf.toLowerCase(),dT=uf[0].toUpperCase()+uf.slice(1);Ea(cT,"on"+dT)}Ea(aw,"onAnimationEnd");Ea(iw,"onAnimationIteration");Ea(lw,"onAnimationStart");Ea("dblclick","onDoubleClick");Ea("focusin","onFocus");Ea("focusout","onBlur");Ea(ow,"onTransitionEnd");wl("onMouseEnter",["mouseout","mouseover"]);wl("onMouseLeave",["mouseout","mouseover"]);wl("onPointerEnter",["pointerout","pointerover"]);wl("onPointerLeave",["pointerout","pointerover"]);pi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pi("onBeforeInput",["compositionend","keypress","textInput","paste"]);pi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hT=new Set("cancel close invalid load scroll toggle".split(" ").concat(bo));function kx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,cS(n,t,void 0,e),e.currentTarget=null}function cw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;kx(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;kx(s,o,c),i=u}}}if(ud)throw e=_m,ud=!1,_m=null,e}function yt(e,t){var r=t[Pm];r===void 0&&(r=t[Pm]=new Set);var n=e+"__bubble";r.has(n)||(dw(t,e,2,!1),r.add(n))}function cf(e,t,r){var n=0;t&&(n|=4),dw(r,e,n,t)}var xc="_reactListening"+Math.random().toString(36).slice(2);function nu(e){if(!e[xc]){e[xc]=!0,yv.forEach(function(r){r!=="selectionchange"&&(hT.has(r)||cf(r,!1,e),cf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xc]||(t[xc]=!0,cf("selectionchange",!1,t))}}function dw(e,t,r,n){switch(Yv(t)){case 1:var s=SS;break;case 4:s=TS;break;default:s=m0}r=s.bind(null,t,r,e),s=void 0,!km||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function df(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=Ba(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}Ov(function(){var c=i,d=c0(r),h=[];e:{var f=uw.get(e);if(f!==void 0){var p=g0,g=e;switch(e){case"keypress":if(Gc(r)===0)break e;case"keydown":case"keyup":p=$S;break;case"focusin":g="focus",p=nf;break;case"focusout":g="blur",p=nf;break;case"beforeblur":case"afterblur":p=nf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=hx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=AS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=VS;break;case aw:case iw:case lw:p=LS;break;case ow:p=GS;break;case"scroll":p=CS;break;case"wheel":p=QS;break;case"copy":case"cut":case"paste":p=PS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=mx}var y=(t&4)!==0,E=!y&&e==="scroll",x=y?f!==null?f+"Capture":null:f;y=[];for(var b=c,v;b!==null;){v=b;var _=v.stateNode;if(v.tag===5&&_!==null&&(v=_,x!==null&&(_=Zo(b,x),_!=null&&y.push(su(b,_,v)))),E)break;b=b.return}0<y.length&&(f=new p(f,g,null,r,d),h.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==Em&&(g=r.relatedTarget||r.fromElement)&&(Ba(g)||g[gs]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?Ba(g):null,g!==null&&(E=gi(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(y=hx,_="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(y=mx,_="onPointerLeave",x="onPointerEnter",b="pointer"),E=p==null?f:Fi(p),v=g==null?f:Fi(g),f=new y(_,b+"leave",p,r,d),f.target=E,f.relatedTarget=v,_=null,Ba(d)===c&&(y=new y(x,b+"enter",g,r,d),y.target=v,y.relatedTarget=E,_=y),E=_,p&&g)t:{for(y=p,x=g,b=0,v=y;v;v=Ni(v))b++;for(v=0,_=x;_;_=Ni(_))v++;for(;0<b-v;)y=Ni(y),b--;for(;0<v-b;)x=Ni(x),v--;for(;b--;){if(y===x||x!==null&&y===x.alternate)break t;y=Ni(y),x=Ni(x)}y=null}else y=null;p!==null&&_x(h,f,p,y,!1),g!==null&&E!==null&&_x(h,E,g,y,!0)}}e:{if(f=c?Fi(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=rT;else if(xx(f))if(ew)k=iT;else{k=sT;var S=nT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=aT);if(k&&(k=k(e,c))){Jv(h,k,r,d);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&xm(f,"number",f.value)}switch(S=c?Fi(c):window,e){case"focusin":(xx(S)||S.contentEditable==="true")&&(Di=S,jm=c,Ao=null);break;case"focusout":Ao=jm=Di=null;break;case"mousedown":Am=!0;break;case"contextmenu":case"mouseup":case"dragend":Am=!1,Ex(h,r,d);break;case"selectionchange":if(uT)break;case"keydown":case"keyup":Ex(h,r,d)}var I;if(y0)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Pi?Zv(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(Kv&&r.locale!=="ko"&&(Pi||j!=="onCompositionStart"?j==="onCompositionEnd"&&Pi&&(I=Qv()):(ra=d,p0="value"in ra?ra.value:ra.textContent,Pi=!0)),S=md(c,j),0<S.length&&(j=new fx(j,e,null,r,d),h.push({event:j,listeners:S}),I?j.data=I:(I=Xv(r),I!==null&&(j.data=I)))),(I=ZS?XS(e,r):JS(e,r))&&(c=md(c,"onBeforeInput"),0<c.length&&(d=new fx("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=I))}cw(h,t)})}function su(e,t,r){return{instance:e,listener:t,currentTarget:r}}function md(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Zo(e,r),i!=null&&n.unshift(su(e,i,s)),i=Zo(e,t),i!=null&&n.push(su(e,i,s))),e=e.return}return n}function Ni(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _x(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=Zo(r,i),u!=null&&l.unshift(su(r,u,o))):s||(u=Zo(r,i),u!=null&&l.push(su(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var fT=/\r\n?/g,mT=/\u0000|\uFFFD/g;function Sx(e){return(typeof e=="string"?e:""+e).replace(fT,`
`).replace(mT,"")}function yc(e,t,r){if(t=Sx(t),Sx(e)!==t&&r)throw Error(oe(425))}function pd(){}var Im=null,Rm=null;function Lm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Om=typeof setTimeout=="function"?setTimeout:void 0,pT=typeof clearTimeout=="function"?clearTimeout:void 0,Tx=typeof Promise=="function"?Promise:void 0,gT=typeof queueMicrotask=="function"?queueMicrotask:typeof Tx<"u"?function(e){return Tx.resolve(null).then(e).catch(xT)}:Om;function xT(e){setTimeout(function(){throw e})}function hf(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),eu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);eu(t)}function ua(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Cx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ul=Math.random().toString(36).slice(2),zn="__reactFiber$"+Ul,au="__reactProps$"+Ul,gs="__reactContainer$"+Ul,Pm="__reactEvents$"+Ul,yT="__reactListeners$"+Ul,bT="__reactHandles$"+Ul;function Ba(e){var t=e[zn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[gs]||r[zn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Cx(e);e!==null;){if(r=e[zn])return r;e=Cx(e)}return t}e=r,r=e.parentNode}return null}function qu(e){return e=e[zn]||e[gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function nh(e){return e[au]||null}var Dm=[],Ui=-1;function Na(e){return{current:e}}function bt(e){0>Ui||(e.current=Dm[Ui],Dm[Ui]=null,Ui--)}function mt(e,t){Ui++,Dm[Ui]=e.current,e.current=t}var ga={},dr=Na(ga),Lr=Na(!1),ri=ga;function El(e,t){var r=e.type.contextTypes;if(!r)return ga;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Or(e){return e=e.childContextTypes,e!=null}function gd(){bt(Lr),bt(dr)}function jx(e,t,r){if(dr.current!==ga)throw Error(oe(168));mt(dr,t),mt(Lr,r)}function hw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(oe(108,nS(e)||"Unknown",s));return St({},r,n)}function xd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ga,ri=dr.current,mt(dr,e),mt(Lr,Lr.current),!0}function Ax(e,t,r){var n=e.stateNode;if(!n)throw Error(oe(169));r?(e=hw(e,t,ri),n.__reactInternalMemoizedMergedChildContext=e,bt(Lr),bt(dr),mt(dr,e)):bt(Lr),mt(Lr,r)}var is=null,sh=!1,ff=!1;function fw(e){is===null?is=[e]:is.push(e)}function vT(e){sh=!0,fw(e)}function ka(){if(!ff&&is!==null){ff=!0;var e=0,t=lt;try{var r=is;for(lt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}is=null,sh=!1}catch(s){throw is!==null&&(is=is.slice(e+1)),Fv(d0,ka),s}finally{lt=t,ff=!1}}return null}var Bi=[],Hi=0,yd=null,bd=0,nn=[],sn=0,ni=null,ds=1,hs="";function Oa(e,t){Bi[Hi++]=bd,Bi[Hi++]=yd,yd=e,bd=t}function mw(e,t,r){nn[sn++]=ds,nn[sn++]=hs,nn[sn++]=ni,ni=e;var n=ds;e=hs;var s=32-Sn(n)-1;n&=~(1<<s),r+=1;var i=32-Sn(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,ds=1<<32-Sn(t)+s|r<<s|n,hs=i+e}else ds=1<<i|r<<s|n,hs=e}function v0(e){e.return!==null&&(Oa(e,1),mw(e,1,0))}function w0(e){for(;e===yd;)yd=Bi[--Hi],Bi[Hi]=null,bd=Bi[--Hi],Bi[Hi]=null;for(;e===ni;)ni=nn[--sn],nn[sn]=null,hs=nn[--sn],nn[sn]=null,ds=nn[--sn],nn[sn]=null}var Vr=null,qr=null,Et=!1,En=null;function pw(e,t){var r=on(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Ix(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Vr=e,qr=ua(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Vr=e,qr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ni!==null?{id:ds,overflow:hs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=on(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Vr=e,qr=null,!0):!1;default:return!1}}function Mm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Fm(e){if(Et){var t=qr;if(t){var r=t;if(!Ix(e,t)){if(Mm(e))throw Error(oe(418));t=ua(r.nextSibling);var n=Vr;t&&Ix(e,t)?pw(n,r):(e.flags=e.flags&-4097|2,Et=!1,Vr=e)}}else{if(Mm(e))throw Error(oe(418));e.flags=e.flags&-4097|2,Et=!1,Vr=e}}}function Rx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vr=e}function bc(e){if(e!==Vr)return!1;if(!Et)return Rx(e),Et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Lm(e.type,e.memoizedProps)),t&&(t=qr)){if(Mm(e))throw gw(),Error(oe(418));for(;t;)pw(e,t),t=ua(t.nextSibling)}if(Rx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){qr=ua(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}qr=null}}else qr=Vr?ua(e.stateNode.nextSibling):null;return!0}function gw(){for(var e=qr;e;)e=ua(e.nextSibling)}function Nl(){qr=Vr=null,Et=!1}function E0(e){En===null?En=[e]:En.push(e)}var wT=ws.ReactCurrentBatchConfig;function no(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(oe(309));var n=r.stateNode}if(!n)throw Error(oe(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(oe(284));if(!r._owner)throw Error(oe(290,e))}return e}function vc(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Lx(e){var t=e._init;return t(e._payload)}function xw(e){function t(x,b){if(e){var v=x.deletions;v===null?(x.deletions=[b],x.flags|=16):v.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=fa(x,b),x.index=0,x.sibling=null,x}function i(x,b,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<b?(x.flags|=2,b):v):(x.flags|=2,b)):(x.flags|=1048576,b)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,b,v,_){return b===null||b.tag!==6?(b=vf(v,x.mode,_),b.return=x,b):(b=s(b,v),b.return=x,b)}function u(x,b,v,_){var k=v.type;return k===Oi?d(x,b,v.props.children,_,v.key):b!==null&&(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Fs&&Lx(k)===b.type)?(_=s(b,v.props),_.ref=no(x,b,v),_.return=x,_):(_=ed(v.type,v.key,v.props,null,x.mode,_),_.ref=no(x,b,v),_.return=x,_)}function c(x,b,v,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=wf(v,x.mode,_),b.return=x,b):(b=s(b,v.children||[]),b.return=x,b)}function d(x,b,v,_,k){return b===null||b.tag!==7?(b=Ja(v,x.mode,_,k),b.return=x,b):(b=s(b,v),b.return=x,b)}function h(x,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=vf(""+b,x.mode,v),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case uc:return v=ed(b.type,b.key,b.props,null,x.mode,v),v.ref=no(x,null,b),v.return=x,v;case Li:return b=wf(b,x.mode,v),b.return=x,b;case Fs:var _=b._init;return h(x,_(b._payload),v)}if(xo(b)||Xl(b))return b=Ja(b,x.mode,v,null),b.return=x,b;vc(x,b)}return null}function f(x,b,v,_){var k=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:o(x,b,""+v,_);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case uc:return v.key===k?u(x,b,v,_):null;case Li:return v.key===k?c(x,b,v,_):null;case Fs:return k=v._init,f(x,b,k(v._payload),_)}if(xo(v)||Xl(v))return k!==null?null:d(x,b,v,_,null);vc(x,v)}return null}function p(x,b,v,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(v)||null,o(b,x,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case uc:return x=x.get(_.key===null?v:_.key)||null,u(b,x,_,k);case Li:return x=x.get(_.key===null?v:_.key)||null,c(b,x,_,k);case Fs:var S=_._init;return p(x,b,v,S(_._payload),k)}if(xo(_)||Xl(_))return x=x.get(v)||null,d(b,x,_,k,null);vc(b,_)}return null}function g(x,b,v,_){for(var k=null,S=null,I=b,j=b=0,P=null;I!==null&&j<v.length;j++){I.index>j?(P=I,I=null):P=I.sibling;var T=f(x,I,v[j],_);if(T===null){I===null&&(I=P);break}e&&I&&T.alternate===null&&t(x,I),b=i(T,b,j),S===null?k=T:S.sibling=T,S=T,I=P}if(j===v.length)return r(x,I),Et&&Oa(x,j),k;if(I===null){for(;j<v.length;j++)I=h(x,v[j],_),I!==null&&(b=i(I,b,j),S===null?k=I:S.sibling=I,S=I);return Et&&Oa(x,j),k}for(I=n(x,I);j<v.length;j++)P=p(I,x,j,v[j],_),P!==null&&(e&&P.alternate!==null&&I.delete(P.key===null?j:P.key),b=i(P,b,j),S===null?k=P:S.sibling=P,S=P);return e&&I.forEach(function(H){return t(x,H)}),Et&&Oa(x,j),k}function y(x,b,v,_){var k=Xl(v);if(typeof k!="function")throw Error(oe(150));if(v=k.call(v),v==null)throw Error(oe(151));for(var S=k=null,I=b,j=b=0,P=null,T=v.next();I!==null&&!T.done;j++,T=v.next()){I.index>j?(P=I,I=null):P=I.sibling;var H=f(x,I,T.value,_);if(H===null){I===null&&(I=P);break}e&&I&&H.alternate===null&&t(x,I),b=i(H,b,j),S===null?k=H:S.sibling=H,S=H,I=P}if(T.done)return r(x,I),Et&&Oa(x,j),k;if(I===null){for(;!T.done;j++,T=v.next())T=h(x,T.value,_),T!==null&&(b=i(T,b,j),S===null?k=T:S.sibling=T,S=T);return Et&&Oa(x,j),k}for(I=n(x,I);!T.done;j++,T=v.next())T=p(I,x,j,T.value,_),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?j:T.key),b=i(T,b,j),S===null?k=T:S.sibling=T,S=T);return e&&I.forEach(function(O){return t(x,O)}),Et&&Oa(x,j),k}function E(x,b,v,_){if(typeof v=="object"&&v!==null&&v.type===Oi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case uc:e:{for(var k=v.key,S=b;S!==null;){if(S.key===k){if(k=v.type,k===Oi){if(S.tag===7){r(x,S.sibling),b=s(S,v.props.children),b.return=x,x=b;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Fs&&Lx(k)===S.type){r(x,S.sibling),b=s(S,v.props),b.ref=no(x,S,v),b.return=x,x=b;break e}r(x,S);break}else t(x,S);S=S.sibling}v.type===Oi?(b=Ja(v.props.children,x.mode,_,v.key),b.return=x,x=b):(_=ed(v.type,v.key,v.props,null,x.mode,_),_.ref=no(x,b,v),_.return=x,x=_)}return l(x);case Li:e:{for(S=v.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){r(x,b.sibling),b=s(b,v.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=wf(v,x.mode,_),b.return=x,x=b}return l(x);case Fs:return S=v._init,E(x,b,S(v._payload),_)}if(xo(v))return g(x,b,v,_);if(Xl(v))return y(x,b,v,_);vc(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,v),b.return=x,x=b):(r(x,b),b=vf(v,x.mode,_),b.return=x,x=b),l(x)):r(x,b)}return E}var kl=xw(!0),yw=xw(!1),vd=Na(null),wd=null,$i=null,N0=null;function k0(){N0=$i=wd=null}function _0(e){var t=vd.current;bt(vd),e._currentValue=t}function Um(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Zi(e,t){wd=e,N0=$i=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Rr=!0),e.firstContext=null)}function cn(e){var t=e._currentValue;if(N0!==e)if(e={context:e,memoizedValue:t,next:null},$i===null){if(wd===null)throw Error(oe(308));$i=e,wd.dependencies={lanes:0,firstContext:e}}else $i=$i.next=e;return t}var Ha=null;function S0(e){Ha===null?Ha=[e]:Ha.push(e)}function bw(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,S0(t)):(r.next=s.next,s.next=r),t.interleaved=r,xs(e,n)}function xs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Us=!1;function T0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ca(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rt&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,xs(e,r)}return s=n.interleaved,s===null?(t.next=t,S0(n)):(t.next=s.next,s.next=t),n.interleaved=t,xs(e,r)}function Yc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,h0(e,r)}}function Ox(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ed(e,t,r,n){var s=e.updateQueue;Us=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;l=0,d=c=u=null,o=i;do{var f=o.lane,p=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,y=o;switch(f=t,p=r,y.tag){case 1:if(g=y.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=St({},h,f);break e;case 2:Us=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=p,u=h):d=d.next=p,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ai|=l,e.lanes=l,e.memoizedState=h}}function Px(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(oe(191,s));s.call(n)}}}var Vu={},Vn=Na(Vu),iu=Na(Vu),lu=Na(Vu);function $a(e){if(e===Vu)throw Error(oe(174));return e}function C0(e,t){switch(mt(lu,t),mt(iu,e),mt(Vn,Vu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bm(t,e)}bt(Vn),mt(Vn,t)}function _l(){bt(Vn),bt(iu),bt(lu)}function ww(e){$a(lu.current);var t=$a(Vn.current),r=bm(t,e.type);t!==r&&(mt(iu,e),mt(Vn,r))}function j0(e){iu.current===e&&(bt(Vn),bt(iu))}var kt=Na(0);function Nd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var mf=[];function A0(){for(var e=0;e<mf.length;e++)mf[e]._workInProgressVersionPrimary=null;mf.length=0}var Qc=ws.ReactCurrentDispatcher,pf=ws.ReactCurrentBatchConfig,si=0,_t=null,Ht=null,Kt=null,kd=!1,Io=!1,ou=0,ET=0;function sr(){throw Error(oe(321))}function I0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!In(e[r],t[r]))return!1;return!0}function R0(e,t,r,n,s,i){if(si=i,_t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qc.current=e===null||e.memoizedState===null?ST:TT,e=r(n,s),Io){i=0;do{if(Io=!1,ou=0,25<=i)throw Error(oe(301));i+=1,Kt=Ht=null,t.updateQueue=null,Qc.current=CT,e=r(n,s)}while(Io)}if(Qc.current=_d,t=Ht!==null&&Ht.next!==null,si=0,Kt=Ht=_t=null,kd=!1,t)throw Error(oe(300));return e}function L0(){var e=ou!==0;return ou=0,e}function Dn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?_t.memoizedState=Kt=e:Kt=Kt.next=e,Kt}function dn(){if(Ht===null){var e=_t.alternate;e=e!==null?e.memoizedState:null}else e=Ht.next;var t=Kt===null?_t.memoizedState:Kt.next;if(t!==null)Kt=t,Ht=e;else{if(e===null)throw Error(oe(310));Ht=e,e={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Kt===null?_t.memoizedState=Kt=e:Kt=Kt.next=e}return Kt}function uu(e,t){return typeof t=="function"?t(e):t}function gf(e){var t=dn(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=Ht,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var d=c.lane;if((si&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,l=n):u=u.next=h,_t.lanes|=d,ai|=d}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,In(n,t.memoizedState)||(Rr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,_t.lanes|=i,ai|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xf(e){var t=dn(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);In(i,t.memoizedState)||(Rr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Ew(){}function Nw(e,t){var r=_t,n=dn(),s=t(),i=!In(n.memoizedState,s);if(i&&(n.memoizedState=s,Rr=!0),n=n.queue,O0(Sw.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Kt!==null&&Kt.memoizedState.tag&1){if(r.flags|=2048,cu(9,_w.bind(null,r,n,s,t),void 0,null),Xt===null)throw Error(oe(349));si&30||kw(r,t,s)}return s}function kw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _w(e,t,r,n){t.value=r,t.getSnapshot=n,Tw(t)&&Cw(e)}function Sw(e,t,r){return r(function(){Tw(t)&&Cw(e)})}function Tw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!In(e,r)}catch{return!0}}function Cw(e){var t=xs(e,1);t!==null&&Tn(t,e,1,-1)}function Dx(e){var t=Dn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uu,lastRenderedState:e},t.queue=e,e=e.dispatch=_T.bind(null,_t,e),[t.memoizedState,e]}function cu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function jw(){return dn().memoizedState}function Kc(e,t,r,n){var s=Dn();_t.flags|=e,s.memoizedState=cu(1|t,r,void 0,n===void 0?null:n)}function ah(e,t,r,n){var s=dn();n=n===void 0?null:n;var i=void 0;if(Ht!==null){var l=Ht.memoizedState;if(i=l.destroy,n!==null&&I0(n,l.deps)){s.memoizedState=cu(t,r,i,n);return}}_t.flags|=e,s.memoizedState=cu(1|t,r,i,n)}function Mx(e,t){return Kc(8390656,8,e,t)}function O0(e,t){return ah(2048,8,e,t)}function Aw(e,t){return ah(4,2,e,t)}function Iw(e,t){return ah(4,4,e,t)}function Rw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Lw(e,t,r){return r=r!=null?r.concat([e]):null,ah(4,4,Rw.bind(null,t,e),r)}function P0(){}function Ow(e,t){var r=dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&I0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Pw(e,t){var r=dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&I0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Dw(e,t,r){return si&21?(In(r,t)||(r=Hv(),_t.lanes|=r,ai|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Rr=!0),e.memoizedState=r)}function NT(e,t){var r=lt;lt=r!==0&&4>r?r:4,e(!0);var n=pf.transition;pf.transition={};try{e(!1),t()}finally{lt=r,pf.transition=n}}function Mw(){return dn().memoizedState}function kT(e,t,r){var n=ha(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Fw(e))Uw(t,r);else if(r=bw(e,t,r,n),r!==null){var s=vr();Tn(r,e,n,s),Bw(r,t,n)}}function _T(e,t,r){var n=ha(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Fw(e))Uw(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,In(o,l)){var u=t.interleaved;u===null?(s.next=s,S0(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=bw(e,t,s,n),r!==null&&(s=vr(),Tn(r,e,n,s),Bw(r,t,n))}}function Fw(e){var t=e.alternate;return e===_t||t!==null&&t===_t}function Uw(e,t){Io=kd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Bw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,h0(e,r)}}var _d={readContext:cn,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useInsertionEffect:sr,useLayoutEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useMutableSource:sr,useSyncExternalStore:sr,useId:sr,unstable_isNewReconciler:!1},ST={readContext:cn,useCallback:function(e,t){return Dn().memoizedState=[e,t===void 0?null:t],e},useContext:cn,useEffect:Mx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Kc(4194308,4,Rw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Kc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kc(4,2,e,t)},useMemo:function(e,t){var r=Dn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Dn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=kT.bind(null,_t,e),[n.memoizedState,e]},useRef:function(e){var t=Dn();return e={current:e},t.memoizedState=e},useState:Dx,useDebugValue:P0,useDeferredValue:function(e){return Dn().memoizedState=e},useTransition:function(){var e=Dx(!1),t=e[0];return e=NT.bind(null,e[1]),Dn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=_t,s=Dn();if(Et){if(r===void 0)throw Error(oe(407));r=r()}else{if(r=t(),Xt===null)throw Error(oe(349));si&30||kw(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Mx(Sw.bind(null,n,i,e),[e]),n.flags|=2048,cu(9,_w.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Dn(),t=Xt.identifierPrefix;if(Et){var r=hs,n=ds;r=(n&~(1<<32-Sn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ou++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ET++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},TT={readContext:cn,useCallback:Ow,useContext:cn,useEffect:O0,useImperativeHandle:Lw,useInsertionEffect:Aw,useLayoutEffect:Iw,useMemo:Pw,useReducer:gf,useRef:jw,useState:function(){return gf(uu)},useDebugValue:P0,useDeferredValue:function(e){var t=dn();return Dw(t,Ht.memoizedState,e)},useTransition:function(){var e=gf(uu)[0],t=dn().memoizedState;return[e,t]},useMutableSource:Ew,useSyncExternalStore:Nw,useId:Mw,unstable_isNewReconciler:!1},CT={readContext:cn,useCallback:Ow,useContext:cn,useEffect:O0,useImperativeHandle:Lw,useInsertionEffect:Aw,useLayoutEffect:Iw,useMemo:Pw,useReducer:xf,useRef:jw,useState:function(){return xf(uu)},useDebugValue:P0,useDeferredValue:function(e){var t=dn();return Ht===null?t.memoizedState=e:Dw(t,Ht.memoizedState,e)},useTransition:function(){var e=xf(uu)[0],t=dn().memoizedState;return[e,t]},useMutableSource:Ew,useSyncExternalStore:Nw,useId:Mw,unstable_isNewReconciler:!1};function xn(e,t){if(e&&e.defaultProps){t=St({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Bm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:St({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ih={isMounted:function(e){return(e=e._reactInternals)?gi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=vr(),s=ha(e),i=fs(n,s);i.payload=t,r!=null&&(i.callback=r),t=ca(e,i,s),t!==null&&(Tn(t,e,s,n),Yc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=vr(),s=ha(e),i=fs(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ca(e,i,s),t!==null&&(Tn(t,e,s,n),Yc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=vr(),n=ha(e),s=fs(r,n);s.tag=2,t!=null&&(s.callback=t),t=ca(e,s,n),t!==null&&(Tn(t,e,n,r),Yc(t,e,n))}};function Fx(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!ru(r,n)||!ru(s,i):!0}function Hw(e,t,r){var n=!1,s=ga,i=t.contextType;return typeof i=="object"&&i!==null?i=cn(i):(s=Or(t)?ri:dr.current,n=t.contextTypes,i=(n=n!=null)?El(e,s):ga),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ih,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ux(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ih.enqueueReplaceState(t,t.state,null)}function Hm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},T0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=cn(i):(i=Or(t)?ri:dr.current,s.context=El(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Bm(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ih.enqueueReplaceState(s,s.state,null),Ed(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Sl(e,t){try{var r="",n=t;do r+=rS(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function yf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function $m(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var jT=typeof WeakMap=="function"?WeakMap:Map;function $w(e,t,r){r=fs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Td||(Td=!0,Xm=n),$m(e,t)},r}function zw(e,t,r){r=fs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){$m(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){$m(e,t),typeof n!="function"&&(da===null?da=new Set([this]):da.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Bx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new jT;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=zT.bind(null,e,t,r),t.then(e,e))}function Hx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $x(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fs(-1,1),t.tag=2,ca(r,t,1))),r.lanes|=1),e)}var AT=ws.ReactCurrentOwner,Rr=!1;function yr(e,t,r,n){t.child=e===null?yw(t,null,r,n):kl(t,e.child,r,n)}function zx(e,t,r,n,s){r=r.render;var i=t.ref;return Zi(t,s),n=R0(e,t,r,n,i,s),r=L0(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ys(e,t,s)):(Et&&r&&v0(t),t.flags|=1,yr(e,t,n,s),t.child)}function qx(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!z0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,qw(e,t,i,n,s)):(e=ed(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:ru,r(l,n)&&e.ref===t.ref)return ys(e,t,s)}return t.flags|=1,e=fa(i,n),e.ref=t.ref,e.return=t,t.child=e}function qw(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(ru(i,n)&&e.ref===t.ref)if(Rr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Rr=!0);else return t.lanes=e.lanes,ys(e,t,s)}return zm(e,t,r,n,s)}function Vw(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(qi,$r),$r|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(qi,$r),$r|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,mt(qi,$r),$r|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,mt(qi,$r),$r|=n;return yr(e,t,s,r),t.child}function Ww(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function zm(e,t,r,n,s){var i=Or(r)?ri:dr.current;return i=El(t,i),Zi(t,s),r=R0(e,t,r,n,i,s),n=L0(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ys(e,t,s)):(Et&&n&&v0(t),t.flags|=1,yr(e,t,r,s),t.child)}function Vx(e,t,r,n,s){if(Or(r)){var i=!0;xd(t)}else i=!1;if(Zi(t,s),t.stateNode===null)Zc(e,t),Hw(t,r,n),Hm(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=cn(c):(c=Or(r)?ri:dr.current,c=El(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&Ux(t,l,n,c),Us=!1;var f=t.memoizedState;l.state=f,Ed(t,n,l,s),u=t.memoizedState,o!==n||f!==u||Lr.current||Us?(typeof d=="function"&&(Bm(t,r,d,n),u=t.memoizedState),(o=Us||Fx(t,r,o,n,f,u,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,vw(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:xn(t.type,o),l.props=c,h=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=cn(u):(u=Or(r)?ri:dr.current,u=El(t,u));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==u)&&Ux(t,l,n,u),Us=!1,f=t.memoizedState,l.state=f,Ed(t,n,l,s);var g=t.memoizedState;o!==h||f!==g||Lr.current||Us?(typeof p=="function"&&(Bm(t,r,p,n),g=t.memoizedState),(c=Us||Fx(t,r,c,n,f,g,u)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return qm(e,t,r,n,i,s)}function qm(e,t,r,n,s,i){Ww(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&Ax(t,r,!1),ys(e,t,i);n=t.stateNode,AT.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=kl(t,e.child,null,i),t.child=kl(t,null,o,i)):yr(e,t,o,i),t.memoizedState=n.state,s&&Ax(t,r,!0),t.child}function Gw(e){var t=e.stateNode;t.pendingContext?jx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&jx(e,t.context,!1),C0(e,t.containerInfo)}function Wx(e,t,r,n,s){return Nl(),E0(s),t.flags|=256,yr(e,t,r,n),t.child}var Vm={dehydrated:null,treeContext:null,retryLane:0};function Wm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Yw(e,t,r){var n=t.pendingProps,s=kt.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),mt(kt,s&1),e===null)return Fm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=uh(l,n,0,null),e=Ja(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Wm(r),t.memoizedState=Vm,e):D0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return IT(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=fa(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=fa(o,i):(i=Ja(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?Wm(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Vm,n}return i=e.child,e=i.sibling,n=fa(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function D0(e,t){return t=uh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wc(e,t,r,n){return n!==null&&E0(n),kl(t,e.child,null,r),e=D0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function IT(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=yf(Error(oe(422))),wc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=uh({mode:"visible",children:n.children},s,0,null),i=Ja(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&kl(t,e.child,null,l),t.child.memoizedState=Wm(l),t.memoizedState=Vm,i);if(!(t.mode&1))return wc(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(oe(419)),n=yf(i,n,void 0),wc(e,t,l,n)}if(o=(l&e.childLanes)!==0,Rr||o){if(n=Xt,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xs(e,s),Tn(n,e,s,-1))}return $0(),n=yf(Error(oe(421))),wc(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=qT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,qr=ua(s.nextSibling),Vr=t,Et=!0,En=null,e!==null&&(nn[sn++]=ds,nn[sn++]=hs,nn[sn++]=ni,ds=e.id,hs=e.overflow,ni=t),t=D0(t,n.children),t.flags|=4096,t)}function Gx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Um(e.return,t,r)}function bf(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Qw(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(yr(e,t,n.children,r),n=kt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Gx(e,r,t);else if(e.tag===19)Gx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mt(kt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Nd(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),bf(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Nd(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}bf(t,!0,r,null,i);break;case"together":bf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ys(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ai|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,r=fa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=fa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function RT(e,t,r){switch(t.tag){case 3:Gw(t),Nl();break;case 5:ww(t);break;case 1:Or(t.type)&&xd(t);break;case 4:C0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;mt(vd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mt(kt,kt.current&1),t.flags|=128,null):r&t.child.childLanes?Yw(e,t,r):(mt(kt,kt.current&1),e=ys(e,t,r),e!==null?e.sibling:null);mt(kt,kt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Qw(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),mt(kt,kt.current),n)break;return null;case 22:case 23:return t.lanes=0,Vw(e,t,r)}return ys(e,t,r)}var Kw,Gm,Zw,Xw;Kw=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Gm=function(){};Zw=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,$a(Vn.current);var i=null;switch(r){case"input":s=pm(e,s),n=pm(e,n),i=[];break;case"select":s=St({},s,{value:void 0}),n=St({},n,{value:void 0}),i=[];break;case"textarea":s=ym(e,s),n=ym(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=pd)}vm(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&yt("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Xw=function(e,t,r,n){r!==n&&(t.flags|=4)};function so(e,t){if(!Et)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ar(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function LT(e,t,r){var n=t.pendingProps;switch(w0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(t),null;case 1:return Or(t.type)&&gd(),ar(t),null;case 3:return n=t.stateNode,_l(),bt(Lr),bt(dr),A0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(bc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,En!==null&&(tp(En),En=null))),Gm(e,t),ar(t),null;case 5:j0(t);var s=$a(lu.current);if(r=t.type,e!==null&&t.stateNode!=null)Zw(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(oe(166));return ar(t),null}if(e=$a(Vn.current),bc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[zn]=t,n[au]=i,e=(t.mode&1)!==0,r){case"dialog":yt("cancel",n),yt("close",n);break;case"iframe":case"object":case"embed":yt("load",n);break;case"video":case"audio":for(s=0;s<bo.length;s++)yt(bo[s],n);break;case"source":yt("error",n);break;case"img":case"image":case"link":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"input":rx(n,i),yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},yt("invalid",n);break;case"textarea":sx(n,i),yt("invalid",n)}vm(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&yc(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&yc(n.textContent,o,e),s=["children",""+o]):Qo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&yt("scroll",n)}switch(r){case"input":cc(n),nx(n,i,!0);break;case"textarea":cc(n),ax(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=pd)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[zn]=t,e[au]=n,Kw(e,t,!1,!1),t.stateNode=e;e:{switch(l=wm(r,n),r){case"dialog":yt("cancel",e),yt("close",e),s=n;break;case"iframe":case"object":case"embed":yt("load",e),s=n;break;case"video":case"audio":for(s=0;s<bo.length;s++)yt(bo[s],e);s=n;break;case"source":yt("error",e),s=n;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=n;break;case"details":yt("toggle",e),s=n;break;case"input":rx(e,n),s=pm(e,n),yt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=St({},n,{value:void 0}),yt("invalid",e);break;case"textarea":sx(e,n),s=ym(e,n),yt("invalid",e);break;default:s=n}vm(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?jv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Tv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ko(e,u):typeof u=="number"&&Ko(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Qo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&yt("scroll",e):u!=null&&i0(e,i,u,l))}switch(r){case"input":cc(e),nx(e,n,!1);break;case"textarea":cc(e),ax(e);break;case"option":n.value!=null&&e.setAttribute("value",""+pa(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Gi(e,!!n.multiple,i,!1):n.defaultValue!=null&&Gi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=pd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ar(t),null;case 6:if(e&&t.stateNode!=null)Xw(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(oe(166));if(r=$a(lu.current),$a(Vn.current),bc(t)){if(n=t.stateNode,r=t.memoizedProps,n[zn]=t,(i=n.nodeValue!==r)&&(e=Vr,e!==null))switch(e.tag){case 3:yc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zn]=t,t.stateNode=n}return ar(t),null;case 13:if(bt(kt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Et&&qr!==null&&t.mode&1&&!(t.flags&128))gw(),Nl(),t.flags|=98560,i=!1;else if(i=bc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(oe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[zn]=t}else Nl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ar(t),i=!1}else En!==null&&(tp(En),En=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||kt.current&1?zt===0&&(zt=3):$0())),t.updateQueue!==null&&(t.flags|=4),ar(t),null);case 4:return _l(),Gm(e,t),e===null&&nu(t.stateNode.containerInfo),ar(t),null;case 10:return _0(t.type._context),ar(t),null;case 17:return Or(t.type)&&gd(),ar(t),null;case 19:if(bt(kt),i=t.memoizedState,i===null)return ar(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)so(i,!1);else{if(zt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Nd(e),l!==null){for(t.flags|=128,so(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(kt,kt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Lt()>Tl&&(t.flags|=128,n=!0,so(i,!1),t.lanes=4194304)}else{if(!n)if(e=Nd(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),so(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Et)return ar(t),null}else 2*Lt()-i.renderingStartTime>Tl&&r!==1073741824&&(t.flags|=128,n=!0,so(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Lt(),t.sibling=null,r=kt.current,mt(kt,n?r&1|2:r&1),t):(ar(t),null);case 22:case 23:return H0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?$r&1073741824&&(ar(t),t.subtreeFlags&6&&(t.flags|=8192)):ar(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function OT(e,t){switch(w0(t),t.tag){case 1:return Or(t.type)&&gd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _l(),bt(Lr),bt(dr),A0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return j0(t),null;case 13:if(bt(kt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));Nl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return bt(kt),null;case 4:return _l(),null;case 10:return _0(t.type._context),null;case 22:case 23:return H0(),null;case 24:return null;default:return null}}var Ec=!1,lr=!1,PT=typeof WeakSet=="function"?WeakSet:Set,we=null;function zi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){It(e,t,n)}else r.current=null}function Ym(e,t,r){try{r()}catch(n){It(e,t,n)}}var Yx=!1;function DT(e,t){if(Im=hd,e=nw(),b0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=l+s),h!==i||n!==0&&h.nodeType!==3||(u=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++d===n&&(u=l),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Rm={focusedElem:e,selectionRange:r},hd=!1,we=t;we!==null;)if(t=we,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,we=e;else for(;we!==null;){t=we;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,E=g.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:xn(t.type,y),E);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(_){It(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,we=e;break}we=t.return}return g=Yx,Yx=!1,g}function Ro(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ym(t,r,i)}s=s.next}while(s!==n)}}function lh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Qm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Jw(e){var t=e.alternate;t!==null&&(e.alternate=null,Jw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zn],delete t[au],delete t[Pm],delete t[yT],delete t[bT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function e2(e){return e.tag===5||e.tag===3||e.tag===4}function Qx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Km(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=pd));else if(n!==4&&(e=e.child,e!==null))for(Km(e,t,r),e=e.sibling;e!==null;)Km(e,t,r),e=e.sibling}function Zm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Zm(e,t,r),e=e.sibling;e!==null;)Zm(e,t,r),e=e.sibling}var er=null,vn=!1;function Cs(e,t,r){for(r=r.child;r!==null;)t2(e,t,r),r=r.sibling}function t2(e,t,r){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount(Jd,r)}catch{}switch(r.tag){case 5:lr||zi(r,t);case 6:var n=er,s=vn;er=null,Cs(e,t,r),er=n,vn=s,er!==null&&(vn?(e=er,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):er.removeChild(r.stateNode));break;case 18:er!==null&&(vn?(e=er,r=r.stateNode,e.nodeType===8?hf(e.parentNode,r):e.nodeType===1&&hf(e,r),eu(e)):hf(er,r.stateNode));break;case 4:n=er,s=vn,er=r.stateNode.containerInfo,vn=!0,Cs(e,t,r),er=n,vn=s;break;case 0:case 11:case 14:case 15:if(!lr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Ym(r,t,l),s=s.next}while(s!==n)}Cs(e,t,r);break;case 1:if(!lr&&(zi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){It(r,t,o)}Cs(e,t,r);break;case 21:Cs(e,t,r);break;case 22:r.mode&1?(lr=(n=lr)||r.memoizedState!==null,Cs(e,t,r),lr=n):Cs(e,t,r);break;default:Cs(e,t,r)}}function Kx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new PT),t.forEach(function(n){var s=VT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function gn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:er=o.stateNode,vn=!1;break e;case 3:er=o.stateNode.containerInfo,vn=!0;break e;case 4:er=o.stateNode.containerInfo,vn=!0;break e}o=o.return}if(er===null)throw Error(oe(160));t2(i,l,s),er=null,vn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){It(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)r2(t,e),t=t.sibling}function r2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gn(t,e),On(e),n&4){try{Ro(3,e,e.return),lh(3,e)}catch(y){It(e,e.return,y)}try{Ro(5,e,e.return)}catch(y){It(e,e.return,y)}}break;case 1:gn(t,e),On(e),n&512&&r!==null&&zi(r,r.return);break;case 5:if(gn(t,e),On(e),n&512&&r!==null&&zi(r,r.return),e.flags&32){var s=e.stateNode;try{Ko(s,"")}catch(y){It(e,e.return,y)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&kv(s,i),wm(o,l);var c=wm(o,i);for(l=0;l<u.length;l+=2){var d=u[l],h=u[l+1];d==="style"?jv(s,h):d==="dangerouslySetInnerHTML"?Tv(s,h):d==="children"?Ko(s,h):i0(s,d,h,c)}switch(o){case"input":gm(s,i);break;case"textarea":_v(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Gi(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Gi(s,!!i.multiple,i.defaultValue,!0):Gi(s,!!i.multiple,i.multiple?[]:"",!1))}s[au]=i}catch(y){It(e,e.return,y)}}break;case 6:if(gn(t,e),On(e),n&4){if(e.stateNode===null)throw Error(oe(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(y){It(e,e.return,y)}}break;case 3:if(gn(t,e),On(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{eu(t.containerInfo)}catch(y){It(e,e.return,y)}break;case 4:gn(t,e),On(e);break;case 13:gn(t,e),On(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(U0=Lt())),n&4&&Kx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(lr=(c=lr)||d,gn(t,e),lr=c):gn(t,e),On(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(we=e,d=e.child;d!==null;){for(h=we=d;we!==null;){switch(f=we,p=f.child,f.tag){case 0:case 11:case 14:case 15:Ro(4,f,f.return);break;case 1:zi(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(y){It(n,r,y)}}break;case 5:zi(f,f.return);break;case 22:if(f.memoizedState!==null){Xx(h);continue}}p!==null?(p.return=f,we=p):Xx(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,u=h.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=Cv("display",l))}catch(y){It(e,e.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(y){It(e,e.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gn(t,e),On(e),n&4&&Kx(e);break;case 21:break;default:gn(t,e),On(e)}}function On(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(e2(r)){var n=r;break e}r=r.return}throw Error(oe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ko(s,""),n.flags&=-33);var i=Qx(e);Zm(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Qx(e);Km(e,o,l);break;default:throw Error(oe(161))}}catch(u){It(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MT(e,t,r){we=e,n2(e)}function n2(e,t,r){for(var n=(e.mode&1)!==0;we!==null;){var s=we,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||Ec;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||lr;o=Ec;var c=lr;if(Ec=l,(lr=u)&&!c)for(we=s;we!==null;)l=we,u=l.child,l.tag===22&&l.memoizedState!==null?Jx(s):u!==null?(u.return=l,we=u):Jx(s);for(;i!==null;)we=i,n2(i),i=i.sibling;we=s,Ec=o,lr=c}Zx(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,we=i):Zx(e)}}function Zx(e){for(;we!==null;){var t=we;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:lr||lh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!lr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:xn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Px(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Px(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&eu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}lr||t.flags&512&&Qm(t)}catch(f){It(t,t.return,f)}}if(t===e){we=null;break}if(r=t.sibling,r!==null){r.return=t.return,we=r;break}we=t.return}}function Xx(e){for(;we!==null;){var t=we;if(t===e){we=null;break}var r=t.sibling;if(r!==null){r.return=t.return,we=r;break}we=t.return}}function Jx(e){for(;we!==null;){var t=we;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{lh(4,t)}catch(u){It(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){It(t,s,u)}}var i=t.return;try{Qm(t)}catch(u){It(t,i,u)}break;case 5:var l=t.return;try{Qm(t)}catch(u){It(t,l,u)}}}catch(u){It(t,t.return,u)}if(t===e){we=null;break}var o=t.sibling;if(o!==null){o.return=t.return,we=o;break}we=t.return}}var FT=Math.ceil,Sd=ws.ReactCurrentDispatcher,M0=ws.ReactCurrentOwner,un=ws.ReactCurrentBatchConfig,rt=0,Xt=null,Ft=null,rr=0,$r=0,qi=Na(0),zt=0,du=null,ai=0,oh=0,F0=0,Lo=null,Ar=null,U0=0,Tl=1/0,ss=null,Td=!1,Xm=null,da=null,Nc=!1,na=null,Cd=0,Oo=0,Jm=null,Xc=-1,Jc=0;function vr(){return rt&6?Lt():Xc!==-1?Xc:Xc=Lt()}function ha(e){return e.mode&1?rt&2&&rr!==0?rr&-rr:wT.transition!==null?(Jc===0&&(Jc=Hv()),Jc):(e=lt,e!==0||(e=window.event,e=e===void 0?16:Yv(e.type)),e):1}function Tn(e,t,r,n){if(50<Oo)throw Oo=0,Jm=null,Error(oe(185));$u(e,r,n),(!(rt&2)||e!==Xt)&&(e===Xt&&(!(rt&2)&&(oh|=r),zt===4&&zs(e,rr)),Pr(e,n),r===1&&rt===0&&!(t.mode&1)&&(Tl=Lt()+500,sh&&ka()))}function Pr(e,t){var r=e.callbackNode;wS(e,t);var n=dd(e,e===Xt?rr:0);if(n===0)r!==null&&ox(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&ox(r),t===1)e.tag===0?vT(ey.bind(null,e)):fw(ey.bind(null,e)),gT(function(){!(rt&6)&&ka()}),r=null;else{switch($v(n)){case 1:r=d0;break;case 4:r=Uv;break;case 16:r=cd;break;case 536870912:r=Bv;break;default:r=cd}r=d2(r,s2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function s2(e,t){if(Xc=-1,Jc=0,rt&6)throw Error(oe(327));var r=e.callbackNode;if(Xi()&&e.callbackNode!==r)return null;var n=dd(e,e===Xt?rr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=jd(e,n);else{t=n;var s=rt;rt|=2;var i=i2();(Xt!==e||rr!==t)&&(ss=null,Tl=Lt()+500,Xa(e,t));do try{HT();break}catch(o){a2(e,o)}while(!0);k0(),Sd.current=i,rt=s,Ft!==null?t=0:(Xt=null,rr=0,t=zt)}if(t!==0){if(t===2&&(s=Sm(e),s!==0&&(n=s,t=ep(e,s))),t===1)throw r=du,Xa(e,0),zs(e,n),Pr(e,Lt()),r;if(t===6)zs(e,n);else{if(s=e.current.alternate,!(n&30)&&!UT(s)&&(t=jd(e,n),t===2&&(i=Sm(e),i!==0&&(n=i,t=ep(e,i))),t===1))throw r=du,Xa(e,0),zs(e,n),Pr(e,Lt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(oe(345));case 2:Pa(e,Ar,ss);break;case 3:if(zs(e,n),(n&130023424)===n&&(t=U0+500-Lt(),10<t)){if(dd(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){vr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Om(Pa.bind(null,e,Ar,ss),t);break}Pa(e,Ar,ss);break;case 4:if(zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-Sn(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=Lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*FT(n/1960))-n,10<n){e.timeoutHandle=Om(Pa.bind(null,e,Ar,ss),n);break}Pa(e,Ar,ss);break;case 5:Pa(e,Ar,ss);break;default:throw Error(oe(329))}}}return Pr(e,Lt()),e.callbackNode===r?s2.bind(null,e):null}function ep(e,t){var r=Lo;return e.current.memoizedState.isDehydrated&&(Xa(e,t).flags|=256),e=jd(e,t),e!==2&&(t=Ar,Ar=r,t!==null&&tp(t)),e}function tp(e){Ar===null?Ar=e:Ar.push.apply(Ar,e)}function UT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~F0,t&=~oh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Sn(t),n=1<<r;e[r]=-1,t&=~n}}function ey(e){if(rt&6)throw Error(oe(327));Xi();var t=dd(e,0);if(!(t&1))return Pr(e,Lt()),null;var r=jd(e,t);if(e.tag!==0&&r===2){var n=Sm(e);n!==0&&(t=n,r=ep(e,n))}if(r===1)throw r=du,Xa(e,0),zs(e,t),Pr(e,Lt()),r;if(r===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pa(e,Ar,ss),Pr(e,Lt()),null}function B0(e,t){var r=rt;rt|=1;try{return e(t)}finally{rt=r,rt===0&&(Tl=Lt()+500,sh&&ka())}}function ii(e){na!==null&&na.tag===0&&!(rt&6)&&Xi();var t=rt;rt|=1;var r=un.transition,n=lt;try{if(un.transition=null,lt=1,e)return e()}finally{lt=n,un.transition=r,rt=t,!(rt&6)&&ka()}}function H0(){$r=qi.current,bt(qi)}function Xa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,pT(r)),Ft!==null)for(r=Ft.return;r!==null;){var n=r;switch(w0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gd();break;case 3:_l(),bt(Lr),bt(dr),A0();break;case 5:j0(n);break;case 4:_l();break;case 13:bt(kt);break;case 19:bt(kt);break;case 10:_0(n.type._context);break;case 22:case 23:H0()}r=r.return}if(Xt=e,Ft=e=fa(e.current,null),rr=$r=t,zt=0,du=null,F0=oh=ai=0,Ar=Lo=null,Ha!==null){for(t=0;t<Ha.length;t++)if(r=Ha[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}Ha=null}return e}function a2(e,t){do{var r=Ft;try{if(k0(),Qc.current=_d,kd){for(var n=_t.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}kd=!1}if(si=0,Kt=Ht=_t=null,Io=!1,ou=0,M0.current=null,r===null||r.return===null){zt=1,du=t,Ft=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=rr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Hx(l);if(p!==null){p.flags&=-257,$x(p,l,o,i,t),p.mode&1&&Bx(i,c,t),t=p,u=c;var g=t.updateQueue;if(g===null){var y=new Set;y.add(u),t.updateQueue=y}else g.add(u);break e}else{if(!(t&1)){Bx(i,c,t),$0();break e}u=Error(oe(426))}}else if(Et&&o.mode&1){var E=Hx(l);if(E!==null){!(E.flags&65536)&&(E.flags|=256),$x(E,l,o,i,t),E0(Sl(u,o));break e}}i=u=Sl(u,o),zt!==4&&(zt=2),Lo===null?Lo=[i]:Lo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=$w(i,u,t);Ox(i,x);break e;case 1:o=u;var b=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(da===null||!da.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=zw(i,o,t);Ox(i,_);break e}}i=i.return}while(i!==null)}o2(r)}catch(k){t=k,Ft===r&&r!==null&&(Ft=r=r.return);continue}break}while(!0)}function i2(){var e=Sd.current;return Sd.current=_d,e===null?_d:e}function $0(){(zt===0||zt===3||zt===2)&&(zt=4),Xt===null||!(ai&268435455)&&!(oh&268435455)||zs(Xt,rr)}function jd(e,t){var r=rt;rt|=2;var n=i2();(Xt!==e||rr!==t)&&(ss=null,Xa(e,t));do try{BT();break}catch(s){a2(e,s)}while(!0);if(k0(),rt=r,Sd.current=n,Ft!==null)throw Error(oe(261));return Xt=null,rr=0,zt}function BT(){for(;Ft!==null;)l2(Ft)}function HT(){for(;Ft!==null&&!hS();)l2(Ft)}function l2(e){var t=c2(e.alternate,e,$r);e.memoizedProps=e.pendingProps,t===null?o2(e):Ft=t,M0.current=null}function o2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=OT(r,t),r!==null){r.flags&=32767,Ft=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{zt=6,Ft=null;return}}else if(r=LT(r,t,$r),r!==null){Ft=r;return}if(t=t.sibling,t!==null){Ft=t;return}Ft=t=e}while(t!==null);zt===0&&(zt=5)}function Pa(e,t,r){var n=lt,s=un.transition;try{un.transition=null,lt=1,$T(e,t,r,n)}finally{un.transition=s,lt=n}return null}function $T(e,t,r,n){do Xi();while(na!==null);if(rt&6)throw Error(oe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(ES(e,i),e===Xt&&(Ft=Xt=null,rr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Nc||(Nc=!0,d2(cd,function(){return Xi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=un.transition,un.transition=null;var l=lt;lt=1;var o=rt;rt|=4,M0.current=null,DT(e,r),r2(r,e),oT(Rm),hd=!!Im,Rm=Im=null,e.current=r,MT(r),fS(),rt=o,lt=l,un.transition=i}else e.current=r;if(Nc&&(Nc=!1,na=e,Cd=s),i=e.pendingLanes,i===0&&(da=null),gS(r.stateNode),Pr(e,Lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Td)throw Td=!1,e=Xm,Xm=null,e;return Cd&1&&e.tag!==0&&Xi(),i=e.pendingLanes,i&1?e===Jm?Oo++:(Oo=0,Jm=e):Oo=0,ka(),null}function Xi(){if(na!==null){var e=$v(Cd),t=un.transition,r=lt;try{if(un.transition=null,lt=16>e?16:e,na===null)var n=!1;else{if(e=na,na=null,Cd=0,rt&6)throw Error(oe(331));var s=rt;for(rt|=4,we=e.current;we!==null;){var i=we,l=i.child;if(we.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(we=c;we!==null;){var d=we;switch(d.tag){case 0:case 11:case 15:Ro(8,d,i)}var h=d.child;if(h!==null)h.return=d,we=h;else for(;we!==null;){d=we;var f=d.sibling,p=d.return;if(Jw(d),d===c){we=null;break}if(f!==null){f.return=p,we=f;break}we=p}}}var g=i.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}we=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,we=l;else e:for(;we!==null;){if(i=we,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ro(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,we=x;break e}we=i.return}}var b=e.current;for(we=b;we!==null;){l=we;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,we=v;else e:for(l=b;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:lh(9,o)}}catch(k){It(o,o.return,k)}if(o===l){we=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,we=_;break e}we=o.return}}if(rt=s,ka(),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot(Jd,e)}catch{}n=!0}return n}finally{lt=r,un.transition=t}}return!1}function ty(e,t,r){t=Sl(r,t),t=$w(e,t,1),e=ca(e,t,1),t=vr(),e!==null&&($u(e,1,t),Pr(e,t))}function It(e,t,r){if(e.tag===3)ty(e,e,r);else for(;t!==null;){if(t.tag===3){ty(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(da===null||!da.has(n))){e=Sl(r,e),e=zw(t,e,1),t=ca(t,e,1),e=vr(),t!==null&&($u(t,1,e),Pr(t,e));break}}t=t.return}}function zT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=vr(),e.pingedLanes|=e.suspendedLanes&r,Xt===e&&(rr&r)===r&&(zt===4||zt===3&&(rr&130023424)===rr&&500>Lt()-U0?Xa(e,0):F0|=r),Pr(e,t)}function u2(e,t){t===0&&(e.mode&1?(t=fc,fc<<=1,!(fc&130023424)&&(fc=4194304)):t=1);var r=vr();e=xs(e,t),e!==null&&($u(e,t,r),Pr(e,r))}function qT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),u2(e,r)}function VT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(oe(314))}n!==null&&n.delete(t),u2(e,r)}var c2;c2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lr.current)Rr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Rr=!1,RT(e,t,r);Rr=!!(e.flags&131072)}else Rr=!1,Et&&t.flags&1048576&&mw(t,bd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Zc(e,t),e=t.pendingProps;var s=El(t,dr.current);Zi(t,r),s=R0(null,t,n,e,s,r);var i=L0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(n)?(i=!0,xd(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,T0(t),s.updater=ih,t.stateNode=s,s._reactInternals=t,Hm(t,n,e,r),t=qm(null,t,n,!0,i,r)):(t.tag=0,Et&&i&&v0(t),yr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Zc(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=GT(n),e=xn(n,e),s){case 0:t=zm(null,t,n,e,r);break e;case 1:t=Vx(null,t,n,e,r);break e;case 11:t=zx(null,t,n,e,r);break e;case 14:t=qx(null,t,n,xn(n.type,e),r);break e}throw Error(oe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:xn(n,s),zm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:xn(n,s),Vx(e,t,n,s,r);case 3:e:{if(Gw(t),e===null)throw Error(oe(387));n=t.pendingProps,i=t.memoizedState,s=i.element,vw(e,t),Ed(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Sl(Error(oe(423)),t),t=Wx(e,t,n,r,s);break e}else if(n!==s){s=Sl(Error(oe(424)),t),t=Wx(e,t,n,r,s);break e}else for(qr=ua(t.stateNode.containerInfo.firstChild),Vr=t,Et=!0,En=null,r=yw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Nl(),n===s){t=ys(e,t,r);break e}yr(e,t,n,r)}t=t.child}return t;case 5:return ww(t),e===null&&Fm(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,Lm(n,s)?l=null:i!==null&&Lm(n,i)&&(t.flags|=32),Ww(e,t),yr(e,t,l,r),t.child;case 6:return e===null&&Fm(t),null;case 13:return Yw(e,t,r);case 4:return C0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=kl(t,null,n,r):yr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:xn(n,s),zx(e,t,n,s,r);case 7:return yr(e,t,t.pendingProps,r),t.child;case 8:return yr(e,t,t.pendingProps.children,r),t.child;case 12:return yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,mt(vd,n._currentValue),n._currentValue=l,i!==null)if(In(i.value,l)){if(i.children===s.children&&!Lr.current){t=ys(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=fs(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Um(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(oe(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Um(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}yr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Zi(t,r),s=cn(s),n=n(s),t.flags|=1,yr(e,t,n,r),t.child;case 14:return n=t.type,s=xn(n,t.pendingProps),s=xn(n.type,s),qx(e,t,n,s,r);case 15:return qw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:xn(n,s),Zc(e,t),t.tag=1,Or(n)?(e=!0,xd(t)):e=!1,Zi(t,r),Hw(t,n,s),Hm(t,n,s,r),qm(null,t,n,!0,e,r);case 19:return Qw(e,t,r);case 22:return Vw(e,t,r)}throw Error(oe(156,t.tag))};function d2(e,t){return Fv(e,t)}function WT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,r,n){return new WT(e,t,r,n)}function z0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function GT(e){if(typeof e=="function")return z0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===o0)return 11;if(e===u0)return 14}return 2}function fa(e,t){var r=e.alternate;return r===null?(r=on(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ed(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")z0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Oi:return Ja(r.children,s,i,t);case l0:l=8,s|=8;break;case dm:return e=on(12,r,t,s|2),e.elementType=dm,e.lanes=i,e;case hm:return e=on(13,r,t,s),e.elementType=hm,e.lanes=i,e;case fm:return e=on(19,r,t,s),e.elementType=fm,e.lanes=i,e;case wv:return uh(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bv:l=10;break e;case vv:l=9;break e;case o0:l=11;break e;case u0:l=14;break e;case Fs:l=16,n=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=on(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Ja(e,t,r,n){return e=on(7,e,n,t),e.lanes=r,e}function uh(e,t,r,n){return e=on(22,e,n,t),e.elementType=wv,e.lanes=r,e.stateNode={isHidden:!1},e}function vf(e,t,r){return e=on(6,e,null,t),e.lanes=r,e}function wf(e,t,r){return t=on(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function YT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ef(0),this.expirationTimes=ef(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ef(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function q0(e,t,r,n,s,i,l,o,u){return e=new YT(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=on(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},T0(i),e}function QT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function h2(e){if(!e)return ga;e=e._reactInternals;e:{if(gi(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var r=e.type;if(Or(r))return hw(e,r,t)}return t}function f2(e,t,r,n,s,i,l,o,u){return e=q0(r,n,!0,e,s,i,l,o,u),e.context=h2(null),r=e.current,n=vr(),s=ha(r),i=fs(n,s),i.callback=t??null,ca(r,i,s),e.current.lanes=s,$u(e,s,n),Pr(e,n),e}function ch(e,t,r,n){var s=t.current,i=vr(),l=ha(s);return r=h2(r),t.context===null?t.context=r:t.pendingContext=r,t=fs(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ca(s,t,l),e!==null&&(Tn(e,s,l,i),Yc(e,s,l)),l}function Ad(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ry(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function V0(e,t){ry(e,t),(e=e.alternate)&&ry(e,t)}function KT(){return null}var m2=typeof reportError=="function"?reportError:function(e){console.error(e)};function W0(e){this._internalRoot=e}dh.prototype.render=W0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));ch(e,t,null,null)};dh.prototype.unmount=W0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ii(function(){ch(null,e,null,null)}),t[gs]=null}};function dh(e){this._internalRoot=e}dh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$s.length&&t!==0&&t<$s[r].priority;r++);$s.splice(r,0,e),r===0&&Gv(e)}};function G0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ny(){}function ZT(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Ad(l);i.call(c)}}var l=f2(t,n,e,0,null,!1,!1,"",ny);return e._reactRootContainer=l,e[gs]=l.current,nu(e.nodeType===8?e.parentNode:e),ii(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ad(u);o.call(c)}}var u=q0(e,0,!1,null,null,!1,!1,"",ny);return e._reactRootContainer=u,e[gs]=u.current,nu(e.nodeType===8?e.parentNode:e),ii(function(){ch(t,u,r,n)}),u}function fh(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=Ad(l);o.call(u)}}ch(t,l,e,s)}else l=ZT(r,t,e,s,n);return Ad(l)}zv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=yo(t.pendingLanes);r!==0&&(h0(t,r|1),Pr(t,Lt()),!(rt&6)&&(Tl=Lt()+500,ka()))}break;case 13:ii(function(){var n=xs(e,1);if(n!==null){var s=vr();Tn(n,e,1,s)}}),V0(e,1)}};f0=function(e){if(e.tag===13){var t=xs(e,134217728);if(t!==null){var r=vr();Tn(t,e,134217728,r)}V0(e,134217728)}};qv=function(e){if(e.tag===13){var t=ha(e),r=xs(e,t);if(r!==null){var n=vr();Tn(r,e,t,n)}V0(e,t)}};Vv=function(){return lt};Wv=function(e,t){var r=lt;try{return lt=e,t()}finally{lt=r}};Nm=function(e,t,r){switch(t){case"input":if(gm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=nh(n);if(!s)throw Error(oe(90));Nv(n),gm(n,s)}}}break;case"textarea":_v(e,r);break;case"select":t=r.value,t!=null&&Gi(e,!!r.multiple,t,!1)}};Rv=B0;Lv=ii;var XT={usingClientEntryPoint:!1,Events:[qu,Fi,nh,Av,Iv,B0]},ao={findFiberByHostInstance:Ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JT={bundleType:ao.bundleType,version:ao.version,rendererPackageName:ao.rendererPackageName,rendererConfig:ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Dv(e),e===null?null:e.stateNode},findFiberByHostInstance:ao.findFiberByHostInstance||KT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{Jd=kc.inject(JT),qn=kc}catch{}}Qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XT;Qr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!G0(t))throw Error(oe(200));return QT(e,t,null,r)};Qr.createRoot=function(e,t){if(!G0(e))throw Error(oe(299));var r=!1,n="",s=m2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=q0(e,1,!1,null,null,r,!1,n,s),e[gs]=t.current,nu(e.nodeType===8?e.parentNode:e),new W0(t)};Qr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=Dv(t),e=e===null?null:e.stateNode,e};Qr.flushSync=function(e){return ii(e)};Qr.hydrate=function(e,t,r){if(!hh(t))throw Error(oe(200));return fh(null,e,t,!0,r)};Qr.hydrateRoot=function(e,t,r){if(!G0(e))throw Error(oe(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=m2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=f2(t,null,e,1,r??null,s,!1,i,l),e[gs]=t.current,nu(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new dh(t)};Qr.render=function(e,t,r){if(!hh(t))throw Error(oe(200));return fh(null,e,t,!1,r)};Qr.unmountComponentAtNode=function(e){if(!hh(e))throw Error(oe(40));return e._reactRootContainer?(ii(function(){fh(null,null,e,!1,function(){e._reactRootContainer=null,e[gs]=null})}),!0):!1};Qr.unstable_batchedUpdates=B0;Qr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!hh(r))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return fh(e,t,r,!1,n)};Qr.version="18.3.1-next-f1338f8080-20240426";function p2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p2)}catch(e){console.error(e)}}p2(),pv.exports=Qr;var eC=pv.exports,g2,sy=eC;g2=sy.createRoot,sy.hydrateRoot;var Bl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},li=typeof window>"u"||"Deno"in globalThis;function rn(){}function tC(e,t){return typeof e=="function"?e(t):e}function rp(e){return typeof e=="number"&&e>=0&&e!==1/0}function x2(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ji(e,t){return typeof e=="function"?e(t):e}function Nn(e,t){return typeof e=="function"?e(t):e}function ay(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==Y0(l,t.options))return!1}else if(!hu(t.queryKey,l))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||i&&!i(t))}function iy(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(oi(t.options.mutationKey)!==oi(i))return!1}else if(!hu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function Y0(e,t){return((t==null?void 0:t.queryKeyHashFn)||oi)(e)}function oi(e){return JSON.stringify(e,(t,r)=>np(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function hu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>hu(e[r],t[r])):!1}function y2(e,t){if(e===t)return e;const r=ly(e)&&ly(t);if(r||np(e)&&np(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{};let u=0;for(let c=0;c<l;c++){const d=r?c:i[c];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=y2(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return s===l&&u===s?e:o}return t}function Id(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function ly(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function np(e){if(!oy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!oy(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function oy(e){return Object.prototype.toString.call(e)==="[object Object]"}function rC(e){return new Promise(t=>{setTimeout(t,e)})}function sp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?y2(e,t):t}function nC(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function sC(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Q0=Symbol();function b2(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Q0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var qa,Ws,ol,Y1,aC=(Y1=class extends Bl{constructor(){super();Te(this,qa);Te(this,Ws);Te(this,ol);be(this,ol,t=>{if(!li&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){M(this,Ws)||this.setEventListener(M(this,ol))}onUnsubscribe(){var t;this.hasListeners()||((t=M(this,Ws))==null||t.call(this),be(this,Ws,void 0))}setEventListener(t){var r;be(this,ol,t),(r=M(this,Ws))==null||r.call(this),be(this,Ws,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){M(this,qa)!==t&&(be(this,qa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof M(this,qa)=="boolean"?M(this,qa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},qa=new WeakMap,Ws=new WeakMap,ol=new WeakMap,Y1),K0=new aC,ul,Gs,cl,Q1,iC=(Q1=class extends Bl{constructor(){super();Te(this,ul,!0);Te(this,Gs);Te(this,cl);be(this,cl,t=>{if(!li&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){M(this,Gs)||this.setEventListener(M(this,cl))}onUnsubscribe(){var t;this.hasListeners()||((t=M(this,Gs))==null||t.call(this),be(this,Gs,void 0))}setEventListener(t){var r;be(this,cl,t),(r=M(this,Gs))==null||r.call(this),be(this,Gs,t(this.setOnline.bind(this)))}setOnline(t){M(this,ul)!==t&&(be(this,ul,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return M(this,ul)}},ul=new WeakMap,Gs=new WeakMap,cl=new WeakMap,Q1),Rd=new iC;function ap(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function lC(e){return Math.min(1e3*2**e,3e4)}function v2(e){return(e??"online")==="online"?Rd.isOnline():!0}var w2=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Ef(e){return e instanceof w2}function E2(e){let t=!1,r=0,n=!1,s;const i=ap(),l=y=>{var E;n||(f(new w2(y)),(E=e.abort)==null||E.call(e))},o=()=>{t=!0},u=()=>{t=!1},c=()=>K0.isFocused()&&(e.networkMode==="always"||Rd.isOnline())&&e.canRun(),d=()=>v2(e.networkMode)&&e.canRun(),h=y=>{var E;n||(n=!0,(E=e.onSuccess)==null||E.call(e,y),s==null||s(),i.resolve(y))},f=y=>{var E;n||(n=!0,(E=e.onError)==null||E.call(e,y),s==null||s(),i.reject(y))},p=()=>new Promise(y=>{var E;s=x=>{(n||c())&&y(x)},(E=e.onPause)==null||E.call(e)}).then(()=>{var y;s=void 0,n||(y=e.onContinue)==null||y.call(e)}),g=()=>{if(n)return;let y;const E=r===0?e.initialPromise:void 0;try{y=E??e.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(h).catch(x=>{var S;if(n)return;const b=e.retry??(li?0:3),v=e.retryDelay??lC,_=typeof v=="function"?v(r,x):v,k=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,x);if(t||!k){f(x);return}r++,(S=e.onFail)==null||S.call(e,r,x),rC(_).then(()=>c()?void 0:p()).then(()=>{t?f(x):g()})})};return{promise:i,cancel:l,continue:()=>(s==null||s(),i),cancelRetry:o,continueRetry:u,canStart:d,start:()=>(d()?g():p().then(g),i)}}var oC=e=>setTimeout(e,0);function uC(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=oC;const i=o=>{t?e.push(o):s(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||l()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var $t=uC(),Va,K1,N2=(K1=class{constructor(){Te(this,Va)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),rp(this.gcTime)&&be(this,Va,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(li?1/0:5*60*1e3))}clearGcTimeout(){M(this,Va)&&(clearTimeout(M(this,Va)),be(this,Va,void 0))}},Va=new WeakMap,K1),dl,hl,tn,Wa,ir,Mu,Ga,yn,rs,Z1,cC=(Z1=class extends N2{constructor(t){super();Te(this,yn);Te(this,dl);Te(this,hl);Te(this,tn);Te(this,Wa);Te(this,ir);Te(this,Mu);Te(this,Ga);be(this,Ga,!1),be(this,Mu,t.defaultOptions),this.setOptions(t.options),this.observers=[],be(this,Wa,t.client),be(this,tn,M(this,Wa).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,be(this,dl,dC(this.options)),this.state=t.state??M(this,dl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=M(this,ir))==null?void 0:t.promise}setOptions(t){this.options={...M(this,Mu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,tn).remove(this)}setData(t,r){const n=sp(this.state.data,t,this.options);return He(this,yn,rs).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){He(this,yn,rs).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=M(this,ir))==null?void 0:n.promise;return(s=M(this,ir))==null||s.cancel(t),r?r.then(rn).catch(rn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,dl))}isActive(){return this.observers.some(t=>Nn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Q0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!x2(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=M(this,ir))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=M(this,ir))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),M(this,tn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(M(this,ir)&&(M(this,Ga)?M(this,ir).cancel({revert:!0}):M(this,ir).cancelRetry()),this.scheduleGc()),M(this,tn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||He(this,yn,rs).call(this,{type:"invalidate"})}fetch(t,r){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(M(this,ir))return M(this,ir).continueRetry(),M(this,ir).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(be(this,Ga,!0),n.signal)})},i=()=>{const h=b2(this.options,r),f={client:M(this,Wa),queryKey:this.queryKey,meta:this.meta};return s(f),be(this,Ga,!1),this.options.persister?this.options.persister(h,f,this):h(f)},l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:M(this,Wa),state:this.state,fetchFn:i};s(l),(u=this.options.behavior)==null||u.onFetch(l,this),be(this,hl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=l.fetchOptions)==null?void 0:c.meta))&&He(this,yn,rs).call(this,{type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta});const o=h=>{var f,p,g,y;Ef(h)&&h.silent||He(this,yn,rs).call(this,{type:"error",error:h}),Ef(h)||((p=(f=M(this,tn).config).onError)==null||p.call(f,h,this),(y=(g=M(this,tn).config).onSettled)==null||y.call(g,this.state.data,h,this)),this.scheduleGc()};return be(this,ir,E2({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,p,g,y;if(h===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(E){o(E);return}(p=(f=M(this,tn).config).onSuccess)==null||p.call(f,h,this),(y=(g=M(this,tn).config).onSettled)==null||y.call(g,h,this.state.error,this),this.scheduleGc()},onError:o,onFail:(h,f)=>{He(this,yn,rs).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{He(this,yn,rs).call(this,{type:"pause"})},onContinue:()=>{He(this,yn,rs).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),M(this,ir).start()}},dl=new WeakMap,hl=new WeakMap,tn=new WeakMap,Wa=new WeakMap,ir=new WeakMap,Mu=new WeakMap,Ga=new WeakMap,yn=new WeakSet,rs=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...k2(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Ef(s)&&s.revert&&M(this,hl)?{...M(this,hl),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),$t.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),M(this,tn).notify({query:this,type:"updated",action:t})})},Z1);function k2(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:v2(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function dC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Un,X1,hC=(X1=class extends Bl{constructor(t={}){super();Te(this,Un);this.config=t,be(this,Un,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??Y0(s,r);let l=this.get(i);return l||(l=new cC({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){M(this,Un).has(t.queryHash)||(M(this,Un).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=M(this,Un).get(t.queryHash);r&&(t.destroy(),r===t&&M(this,Un).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){$t.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return M(this,Un).get(t)}getAll(){return[...M(this,Un).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>ay(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>ay(t,n)):r}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){$t.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){$t.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Un=new WeakMap,X1),Bn,gr,Ya,Hn,Ls,J1,fC=(J1=class extends N2{constructor(t){super();Te(this,Hn);Te(this,Bn);Te(this,gr);Te(this,Ya);this.mutationId=t.mutationId,be(this,gr,t.mutationCache),be(this,Bn,[]),this.state=t.state||_2(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){M(this,Bn).includes(t)||(M(this,Bn).push(t),this.clearGcTimeout(),M(this,gr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){be(this,Bn,M(this,Bn).filter(r=>r!==t)),this.scheduleGc(),M(this,gr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){M(this,Bn).length||(this.state.status==="pending"?this.scheduleGc():M(this,gr).remove(this))}continue(){var t;return((t=M(this,Ya))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,u,c,d,h,f,p,g,y,E,x,b,v,_,k,S,I,j;const r=()=>{He(this,Hn,Ls).call(this,{type:"continue"})};be(this,Ya,E2({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(P,T)=>{He(this,Hn,Ls).call(this,{type:"failed",failureCount:P,error:T})},onPause:()=>{He(this,Hn,Ls).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,gr).canRun(this)}));const n=this.state.status==="pending",s=!M(this,Ya).canStart();try{if(n)r();else{He(this,Hn,Ls).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(i=M(this,gr).config).onMutate)==null?void 0:l.call(i,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&He(this,Hn,Ls).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const P=await M(this,Ya).start();return await((d=(c=M(this,gr).config).onSuccess)==null?void 0:d.call(c,P,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,P,t,this.state.context)),await((g=(p=M(this,gr).config).onSettled)==null?void 0:g.call(p,P,null,this.state.variables,this.state.context,this)),await((E=(y=this.options).onSettled)==null?void 0:E.call(y,P,null,t,this.state.context)),He(this,Hn,Ls).call(this,{type:"success",data:P}),P}catch(P){try{throw await((b=(x=M(this,gr).config).onError)==null?void 0:b.call(x,P,t,this.state.context,this)),await((_=(v=this.options).onError)==null?void 0:_.call(v,P,t,this.state.context)),await((S=(k=M(this,gr).config).onSettled)==null?void 0:S.call(k,void 0,P,this.state.variables,this.state.context,this)),await((j=(I=this.options).onSettled)==null?void 0:j.call(I,void 0,P,t,this.state.context)),P}finally{He(this,Hn,Ls).call(this,{type:"error",error:P})}}finally{M(this,gr).runNext(this)}}},Bn=new WeakMap,gr=new WeakMap,Ya=new WeakMap,Hn=new WeakSet,Ls=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),$t.batch(()=>{M(this,Bn).forEach(n=>{n.onMutationUpdate(t)}),M(this,gr).notify({mutation:this,type:"updated",action:t})})},J1);function _2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var os,bn,Fu,ev,mC=(ev=class extends Bl{constructor(t={}){super();Te(this,os);Te(this,bn);Te(this,Fu);this.config=t,be(this,os,new Set),be(this,bn,new Map),be(this,Fu,0)}build(t,r,n){const s=new fC({mutationCache:this,mutationId:++lc(this,Fu)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){M(this,os).add(t);const r=_c(t);if(typeof r=="string"){const n=M(this,bn).get(r);n?n.push(t):M(this,bn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(M(this,os).delete(t)){const r=_c(t);if(typeof r=="string"){const n=M(this,bn).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&M(this,bn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=_c(t);if(typeof r=="string"){const n=M(this,bn).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=_c(t);if(typeof r=="string"){const s=(n=M(this,bn).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){$t.batch(()=>{M(this,os).forEach(t=>{this.notify({type:"removed",mutation:t})}),M(this,os).clear(),M(this,bn).clear()})}getAll(){return Array.from(M(this,os))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>iy(r,n))}findAll(t={}){return this.getAll().filter(r=>iy(t,r))}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return $t.batch(()=>Promise.all(t.map(r=>r.continue().catch(rn))))}},os=new WeakMap,bn=new WeakMap,Fu=new WeakMap,ev);function _c(e){var t;return(t=e.options.scope)==null?void 0:t.id}function uy(e){return{onFetch:(t,r)=>{var d,h,f,p,g;const n=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],l=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let y=!1;const E=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},x=b2(t.options,t.fetchOptions),b=async(v,_,k)=>{if(y)return Promise.reject();if(_==null&&v.pages.length)return Promise.resolve(v);const S={client:t.client,queryKey:t.queryKey,pageParam:_,direction:k?"backward":"forward",meta:t.options.meta};E(S);const I=await x(S),{maxPages:j}=t.options,P=k?sC:nC;return{pages:P(v.pages,I,j),pageParams:P(v.pageParams,_,j)}};if(s&&i.length){const v=s==="backward",_=v?pC:cy,k={pages:i,pageParams:l},S=_(n,k);o=await b(k,S,v)}else{const v=e??i.length;do{const _=u===0?l[0]??n.initialPageParam:cy(n,o);if(u>0&&_==null)break;o=await b(o,_),u++}while(u<v)}return o};t.options.persister?t.fetchFn=()=>{var y,E;return(E=(y=t.options).persister)==null?void 0:E.call(y,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function cy(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function pC(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var jt,Ys,Qs,fl,ml,Ks,pl,gl,tv,gC=(tv=class{constructor(e={}){Te(this,jt);Te(this,Ys);Te(this,Qs);Te(this,fl);Te(this,ml);Te(this,Ks);Te(this,pl);Te(this,gl);be(this,jt,e.queryCache||new hC),be(this,Ys,e.mutationCache||new mC),be(this,Qs,e.defaultOptions||{}),be(this,fl,new Map),be(this,ml,new Map),be(this,Ks,0)}mount(){lc(this,Ks)._++,M(this,Ks)===1&&(be(this,pl,K0.subscribe(async e=>{e&&(await this.resumePausedMutations(),M(this,jt).onFocus())})),be(this,gl,Rd.subscribe(async e=>{e&&(await this.resumePausedMutations(),M(this,jt).onOnline())})))}unmount(){var e,t;lc(this,Ks)._--,M(this,Ks)===0&&((e=M(this,pl))==null||e.call(this),be(this,pl,void 0),(t=M(this,gl))==null||t.call(this),be(this,gl,void 0))}isFetching(e){return M(this,jt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return M(this,Ys).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=M(this,jt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=M(this,jt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Ji(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return M(this,jt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=M(this,jt).get(n.queryHash),i=s==null?void 0:s.state.data,l=tC(t,i);if(l!==void 0)return M(this,jt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return $t.batch(()=>M(this,jt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=M(this,jt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=M(this,jt);$t.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=M(this,jt);return $t.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=$t.batch(()=>M(this,jt).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(rn).catch(rn)}invalidateQueries(e,t={}){return $t.batch(()=>(M(this,jt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=$t.batch(()=>M(this,jt).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(rn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(rn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=M(this,jt).build(this,t);return r.isStaleByTime(Ji(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(rn).catch(rn)}fetchInfiniteQuery(e){return e.behavior=uy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(rn).catch(rn)}ensureInfiniteQueryData(e){return e.behavior=uy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Rd.isOnline()?M(this,Ys).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,jt)}getMutationCache(){return M(this,Ys)}getDefaultOptions(){return M(this,Qs)}setDefaultOptions(e){be(this,Qs,e)}setQueryDefaults(e,t){M(this,fl).set(oi(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...M(this,fl).values()],r={};return t.forEach(n=>{hu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){M(this,ml).set(oi(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...M(this,ml).values()],r={};return t.forEach(n=>{hu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...M(this,Qs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Y0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Q0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...M(this,Qs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){M(this,jt).clear(),M(this,Ys).clear()}},jt=new WeakMap,Ys=new WeakMap,Qs=new WeakMap,fl=new WeakMap,ml=new WeakMap,Ks=new WeakMap,pl=new WeakMap,gl=new WeakMap,tv),Cr,Xe,Uu,xr,Qa,xl,Zs,Xs,Bu,yl,bl,Ka,Za,Js,vl,st,vo,ip,lp,op,up,cp,dp,hp,S2,rv,xC=(rv=class extends Bl{constructor(t,r){super();Te(this,st);Te(this,Cr);Te(this,Xe);Te(this,Uu);Te(this,xr);Te(this,Qa);Te(this,xl);Te(this,Zs);Te(this,Xs);Te(this,Bu);Te(this,yl);Te(this,bl);Te(this,Ka);Te(this,Za);Te(this,Js);Te(this,vl,new Set);this.options=r,be(this,Cr,t),be(this,Xs,null),be(this,Zs,ap()),this.options.experimental_prefetchInRender||M(this,Zs).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,Xe).addObserver(this),dy(M(this,Xe),this.options)?He(this,st,vo).call(this):this.updateResult(),He(this,st,up).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return fp(M(this,Xe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return fp(M(this,Xe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,He(this,st,cp).call(this),He(this,st,dp).call(this),M(this,Xe).removeObserver(this)}setOptions(t){const r=this.options,n=M(this,Xe);if(this.options=M(this,Cr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Nn(this.options.enabled,M(this,Xe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");He(this,st,hp).call(this),M(this,Xe).setOptions(this.options),r._defaulted&&!Id(this.options,r)&&M(this,Cr).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,Xe),observer:this});const s=this.hasListeners();s&&hy(M(this,Xe),n,this.options,r)&&He(this,st,vo).call(this),this.updateResult(),s&&(M(this,Xe)!==n||Nn(this.options.enabled,M(this,Xe))!==Nn(r.enabled,M(this,Xe))||Ji(this.options.staleTime,M(this,Xe))!==Ji(r.staleTime,M(this,Xe)))&&He(this,st,ip).call(this);const i=He(this,st,lp).call(this);s&&(M(this,Xe)!==n||Nn(this.options.enabled,M(this,Xe))!==Nn(r.enabled,M(this,Xe))||i!==M(this,Js))&&He(this,st,op).call(this,i)}getOptimisticResult(t){const r=M(this,Cr).getQueryCache().build(M(this,Cr),t),n=this.createResult(r,t);return bC(this,n)&&(be(this,xr,n),be(this,xl,this.options),be(this,Qa,M(this,Xe).state)),n}getCurrentResult(){return M(this,xr)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){M(this,vl).add(t)}getCurrentQuery(){return M(this,Xe)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=M(this,Cr).defaultQueryOptions(t),n=M(this,Cr).getQueryCache().build(M(this,Cr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return He(this,st,vo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,xr)))}createResult(t,r){var P;const n=M(this,Xe),s=this.options,i=M(this,xr),l=M(this,Qa),o=M(this,xl),c=t!==n?t.state:M(this,Uu),{state:d}=t;let h={...d},f=!1,p;if(r._optimisticResults){const T=this.hasListeners(),H=!T&&dy(t,r),O=T&&hy(t,n,r,s);(H||O)&&(h={...h,...k2(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:E}=h;p=h.data;let x=!1;if(r.placeholderData!==void 0&&p===void 0&&E==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,x=!0):T=typeof r.placeholderData=="function"?r.placeholderData((P=M(this,bl))==null?void 0:P.state.data,M(this,bl)):r.placeholderData,T!==void 0&&(E="success",p=sp(i==null?void 0:i.data,T,r),f=!0)}if(r.select&&p!==void 0&&!x)if(i&&p===(l==null?void 0:l.data)&&r.select===M(this,Bu))p=M(this,yl);else try{be(this,Bu,r.select),p=r.select(p),p=sp(i==null?void 0:i.data,p,r),be(this,yl,p),be(this,Xs,null)}catch(T){be(this,Xs,T)}M(this,Xs)&&(g=M(this,Xs),p=M(this,yl),y=Date.now(),E="error");const b=h.fetchStatus==="fetching",v=E==="pending",_=E==="error",k=v&&b,S=p!==void 0,j={status:E,fetchStatus:h.fetchStatus,isPending:v,isSuccess:E==="success",isError:_,isInitialLoading:k,isLoading:k,data:p,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:b,isRefetching:b&&!v,isLoadingError:_&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&S,isStale:Z0(t,r),refetch:this.refetch,promise:M(this,Zs)};if(this.options.experimental_prefetchInRender){const T=q=>{j.status==="error"?q.reject(j.error):j.data!==void 0&&q.resolve(j.data)},H=()=>{const q=be(this,Zs,j.promise=ap());T(q)},O=M(this,Zs);switch(O.status){case"pending":t.queryHash===n.queryHash&&T(O);break;case"fulfilled":(j.status==="error"||j.data!==O.value)&&H();break;case"rejected":(j.status!=="error"||j.error!==O.reason)&&H();break}}return j}updateResult(){const t=M(this,xr),r=this.createResult(M(this,Xe),this.options);if(be(this,Qa,M(this,Xe).state),be(this,xl,this.options),M(this,Qa).data!==void 0&&be(this,bl,M(this,Xe)),Id(r,t))return;be(this,xr,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!M(this,vl).size)return!0;const l=new Set(i??M(this,vl));return this.options.throwOnError&&l.add("error"),Object.keys(M(this,xr)).some(o=>{const u=o;return M(this,xr)[u]!==t[u]&&l.has(u)})};He(this,st,S2).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&He(this,st,up).call(this)}},Cr=new WeakMap,Xe=new WeakMap,Uu=new WeakMap,xr=new WeakMap,Qa=new WeakMap,xl=new WeakMap,Zs=new WeakMap,Xs=new WeakMap,Bu=new WeakMap,yl=new WeakMap,bl=new WeakMap,Ka=new WeakMap,Za=new WeakMap,Js=new WeakMap,vl=new WeakMap,st=new WeakSet,vo=function(t){He(this,st,hp).call(this);let r=M(this,Xe).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(rn)),r},ip=function(){He(this,st,cp).call(this);const t=Ji(this.options.staleTime,M(this,Xe));if(li||M(this,xr).isStale||!rp(t))return;const n=x2(M(this,xr).dataUpdatedAt,t)+1;be(this,Ka,setTimeout(()=>{M(this,xr).isStale||this.updateResult()},n))},lp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,Xe)):this.options.refetchInterval)??!1},op=function(t){He(this,st,dp).call(this),be(this,Js,t),!(li||Nn(this.options.enabled,M(this,Xe))===!1||!rp(M(this,Js))||M(this,Js)===0)&&be(this,Za,setInterval(()=>{(this.options.refetchIntervalInBackground||K0.isFocused())&&He(this,st,vo).call(this)},M(this,Js)))},up=function(){He(this,st,ip).call(this),He(this,st,op).call(this,He(this,st,lp).call(this))},cp=function(){M(this,Ka)&&(clearTimeout(M(this,Ka)),be(this,Ka,void 0))},dp=function(){M(this,Za)&&(clearInterval(M(this,Za)),be(this,Za,void 0))},hp=function(){const t=M(this,Cr).getQueryCache().build(M(this,Cr),this.options);if(t===M(this,Xe))return;const r=M(this,Xe);be(this,Xe,t),be(this,Uu,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},S2=function(t){$t.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(M(this,xr))}),M(this,Cr).getQueryCache().notify({query:M(this,Xe),type:"observerResultsUpdated"})})},rv);function yC(e,t){return Nn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function dy(e,t){return yC(e,t)||e.state.data!==void 0&&fp(e,t,t.refetchOnMount)}function fp(e,t,r){if(Nn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Z0(e,t)}return!1}function hy(e,t,r,n){return(e!==t||Nn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Z0(e,r)}function Z0(e,t){return Nn(t.enabled,e)!==!1&&e.isStaleByTime(Ji(t.staleTime,e))}function bC(e,t){return!Id(e.getCurrentResult(),t)}var ea,ta,jr,us,ms,td,mp,nv,vC=(nv=class extends Bl{constructor(r,n){super();Te(this,ms);Te(this,ea);Te(this,ta);Te(this,jr);Te(this,us);be(this,ea,r),this.setOptions(n),this.bindMethods(),He(this,ms,td).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=M(this,ea).defaultMutationOptions(r),Id(this.options,n)||M(this,ea).getMutationCache().notify({type:"observerOptionsUpdated",mutation:M(this,jr),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&oi(n.mutationKey)!==oi(this.options.mutationKey)?this.reset():((s=M(this,jr))==null?void 0:s.state.status)==="pending"&&M(this,jr).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=M(this,jr))==null||r.removeObserver(this)}onMutationUpdate(r){He(this,ms,td).call(this),He(this,ms,mp).call(this,r)}getCurrentResult(){return M(this,ta)}reset(){var r;(r=M(this,jr))==null||r.removeObserver(this),be(this,jr,void 0),He(this,ms,td).call(this),He(this,ms,mp).call(this)}mutate(r,n){var s;return be(this,us,n),(s=M(this,jr))==null||s.removeObserver(this),be(this,jr,M(this,ea).getMutationCache().build(M(this,ea),this.options)),M(this,jr).addObserver(this),M(this,jr).execute(r)}},ea=new WeakMap,ta=new WeakMap,jr=new WeakMap,us=new WeakMap,ms=new WeakSet,td=function(){var n;const r=((n=M(this,jr))==null?void 0:n.state)??_2();be(this,ta,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},mp=function(r){$t.batch(()=>{var n,s,i,l,o,u,c,d;if(M(this,us)&&this.hasListeners()){const h=M(this,ta).variables,f=M(this,ta).context;(r==null?void 0:r.type)==="success"?((s=(n=M(this,us)).onSuccess)==null||s.call(n,r.data,h,f),(l=(i=M(this,us)).onSettled)==null||l.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((u=(o=M(this,us)).onError)==null||u.call(o,r.error,h,f),(d=(c=M(this,us)).onSettled)==null||d.call(c,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(M(this,ta))})})},nv),T2=w.createContext(void 0),hn=e=>{const t=w.useContext(T2);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},C2=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(T2.Provider,{value:e,children:t})),j2=w.createContext(!1),wC=()=>w.useContext(j2);j2.Provider;function EC(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var NC=w.createContext(EC()),kC=()=>w.useContext(NC);function A2(e,t){return typeof e=="function"?e(...t):!!e}function pp(){}var _C=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},SC=e=>{w.useEffect(()=>{e.clearReset()},[e])},TC=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||A2(r,[e.error,n])),CC=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},jC=(e,t)=>e.isLoading&&e.isFetching&&!t,AC=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,fy=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function IC(e,t,r){var h,f,p,g,y;const n=hn(),s=wC(),i=kC(),l=n.defaultQueryOptions(e);(f=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",CC(l),_C(l,i),SC(i);const o=!n.getQueryCache().get(l.queryHash),[u]=w.useState(()=>new t(n,l)),c=u.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(E=>{const x=d?u.subscribe($t.batchCalls(E)):pp;return u.updateResult(),x},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(l)},[l,u]),AC(l,c))throw fy(l,u,i);if(TC({result:c,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((g=(p=n.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||g.call(p,l,c),l.experimental_prefetchInRender&&!li&&jC(c,s)){const E=o?fy(l,u,i):(y=n.getQueryCache().get(l.queryHash))==null?void 0:y.promise;E==null||E.catch(pp).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function Ut(e,t){return IC(e,xC)}function At(e,t){const r=hn(),[n]=w.useState(()=>new vC(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const s=w.useSyncExternalStore(w.useCallback(l=>n.subscribe($t.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((l,o)=>{n.mutate(l,o).catch(pp)},[n]);if(s.error&&A2(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fu(){return fu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fu.apply(this,arguments)}var sa;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sa||(sa={}));const my="popstate";function RC(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return gp("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Ld(s)}return OC(t,r,null,e)}function Pt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function I2(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function LC(){return Math.random().toString(36).substr(2,8)}function py(e,t){return{usr:e.state,key:e.key,idx:t}}function gp(e,t,r,n){return r===void 0&&(r=null),fu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Hl(t):t,{state:r,key:t&&t.key||n||LC()})}function Ld(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Hl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function OC(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=sa.Pop,u=null,c=d();c==null&&(c=0,l.replaceState(fu({},l.state,{idx:c}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=sa.Pop;let E=d(),x=E==null?null:E-c;c=E,u&&u({action:o,location:y.location,delta:x})}function f(E,x){o=sa.Push;let b=gp(y.location,E,x);c=d()+1;let v=py(b,c),_=y.createHref(b);try{l.pushState(v,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(_)}i&&u&&u({action:o,location:y.location,delta:1})}function p(E,x){o=sa.Replace;let b=gp(y.location,E,x);c=d();let v=py(b,c),_=y.createHref(b);l.replaceState(v,"",_),i&&u&&u({action:o,location:y.location,delta:0})}function g(E){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof E=="string"?E:Ld(E);return b=b.replace(/ $/,"%20"),Pt(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let y={get action(){return o},get location(){return e(s,l)},listen(E){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(my,h),u=E,()=>{s.removeEventListener(my,h),u=null}},createHref(E){return t(s,E)},createURL:g,encodeLocation(E){let x=g(E);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(E){return l.go(E)}};return y}var gy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(gy||(gy={}));function PC(e,t,r){return r===void 0&&(r="/"),DC(e,t,r)}function DC(e,t,r,n){let s=typeof t=="string"?Hl(t):t,i=X0(s.pathname||"/",r);if(i==null)return null;let l=R2(e);MC(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=QC(i);o=WC(l[u],c)}return o}function R2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(Pt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=ma([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(Pt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),R2(i.children,t,d,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:qC(c,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of L2(i.path))s(i,l,u)}),t}function L2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=L2(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function MC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:VC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const FC=/^:[\w-]+$/,UC=3,BC=2,HC=1,$C=10,zC=-2,xy=e=>e==="*";function qC(e,t){let r=e.split("/"),n=r.length;return r.some(xy)&&(n+=zC),t&&(n+=BC),r.filter(s=>!xy(s)).reduce((s,i)=>s+(FC.test(i)?UC:i===""?HC:$C),n)}function VC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function WC(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=GC({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),l.push({params:s,pathname:ma([i,h.pathname]),pathnameBase:JC(ma([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ma([i,h.pathnameBase]))}return l}function GC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=YC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let y=o[h]||"";l=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[h];return p&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function YC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),I2(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function QC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return I2(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function X0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function KC(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Hl(e):e;return{pathname:r?r.startsWith("/")?r:ZC(r,t):t,search:ej(n),hash:tj(s)}}function ZC(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Nf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XC(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function J0(e,t){let r=XC(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function eg(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Hl(e):(s=fu({},e),Pt(!s.pathname||!s.pathname.includes("?"),Nf("?","pathname","search",s)),Pt(!s.pathname||!s.pathname.includes("#"),Nf("#","pathname","hash",s)),Pt(!s.search||!s.search.includes("#"),Nf("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let u=KC(s,o),c=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const ma=e=>e.join("/").replace(/\/\/+/g,"/"),JC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ej=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function rj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const O2=["post","put","patch","delete"];new Set(O2);const nj=["get",...O2];new Set(nj);/**
 * React Router v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mu(){return mu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mu.apply(this,arguments)}const tg=w.createContext(null),sj=w.createContext(null),_a=w.createContext(null),mh=w.createContext(null),Es=w.createContext({outlet:null,matches:[],isDataRoute:!1}),P2=w.createContext(null);function aj(e,t){let{relative:r}=t===void 0?{}:t;$l()||Pt(!1);let{basename:n,navigator:s}=w.useContext(_a),{hash:i,pathname:l,search:o}=M2(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:ma([n,l])),s.createHref({pathname:u,search:o,hash:i})}function $l(){return w.useContext(mh)!=null}function Sa(){return $l()||Pt(!1),w.useContext(mh).location}function D2(e){w.useContext(_a).static||w.useLayoutEffect(e)}function fn(){let{isDataRoute:e}=w.useContext(Es);return e?yj():ij()}function ij(){$l()||Pt(!1);let e=w.useContext(tg),{basename:t,future:r,navigator:n}=w.useContext(_a),{matches:s}=w.useContext(Es),{pathname:i}=Sa(),l=JSON.stringify(J0(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return D2(()=>{o.current=!0}),w.useCallback(function(c,d){if(d===void 0&&(d={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=eg(c,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ma([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,l,i,e])}function rg(){let{matches:e}=w.useContext(Es),t=e[e.length-1];return t?t.params:{}}function M2(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(_a),{matches:s}=w.useContext(Es),{pathname:i}=Sa(),l=JSON.stringify(J0(s,n.v7_relativeSplatPath));return w.useMemo(()=>eg(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function lj(e,t){return oj(e,t)}function oj(e,t,r,n){$l()||Pt(!1);let{navigator:s}=w.useContext(_a),{matches:i}=w.useContext(Es),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=Sa(),d;if(t){var h;let E=typeof t=="string"?Hl(t):t;u==="/"||(h=E.pathname)!=null&&h.startsWith(u)||Pt(!1),d=E}else d=c;let f=d.pathname||"/",p=f;if(u!=="/"){let E=u.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let g=PC(e,{pathname:p}),y=fj(g&&g.map(E=>Object.assign({},E,{params:Object.assign({},o,E.params),pathname:ma([u,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?u:ma([u,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,r,n);return t&&y?w.createElement(mh.Provider,{value:{location:mu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:sa.Pop}},y):y}function uj(){let e=xj(),t=rj(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const cj=w.createElement(uj,null);class dj extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(Es.Provider,{value:this.props.routeContext},w.createElement(P2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hj(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(tg);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(Es.Provider,{value:t},n)}function fj(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Pt(!1),l=l.slice(0,Math.min(l.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:p}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||g){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let p,g=!1,y=null,E=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,y=h.route.errorElement||cj,u&&(c<0&&f===0?(bj("route-fallback"),g=!0,E=null):c===f&&(g=!0,E=h.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),b=()=>{let v;return p?v=y:g?v=E:h.route.Component?v=w.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=d,w.createElement(hj,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(dj,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var F2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(F2||{}),U2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(U2||{});function mj(e){let t=w.useContext(tg);return t||Pt(!1),t}function pj(e){let t=w.useContext(sj);return t||Pt(!1),t}function gj(e){let t=w.useContext(Es);return t||Pt(!1),t}function B2(e){let t=gj(),r=t.matches[t.matches.length-1];return r.route.id||Pt(!1),r.route.id}function xj(){var e;let t=w.useContext(P2),r=pj(),n=B2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function yj(){let{router:e}=mj(F2.UseNavigateStable),t=B2(U2.UseNavigateStable),r=w.useRef(!1);return D2(()=>{r.current=!0}),w.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,mu({fromRouteId:t},i)))},[e,t])}const yy={};function bj(e,t,r){yy[e]||(yy[e]=!0)}const by={};function vj(e,t){by[t]||(by[t]=!0,console.warn(t))}const vy=(e,t,r)=>vj(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function wj(e,t){(e==null?void 0:e.v7_startTransition)===void 0&&vy("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&vy("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Po(e){let{to:t,replace:r,state:n,relative:s}=e;$l()||Pt(!1);let{future:i,static:l}=w.useContext(_a),{matches:o}=w.useContext(Es),{pathname:u}=Sa(),c=fn(),d=eg(t,J0(o,i.v7_relativeSplatPath),u,s==="path"),h=JSON.stringify(d);return w.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function en(e){Pt(!1)}function Ej(e){let{basename:t="/",children:r=null,location:n,navigationType:s=sa.Pop,navigator:i,static:l=!1,future:o}=e;$l()&&Pt(!1);let u=t.replace(/^\/*/,"/"),c=w.useMemo(()=>({basename:u,navigator:i,static:l,future:mu({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Hl(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:g="default"}=n,y=w.useMemo(()=>{let E=X0(d,u);return E==null?null:{location:{pathname:E,search:h,hash:f,state:p,key:g},navigationType:s}},[u,d,h,f,p,g,s]);return y==null?null:w.createElement(_a.Provider,{value:c},w.createElement(mh.Provider,{children:r,value:y}))}function wy(e){let{children:t,location:r}=e;return lj(xp(t),r)}new Promise(()=>{});function xp(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let i=[...t,s];if(n.type===w.Fragment){r.push.apply(r,xp(n.props.children,i));return}n.type!==en&&Pt(!1),!n.props.index||!n.props.children||Pt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=xp(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yp.apply(this,arguments)}function Nj(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function kj(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _j(e,t){return e.button===0&&(!t||t==="_self")&&!kj(e)}const Sj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Tj="6";try{window.__reactRouterVersion=Tj}catch{}const Cj="startTransition",Ey=z_[Cj];function jj(e){let{basename:t,children:r,future:n,window:s}=e,i=w.useRef();i.current==null&&(i.current=RC({window:s,v5Compat:!0}));let l=i.current,[o,u]=w.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},d=w.useCallback(h=>{c&&Ey?Ey(()=>u(h)):u(h)},[u,c]);return w.useLayoutEffect(()=>l.listen(d),[l,d]),w.useEffect(()=>wj(n),[n]),w.createElement(Ej,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const Aj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ij=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bp=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:d,viewTransition:h}=t,f=Nj(t,Sj),{basename:p}=w.useContext(_a),g,y=!1;if(typeof c=="string"&&Ij.test(c)&&(g=c,Aj))try{let v=new URL(window.location.href),_=c.startsWith("//")?new URL(v.protocol+c):new URL(c),k=X0(_.pathname,p);_.origin===v.origin&&k!=null?c=k+_.search+_.hash:y=!0}catch{}let E=aj(c,{relative:s}),x=Rj(c,{replace:l,state:o,target:u,preventScrollReset:d,relative:s,viewTransition:h});function b(v){n&&n(v),v.defaultPrevented||x(v)}return w.createElement("a",yp({},f,{href:g||E,onClick:y||i?n:b,ref:r,target:u}))});var Ny;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ny||(Ny={}));var ky;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ky||(ky={}));function Rj(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=fn(),c=Sa(),d=M2(e,{relative:l});return w.useCallback(h=>{if(_j(h,r)){h.preventDefault();let f=n!==void 0?n:Ld(c)===Ld(d);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,d,n,s,r,e,i,l,o])}const Lj="modulepreload",Oj=function(e){return"/"+e},_y={},Cl=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=Oj(u),u in _y)return;_y[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Lj,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Pj=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Cl(async()=>{const{default:n}=await Promise.resolve().then(()=>zl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ng extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Dj extends ng{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Mj extends ng{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Fj extends ng{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var vp;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(vp||(vp={}));var Uj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class Bj{constructor(t,{headers:r={},customFetch:n,region:s=vp.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Pj(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Uj(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:l}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let c;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=l):typeof l=="string"?(o["Content-Type"]="text/plain",c=l):typeof FormData<"u"&&l instanceof FormData?c=l:(o["Content-Type"]="application/json",c=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(g=>{throw new Dj(g)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Mj(d);if(!d.ok)throw new Fj(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var Ir={},sg={},ph={},Wu={},gh={},xh={},Hj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},jl=Hj();const $j=jl.fetch,H2=jl.fetch.bind(jl),$2=jl.Headers,zj=jl.Request,qj=jl.Response,zl=Object.freeze(Object.defineProperty({__proto__:null,Headers:$2,Request:zj,Response:qj,default:H2,fetch:$j},Symbol.toStringTag,{value:"Module"})),Vj=T_(zl);var yh={};Object.defineProperty(yh,"__esModule",{value:!0});let Wj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};yh.default=Wj;var z2=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xh,"__esModule",{value:!0});const Gj=z2(Vj),Yj=z2(yh);let Qj=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Gj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,u;let c=null,d=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const y=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),E=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");y&&E&&E.length>1&&(h=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const y=await i.text();try{c=JSON.parse(y),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,p="OK")}catch{i.status===404&&y===""?(f=204,p="No Content"):c={message:y}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new Yj.default(c)}return{error:c,data:d,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var l,o,u;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};xh.default=Qj;var Kj=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gh,"__esModule",{value:!0});const Zj=Kj(xh);let Xj=class extends Zj.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:l="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${c}"; options=${u};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};gh.default=Xj;var Jj=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wu,"__esModule",{value:!0});const e3=Jj(gh);let t3=class extends e3.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Wu.default=t3;var r3=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ph,"__esModule",{value:!0});const io=r3(Wu);let n3=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&(this.headers.Prefer=`count=${n}`),new io.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new io.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const l="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new io.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new io.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new io.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ph.default=n3;var bh={},vh={};Object.defineProperty(vh,"__esModule",{value:!0});vh.version=void 0;vh.version="0.0.0-automated";Object.defineProperty(bh,"__esModule",{value:!0});bh.DEFAULT_HEADERS=void 0;const s3=vh;bh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${s3.version}`};var q2=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sg,"__esModule",{value:!0});const a3=q2(ph),i3=q2(Wu),l3=bh;let o3=class V2{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},l3.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new a3.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new V2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let l;const o=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new i3.default({method:l,url:o,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};sg.default=o3;var ql=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.PostgrestError=Ir.PostgrestBuilder=Ir.PostgrestTransformBuilder=Ir.PostgrestFilterBuilder=Ir.PostgrestQueryBuilder=Ir.PostgrestClient=void 0;const W2=ql(sg);Ir.PostgrestClient=W2.default;const G2=ql(ph);Ir.PostgrestQueryBuilder=G2.default;const Y2=ql(Wu);Ir.PostgrestFilterBuilder=Y2.default;const Q2=ql(gh);Ir.PostgrestTransformBuilder=Q2.default;const K2=ql(xh);Ir.PostgrestBuilder=K2.default;const Z2=ql(yh);Ir.PostgrestError=Z2.default;var u3=Ir.default={PostgrestClient:W2.default,PostgrestQueryBuilder:G2.default,PostgrestFilterBuilder:Y2.default,PostgrestTransformBuilder:Q2.default,PostgrestBuilder:K2.default,PostgrestError:Z2.default};const{PostgrestClient:c3,PostgrestQueryBuilder:rH,PostgrestFilterBuilder:nH,PostgrestTransformBuilder:sH,PostgrestBuilder:aH,PostgrestError:iH}=u3,d3="2.11.2",h3={"X-Client-Info":`realtime-js/${d3}`},f3="1.0.0",X2=1e4,m3=1e3;var el;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(el||(el={}));var Hr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Hr||(Hr={}));var wn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(wn||(wn={}));var wp;(function(e){e.websocket="websocket"})(wp||(wp={}));var Ma;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ma||(Ma={}));class p3{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const c=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class J2{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ht;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ht||(ht={}));const Sy=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,l)=>(i[l]=g3(l,e,t,s),i),{})},g3=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?eE(i,l):Ep(l)},eE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return v3(t,r)}switch(e){case ht.bool:return x3(t);case ht.float4:case ht.float8:case ht.int2:case ht.int4:case ht.int8:case ht.numeric:case ht.oid:return y3(t);case ht.json:case ht.jsonb:return b3(t);case ht.timestamp:return w3(t);case ht.abstime:case ht.date:case ht.daterange:case ht.int4range:case ht.int8range:case ht.money:case ht.reltime:case ht.text:case ht.time:case ht.timestamptz:case ht.timetz:case ht.tsrange:case ht.tstzrange:return Ep(t);default:return Ep(t)}},Ep=e=>e,x3=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},y3=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},b3=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},v3=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>eE(t,o))}return e},w3=e=>typeof e=="string"?e.replace(" ","T"):e,tE=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class kf{constructor(t,r,n={},s=X2){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ty;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ty||(Ty={}));class Do{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Do.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=Do.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Do.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,d)=>{l[c]||(u[c]=d)}),this.map(l,(c,d)=>{const h=i[c];if(h){const f=d.map(E=>E.presence_ref),p=h.map(E=>E.presence_ref),g=d.filter(E=>p.indexOf(E.presence_ref)<0),y=h.filter(E=>f.indexOf(E.presence_ref)<0);g.length>0&&(o[c]=g),y.length>0&&(u[c]=y)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),d.length>0){const h=t[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);t[o].unshift(...f)}n(o,d,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Cy;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Cy||(Cy={}));var jy;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(jy||(jy={}));var as;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(as||(as={}));class ag{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new kf(this,wn.join,this.params,this.timeout),this.rejoinTimer=new J2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Hr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wn.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Do(this),this.broadcastEndpointURL=tE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:l,private:o}}=this.params;this._onError(d=>t==null?void 0:t(as.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(as.CLOSED));const u={},c={broadcast:i,presence:l,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(as.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,g=[];for(let y=0;y<p;y++){const E=f[y],{filter:{event:x,schema:b,table:v,filter:_}}=E,k=d&&d[y];if(k&&k.event===x&&k.schema===b&&k.table===v&&k.filter===_)g.push(Object.assign(Object.assign({},E),{id:k.id}));else{this.unsubscribe(),t==null||t(as.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(as.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(as.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(as.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Hr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new kf(this,wn.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new kf(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:d}=wn;if(n&&[o,u,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,y,E;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((E=(y=p.filter)===null||y===void 0?void 0:y.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(p=>p.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(p=>{var g,y,E,x,b,v;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in p){const _=p.id,k=(g=p.filter)===null||g===void 0?void 0:g.event;return _&&((y=r.ids)===null||y===void 0?void 0:y.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const _=(b=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return _==="*"||_===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===l}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:y,table:E,commit_timestamp:x,type:b,errors:v}=g;f=Object.assign(Object.assign({},{schema:y,table:E,commit_timestamp:x,eventType:b,new:{},old:{},errors:v}),this._getPayloadRecords(g))}p.callback(f,n)})}_isClosed(){return this.state===Hr.closed}_isJoined(){return this.state===Hr.joined}_isJoining(){return this.state===Hr.joining}_isLeaving(){return this.state===Hr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&ag.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(wn.close,{},t)}_onError(t){this._on(wn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Sy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Sy(t.columns,t.old_record)),r}}const E3=()=>{},N3=typeof WebSocket<"u",k3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _3{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=h3,this.params={},this.timeout=X2,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=E3,this.conn=null,this.sendBuffer=[],this.serializer=new p3,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...o)=>Cl(async()=>{const{default:u}=await Promise.resolve().then(()=>zl);return{default:u}},void 0).then(({default:u})=>u(...o)):l=fetch,(...o)=>l(...o)},this.endPoint=`${t}/${wp.websocket}`,this.httpEndpoint=tE(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,l)=>l(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new J2(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(N3){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new S3(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Cl(async()=>{const{default:t}=await import("./browser-DCwyxYxa.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:f3}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case el.connecting:return Ma.Connecting;case el.open:return Ma.Open;case el.closing:return Ma.Closing;default:return Ma.Closed}}isConnected(){return this.connectionState()===Ma.Open}channel(t,r={config:{}}){const n=new ag(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(wn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(m3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:l}=r;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${l&&"("+l+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,l)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(wn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([k3],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class S3{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=el.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class ig extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Qt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class T3 extends ig{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Np extends ig{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var C3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const rE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Cl(async()=>{const{default:n}=await Promise.resolve().then(()=>zl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},j3=()=>C3(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Cl(()=>Promise.resolve().then(()=>zl),void 0)).Response:Response}),kp=e=>{if(Array.isArray(e))return e.map(r=>kp(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=kp(n)}),t};var xi=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const _f=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),A3=(e,t,r)=>xi(void 0,void 0,void 0,function*(){const n=yield j3();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new T3(_f(s),e.status||500))}).catch(s=>{t(new Np(_f(s),s))}):t(new Np(_f(e),e))}),I3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Gu(e,t,r,n,s,i){return xi(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,I3(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>A3(u,o,n))})})}function Od(e,t,r,n){return xi(this,void 0,void 0,function*(){return Gu(e,"GET",t,r,n)})}function Bs(e,t,r,n,s){return xi(this,void 0,void 0,function*(){return Gu(e,"POST",t,n,s,r)})}function R3(e,t,r,n,s){return xi(this,void 0,void 0,function*(){return Gu(e,"PUT",t,n,s,r)})}function L3(e,t,r,n){return xi(this,void 0,void 0,function*(){return Gu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function nE(e,t,r,n,s){return xi(this,void 0,void 0,function*(){return Gu(e,"DELETE",t,n,s,r)})}var _r=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const O3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ay={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class P3{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=rE(s)}uploadOrUpdate(t,r,n,s){return _r(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Ay),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Qt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return _r(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return _r(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:Ay.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(Qt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return _r(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Bs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new ig("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}update(t,r,n){return _r(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return _r(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return _r(this,void 0,void 0,function*(){try{return{data:{path:(yield Bs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return _r(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Bs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return _r(this,void 0,void 0,function*(){try{const s=yield Bs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}download(t,r){return _r(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Od(this.fetch,`${this.url}/${s}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Qt(o))return{data:null,error:o};throw o}})}info(t){return _r(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Od(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:kp(n),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}exists(t){return _r(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield L3(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Qt(n)&&n instanceof Np){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return _r(this,void 0,void 0,function*(){try{return{data:yield nE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}list(t,r,n){return _r(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},O3),r),{prefix:t||""});return{data:yield Bs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const D3="2.7.1",M3={"X-Client-Info":`storage-js/${D3}`};var ki=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class F3{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},M3),r),this.fetch=rE(n)}listBuckets(){return ki(this,void 0,void 0,function*(){try{return{data:yield Od(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Qt(t))return{data:null,error:t};throw t}})}getBucket(t){return ki(this,void 0,void 0,function*(){try{return{data:yield Od(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ki(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ki(this,void 0,void 0,function*(){try{return{data:yield R3(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ki(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ki(this,void 0,void 0,function*(){try{return{data:yield nE(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}}class U3 extends F3{constructor(t,r={},n){super(t,r,n)}from(t){return new P3(this.url,this.headers,t,this.fetch)}}const B3="2.49.4";let wo="";typeof Deno<"u"?wo="deno":typeof document<"u"?wo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wo="react-native":wo="node";const H3={"X-Client-Info":`supabase-js-${wo}/${B3}`},$3={headers:H3},z3={schema:"public"},q3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},V3={};var W3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const G3=e=>{let t;return e?t=e:typeof fetch>"u"?t=H2:t=fetch,(...r)=>t(...r)},Y3=()=>typeof Headers>"u"?$2:Headers,Q3=(e,t,r)=>{const n=G3(r),s=Y3();return(i,l)=>W3(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},l),{headers:c}))})};var K3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};function Z3(e){return e.replace(/\/$/,"")}function X3(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:l,auth:o,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>K3(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const sE="2.69.1",Ai=30*1e3,_p=3,Sf=_p*Ai,J3="http://localhost:9999",eA="supabase.auth.token",tA={"X-Client-Info":`gotrue-js/${sE}`},Sp="X-Supabase-Api-Version",aE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nA=6e5;class lg extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Be(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class sA extends lg{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function aA(e){return Be(e)&&e.name==="AuthApiError"}class iE extends lg{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ta extends lg{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Os extends Ta{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function iA(e){return Be(e)&&e.name==="AuthSessionMissingError"}class Tf extends Ta{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Sc extends Ta{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Tc extends Ta{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lA(e){return Be(e)&&e.name==="AuthImplicitGrantRedirectError"}class Iy extends Ta{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Tp extends Ta{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Cf(e){return Be(e)&&e.name==="AuthRetryableFetchError"}class Ry extends Ta{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Mo extends Ta{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ly="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Oy=` 	
\r=`.split(""),oA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Oy.length;t+=1)e[Oy[t].charCodeAt(0)]=-2;for(let t=0;t<Ly.length;t+=1)e[Ly[t].charCodeAt(0)]=t;return e})();function lE(e,t,r){const n=oA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Py(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{dA(l,n,r)};for(let l=0;l<e.length;l+=1)lE(e.charCodeAt(l),s,i);return t.join("")}function uA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function cA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}uA(n,t)}}function dA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function hA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)lE(e.charCodeAt(s),r,n);return new Uint8Array(t)}function fA(e){const t=[];return cA(e,r=>t.push(r)),new Uint8Array(t)}function mA(e){return Math.round(Date.now()/1e3)+e}function pA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Pn=()=>typeof window<"u"&&typeof document<"u",Ia={tested:!1,writable:!1},Fo=()=>{if(!Pn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ia.tested)return Ia.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ia.tested=!0,Ia.writable=!0}catch{Ia.tested=!0,Ia.writable=!1}return Ia.writable};function gA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const oE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Cl(async()=>{const{default:n}=await Promise.resolve().then(()=>zl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},xA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",uE=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Cc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},jc=async(e,t)=>{await e.removeItem(t)};class wh{constructor(){this.promise=new wh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}wh.promiseConstructor=Promise;function jf(e){const t=e.split(".");if(t.length!==3)throw new Mo("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!rA.test(t[n]))throw new Mo("JWT not in base64url format");return{header:JSON.parse(Py(t[0])),payload:JSON.parse(Py(t[1])),signature:hA(t[2]),raw:{header:t[0],payload:t[1]}}}async function yA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function bA(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function vA(e){return("0"+e.toString(16)).substr(-2)}function wA(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,vA).join("")}async function EA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function NA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await EA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _i(e,t,r=!1){const n=wA();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await uE(e,`${t}-code-verifier`,s);const i=await NA(n);return[i,n===i?"plain":"s256"]}const kA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _A(e){const t=e.headers.get(Sp);if(!t||!t.match(kA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function SA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function TA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var CA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Da=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),jA=[502,503,504];async function Dy(e){var t;if(!xA(e))throw new Tp(Da(e),0);if(jA.includes(e.status))throw new Tp(Da(e),e.status);let r;try{r=await e.json()}catch(i){throw new iE(Da(i),i)}let n;const s=_A(e);if(s&&s.getTime()>=aE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ry(Da(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Os}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Ry(Da(r),e.status,r.weak_password.reasons);throw new sA(Da(r),e.status||500,n)}const AA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ze(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Sp]||(i[Sp]=aE["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await IA(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function IA(e,t,r,n,s,i){const l=AA(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new Tp(Da(u),0)}if(o.ok||await Dy(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await Dy(u)}}function Ps(e){var t;let r=null;PA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=mA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function My(e){const t=Ps(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function qs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function RA(e){return{data:e,error:null}}function LA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=CA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function OA(e){return e}function PA(e){return e.access_token&&e.refresh_token&&e.expires_in}var DA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class MA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=oE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Be(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qs})}catch(n){if(Be(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=DA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:LA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Be(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ze(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:qs})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},d=await Ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:OA});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,p=(u=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(g.split(";")[1].split("=")[1]);c[`${E}Page`]=y}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Be(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ze(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:qs})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ze(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:qs})}catch(n){if(Be(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:qs})}catch(n){if(Be(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ze(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Be(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}}const FA={getItem:e=>Fo()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Fo()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Fo()&&globalThis.localStorage.removeItem(e)}};function Fy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function UA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Si={debug:!!(globalThis&&Fo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class BA extends cE{}async function HA(e,t,r){Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Si.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Si.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new BA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Si.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}UA();const $A={url:J3,storageKey:eA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Uy(e,t,r){return await r()}class pu{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=pu.nextInstanceID,pu.nextInstanceID+=1,this.instanceID>0&&Pn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},$A),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new MA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=oE(s.fetch),this.lock=s.lock||Uy,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Pn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=HA:this.lock=Uy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Fo()?this.storage=FA:(this.memoryStorage={},this.storage=Fy(this.memoryStorage)):(this.memoryStorage={},this.storage=Fy(this.memoryStorage)),Pn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${sE}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=gA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Pn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lA(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Be(r)?{error:r}:{error:new iE("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ps}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Be(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await _i(this.storage,this.storageKey)),i=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:Ps})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ps})}else throw new Sc("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Be(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:My})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:My})}else throw new Sc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Tf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Be(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Cc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:l}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ps});if(await jc(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Tf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(Be(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ps}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Tf}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(Be(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await _i(this.storage,this.storageKey));const{error:h}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:d}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Sc("You must provide either an email or phone number.")}catch(o){if(Be(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ps});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Be(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await _i(this.storage,this.storageKey)),await Ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:RA})}catch(i){if(Be(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Os;const{error:s}=await Ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await Ze(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await Ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new Sc("You must provide either an email or phone number and a type")}catch(r){if(Be(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Cc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Sf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!l&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:qs}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Os}:await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:qs})})}catch(r){if(Be(r))return iA(r)&&(await this._removeSession(),await jc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Os;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await _i(this.storage,this.storageKey));const{data:c,error:d}=await Ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:qs});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Be(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Os;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=jf(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Be(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Os;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Be(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Pn())throw new Tc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Tc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Iy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Tc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Iy("No code detected.");const{data:b,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new Tc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;u&&(f=parseInt(u));const p=f-d;p*1e3<=Ai&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=f-h;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:y,error:E}=await this._getUser(i);if(E)throw E;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Be(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Cc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(aA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await jc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=pA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await _i(this.storage,this.storageKey,!0));try{return await Ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Be(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Ze(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Pn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Be(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await Ze(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Be(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await bA(async s=>(s>0&&await yA(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ps})),(s,i)=>{const l=200*Math.pow(2,s);return i&&Cf(i)&&Date.now()+l-n<Ai})}catch(n){if(this._debug(r,"error",n),Be(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Pn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Cc(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Sf;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Sf}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Cf(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Os;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new wh;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Os;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Be(i)){const l={session:null,error:i};return Cf(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await uE(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await jc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Pn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ai);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Ai);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ai}ms, refresh threshold is ${_p} ticks`),s<=_p&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof cE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await _i(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ze(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Be(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await Ze(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Be(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await Ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(Be(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Be(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=jf(s.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n||(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+nA>Date.now()))return n;const{data:s,error:i}=await Ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Mo("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(l=>l.kid===t),!n)throw new Mo("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=jf(n);if(SA(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:l},error:null}}const c=TA(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,l,fA(`${o}.${u}`)))throw new Mo("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if(Be(n))return{data:null,error:n};throw n}}}pu.nextInstanceID=0;const zA=pu;class qA extends zA{constructor(t){super(t)}}var VA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class WA{constructor(t,r,n){var s,i,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=Z3(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:z3,realtime:V3,auth:Object.assign(Object.assign({},q3),{storageKey:u}),global:$3},d=X3(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=Q3(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new c3(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Bj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new U3(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return VA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:l,lock:o,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:l,lock:o,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new _3(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const GA=(e,t,r)=>new WA(e,t,r),YA="https://tkenxulvmzhhkuhfvcpt.supabase.co",QA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrZW54dWx2bXpoaGt1aGZ2Y3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgwOTEwNzgsImV4cCI6MjA1MzY2NzA3OH0.UJPzvtHD6k6rJ09BlFYkdYEyHC3sx3h1rpAG8DULSHI",Af={maxRetries:3,retryDelay:1e3,retryCondition:e=>{var t,r,n,s,i;return(e==null?void 0:e.status)===500||(e==null?void 0:e.status)===503||(e==null?void 0:e.status)===504||(e==null?void 0:e.status)===429||((t=e==null?void 0:e.message)==null?void 0:t.includes("Database error"))||((r=e==null?void 0:e.message)==null?void 0:r.includes("unexpected_failure"))||((n=e==null?void 0:e.message)==null?void 0:n.includes("schema"))||((s=e==null?void 0:e.message)==null?void 0:s.includes("network"))||((i=e==null?void 0:e.message)==null?void 0:i.includes("timeout"))}},te=GA(YA,QA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"dragonbane_auth",flowType:"implicit"},global:{headers:{"X-Client-Info":"dragonbane-character-manager"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}},maxRetries:Af.maxRetries,retryDelay:Af.retryDelay,retryCondition:Af.retryCondition});te.auth.onAuthStateChange((e,t)=>{(e==="USER_DELETED"||e==="SIGNED_OUT")&&console.log("Auth event:",e),e==="TOKEN_REFRESHED"&&console.log("Token refreshed successfully"),e==="SIGNED_OUT"&&!t&&console.error("Auth error: Session ended unexpectedly")});window.addEventListener("online",()=>{te.auth.startAutoRefresh()});window.addEventListener("offline",()=>{te.auth.stopAutoRefresh()});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),dE=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ZA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},u)=>w.createElement("svg",{ref:u,...ZA,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:dE("lucide",s),...o},[...l.map(([c,d])=>w.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=(e,t)=>{const r=w.forwardRef(({className:n,...s},i)=>w.createElement(XA,{ref:i,iconNode:t,className:dE(`lucide-${KA(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=re("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=re("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mE=re("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z",key:"wvr1b5"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}],["path",{d:"M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5",key:"xk3gvk"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=re("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pE=re("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=re("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=re("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=re("BookUser",[["path",{d:"M15 13a3 3 0 1 0-6 0",key:"10j68g"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=re("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=re("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=re("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gE=re("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=re("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=re("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=re("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=re("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=re("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=re("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=re("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=re("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=re("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=re("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=re("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=re("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=re("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=re("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=re("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=re("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=re("Dice4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=re("Dice6",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=re("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=re("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=re("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=re("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=re("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=re("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=re("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=re("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=re("HeartCrack",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"m12 13-1-1 2-2-3-3 2-2",key:"xjdxli"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=re("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=re("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=re("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=re("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=re("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=re("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=re("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=re("LampDesk",[["path",{d:"m14 5-3 3 2 7 8-8-7-2Z",key:"1b0msb"}],["path",{d:"m14 5-3 3-3-3 3-3 3 3Z",key:"1uemms"}],["path",{d:"M9.5 6.5 4 12l3 6",key:"1bx08v"}],["path",{d:"M3 22v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2H3Z",key:"wap775"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=re("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=re("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=re("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=re("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=re("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=re("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=re("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=re("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=re("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=re("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=re("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=re("Notebook",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=re("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=re("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=re("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=re("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=re("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=re("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=re("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=re("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=re("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=re("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=re("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=re("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=re("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=re("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=re("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=re("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=re("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=re("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=re("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=re("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ap=re("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=re("SquareMinus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=re("SquareUser",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 21v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2",key:"1m6ac2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=re("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=re("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=re("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=re("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=re("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=re("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=re("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=re("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=re("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=re("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=re("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=re("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=re("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=re("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=re("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=re("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=re("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=re("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),jE=w.createContext(void 0);function B4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(!1),[i,l]=w.useState(null);return a.jsxs(jE.Provider,{value:{setGlobalError:r,setGlobalLoading:s,setGlobalWarning:l},children:[n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})})}),i&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ku,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-yellow-700",children:i})}),a.jsx("button",{onClick:()=>l(null),className:"text-yellow-500 hover:text-yellow-700",children:a.jsx(Dt,{className:"w-5 h-5"})})]})})}),t&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(qt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-700",children:t})}),a.jsx("button",{onClick:()=>r(null),className:"text-red-500 hover:text-red-700",children:a.jsx(Dt,{className:"w-5 h-5"})})]})})}),e]})}function AE(){const e=w.useContext(jE);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}async function H4(e,t,r,n){const{data:s,error:i}=await te.auth.signUp({email:e,password:t,options:{data:{username:r.trim(),role:n}}});if(i)throw i.message.includes("User already registered")?new Error("An account with this email already exists."):(console.error("Sign up error (auth):",i.message),new Error(`Authentication error: ${i.message}`));if(!s.user)throw console.error("Sign up error: User object not returned after sign up."),new Error("Sign up failed: Could not retrieve user information.");const{error:l}=await te.from("users").insert({id:s.user.id,username:r.trim(),role:n,email:e});if(l)throw console.error("Sign up error (profile creation):",l.message),new Error(`Account created, but failed to set up user profile: ${l.message}. Please contact support.`);return s.user}async function $4(e,t){const{data:r,error:n}=await te.auth.signInWithPassword({email:e,password:t});if(n)throw n;if(r.user){const{error:s}=await te.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.user.id);s&&console.error("Failed to update user timestamps on login:",s.message)}if(!r.session){const{data:s,error:i}=await te.auth.getSession();if(i)throw i;return{user:r.user,session:s.session}}return{user:r.user,session:r.session}}async function z4(){const{error:e}=await te.auth.signOut();if(e)throw console.error("Sign out error:",e.message),e}const Qy=["player","dm","admin"],IE=w.createContext(void 0);function Vt(){const e=w.useContext(IE);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function q4({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState(!0),[c,d]=w.useState(!1),h=fn(),{setGlobalError:f}=AE(),p=w.useCallback(async k=>{var S,I,j;try{const{data:P,error:T}=await te.auth.getSession();if(T)console.error("[fetchUserRole] Error getting session for metadata check:",T.message);else{const $=(j=(I=(S=P==null?void 0:P.session)==null?void 0:S.user)==null?void 0:I.user_metadata)==null?void 0:j.role;if($&&Qy.includes($))return $}const{data:H,error:O,status:q}=await te.from("users").select("role").eq("id",k).single();if(O)return O.code==="PGRST116"||q===404?"player":q===401||q===403?(f("Permission issue accessing user data. Please contact support if this persists."),"player"):(console.error("[fetchUserRole] Database error fetching role from table:",O),f("Failed to retrieve user role data due to a database error."),"player");const G=H==null?void 0:H.role;return G&&Qy.includes(G)?G:"player"}catch(P){return console.error("[fetchUserRole] Unexpected error during role fetch process:",P),f("Failed to determine user role due to an unexpected error."),"player"}},[f]);w.useEffect(()=>{u(!0),te.auth.getSession().then(({data:{session:k}})=>{s(k),r((k==null?void 0:k.user)??null),k!=null&&k.user||u(!1)}).catch(k=>{console.error("Error getting initial session:",k),f("Failed to initialize user session."),s(null),r(null),l(null),u(!1)})},[]),w.useEffect(()=>{const{data:k}=te.auth.onAuthStateChange(async(S,I)=>{const j=(I==null?void 0:I.user)??null;s(I),r(j),S==="SIGNED_OUT"?(l(null),u(!1),f(null),h("/login")):S==="SIGNED_IN"&&window.location.pathname==="/login"&&j&&h("/")});return()=>{var S;(S=k==null?void 0:k.subscription)==null||S.unsubscribe()}},[h,f]),w.useEffect(()=>{t?(o||u(!0),p(t.id).then(k=>{l(k)}).catch(k=>{l("player")}).finally(()=>{u(!1)})):(l(null),o&&u(!1))},[t,p]);const g=async(k,S,I,j)=>{try{d(!0),f(null),await H4(k,S,I,j)}catch(P){throw f(P instanceof Error?P.message:"Signup failed"),P}finally{d(!1)}},y=async(k,S)=>{try{d(!0),f(null),await $4(k,S)}catch(I){let j="Authentication failed. Please check your credentials.";throw I instanceof Error&&(I.message.includes("Invalid login credentials")?j="Incorrect email or password.":I.message.includes("Email not confirmed")?j="Please verify your email address before logging in.":I.message.includes("network error")||I.message.includes("Failed to fetch")?j="Network error. Please check your connection and try again.":j=I.message.length>100?"An unexpected authentication error occurred.":I.message),f(j),new Error(j)}finally{d(!1)}},E=w.useCallback(async()=>{if(!c)try{d(!0),await z4()}catch(k){console.error("Sign out error:",k),f("Failed to sign out")}finally{d(!1)}},[f,c]),x=()=>i==="admin",b=()=>i==="dm"||i==="admin",v=()=>i==="player",_=o||c;return a.jsx(IE.Provider,{value:{user:t,session:n,role:i,isLoading:_,signIn:y,signUp:g,signOut:E,isAdmin:x,isDM:b,isPlayer:v},children:e})}const RE=w.createContext(void 0),Ac=30*60*1e3,Ky=30*1e3,V4=10*1e3;function W4({children:e}){const{signOut:t}=Vt(),r=fn(),n=w.useRef(Date.now()),s=w.useRef(null),i=w.useRef(null),[l,o]=w.useState(!1),u=w.useCallback(()=>{s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{o(!0)},Ac-Ky),s.current=setTimeout(async()=>{await t(),r("/login",{state:{message:"Your session has expired due to inactivity."}})},Ac),n.current=Date.now(),o(!1)},[t,r]),c=w.useCallback(()=>{u()},[u]);return w.useEffect(()=>{const d=["mousedown","keydown","scroll","mousemove","click","touchstart"];let h;function f(g,y){let E;return function(...b){const v=()=>{clearTimeout(E),g(...b)};clearTimeout(E),E=setTimeout(v,y)}}const p=f(()=>{Date.now()-n.current>1e3&&u()},1e3);return d.forEach(g=>{document.addEventListener(g,p)}),h=window.setInterval(()=>{const g=Date.now()-n.current;g>=Ac-Ky&&o(!0),g>=Ac&&(t(),r("/login",{state:{message:"Your session has expired due to inactivity."}}))},V4),u(),()=>{d.forEach(g=>{document.removeEventListener(g,p)}),s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),window.clearInterval(h)}},[u,t,r]),a.jsx(RE.Provider,{value:{showWarning:l,extendSession:c},children:e})}function G4(){const e=w.useContext(RE);if(e===void 0)throw new Error("useSessionTimeout must be used within a SessionTimeoutProvider");return e}const Fn=class Fn{constructor(){ic(this,"environment");this.environment="production"}static getInstance(){return Fn.instance||(Fn.instance=new Fn),Fn.instance}logError(t,r={},n="medium"){const s={error:t,context:{...r,timestamp:new Date().toISOString(),path:window.location.pathname},severity:n};this.environment==="development"&&console.error("Error Report:",{message:t.message,stack:t.stack,...s.context,severity:n}),this.environment==="production"&&this.sendToErrorTrackingService(s)}async sendToErrorTrackingService(t){try{console.error("Production Error:",t)}catch(r){console.error("Failed to send error report:",r)}}static handleError(t,r){const n=Fn.getInstance();t instanceof Error?n.logError(t,r):n.logError(new Error(String(t)),r)}static handleNetworkError(t,r){const n=Fn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("network")||t.message.toLowerCase().includes("connection")||t.message.toLowerCase().includes("offline");n.logError(t,{...r,additionalData:{isNetworkError:s}},s?"high":"medium")}}static handleAuthError(t,r){const n=Fn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("auth")||t.message.toLowerCase().includes("unauthorized")||t.message.toLowerCase().includes("forbidden");n.logError(t,{...r,additionalData:{isAuthError:s}},s?"high":"medium")}}};ic(Fn,"instance");let sl=Fn;class Y4 extends w.Component{constructor(r){super(r);ic(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){sl.handleError(r,{action:"render",additionalData:{componentStack:n.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Ku,{className:"w-8 h-8 text-red-500"}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Something went wrong"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. The application has encountered an unexpected error."}),this.state.error&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-red-700 font-mono break-all",children:this.state.error.message||"No error message available"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(NE,{className:"w-5 h-5"}),"Refresh Page"]}),a.jsxs(bp,{to:"/",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(m4,{className:"w-5 h-5"}),"Go Home"]})]})]})}):this.props.children}}const LE=new gC({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1,retry:1}}}),Q4=/(\d+)?d(\d+)/i;function K4(e){const t=e.match(Q4);if(!t){const i=`d${e.replace(/\D/g,"")}`;return["d4","d6","d8","d10","d12","d20"].includes(i)?[i]:(console.warn(`Invalid dice string format: "${e}". Could not parse.`),[])}const r=parseInt(t[1]||"1",10),n=parseInt(t[2],10),s=`d${n}`;return["d4","d6","d8","d10","d12","d20"].includes(s)?Array(r).fill(s):(console.warn(`Invalid die type in string: "d${n}" from "${e}".`),[])}const OE=w.createContext(void 0),Z4=20;function X4({children:e}){const[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState(!1),[h,f]=w.useState(!1),p=w.useCallback(k=>{r(S=>{const I=!S;if(I){const j={...k};j.label&&!j.description&&(j.description=j.label),s(j||null);let P=[];k!=null&&k.dice?P=K4(k.dice):k!=null&&k.initialDice&&(P=k.initialDice),(k==null?void 0:k.rollMode)==="deathRoll"?P=["d20"]:(k==null?void 0:k.rollMode)==="recoveryRoll"?P=["d6"]:(k==null?void 0:k.rollMode)==="rallyRoll"?P=["d20"]:(k==null?void 0:k.rollMode)==="skillCheck"&&P.length===0?P=["d20"]:(k==null?void 0:k.rollMode)==="advancementRoll"&&(P=["d20"]),l(P),d(!1),f((k==null?void 0:k.requiresBane)||(k==null?void 0:k.rollMode)==="rallyRoll"||!1)}else s(null),l([]),d(!1),f(!1);return I})},[]),g=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l(S=>[...S,k]),(c||h)&&(d(!1),f(!1)))},[c,h,n]),y=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||l(S=>{if(S.length===0)return[];if(k){const I=S.lastIndexOf(k);if(I!==-1){const j=[...S];return j.splice(I,1),j}}return S.slice(0,-1)})},[n]),E=w.useCallback(()=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l([]),d(!1),f(!1))},[n]),x=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(d(!0),f(!1),l(["d20"])):d(!1))},[n]),b=w.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(f(!0),d(!1),l(["d20"])):(n==null?void 0:n.rollMode)!=="rallyRoll"&&f(!1))},[n]),v=w.useCallback(k=>{u(S=>{const j=[{...k,id:crypto.randomUUID(),timestamp:Date.now()},...S];return j.length>Z4&&j.pop(),j})},[]),_=w.useCallback(()=>{u([])},[]);return a.jsx(OE.Provider,{value:{showDiceRoller:t,currentConfig:n,dicePool:i,rollHistory:o,isBoonActive:c,isBaneActive:h,toggleDiceRoller:p,addDie:g,removeLastDie:y,clearDicePool:E,setBoon:x,setBane:b,addRollToHistory:v,clearHistory:_},children:e})}function Zn(){const e=w.useContext(OE);if(e===void 0)throw new Error("useDice must be used within a DiceProvider");return e}function J4(){const e=Sa(),{signOut:t,isAdmin:r,isDM:n,role:s}=Vt(),{toggleDiceRoller:i}=Zn(),[l,o]=w.useState(!1),u=w.useRef(null),c=f=>e.pathname===f,d=[{path:"/",label:"Characters",icon:Cn,roles:["player","dm","admin"]},{path:"/compendium",label:"Compendium",icon:Yu,roles:["player","dm","admin"]},{path:"/adventure-party",label:"Adventure Party",icon:ui,roles:["player","dm","admin"]},{path:"/notes",label:"Notes",icon:Al,roles:["player","dm","admin"]},{path:"/settings",label:"Settings",icon:kE,roles:["player","dm","admin"]}],h=()=>{l&&o(!1)};return w.useEffect(()=>{const f=p=>{u.current&&!u.current.contains(p.target)&&o(!1)};return l?document.addEventListener("mousedown",f):document.removeEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[l]),a.jsxs("nav",{className:"bg-gray-800 text-white",ref:u,children:[a.jsx("div",{className:"container mx-auto px-4",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0"}),a.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-4",children:d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(bp,{to:f,onClick:h,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-5 h-5"}),a.jsx("span",{children:p})]},f))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Open Dice Roller",children:[a.jsx(ur,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Dice"})]}),a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700",title:`Current role: ${s}`,children:[r()?a.jsx($y,{className:"w-5 h-5 text-yellow-400"}):n()?a.jsx(bs,{className:"w-5 h-5 text-blue-400"}):a.jsx(Cn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:r()?"Admin":n()?"DM":"Player"})]}),a.jsxs("button",{onClick:()=>{t(),h()},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Log Out",children:[a.jsx(jp,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Log Out"})]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center",children:[a.jsx("button",{onClick:i,className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white mr-2",title:"Open Dice Roller",children:a.jsx(ur,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>o(!l),className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white","aria-expanded":l,"aria-controls":"mobile-menu",children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),l?a.jsx(Dt,{className:"block h-6 w-6"}):a.jsx(v4,{className:"block h-6 w-6"})]})]})]})}),l&&a.jsx("div",{className:"md:hidden absolute top-16 inset-x-0 bg-gray-800 z-50 shadow-lg",id:"mobile-menu",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(bp,{to:f,onClick:h,className:`flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-6 h-6"}),a.jsx("span",{children:p})]},f)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700 w-full",children:r()?a.jsxs(a.Fragment,{children:[a.jsx($y,{className:"w-5 h-5 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}):n()?a.jsxs(a.Fragment,{children:[a.jsx(bs,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-sm font-medium",children:"DM"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Cn,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Player"})]})})}),a.jsxs("button",{onClick:()=>{t(),h()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:[a.jsx(jp,{className:"w-6 h-6"}),a.jsx("span",{children:"Log Out"})]})]})})]})}function e6({character:e}){const t=r=>r>=16?"text-purple-600":r>=14?"text-blue-600":r>=12?"text-green-600":r>=10?"text-yellow-600":"text-gray-600";return a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.kin," ",e.profession]})]}),a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.age})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(bs,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:t(e.attributes.STR),children:e.attributes.STR})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Uo,{className:"w-4 h-4 text-pink-600"}),a.jsx("span",{className:t(e.attributes.CON),children:e.attributes.CON})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pg,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{className:t(e.attributes.AGL),children:e.attributes.AGL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gE,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:t(e.attributes.INT),children:e.attributes.INT})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Yn,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:t(e.attributes.WIL),children:e.attributes.WIL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Cn,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:t(e.attributes.CHA),children:e.attributes.CHA})]})]}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsx("p",{className:"line-clamp-2",children:e.appearance||"No appearance set"})})]})})}const t6={},Zy=e=>{let t;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const p=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(g=>g(t,p))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(t6?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,s,u);return u},r6=e=>e?Zy(e):Zy;var PE={exports:{}},DE={},ME={exports:{}},FE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Il=w;function n6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var s6=typeof Object.is=="function"?Object.is:n6,a6=Il.useState,i6=Il.useEffect,l6=Il.useLayoutEffect,o6=Il.useDebugValue;function u6(e,t){var r=t(),n=a6({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return l6(function(){s.value=r,s.getSnapshot=t,Rf(s)&&i({inst:s})},[e,r,t]),i6(function(){return Rf(s)&&i({inst:s}),e(function(){Rf(s)&&i({inst:s})})},[e]),o6(r),r}function Rf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!s6(e,r)}catch{return!0}}function c6(e,t){return t()}var d6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c6:u6;FE.useSyncExternalStore=Il.useSyncExternalStore!==void 0?Il.useSyncExternalStore:d6;ME.exports=FE;var h6=ME.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ch=w,f6=h6;function m6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var p6=typeof Object.is=="function"?Object.is:m6,g6=f6.useSyncExternalStore,x6=Ch.useRef,y6=Ch.useEffect,b6=Ch.useMemo,v6=Ch.useDebugValue;DE.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=x6(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=b6(function(){function u(p){if(!c){if(c=!0,d=p,p=n(p),s!==void 0&&l.hasValue){var g=l.value;if(s(g,p))return h=g}return h=p}if(g=h,p6(d,p))return g;var y=n(p);return s!==void 0&&s(g,y)?(d=p,g):(d=p,h=y)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,r,n,s]);var o=g6(e,i[0],i[1]);return y6(function(){l.hasValue=!0,l.value=o},[o]),v6(o),o};PE.exports=DE;var w6=PE.exports;const E6=Zd(w6),UE={},{useDebugValue:N6}=_n,{useSyncExternalStoreWithSelector:k6}=E6;let Xy=!1;const _6=e=>e;function S6(e,t=_6,r){(UE?"production":void 0)!=="production"&&r&&!Xy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Xy=!0);const n=k6(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return N6(n),n}const Jy=e=>{(UE?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?r6(e):e,r=(n,s)=>S6(t,n,s);return Object.assign(r,t),r},BE=e=>e?Jy(e):Jy,ks=BE(e=>({step:0,character:{},setStep:t=>e({step:t}),updateCharacter:t=>e(r=>({character:{...r.character,...t}})),resetCharacter:()=>e({character:{},step:0})}));async function T6(){const{data:e,error:t}=await te.from("kin").select("id, name, description, heroic_ability");if(t)throw console.error("Error fetching kin list:",t),new Error(t.message||"Failed to fetch kin list");return e||[]}async function C6(e){if(!e||e.length===0)return[];const t=e.map(s=>s.trim()).filter(s=>s);if(t.length===0)return[];const{data:r,error:n}=await te.from("heroic_abilities").select("id, name, description, willpower_cost, requirement").in("name",t);if(n)throw console.error("Error fetching ability details by names:",n),new Error(n.message||"Failed to fetch ability details");return(r||[]).map(s=>({id:s.id,name:s.name,description:s.description,willpower_cost:s.willpower_cost,requirement:s.requirement}))}function $e({size:e="md",className:t=""}){const r={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-4",lg:"w-12 h-12 border-4"};return a.jsx("div",{className:`flex items-center justify-center ${t}`,role:"status",children:a.jsx("div",{className:`${r[e]} animate-spin rounded-full border-gray-200 border-t-blue-600`,"aria-label":"Loading..."})})}function Ie({message:e,onClose:t}){return e?a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 flex items-start justify-between",role:"alert",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(rl,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{className:"block sm:inline",children:e})]}),t&&a.jsx("button",{onClick:t,className:"ml-4 p-1 text-red-500 hover:text-red-700 hover:bg-red-200 rounded-full transition-colors","aria-label":"Close error message",children:a.jsx(Dt,{className:"w-4 h-4"})})]}):null}const eb=e=>e?e.split(",").map(t=>t.trim()).filter(t=>t):[];function j6(){const{character:e,updateCharacter:t}=ks(),[r,n]=w.useState(null),{data:s=[],isLoading:i,error:l}=Ut({queryKey:["kinListWithHeroicAbility"],queryFn:T6,retry:!1});w.useEffect(()=>{if(e.kin&&s.length>0&&!r){const g=s.find(y=>y.name===e.kin);if(g){n(g.id);const y=eb(g.heroic_ability);JSON.stringify(e.kinAbilityNames)!==JSON.stringify(y)&&t({kinAbilityNames:y})}}},[e.kin,s,r,e.kinAbilityNames,t]);const o=g=>{n(g.id);const y=eb(g.heroic_ability);t({kin:g.name,kinAbilityNames:y})},u=w.useMemo(()=>s.find(g=>g.id===r),[s,r]),c=w.useMemo(()=>e.kinAbilityNames||[],[e.kinAbilityNames]),{data:d=[],isLoading:h,error:f}=Ut({queryKey:["abilityDetails",c.sort().join(",")],queryFn:()=>C6(c),enabled:c.length>0,staleTime:10*60*1e3,retry:!1}),p=g=>a.jsxs("div",{className:"mb-4 p-3 border rounded bg-gray-50 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-md text-gray-800",children:g.name}),g.willpower_cost!=null&&a.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:["Willpower Cost: ",g.willpower_cost]}),g.requirement&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requirement: ",g.requirement]}),a.jsx("p",{className:"text-sm text-gray-700 mt-2",children:g.description})]},g.id);if(i)return a.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:a.jsx($e,{size:"lg"})});if(l){const g=l instanceof Error?l.message:"Failed to load Kin options.";return console.error("Error loading Kin:",l),a.jsx(Ie,{title:"Error Loading Kin",message:g})}return a.jsxs("div",{className:"flex space-x-6 h-[60vh]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Kin List"}),a.jsx("ul",{className:"space-y-1",children:s.map(g=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md text-sm ${r===g.id?"bg-blue-100 font-semibold text-blue-800":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>o(g),children:g.name},g.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:u?a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-1",children:u.name}),a.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:u.description}),a.jsx("hr",{className:"my-4 border-gray-300"}),a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Kin Abilities"}),h?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx($e,{})}):f?a.jsx(Ie,{title:"Error Loading Abilities",message:f.message||"Failed to load ability details."}):d.length>0?d.map(p):c.length>0&&!h?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-orange-600 italic mb-2",children:"Could not fetch full details for the following abilities (check names in database):"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:c.map(g=>a.jsx("li",{children:g},g))})]}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific heroic abilities listed for this Kin."})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"Select a kin from the list to view details and abilities."})})})]})}async function A6(){const{data:e,error:t}=await te.from("professions").select("*").order("name");if(t)throw console.error("Error fetching profession list:",t),new Error(t.message||"Failed to fetch profession list");return e||[]}async function I6(e){const{data:t,error:r}=await te.from("heroic_abilities").select("*").eq("profession",e);if(r)throw console.error("Error fetching heroic abilities:",r),new Error(r.message||"Failed to fetch heroic abilities");return t||[]}async function R6(){const{data:e,error:t}=await te.from("game_spells").select(`
      *,
      magic_schools ( name )
    `).order("name",{ascending:!0});if(t)throw console.error("Error fetching spells:",t),new Error(t.message||"Failed to fetch spells");return e||[]}async function HE(){const{data:e,error:t}=await te.from("magic_schools").select("id, name, description").order("name",{ascending:!0});if(t)throw console.error("Error fetching magic schools:",t),new Error(t.message||"Failed to fetch magic schools");return e||[]}function L6(){const{character:e,updateCharacter:t}=ks(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(null),[u,c]=w.useState(!1),[d,h]=w.useState(null),{data:f=[],isLoading:p,error:g}=Ut({queryKey:["professions"],queryFn:A6}),{data:y=[],isLoading:E,error:x}=Ut({queryKey:["magicSchools"],queryFn:HE});w.useEffect(()=>{if(e.profession&&f.length>0){const I=f.find(j=>j.name===e.profession);if(I&&(n(I),I.magic_school_id===null&&e.professionHeroicAbilityName&&b(I.name,e.professionHeroicAbilityName),e.professionHeroicAbilityName&&s.length>0)){const j=s.find(P=>P.name===e.professionHeroicAbilityName);j&&o(j)}}},[e.profession,f,e.professionHeroicAbilityName]);const b=async(I,j)=>{c(!0),h(null);try{const T=await I6(I);i(T);const H=j??e.professionHeroicAbilityName;if(H){const O=T.find(q=>q.name===H);o(O||null)}else o(null)}catch(P){h(P instanceof Error?P.message:"Failed to load heroic abilities"),i([]),o(null)}finally{c(!1)}};w.useEffect(()=>{r&&r.magic_school_id===null?b(r.name):(i([]),o(null),e.professionHeroicAbilityName&&t({professionHeroicAbilityName:null}))},[r]);const v=I=>{var P;n(I),I.magic_school_id!==null&&((P=y.find(T=>T.id===I.magic_school_id))==null||P.name);const j={profession:I.name,key_attribute:I.key_attribute,magicSchool:I.magic_school_id??null,professionHeroicAbilityName:null};I.magic_school_id!==null&&o(null),t(j)},_=I=>{o(I),t({professionHeroicAbilityName:I.name})},k=I=>{var j;return I===null||y.length===0?null:((j=y.find(P=>P.id===I))==null?void 0:j.name)??`ID: ${I}`},S=(I,j)=>{if(!Array.isArray(I)||I.length===0)return a.jsxs("p",{className:"text-sm text-gray-500",children:["No ",j.toLowerCase()," listed."]});const P=I.filter(T=>typeof T=="string");return P.length===0?a.jsxs("p",{className:"text-sm text-gray-500",children:["No valid ",j.toLowerCase()," listed."]}):a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:P.map((T,H)=>a.jsx("li",{children:T},H))})};return p||E?a.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:a.jsx($e,{size:"lg"})}):g||x?a.jsx(Ie,{message:(g==null?void 0:g.message)||(x==null?void 0:x.message)||"Failed to load required data."}):(r&&console.log("Selected Profession Data:",r),a.jsxs("div",{className:"flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6 h-[80vh]",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 overflow-y-auto max-h-[30vh] md:max-h-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Profession List"}),a.jsx("ul",{className:"space-y-2",children:f.map(I=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md border ${(r==null?void 0:r.id)===I.id?"bg-blue-100 border-blue-300 font-semibold":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>v(I),children:I.name},I.id))})]}),a.jsx("div",{className:"w-full md:w-2/3 md:pl-4 overflow-y-auto max-h-[calc(80vh-30vh-2rem)] md:max-h-full",children:r?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:r.description})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Key Attribute"}),a.jsx("p",{className:"text-gray-700",children:r.key_attribute})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Skills"}),S(r.skills,"Skills")]}),r.starting_equipment&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Starting Equipment"}),S(r.starting_equipment,"Starting Equipment")]}),r.equipment_description&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Equipment Notes"}),S(r.equipment_description,"Equipment Notes")]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Heroic Ability / Magic"}),r.magic_school_id!==null?a.jsxs("p",{className:"text-gray-600",children:["As a mage of the ",a.jsx("strong",{children:k(r.magic_school_id)??"Unknown School"})," school, you don't get a starting heroic ability. Instead, you get your magic."]}):a.jsxs(a.Fragment,{children:[u&&a.jsx($e,{size:"sm"}),d&&a.jsx(Ie,{message:d}),!u&&!d&&s.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(I=>a.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${(l==null?void 0:l.id)===I.id?"border-green-500 bg-green-50 ring-2 ring-green-300":"border-gray-200 hover:border-green-300 hover:bg-green-50"}`,onClick:()=>_(I),children:[a.jsx("h5",{className:"font-semibold text-lg mb-2",children:I.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:I.description}),a.jsxs("p",{className:"text-sm text-blue-600",children:["Willpower Cost: ",I.willpower_cost??"N/A"," WP"]}),I.requirement&&typeof I.requirement=="string"&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requirement: ",I.requirement]})]},I.id))}):!u&&!d&&a.jsx("p",{className:"text-gray-600",children:"No specific heroic abilities listed for this profession, or none available."})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg sticky bottom-0",children:[a.jsxs("p",{className:"text-blue-800 font-medium",children:["Selected: ",a.jsx("strong",{children:r.name}),r.magic_school_id!==null&&a.jsxs(a.Fragment,{children:[" (Magic School: ",a.jsx("strong",{children:k(r.magic_school_id)??"N/A"}),")"]}),r.magic_school_id===null&&e.professionHeroicAbilityName&&a.jsxs(a.Fragment,{children:[" with Heroic Ability: ",a.jsx("strong",{children:e.professionHeroicAbilityName})]})]}),r.magic_school_id===null&&!e.professionHeroicAbilityName&&s.length>0&&!u&&a.jsx("p",{className:"text-amber-700 mt-2 text-sm",children:"Please select a heroic ability above to continue."}),r.magic_school_id===null&&s.length===0&&!u&&!d&&a.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"No heroic ability selection required for this profession."})]})]}):a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500 text-lg",children:"Select a profession from the list to view details."})})})]}))}const Ic={Young:{attributes:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},skillPoints:8},Adult:{attributes:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},skillPoints:10},Old:{attributes:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0},skillPoints:12}};function O6(){const{character:e,updateCharacter:t}=ks(),r=n=>n===0?"No change":n>0?`+${n}`:n;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Details"}),a.jsx("p",{className:"text-gray-600",children:"Choose a name that fits your character's background and select their age category. Age affects your starting attributes and the number of skill points available during character creation."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Character Name"}),a.jsxs("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(yi,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:e.name||"",onChange:n=>t({name:n.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter character name"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Age Category"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Young","Adult","Old"].map(n=>a.jsxs("div",{className:`relative rounded-lg border p-6 cursor-pointer transition-all ${e.age===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>t({age:n}),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(ug,{className:`h-5 w-5 ${e.age===n?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium",children:n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Attribute Modifiers"}),a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:Object.entries(Ic[n].attributes).map(([s,i])=>i!==0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-gray-600",children:[s,":"]}),a.jsx("span",{className:i>0?"text-green-600":"text-red-600",children:r(i)})]},s))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Skill Points"}),a.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[Ic[n].skillPoints," points"]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[n==="Young"&&"Quick to learn, physically developing",n==="Adult"&&"Balanced attributes and experience",n==="Old"&&"Wise and knowledgeable, physically declining"]})]})]},n))})]})]}),(e.name||e.age)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[e.name&&a.jsxs("p",{className:"text-green-800",children:["Name: ",a.jsx("strong",{children:e.name})]}),e.age&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-green-800",children:["Age Category: ",a.jsx("strong",{children:e.age})]}),a.jsxs("p",{className:"text-sm text-green-700",children:["Starting Skill Points: ",a.jsx("strong",{children:Ic[e.age].skillPoints})]}),Object.entries(Ic[e.age].attributes).filter(([n,s])=>s!==0).map(([n,s])=>a.jsxs("p",{className:"text-sm text-green-700",children:[n," Modifier: ",a.jsx("strong",{children:r(s)})]},n))]})]})})]})}const Lf=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,Of=e=>e<=12?"None":e<=15?"+D4":"+D6",Ci=()=>{const e=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return e.sort((t,r)=>r-t),e.slice(0,3).reduce((t,r)=>t+r,0)},P6=()=>({STR:Ci(),CON:Ci(),AGL:Ci(),INT:Ci(),WIL:Ci(),CHA:Ci()}),D6={Young:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},Adult:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},Old:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0}};function M6(){var f,p,g,y,E,x;const{character:e,updateCharacter:t}=ks(),[r,n]=w.useState({STR:{value:((f=e.attributes)==null?void 0:f.STR)||0,baseChance:0},CON:{value:((p=e.attributes)==null?void 0:p.CON)||0,baseChance:0},AGL:{value:((g=e.attributes)==null?void 0:g.AGL)||0,baseChance:0},INT:{value:((y=e.attributes)==null?void 0:y.INT)||0,baseChance:0},WIL:{value:((E=e.attributes)==null?void 0:E.WIL)||0,baseChance:0},CHA:{value:((x=e.attributes)==null?void 0:x.CHA)||0,baseChance:0}}),[s,i]=w.useState(!1),l=b=>e.age?D6[e.age][b]:0,o=(b,v)=>{const _=l(b);return v+_},u=()=>{i(!0);const b=P6(),v=Object.entries(b).reduce((k,[S,I])=>({...k,[S]:o(S,I)}),{}),_=Object.entries(b).reduce((k,[S,I])=>({...k,[S]:{value:I,baseChance:Lf(o(S,I))}}),{});n(_),t({attributes:v,current_hp:v.CON,current_wp:v.WIL,magic_school:e.magicSchool??null}),i(!1)},c=(b,v)=>{const _=Math.max(3,Math.min(18,parseInt(v)||0)),k=o(b,_),S={...r,[b]:{value:_,baseChance:Lf(k)}};n(S);const I=Object.entries(S).reduce((j,[P,{value:T}])=>({...j,[P]:o(P,T)}),{});t({attributes:I,current_hp:I.CON,current_wp:I.WIL,magic_school:e.magicSchool??null})},d=()=>{if(!e.kin||!r.AGL.value)return 0;const b={Human:10,Halfling:8,Dwarf:8,Elf:10,Mallard:8,Wolfkin:12}[e.kin],v=o("AGL",r.AGL.value);let _=0;return v<=6?_=-4:v<=9?_=-2:v<=12?_=0:v<=15?_=2:_=4,b+_},h=e.key_attribute;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Assign Attributes"}),a.jsxs("p",{className:"text-gray-600",children:["Roll or manually enter your character's attributes. Each attribute is determined by rolling 4D6 and removing the lowest die, giving you a score between 3 and 18. ",e.age&&"Age modifiers will be automatically applied."]}),e.profession&&a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-blue-800",children:["Selected Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&a.jsxs(a.Fragment,{children:[" (Key Attribute: ",a.jsx("strong",{children:e.key_attribute}),")"]})]})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?a.jsx(NE,{className:"w-5 h-5 animate-spin"}):a.jsx(ur,{className:"w-5 h-5"}),"Roll All Attributes"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([b,{value:v,baseChance:_}])=>{const k=l(b),S=o(b,v),I=h===b;return a.jsxs("div",{className:`p-4 border rounded-lg shadow-sm bg-white ${I?"bg-yellow-100 border-yellow-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-lg font-medium",children:b}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Base Chance: ",Lf(S)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",min:"3",max:"18",value:v||"",onChange:j=>c(b,j.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),k!==0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Age Modifier:"}),a.jsx("span",{className:k>0?"text-green-600":"text-red-600",children:k>0?`+${k}`:k})]}),v>0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Final Value:"}),a.jsx("span",{className:"font-medium text-blue-600",children:S})]})]}),(b==="STR"||b==="AGL")&&S>12&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Damage Bonus: ",Of(S)]})]},b)})}),e.kin&&Object.values(r).every(b=>b.value>0)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"Movement"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d()})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"STR Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:Of(o("STR",r.STR.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"AGL Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:Of(o("AGL",r.AGL.value))})]})]})}),e.age&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Age Modifiers Applied"}),a.jsxs("p",{className:"text-sm text-amber-700",children:[e.age==="Young"&&"Young: +1 CON, +1 AGL",e.age==="Adult"&&"Adult: No attribute modifiers",e.age==="Old"&&"Old: -2 STR, -2 CON, -2 AGL, +1 INT, +1 WIL"]})]})]})]})}function F6(e){const[t,r]=w.useState([]),[n,s]=w.useState([]),[i,l]=w.useState(!0),[o,u]=w.useState(null);return w.useEffect(()=>{async function c(){try{l(!0),u(null);const{data:d,error:h}=await te.from("game_spells").select("*").eq("rank",0).order("name");if(h)throw h;r(d||[]);let f=te.from("game_spells").select(`
            *,
            magic_schools ( name )
          `).eq("rank",1).order("name");e?f=f.or(`school_id.is.null,school_id.eq.${e}`):f=f.is("school_id",null);const{data:p,error:g}=await f;if(g)throw g;s(p||[])}catch(d){console.error("Error loading spells:",d),u(d instanceof Error?d.message:"Failed to load spells")}finally{l(!1)}}c()},[e]),{tricks:t,spells:n,loading:i,error:o}}const Pf={"6d2d7686-da89-4c42-a763-6b143c1dac60":"Elementalist","b500058b-543f-4c44-a097-911102245236":"Mentalist","e7836c1c-517a-41f8-bd71-92ba20d9c9e1":"Animist"};function U6(){var b;const{character:e,updateCharacter:t}=ks(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState("all"),[u,c]=w.useState(1),d=(b=e.profession)==null?void 0:b.includes("Mage"),h=d&&e.magicSchool?e.magicSchool:null;if(!d)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Only mages can learn and cast spells. Continue to the next step."})});if(h===null)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please go back to the Profession step and select a magic school before choosing spells."})]})]})});const{tricks:f,spells:p,loading:g}=F6(h),y=(v,_)=>{_==="trick"?r.includes(v)?n(r.filter(k=>k!==v)):r.length<3&&n([...r,v]):s.includes(v)?i(s.filter(k=>k!==v)):s.length<3&&i([...s,v])},E=p.filter(v=>l==="general"?v.school_id===null:l==="school"?v.school_id===h:v.rank===u);if(g)return a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(b4,{className:"w-8 h-8 animate-spin text-blue-600"})});const x=()=>{t({spells:{general:[...r,...s.filter(v=>{var _;return((_=p.find(k=>k.name===v))==null?void 0:_.school_id)===null})],school:{name:Pf[h]||"Unknown",spells:s.filter(v=>{var _;return((_=p.find(k=>k.name===v))==null?void 0:_.school_id)===h})}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Magic"}),a.jsxs("p",{className:"text-gray-600",children:["As a newly created mage, you may choose three rank 1 spells and three magic tricks. You can select spells from both General Magic and your chosen school of magic (",Pf[h]||"General",")."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Your Magic School"}),a.jsx("p",{className:"text-sm text-blue-700",children:Pf[h]||"General Magic"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Magic Tricks"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",r.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(v=>{var _;return a.jsxs("div",{onClick:()=>y(v.name,"trick"),className:`p-4 border rounded-lg cursor-pointer transition-all ${r.includes(v.name)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(nl,{className:`w-5 h-5 ${r.includes(v.name)?"text-purple-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=v.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.casting_time]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Rank 1 Spells"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("select",{value:u,onChange:v=>c(parseInt(v.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[...Array(10)].map((v,_)=>a.jsxs("option",{value:_+1,children:["Rank ",_+1]},_+1))}),a.jsx(Ns,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:l,onChange:v=>o(v.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Spells"}),a.jsx("option",{value:"general",children:"General Magic"}),a.jsx("option",{value:"school",children:"School Spells"})]})]})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",s.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(v=>{var _;return a.jsxs("div",{onClick:()=>y(v.name,"spell"),className:`p-4 border rounded-lg cursor-pointer transition-all ${s.includes(v.name)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(nl,{className:`w-5 h-5 ${s.includes(v.name)?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=v.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.range]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement!=="None"&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),(r.length<3||s.length<3)&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select 3 magic tricks and 3 rank 1 spells to continue."})]})]}),a.jsxs("button",{onClick:x,disabled:r.length<3||s.length<3,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(nl,{className:"w-5 h-5"}),"Save Spell Selections"]})]})}function $E(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null);return w.useEffect(()=>{async function l(){n(!0),i(null),console.log("useSkills: Fetching skills...");try{const{data:o,error:u}=await te.from("game_skills").select("*").order("name");if(u)throw console.error("useSkills: Supabase error fetching skills:",u),new Error(u.message||"Failed to fetch skills from database");if(console.log("useSkills: Raw data received from Supabase:",o),Array.isArray(o)){let d=!1;o.forEach((h,f)=>{if(h&&typeof h=="object"){const p=Object.keys(h);p.length>0&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(p[0])&&(!("id"in h)||!("name"in h))&&(console.warn(`useSkills: Potential problematic object structure found at index ${f}:`,h),d=!0),(typeof h.id!="string"||typeof h.name!="string")&&console.warn(`useSkills: Item at index ${f} missing 'id' or 'name', or they have wrong types:`,h)}else console.warn(`useSkills: Invalid non-object item found in fetched data at index ${f}:`,h),d=!0}),d||console.log("useSkills: Initial check of fetched data structure passed.")}else console.warn("useSkills: Fetched data is not an array:",o);const c=Array.isArray(o)?o:[];t(c),console.log(`useSkills: Successfully processed and set ${c.length} skills.`)}catch(o){console.error("useSkills: Error during fetch or processing:",o);const u=o instanceof Error?o.message:"An unknown error occurred while fetching skills";i(u),t([])}finally{n(!1),console.log("useSkills: Fetch finished.")}}l()},[]),{skills:e,loading:r,error:s}}const Rc=e=>{switch(e){case"Young":return 2;case"Adult":return 4;case"Old":return 6;default:return 0}},Df=["Animism","Elementalism","Mentalism"],tb=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"];function B6(){const{character:e,updateCharacter:t}=ks(),{skills:r,loading:n,error:s}=$E(),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState("profession"),[h,f]=w.useState("all"),[p,g]=w.useState([]),[y,E]=w.useState(!1),[x,b]=w.useState(null),v=w.useMemo(()=>{var B;return(B=e.profession)==null?void 0:B.toLowerCase().includes("mage")},[e.profession]),k=(B=>{if(typeof B=="string")return B;if(typeof B=="object"&&B!==null){if("name"in B&&typeof B.name=="string")return B.name;if("id"in B&&typeof B.id=="string")return B.id}return null})(e.magicSchool);w.useEffect(()=>{async function B(){if(!e.profession){g([]);return}E(!0),b(null);try{const{data:L,error:Q}=await te.from("professions").select("skills").eq("name",e.profession).single();if(Q)throw new Error(`Failed to load skills for profession: ${e.profession}. ${Q.message}`);const N=Array.isArray(L==null?void 0:L.skills)?L.skills.filter(K=>typeof K=="string"):[];g(N)}catch(L){const Q=L instanceof Error?L.message:"An unknown error occurred loading profession skills.";b(Q),g([])}finally{E(!1)}}B()},[e.profession]);const S=w.useMemo(()=>n||y||!Array.isArray(r)||!Array.isArray(p)?[]:r.filter(B=>B&&typeof B.name=="string"&&p.includes(B.name)),[r,n,y,p]),I=w.useMemo(()=>{if(n||!Array.isArray(r))return[];let B=r.filter(L=>!(!L||typeof L.name!="string"||i.includes(L.name)));switch(v||(B=B.filter(L=>!Df.includes(L.name))),h){case"combat":return B.filter(L=>tb.includes(L.name));case"general":return B.filter(L=>!tb.includes(L.name)&&!Df.includes(L.name));case"magic":return v?B.filter(L=>Df.includes(L.name)):[];case"all":default:return B}},[r,n,i,h,v]);w.useEffect(()=>{if(e.trainedSkills&&!Array.isArray(e.trainedSkills))console.error("CRITICAL: character.trainedSkills in store is not an array!",e.trainedSkills);else if(e.trainedSkills){const B=e.trainedSkills.filter(L=>typeof L!="string");B.length>0&&console.error("CRITICAL: character.trainedSkills in store contains non-string items!",B)}},[e.trainedSkills]);const j=(B,L)=>{if(typeof B!="string"||!B){console.error("Invalid skillName passed to handleSkillSelection:",B);return}if(L==="profession")i.includes(B)?l(N=>N.filter(K=>K!==B)):i.length<6&&l(N=>[...N,B]);else{const Q=Rc(e.age||"");o.includes(B)?u(N=>N.filter(K=>K!==B)):o.length<Q&&u(N=>[...N,B])}},P=()=>{if(c==="profession"&&i.length===6)d("additional");else if(c==="additional"&&o.length===Rc(e.age||"")){const B=[...new Set([...i,...o])];B.every(L=>typeof L=="string")?(t({trainedSkills:B}),console.log("Skills saved to character state (names):",B)):console.error("CRITICAL: Attempted to save non-string skills to character state!",B)}},T=(B,L)=>{if(!B||typeof B!="object"||typeof B.id!="string"||typeof B.name!="string")return console.error("Invalid skill object passed to renderSkillCard:",B),a.jsx("div",{className:"p-4 border border-red-500 rounded-lg bg-red-50 text-red-700",children:"Invalid Skill Data"});const Q=B.name,N=typeof B.description=="string"?B.description:null,K=typeof B.attribute=="string"?B.attribute:null,Y=L==="profession"?i.includes(Q):o.includes(Q),A=i.length>=6,me=o.length>=Rc(e.age||""),J=L==="profession"&&A&&!Y||L==="additional"&&me&&!Y;return a.jsxs("div",{onClick:()=>!J&&j(Q,L),className:`p-4 border rounded-lg transition-all ${J?"bg-gray-100 opacity-60 cursor-not-allowed":"cursor-pointer"} ${Y?"border-blue-500 bg-blue-50 ring-1 ring-blue-500":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(gu,{className:`w-5 h-5 flex-shrink-0 ${Y?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h5",{className:"font-medium",children:Q}),K&&a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:K})]})]}),N&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N})]},B.id)};if(n)return a.jsx($e,{size:"lg",className:"my-8"});if(s)return a.jsx(Ie,{message:`Skills Error: ${s}`,onClose:()=>{}});if(!e.profession||!e.age)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession and age first."})});if(v&&!e.magicSchool)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"As a Mage, please select a magic school first."})]})]})});const H=i.length,O=o.length,q=6,G=Rc(e.age),$=H===q,z=O===G;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Select Skills"}),e.profession&&a.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-sm",children:[a.jsxs("p",{className:"text-indigo-800",children:["Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&` (Key Attribute: ${e.key_attribute})`,v&&k&&` (School: ${k})`]}),a.jsxs("p",{className:"text-indigo-700 mt-1",children:["Age: ",a.jsx("strong",{children:e.age})," (Grants ",G," additional skill points)"]})]}),a.jsxs("p",{className:"text-gray-600 text-sm",children:[c==="profession"?`Choose ${q} skills from your profession's list below.`:`Choose ${G} additional skills based on your age (${e.age}).`,v&&c==="additional"&&" Magic skills are now available.",!v&&c==="additional"&&" Magic skills are not available for your profession."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Selection Progress"}),a.jsx("p",{className:"text-sm text-blue-700",children:c==="profession"?`Professional Skills: ${H}/${q}`:`Additional Skills: ${O}/${G}`})]})]}),c==="additional"&&a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx(Ns,{className:"w-4 h-4 text-gray-500"}),a.jsx("label",{htmlFor:"skillFilter",className:"text-sm font-medium text-gray-700",children:"Filter:"}),a.jsxs("select",{id:"skillFilter",value:h,onChange:B=>f(B.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Available"}),a.jsx("option",{value:"combat",children:"Combat"}),a.jsx("option",{value:"general",children:"General"}),v&&a.jsx("option",{value:"magic",children:"Magic"})]})]}),c==="profession"&&y&&a.jsx($e,{size:"md",className:"my-4"}),c==="profession"&&x&&a.jsx(Ie,{message:`Profession Skills Error: ${x}`,onClose:()=>b(null)}),!y&&!x&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c==="profession"&&(Array.isArray(S)?S.map(B=>T(B,"profession")):(console.error("Error: availableProfessionSkillsData is not an array!",S),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Profession skills data is not an array."}))),c==="additional"&&(Array.isArray(I)?I.map(B=>T(B,"additional")):(console.error("Error: remainingSkillsData is not an array!",I),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Remaining skills data is not an array."}))),c==="profession"&&S.length===0&&!y&&!x&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No specific skills found for the selected profession, or skills failed to load."}),c==="additional"&&I.length===0&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No skills match the current filter or selection."})]}),(c==="profession"&&!$&&H>0||c==="additional"&&!z&&O>0)&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:c==="profession"?`Please select ${q-H} more professional skill(s).`:`Please select ${G-O} more additional skill(s).`})]})]}),a.jsxs("button",{onClick:P,disabled:c==="profession"&&!$||c==="additional"&&!z||y,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[y?a.jsx(Vs,{className:"w-5 h-5 animate-spin"}):a.jsx(gu,{className:"w-5 h-5"}),c==="profession"?"Continue to Additional Skills":"Confirm Skill Selections"]})]})}function zE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=zE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function qE(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=zE(e))&&(n&&(n+=" "),n+=t);return n}const rb=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,nb=qE,H6=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return nb(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(c=>{const d=r==null?void 0:r[c],h=i==null?void 0:i[c];if(d===null)return null;const f=rb(d)||rb(h);return s[c][f]}),o=r&&Object.entries(r).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(g=>{let[y,E]=g;return Array.isArray(E)?E.includes({...i,...o}[y]):{...i,...o}[y]===E})?[...c,h,f]:c},[]);return nb(e,l,u,r==null?void 0:r.class,r==null?void 0:r.className)},gg="-",$6=e=>{const t=q6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(gg);return o[0]===""&&o.length!==1&&o.shift(),VE(o,t)||z6(l)},getConflictingClassGroupIds:(l,o)=>{const u=r[l]||[];return o&&n[l]?[...u,...n[l]]:u}}},VE=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?VE(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(gg);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},sb=/^\[(.+)\]$/,z6=e=>{if(sb.test(e)){const t=sb.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},q6=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return W6(Object.entries(e.classGroups),r).forEach(([i,l])=>{Ip(l,n,i,t)}),n},Ip=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:ab(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(V6(s)){Ip(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{Ip(l,ab(t,i),r,n)})})},ab=(e,t)=>{let r=e;return t.split(gg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},V6=e=>e.isThemeGetter,W6=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,G6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},WE="!",Y6=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const u=[];let c=0,d=0,h;for(let E=0;E<o.length;E++){let x=o[E];if(c===0){if(x===s&&(n||o.slice(E,E+i)===t)){u.push(o.slice(d,E)),d=E+i;continue}if(x==="/"){h=E;continue}}x==="["?c++:x==="]"&&c--}const f=u.length===0?o:o.substring(d),p=f.startsWith(WE),g=p?f.substring(1):f,y=h&&h>d?h-d:void 0;return{modifiers:u,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}};return r?o=>r({className:o,parseClassName:l}):l},Q6=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},K6=e=>({cache:G6(e.cacheSize),parseClassName:Y6(e),...$6(e)}),Z6=/\s+/,X6=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(Z6);let o="";for(let u=l.length-1;u>=0;u-=1){const c=l[u],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(c);let g=!!p,y=n(g?f.substring(0,p):f);if(!y){if(!g){o=c+(o.length>0?" "+o:o);continue}if(y=n(f),!y){o=c+(o.length>0?" "+o:o);continue}g=!1}const E=Q6(d).join(":"),x=h?E+WE:E,b=x+y;if(i.includes(b))continue;i.push(b);const v=s(y,g);for(let _=0;_<v.length;++_){const k=v[_];i.push(x+k)}o=c+(o.length>0?" "+o:o)}return o};function J6(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=GE(t))&&(n&&(n+=" "),n+=r);return n}const GE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=GE(e[n]))&&(r&&(r+=" "),r+=t);return r};function e5(e,...t){let r,n,s,i=l;function l(u){const c=t.reduce((d,h)=>h(d),e());return r=K6(c),n=r.cache.get,s=r.cache.set,i=o,o(u)}function o(u){const c=n(u);if(c)return c;const d=X6(u,r);return s(u,d),d}return function(){return i(J6.apply(null,arguments))}}const xt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},YE=/^\[(?:([a-z-]+):)?(.+)\]$/i,t5=/^\d+\/\d+$/,r5=new Set(["px","full","screen"]),n5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,s5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,a5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,i5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,l5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,es=e=>al(e)||r5.has(e)||t5.test(e),As=e=>Vl(e,"length",p5),al=e=>!!e&&!Number.isNaN(Number(e)),Mf=e=>Vl(e,"number",al),oo=e=>!!e&&Number.isInteger(Number(e)),o5=e=>e.endsWith("%")&&al(e.slice(0,-1)),Ue=e=>YE.test(e),Is=e=>n5.test(e),u5=new Set(["length","size","percentage"]),c5=e=>Vl(e,u5,QE),d5=e=>Vl(e,"position",QE),h5=new Set(["image","url"]),f5=e=>Vl(e,h5,x5),m5=e=>Vl(e,"",g5),uo=()=>!0,Vl=(e,t,r)=>{const n=YE.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},p5=e=>s5.test(e)&&!a5.test(e),QE=()=>!1,g5=e=>i5.test(e),x5=e=>l5.test(e),y5=()=>{const e=xt("colors"),t=xt("spacing"),r=xt("blur"),n=xt("brightness"),s=xt("borderColor"),i=xt("borderRadius"),l=xt("borderSpacing"),o=xt("borderWidth"),u=xt("contrast"),c=xt("grayscale"),d=xt("hueRotate"),h=xt("invert"),f=xt("gap"),p=xt("gradientColorStops"),g=xt("gradientColorStopPositions"),y=xt("inset"),E=xt("margin"),x=xt("opacity"),b=xt("padding"),v=xt("saturate"),_=xt("scale"),k=xt("sepia"),S=xt("skew"),I=xt("space"),j=xt("translate"),P=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",Ue,t],O=()=>[Ue,t],q=()=>["",es,As],G=()=>["auto",al,Ue],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],B=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",Ue],N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[al,Ue];return{cacheSize:500,separator:":",theme:{colors:[uo],spacing:[es,As],blur:["none","",Is,Ue],brightness:K(),borderColor:[e],borderRadius:["none","","full",Is,Ue],borderSpacing:O(),borderWidth:q(),contrast:K(),grayscale:Q(),hueRotate:K(),invert:Q(),gap:O(),gradientColorStops:[e],gradientColorStopPositions:[o5,As],inset:H(),margin:H(),opacity:K(),padding:O(),saturate:K(),scale:K(),sepia:Q(),skew:K(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",Ue]}],container:["container"],columns:[{columns:[Is]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),Ue]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",oo,Ue]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ue]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",oo,Ue]}],"grid-cols":[{"grid-cols":[uo]}],"col-start-end":[{col:["auto",{span:["full",oo,Ue]},Ue]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[uo]}],"row-start-end":[{row:["auto",{span:[oo,Ue]},Ue]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ue]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ue,t]}],"min-w":[{"min-w":[Ue,t,"min","max","fit"]}],"max-w":[{"max-w":[Ue,t,"none","full","min","max","fit","prose",{screen:[Is]},Is]}],h:[{h:[Ue,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ue,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ue,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ue,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Is,As]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Mf]}],"font-family":[{font:[uo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ue]}],"line-clamp":[{"line-clamp":["none",al,Mf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",es,Ue]}],"list-image":[{"list-image":["none",Ue]}],"list-style-type":[{list:["none","disc","decimal",Ue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",es,As]}],"underline-offset":[{"underline-offset":["auto",es,Ue]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),d5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",c5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},f5]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[es,Ue]}],"outline-w":[{outline:[es,As]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[es,As]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Is,m5]}],"shadow-color":[{shadow:[uo]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...B(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":B()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Is,Ue]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[v]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ue]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",Ue]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[oo,Ue]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ue]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ue]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ue]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[es,As,Mf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},b5=e5(y5);function v5(...e){return b5(qE(e))}const w5=H6("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",danger:"bg-red-600 text-white hover:bg-red-700",danger_outline:"border border-red-500 text-red-600 hover:bg-red-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"primary",size:"default"}}),U=_n.forwardRef(({className:e,variant:t,size:r,icon:n,iconPosition:s="left",fullWidth:i,loading:l,children:o,...u},c)=>{const d=l||u.disabled;return a.jsxs("button",{className:v5(w5({variant:t,size:r,className:e}),i&&"w-full",l&&"relative"),ref:c,disabled:d,...u,children:[l&&a.jsx(Vs,{className:`animate-spin h-4 w-4 ${o?s==="left"?"mr-2":"ml-2":""}`}),!l&&n&&s==="left"&&a.jsx(n,{className:`h-4 w-4 ${o?"mr-2":""}`}),!l&&o,!l&&n&&s==="right"&&a.jsx(n,{className:`h-4 w-4 ${o?"ml-2":""}`})]})});U.displayName="Button";async function jh(e){let t=te.from("game_items").select("*");e&&e!=="all"&&typeof e=="string"&&(t=t.eq("category",e.toUpperCase()));const{data:r,error:n}=await t.order("category").order("name");if(n)throw console.error("Error fetching game items:",n),new Error(n.message||"Failed to fetch game items");return r||[]}function ib(e){const t={gold:0,silver:0,copper:0};if(!e||typeof e!="string")return t;const r=e.toLowerCase().split(/,\s*|\s+/);for(let n=0;n<r.length;n++){const s=parseInt(r[n]);if(!isNaN(s)&&n+1<r.length){const i=r[n+1];i.startsWith("gold")||i.startsWith("g")?(t.gold=s,n++):i.startsWith("silver")||i.startsWith("s")?(t.silver=s,n++):(i.startsWith("copper")||i.startsWith("c"))&&(t.copper=s,n++)}}return KE(t)}function E5(e){if(!e)return"0 copper";const t=[];return e.gold>0&&t.push(`${e.gold} gold`),e.silver>0&&t.push(`${e.silver} silver`),e.copper>0&&t.push(`${e.copper} copper`),t.length>0?t.join(", "):"0 copper"}function KE(e){let{gold:t,silver:r,copper:n}=e;return r+=Math.floor(n/100),n%=100,t+=Math.floor(r/100),r%=100,{gold:t,silver:r,copper:n}}function N5(e,t){const r=e.gold*1e4+e.silver*100+e.copper,n=t.gold*1e4+t.silver*100+t.copper;if(r<n)return{success:!1,newMoney:e};let s=r-n;const i=Math.floor(s/1e4);s%=1e4;const l=Math.floor(s/100);return s%=100,{success:!0,newMoney:{gold:i,silver:l,copper:s}}}function k5(){var T,H;const{character:e,updateCharacter:t}=ks(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState({}),[f,p]=w.useState(!0),[g,y]=w.useState(""),{data:E=[],isLoading:x,error:b}=Ut({queryKey:["gameItems"],queryFn:jh,staleTime:1e3*60*10});w.useEffect(()=>{async function O(){if(!e.profession){y("Profession not selected."),p(!1);return}try{p(!0),y("");const{data:q,error:G}=await te.from("professions").select("starting_equipment, equipment_description").eq("name",e.profession).single();if(G)throw G;if(q){const $=q,z=($.starting_equipment||[]).map((B,L)=>({option:L+1,items:B.split(",").map(Q=>Q.trim()).filter(Boolean),description:($.equipment_description||[])[L]||""}));i(z)}else i([])}catch(q){console.error("Error fetching equipment options:",q),y("Failed to load equipment options.")}finally{p(!1)}}O()},[e.profession]);const v=O=>{const G=O.split(" or ")[0].trim().replace(/^\d+\s+/,"");return E.find($=>$.name===G)},_=O=>{const q=O.match(/^(\d*D\d+)/i);if(!q)return null;const G=q[1],$=G.toUpperCase().split("D"),z=$[0]===""?1:parseInt($[0]),B=parseInt($[1]),L=O.slice(G.length).trim();return{count:z,sides:B,rest:L}},k=(O,q)=>{let G=0;for(let $=0;$<O;$++)G+=Math.floor(Math.random()*q)+1;return G},S=O=>{n(O),o(!1)},I=()=>{var G,$;if(r===null)return;const O=s.find(z=>z.option===r);if(!O)return;if(O.items.some(z=>_(z)||z.toLowerCase().includes(" or "))){const z=O.items.reduce((B,L,Q)=>{if(L.toLowerCase().includes(" or ")){const N=L.split(/\s+or\s+/i).map(K=>K.trim());B[Q]=N[0]}else B[Q]="";return B},{});h(z),c(!0)}else{const z=((G=e.equipment)==null?void 0:G.money)||{gold:0,silver:0,copper:0};t({startingEquipment:{option:r,items:O.items},equipment:{money:z,equipped:(($=e.equipment)==null?void 0:$.equipped)||{weapons:[]},inventory:[...O.items]}}),o(!0)}},j=()=>{var z,B;if(r===null)return;const O=s.find(L=>L.option===r);if(!O)return;const G={...((z=e.equipment)==null?void 0:z.money)||{gold:0,silver:0,copper:0}},$=[];O.items.forEach((L,Q)=>{if(L.toLowerCase().includes(" or ")){const N=d[Q]||L.split(/\s+or\s+/i)[0].trim();$.push(N)}else{const N=_(L);if(N){const K=d[Q]?parseInt(d[Q]):k(N.count,N.sides),Y=N.rest.toLowerCase();Y.includes("gold")?G.gold+=K:Y.includes("silver")?G.silver+=K:Y.includes("copper")?G.copper+=K:$.push(`${K} ${N.rest}`)}else $.push(L)}}),t({startingEquipment:{option:r,items:$},equipment:{money:KE(G),equipped:((B=e.equipment)==null?void 0:B.equipped)||{weapons:[]},inventory:[...$]}}),c(!1),o(!0)},P=r!==null&&((T=s.find(O=>O.option===r))==null?void 0:T.items.every((O,q)=>O.toLowerCase().includes(" or ")||_(O)?!!d[q]:!0));return f||x?a.jsx($e,{}):g||b?a.jsx(Ie,{message:g||(b==null?void 0:b.message)||"Failed to load data."}):e.profession?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Starting Equipment"}),a.jsxs("p",{className:"text-gray-600",children:["Select one of the available equipment packages for your ",e.profession,"."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Equipment Selection"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Choose carefully  this will be your starting gear. Items with ",a.jsx(zy,{className:"inline w-4 h-4 text-amber-600"})," require a dice roll, items with ",a.jsx(Wy,{className:"inline w-4 h-4 text-purple-600"})," offer a choice."]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(O=>a.jsxs("div",{onClick:()=>S(O.option),className:`p-6 border rounded-lg cursor-pointer transition-all ${r===O.option?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(xu,{className:"w-6 h-6 text-gray-500"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold",children:["Option ",O.option]}),a.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Equipment List:"}),a.jsx("ul",{className:"space-y-1",children:O.items.map((q,G)=>{const $=!!_(q),z=q.toLowerCase().includes(" or "),B=v(q);return a.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-600 group relative",children:[$?a.jsx(zy,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):z?a.jsx(Wy,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):a.jsx(gu,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a.jsx("span",{children:q}),(B==null?void 0:B.effect)&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 max-w-xs",children:[B.effect," (W: ",B.weight,", Cost: ",B.cost,")"]})]},G)})})]}),r===O.option&&a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[a.jsx(gu,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Selected"})]})]},O.option))}),!r&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Equipment Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select a starting equipment package."})]})]}),a.jsxs("button",{onClick:I,disabled:!r||l,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${l?"bg-green-600 text-white cursor-default":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[a.jsx(mE,{className:"w-5 h-5"}),l?"Equipment Confirmed":"Confirm Equipment Selection"]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Resolve Dice Rolls & Selections"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{className:"w-5 h-5"})})]}),(((H=s.find(O=>O.option===r))==null?void 0:H.items)||[]).map((O,q)=>{if(O.toLowerCase().includes(" or ")){const $=O.split(/\s+or\s+/i).map(z=>z.trim());return a.jsxs("div",{className:"mb-4 p-3 border rounded bg-purple-50 border-purple-200",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:O}),a.jsxs("select",{value:d[q]||"",onChange:z=>h(B=>({...B,[q]:z.target.value})),className:"mt-1 w-full border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select one..."}),$.map((z,B)=>a.jsx("option",{value:z,children:z},B))]})]},q)}const G=_(O);return G?a.jsxs("div",{className:"mb-4 p-3 border rounded bg-amber-50 border-amber-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium",children:O}),a.jsxs(U,{size:"sm",variant:"secondary",onClick:()=>{const $=k(G.count,G.sides);h(z=>({...z,[q]:$.toString()}))},children:["Roll ",G.count,"D",G.sides]})]}),a.jsx("input",{type:"number",min:G.count,max:G.count*G.sides,value:d[q]||"",onChange:$=>{const z=$.target.value;if(z==="")h(B=>({...B,[q]:""}));else{const B=parseInt(z);if(!isNaN(B)){const L=Math.max(G.count,Math.min(G.count*G.sides,B));h(Q=>({...Q,[q]:L.toString()}))}}},className:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:`Enter result (${G.count}-${G.count*G.sides})`})]},q):null}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(U,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:j,disabled:!P,children:"Confirm Rolls/Choices"})]})]})})]}):a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession before choosing equipment."})})}async function _5(){const{data:e,error:t}=await te.from("compendium").select("*").order("category").order("title");if(t)throw console.error("Error fetching compendium entries:",t),new Error(t.message||"Failed to load compendium entries");return e||[]}async function S5(){const{data:e,error:t}=await te.from("compendium_templates").select("*").order("category").order("name");if(t)throw console.error("Error fetching compendium templates:",t),new Error(t.message||"Failed to load compendium templates");return e||[]}async function T5(){const{data:e,error:t}=await te.from("bio_data").select("appearance, mementos, flaws");if(t)throw console.error("Error fetching bio data:",t),new Error(t.message||"Failed to load bio data");const r=new Set,n=new Set,s=new Set;return(e||[]).forEach(i=>{(i.appearance||[]).forEach(l=>r.add(l)),(i.mementos||[]).forEach(l=>n.add(l)),(i.flaws||[]).forEach(l=>s.add(l))}),{appearance:Array.from(r).sort(),mementos:Array.from(n).sort(),flaws:Array.from(s).sort()}}const lb=["Diminutive","Short","Below Average","Average","Above Average","Tall","Towering"],ob=["Gaunt","Slight","Lean","Wiry","Average","Athletic","Muscular","Stocky","Heavy"],ub=["Raven Black","Chestnut Brown","Sandy Blonde","Fiery Red","Ash Gray","Snow White","Auburn"],cb=["Slicked Back","Short & Spiky","Long & Flowing","Ornate Braids","Messy Bun","Curly Mop","Shaved Sides","Tonsure","Bald"],db=["Chocolate Brown","Sky Blue","Emerald Green","Stormy Gray","Warm Hazel","Amber"],hb=["Pale","Fair","Light","Olive","Ruddy","Tan","Dark","Ebony"],fb=["Deep Blue","Crimson","Silver","Violet","Pastel Pink"],mb=["Lilac","Gold","Silver","Blood Red","All White (No Pupil)"],pb=["Simple traveler's clothes","Ragged commoner's garb","Well-made leather armor","Sturdy chainmail hauberk","Flamboyant noble's attire","Scholar's robes and spectacles","Mysterious hooded cloak","Practical hunter's leathers","Grim ritual vestments","Colorful entertainer's outfit","Tailored city guard uniform","Patched and worn adventurer's gear"],Lc=({label:e,placeholder:t,options:r,value:n,onChange:s,mode:i,onModeChange:l,onRandomize:o,isLoading:u=!1,rows:c=3})=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),a.jsxs("button",{onClick:()=>l(i==="manual"?"select":"manual"),className:"flex items-center gap-1 text-xs text-gray-600 hover:text-blue-600",title:`Switch to ${i==="manual"?"selection":"manual"} mode`,children:[i==="manual"?a.jsx(D4,{className:"w-4 h-4"}):a.jsx(M4,{className:"w-4 h-4"}),a.jsx("span",{children:i==="manual"?"Manual":"Select"})]})]}),i==="manual"?a.jsx("textarea",{value:n,onChange:d=>s(d.target.value),placeholder:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:c}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("select",{value:n,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:u||r.length===0,children:[a.jsx("option",{value:"",children:u?"Loading...":"Select an option..."}),r.map(d=>a.jsx("option",{value:d,children:d},d))]}),a.jsx(U,{variant:"secondary",size:"icon",onClick:o,disabled:u||r.length===0,"aria-label":`Randomize ${e}`,icon:ur})]})]});function C5(){const{character:e,updateCharacter:t}=ks(),{data:r,isLoading:n}=Ut({queryKey:["bioData"],queryFn:T5,staleTime:1e3*60*5}),[s,i]=w.useState({height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",distinctiveFeatures:"",clothing:"",memento:"",flaw:""}),[l,o]=w.useState({distinctiveFeatures:"select",clothing:"select",memento:"select",flaw:"select"}),u=(x,b)=>{i(v=>({...v,[x]:b}))},c=(x,b)=>{o(v=>({...v,[x]:b})),i(v=>({...v,[x]:""}))},d=x=>!x||x.length===0?"":x[Math.floor(Math.random()*x.length)],h=(x,b)=>{b&&b.length>0&&i(v=>({...v,[x]:d(b)}))},f=()=>{i(x=>({...x,height:d(lb),build:d(ob)}))},p=()=>{const x=Math.random()<.05?d(fb):d(ub),b=Math.random()<.05?d(mb):d(db);i(v=>({...v,hairColor:x,hairStyle:d(cb),eyeColor:b,skinTone:d(hb)}))},g=()=>{const x=[];s.height&&s.build&&x.push(`A ${s.height.toLowerCase()}, ${s.build.toLowerCase()} individual`),s.hairStyle&&s.hairColor&&(s.hairStyle.toLowerCase()==="bald"?x.push("with a bald head"):x.push(`with ${s.hairStyle.toLowerCase()} ${s.hairColor.toLowerCase()} hair`)),s.eyeColor&&x.push(`${s.eyeColor.toLowerCase()} eyes`),s.skinTone&&x.push(`and ${s.skinTone.toLowerCase()} skin`);let b=x.join(", ").replace(/,([^,]*)$/," and$1")+".";return s.distinctiveFeatures&&(b+=` They are notable for ${s.distinctiveFeatures.toLowerCase()}.`),s.clothing&&(b+=` They typically wear ${s.clothing.toLowerCase()}.`),b},y=()=>{const x=g();t({appearance:x,mementos:s.memento?[s.memento]:[],weak_spot:s.flaw})},E=()=>Object.values(s).every(x=>x.trim()!=="");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Character Appearance"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Describe your character's physical appearance, clothing, and defining traits."})]}),a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Character Details"}),a.jsxs("p",{className:"text-sm text-blue-700",children:[e.kin,"  ",e.age,"  ",e.profession]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(T4,{className:"w-5 h-5 text-gray-500"}),"Physical Characteristics"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:ur,onClick:f,children:"Randomize"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),a.jsxs("select",{value:s.height,onChange:x=>u("height",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select height..."}),lb.map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build"}),a.jsxs("select",{value:s.build,onChange:x=>u("build",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select build..."}),ob.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(yi,{className:"w-5 h-5 text-gray-500"}),"Hair and Face"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:ur,onClick:p,children:"Randomize"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Color"}),a.jsxs("select",{value:s.hairColor,onChange:x=>u("hairColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...ub,...fb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Style"}),a.jsxs("select",{value:s.hairStyle,onChange:x=>u("hairStyle",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select style..."}),cb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eye Color"}),a.jsxs("select",{value:s.eyeColor,onChange:x=>u("eyeColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...db,...mb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skin Tone"}),a.jsxs("select",{value:s.skinTone,onChange:x=>u("skinTone",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select tone..."}),hb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]})]}),a.jsx("div",{className:"space-y-4 md:col-span-2",children:a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800 border-b pb-2",children:[a.jsx(nl,{className:"w-5 h-5 text-gray-500"}),"Traits & Possessions"]})}),a.jsx(Lc,{label:"Distinctive Feature",placeholder:"Scars, tattoos, birthmarks...",options:(r==null?void 0:r.appearance)||[],value:s.distinctiveFeatures,onChange:x=>u("distinctiveFeatures",x),mode:l.distinctiveFeatures,onModeChange:x=>c("distinctiveFeatures",x),onRandomize:()=>h("distinctiveFeatures",r==null?void 0:r.appearance),isLoading:n}),a.jsx(Lc,{label:"Typical Clothing",placeholder:"Describe typical clothing...",options:pb,value:s.clothing,onChange:x=>u("clothing",x),mode:l.clothing,onModeChange:x=>c("clothing",x),onRandomize:()=>h("clothing",pb)}),a.jsx(Lc,{label:"Memento",placeholder:"A locket, a worn coin...",options:(r==null?void 0:r.mementos)||[],value:s.memento,onChange:x=>u("memento",x),mode:l.memento,onModeChange:x=>c("memento",x),onRandomize:()=>h("memento",r==null?void 0:r.mementos),isLoading:n}),a.jsx(Lc,{label:"Flaw / Weak Spot",placeholder:"A fear of heights, a gambling problem...",options:(r==null?void 0:r.flaws)||[],value:s.flaw,onChange:x=>u("flaw",x),mode:l.flaw,onModeChange:x=>c("flaw",x),onRandomize:()=>h("flaw",r==null?void 0:r.flaws),isLoading:n})]}),E()?a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg space-y-3",children:[a.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"Appearance Preview"}),a.jsx("p",{className:"text-sm text-green-700",children:g()})]}):a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Description"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please fill in all appearance details to see a preview and save."})]})]}),a.jsx(U,{onClick:y,disabled:!E(),icon:tr,className:"w-full justify-center",children:"Save Appearance"})]})}const co=[{title:"Kin",component:j6},{title:"Profession",component:L6},{title:"Name & Age",component:O6},{title:"Attributes",component:M6},{title:"Magic",component:U6},{title:"Trained Skills",component:B6},{title:"Gear",component:k5},{title:"Appearance",component:C5}],j5=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,ZE={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR"},A5=Object.keys(ZE);function I5(){const{user:e}=Vt(),{step:t,setStep:r,character:n,resetCharacter:s}=ks(),[i,l]=_n.useState(null),[o,u]=_n.useState(!1),c=fn(),d=hn(),h=co[t].component,f=()=>{var g;switch(t){case 0:return!!n.kin&&n.kinAbilityNames!==void 0&&n.kinAbilityNames.length>0;case 1:const y=n.magicSchool!==null&&n.magicSchool!==void 0;return!!n.profession&&(y||n.professionHeroicAbilityName!==void 0);case 2:return!!n.name&&n.name.trim().length>0&&!!n.age;case 3:return n.attributes&&Object.values(n.attributes).every(E=>E>0);case 4:return n.magicSchool?((g=n.spells)==null?void 0:g.general)&&n.spells.general.length>=3:!0;case 5:return n.trainedSkills&&n.trainedSkills.length>=6&&!!n.attributes;case 6:return n.startingEquipment&&n.startingEquipment.items.length>=0;case 7:return!!n.appearance&&n.appearance.trim().length>0&&!!n.mementos&&n.mementos.length>0&&!!n.weak_spot&&n.weak_spot.trim().length>0;default:return!1}},p=async()=>{var g,y,E,x,b;if(!e){l("You must be logged in to create a character");return}if(!f()){l("Please complete all required fields for the final step before saving.");return}if(!n.attributes){l("Attributes must be set before saving.");return}try{u(!0),l(null),console.log("[CharacterSave] Starting character save process...");const v={},_=new Set(n.trainedSkills||[]);A5.forEach(T=>{var G;const H=ZE[T];if(!H)return;const O=((G=n.attributes)==null?void 0:G[H])??0,q=j5(O);v[T]=_.has(T)?q*2:q}),console.log("[CharacterSave] Calculated initial skill levels:",v);const k=[...n.kinAbilityNames||[],...n.professionHeroicAbilityName?[n.professionHeroicAbilityName]:[]].filter(Boolean);console.log("[CharacterSave] Combined heroic abilities:",k);const S={user_id:e.id,name:(g=n.name)==null?void 0:g.trim(),kin:n.kin,profession:n.profession,magic_school:n.magicSchool,age:n.age,attributes:n.attributes,trained_skills:n.trainedSkills||[],other_skills:n.otherSkills||[],skill_levels:v,equipment:n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},appearance:(y=n.appearance)==null?void 0:y.trim(),conditions:n.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},spells:n.spells||null,starting_equipment:n.startingEquipment||{items:[],money:{gold:0,silver:0,copper:0}},experience:{marked_skills:[]},current_hp:((E=n.attributes)==null?void 0:E.CON)??10,current_wp:((x=n.attributes)==null?void 0:x.WIL)??10,heroic_ability:k,memento:((b=n.mementos)==null?void 0:b[0])||null,weak_spot:n.weak_spot||null};console.log("[CharacterSave] Prepared character data for insert:",S),console.log("[CharacterSave] Inserting character into Supabase...");const{data:I,error:j}=await te.from("characters").insert(S).select().single();if(j)throw console.error("[CharacterSave] Supabase insert error:",j),j;if(!I)throw console.error("[CharacterSave] Character insert succeeded but no data returned."),new Error("Character not created or data not returned.");console.log("[CharacterSave] Character saved successfully:",I),console.log("[CharacterSave] Invalidating characters query cache..."),await d.invalidateQueries({queryKey:["characters",e.id]}),await d.invalidateQueries({queryKey:["characters"]}),console.log("[CharacterSave] Resetting character creation store..."),s();const P=I.id;console.log(`[CharacterSave] Navigating to /characters/${P}`),c(`/characters/${P}`)}catch(v){console.error("[CharacterSave] Save process failed:",v);const _=v instanceof Error?v.message:"Failed to save character";l(`Failed to save character: ${_}`)}finally{console.log("[CharacterSave] Save process finished (finally block)."),u(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-8 my-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Create New Character"}),a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Step ",t+1," of ",co.length]})]}),a.jsx("div",{className:"flex space-x-1",children:co.map((g,y)=>a.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden bg-gray-200",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${y<t?"bg-blue-500":y===t?"bg-blue-300":"bg-gray-200"}`,style:{width:y===t?"50%":"100%"}})},g.title))}),a.jsx("p",{className:"text-center text-lg font-semibold mt-3 text-gray-700",children:co[t].title})]}),i&&a.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-red-50 border border-red-300 rounded-lg shadow-sm",children:[a.jsx(qt,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Creation Error"}),a.jsx("p",{className:"text-sm text-red-700",children:i})]})]}),a.jsx("div",{className:"min-h-[400px] mb-8",children:a.jsx(h,{})}),a.jsxs("div",{className:"flex justify-between items-center mt-8 border-t pt-6",children:[a.jsx("button",{onClick:()=>r(t-1),disabled:t===0||o,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t===co.length-1?a.jsxs("button",{onClick:p,disabled:!f()||o,className:`inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":f()?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"}`,children:[a.jsx(tr,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Saving Character...":"Create Character"]}):a.jsx("button",{onClick:()=>r(t+1),disabled:!f()||o,className:`inline-flex items-center px-5 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ${!f()||o?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Next Step"})]})]})}function Rp({icon:e,title:t,description:r,action:n}){return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 mb-6",children:r}),n]})}const xg="*, magic_school:magic_schools!left(*)",Wl=e=>{const t={STR:10,AGL:10,INT:10,CON:10,WIL:10,CHA:10},r=e.attributes||{},n={STR:r.STR??t.STR,AGL:r.AGL??t.AGL,INT:r.INT??t.INT,CHA:r.CHA??t.CHA,CON:r.CON??t.CON,WIL:r.WIL??t.WIL},s=n.CON,i=n.WIL;let l={};if(typeof e.skill_levels=="string")try{l=JSON.parse(e.skill_levels)}catch{}else typeof e.skill_levels=="object"&&e.skill_levels!==null&&(l=e.skill_levels);const o=e.equipment||{};return{id:e.id,user_id:e.user_id,name:e.name||"Unnamed Character",kin:e.kin||"Unknown",profession:e.profession||"Unknown",age:e.age,appearance:e.appearance||"",background:e.background||"",notes:e.notes||"",portrait_url:e.portrait_url,magicSchool:e.magic_school||null,memento:e.memento||"",flaw:e.weak_spot||"",attributes:n,max_hp:s,current_hp:e.current_hp??s,max_wp:i,current_wp:e.current_wp??i,skill_levels:l,trainedSkills:e.trained_skills||[],spells:e.spells||{known:[]},heroic_abilities:e.heroic_ability||[],equipment:{inventory:o.inventory||[],equipped:o.equipped||{weapons:[]},money:o.money||{gold:0,silver:0,copper:0}},conditions:e.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},is_rallied:e.is_rallied??!1,death_rolls_passed:e.death_rolls_passed??0,death_rolls_failed:e.death_rolls_failed??0,experience:e.experience??0,teacher:e.teacher||null,reputation:e.reputation??0,corruption:e.corruption??0,created_at:e.created_at,updated_at:e.updated_at,party_id:e.party_id,party_info:e.party_info}};async function R5(e){if(!e)return[];const{data:t,error:r}=await te.from("characters").select(xg).eq("user_id",e).order("created_at",{ascending:!1});if(r)throw new Error(r.message||"Failed to fetch characters");return(t||[]).map(Wl)}async function L5(e){if(!e)return null;const{data:t,error:r}=await te.from("characters").select(xg).eq("id",e).single();if(r){if(r.code==="PGRST116")return null;throw new Error(r.message||"Failed to fetch character")}return t?Wl(t):null}async function O5(e,t){const r={...t};r.heroic_abilities&&(r.heroic_ability=r.heroic_abilities,delete r.heroic_abilities),r.trainedSkills&&(r.trained_skills=r.trainedSkills,delete r.trainedSkills),r.magicSchool&&(r.magic_school=r.magicSchool,delete r.magicSchool),r.updated_at=new Date().toISOString();const{data:n,error:s}=await te.from("characters").update(r).eq("id",e).select(xg).single();if(s)throw new Error(s.message||"Failed to update character");return n?Wl(n):null}async function P5(e){if(e.length===0)return;const{error:t}=await te.from("characters").delete().in("id",e);if(t)throw new Error(t.message||"Failed to delete characters")}const XE=_n.forwardRef(({className:e,...t},r)=>a.jsx("input",{ref:r,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed ${e}`,...t}));XE.displayName="Input";function D5({isOpen:e,onClose:t,onJoin:r}){const[n,s]=w.useState(""),[i,l]=w.useState(""),[o,u]=w.useState(!1),c=async()=>{l("");const h=n.match(/party\/join\/([^/?]+)/);if(h&&h[1]){const f=h[1];u(!0);try{await r(f),d()}catch(p){console.error("Join operation failed:",p)}finally{u(!1)}}else l("Invalid party invite link. Please paste the full link.")},d=()=>{s(""),l(""),u(!1),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity","aria-labelledby":"join-party-title",role:"dialog","aria-modal":"true",onClick:d,children:a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md m-4 transform transition-all",onClick:h=>h.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{id:"join-party-title",className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Sh,{className:"w-6 h-6 text-blue-600"}),"Join an Adventure Party"]}),a.jsx("button",{onClick:d,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600","aria-label":"Close dialog",disabled:o,children:a.jsx(Dt,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Paste the invite link you received from your Dungeon Master to join their party."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party-link",className:"sr-only",children:"Party Invite Link"}),a.jsx(XE,{id:"party-link",type:"text",value:n,onChange:h=>s(h.target.value),placeholder:"https://.../party/join/...",className:"w-full","aria-describedby":"link-error",disabled:o}),i&&a.jsx("p",{id:"link-error",className:"text-red-500 text-sm mt-2",children:i})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(U,{variant:"secondary",onClick:d,disabled:o,children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:c,disabled:!n||o,children:o?"Joining...":"Join Party"})]})]})}):null}function Lp({isOpen:e,onClose:t,onConfirm:r,title:n,description:s,confirmText:i="Confirm",cancelText:l="Cancel",isLoading:o=!1,isDestructive:u=!1,icon:c}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[c&&a.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${u?"bg-red-100":"bg-blue-100"}`,children:c}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",id:"modal-title",children:n}),a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:s})})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3",children:[a.jsx(U,{variant:"secondary",onClick:t,disabled:o,className:"mt-3 sm:mt-0 w-full sm:w-auto",children:l}),a.jsx(U,{variant:u?"danger":"primary",onClick:r,loading:o,className:"w-full sm:w-auto",children:i})]})]})}):null}function M5(){const{user:e}=Vt(),t=fn(),r=hn(),[n,s]=w.useState(!1),[i,l]=w.useState(!1),[o,u]=w.useState([]),[c,d]=w.useState(!1),{data:h=[],isLoading:f,error:p}=Ut({queryKey:["characters",e==null?void 0:e.id],queryFn:()=>R5(e==null?void 0:e.id),enabled:!!e}),g=At({mutationFn:P5,onSuccess:()=>{r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]}),u([]),d(!1)},onError:E=>{console.error("Failed to delete characters:",E),d(!1)}}),y=(E,x)=>{if(E.shiftKey)E.preventDefault(),u(b=>b.includes(x)?b.filter(v=>v!==x):[...b,x]);else{if(o.length>0)return;t(`/character/${x}`)}};return f?a.jsx("div",{className:"p-8 flex justify-center items-center h-full",children:a.jsx($e,{size:"lg"})}):p?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:p.message||"Failed to load characters"})}):e?a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Characters"}),h.length>0&&!n&&a.jsxs("div",{className:"relative group flex items-center",children:[a.jsx(Gn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 cursor-pointer transition-colors"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 z-10 mb-2 w-max max-w-xs -translate-x-1/2 transform rounded-lg bg-gray-900 px-3 py-2 text-center text-sm font-normal text-white opacity-0 transition-opacity duration-300 group-hover:opacity-100 pointer-events-none",children:["Hold ",a.jsx("kbd",{className:"px-2 py-1.5 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg",children:"Shift"})," and click cards to select multiple for deletion.",a.jsx("div",{className:"absolute left-1/2 top-full h-0 w-0 -translate-x-1/2 border-x-4 border-x-transparent border-t-4 border-t-gray-900"})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[o.length>0&&a.jsxs(U,{variant:"danger",icon:cr,onClick:()=>d(!0),loading:g.isPending,children:["Delete (",o.length,")"]}),a.jsx(U,{variant:"secondary",icon:Sh,onClick:()=>l(!0),children:"Join Party"}),a.jsx(U,{variant:"primary",icon:Jt,onClick:()=>s(!0),children:"Create Character"})]})]}),n?a.jsx(I5,{onComplete:()=>{s(!1),r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]})}}):h.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(E=>a.jsxs("div",{className:"relative group cursor-pointer",onClick:x=>y(x,E.id),children:[a.jsx("div",{className:`absolute inset-0 rounded-lg border-2 transition-all duration-200 pointer-events-none ${o.includes(E.id)?"border-red-500 shadow-lg":"border-transparent group-hover:border-blue-500"}`}),a.jsx(e6,{character:E})]},E.id))}):a.jsx(Rp,{icon:Jt,title:"No Characters Yet",description:"Create your first character to begin your adventure.",action:a.jsx(U,{variant:"primary",icon:Jt,onClick:()=>s(!0),children:"Create Your First Character"})}),a.jsx(D5,{isOpen:i,onClose:()=>l(!1),onJoin:E=>{l(!1),t(`/party/join/${E}`)}}),a.jsx(Lp,{isOpen:c,onClose:()=>d(!1),onConfirm:()=>{o.length>0&&g.mutate(o)},title:`Delete ${o.length} ${o.length>1?"Characters":"Character"}?`,description:"Are you sure you want to permanently delete the selected character(s)? All of their data will be lost. This action cannot be undone.",confirmText:`Yes, Delete ${o.length}`,isLoading:g.isPending,isDestructive:!0,icon:a.jsx(Ku,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})})]}):a.jsx("div",{className:"p-8",children:a.jsx(Rp,{icon:qt,title:"Authentication Required",description:"Please sign in to view your characters."})})}async function F5(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1}).limit(1);if(r)throw console.error("Error fetching latest encounter:",r),r;return(t==null?void 0:t[0])||null}async function U5(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching all encounters:",r),r;return t||[]}async function JE(e){const{data:t,error:r}=await te.from("encounters").select("*").eq("id",e).single();if(r)throw console.error("Error fetching encounter details:",r),r;return t}async function yg(e){const{data:t,error:r}=await te.from("encounter_combatants").select("*, characters(name), monsters(name)").eq("encounter_id",e).order("initiative_roll",{ascending:!1,nullsLast:!0}).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching encounter combatants:",r),r;return(t||[]).map(n=>({...n,display_name:n.display_name||(n.character_id&&n.characters?n.characters.name:n.monster_id&&n.monsters?n.monsters.name:"Unknown Combatant")}))}async function eN(e,t,r){const{data:n,error:s}=await te.from("encounters").insert({party_id:e,name:t,description:r,status:"planning",log:[]}).select().single();if(s)throw console.error("Error creating encounter:",s),s;if(!n)throw new Error("Encounter creation returned no data");return n}async function B5(e){const{error:t}=await te.from("encounter_combatants").delete().eq("encounter_id",e);if(t)throw console.error("Error deleting encounter combatants:",t),t;const{error:r}=await te.from("encounters").delete().eq("id",e);if(r)throw console.error("Error deleting encounter:",r),r}async function H5(e,t,r){const n=await JE(e);if(!n)throw new Error("Original encounter not found");const s=await eN(n.party_id,t,n.description||void 0),i=await yg(e);if(i.length>0){const l=i.map(u=>({encounter_id:s.id,character_id:u.character_id,monster_id:u.monster_id,display_name:u.display_name,max_hp:u.max_hp,current_hp:u.max_hp,max_wp:u.max_wp,current_wp:u.max_wp,is_player_character:u.is_player_character,initiative_roll:null,is_active_turn:!1,status_effects:[]})),{error:o}=await te.from("encounter_combatants").insert(l);if(o)throw console.error("Error duplicating combatants:",o),o}return s}async function $5(e,t){var r,n;if(t.type==="character"){const{data:s,error:i}=await te.from("characters").select("id, name, max_health, current_health, max_willpower, current_willpower").eq("id",t.characterId).single();if(i||!s)throw console.error("Error fetching character for combatant:",i==null?void 0:i.message),new Error(`Character (ID: ${t.characterId}) not found or error fetching details.`);const l=s.name||"Unnamed Character",o={encounter_id:e,character_id:s.id,display_name:l,max_hp:s.max_health??10,current_hp:s.current_health??s.max_health??10,max_wp:s.max_willpower,current_wp:s.current_willpower,is_player_character:!0,initiative_roll:t.initiativeRoll},{data:u,error:c}=await te.from("encounter_combatants").insert(o).select().single();if(c)throw console.error("Error inserting character combatant:",c.message),c;return[u]}else{const{data:s,error:i}=await te.from("monsters").select("id, name, stats").eq("id",t.monsterId).single();if(i||!s)throw console.error("Error fetching monster for combatant:",i==null?void 0:i.message),new Error(`Monster (ID: ${t.monsterId}) not found or error fetching details.`);const l=((r=s.stats)==null?void 0:r.HP)??((n=s.stats)==null?void 0:n.hp)??10,o=t.instanceCount??1,u=[];for(let h=0;h<o;h++){const f=o>1?`${t.customName||s.name||"Unnamed Monster"} ${h+1}`:t.customName||s.name||"Unnamed Monster";u.push({encounter_id:e,monster_id:s.id,display_name:f,max_hp:l,current_hp:l,max_wp:null,current_wp:null,is_player_character:!1,initiative_roll:t.initiativeRoll})}const{data:c,error:d}=await te.from("encounter_combatants").insert(u).select();if(d)throw console.error("Error inserting monster combatants:",d.message),d;return c||[]}}async function Ah(e,t){const{data:r,error:n}=await te.from("encounters").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating encounter:",n),n;if(!r)throw new Error("Encounter update returned no data");return r}async function bu(e,t){const{data:r,error:n}=await te.from("encounter_combatants").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating combatant:",n),n;if(!r)throw new Error("Combatant update returned no data");return r}async function z5(e){const{error:t}=await te.from("encounter_combatants").delete().eq("id",e);if(t)throw console.error("Error removing combatant:",t),t}async function q5(e,t){const{data:r,error:n}=await te.from("encounter_combatants").select("*, monsters(stats)").eq("encounter_id",e).in("id",t);if(n)throw console.error("Error fetching combatants for initiative:",n),n;const i=((r==null?void 0:r.map(l=>{var u,c,d,h;let o;if(l.is_player_character)o=Math.floor(Math.random()*10)+1;else{const f=((c=(u=l.monsters)==null?void 0:u.stats)==null?void 0:c.FEROCITY)??((h=(d=l.monsters)==null?void 0:d.stats)==null?void 0:h.ferocity)??1,p=Math.max(1,Math.min(f,5)),g=Array.from({length:p},()=>Math.floor(Math.random()*10)+1);o=Math.max(...g)}return{id:l.id,initiative_roll:o}}))||[]).map(l=>bu(l.id,{initiative_roll:l.initiative_roll}));return Promise.all(i)}async function V5(e,t){const{data:r,error:n}=await te.from("encounter_combatants").select("id, initiative_roll").in("id",[e,t]);if(n||!r||r.length!==2)throw new Error("Could not fetch combatants for initiative swap");const[s,i]=r,[l,o]=await Promise.all([bu(s.id,{initiative_roll:i.initiative_roll}),bu(i.id,{initiative_roll:s.initiative_roll})]);return[l,o]}async function W5(e){const t=await Ah(e,{status:"active",current_round:1});return await Ih(e,{type:"start",round:1}),t}async function G5(e){const t=await Ah(e,{status:"completed",active_combatant_id:null});return await Ih(e,{type:"end"}),t}async function Y5(e){const{data:t}=await te.from("encounters").select("current_round").eq("id",e).single();if(!t)throw new Error("Encounter not found");const r=await Ah(e,{current_round:(t.current_round??0)+1,active_combatant_id:null});return await Ih(e,{type:"round_advanced",round:r.current_round}),r}async function Q5(e){const{data:t,error:r}=await te.from("encounters").select("log").eq("id",e).single();if(r)throw console.error("Error fetching encounter log:",r),r;const n=(t==null?void 0:t.log)??[];return Array.isArray(n)?n:[]}async function Ih(e,t){const r=await Q5(e),n={ts:t.ts??new Date().toISOString(),...t};r.push(n);const{error:s}=await te.from("encounters").update({log:r}).eq("id",e);if(s)throw console.error("Error appending encounter log:",s),s}const hr=BE((e,t)=>({character:null,isLoading:!0,isSaving:!1,error:null,saveError:null,markedSkillsThisSession:new Set,allGameItems:[],isLoadingGameItems:!1,allHeroicAbilities:[],isLoadingAbilities:!1,activeStatusMessage:null,statusMessageTimeoutId:null,activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null,fetchCharacter:async(r,n)=>{e({character:null,isLoading:!0,error:null,saveError:null});try{await Promise.all([t()._loadGameItems(),t()._loadAllHeroicAbilities()]);const s=await L5(r,n);if(!s)throw new Error(`Character with ID ${r} not found or you do not have permission to view it.`);e({character:s,isLoading:!1}),s!=null&&s.party_id?t().fetchActiveEncounter(s.party_id,s.id):t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch character and related data";e({error:i,isLoading:!1})}},setCharacter:r=>{e({character:r}),!r||!r.party_id?t().clearActiveEncounter():t().fetchActiveEncounter(r.party_id,r.id)},_saveCharacter:async r=>{const n=t().character;if(!(n!=null&&n.id)){const s="Cannot save: Character ID is missing.";throw e({saveError:s}),new Error(s)}e({isSaving:!0,saveError:null});try{await O5(n.id,r);const s={...n,...r,updated_at:new Date().toISOString()};e({character:s,isSaving:!1})}catch(s){const i=s instanceof Error?s.message:"Failed to save character";throw e({saveError:i,isSaving:!1}),s}},_loadGameItems:async()=>{if(!(t().isLoadingGameItems||t().allGameItems.length>0)){e({isLoadingGameItems:!0});try{const r=await jh();e({allGameItems:r,isLoadingGameItems:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load game items";e({isLoadingGameItems:!1,error:n})}}},_loadAllHeroicAbilities:async()=>{if(!(t().isLoadingAbilities||t().allHeroicAbilities.length>0)){e({isLoadingAbilities:!0});try{const{data:r,error:n}=await te.from("heroic_abilities").select("*").order("name");if(n)throw n;e({allHeroicAbilities:r||[],isLoadingAbilities:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load heroic abilities";e({isLoadingAbilities:!1,error:n})}}},updateCharacterData:async r=>t()._saveCharacter(r),adjustStat:async(r,n)=>{const s=t().character;if(s){if(r==="current_hp"){const i=s.current_hp??0,l=s.max_hp??0,o=Math.max(0,Math.min(l,i+n));if(o!==i){const u={current_hp:o};i<=0&&o>0&&(u.death_rolls_passed=0,u.death_rolls_failed=0,u.is_rallied=!1),await t()._saveCharacter(u)}}else if(r==="current_wp"){const i=s.current_wp??0,l=s.max_wp??0,o=Math.max(0,Math.min(l,i+n));o!==i&&await t()._saveCharacter({current_wp:o})}}},toggleCondition:async r=>{const n=t().character;if(!n)return;const s=n.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i={...s,[r]:!s[r]};await t()._saveCharacter({conditions:i})},performRest:async(r,n)=>{const s=t().character;if(!s)return;const i={},l=s.current_hp??0,o=s.max_hp??0,u=s.current_wp??0,c=s.max_wp??0,d=()=>Math.floor(Math.random()*6)+1;if(r==="round")i.current_wp=Math.min(c,u+d());else if(r==="stretch"){if(l<=0){t().setActiveStatusMessage("Cannot take Stretch Rest while dying.",3e3);return}const h=n?d()+d():d();i.current_hp=Math.min(o,l+h),i.current_wp=Math.min(c,u+d());const p={...s.conditions??{}};for(const g of Object.keys(p))if(p[g]===!0){p[g]=!1,i.conditions=p;break}}else r==="shift"&&(i.current_hp=o,i.current_wp=c,i.conditions={exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i.death_rolls_failed=0,i.death_rolls_passed=0,i.is_rallied=!1);Object.keys(i).length>0&&await t()._saveCharacter(i)},setDeathRollState:async(r,n,s)=>{const i={death_rolls_passed:r,death_rolls_failed:n};s!==void 0&&(i.is_rallied=s),await t()._saveCharacter(i)},updateAttribute:async(r,n)=>{const s=t().character;if(!s)return;const l={attributes:{...s.attributes||{},[r]:n}};r==="CON"&&(l.max_hp=n,l.current_hp=Math.min(s.current_hp??0,n)),r==="WIL"&&(l.max_wp=n,l.current_wp=Math.min(s.current_wp??0,n)),await t()._saveCharacter(l)},updateCurrentHP:async r=>t()._saveCharacter({current_hp:r}),updateWillpowerPoints:async r=>t()._saveCharacter({current_wp:r}),updateConditions:async r=>t()._saveCharacter({conditions:r}),updateInventory:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,inventory:r}})},updateEquipped:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,equipped:r}})},updateMoney:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,money:r}})},updateNotes:async r=>t()._saveCharacter({notes:r}),updateExperience:async r=>t()._saveCharacter({experience:r}),updateReputation:async r=>t()._saveCharacter({reputation:r}),updateCorruption:async r=>t()._saveCharacter({corruption:r}),updateAppearance:async r=>t()._saveCharacter({appearance:r}),updateDeathRolls:async(r,n)=>{const s=t().character;s&&(r==="failed"?await t().setDeathRollState(s.death_rolls_passed??0,n,s.is_rallied):await t().setDeathRollState(n,s.death_rolls_failed??0,s.is_rallied))},updateSkillLevel:async(r,n)=>{const s=t().character;if(!s)return;const l={...s.skill_levels||{},[r]:n};await t()._saveCharacter({skill_levels:l})},increaseSkillLevel:async r=>{var u;const n=t().character;if(!n)return;const s=n.skill_levels||{},i=s[r]??0;if(i>=18)return;const l=Math.min(i+1,18),o={skill_levels:{...s,[r]:l}};((u=n.teacher)==null?void 0:u.skillUnderStudy)===r&&(o.teacher=null),await t()._saveCharacter(o)},addHeroicAbility:async r=>{const n=t().character;if(!n)return;const s=n.heroic_abilities||[];s.includes(r)||await t()._saveCharacter({heroic_abilities:[...s,r]})},learnSpell:async r=>{const n=t().character;if(!n)return;const s=n.spells??{known:[]},i=s.known||[];if(!i.includes(r)){const l={...s,known:[...i,r]};await t()._saveCharacter({spells:l})}},setSkillUnderStudy:async r=>{await t()._saveCharacter({teacher:r?{skillUnderStudy:r}:null})},markSkillThisSession:r=>{e(n=>({markedSkillsThisSession:new Set(n.markedSkillsThisSession).add(r)}))},clearMarkedSkillsThisSession:()=>e({markedSkillsThisSession:new Set}),setActiveStatusMessage:(r,n=3e4)=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:r});const s=setTimeout(()=>{e({activeStatusMessage:null,statusMessageTimeoutId:null})},n);e({statusMessageTimeoutId:s})},clearActiveStatusMessage:()=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:null,statusMessageTimeoutId:null})},fetchActiveEncounter:async(r,n)=>{e({isLoadingEncounter:!0,encounterError:null,activeEncounter:null,currentCombatant:null});try{const s=await F5(r);if(s){const l=(await yg(s.id)).find(o=>o.character_id===n);e({activeEncounter:s,currentCombatant:l??null})}else e({activeEncounter:null,currentCombatant:null})}catch(s){const i=s instanceof Error?s.message:"Failed to fetch active encounter";e({encounterError:i})}finally{e({isLoadingEncounter:!1})}},drawInitiative:async()=>{const{currentCombatant:r,activeEncounter:n}=t();if(!r||!n||n.status!=="active"){t().setActiveStatusMessage("Cannot draw initiative: Not in an active encounter.",5e3);return}e({isSaving:!0,saveError:null});try{const s=Math.floor(Math.random()*10)+1,i=await bu(r.id,{initiative_roll:s});e({currentCombatant:i}),t().setActiveStatusMessage(`Initiative drawn: ${s}`,5e3)}catch(s){const i=s instanceof Error?s.message:"Failed to draw initiative";e({saveError:i}),t().setActiveStatusMessage(`Failed to draw initiative: ${i}`,5e3)}finally{e({isSaving:!1})}},clearActiveEncounter:()=>{e({activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null})}})),K5=[{kin:"Human",movement:10},{kin:"Halfling",movement:8},{kin:"Dwarf",movement:8},{kin:"Elf",movement:10},{kin:"Mallard",movement:8},{kin:"Wolfkin",movement:12}];function Z5(e,t){var s;const r=((s=K5.find(i=>i.kin===e))==null?void 0:s.movement)||10;let n=0;return t<=6?n=-4:t<=9?n=-2:t<=12?n=0:t<=15?n=2:n=4,r+n}const Ff={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},X5=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming"],J5=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],eI=["Mentalism","Animism","Elementalism"],tI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,rI=(e,t,r)=>{var l,o;console.warn(`[SkillsModal] Calculating fallback level for ${t}.`);const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=tI(s);return n?i*2:i};function nI({onClose:e}){const{toggleDiceRoller:t}=Zn(),{character:r}=hr(),[n,s]=w.useState([]),[i,l]=w.useState(!1),[o,u]=w.useState(null);if(w.useEffect(()=>{(async()=>{l(!0),u(null);try{const{data:v,error:_}=await te.from("magic_schools").select("id, name");if(_)throw _;s(v||[])}catch(v){console.error("[SkillsModal] Error fetching magic schools:",v),u("Failed to load magic schools data.")}finally{l(!1)}})()},[]),!r)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6",children:a.jsx($e,{})})});const c=r.magicSchool,d=!!c;let h=null;if(d&&!i&&n.length>0){const b=n.find(v=>v.id===c);b?h=b.name:console.warn(`[SkillsModal] Could not find magic school name for ID: ${c}`)}const f=b=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[b],p=(b,v,_)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:v,description:`${b} Check`,requiresBane:_,skillName:b}),e()},g=X5.map(b=>({name:b,attr:Ff[b]})).sort((b,v)=>b.name.localeCompare(v.name)),y=J5.map(b=>({name:b,attr:Ff[b]})).sort((b,v)=>b.name.localeCompare(v.name)),E=h?eI.filter(b=>b===h).map(b=>({name:b,attr:Ff[b]})):[],x=b=>{var I,j,P;const v=((I=r.trainedSkills)==null?void 0:I.includes(b.name))??!1,_=((j=r.skill_levels)==null?void 0:j[b.name])??rI(r,b.name,b.attr),k=f(b.attr),S=((P=r.conditions)==null?void 0:P[k])??!1;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${S?"bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"hover:bg-gray-100"}`,onClick:()=>p(b.name,_,S),title:`Click to roll ${b.name} (Target  ${_}${S?", Bane":""})`,children:[a.jsxs("div",{children:[a.jsx("span",{className:`${v?"font-bold":""} ${S?"text-red-700":"text-gray-800"}`,children:b.name}),a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",b.attr,")"]}),S&&a.jsx("span",{className:"text-xs text-red-600 font-semibold ml-2",children:"(Bane)"})]}),a.jsxs("span",{className:`font-medium text-sm ${S?"text-red-700":"text-gray-600"}`,children:["Target: ",_]})]},b.name)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Skills (d20 Check)"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click a skill to roll a d20 check. Roll  Skill Level for success. 1 is Dragon (Crit Success), 20 is Demon (Crit Fail). Conditions apply Bane (roll 2d20, take highest/worst). Trained skills are bolded."})]}),a.jsxs("div",{className:`grid grid-cols-1 ${d?"md:grid-cols-3":"md:grid-cols-2"} gap-6 p-6 overflow-y-auto flex-grow`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"General Skills"}),a.jsx("div",{className:"space-y-1",children:g.map(x)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Weapon Skills"}),a.jsx("div",{className:"space-y-1",children:y.map(x)})]}),d&&a.jsxs("div",{children:[i&&a.jsxs("div",{className:"text-center text-gray-500 p-4",children:[a.jsx($e,{size:"sm"})," Loading magic info..."]}),o&&!i&&a.jsx("div",{className:"text-center text-red-600 p-4 border border-red-200 bg-red-50 rounded",children:o}),!i&&!o&&h&&a.jsxs(a.Fragment,{children:[a.jsxs("h3",{className:"font-bold mb-4 text-gray-700",children:["Magic Skill (",h,")"]}),a.jsx("div",{className:"space-y-1",children:E.length>0?E.map(x):a.jsxs("p",{className:"text-sm text-gray-500 italic px-2 py-1",children:["No matching magic skill component found for ",h,"."]})})]}),!i&&!o&&!h&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Magic Skill"}),a.jsxs("p",{className:"text-sm text-orange-600 italic px-2 py-1 bg-orange-50 border border-orange-200 rounded",children:["Could not determine magic school name from ID (",c,")."]})]})]})]}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,children:"Close"})})]})})}function sI(e){var h,f;const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),o=hr(p=>p.character),u=w.useMemo(()=>{if(!(o!=null&&o.spells))return[];let p=[];if(o.spells.general&&(Array.isArray(o.spells.general)?p=p.concat(o.spells.general):console.warn("[useSpells] character.spells.general is not an array:",o.spells.general)),o.spells.school&&o.spells.school.spells){const g=o.spells.school.spells;Array.isArray(g)?p=p.concat(g):console.warn("[useSpells] character.spells.school.spells is not an array:",g)}return Array.from(new Set(p))},[o==null?void 0:o.spells]);w.useEffect(()=>{if(!e||u.length===0){s(!1),r([]);return}async function p(){s(!0),l(null);try{const{data:g,error:y}=await te.from("game_spells").select(`
            *,
            power_level,
            magic_schools ( name )
          `).in("name",u).order("rank",{ascending:!0}).order("name",{ascending:!0});if(y)throw y;r(g||[])}catch(g){console.error("Error loading learned spell details:",g),l(g instanceof Error?g.message:"Failed to load spell details"),r([])}finally{s(!1)}}p()},[e,u]);const c=w.useMemo(()=>t.map(p=>({id:p.id,name:p.name,schoolId:p.school_id,rank:p.rank,requirement:p.requirement,castingTime:p.casting_time,range:p.range,duration:p.duration,description:p.description,willpowerCost:p.willpower_cost,createdAt:p.created_at,powerLevel:p.power_level})),[t]),d=w.useMemo(()=>{var p,g;return((g=(p=o==null?void 0:o.spells)==null?void 0:p.school)==null?void 0:g.name)??null},[(f=(h=o==null?void 0:o.spells)==null?void 0:h.school)==null?void 0:f.name]);return{learnedSpells:c,characterSchoolName:d,loading:n,error:i}}const tN=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,aI=(e,t)=>{var l,o;const r="WIL",n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=tN(s);return n?i*2:i};function iI({onClose:e}){var me;const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState("prepared"),[c,d]=w.useState({}),[h,f]=w.useState("all"),{toggleDiceRoller:p}=Zn(),{character:g,updateCharacterData:y,isSaving:E,setActiveStatusMessage:x}=hr(),{learnedSpells:b,characterSchoolName:v,loading:_,error:k}=sI(g==null?void 0:g.id),S=((me=g==null?void 0:g.attributes)==null?void 0:me.INT)??10,I=tN(S),j=w.useMemo(()=>new Set((g==null?void 0:g.prepared_spells)??[]),[g==null?void 0:g.prepared_spells]),P=w.useMemo(()=>b.filter(J=>J.rank>0&&j.has(J.id)).length,[b,j]),T=P<I,H=async(J,ae)=>{const Z=b.find(De=>De.id===J),le=ae?"Unprepare":"Prepare";if(console.log(`[SpellcastingView - Prepare] START: Initiating toggle for spell "${(Z==null?void 0:Z.name)||"Unknown"}". Action: ${le}`),s(null),!g){console.error("[SpellcastingView - Prepare] FAILED: Character object is not available.");return}const he=g.prepared_spells??[];let ye;if(ae)ye=he.filter(De=>De!==J);else{if(!T){const De=`Preparation limit reached (${I} based on INT ${S}).`;console.warn(`[SpellcastingView - Prepare] FAILED (UI Rule): ${De}`),s(De);return}ye=[...he,J]}const Le={prepared_spells:ye};console.log("[SpellcastingView - Prepare] BEFORE_SAVE: Calling updateCharacterData with payload:",Le);try{await y(Le),console.log(`[SpellcastingView - Prepare] SUCCESS: updateCharacterData promise resolved for spell "${(Z==null?void 0:Z.name)||"Unknown"}".`)}catch(De){console.error(`[SpellcastingView - Prepare] FAILED (catch block): Caught an error during update for spell "${(Z==null?void 0:Z.name)||"Unknown"}".`,{wasTryingTo:le.toLowerCase(),intendedUpdatePayload:Le,originalError:De}),s(De instanceof Error?De.message:"Failed to update preparation")}finally{console.log(`[SpellcastingView - Prepare] END: Finished toggle attempt for spell "${(Z==null?void 0:Z.name)||"Unknown"}".`)}},{preparedSpellsList:O,grimoireSpellsList:q}=w.useMemo(()=>{const J=b.filter(he=>he.rank===0),ae=b.filter(he=>he.rank>0&&j.has(he.id)),Z=[...J,...ae].sort((he,ye)=>he.rank-ye.rank||he.name.localeCompare(ye.name)),le=[...b].sort((he,ye)=>he.rank-ye.rank||he.name.localeCompare(ye.name));return{preparedSpellsList:Z,grimoireSpellsList:le}},[b,j]),G=w.useMemo(()=>{const J=new Set(b.map(ae=>ae.rank));return Array.from(J).sort((ae,Z)=>ae-Z)},[b]),$=w.useMemo(()=>{const J=[{label:"All",value:"all"}];return G.forEach(ae=>{ae===0?J.push({label:"Trick",value:0}):ae>=1&&ae<=9&&J.push({label:`Rank ${ae}`,value:ae})}),J},[G]),z=w.useMemo(()=>{const J=o==="prepared"?O:q;return h==="all"?J:J.filter(ae=>ae.rank===h)},[o,O,q,h]),{actualMagicSkillName:B,magicSkillValue:L,isMagicSkillAffected:Q}=w.useMemo(()=>{var he;if(!g||!v)return{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1};const J=["Animism","Elementalism","Mentalism","Symbolism","General Magic"],ae=g.skill_levels||{},Z=new Set([...g.trainedSkills||[],...Object.keys(ae)]);let le=null;if(v==="Animism"&&Z.has("Animism")?le="Animism":v==="Elementalism"&&Z.has("Elementalism")?le="Elementalism":v==="Mentalism"&&Z.has("Mentalism")?le="Mentalism":(le=J.find(ye=>Z.has(ye))??null,!le&&Z.has(v)&&(le=v)),le){const ye=ae[le],Le=ye!==void 0?ye:aI(g,le),De=((he=g.conditions)==null?void 0:he.scared)??!1;return{actualMagicSkillName:le,magicSkillValue:Le,isMagicSkillAffected:De}}return console.warn(`[SpellcastingView] Could not determine actual magic skill for school '${v}'.`),{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1}},[g,v]);if(w.useEffect(()=>{const J={};b.forEach(ae=>{ae.powerLevel==="yes"&&(J[ae.id]=c[ae.id]||1)}),d(J)},[b]),!g)return null;const N=async J=>{l(J.id),r(null);try{const ae=g.current_wp??g.attributes.WIL,Z=Number(J.willpowerCost??0),le=c[J.id]||1,he=J.powerLevel==="yes",ye=he?Z+(le-1)*2:Z;if(ae<ye)throw new Error(`Insufficient Willpower Points (Need ${ye}, Have ${ae})`);const Le=ae-ye;await y({current_wp:Le}),x(`Casted ${J.name}${he?` (Lvl ${le})`:""} for ${ye} WP.`)}catch(ae){console.error("Error casting spell:",ae),r(ae instanceof Error?ae.message:"Failed to cast spell")}finally{l(null)}},K=(J,ae)=>{d(Z=>{const le=Z[J]||1,he=Math.max(1,Math.min(3,le+ae));return{...Z,[J]:he}})},Y=()=>{!B||L===null||p({initialDice:["d20"],rollMode:"skillCheck",targetValue:L,description:`${B} Check`,requiresBane:Q,skillName:B})},A=({spell:J,isPreparedView:ae})=>{const Z=j.has(J.id),le=J.rank===0,he=!le&&(Z||T),ye=J.powerLevel==="yes",Le=c[J.id]||1,De=Number(J.willpowerCost??0),Qe=ye?De+(Le-1)*2:De,Je=(g.current_wp??g.attributes.WIL)<Qe;let V=`Rank ${J.rank}`,Ne="bg-amber-100",ue="text-amber-800",fe="border-amber-200";return J.rank===0?(V="Trick",Ne="bg-gray-100",ue="text-gray-800",fe="border-gray-300"):J.rank<=1?(Ne="bg-blue-100",ue="text-blue-800",fe="border-blue-200"):J.rank<=3&&(Ne="bg-purple-100",ue="text-purple-800",fe="border-purple-200"),a.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm flex flex-col justify-between ${!ae&&!le?"opacity-70":""}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-base text-gray-900",children:J.name}),!ae&&a.jsx("div",{className:"ml-2 flex-shrink-0",children:le?a.jsx(Ap,{className:"w-5 h-5 text-green-500",title:"Tricks are always prepared"}):a.jsx("button",{onClick:()=>H(J.id,Z),disabled:!he||E,className:"disabled:opacity-50 disabled:cursor-not-allowed",title:Z?"Unprepare":T?"Prepare":`Limit reached (${I})`,children:Z?a.jsx(Ap,{className:"w-5 h-5 text-blue-600 hover:text-blue-800"}):a.jsx(TE,{className:`w-5 h-5 ${T?"text-gray-400 hover:text-gray-600":"text-gray-300"}`})})})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Ne} ${ue} border ${fe}`,children:V}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yn,{size:14,className:"text-gray-400"}),a.jsxs("span",{children:[Qe," WP",ye&&Le>1&&a.jsxs("span",{className:"text-xs text-blue-600",children:[" (Lvl ",Le,")"]})]})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-2 mb-4",children:[J.requirement&&a.jsxs("p",{className:"text-amber-700 bg-amber-50 px-2 py-1 rounded border border-amber-200",children:[a.jsx("span",{className:"font-medium",children:"Requirement:"})," ",J.requirement]}),a.jsxs("p",{className:"whitespace-normal break-words",children:[a.jsx("span",{className:"font-medium",children:"Description:"})," ",J.description||"No description."]}),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1 text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(_h,{size:12})," ",J.castingTime]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(P4,{size:12})," ",J.range]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ug,{size:12})," ",J.duration]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yn,{size:12})," ",De," WP ",ye?"(Base)":""]})]})]})]}),ae&&a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center justify-center gap-1",children:ye?a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"primary",size:"sm",onClick:()=>K(J.id,-1),disabled:Le<=1||!!i||E,className:"px-2",title:"Decrease level",children:a.jsx(wE,{size:14})}),a.jsx(U,{variant:"primary",size:"sm",onClick:()=>N(J),loading:i===J.id||E,disabled:!!i||E||Je,className:"flex-grow min-w-[80px]",title:Je?`Need ${Qe} WP`:`Cast Lvl ${Le}`,children:i===J.id?"":`Cast Lvl ${Le}`}),a.jsx(U,{variant:"primary",size:"sm",onClick:()=>K(J.id,1),disabled:Le>=3||!!i||E,className:"px-2",title:"Increase level",children:a.jsx(Jt,{size:14})})]}):a.jsx(U,{variant:"primary",size:"sm",onClick:()=>N(J),loading:i===J.id||E,disabled:!!i||E||Je,className:"w-full",title:Je?`Need ${Qe} WP`:`Cast ${J.name}`,children:i===J.id?"":"Cast"})})}),!ae&&!le&&a.jsx("div",{className:"mt-auto pt-3 text-center text-xs text-gray-400 italic",children:Z?"Prepared":"Prepare in Grimoire"})]})};return _?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:[a.jsx($e,{}),a.jsx("p",{className:"text-center mt-2 text-gray-600",children:"Loading spells..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-7xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 text-gray-800 mb-1",children:[a.jsx(nl,{className:"w-6 h-6 text-purple-600"}),"Spellcasting"]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Current WP: ",a.jsx("strong",{className:"font-semibold",children:g.current_wp??g.attributes.WIL})," / ",g.attributes.WIL]}),B&&L!==null&&a.jsxs("div",{className:`flex items-center gap-1 cursor-pointer px-2 py-0.5 rounded transition-colors ${Q?"text-red-700 bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 ring-1 ring-indigo-200"}`,onClick:Y,title:`Click to roll ${B} (Target  ${L}${Q?", Bane":""})`,children:[a.jsx(ur,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"font-medium",children:[B,":"]}),a.jsx("span",{children:L}),Q&&a.jsx("span",{className:"text-xs font-semibold",children:"(Bane)"})]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none focus:outline-none mt-[-4px]",children:""})]}),t&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Casting Error"}),a.jsx("p",{className:"text-xs text-red-700",children:t})]}),n&&a.jsxs("div",{className:"mb-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Preparation Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:n})]}),k&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Spell Data Error"}),a.jsx("p",{className:"text-xs text-red-700",children:k})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-6",children:[a.jsxs("button",{onClick:()=>{u("prepared"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="prepared"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Md,{size:16})," Prepared (",O.length,")"]}),a.jsxs("button",{onClick:()=>{u("grimoire"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="grimoire"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(og,{size:16})," Grimoire (",b.length,")"]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"py-3 px-1 text-sm text-gray-500",children:["Preparation Slots: ",a.jsxs("span",{className:"font-medium",children:[P," / ",I]})," (INT ",S,")"]})]})}),b.length>0&&$.length>1&&a.jsxs("div",{className:"pt-4 flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-600 flex items-center gap-1 mr-1 shrink-0",children:[a.jsx(Ns,{size:14})," Filter:"]}),$.map(J=>a.jsx(U,{variant:h===J.value?"primary":"outline",size:"xs",onClick:()=>f(J.value),className:`px-2.5 py-1 ${h===J.value?"":"text-gray-600 bg-white hover:bg-gray-50"}`,children:J.label},J.value))]})]}),a.jsx("div",{className:"overflow-y-auto flex-grow p-6 bg-gray-50",children:z.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:z.map(J=>a.jsx(A,{spell:J,isPreparedView:o==="prepared"},J.id))}):a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[_&&a.jsx("p",{children:"Loading spells..."}),!_&&k&&a.jsx("p",{children:"Could not load spell details."}),!_&&!k&&a.jsxs(a.Fragment,{children:[o==="prepared"&&O.length===0&&a.jsx("p",{children:"No spells prepared. Go to the Grimoire tab. Tricks are always prepared."}),o==="grimoire"&&q.length===0&&a.jsx("p",{children:"Character has not learned any spells."}),z.length===0&&a.jsx("p",{children:"No spells match the selected rank filter."})]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,disabled:!!i||E,children:"Close"})})]})})}function Oc(e,t){var c;const r=e.trim();let n=r,s=1,i;const l=r.match(/^(\d+)\s+(.*)/),o=r.match(/^(.*?)\s+(\d+)\s*(\w+)?$/);l?(s=parseInt(l[1],10),n=l[2].trim(),n.match(/^(.*?)\s+(\d+)\s*(\w+)?$/)&&console.warn(`Ambiguous item string: "${r}". Using quantity ${s} for name "${n}".`)):o&&(n=o[1].trim(),s=parseInt(o[2],10),i=(c=o[3])==null?void 0:c.trim());const u=t==null?void 0:t.find(d=>{var h;return((h=d.name)==null?void 0:h.toLowerCase())===n.toLowerCase()});return{name:n,quantity:s,unit:i,originalName:r,description:u==null?void 0:u.description,weight:u==null?void 0:u.weight,cost:u==null?void 0:u.cost,category:u==null?void 0:u.category,damage:u==null?void 0:u.damage,armor_rating:u==null?void 0:u.armor_rating,grip:u==null?void 0:u.grip,range:u==null?void 0:u.range,durability:u==null?void 0:u.durability,features:u==null?void 0:u.features,effect:u==null?void 0:u.effect,id:`${n}-${Date.now()}-${Math.random()}`}}function Pc(e){let t="";return e.quantity>1?t=` (x${e.quantity}${e.unit?" "+e.unit:""})`:e.unit&&(t=` (${e.quantity} ${e.unit})`),`${e.name}${t}`}function Dc(e,t){const r=e.findIndex(n=>n.name.toLowerCase()===t.name.toLowerCase()&&n.unit===t.unit);if(r>-1){const n=[...e],s=n[r];return n[r]={...s,quantity:s.quantity+t.quantity,originalName:`${t.quantity>1?t.quantity+" ":""}${s.name}${t.unit?" "+t.unit:""}`.trim()},n}else return[...e,t]}const gb=["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS","CLOTHES","MUSICAL INSTRUMENTS","TRADE GOODS","STUDIES & MAGIC","LIGHT SOURCES","TOOLS","CONTAINERS","MEDICINE","SERVICES","HUNTING & FISHING","MEANS OF TRAVEL","ANIMALS"],lI=[{name:"Armor & Weapons",categories:["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS"],Icon:bs},{name:"Clothing & Accessories",categories:["CLOTHES"],Icon:xu},{name:"Musical & Trade Goods",categories:["MUSICAL INSTRUMENTS","TRADE GOODS"],Icon:Vy},{name:"Magic & Studies",categories:["STUDIES & MAGIC"],Icon:C4},{name:"Light & Tools",categories:["LIGHT SOURCES","TOOLS"],Icon:U4},{name:"Containers & Medicine",categories:["CONTAINERS","MEDICINE"],Icon:xu},{name:"Services",categories:["SERVICES"],Icon:Vy},{name:"Hunting & Travel",categories:["HUNTING & FISHING","MEANS OF TRAVEL"],Icon:hE},{name:"Animals",categories:["ANIMALS"],Icon:Qu}];function oI({onClose:e}){var L,Q,N,K,Y,A,me,J,ae,Z,le,he,ye,Le,De,Qe,Je;const{isAdmin:t,isDM:r}=Vt(),[n,s]=w.useState(null),[i,l]=w.useState("inventory"),[o,u]=w.useState({search:"",category:"all"}),[c,d]=w.useState({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""}),[h,f]=w.useState(!1),[p,g]=w.useState(null),{character:y,updateCharacterData:E,updateInventory:x,isSaving:b,saveError:v,allGameItems:_,isLoadingGameItems:k,_loadGameItems:S}=hr(V=>({character:V.character,updateCharacterData:V.updateCharacterData,updateInventory:V.updateInventory,isSaving:V.isSaving,saveError:V.saveError,allGameItems:V.allGameItems,isLoadingGameItems:V.isLoadingGameItems,_loadGameItems:V._loadGameItems}));if(w.useEffect(()=>{_.length===0&&!k&&S()},[S,_,k]),w.useEffect(()=>{if(v){s(`Save failed: ${v}`);const V=setTimeout(()=>s(null),5e3);return()=>clearTimeout(V)}else s(null)},[v]),!y)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 text-center",children:[a.jsx($e,{}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Loading character data..."})]})});const I=V=>{if(!(!V||typeof V!="string"))return _.find(Ne=>{var ue;return((ue=Ne.name)==null?void 0:ue.toLowerCase())===V.toLowerCase()})},j=(V,Ne)=>{var _e;s(null);const ue=((_e=y.equipment)==null?void 0:_e.money)||{gold:0,silver:0,copper:0},fe=Math.max(0,(ue[V]||0)+Ne);E({equipment:{...y.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},money:{...ue,[V]:fe}}})},P=()=>{var _e,nt,at;if(s(null),!c.name||!c.cost){s("Name and cost are required for custom items");return}if(!ib(c.cost)){s('Invalid cost format. Use e.g., "10 silver", "1 gold 5 copper".');return}const Ne={id:`custom-${Date.now()}-${Math.random().toString(36).substring(7)}`,name:c.name.trim(),quantity:c.quantity>0?c.quantity:1,unit:((_e=c.unit)==null?void 0:_e.trim())||void 0,originalName:Pc({name:c.name.trim(),quantity:c.quantity,unit:(nt=c.unit)==null?void 0:nt.trim()}),cost:c.cost,weight:c.weight,category:c.category,effect:c.effect||void 0},ue=((at=y.equipment)==null?void 0:at.inventory)||[],fe=Dc(ue,Ne);x(fe),f(!1),d({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""})},T=(V,Ne)=>{var xe;s(null);const ue=I(V.name);if(!ue){s(`Details not found for item: ${V.name}`);return}const fe=3,_e=structuredClone(y.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}}),nt=_e.inventory,at=_e.equipped;at.weapons||(at.weapons=[]);const pt=nt[Ne];if(!pt||pt.id!==V.id){s(`Item "${V.name}" not found at expected index ${Ne}. Inventory might be out of sync.`);return}pt.quantity>1?nt[Ne]={...pt,quantity:pt.quantity-1}:nt.splice(Ne,1);const Wt=((xe=ue.category)==null?void 0:xe.toUpperCase())||"";let Gt=null;const Rt=Wt==="MELEE WEAPONS"||Wt==="RANGED WEAPONS",ee=Wt==="ARMOR & HELMETS"&&ue.name.toLowerCase().includes("shield"),de=Wt==="ARMOR & HELMETS"&&ue.name.toLowerCase().includes("helmet"),je=Wt==="ARMOR & HELMETS"&&!ee&&!de;try{if(Rt||ee){if(at.weapons.length>=fe)throw new Error(`Cannot equip ${V.name}. You can only have up to ${fe} weapons or shields at hand.`);const Ae={name:V.name,grip:ue.grip||(ee?"Shield":"1H"),range:ue.range,damage:ue.damage,durability:ue.durability,features:ue.features||[]};at.weapons.push(Ae)}else if(je){const Ae="armor",Tt=at[Ae];Tt&&(Gt=Oc(Tt,_),Gt.quantity=1),at[Ae]=V.name}else if(de){const Ae="helmet",Tt=at[Ae];Tt&&(Gt=Oc(Tt,_),Gt.quantity=1),at[Ae]=V.name}else throw new Error(`Item "${V.name}" category "${ue.category}" is not directly equippable.`);Gt?_e.inventory=Dc(nt,Gt):_e.inventory=nt,E({equipment:_e})}catch(Ae){s(Ae.message||"Failed to equip item.")}},H=(V,Ne)=>{var at;s(null);const ue=structuredClone(y.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}});if(!ue.equipped)return;let fe=null,_e=ue.equipped,nt=ue.inventory;if(V==="armor"&&_e.armor)fe=_e.armor,_e.armor=void 0;else if(V==="helmet"&&_e.helmet)fe=_e.helmet,_e.helmet=void 0;else if(V==="weapon"&&typeof Ne=="number"&&((at=_e.weapons)!=null&&at[Ne]))fe=_e.weapons[Ne].name,_e.weapons.splice(Ne,1);else{s(`Could not find item to unequip (${V}, ${Ne})`);return}if(fe){I(fe);let pt;pt=Oc(fe,_),pt.quantity=1,nt=Dc(nt,pt),E({equipment:{...ue,inventory:nt,equipped:_e}})}else E({equipment:ue})},O=V=>{var Wt,Gt;s(null);const Ne=ib(V.cost);if(!Ne){s(`Invalid cost format for item: ${V.name} (${V.cost})`);return}const ue=((Wt=y.equipment)==null?void 0:Wt.money)||{gold:0,silver:0,copper:0},{success:fe,newMoney:_e}=N5(ue,Ne);if(!fe){s("Not enough money to buy this item."),setTimeout(()=>s(null),3e3);return}const nt=Oc(V.name||"Unknown Item",_);nt.quantity<=0&&(nt.quantity=1);const at=((Gt=y.equipment)==null?void 0:Gt.inventory)||[],pt=Dc(at,nt);E({equipment:{...y.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},inventory:pt,money:_e}})},q=V=>{var ue;s(null);const Ne=[...((ue=y.equipment)==null?void 0:ue.inventory)||[]];if(V<0||V>=Ne.length){s("Invalid item index for dropping.");return}Ne.splice(V,1),x(Ne)},G=V=>{var fe;s(null);const Ne=[...((fe=y.equipment)==null?void 0:fe.inventory)||[]];if(V<0||V>=Ne.length){s("Invalid item index for using.");return}const ue={...Ne[V]};ue.quantity>1?(ue.quantity-=1,Ne[V]=ue):Ne.splice(V,1),x(Ne)},$=(((L=y.equipment)==null?void 0:L.inventory)||[]).filter(V=>{if(!V||typeof V.name!="string")return!1;const Ne=V.name.toLowerCase(),ue=o.search.toLowerCase(),fe=I(V.name),_e=typeof(fe==null?void 0:fe.category)=="string"?fe.category.toUpperCase():"",nt=typeof V.originalName=="string"?V.originalName.toLowerCase():"",at=Ne.includes(ue)||nt.includes(ue),pt=o.category==="all"||_e===o.category.toUpperCase();return at&&pt}),z=_.filter(V=>{if(!V||typeof V.name!="string")return!1;const Ne=V.name.toLowerCase(),ue=o.search.toLowerCase(),fe=typeof V.category=="string"?V.category.toUpperCase():"",_e=Ne.includes(ue),nt=p?p.categories.includes(fe||""):o.category==="all"||fe===o.category.toUpperCase();return _e&&nt}),B=()=>{var Ne,ue;const V=(Ne=y.equipment)==null?void 0:Ne.equipped;return!V||!V.armor&&!V.helmet&&(!V.weapons||V.weapons.length===0)?null:a.jsxs("div",{className:"mt-6 pt-4 border-t",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-600 mb-3",children:"Equipped Items"}),a.jsxs("div",{className:"space-y-2",children:[V.armor&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[V.armor," (Armor)"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:If,onClick:()=>H("armor",V.armor),disabled:b,title:`Unequip ${V.armor}`,children:"Unequip"})]}),V.helmet&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[V.helmet," (Helmet)"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:If,onClick:()=>H("helmet",V.helmet),disabled:b,title:`Unequip ${V.helmet}`,children:"Unequip"})]}),(ue=V.weapons)==null?void 0:ue.map((fe,_e)=>{const nt=fe.grip==="Shield"?"Shield":`${fe.grip} Weapon`;return a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[fe.name," (",nt,")"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:If,onClick:()=>H("weapon",_e),disabled:b,title:`Unequip ${fe.name}`,children:"Unequip"})]},`${fe.name}-${_e}`)})]})]})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-4 md:p-6 border-b flex-shrink-0 bg-gray-50 rounded-t-lg",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800",children:i==="inventory"?"Inventory & Equipped":i==="shop"?"Shop":"Money"}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs md:text-sm font-medium",children:[a.jsx(u4,{className:"w-3 h-3 md:w-4 md:h-4"}),E5(((Q=y.equipment)==null?void 0:Q.money)||{gold:0,silver:0,copper:0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{size:"sm",variant:i==="inventory"?"primary":"secondary",onClick:()=>{l("inventory"),g(null)},children:"Inventory"}),a.jsx(U,{size:"sm",variant:i==="shop"?"primary":"secondary",onClick:()=>{l("shop"),g(null)},children:"Shop"}),a.jsx(U,{size:"sm",variant:i==="money"?"primary":"secondary",onClick:()=>{l("money"),g(null)},children:"Money"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-800 rounded-full hover:bg-gray-200 transition-colors",children:a.jsx(Dt,{className:"w-5 h-5"})})]})]}),(i==="inventory"||i==="shop"&&!p)&&a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mt-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:`Search ${i==="inventory"?"inventory by name":"shop"}...`,value:o.search,onChange:V=>u({...o,search:V.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsxs("select",{value:o.category,onChange:V=>u({...o,category:V.target.value}),className:"w-full md:w-auto pl-9 pr-8 py-2 border rounded-lg appearance-none bg-white text-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),gb.map(V=>a.jsx("option",{value:V,children:V},V))]})]}),i==="inventory"&&(t()||r())&&a.jsx(U,{variant:"secondary",size:"sm",icon:Jt,onClick:()=>f(!0),children:"Custom Item"})]}),i==="shop"&&p&&a.jsx(U,{variant:"secondary",size:"sm",icon:Eh,onClick:()=>g(null),className:"mt-3",children:"Back to Categories"})]}),a.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto flex-1 bg-white",children:[n&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:n})}),(k||b)&&a.jsxs("div",{className:"flex justify-center items-center py-10",children:[a.jsx($e,{}),a.jsx("span",{className:"ml-2 text-gray-600",children:b?"Saving...":"Loading items..."})]}),i==="money"&&!b&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-yellow-800 text-center",children:"Gold"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("gold",-1),disabled:b||(((K=(N=y.equipment)==null?void 0:N.money)==null?void 0:K.gold)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-yellow-900 min-w-[3ch] text-center",children:((A=(Y=y.equipment)==null?void 0:Y.money)==null?void 0:A.gold)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("gold",1),disabled:b,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border border-gray-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-gray-800 text-center",children:"Silver"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("silver",-1),disabled:b||(((J=(me=y.equipment)==null?void 0:me.money)==null?void 0:J.silver)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-gray-900 min-w-[3ch] text-center",children:((Z=(ae=y.equipment)==null?void 0:ae.money)==null?void 0:Z.silver)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("silver",1),disabled:b,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-orange-800 text-center",children:"Copper"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("copper",-1),disabled:b||(((he=(le=y.equipment)==null?void 0:le.money)==null?void 0:he.copper)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-orange-900 min-w-[3ch] text-center",children:((Le=(ye=y.equipment)==null?void 0:ye.money)==null?void 0:Le.copper)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>j("copper",1),disabled:b,children:"+1"})]})]})]}),(t()||r())&&a.jsxs("div",{className:"mt-6 pt-6 border-t",children:[a.jsx("h3",{className:"font-medium mb-3 text-sm text-gray-600",children:"Quick Add (Admin/DM)"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsx(U,{variant:"outline",size:"sm",onClick:()=>j("gold",10),disabled:b,children:"+10 Gold"}),a.jsx(U,{variant:"outline",size:"sm",onClick:()=>j("silver",50),disabled:b,children:"+50 Silver"}),a.jsx(U,{variant:"outline",size:"sm",onClick:()=>j("copper",100),disabled:b,children:"+100 Copper"})]})]})]}),i==="shop"&&!k&&!b&&(p===null?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 md:gap-4",children:lI.map(V=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-3 md:p-4 border rounded-lg hover:shadow-lg cursor-pointer transition-shadow bg-white hover:bg-gray-50",onClick:()=>g(V),children:[a.jsx(V.Icon,{className:"w-8 h-8 md:w-10 md:h-10 text-blue-600 mb-2"}),a.jsx("span",{className:"font-medium text-center text-xs md:text-sm",children:V.name})]},V.name))}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[z.map(V=>a.jsxs("div",{className:"group relative flex flex-col p-3 border rounded-lg hover:shadow-md transition-shadow bg-white",children:[a.jsxs("div",{className:"flex-1 mb-2",children:[a.jsx("h4",{className:"font-medium text-sm",children:V.name}),a.jsx("p",{className:"text-xs text-gray-500",children:V.category}),a.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:V.effect||V.description||"No description."})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-100",children:[a.jsx("span",{className:"text-xs font-semibold text-green-700",children:V.cost||"N/A"}),a.jsx(U,{variant:"primary",size:"xs",onClick:()=>O(V),disabled:b||!V.cost,children:"Buy"})]}),(V.effect||V.description)&&a.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:V.effect||V.description})]},V.id)),z.length===0&&a.jsx("p",{className:"text-gray-500 italic col-span-full text-center py-6",children:"No items found matching filters in this category."})]})),i==="inventory"&&!b&&a.jsxs(a.Fragment,{children:[B(),a.jsx("h3",{className:"font-medium text-sm text-gray-600 mt-6 mb-3 pt-4 border-t",children:"Inventory Items"}),a.jsxs("div",{className:"space-y-3",children:[(((De=y.equipment)==null?void 0:De.inventory)||[]).map((V,Ne)=>{var at,pt,Wt;if(!$.includes(V)||!V||typeof V.name!="string")return null;const ue=I(V.name),fe=typeof(ue==null?void 0:ue.category)=="string"?ue.category.toUpperCase():"",_e=ue&&(fe==="ARMOR & HELMETS"||fe==="MELEE WEAPONS"||fe==="RANGED WEAPONS"),nt=V.quantity>0&&(((at=ue==null?void 0:ue.category)==null?void 0:at.toUpperCase())==="MEDICINE"||((pt=ue==null?void 0:ue.category)==null?void 0:pt.toUpperCase())==="STUDIES & MAGIC"||((Wt=ue==null?void 0:ue.category)==null?void 0:Wt.toUpperCase())==="LIGHT SOURCES"||V.name.toLowerCase().includes("ration"));return a.jsxs("div",{className:"group relative p-3 border rounded-lg hover:shadow-sm transition-shadow flex items-center justify-between gap-2 bg-white",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-sm truncate",title:Pc(V),children:Pc(V)}),ue&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-1",children:ue.effect||ue.description||"No description."})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ue==null?void 0:ue.category)&&a.jsx("span",{className:"hidden sm:inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 text-gray-700 whitespace-nowrap",children:ue.category}),nt&&a.jsx(U,{variant:"outline",size:"xs",icon:i4,onClick:()=>G(Ne),disabled:b,title:`Use one ${V.name}`,children:"Use"}),_e&&a.jsx(U,{variant:"secondary",size:"xs",icon:Ap,onClick:()=>T(V,Ne),disabled:b,title:`Equip ${V.name}`,children:"Equip"}),a.jsx(U,{variant:"dangerOutline",size:"xs",icon:cr,onClick:()=>q(Ne),disabled:b,title:`Drop ${Pc(V)}`,children:"Drop"}),((ue==null?void 0:ue.effect)||(ue==null?void 0:ue.description))&&a.jsxs("span",{className:"relative inline-block ml-1",children:[a.jsx(Gn,{className:"w-4 h-4 text-gray-400 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:[a.jsx("h5",{className:"font-semibold mb-1 border-b border-gray-600 pb-1",children:ue.name}),ue.effect||ue.description,ue.weight&&a.jsxs("p",{className:"mt-1 text-gray-300",children:["Weight: ",ue.weight]}),ue.cost&&a.jsxs("p",{className:"text-gray-300",children:["Cost: ",ue.cost]})]})]})]})]},V.id||`${V.name}-${Ne}`)}),$.length===0&&(((Qe=y.equipment)==null?void 0:Qe.inventory)||[]).length>0&&a.jsx("div",{className:"text-center py-8 text-gray-500 italic",children:"No items match current filters."}),(((Je=y.equipment)==null?void 0:Je.inventory)||[]).length===0&&!B()&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(xu,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{className:"text-gray-500",children:"Inventory is empty."}),a.jsx(U,{variant:"link",size:"sm",onClick:()=>l("shop"),className:"mt-2",children:"Go to Shop"})]})]}),h&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Create Custom Item"}),a.jsx("button",{onClick:()=>f(!1),className:"p-1 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-200",children:a.jsx(Dt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Name"}),a.jsx("input",{type:"text",value:c.name,onChange:V=>d({...c,name:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Category"}),a.jsx("select",{value:c.category,onChange:V=>d({...c,category:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm bg-white",children:gb.map(V=>a.jsx("option",{value:V,children:V},V))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Cost (per item)"}),a.jsx("input",{type:"text",value:c.cost,onChange:V=>d({...c,cost:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., 1 gold 5 silver"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Weight (per item)"}),a.jsx("input",{type:"number",value:c.weight,onChange:V=>d({...c,weight:Number(V.target.value)}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Quantity"}),a.jsx("input",{type:"number",value:c.quantity,onChange:V=>d({...c,quantity:Math.max(1,Number(V.target.value))}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"1"})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Unit (Optional)"}),a.jsx("input",{type:"text",value:c.unit,onChange:V=>d({...c,unit:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., meters, doses"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Effect/Description"}),a.jsx("textarea",{value:c.effect,onChange:V=>d({...c,effect:V.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",rows:2})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>f(!1),children:"Cancel"}),a.jsx(U,{variant:"primary",size:"sm",icon:Jt,onClick:P,disabled:b||!c.name||!c.cost,children:"Add Item"})]})]})]})]})]})})}const Uf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},uI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,cI=(e,t,r)=>{var l,o;const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=uI(s);return n?i*2:i},dI=e=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[e],hI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}else if(typeof e=="object"&&e!==null)return e;return{}},xb=e=>e?e.split("(")[0].trim():null,fI=e=>["d4","d6","d8","d10","d12","d20"].includes(e),Bf=e=>e?Array.isArray(e)?e.join(", "):e:"-";function mI({character:e}){var b,v,_,k,S,I;const{toggleDiceRoller:t}=Zn(),{data:r=[],isLoading:n,error:s}=Ut({queryKey:["gameItems"],queryFn:jh,staleTime:1e3*60*10}),i=j=>{if(j)return r.find(P=>{var T;return((T=P.name)==null?void 0:T.toLowerCase())===j.toLowerCase()})},l=()=>{var H,O,q,G;let j=0;const P=(O=(H=e.equipment)==null?void 0:H.equipped)==null?void 0:O.armor,T=(G=(q=e.equipment)==null?void 0:q.equipped)==null?void 0:G.helmet;if(P){const $=i(P);j+=Number($==null?void 0:$.armor_rating)||0}if(T){const $=i(T);j+=Number($==null?void 0:$.armor_rating)||0}return j},o=(j,P)=>{const T=P==null?void 0:P.match(/(\d+)?d(\d+)/i);let H=["d6"],O="1d6";if(T){const K=T[1]?parseInt(T[1],10):1,Y=`d${T[2]}`;fI(Y)&&(H=Array(K).fill(Y),O=`${K}d${T[2]}`)}let q="",G=null;const $=i(j),z=$==null?void 0:$.skill,B=xb(z),L=B?Uf[B]:null;L==="STR"?e.attributes.STR>15?(q="d6",G="d6"):e.attributes.STR>12&&(q="d4",G="d4"):L==="AGL"&&(e.attributes.AGL>15?(q="d6",G="d6"):e.attributes.AGL>12&&(q="d4",G="d4"));let Q=O;q&&(Q+=` + ${q}`);const N=[...H];G&&N.push(G),t({rollMode:"attackDamage",initialDice:N,description:`Damage roll for ${j} (${Q})`})},u=(j,P,T)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:P,description:`${j} Check`,requiresBane:T,skillName:j})},c=l(),d=((v=(b=e.equipment)==null?void 0:b.equipped)==null?void 0:v.weapons)||[],h=hI(e.skill_levels),f=(k=(_=e.equipment)==null?void 0:_.equipped)==null?void 0:k.armor,p=(I=(S=e.equipment)==null?void 0:S.equipped)==null?void 0:I.helmet,g=f?i(f):void 0,y=p?i(p):void 0,E=g?Bf(g.features):"-",x=y?Bf(y.features):"-";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[" ",a.jsx(bs,{className:"w-5 h-5 text-blue-600"})," Armor"]}),n?a.jsx($e,{size:"sm"}):s?a.jsx(Ie,{message:"Could not load item details for armor."}):a.jsxs("div",{className:"space-y-3",children:[" ",a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Body:"})," ",(g==null?void 0:g.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(g==null?void 0:g.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",g.armor_rating,")"]})]}),g&&g.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(qy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:E})]})]}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Helmet:"})," ",(y==null?void 0:y.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(y==null?void 0:y.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",y.armor_rating,")"]})]}),y&&y.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(qy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:x})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium mt-2",children:[a.jsx(bs,{className:"w-4 h-4"}),a.jsxs("span",{children:["Total Armor Rating: ",c]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[a.jsx(ui,{className:"w-5 h-5 text-red-600"})," Weapons"]}),n?a.jsx($e,{size:"sm"}):s?a.jsx(Ie,{message:"Could not load item details for weapons."}):d.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No weapons equipped."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Weapon / Shield"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Grip"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Range"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Damage"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Features"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:d.map((j,P)=>{var B;const T=i(j.name),H=T==null?void 0:T.skill,O=xb(H);let q=null,G=!1,$=null;if(O&&Uf[O]){$=Uf[O],q=(h==null?void 0:h[O])??cI(e,O,$);const L=dI($);G=((B=e.conditions)==null?void 0:B[L])??!1}const z=Bf(j.features);return a.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:j.name}),a.jsx("td",{className:"px-4 py-2",children:j.grip||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.range||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.damage||"-"}),a.jsx("td",{className:"px-4 py-2",children:z}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[j.damage?a.jsxs(U,{variant:"link",size:"xs",onClick:()=>o(j.name,j.damage),className:"text-red-600 hover:text-red-800 font-medium p-0 flex items-center gap-1",title:`Roll damage for ${j.name} (${j.damage})`,children:[a.jsx(ur,{className:"w-3 h-3"}),"Damage"]}):null,O&&q!==null?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(U,{variant:"link",size:"xs",onClick:()=>u(O,q,G),className:`${G?"text-red-600 hover:text-red-800":"text-indigo-600 hover:text-indigo-800"} font-medium p-0 flex items-center gap-1`,title:`Roll ${O} check (Target  ${q}${G?", Bane":""})`,children:[a.jsx(ur,{className:"w-3 h-3"}),O,": ",q]}),G&&a.jsx("span",{className:"text-xs text-red-500 font-semibold",children:"(Bane)"})]}):H?a.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Skill '${H}' not found or level unavailable.`,children:["(",O||H," N/A)"]}):null]})})]},`${j.name}-${P}`)})})]})})]})]})}function bg(e){return typeof e!="object"||e===null||Array.isArray(e)?!1:Object.values(e).every(t=>typeof t=="number"||t===null)}function yb(e){return typeof e!="object"||e===null?!1:typeof e.skill_id=="string"&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}const pI=e=>Object.entries(e).map(([t,r])=>r!==null?`${t} (Level ${r})`:t).join(", "),gI=e=>e?typeof e=="string"?e:bg(e)?pI(e):typeof e=="object"?(console.warn("Unexpected requirement object format:",e),`Requires: ${Object.keys(e).join(", ")}`):(console.warn("Unexpected requirement type:",typeof e,e),"Unknown requirement format"):null;function xI({onClose:e}){const{character:t,allHeroicAbilities:r,isLoading:n,error:s,updateCharacterData:i,isSaving:l,setActiveStatusMessage:o}=hr(),[u,c]=w.useState(null);if(!t)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6",children:[a.jsx($e,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]})});const d=w.useMemo(()=>{if(!r||!t||!t.heroic_abilities)return[];const g=new Set(Array.isArray(t.heroic_abilities)?t.heroic_abilities:[]);return r.filter(y=>g.has(y.name))},[r,t]),h=async g=>{c(null);const y=g.willpower_cost,E=t.current_wp;if(y===null||y<=0){o(`Used Heroic Ability: ${g.name}`);return}if(typeof E!="number"){const x=`Cannot activate ${g.name}: Current Willpower is invalid.`;c(x);return}if(E>=y){const x=E-y;try{await i({current_wp:x}),o(`Used Heroic Ability: ${g.name} for ${y} WP.`)}catch(b){c(`Failed to update Willpower: ${b.message}`)}}else c(`Not enough Willpower. Required: ${y}, Available: ${E}`)},f=()=>n?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx($e,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]}):s?a.jsx("div",{className:"p-6",children:a.jsx(Ie,{message:`Failed to load required data: ${s}`})}):t.profession==="Mage"?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Magic Instead of Heroic Abilities"}),a.jsx("p",{className:"text-sm text-blue-700",children:"As a mage, you use magic instead of heroic abilities. Check the Spells tab to manage your capabilities."})]})]})}):d.length===0?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx(Gn,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"No Heroic Abilities Assigned"}),a.jsx("p",{className:"text-sm text-gray-700",children:"This character does not currently have any heroic abilities assigned."})]})]})}):a.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[u&&a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(_E,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800",children:"Activation Failed"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(g=>{const y=g.willpower_cost,E=t.current_wp,x=y===null||y<=0||typeof E=="number"&&E>=y,b=gI(g.requirement);return a.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:g.name}),a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded-full",children:y!==null&&y>0?a.jsxs(a.Fragment,{children:[a.jsx(Th,{className:"w-4 h-4 text-amber-500"}),a.jsxs("span",{children:[y," WP"]})]}):a.jsx("span",{className:"text-green-600",children:"Free"})})]}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:g.description}),b&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Requirement: ",b]})]}),a.jsxs(U,{onClick:()=>h(g),disabled:!x||l,loading:l,variant:x?"default":"secondary",size:"sm",className:"w-full mt-4",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Activate ",y!==null&&y>0?`(${y} WP)`:""]})]},g.id)})})]}),p=typeof t.current_wp=="number"?t.current_wp:"N/A";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(pg,{className:"w-6 h-6 text-blue-600"}),"Heroic Abilities"]}),a.jsxs("p",{className:"text-gray-600",children:["Available Willpower: ",p," WP"]})]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-3xl leading-none","aria-label":"Close",children:""})]}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:f()}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,children:"Close"})})]})})}async function yI(){const{data:e,error:t}=await te.from("heroic_abilities").select(`
      id,
      name,
      description,
      willpower_cost,
      requirement,
      kin,        
      profession  
    `);if(t)throw console.error("Error fetching heroic abilities:",t),new Error(t.message||"Failed to fetch heroic abilities");return(e||[]).map(n=>({id:n.id,name:n.name,description:n.description,willpower_cost:n.willpower_cost,requirement:n.requirement,kin:n.kin,profession:n.profession}))}const bb={Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},bI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,ts=e=>{const t=hr.getState().character,r=(t==null?void 0:t.skill_levels)||{};return(r==null?void 0:r[e])??0};function vI(e){const t=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming","Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],r=new Set([...e.trainedSkills||[],...t]);e.magicSchool&&Object.keys(bb).forEach(l=>r.add(l));const n={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",...bb},s=[],i=e.skill_levels||{};return r.forEach(l=>{var h;const o=n[l];if(!o)return;const u=((h=e.trainedSkills)==null?void 0:h.includes(l))??!1,d=(i==null?void 0:i[l])??(()=>{const f=e.attributes[o],p=bI(f);return u?p*2:p})();s.push({name:l,attribute:o,level:d,isTrained:u})}),s.sort((l,o)=>l.name.localeCompare(o.name)),s}const wI=(e,t)=>{var l,o;if(!t)return!1;if(!e.requirement)return!0;const r=e.requirement,n=t.attributes,s=t.skill_levels||{},i=Object.fromEntries(Object.entries(n).map(([u,c])=>[u.toUpperCase(),c]));if(typeof r=="string"){const u=r.split(" ");if(u.length===2){const c=u[0].toUpperCase(),d=parseInt(u[1],10);if(!isNaN(d)){if(c in i)return i[c]>=d;const h=(l=Object.entries(s).find(([f])=>f.toUpperCase()===c))==null?void 0:l[1];if(h!==void 0)return h>=d}}return!1}else if(typeof r=="object"&&r!==null){for(const[u,c]of Object.entries(r)){if(c==null)continue;const d=u.toUpperCase();if(d in i){if(i[d]<c)return!1}else{const h=(o=Object.entries(s).find(([f])=>f.toUpperCase()===d))==null?void 0:o[1];if(h===void 0||h<c)return!1}}return!0}return!1},rN=e=>e!=null&&e.known?Array.from(new Set(e.known.map(t=>t.toUpperCase()))):[],EI=(e,t,r,n)=>{if(!e)return!0;const s=rN(t.spells),i=t.skill_levels||{},l=t.attributes,o=y=>{let E=!1;switch(y.type){case"spell":E=s.includes(y.name.toUpperCase());break;case"school":E=(r==null?void 0:r.toUpperCase())===y.name.toUpperCase();break;case"anySchool":E=!!t.magicSchool;break;case"skill":const x=i[y.name];E=x!==void 0&&x>=y.value;break;case"attribute":const b=l[y.name.toUpperCase()];E=b!==void 0&&b>=y.value;break}return y.negate?!E:E};let u;const c=y=>{const E=y.operator.toUpperCase();if(E==="AND"){const x=y.conditions.every(b=>u(b));return y.negate?!x:x}else if(E==="OR"){const x=y.conditions.some(b=>u(b));return y.negate?!x:x}return!1};u=y=>"operator"in y?c(y):o(y);let d=null;try{e.trim().startsWith("{")&&(d=JSON.parse(e))}catch{}if(d)return u(d);const h=n.map(y=>y.name.toUpperCase()),f=r,p=y=>{const E=y.trim().toUpperCase();if(E==="ANY SCHOOL OF MAGIC")return!!t.magicSchool;if(s.includes(E))return!0;if(h.includes(E))return(f==null?void 0:f.toUpperCase())===E;const x=E.split(" ");if(x.length===2){const[b,v]=x,_=parseInt(v,10);if(!isNaN(_)){const k=Object.keys(l).find(I=>I.toUpperCase()===b);if(k)return l[k]>=_;const S=Object.keys(i).find(I=>I.toUpperCase()===b);if(S)return i[S]>=_}}return!1},g=y=>y.trim().split(/ AND /i).every(p);return e.trim().split(/ OR /i).some(g)};function NI({character:e,onClose:t}){var ac;const{character:r,markedSkillsThisSession:n,clearMarkedSkillsThisSession:s,increaseSkillLevel:i,addHeroicAbility:l,setSkillUnderStudy:o,learnSpell:u,isSaving:c,saveError:d}=hr(),{toggleDiceRoller:h}=Zn(),[f,p]=w.useState("initial"),[g,y]=w.useState(null),[E,x]=w.useState(0),[b,v]=w.useState(new Set),[_,k]=w.useState([]),[S,I]=w.useState(0),[j,P]=w.useState(null),[T,H]=w.useState(null),[O,q]=w.useState([]),[G,$]=w.useState(!1),[z,B]=w.useState(null),[L,Q]=w.useState(null),[N,K]=w.useState(null),[Y,A]=w.useState(null),[me,J]=w.useState([]),[ae,Z]=w.useState([]),[le,he]=w.useState([]),[ye,Le]=w.useState(null),[De,Qe]=w.useState(!1),Je=r||e,V=w.useMemo(()=>Je?vI(Je):[],[Je]),Ne=(ac=r==null?void 0:r.teacher)==null?void 0:ac.skillUnderStudy,ue=()=>{y(null),P(null),K(null),x(0),v(new Set),k([]),I(0),H(null),B(null),Q(null),he([]),Le(null),Qe(!1),$(!1)},fe=()=>{ue(),p("enterMarks")},_e=()=>{ue(),p("selectStudyType")},nt=async()=>{if(!r||!r.magicSchool){y("Character has no magic school assigned."),p("selectStudyType");return}Qe(!0),y(null);try{let Ee=ae.length>0?ae:await HE();ae.length===0&&Z(Ee);let Ve=me.length>0?me:await R6();me.length===0&&J(Ve);const qe=Ee.find(Bt=>Bt.id===r.magicSchool),it=qe?qe.name:null;A(it);const ot=rN(r.spells),ut=Ve.filter(Bt=>!ot.includes(Bt.name.toUpperCase())&&EI(Bt.prerequisite,r,it,Ee));he(ut),p("studyMagicSelectSpell")}catch(Ee){console.error("Error loading magic data:",Ee),y(Ee instanceof Error?Ee.message:"Failed to load magic study data."),p("selectStudyType")}finally{Qe(!1)}},at=Ee=>{Ee==="teacher"?p("studyTeacherSelectSkill"):Ee==="magic"&&nt()},pt=Ee=>{if(Ee.preventDefault(),E>0){const Ve=new Set;let qe=0;const it=V.map(ot=>ot.name);for(const ot of n)qe<E&&it.includes(ot)&&(Ve.add(ot),qe++);v(Ve),y(null),p("selectSkills")}else y("Please enter at least one Advancement Mark.")},Wt=Ee=>{v(Ve=>{const qe=new Set(Ve);return qe.has(Ee)?qe.delete(Ee):qe.size<E&&qe.add(Ee),qe})},Gt=()=>{if(b.size!==E){y(`Please select exactly ${E} skill(s).`);return}y(null),k(Array.from(b)),I(0),P(null),p("rollSkills")},Rt=w.useCallback(async Ee=>{if(!r||!Ee.results||Ee.results.length===0){P("Error: Roll failed due to missing data."),h();return}const{value:Ve}=Ee.results[0],{skillName:qe,targetValue:it}=Ee;if(!qe||it===void 0){P("Error: Roll context missing skill information."),h();return}const ot=Ve>it;let ut=`Rolled ${Ve} vs ${qe} (Target > ${it}). `;if(ot){ut+="Success! Skill increased.",await i(qe);const Bt=ts(qe);ut+=` New Level: ${Bt}.`,Bt===18&&it<18&&(H(qe),ut+=" Reached level 18!")}else ut+="Failed to increase skill.";P(ut),h()},[r,i,h]),ee=(Ee,Ve)=>{const qe=ts(Ee),it=Ve==="study"?K:P;if(qe>=18){it(`Skill ${Ee} is already at max level (18).`);return}it(null),h({rollMode:"advancementRoll",targetValue:qe,skillName:Ee,description:`Advancement Roll: ${Ee} (d20 vs > ${qe})`,onRollComplete:Ve==="study"?Ur:Rt})},de=async(Ee,Ve)=>{const qe=Ve==="study"?K:P;if(!r){qe("Error: Character data not available.");return}const it=ts(Ee);if(it>=18){qe(`Skill ${Ee} is already at max level (18).`);return}qe(null);let ot=`Manually advanced ${Ee}. Skill increased.`;await i(Ee);const ut=ts(Ee);ot+=` New Level: ${ut}.`,ut===18&&it<18&&(Ve==="endSession"&&H(Ee),ot+=" Reached level 18!"),qe(ot)},je=()=>{P(null),T?(xe(),p("selectAbility")):S<_.length-1?I(Ee=>Ee+1):Zr()},xe=async()=>{$(!0),y(null);try{const Ee=await yI(),Ve=hr.getState().character;if(!Ve)throw new Error("Character data not available for ability filtering.");const qe=new Set((Ve.heroic_abilities||[]).map(ot=>ot.toUpperCase())),it=Ee.filter(ot=>{var ut,Bt;return!qe.has(ot.name.toUpperCase())&&(!ot.kin||ot.kin.toLowerCase()===((ut=Ve.kin)==null?void 0:ut.toLowerCase()))&&(!ot.profession||ot.profession.toLowerCase()===((Bt=Ve.profession)==null?void 0:Bt.toLowerCase()))&&wI(ot,Ve)});q(it)}catch(Ee){console.error("Error fetching abilities:",Ee),y(Ee instanceof Error?Ee.message:"Failed to load heroic abilities.")}finally{$(!1)}},Ae=Ee=>{B(Ee)},Tt=async()=>{if(!z){y("Please select a heroic ability.");return}y(null),await l(z.name),H(null),B(null),S<_.length-1?(I(Ee=>Ee+1),p("rollSkills")):Zr()},Zr=()=>{s(),p("finished")},Mr=Ee=>{Q(Ee)},Fr=async()=>{if(!L){y("Please select a skill to study.");return}y(null),K(null),await o(L),p("studyTeacherRollSkill")},Ur=w.useCallback(async Ee=>{if(!r||!Ee.results||!Ee.results.length){K("Error: Roll failed due to missing data."),h();return}const{value:Ve}=Ee.results[0],{skillName:qe,targetValue:it}=Ee;if(!qe||it===void 0){K("Error: Roll context missing skill information."),h();return}const ot=Ve>it;let ut=`Studied ${qe}. Rolled ${Ve} vs Target > ${it}. `;if(ot){ut+="Success! Skill increased.",await i(qe);const Bt=ts(qe);ut+=` New Level: ${Bt}.`,Bt===18&&it<18&&(ut+=" Reached level 18!")}else ut+="Failed to increase skill this time.";K(ut),h()},[r,i,h]),Ct=Ee=>{Le(Ee)},pn=async()=>{if(!ye){y("Please select a spell to learn.");return}y(null);try{await u(ye.name),t()}catch(Ee){console.error("Error learning spell:",Ee),y(Ee instanceof Error?Ee.message:"Failed to learn the spell.")}},kr=()=>{Q(null),K(null),Le(null),he([]),t()},Vh=()=>{if(!Je&&f!=="initial")return a.jsx($e,{text:"Loading character data..."});switch(f){case"initial":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Choose an action to proceed."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(U,{onClick:fe,className:"flex-1",children:[a.jsx(Eo,{className:"w-5 h-5 mr-2"})," End Session & Advance"]}),a.jsxs(U,{onClick:_e,variant:"outline",className:"flex-1",children:[a.jsx(og,{className:"w-5 h-5 mr-2"})," Study"]})]})]});case"enterMarks":return a.jsxs("form",{onSubmit:pt,className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"End Session Advancement"}),a.jsx("label",{htmlFor:"advancementMarks",className:"block font-medium text-gray-700",children:"How many Advancement Marks did you gain this session?"}),a.jsx("input",{type:"number",id:"advancementMarks",name:"advancementMarks",min:"1",value:E===0?"":E,onChange:Se=>x(parseInt(Se.target.value,10)||0),className:"w-full p-2 border rounded focus:ring-blue-500 focus:border-blue-500",required:!0}),g&&a.jsx(Ie,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(lo,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{type:"submit",disabled:E<=0,children:["Next ",a.jsx(Fa,{className:"w-4 h-4 ml-1"})]})]})]});case"selectSkills":return Je?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Select ",E," skill(s) to attempt advancement:"]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:V.length===0?a.jsx("p",{className:"text-gray-500 italic",children:"No skills found for this character."}):V.map(Se=>{const Xr=ts(Se.name),Jr=Xr>=18,Aa=Se.name===Ne;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Jr?"opacity-60 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",checked:b.has(Se.name),onChange:()=>Wt(Se.name),disabled:Jr||!b.has(Se.name)&&b.size>=E,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${Se.isTrained?"font-semibold":""}`,children:Se.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",Se.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Xr]}),Jr&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"}),n.has(Se.name)&&!Jr&&a.jsx(Th,{className:"w-4 h-4 text-yellow-500 flex-shrink-0",title:"Marked this session (rolled 1 or 20)"}),Aa&&a.jsx(Eo,{className:"w-4 h-4 text-purple-600 flex-shrink-0 ml-1",title:"Currently studying with teacher"})]},Se.name)})}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",b.size," / ",E]}),g&&a.jsx(Ie,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>p("enterMarks"),children:[a.jsx(lo,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:Gt,disabled:b.size!==E,children:["Confirm Selection ",a.jsx(Fa,{className:"w-4 h-4 ml-1"})]})]})]}):a.jsx($e,{});case"rollSkills":if(_.length===0||!Je)return a.jsx($e,{text:"Preparing skill roll..."});const Ee=_[S],Ve=ts(Ee),qe=Ve>=18,it=!!j;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Attempting Advancement (",S+1," / ",_.length,")"]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Ee}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Ve]}),qe&&!it&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Skipped."})]}),j&&a.jsx("div",{className:`p-3 rounded border text-center ${j.includes("Success")||j.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":j.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:j}),d&&a.jsx(Ie,{message:d}),g&&a.jsx(Ie,{message:g}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!it&&!qe&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:()=>ee(Ee,"endSession"),disabled:c,loading:c,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Ve,")"]}),a.jsxs(U,{variant:"outline",onClick:()=>de(Ee,"endSession"),disabled:c,loading:c,children:[a.jsx(Yn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(it||qe&&!it)&&a.jsxs(U,{onClick:je,disabled:c,loading:c,children:[T?"Select Heroic Ability":S<_.length-1?"Next Skill":"Finish Session"," ",a.jsx(Fa,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Vs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectAbility":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 flex items-center gap-2",children:[a.jsx(fE,{className:"w-5 h-5"})," Skill ",a.jsx("span",{className:"font-bold",children:T})," reached level 18!"]}),a.jsx("p",{className:"text-gray-700",children:"Select a new Heroic Ability:"}),G&&a.jsx($e,{text:"Loading available abilities..."}),g&&a.jsx(Ie,{message:g}),!G&&O.length===0&&!g&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No eligible heroic abilities found for this character."}),!G&&O.length>0&&a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:O.map(Se=>a.jsxs("div",{onClick:()=>Ae(Se),className:`p-3 rounded border cursor-pointer ${(z==null?void 0:z.id)===Se.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("p",{className:"font-semibold",children:Se.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:Se.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[Se.willpower_cost&&a.jsxs("span",{children:["WP: ",Se.willpower_cost]}),Se.requirement&&typeof Se.requirement=="object"&&Object.keys(Se.requirement).length>0&&a.jsxs("span",{children:["Req: ",Object.entries(Se.requirement).filter(([,Xr])=>Xr!=null).map(([Xr,Jr])=>`${Xr} ${Jr}`).join(", ")]}),Se.requirement&&typeof Se.requirement=="string"&&a.jsxs("span",{children:["Req: ",Se.requirement]})]})]},Se.id))}),d&&a.jsx(Ie,{message:d}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsxs(U,{onClick:Tt,disabled:!z||G||c||O.length===0&&!g&&!G,loading:c,children:["Confirm Ability & Continue ",a.jsx(Fa,{className:"w-4 h-4 ml-1"})]})}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Vs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectStudyType":const ot=!!(r!=null&&r.magicSchool);return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Choose Study Method"}),a.jsx("p",{className:"text-gray-600",children:"How would you like to study to improve a skill or learn magic?"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(U,{onClick:()=>at("teacher"),className:"flex-1",children:[a.jsx(Eo,{className:"w-5 h-5 mr-2"})," Find a Teacher (Skills)"]}),a.jsxs(U,{onClick:()=>at("magic"),variant:"outline",className:"flex-1",disabled:!ot||De,loading:De,children:[a.jsx(Md,{className:"w-5 h-5 mr-2"})," Study Magic (Spells)"]})]}),!ot&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(qt,{className:"w-4 h-4 flex-shrink-0"})," Character must belong to a Magic School to study magic."]}),g&&a.jsx(Ie,{message:g}),a.jsx("div",{className:"flex justify-start",children:a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(lo,{className:"w-4 h-4 mr-1"})," Back"]})})]});case"studyTeacherSelectSkill":return Je?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Study with a Teacher"}),a.jsx("p",{className:"text-gray-600",children:"Select one skill to focus on improving. You cannot study a skill currently being studied until it has been advanced or study is completed."}),Ne&&a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded text-purple-800 text-sm flex items-center gap-2",children:[a.jsx(Gn,{className:"w-4 h-4 flex-shrink-0"}),"Currently studying: ",a.jsx("span",{className:"font-semibold",children:Ne}),". Complete or advance this study first to pick another skill."]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:V.map(Se=>{const Xr=ts(Se.name),Jr=Xr>=18,Aa=Jr||!!Ne&&Ne!==Se.name;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Aa?"opacity-60 cursor-not-allowed":L===Se.name?"bg-blue-100 border border-blue-300":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"radio",name:"studySkill",checked:L===Se.name,onChange:()=>Mr(Se.name),disabled:Aa,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${Se.isTrained?"font-semibold":""}`,children:Se.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",Se.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Xr]}),Jr&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"})]},Se.name)})}),g&&a.jsx(Ie,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>p("selectStudyType"),children:[a.jsx(lo,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:Fr,disabled:!L||!!Ne||c,loading:c,children:["Confirm Study Skill ",a.jsx(Fa,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Vs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]}):a.jsx($e,{});case"studyTeacherRollSkill":const ut=Ne||L;if(!ut||!Je)return a.jsx(Ie,{message:"Error: No skill selected or found for study, or character data missing."});const Bt=ts(ut),wi=Bt>=18,Ss=!!N;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: ",ut]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:ut}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Bt]}),wi&&!Ss&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Study complete."})]}),N&&a.jsx("div",{className:`p-3 rounded border text-center ${N.includes("Success")||N.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":N.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:N}),d&&a.jsx(Ie,{message:d}),g&&a.jsx(Ie,{message:g}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Ss&&!wi&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:()=>ee(ut,"study"),disabled:c,loading:c,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Bt,")"]}),a.jsxs(U,{variant:"outline",onClick:()=>de(ut,"study"),disabled:c,loading:c,children:[a.jsx(Yn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(Ss||wi&&!Ss)&&a.jsxs(U,{onClick:kr,disabled:c,loading:c,children:["Finish Study ",a.jsx(tl,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Vs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSpell":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(Md,{className:"w-5 h-5 text-purple-600"})," Study Magic"]}),Y&&a.jsxs("p",{className:"text-gray-600",children:["School: ",a.jsx("span",{className:"font-semibold",children:Y})]}),a.jsx("p",{className:"text-gray-600",children:"Select a spell to learn:"}),De&&a.jsx($e,{text:"Loading spells..."}),g&&a.jsx(Ie,{message:g}),!De&&le.length===0&&!g&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No new spells available to learn at this time, or prerequisites not met."}),!De&&le.length>0&&a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:le.map(Se=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(ye==null?void 0:ye.id)===Se.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSpell",checked:(ye==null?void 0:ye.id)===Se.id,onChange:()=>Ct(Se),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-semibold",children:[Se.name," ",a.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(Rank ",Se.rank??"N/A",")"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:Se.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[Se.casting_time&&a.jsxs("span",{children:["Cast: ",Se.casting_time]}),Se.range&&a.jsxs("span",{children:["Range: ",Se.range]}),Se.duration&&a.jsxs("span",{children:["Duration: ",Se.duration]}),Se.willpower_cost&&a.jsxs("span",{children:["WP: ",Se.willpower_cost]}),Se.prerequisite&&a.jsxs("span",{className:"italic",children:["(Learn Req: ",Se.prerequisite,")"]}),Se.casting_requirement&&a.jsxs("span",{className:"italic",children:["(Cast Req: ",Se.casting_requirement,")"]})]})]})]},Se.id))}),d&&a.jsx(Ie,{message:d}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>{p("selectStudyType"),y(null)},children:[a.jsx(lo,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:pn,disabled:!ye||De||c||le.length===0&&!g&&!De,loading:c,children:["Learn Selected Spell ",a.jsx(tl,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Vs,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"finished":return a.jsxs("div",{className:"text-center space-y-4 p-6 bg-green-50 rounded border border-green-200",children:[a.jsx(tl,{className:"w-12 h-12 text-green-500 mx-auto"}),a.jsx("h4",{className:"text-xl font-semibold text-green-800",children:"Session Ended & Advancement Complete!"}),a.jsx("p",{className:"text-gray-700",children:"Character data has been updated. Marked skills for this session have been cleared."}),a.jsx(U,{onClick:t,children:"Done"})]});default:const Wh=f;return a.jsxs("p",{children:["Unknown step: ",Wh]})}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4 sticky top-0 bg-white z-10",children:[a.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(Eo,{className:"w-6 h-6 text-blue-600"}),"Character Advancement"]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600","aria-label":"Close advancement modal",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-6",children:Vh()})]})})}function kI({character:e}){const{toggleDiceRoller:t}=Zn(),{setDeathRollState:r,adjustStat:n,isSaving:s}=hr(),[i,l]=w.useState(!1),[o,u]=w.useState(null),c=e.death_rolls_passed??0,d=e.death_rolls_failed??0,h=e.is_rallied??!1,f=e.attributes.CON,p=e.attributes.WIL,g=c>=3,y=d>=3,E=P=>{l(!1);const T=P.results[0].value,H=P.isCritical&&P.isSuccess,O=P.isCritical&&!P.isSuccess,q=P.isSuccess;let G=c,$=d;H?(G+=2,u(`Rolled ${T} (Dragon! +2 Successes)`)):O?($+=2,u(`Rolled ${T} (Demon! +2 Failures)`)):q?(G+=1,u(`Rolled ${T} (Success vs CON ${f})`)):($+=1,u(`Rolled ${T} (Failure vs CON ${f})`)),r(G,$,h),t()},x=P=>{l(!1);const T=P.results[0].value;P.isSuccess?(r(c,d,!0),u(`Rallied! (Rolled ${T} vs WIL ${p} w/ Bane)`)):(r(c,d,!1),u(`Rally Failed (Rolled ${T} vs WIL ${p} w/ Bane)`)),t()},b=P=>{l(!1);const T=P.results[0].value;u(`Recovered ${T} HP!`),n("current_hp",T),t()},v=()=>{i||g||y||(l(!0),u(null),t({rollMode:"deathRoll",targetValue:f,description:`Death Save (d20 vs CON ${f})`,onRollComplete:E}))},_=()=>{i||h||g||y||(l(!0),u(null),t({rollMode:"rallyRoll",targetValue:p,requiresBane:!0,description:`Rally Self (d20 vs WIL ${p}, Bane)`,onRollComplete:x}))},k=()=>{i||!g||y||(l(!0),u(null),t({rollMode:"recoveryRoll",description:"Recovery Roll (1d6 HP)",onRollComplete:b}))},S=P=>{if(g||y||s)return;const T=Math.max(0,Math.min(3,c+P));r(T,d,h)},I=P=>{if(g||y||s)return;const T=Math.max(0,Math.min(3,d+P));r(c,T,h)},j=(P,T,H,O,q,G)=>a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(O,{className:`w-4 h-4 sm:w-5 sm:h-5 ${q}`}),a.jsxs("span",{className:"font-medium text-xs sm:text-sm w-16 sm:w-20",children:[P,":"]}),a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{onClick:()=>G(-1),disabled:T===0||g||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Decrease ${P}`,children:a.jsx(wE,{className:"w-3 h-3"})}),[...Array(H)].map(($,z)=>a.jsx("div",{className:`w-3 h-3 sm:w-4 sm:h-4 rounded-full border ${z<T?P==="Successes"?"bg-green-500 border-green-600":"bg-red-500 border-red-600":"bg-gray-200 border-gray-300"}`},z)),a.jsx("button",{onClick:()=>G(1),disabled:T===H||g||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Increase ${P}`,children:a.jsx(Jt,{className:"w-3 h-3"})})]})]});return a.jsxs("div",{className:"p-3 rounded-lg shadow bg-red-50 border border-red-300 space-y-2",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm text-red-700",children:[a.jsx(Dd,{className:"w-4 h-4 text-red-600 animate-pulse"}),"DYING (",e.current_hp," HP)"]}),a.jsxs("div",{className:"space-y-1",children:[j("Successes",c,3,kh,"text-green-500",S),j("Failures",d,3,rl,"text-red-500",I)]}),o&&a.jsx("p",{className:"text-xs text-center text-gray-700 italic",children:o}),h&&!g&&!y&&a.jsxs("p",{className:"text-xs text-center text-yellow-800 bg-yellow-100 p-1 rounded border border-yellow-200 flex items-center justify-center gap-1",children:[a.jsx(Gn,{className:"w-3 h-3"})," Rallied! Can act, but still dying."]}),a.jsx("div",{className:"pt-1 space-y-2",children:y?a.jsx("div",{className:"text-center font-bold text-lg text-red-800 p-2 bg-red-200 rounded",children:"CHARACTER DIED"}):g?a.jsxs(U,{onClick:k,disabled:i||s,loading:i||s,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[a.jsx(hg,{className:"w-4 h-4 mr-1"})," Roll Recovery (1d6 HP)"]}):a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:v,disabled:i||s,loading:i||s,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"sm",children:[a.jsx(Dd,{className:"w-4 h-4 mr-1"})," Roll Death Save (d20)"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(U,{onClick:_,disabled:i||s||h,loading:i||s,className:`w-full text-black ${h?"bg-gray-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,size:"sm",children:[a.jsx(SE,{className:"w-4 h-4 mr-1"})," ",h?"Rallied!":"Attempt Rally (Self)"]}),!h&&a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 p-2 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none",children:["Roll d20 vs WIL (",p,") with Bane. Success lets you act while dying.",a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-black rotate-45"})]})]})]})}),s&&a.jsx("div",{className:"text-xs text-center text-blue-600 italic mt-1",children:"Saving..."})]})}function _I(){const e=hr(r=>r.activeStatusMessage),t=hr(r=>r.clearActiveStatusMessage);return e?a.jsxs("div",{className:"my-3 p-3 bg-blue-100 border border-blue-300 rounded-lg shadow-sm flex items-center justify-between animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Yn,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsxs("p",{className:"text-sm text-blue-800",children:["Activated: ",a.jsx("span",{className:"font-semibold",children:e})]})]}),a.jsx("button",{onClick:t,className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full transition-colors","aria-label":"Dismiss status message",children:a.jsx(Dt,{className:"w-4 h-4"})})]}):null}const Hf=({label:e,value:t})=>a.jsxs("div",{children:[a.jsx("dt",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:e}),a.jsx("dd",{className:"text-base text-gray-900",children:t||a.jsx("span",{className:"text-gray-400 italic",children:"N/A"})})]}),$f=({label:e,children:t,icon:r})=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[a.jsx(r,{className:"w-4 h-4 text-gray-500"}),e]}),t]});function SI({onClose:e}){const{character:t,updateCharacterData:r,isSaving:n,saveError:s}=hr(),[i,l]=w.useState("bio"),[o,u]=w.useState(!1),[c,d]=w.useState(!1),[h,f]=w.useState(!1),p=w.useRef(null),[g,y]=w.useState(""),[E,x]=w.useState(""),[b,v]=w.useState(""),[_,k]=w.useState(""),[S,I]=w.useState(""),[j,P]=w.useState(!1),T=()=>{t&&(y(t.portrait_url||""),x(t.appearance||""),v(t.memento||""),k(t.flaw||""),I(t.notes||""))};w.useEffect(()=>{T()},[t]),w.useEffect(()=>{const $=z=>{p.current&&!p.current.contains(z.target)&&f(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[]);const H=async $=>{t&&(await r($),u(!1),d(!1),P(!1))},O=()=>{T(),u(!1),d(!1)},q=()=>a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"absolute top-0 right-0",ref:p,children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>f(!h),children:a.jsx(dg,{className:"w-5 h-5"})}),h&&a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:a.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[a.jsxs("button",{onClick:()=>{u(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx(_4,{className:"w-4 h-4"})," Edit Bio Details"]}),a.jsxs("button",{onClick:()=>{d(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx(Cp,{className:"w-4 h-4"})," Edit Portrait URL"]})]})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-6 p-4 border rounded-lg shadow-sm bg-slate-50",children:[a.jsx("div",{className:"w-full md:w-1/3 flex-shrink-0",children:c?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"portraitUrl",className:"block text-sm font-medium text-gray-700",children:"Portrait URL"}),a.jsx("input",{id:"portraitUrl",type:"text",value:g,onChange:$=>y($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://..."}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>{d(!1),T()},children:"Cancel"}),a.jsx(U,{size:"sm",onClick:()=>H({portrait_url:g}),disabled:n,children:n?"...":"Save"})]})]}):g?a.jsx("img",{src:g,alt:"Character Portrait",className:"w-full h-auto object-cover rounded-md border",onError:$=>{$.currentTarget.src="https://via.placeholder.com/150/CCCCCC/FFFFFF?text=Invalid+Image"}}):a.jsxs("button",{onClick:()=>d(!0),className:"w-full h-48 border-2 border-dashed rounded-md flex flex-col items-center justify-center text-gray-500 hover:bg-gray-100 hover:border-gray-400 transition-colors",children:[a.jsx(Cp,{className:"w-8 h-8 mb-2"}),a.jsx("span",{children:"Add Portrait"})]})}),a.jsxs("div",{className:"flex-grow space-y-4",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 border-b pb-2",children:t==null?void 0:t.name}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx(Hf,{label:"Kin",value:t==null?void 0:t.kin}),a.jsx(Hf,{label:"Profession",value:t==null?void 0:t.profession}),a.jsx(Hf,{label:"Age",value:t==null?void 0:t.age})]}),o?a.jsxs(a.Fragment,{children:[a.jsx($f,{label:"Appearance",icon:bE,children:a.jsx("textarea",{value:E,onChange:$=>x($.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A brief description..."})}),a.jsx($f,{label:"Memento",icon:Th,children:a.jsx("input",{type:"text",value:b,onChange:$=>v($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A cherished item..."})}),a.jsx($f,{label:"Flaw",icon:h4,children:a.jsx("input",{type:"text",value:_,onChange:$=>k($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A personal weakness..."})})]}):a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Appearance"}),a.jsx("p",{className:"text-gray-800 text-sm",children:E||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Memento"}),a.jsx("p",{className:"text-gray-800 text-sm",children:b||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Flaw"}),a.jsx("p",{className:"text-gray-800 text-sm",children:_||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]})]})]})]}),o&&a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx(U,{variant:"secondary",onClick:O,children:"Cancel"}),a.jsx(U,{icon:tr,onClick:()=>H({appearance:E,memento:b,flaw:_}),disabled:n,children:n?"Saving...":"Save Changes"})]})]}),G=()=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-end mb-4 gap-2",children:j?a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"secondary",onClick:()=>{I((t==null?void 0:t.notes)||""),P(!1)},children:"Cancel"}),a.jsx(U,{onClick:()=>H({notes:S}),disabled:n,icon:tr,children:n?"Saving...":"Save Backstory"})]}):a.jsx(U,{onClick:()=>P(!0),icon:mg,children:"Edit Backstory"})}),j?a.jsx("textarea",{value:S,onChange:$=>I($.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"Write your character's life story here..."}):a.jsx("div",{className:"p-4 bg-gray-50 rounded-md border min-h-[200px]",children:S?a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:S}):a.jsx("p",{className:"text-gray-500 italic",children:"No backstory has been written yet."})})]});return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:e,children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex flex-col",onClick:$=>$.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Character Biography"}),a.jsx("p",{className:"text-sm text-gray-500",children:"View and edit personal details and history."})]}),a.jsx(U,{variant:"ghost",size:"icon",onClick:e,"aria-label":"Close modal",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-gray-200 px-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>l("bio"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="bio"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(yi,{className:"w-5 h-5"})," Bio"]}),a.jsxs("button",{onClick:()=>l("backstory"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="backstory"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(og,{className:"w-5 h-5"})," Backstory"]})]})}),a.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[s&&a.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-800 rounded-md flex items-center gap-2",children:[a.jsx(Ku,{className:"w-5 h-5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Save Error"}),a.jsx("p",{className:"text-sm",children:s})]})]}),i==="bio"?q():G()]})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex items-center justify-center",children:[a.jsx($e,{}),a.jsx("span",{className:"ml-2",children:"Loading character data..."})]})})}function TI({}){var N,K,Y,A,me,J,ae,Z,le;fn();const{toggleDiceRoller:e}=Zn(),{character:t,adjustStat:r,toggleCondition:n,performRest:s,updateCharacterData:i,isLoading:l,error:o,isSaving:u,saveError:c,setActiveStatusMessage:d}=hr(),[h,f]=w.useState(!1),[p,g]=w.useState(!1),[y,E]=w.useState(!1),[x,b]=w.useState(!1),[v,_]=w.useState(!1),[k,S]=w.useState(!1),[I,j]=w.useState(!1),[P,T]=w.useState(!1);if(l)return a.jsx("div",{className:"p-4 text-center",children:"Loading character..."});if(o)return a.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading character: ",o]});if(!t)return a.jsx("div",{className:"p-4 text-center",children:"Character data is not available. Please select a character."});const H=he=>{n(he)},O=async he=>{g(!1),await s(he,he==="stretch"?P:void 0),T(!1)},q=(he,ye,Le,De)=>{var V;const Qe=ye??10,Je=((V=t.conditions)==null?void 0:V[De])??!1;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:he}),a.jsx("span",{className:"text-xl",children:Qe})]}),a.jsx("div",{className:"text-sm h-5",children:(he==="STR"||he==="AGL")&&Qe>12&&a.jsxs("div",{className:"text-blue-400",children:["Damage Bonus: ",Qe<=15?"+D4":"+D6"]})})]}),a.jsx("button",{onClick:()=>H(De),className:`absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${Je?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${u?"opacity-50 cursor-not-allowed":""}`,disabled:u,title:`Toggle ${De.charAt(0).toUpperCase()+De.slice(1)}`,children:De.toUpperCase().substring(0,3)})]})},G=()=>p?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(By,{className:"w-6 h-6"})," Choose Rest Type"]}),a.jsx("button",{onClick:()=>{g(!1),T(!1)},className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>O("shift"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(_h,{className:"w-5 h-5"}),u?"Resting...":"Take Shift Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Shift Rest (~6 hours):"})," Requires a safe location. Recovers all HP & WP, heals all standard conditions. Resets death roll state. Interruption negates effects."]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>O("stretch"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition-colors",disabled:u||((t==null?void 0:t.current_hp)??0)<=0,children:[a.jsx(CE,{className:"w-5 h-5"}),u?"Resting...":"Take Stretch Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Stretch Rest (~15 mins):"})," Heal ",P?"2d6":"1d6"," HP, recover 1d6 WP, heal one standard condition. Can only be done once per Shift. Cannot be taken while dying. Interruption negates effects."]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:he=>T(he.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:"Healer present for Stretch Rest (requires successful HEALING roll)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Check this if another character is tending to you and succeeds on a HEALING roll during a Stretch Rest."})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>O("round"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(EE,{className:"w-5 h-5"}),u?"Resting...":"Take Round Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Round Rest (~10 secs):"})," Recover 1d6 WP. No HP recovery. Can only be done once per Shift."]})]})]}),u&&a.jsx("div",{className:"mt-4 text-sm text-center text-gray-500",children:"Saving..."}),c&&a.jsxs("div",{className:"mt-4 text-sm text-center text-red-500",children:["Error: ",c]})]})}):null,$=()=>{var ye;const he=Array.isArray(t==null?void 0:t.trainedSkills)?t.trainedSkills:[];return((ye=t==null?void 0:t.profession)==null?void 0:ye.endsWith("Mage"))||he.some(Le=>typeof Le=="string"&&["ELEMENTALISM","ANIMISM","MENTALISM"].includes(Le.toUpperCase()))},z=(t==null?void 0:t.current_hp)??0,B=(t==null?void 0:t.current_wp)??0,L=(t==null?void 0:t.max_hp)??((N=t==null?void 0:t.attributes)==null?void 0:N.CON)??10,Q=(t==null?void 0:t.max_wp)??((K=t==null?void 0:t.attributes)==null?void 0:K.WIL)??10;return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:t.name}),a.jsxs("p",{className:"text-gray-600 text-lg",children:[t.kin||"Unknown Kin"," ",t.profession||"Unknown Profession"," - Age: ",t.age||"Unknown"]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm transition-colors",children:[a.jsx(L4,{className:"w-4 h-4"}),"Bio"]}),a.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(xu,{className:"w-4 h-4"}),"Inventory"]}),a.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm transition-colors",children:[a.jsx(By,{className:"w-4 h-4"}),"Rest"]}),a.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-black rounded-lg hover:bg-yellow-600 text-sm transition-colors",children:[a.jsx(fE,{className:"w-4 h-4"}),"Session"]})]})]}),a.jsx(_I,{}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-x-4 gap-y-6",children:[q("STR",(Y=t.attributes)==null?void 0:Y.STR,a.jsx(c4,{}),"exhausted"),q("CON",(A=t.attributes)==null?void 0:A.CON,a.jsx(Uo,{}),"sickly"),q("AGL",(me=t.attributes)==null?void 0:me.AGL,a.jsx(d4,{}),"dazed"),q("INT",(J=t.attributes)==null?void 0:J.INT,a.jsx(gE,{}),"angry"),q("WIL",(ae=t.attributes)==null?void 0:ae.WIL,a.jsx(Yn,{}),"scared"),q("CHA",(Z=t.attributes)==null?void 0:Z.CHA,a.jsx(F4,{}),"disheartened")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start",children:[a.jsxs("div",{className:"md:col-span-6 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(Yu,{className:"w-4 h-4"}),"Skills"]}),$()&&a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm transition-colors",children:[a.jsx(nl,{className:"w-4 h-4"}),"Spells"]}),a.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm transition-colors",children:[a.jsx(A4,{className:"w-4 h-4"}),"Abilities"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 text-white rounded-lg text-sm self-start",children:[a.jsx("span",{className:"font-medium",children:"Movement:"}),a.jsxs("span",{className:"font-bold text-lg",children:[Z5(t.kin,(le=t.attributes)==null?void 0:le.AGL),"m"]})]})]}),a.jsxs("div",{className:"md:col-span-6 grid grid-cols-2 gap-4",children:[z>0?a.jsxs("div",{className:"p-3 rounded-lg shadow bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(hg,{className:"w-4 h-4 text-red-600"}),"HP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[z," / ",L]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_hp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:u||z<=0,title:"Decrease HP",children:"-"}),a.jsx("button",{onClick:()=>r("current_hp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:z>=L||u,title:"Increase HP",children:"+"})]})]}):a.jsx(kI,{character:t}),a.jsxs("div",{className:"p-3 bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(Yn,{className:"w-4 h-4 text-blue-600"}),"WP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[B," / ",Q]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_wp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:B===0||u,title:"Decrease WP",children:"-"}),a.jsx("button",{onClick:()=>r("current_wp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:B>=Q||u,title:"Increase WP",children:"+"})]})]})]})]}),a.jsx(mI,{character:t}),I&&a.jsx(SI,{onClose:()=>j(!1)}),y&&a.jsx(nI,{onClose:()=>E(!1)}),h&&a.jsx(iI,{onClose:()=>f(!1)}),x&&a.jsx(oI,{onClose:()=>b(!1)}),v&&a.jsx(NI,{character:t,onClose:()=>_(!1)}),k&&a.jsx(xI,{onClose:()=>S(!1)}),G(),u&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50 animate-pulse",children:"Saving..."}),c&&a.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50",children:["Save Error: ",c]})]})}function CI(){const{character:e,activeEncounter:t,currentCombatant:r,isLoadingEncounter:n,encounterError:s,drawInitiative:i,isSaving:l,fetchActiveEncounter:o}=hr(),[u,c]=w.useState(!1);if(w.useEffect(()=>{e!=null&&e.party_id&&(e!=null&&e.id)&&o(e.party_id,e.id)},[e==null?void 0:e.party_id,e==null?void 0:e.id,o]),w.useEffect(()=>{if(!(t!=null&&t.id)||!(e!=null&&e.party_id)||!(e!=null&&e.id))return;const p=te.channel(`player-encounter-updates-${e.id}`).on("postgres_changes",{event:"*",schema:"public",table:"encounters",filter:`id=eq.${t.id}`},()=>{o(e.party_id,e.id)}).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${t.id}`},()=>{o(e.party_id,e.id)}).subscribe();return()=>{te.removeChannel(p)}},[t==null?void 0:t.id,e==null?void 0:e.party_id,e==null?void 0:e.id,o]),!(e!=null&&e.party_id))return null;const d=(t==null?void 0:t.status)==="active",h=d?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",f=d?"Encounter Active":"Party Chat";return a.jsxs(a.Fragment,{children:[a.jsx("button",{className:`fixed bottom-4 right-4 p-4 rounded-full shadow-lg text-white transition-colors duration-200 z-40 ${h}`,onClick:()=>c(!u),"aria-label":f,children:d?a.jsx(ur,{size:24}):a.jsx(w4,{size:24})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-end z-30",onClick:()=>c(!1),children:a.jsxs("div",{className:"bg-white w-full max-w-sm h-full shadow-xl flex flex-col",onClick:p=>p.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:d?"Active Encounter":"Party Chat"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{size:24})})]}),a.jsx("div",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:n&&!t?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Vs,{className:"w-8 h-8 animate-spin text-gray-500"})}):s?a.jsx("div",{className:"text-red-600 text-center",children:s}):t?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-semibold",children:t.name}),t.description&&a.jsx("p",{className:"text-gray-600 text-sm",children:t.description}),a.jsxs("p",{className:"text-sm",children:["Status: ",a.jsx("span",{className:"font-medium",children:t.status})]}),t.current_round!=null&&a.jsxs("p",{className:"text-sm",children:["Round: ",a.jsx("span",{className:"font-medium",children:t.current_round})]}),r?a.jsxs("div",{className:"border p-3 rounded-md bg-blue-50 space-y-2",children:[a.jsx("p",{className:"font-semibold",children:"Your Combatant:"}),a.jsxs("p",{className:"text-sm",children:["Name: ",r.display_name]}),a.jsxs("p",{className:"text-sm",children:["Initiative: ",a.jsx("span",{className:"font-medium",children:r.initiative_roll??"Not Set"})]}),d&&r.initiative_roll===null&&a.jsx(U,{onClick:i,disabled:l,loading:l,Icon:ur,size:"sm",children:"Draw Initiative (1-10)"})]}):a.jsx("p",{className:"text-yellow-600 text-sm",children:"You are in a party with an active encounter, but your character is not yet added as a combatant."}),a.jsxs("div",{className:"border-t pt-4 mt-4",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Chat (Coming Soon)"}),a.jsx("p",{className:"text-gray-500 text-sm italic",children:"Real-time chat functionality will be available here."})]})]}):a.jsx("div",{className:"text-gray-600 text-center",children:"No active encounter for this party."})}),a.jsx("div",{className:"p-4 border-t bg-gray-50",children:a.jsx("input",{type:"text",placeholder:"Chat is coming soon...",className:"w-full px-3 py-2 border rounded-md bg-gray-200 cursor-not-allowed",disabled:!0})})]})})]})}function jI(){const{id:e}=rg(),{user:t}=Vt(),{character:r,isLoading:n,error:s,fetchCharacter:i,setCharacter:l}=hr();return w.useEffect(()=>{(async()=>{e&&(t!=null&&t.id)?await i(e,t.id):(l(null),console.warn("CharacterPage: Character ID or User ID is missing. Cannot load character."))})()},[e,t==null?void 0:t.id,i,l]),n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx($e,{size:"lg"})}):s?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:s})}):r?a.jsxs(a.Fragment,{children:[a.jsx(TI,{}),a.jsx(CI,{})]}):a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:"Character not found, does not exist, or you may not have permission to view it."})})}function vb(e){const t=[],r=String(e||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const l=r.slice(s,n).trim();(l||!i)&&t.push(l),s=n+1,n=r.indexOf(",",s)}return t}function nN(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const AI=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,II=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,RI={};function wb(e,t){return(RI.jsx?II:AI).test(e)}const LI=/[ \t\n\f\r]/g;function OI(e){return typeof e=="object"?e.type==="text"?Eb(e.value):!1:Eb(e)}function Eb(e){return e.replace(LI,"")===""}class Zu{constructor(t,r,n){this.property=t,this.normal=r,n&&(this.space=n)}}Zu.prototype.property={};Zu.prototype.normal={};Zu.prototype.space=null;function sN(e,t){const r={},n={};let s=-1;for(;++s<e.length;)Object.assign(r,e[s].property),Object.assign(n,e[s].normal);return new Zu(r,n,t)}function vu(e){return e.toLowerCase()}class mn{constructor(t,r){this.property=t,this.attribute=r}}mn.prototype.space=null;mn.prototype.boolean=!1;mn.prototype.booleanish=!1;mn.prototype.overloadedBoolean=!1;mn.prototype.number=!1;mn.prototype.commaSeparated=!1;mn.prototype.spaceSeparated=!1;mn.prototype.commaOrSpaceSeparated=!1;mn.prototype.mustUseProperty=!1;mn.prototype.defined=!1;let PI=0;const Me=bi(),Mt=bi(),aN=bi(),ce=bi(),ft=bi(),il=bi(),Br=bi();function bi(){return 2**++PI}const Op=Object.freeze(Object.defineProperty({__proto__:null,boolean:Me,booleanish:Mt,commaOrSpaceSeparated:Br,commaSeparated:il,number:ce,overloadedBoolean:aN,spaceSeparated:ft},Symbol.toStringTag,{value:"Module"})),zf=Object.keys(Op);class vg extends mn{constructor(t,r,n,s){let i=-1;if(super(t,r),Nb(this,"space",s),typeof n=="number")for(;++i<zf.length;){const l=zf[i];Nb(this,zf[i],(n&Op[l])===Op[l])}}}vg.prototype.defined=!0;function Nb(e,t,r){r&&(e[t]=r)}const DI={}.hasOwnProperty;function Gl(e){const t={},r={};let n;for(n in e.properties)if(DI.call(e.properties,n)){const s=e.properties[n],i=new vg(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[vu(n)]=n,r[vu(i.attribute)]=n}return new Zu(t,r,e.space)}const iN=Gl({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),lN=Gl({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function oN(e,t){return t in e?e[t]:t}function uN(e,t){return oN(e,t.toLowerCase())}const cN=Gl({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:uN,properties:{xmlns:null,xmlnsXLink:null}}),dN=Gl({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Mt,ariaAutoComplete:null,ariaBusy:Mt,ariaChecked:Mt,ariaColCount:ce,ariaColIndex:ce,ariaColSpan:ce,ariaControls:ft,ariaCurrent:null,ariaDescribedBy:ft,ariaDetails:null,ariaDisabled:Mt,ariaDropEffect:ft,ariaErrorMessage:null,ariaExpanded:Mt,ariaFlowTo:ft,ariaGrabbed:Mt,ariaHasPopup:null,ariaHidden:Mt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ft,ariaLevel:ce,ariaLive:null,ariaModal:Mt,ariaMultiLine:Mt,ariaMultiSelectable:Mt,ariaOrientation:null,ariaOwns:ft,ariaPlaceholder:null,ariaPosInSet:ce,ariaPressed:Mt,ariaReadOnly:Mt,ariaRelevant:null,ariaRequired:Mt,ariaRoleDescription:ft,ariaRowCount:ce,ariaRowIndex:ce,ariaRowSpan:ce,ariaSelected:Mt,ariaSetSize:ce,ariaSort:null,ariaValueMax:ce,ariaValueMin:ce,ariaValueNow:ce,ariaValueText:null,role:null}}),MI=Gl({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:uN,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:il,acceptCharset:ft,accessKey:ft,action:null,allow:null,allowFullScreen:Me,allowPaymentRequest:Me,allowUserMedia:Me,alt:null,as:null,async:Me,autoCapitalize:null,autoComplete:ft,autoFocus:Me,autoPlay:Me,blocking:ft,capture:null,charSet:null,checked:Me,cite:null,className:ft,cols:ce,colSpan:null,content:null,contentEditable:Mt,controls:Me,controlsList:ft,coords:ce|il,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Me,defer:Me,dir:null,dirName:null,disabled:Me,download:aN,draggable:Mt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Me,formTarget:null,headers:ft,height:ce,hidden:Me,high:ce,href:null,hrefLang:null,htmlFor:ft,httpEquiv:ft,id:null,imageSizes:null,imageSrcSet:null,inert:Me,inputMode:null,integrity:null,is:null,isMap:Me,itemId:null,itemProp:ft,itemRef:ft,itemScope:Me,itemType:ft,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Me,low:ce,manifest:null,max:null,maxLength:ce,media:null,method:null,min:null,minLength:ce,multiple:Me,muted:Me,name:null,nonce:null,noModule:Me,noValidate:Me,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Me,optimum:ce,pattern:null,ping:ft,placeholder:null,playsInline:Me,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Me,referrerPolicy:null,rel:ft,required:Me,reversed:Me,rows:ce,rowSpan:ce,sandbox:ft,scope:null,scoped:Me,seamless:Me,selected:Me,shadowRootClonable:Me,shadowRootDelegatesFocus:Me,shadowRootMode:null,shape:null,size:ce,sizes:null,slot:null,span:ce,spellCheck:Mt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ce,step:null,style:null,tabIndex:ce,target:null,title:null,translate:null,type:null,typeMustMatch:Me,useMap:null,value:Mt,width:ce,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ft,axis:null,background:null,bgColor:null,border:ce,borderColor:null,bottomMargin:ce,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Me,declare:Me,event:null,face:null,frame:null,frameBorder:null,hSpace:ce,leftMargin:ce,link:null,longDesc:null,lowSrc:null,marginHeight:ce,marginWidth:ce,noResize:Me,noHref:Me,noShade:Me,noWrap:Me,object:null,profile:null,prompt:null,rev:null,rightMargin:ce,rules:null,scheme:null,scrolling:Mt,standby:null,summary:null,text:null,topMargin:ce,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ce,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Me,disableRemotePlayback:Me,prefix:null,property:null,results:ce,security:null,unselectable:null}}),FI=Gl({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:oN,properties:{about:Br,accentHeight:ce,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ce,amplitude:ce,arabicForm:null,ascent:ce,attributeName:null,attributeType:null,azimuth:ce,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ce,by:null,calcMode:null,capHeight:ce,className:ft,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ce,diffuseConstant:ce,direction:null,display:null,dur:null,divisor:ce,dominantBaseline:null,download:Me,dx:null,dy:null,edgeMode:null,editable:null,elevation:ce,enableBackground:null,end:null,event:null,exponent:ce,externalResourcesRequired:null,fill:null,fillOpacity:ce,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:il,g2:il,glyphName:il,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ce,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ce,horizOriginX:ce,horizOriginY:ce,id:null,ideographic:ce,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ce,k:ce,k1:ce,k2:ce,k3:ce,k4:ce,kernelMatrix:Br,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ce,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ce,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ce,overlineThickness:ce,paintOrder:null,panose1:null,path:null,pathLength:ce,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ft,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ce,pointsAtY:ce,pointsAtZ:ce,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Br,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Br,rev:Br,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Br,requiredFeatures:Br,requiredFonts:Br,requiredFormats:Br,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ce,specularExponent:ce,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ce,strikethroughThickness:ce,string:null,stroke:null,strokeDashArray:Br,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ce,strokeOpacity:ce,strokeWidth:null,style:null,surfaceScale:ce,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Br,tabIndex:ce,tableValues:null,target:null,targetX:ce,targetY:ce,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Br,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ce,underlineThickness:ce,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ce,values:null,vAlphabetic:ce,vMathematical:ce,vectorEffect:null,vHanging:ce,vIdeographic:ce,version:null,vertAdvY:ce,vertOriginX:ce,vertOriginY:ce,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ce,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),UI=/^data[-\w.:]+$/i,kb=/-[a-z]/g,BI=/[A-Z]/g;function Rh(e,t){const r=vu(t);let n=t,s=mn;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&UI.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(kb,$I);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!kb.test(i)){let l=i.replace(BI,HI);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}s=vg}return new s(n,t)}function HI(e){return"-"+e.toLowerCase()}function $I(e){return e.charAt(1).toUpperCase()}const zI={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Xu=sN([lN,iN,cN,dN,MI],"html"),Ca=sN([lN,iN,cN,dN,FI],"svg");function _b(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function hN(e){return e.join(" ").trim()}var fN={},Sb=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,qI=/\n/g,VI=/^\s*/,WI=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,GI=/^:\s*/,YI=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,QI=/^[;\s]*/,KI=/^\s+|\s+$/g,ZI=`
`,Tb="/",Cb="*",Ua="",XI="comment",JI="declaration",eR=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(g){var y=g.match(qI);y&&(r+=y.length);var E=g.lastIndexOf(ZI);n=~E?g.length-E:n+g.length}function i(){var g={line:r,column:n};return function(y){return y.position=new l(g),c(),y}}function l(g){this.start=g,this.end={line:r,column:n},this.source=t.source}l.prototype.content=e;function o(g){var y=new Error(t.source+":"+r+":"+n+": "+g);if(y.reason=g,y.filename=t.source,y.line=r,y.column=n,y.source=e,!t.silent)throw y}function u(g){var y=g.exec(e);if(y){var E=y[0];return s(E),e=e.slice(E.length),y}}function c(){u(VI)}function d(g){var y;for(g=g||[];y=h();)y!==!1&&g.push(y);return g}function h(){var g=i();if(!(Tb!=e.charAt(0)||Cb!=e.charAt(1))){for(var y=2;Ua!=e.charAt(y)&&(Cb!=e.charAt(y)||Tb!=e.charAt(y+1));)++y;if(y+=2,Ua===e.charAt(y-1))return o("End of comment missing");var E=e.slice(2,y-2);return n+=2,s(E),e=e.slice(y),n+=2,g({type:XI,comment:E})}}function f(){var g=i(),y=u(WI);if(y){if(h(),!u(GI))return o("property missing ':'");var E=u(YI),x=g({type:JI,property:jb(y[0].replace(Sb,Ua)),value:E?jb(E[0].replace(Sb,Ua)):Ua});return u(QI),x}}function p(){var g=[];d(g);for(var y;y=f();)y!==!1&&(g.push(y),d(g));return g}return c(),p()};function jb(e){return e?e.replace(KI,Ua):Ua}var tR=Dr&&Dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fN,"__esModule",{value:!0});var Ab=fN.default=nR,rR=tR(eR);function nR(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,rR.default)(e),s=typeof t=="function";return n.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;s?t(l,o,i):o&&(r=r||{},r[l]=o)}}),r}const sR=Ab.default||Ab,Lh=mN("end"),Xn=mN("start");function mN(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function pN(e){const t=Xn(e),r=Lh(e);if(t&&r)return{start:t,end:r}}function Ho(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Ib(e.position):"start"in e||"end"in e?Ib(e):"line"in e||"column"in e?Pp(e):""}function Pp(e){return Rb(e&&e.line)+":"+Rb(e&&e.column)}function Ib(e){return Pp(e&&e.start)+"-"+Pp(e&&e.end)}function Rb(e){return e&&typeof e=="number"?e:1}class mr extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},l=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof t=="string"?s=t:!i.cause&&t&&(l=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=o?o.line:void 0,this.name=Ho(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}mr.prototype.file="";mr.prototype.name="";mr.prototype.reason="";mr.prototype.message="";mr.prototype.stack="";mr.prototype.column=void 0;mr.prototype.line=void 0;mr.prototype.ancestors=void 0;mr.prototype.cause=void 0;mr.prototype.fatal=void 0;mr.prototype.place=void 0;mr.prototype.ruleId=void 0;mr.prototype.source=void 0;const wg={}.hasOwnProperty,aR=new Map,iR=/[A-Z]/g,lR=/-([a-z])/g,oR=new Set(["table","tbody","thead","tfoot","tr"]),uR=new Set(["td","th"]),gN="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function cR(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=yR(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=xR(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Ca:Xu,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=xN(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function xN(e,t,r){if(t.type==="element")return dR(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return hR(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return mR(e,t,r);if(t.type==="mdxjsEsm")return fR(e,t);if(t.type==="root")return pR(e,t,r);if(t.type==="text")return gR(e,t)}function dR(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=Ca,e.schema=s),e.ancestors.push(t);const i=bN(e,t.tagName,!1),l=bR(e,t);let o=Ng(e,t);return oR.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!OI(u):!0})),yN(e,l,i,t),Eg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function hR(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}wu(e,t.position)}function fR(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);wu(e,t.position)}function mR(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=Ca,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:bN(e,t.name,!0),l=vR(e,t),o=Ng(e,t);return yN(e,l,i,t),Eg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function pR(e,t,r){const n={};return Eg(n,Ng(e,t)),e.create(t,e.Fragment,n,r)}function gR(e,t){return t.value}function yN(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Eg(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function xR(e,t,r){return n;function n(s,i,l,o){const c=Array.isArray(l.children)?r:t;return o?c(i,l,o):c(i,l)}}function yR(e,t){return r;function r(n,s,i,l){const o=Array.isArray(i.children),u=Xn(n);return t(s,i,l,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function bR(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&wg.call(t.properties,s)){const i=wR(e,s,t.properties[s]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&uR.has(t.tagName)?n=o:r[l]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function vR(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else wu(e,t.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else wu(e,t.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function Ng(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:aR;for(;++n<t.children.length;){const i=t.children[n];let l;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const c=s.get(u)||0;l=u+"-"+c,s.set(u,c+1)}}const o=xN(e,i,l);o!==void 0&&r.push(o)}return r}function wR(e,t,r){const n=Rh(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?nN(r):hN(r)),n.property==="style"){let s=typeof r=="object"?r:ER(e,String(r));return e.stylePropertyNameCase==="css"&&(s=NR(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?zI[n.property]||n.property:n.attribute,r]}}function ER(e,t){const r={};try{sR(t,n)}catch(s){if(!e.ignoreInvalidStyle){const i=s,l=new mr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=gN+"#cannot-parse-style-attribute",l}}return r;function n(s,i){let l=s;l.slice(0,2)!=="--"&&(l.slice(0,4)==="-ms-"&&(l="ms-"+l.slice(4)),l=l.replace(lR,_R)),r[l]=i}}function bN(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,l;for(;++i<s.length;){const o=wb(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}n=l}else n=wb(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return wg.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);wu(e)}function wu(e,t){const r=new mr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=gN+"#cannot-handle-mdx-estrees-without-createevaluater",r}function NR(e){const t={};let r;for(r in e)wg.call(e,r)&&(t[kR(r)]=e[r]);return t}function kR(e){let t=e.replace(iR,SR);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function _R(e,t){return t.toUpperCase()}function SR(e){return"-"+e.toLowerCase()}const qf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},TR={};function kg(e,t){const r=TR,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return vN(e,n,s)}function vN(e,t,r){if(CR(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Lb(e.children,t,r)}return Array.isArray(e)?Lb(e,t,r):""}function Lb(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=vN(e[s],t,r);return n.join("")}function CR(e){return!!(e&&typeof e=="object")}const Ob=document.createElement("i");function _g(e){const t="&"+e+";";Ob.innerHTML=t;const r=Ob.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Wr(e,t,r,n){const s=e.length;let i=0,l;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)l=Array.from(n),l.unshift(t,r),e.splice(...l);else for(r&&e.splice(t,r);i<n.length;)l=n.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function an(e,t){return e.length>0?(Wr(e,e.length,0,t),e):t}const Pb={}.hasOwnProperty;function wN(e){const t={};let r=-1;for(;++r<e.length;)jR(t,e[r]);return t}function jR(e,t){let r;for(r in t){const s=(Pb.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let l;if(i)for(l in i){Pb.call(s,l)||(s[l]=[]);const o=i[l];AR(s[l],Array.isArray(o)?o:o?[o]:[])}}}function AR(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Wr(e,0,0,n)}function EN(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function jn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const br=ja(/[A-Za-z]/),or=ja(/[\dA-Za-z]/),IR=ja(/[#-'*+\--9=?A-Z^-~]/);function Fd(e){return e!==null&&(e<32||e===127)}const Dp=ja(/\d/),RR=ja(/[\dA-Fa-f]/),LR=ja(/[!-/:-@[-`{-~]/);function Ce(e){return e!==null&&e<-2}function dt(e){return e!==null&&(e<0||e===32)}function Ge(e){return e===-2||e===-1||e===32}const Oh=ja(new RegExp("\\p{P}|\\p{S}","u")),ci=ja(/\s/);function ja(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Yl(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const i=e.charCodeAt(r);let l="";if(i===37&&or(e.charCodeAt(r+1))&&or(e.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),s=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(n,r),encodeURIComponent(l)),n=r+s+1,l=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function tt(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(u){return Ge(u)?(e.enter(r),o(u)):t(u)}function o(u){return Ge(u)&&i++<s?(e.consume(u),o):(e.exit(r),t(u))}}const OR={tokenize:PR};function PR(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),tt(e,t,"linePrefix")}function s(o){return e.enter("paragraph"),i(o)}function i(o){const u=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=u),r=u,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Ce(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const DR={tokenize:MR},Db={tokenize:FR};function MR(e){const t=this,r=[];let n=0,s,i,l;return o;function o(v){if(n<r.length){const _=r[n];return t.containerState=_[1],e.attempt(_[0].continuation,u,c)(v)}return c(v)}function u(v){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&b();const _=t.events.length;let k=_,S;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){S=t.events[k][1].end;break}x(n);let I=_;for(;I<t.events.length;)t.events[I][1].end={...S},I++;return Wr(t.events,k+1,0,t.events.slice(_)),t.events.length=I,c(v)}return o(v)}function c(v){if(n===r.length){if(!s)return f(v);if(s.currentConstruct&&s.currentConstruct.concrete)return g(v);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Db,d,h)(v)}function d(v){return s&&b(),x(n),f(v)}function h(v){return t.parser.lazy[t.now().line]=n!==r.length,l=t.now().offset,g(v)}function f(v){return t.containerState={},e.attempt(Db,p,g)(v)}function p(v){return n++,r.push([t.currentConstruct,t.containerState]),f(v)}function g(v){if(v===null){s&&b(),x(0),e.consume(v);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),y(v)}function y(v){if(v===null){E(e.exit("chunkFlow"),!0),x(0),e.consume(v);return}return Ce(v)?(e.consume(v),E(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(v),y)}function E(v,_){const k=t.sliceStream(v);if(_&&k.push(null),v.previous=i,i&&(i.next=v),i=v,s.defineSkip(v.start),s.write(k),t.parser.lazy[v.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<l&&(!s.events[S][1].end||s.events[S][1].end.offset>l))return;const I=t.events.length;let j=I,P,T;for(;j--;)if(t.events[j][0]==="exit"&&t.events[j][1].type==="chunkFlow"){if(P){T=t.events[j][1].end;break}P=!0}for(x(n),S=I;S<t.events.length;)t.events[S][1].end={...T},S++;Wr(t.events,j+1,0,t.events.slice(I)),t.events.length=S}}function x(v){let _=r.length;for(;_-- >v;){const k=r[_];t.containerState=k[1],k[0].exit.call(t,e)}r.length=v}function b(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function FR(e,t,r){return tt(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Rl(e){if(e===null||dt(e)||ci(e))return 1;if(Oh(e))return 2}function Ph(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const Mp={name:"attention",resolveAll:UR,tokenize:BR};function UR(e,t){let r=-1,n,s,i,l,o,u,c,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h={...e[n][1].end},f={...e[r][1].start};Mb(h,-u),Mb(f,u),l={type:u>1?"strongSequence":"emphasisSequence",start:h,end:{...e[n][1].end}},o={type:u>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},i={type:u>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:u>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[n][1].end={...l.start},e[r][1].start={...o.end},c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=an(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=an(c,[["enter",s,t],["enter",l,t],["exit",l,t],["enter",i,t]]),c=an(c,Ph(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=an(c,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,c=an(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,Wr(e,n-1,r-n+3,c),r=n+c.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function BR(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=Rl(n);let i;return l;function l(u){return i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const c=e.exit("attentionSequence"),d=Rl(u),h=!d||d===2&&s||r.includes(u),f=!s||s===2&&d||r.includes(n);return c._open=!!(i===42?h:h&&(s||!f)),c._close=!!(i===42?f:f&&(d||!h)),t(u)}}function Mb(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const HR={name:"autolink",tokenize:$R};function $R(e,t,r){let n=0;return s;function s(p){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(p){return br(p)?(e.consume(p),l):p===64?r(p):c(p)}function l(p){return p===43||p===45||p===46||or(p)?(n=1,o(p)):c(p)}function o(p){return p===58?(e.consume(p),n=0,u):(p===43||p===45||p===46||or(p))&&n++<32?(e.consume(p),o):(n=0,c(p))}function u(p){return p===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):p===null||p===32||p===60||Fd(p)?r(p):(e.consume(p),u)}function c(p){return p===64?(e.consume(p),d):IR(p)?(e.consume(p),c):r(p)}function d(p){return or(p)?h(p):r(p)}function h(p){return p===46?(e.consume(p),n=0,d):p===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):f(p)}function f(p){if((p===45||or(p))&&n++<63){const g=p===45?f:h;return e.consume(p),g}return r(p)}}const Ju={partial:!0,tokenize:zR};function zR(e,t,r){return n;function n(i){return Ge(i)?tt(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||Ce(i)?t(i):r(i)}}const NN={continuation:{tokenize:VR},exit:WR,name:"blockQuote",tokenize:qR};function qR(e,t,r){const n=this;return s;function s(l){if(l===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return r(l)}function i(l){return Ge(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function VR(e,t,r){const n=this;return s;function s(l){return Ge(l)?tt(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(NN,t,r)(l)}}function WR(e){e.exit("blockQuote")}const kN={name:"characterEscape",tokenize:GR};function GR(e,t,r){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return LR(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(i)}}const _N={name:"characterReference",tokenize:YR};function YR(e,t,r){const n=this;let s=0,i,l;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),u}function u(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,l=or,d(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=RR,d):(e.enter("characterReferenceValue"),i=7,l=Dp,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return l===or&&!_g(n.sliceSerialize(f))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(h)&&s++<i?(e.consume(h),d):r(h)}}const Fb={partial:!0,tokenize:KR},Ub={concrete:!0,name:"codeFenced",tokenize:QR};function QR(e,t,r){const n=this,s={partial:!0,tokenize:k};let i=0,l=0,o;return u;function u(S){return c(S)}function c(S){const I=n.events[n.events.length-1];return i=I&&I[1].type==="linePrefix"?I[2].sliceSerialize(I[1],!0).length:0,o=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===o?(l++,e.consume(S),d):l<3?r(S):(e.exit("codeFencedFenceSequence"),Ge(S)?tt(e,h,"whitespace")(S):h(S))}function h(S){return S===null||Ce(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(Fb,y,_)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||Ce(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(S)):Ge(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),tt(e,p,"whitespace")(S)):S===96&&S===o?r(S):(e.consume(S),f)}function p(S){return S===null||Ce(S)?h(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(S))}function g(S){return S===null||Ce(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(S)):S===96&&S===o?r(S):(e.consume(S),g)}function y(S){return e.attempt(s,_,E)(S)}function E(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&Ge(S)?tt(e,b,"linePrefix",i+1)(S):b(S)}function b(S){return S===null||Ce(S)?e.check(Fb,y,_)(S):(e.enter("codeFlowValue"),v(S))}function v(S){return S===null||Ce(S)?(e.exit("codeFlowValue"),b(S)):(e.consume(S),v)}function _(S){return e.exit("codeFenced"),t(S)}function k(S,I,j){let P=0;return T;function T($){return S.enter("lineEnding"),S.consume($),S.exit("lineEnding"),H}function H($){return S.enter("codeFencedFence"),Ge($)?tt(S,O,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):O($)}function O($){return $===o?(S.enter("codeFencedFenceSequence"),q($)):j($)}function q($){return $===o?(P++,S.consume($),q):P>=l?(S.exit("codeFencedFenceSequence"),Ge($)?tt(S,G,"whitespace")($):G($)):j($)}function G($){return $===null||Ce($)?(S.exit("codeFencedFence"),I($)):j($)}}}function KR(e,t,r){const n=this;return s;function s(l){return l===null?r(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}const Vf={name:"codeIndented",tokenize:XR},ZR={partial:!0,tokenize:JR};function XR(e,t,r){const n=this;return s;function s(c){return e.enter("codeIndented"),tt(e,i,"linePrefix",5)(c)}function i(c){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?l(c):r(c)}function l(c){return c===null?u(c):Ce(c)?e.attempt(ZR,l,u)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||Ce(c)?(e.exit("codeFlowValue"),l(c)):(e.consume(c),o)}function u(c){return e.exit("codeIndented"),t(c)}}function JR(e,t,r){const n=this;return s;function s(l){return n.parser.lazy[n.now().line]?r(l):Ce(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):tt(e,i,"linePrefix",5)(l)}function i(l){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):Ce(l)?s(l):r(l)}}const eL={name:"codeText",previous:rL,resolve:tL,tokenize:nL};function tL(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function rL(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function nL(e,t,r){let n=0,s,i;return l;function l(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),u(h))}function u(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),u):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):Ce(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Ce(h)?(e.exit("codeTextData"),u(h)):(e.consume(h),c)}function d(h){return h===96?(e.consume(h),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",c(h))}}class sL{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&ho(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),ho(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),ho(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);ho(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);ho(this.left,r.reverse())}}}function ho(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function SN(e){const t={};let r=-1,n,s,i,l,o,u,c;const d=new sL(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,aL(d,r)),r=t[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--;)if(l=d.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),l[1].type="lineEnding",s=i);else if(l[1].type!=="linePrefix")break;s&&(n[1].end={...d.get(s)[1].start},o=d.slice(s,r),o.unshift(n),d.splice(s,r-s+1,o))}}return Wr(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function aL(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const i=[],l=r._tokenizer||n.parser[r.contentType](r.start),o=l.events,u=[],c={};let d,h,f=-1,p=r,g=0,y=0;const E=[y];for(;p;){for(;e.get(++s)[1]!==p;);i.push(s),p._tokenizer||(d=n.sliceStream(p),p.next||d.push(null),h&&l.defineSkip(p.start),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(d),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),h=p,p=p.next}for(p=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(y=f+1,E.push(y),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(l.events=[],p?(p._tokenizer=void 0,p.previous=void 0):E.pop(),f=E.length;f--;){const x=o.slice(E[f],E[f+1]),b=i.pop();u.push([b,b+x.length-1]),e.splice(b,2,x)}for(u.reverse(),f=-1;++f<u.length;)c[g+u[f][0]]=g+u[f][1],g+=u[f][1]-u[f][0]-1;return c}const iL={resolve:oL,tokenize:uL},lL={partial:!0,tokenize:cL};function oL(e){return SN(e),e}function uL(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(o)}function s(o){return o===null?i(o):Ce(o)?e.check(lL,l,i)(o):(e.consume(o),s)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function cL(e,t,r){const n=this;return s;function s(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),tt(e,i,"linePrefix")}function i(l){if(l===null||Ce(l))return r(l);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(n.parser.constructs.flow,r,t)(l)}}function TN(e,t,r,n,s,i,l,o,u){const c=u||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(n),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||Fd(x)?r(x):(e.enter(n),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),y(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),p(x))}function p(x){return x===62?(e.exit("chunkString"),e.exit(o),f(x)):x===null||x===60||Ce(x)?r(x):(e.consume(x),x===92?g:p)}function g(x){return x===60||x===62||x===92?(e.consume(x),p):p(x)}function y(x){return!d&&(x===null||x===41||dt(x))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(n),t(x)):d<c&&x===40?(e.consume(x),d++,y):x===41?(e.consume(x),d--,y):x===null||x===32||x===40||Fd(x)?r(x):(e.consume(x),x===92?E:y)}function E(x){return x===40||x===41||x===92?(e.consume(x),y):y(x)}}function CN(e,t,r,n,s,i){const l=this;let o=0,u;return c;function c(p){return e.enter(n),e.enter(s),e.consume(p),e.exit(s),e.enter(i),d}function d(p){return o>999||p===null||p===91||p===93&&!u||p===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?r(p):p===93?(e.exit(i),e.enter(s),e.consume(p),e.exit(s),e.exit(n),t):Ce(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(p))}function h(p){return p===null||p===91||p===93||Ce(p)||o++>999?(e.exit("chunkString"),d(p)):(e.consume(p),u||(u=!Ge(p)),p===92?f:h)}function f(p){return p===91||p===92||p===93?(e.consume(p),o++,h):h(p)}}function jN(e,t,r,n,s,i){let l;return o;function o(f){return f===34||f===39||f===40?(e.enter(n),e.enter(s),e.consume(f),e.exit(s),l=f===40?41:f,u):r(f)}function u(f){return f===l?(e.enter(s),e.consume(f),e.exit(s),e.exit(n),t):(e.enter(i),c(f))}function c(f){return f===l?(e.exit(i),u(l)):f===null?r(f):Ce(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),tt(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===l||f===null||Ce(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?h:d)}function h(f){return f===l||f===92?(e.consume(f),d):d(f)}}function $o(e,t){let r;return n;function n(s){return Ce(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):Ge(s)?tt(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const dL={name:"definition",tokenize:fL},hL={partial:!0,tokenize:mL};function fL(e,t,r){const n=this;let s;return i;function i(p){return e.enter("definition"),l(p)}function l(p){return CN.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function o(p){return s=jn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),u):r(p)}function u(p){return dt(p)?$o(e,c)(p):c(p)}function c(p){return TN(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function d(p){return e.attempt(hL,h,h)(p)}function h(p){return Ge(p)?tt(e,f,"whitespace")(p):f(p)}function f(p){return p===null||Ce(p)?(e.exit("definition"),n.parser.defined.push(s),t(p)):r(p)}}function mL(e,t,r){return n;function n(o){return dt(o)?$o(e,s)(o):r(o)}function s(o){return jN(e,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return Ge(o)?tt(e,l,"whitespace")(o):l(o)}function l(o){return o===null||Ce(o)?t(o):r(o)}}const pL={name:"hardBreakEscape",tokenize:gL};function gL(e,t,r){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return Ce(i)?(e.exit("hardBreakEscape"),t(i)):r(i)}}const xL={name:"headingAtx",resolve:yL,tokenize:bL};function yL(e,t){let r=e.length-2,n=3,s,i;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},i={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Wr(e,n,r-n+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function bL(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),l(d)}function l(d){return d===35&&n++<6?(e.consume(d),l):d===null||dt(d)?(e.exit("atxHeadingSequence"),o(d)):r(d)}function o(d){return d===35?(e.enter("atxHeadingSequence"),u(d)):d===null||Ce(d)?(e.exit("atxHeading"),t(d)):Ge(d)?tt(e,o,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function u(d){return d===35?(e.consume(d),u):(e.exit("atxHeadingSequence"),o(d))}function c(d){return d===null||d===35||dt(d)?(e.exit("atxHeadingText"),o(d)):(e.consume(d),c)}}const vL=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Bb=["pre","script","style","textarea"],wL={concrete:!0,name:"htmlFlow",resolveTo:kL,tokenize:_L},EL={partial:!0,tokenize:TL},NL={partial:!0,tokenize:SL};function kL(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function _L(e,t,r){const n=this;let s,i,l,o,u;return c;function c(A){return d(A)}function d(A){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(A),h}function h(A){return A===33?(e.consume(A),f):A===47?(e.consume(A),i=!0,y):A===63?(e.consume(A),s=3,n.interrupt?t:N):br(A)?(e.consume(A),l=String.fromCharCode(A),E):r(A)}function f(A){return A===45?(e.consume(A),s=2,p):A===91?(e.consume(A),s=5,o=0,g):br(A)?(e.consume(A),s=4,n.interrupt?t:N):r(A)}function p(A){return A===45?(e.consume(A),n.interrupt?t:N):r(A)}function g(A){const me="CDATA[";return A===me.charCodeAt(o++)?(e.consume(A),o===me.length?n.interrupt?t:O:g):r(A)}function y(A){return br(A)?(e.consume(A),l=String.fromCharCode(A),E):r(A)}function E(A){if(A===null||A===47||A===62||dt(A)){const me=A===47,J=l.toLowerCase();return!me&&!i&&Bb.includes(J)?(s=1,n.interrupt?t(A):O(A)):vL.includes(l.toLowerCase())?(s=6,me?(e.consume(A),x):n.interrupt?t(A):O(A)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(A):i?b(A):v(A))}return A===45||or(A)?(e.consume(A),l+=String.fromCharCode(A),E):r(A)}function x(A){return A===62?(e.consume(A),n.interrupt?t:O):r(A)}function b(A){return Ge(A)?(e.consume(A),b):T(A)}function v(A){return A===47?(e.consume(A),T):A===58||A===95||br(A)?(e.consume(A),_):Ge(A)?(e.consume(A),v):T(A)}function _(A){return A===45||A===46||A===58||A===95||or(A)?(e.consume(A),_):k(A)}function k(A){return A===61?(e.consume(A),S):Ge(A)?(e.consume(A),k):v(A)}function S(A){return A===null||A===60||A===61||A===62||A===96?r(A):A===34||A===39?(e.consume(A),u=A,I):Ge(A)?(e.consume(A),S):j(A)}function I(A){return A===u?(e.consume(A),u=null,P):A===null||Ce(A)?r(A):(e.consume(A),I)}function j(A){return A===null||A===34||A===39||A===47||A===60||A===61||A===62||A===96||dt(A)?k(A):(e.consume(A),j)}function P(A){return A===47||A===62||Ge(A)?v(A):r(A)}function T(A){return A===62?(e.consume(A),H):r(A)}function H(A){return A===null||Ce(A)?O(A):Ge(A)?(e.consume(A),H):r(A)}function O(A){return A===45&&s===2?(e.consume(A),z):A===60&&s===1?(e.consume(A),B):A===62&&s===4?(e.consume(A),K):A===63&&s===3?(e.consume(A),N):A===93&&s===5?(e.consume(A),Q):Ce(A)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(EL,Y,q)(A)):A===null||Ce(A)?(e.exit("htmlFlowData"),q(A)):(e.consume(A),O)}function q(A){return e.check(NL,G,Y)(A)}function G(A){return e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),$}function $(A){return A===null||Ce(A)?q(A):(e.enter("htmlFlowData"),O(A))}function z(A){return A===45?(e.consume(A),N):O(A)}function B(A){return A===47?(e.consume(A),l="",L):O(A)}function L(A){if(A===62){const me=l.toLowerCase();return Bb.includes(me)?(e.consume(A),K):O(A)}return br(A)&&l.length<8?(e.consume(A),l+=String.fromCharCode(A),L):O(A)}function Q(A){return A===93?(e.consume(A),N):O(A)}function N(A){return A===62?(e.consume(A),K):A===45&&s===2?(e.consume(A),N):O(A)}function K(A){return A===null||Ce(A)?(e.exit("htmlFlowData"),Y(A)):(e.consume(A),K)}function Y(A){return e.exit("htmlFlow"),t(A)}}function SL(e,t,r){const n=this;return s;function s(l){return Ce(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):r(l)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}function TL(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(Ju,t,r)}}const CL={name:"htmlText",tokenize:jL};function jL(e,t,r){const n=this;let s,i,l;return o;function o(N){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(N),u}function u(N){return N===33?(e.consume(N),c):N===47?(e.consume(N),k):N===63?(e.consume(N),v):br(N)?(e.consume(N),j):r(N)}function c(N){return N===45?(e.consume(N),d):N===91?(e.consume(N),i=0,g):br(N)?(e.consume(N),b):r(N)}function d(N){return N===45?(e.consume(N),p):r(N)}function h(N){return N===null?r(N):N===45?(e.consume(N),f):Ce(N)?(l=h,B(N)):(e.consume(N),h)}function f(N){return N===45?(e.consume(N),p):h(N)}function p(N){return N===62?z(N):N===45?f(N):h(N)}function g(N){const K="CDATA[";return N===K.charCodeAt(i++)?(e.consume(N),i===K.length?y:g):r(N)}function y(N){return N===null?r(N):N===93?(e.consume(N),E):Ce(N)?(l=y,B(N)):(e.consume(N),y)}function E(N){return N===93?(e.consume(N),x):y(N)}function x(N){return N===62?z(N):N===93?(e.consume(N),x):y(N)}function b(N){return N===null||N===62?z(N):Ce(N)?(l=b,B(N)):(e.consume(N),b)}function v(N){return N===null?r(N):N===63?(e.consume(N),_):Ce(N)?(l=v,B(N)):(e.consume(N),v)}function _(N){return N===62?z(N):v(N)}function k(N){return br(N)?(e.consume(N),S):r(N)}function S(N){return N===45||or(N)?(e.consume(N),S):I(N)}function I(N){return Ce(N)?(l=I,B(N)):Ge(N)?(e.consume(N),I):z(N)}function j(N){return N===45||or(N)?(e.consume(N),j):N===47||N===62||dt(N)?P(N):r(N)}function P(N){return N===47?(e.consume(N),z):N===58||N===95||br(N)?(e.consume(N),T):Ce(N)?(l=P,B(N)):Ge(N)?(e.consume(N),P):z(N)}function T(N){return N===45||N===46||N===58||N===95||or(N)?(e.consume(N),T):H(N)}function H(N){return N===61?(e.consume(N),O):Ce(N)?(l=H,B(N)):Ge(N)?(e.consume(N),H):P(N)}function O(N){return N===null||N===60||N===61||N===62||N===96?r(N):N===34||N===39?(e.consume(N),s=N,q):Ce(N)?(l=O,B(N)):Ge(N)?(e.consume(N),O):(e.consume(N),G)}function q(N){return N===s?(e.consume(N),s=void 0,$):N===null?r(N):Ce(N)?(l=q,B(N)):(e.consume(N),q)}function G(N){return N===null||N===34||N===39||N===60||N===61||N===96?r(N):N===47||N===62||dt(N)?P(N):(e.consume(N),G)}function $(N){return N===47||N===62||dt(N)?P(N):r(N)}function z(N){return N===62?(e.consume(N),e.exit("htmlTextData"),e.exit("htmlText"),t):r(N)}function B(N){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),L}function L(N){return Ge(N)?tt(e,Q,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):Q(N)}function Q(N){return e.enter("htmlTextData"),l(N)}}const Sg={name:"labelEnd",resolveAll:LL,resolveTo:OL,tokenize:PL},AL={tokenize:DL},IL={tokenize:ML},RL={tokenize:FL};function LL(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&Wr(e,0,e.length,r),e}function OL(e,t){let r=e.length,n=0,s,i,l,o;for(;r--;)if(s=e[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(l){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(l=r);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},d={type:"labelText",start:{...e[i+n+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",u,t],["enter",c,t]],o=an(o,e.slice(i+1,i+n+3)),o=an(o,[["enter",d,t]]),o=an(o,Ph(t.parser.constructs.insideSpan.null,e.slice(i+n+4,l-3),t)),o=an(o,[["exit",d,t],e[l-2],e[l-1],["exit",c,t]]),o=an(o,e.slice(l+1)),o=an(o,[["exit",u,t]]),Wr(e,i,e.length,o),e}function PL(e,t,r){const n=this;let s=n.events.length,i,l;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return o;function o(f){return i?i._inactive?h(f):(l=n.parser.defined.includes(jn(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),u):r(f)}function u(f){return f===40?e.attempt(AL,d,l?d:h)(f):f===91?e.attempt(IL,d,l?c:h)(f):l?d(f):h(f)}function c(f){return e.attempt(RL,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,r(f)}}function DL(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return dt(h)?$o(e,i)(h):i(h)}function i(h){return h===41?d(h):TN(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function l(h){return dt(h)?$o(e,u)(h):d(h)}function o(h){return r(h)}function u(h){return h===34||h===39||h===40?jN(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function c(h){return dt(h)?$o(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function ML(e,t,r){const n=this;return s;function s(o){return CN.call(n,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return n.parser.defined.includes(jn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function l(o){return r(o)}}function FL(e,t,r){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):r(i)}}const UL={name:"labelStartImage",resolveAll:Sg.resolveAll,tokenize:BL};function BL(e,t,r){const n=this;return s;function s(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):r(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const HL={name:"labelStartLink",resolveAll:Sg.resolveAll,tokenize:$L};function $L(e,t,r){const n=this;return s;function s(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const Wf={name:"lineEnding",tokenize:zL};function zL(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),tt(e,t,"linePrefix")}}const rd={name:"thematicBreak",tokenize:qL};function qL(e,t,r){let n=0,s;return i;function i(c){return e.enter("thematicBreak"),l(c)}function l(c){return s=c,o(c)}function o(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):n>=3&&(c===null||Ce(c))?(e.exit("thematicBreak"),t(c)):r(c)}function u(c){return c===s?(e.consume(c),n++,u):(e.exit("thematicBreakSequence"),Ge(c)?tt(e,o,"whitespace")(c):o(c))}}const Tr={continuation:{tokenize:YL},exit:KL,name:"list",tokenize:GL},VL={partial:!0,tokenize:ZL},WL={partial:!0,tokenize:QL};function GL(e,t,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,l=0;return o;function o(p){const g=n.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!n.containerState.marker||p===n.containerState.marker:Dp(p)){if(n.containerState.type||(n.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),p===42||p===45?e.check(rd,r,c)(p):c(p);if(!n.interrupt||p===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(p)}return r(p)}function u(p){return Dp(p)&&++l<10?(e.consume(p),u):(!n.interrupt||l<2)&&(n.containerState.marker?p===n.containerState.marker:p===41||p===46)?(e.exit("listItemValue"),c(p)):r(p)}function c(p){return e.enter("listItemMarker"),e.consume(p),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||p,e.check(Ju,n.interrupt?r:d,e.attempt(VL,f,h))}function d(p){return n.containerState.initialBlankLine=!0,i++,f(p)}function h(p){return Ge(p)?(e.enter("listItemPrefixWhitespace"),e.consume(p),e.exit("listItemPrefixWhitespace"),f):r(p)}function f(p){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(p)}}function YL(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(Ju,s,i);function s(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,tt(e,t,"listItemIndent",n.containerState.size+1)(o)}function i(o){return n.containerState.furtherBlankLines||!Ge(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,l(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(WL,t,l)(o))}function l(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,tt(e,e.attempt(Tr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function QL(e,t,r){const n=this;return tt(e,s,"listItemIndent",n.containerState.size+1);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===n.containerState.size?t(i):r(i)}}function KL(e){e.exit(this.containerState.type)}function ZL(e,t,r){const n=this;return tt(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const l=n.events[n.events.length-1];return!Ge(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):r(i)}}const Hb={name:"setextUnderline",resolveTo:XL,tokenize:JL};function XL(e,t){let r=e.length,n,s,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!i&&e[r][1].type==="definition"&&(i=r);const l={type:"setextHeading",start:{...e[s][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",l,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=l,e.push(["exit",l,t]),e}function JL(e,t,r){const n=this;let s;return i;function i(c){let d=n.events.length,h;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){h=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),s=c,l(c)):r(c)}function l(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===s?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),Ge(c)?tt(e,u,"lineSuffix")(c):u(c))}function u(c){return c===null||Ce(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const eO={tokenize:tO};function tO(e){const t=this,r=e.attempt(Ju,n,e.attempt(this.parser.constructs.flowInitial,s,tt(e,e.attempt(this.parser.constructs.flow,s,e.attempt(iL,s)),"linePrefix")));return r;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const rO={resolveAll:IN()},nO=AN("string"),sO=AN("text");function AN(e){return{resolveAll:IN(e==="text"?aO:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],i=r.attempt(s,l,o);return l;function l(d){return c(d)?i(d):o(d)}function o(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),u}function u(d){return c(d)?(r.exit("data"),i(d)):(r.consume(d),u)}function c(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const p=h[f];if(!p.previous||p.previous.call(n,n.previous))return!0}return!1}}}function IN(e){return t;function t(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(r,n):r}}function aO(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let i=s.length,l=-1,o=0,u;for(;i--;){const c=s[i];if(typeof c=="string"){for(l=c.length;c.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(c===-2)u=!0,o++;else if(c!==-1){i++;break}}if(o){const c={type:r===e.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:n.start._bufferIndex+l,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const iO={42:Tr,43:Tr,45:Tr,48:Tr,49:Tr,50:Tr,51:Tr,52:Tr,53:Tr,54:Tr,55:Tr,56:Tr,57:Tr,62:NN},lO={91:dL},oO={[-2]:Vf,[-1]:Vf,32:Vf},uO={35:xL,42:rd,45:[Hb,rd],60:wL,61:Hb,95:rd,96:Ub,126:Ub},cO={38:_N,92:kN},dO={[-5]:Wf,[-4]:Wf,[-3]:Wf,33:UL,38:_N,42:Mp,60:[HR,CL],91:HL,92:[pL,kN],93:Sg,95:Mp,96:eL},hO={null:[Mp,rO]},fO={null:[42,95]},mO={null:[]},pO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:fO,contentInitial:lO,disable:mO,document:iO,flow:uO,flowInitial:oO,insideSpan:hO,string:cO,text:dO},Symbol.toStringTag,{value:"Module"}));function gO(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let l=[],o=[];const u={attempt:I(k),check:I(S),consume:b,enter:v,exit:_,interrupt:I(S,{interrupt:!0})},c={code:null,containerState:{},defineSkip:y,events:[],now:g,parser:e,previous:null,sliceSerialize:f,sliceStream:p,write:h};let d=t.tokenize.call(c,u);return t.resolveAll&&i.push(t),c;function h(H){return l=an(l,H),E(),l[l.length-1]!==null?[]:(j(t,0),c.events=Ph(i,c.events,c),c.events)}function f(H,O){return yO(p(H),O)}function p(H){return xO(l,H)}function g(){const{_bufferIndex:H,_index:O,line:q,column:G,offset:$}=n;return{_bufferIndex:H,_index:O,line:q,column:G,offset:$}}function y(H){s[H.line]=H.column,T()}function E(){let H;for(;n._index<l.length;){const O=l[n._index];if(typeof O=="string")for(H=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===H&&n._bufferIndex<O.length;)x(O.charCodeAt(n._bufferIndex));else x(O)}}function x(H){d=d(H)}function b(H){Ce(H)?(n.line++,n.column=1,n.offset+=H===-3?2:1,T()):H!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=H}function v(H,O){const q=O||{};return q.type=H,q.start=g(),c.events.push(["enter",q,c]),o.push(q),q}function _(H){const O=o.pop();return O.end=g(),c.events.push(["exit",O,c]),O}function k(H,O){j(H,O.from)}function S(H,O){O.restore()}function I(H,O){return q;function q(G,$,z){let B,L,Q,N;return Array.isArray(G)?Y(G):"tokenize"in G?Y([G]):K(G);function K(ae){return Z;function Z(le){const he=le!==null&&ae[le],ye=le!==null&&ae.null,Le=[...Array.isArray(he)?he:he?[he]:[],...Array.isArray(ye)?ye:ye?[ye]:[]];return Y(Le)(le)}}function Y(ae){return B=ae,L=0,ae.length===0?z:A(ae[L])}function A(ae){return Z;function Z(le){return N=P(),Q=ae,ae.partial||(c.currentConstruct=ae),ae.name&&c.parser.constructs.disable.null.includes(ae.name)?J():ae.tokenize.call(O?Object.assign(Object.create(c),O):c,u,me,J)(le)}}function me(ae){return H(Q,N),$}function J(ae){return N.restore(),++L<B.length?A(B[L]):z}}}function j(H,O){H.resolveAll&&!i.includes(H)&&i.push(H),H.resolve&&Wr(c.events,O,c.events.length-O,H.resolve(c.events.slice(O),c)),H.resolveTo&&(c.events=H.resolveTo(c.events,c))}function P(){const H=g(),O=c.previous,q=c.currentConstruct,G=c.events.length,$=Array.from(o);return{from:G,restore:z};function z(){n=H,c.previous=O,c.currentConstruct=q,c.events.length=G,o=$,T()}}function T(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function xO(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let l;if(r===s)l=[e[r].slice(n,i)];else{if(l=e.slice(r,s),n>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(n):l.shift()}i>0&&l.push(e[s].slice(0,i))}return l}function yO(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const i=e[r];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&s)continue;l=" ";break}default:l=String.fromCharCode(i)}s=i===-2,n.push(l)}return n.join("")}function bO(e){const n={constructs:wN([pO,...(e||{}).extensions||[]]),content:s(OR),defined:[],document:s(DR),flow:s(eO),lazy:{},string:s(nO),text:s(sO)};return n;function s(i){return l;function l(o){return gO(n,i,o)}}}function vO(e){for(;!SN(e););return e}const $b=/[\0\t\n\r]/g;function wO(){let e=1,t="",r=!0,n;return s;function s(i,l,o){const u=[];let c,d,h,f,p;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),h=0,t="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if($b.lastIndex=h,c=$b.exec(i),f=c&&c.index!==void 0?c.index:i.length,p=i.charCodeAt(f),!c){t=i.slice(h);break}if(p===10&&h===f&&n)u.push(-3),n=void 0;else switch(n&&(u.push(-5),n=void 0),h<f&&(u.push(i.slice(h,f)),e+=f-h),p){case 0:{u.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,u.push(-2);e++<d;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:n=!0,e=1}h=f+1}return o&&(n&&u.push(-5),t&&u.push(t),u.push(null)),u}}const EO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function NO(e){return e.replace(EO,kO)}function kO(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return EN(r.slice(i?2:1),i?16:10)}return _g(r)||e}const RN={}.hasOwnProperty;function _O(e,t,r){return typeof t!="string"&&(r=t,t=void 0),SO(r)(vO(bO(r).document().write(wO()(e,t,!0))))}function SO(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(_e),autolinkProtocol:P,autolinkEmail:P,atxHeading:i(V),blockQuote:i(ye),characterEscape:P,characterReference:P,codeFenced:i(Le),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(Le,l),codeText:i(De,l),codeTextData:P,data:P,codeFlowValue:P,definition:i(Qe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Je),hardBreakEscape:i(Ne),hardBreakTrailing:i(Ne),htmlFlow:i(ue,l),htmlFlowData:P,htmlText:i(ue,l),htmlTextData:P,image:i(fe),label:l,link:i(_e),listItem:i(at),listItemValue:f,listOrdered:i(nt,h),listUnordered:i(nt),paragraph:i(pt),reference:A,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i(V),strong:i(Wt),thematicBreak:i(Rt)},exit:{atxHeading:u(),atxHeadingSequence:k,autolink:u(),autolinkEmail:he,autolinkProtocol:le,blockQuote:u(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:J,characterReferenceMarkerNumeric:J,characterReferenceValue:ae,characterReference:Z,codeFenced:u(E),codeFencedFence:y,codeFencedFenceInfo:p,codeFencedFenceMeta:g,codeFlowValue:T,codeIndented:u(x),codeText:u($),codeTextData:T,data:T,definition:u(),definitionDestinationString:_,definitionLabelString:b,definitionTitleString:v,emphasis:u(),hardBreakEscape:u(O),hardBreakTrailing:u(O),htmlFlow:u(q),htmlFlowData:T,htmlText:u(G),htmlTextData:T,image:u(B),label:Q,labelText:L,lineEnding:H,link:u(z),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:me,resourceDestinationString:N,resourceTitleString:K,resource:Y,setextHeading:u(j),setextHeadingLineSequence:I,setextHeadingText:S,strong:u(),thematicBreak:u()}};LN(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(ee){let de={type:"root",children:[]};const je={stack:[de],tokenStack:[],config:t,enter:o,exit:c,buffer:l,resume:d,data:r},xe=[];let Ae=-1;for(;++Ae<ee.length;)if(ee[Ae][1].type==="listOrdered"||ee[Ae][1].type==="listUnordered")if(ee[Ae][0]==="enter")xe.push(Ae);else{const Tt=xe.pop();Ae=s(ee,Tt,Ae)}for(Ae=-1;++Ae<ee.length;){const Tt=t[ee[Ae][0]];RN.call(Tt,ee[Ae][1].type)&&Tt[ee[Ae][1].type].call(Object.assign({sliceSerialize:ee[Ae][2].sliceSerialize},je),ee[Ae][1])}if(je.tokenStack.length>0){const Tt=je.tokenStack[je.tokenStack.length-1];(Tt[1]||zb).call(je,void 0,Tt[0])}for(de.position={start:Rs(ee.length>0?ee[0][1].start:{line:1,column:1,offset:0}),end:Rs(ee.length>0?ee[ee.length-2][1].end:{line:1,column:1,offset:0})},Ae=-1;++Ae<t.transforms.length;)de=t.transforms[Ae](de)||de;return de}function s(ee,de,je){let xe=de-1,Ae=-1,Tt=!1,Zr,Mr,Fr,Ur;for(;++xe<=je;){const Ct=ee[xe];switch(Ct[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ct[0]==="enter"?Ae++:Ae--,Ur=void 0;break}case"lineEndingBlank":{Ct[0]==="enter"&&(Zr&&!Ur&&!Ae&&!Fr&&(Fr=xe),Ur=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ur=void 0}if(!Ae&&Ct[0]==="enter"&&Ct[1].type==="listItemPrefix"||Ae===-1&&Ct[0]==="exit"&&(Ct[1].type==="listUnordered"||Ct[1].type==="listOrdered")){if(Zr){let pn=xe;for(Mr=void 0;pn--;){const kr=ee[pn];if(kr[1].type==="lineEnding"||kr[1].type==="lineEndingBlank"){if(kr[0]==="exit")continue;Mr&&(ee[Mr][1].type="lineEndingBlank",Tt=!0),kr[1].type="lineEnding",Mr=pn}else if(!(kr[1].type==="linePrefix"||kr[1].type==="blockQuotePrefix"||kr[1].type==="blockQuotePrefixWhitespace"||kr[1].type==="blockQuoteMarker"||kr[1].type==="listItemIndent"))break}Fr&&(!Mr||Fr<Mr)&&(Zr._spread=!0),Zr.end=Object.assign({},Mr?ee[Mr][1].start:Ct[1].end),ee.splice(Mr||xe,0,["exit",Zr,Ct[2]]),xe++,je++}if(Ct[1].type==="listItemPrefix"){const pn={type:"listItem",_spread:!1,start:Object.assign({},Ct[1].start),end:void 0};Zr=pn,ee.splice(xe,0,["enter",pn,Ct[2]]),xe++,je++,Fr=void 0,Ur=!0}}}return ee[de][1]._spread=Tt,je}function i(ee,de){return je;function je(xe){o.call(this,ee(xe),xe),de&&de.call(this,xe)}}function l(){this.stack.push({type:"fragment",children:[]})}function o(ee,de,je){this.stack[this.stack.length-1].children.push(ee),this.stack.push(ee),this.tokenStack.push([de,je||void 0]),ee.position={start:Rs(de.start),end:void 0}}function u(ee){return de;function de(je){ee&&ee.call(this,je),c.call(this,je)}}function c(ee,de){const je=this.stack.pop(),xe=this.tokenStack.pop();if(xe)xe[0].type!==ee.type&&(de?de.call(this,ee,xe[0]):(xe[1]||zb).call(this,ee,xe[0]));else throw new Error("Cannot close `"+ee.type+"` ("+Ho({start:ee.start,end:ee.end})+"): its not open");je.position.end=Rs(ee.end)}function d(){return kg(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(ee){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(ee),10),this.data.expectingFirstListItemValue=void 0}}function p(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.lang=ee}function g(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.meta=ee}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.value=ee.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.value=ee.replace(/(\r?\n|\r)$/g,"")}function b(ee){const de=this.resume(),je=this.stack[this.stack.length-1];je.label=de,je.identifier=jn(this.sliceSerialize(ee)).toLowerCase()}function v(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.title=ee}function _(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.url=ee}function k(ee){const de=this.stack[this.stack.length-1];if(!de.depth){const je=this.sliceSerialize(ee).length;de.depth=je}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function I(ee){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(ee).codePointAt(0)===61?1:2}function j(){this.data.setextHeadingSlurpLineEnding=void 0}function P(ee){const je=this.stack[this.stack.length-1].children;let xe=je[je.length-1];(!xe||xe.type!=="text")&&(xe=Gt(),xe.position={start:Rs(ee.start),end:void 0},je.push(xe)),this.stack.push(xe)}function T(ee){const de=this.stack.pop();de.value+=this.sliceSerialize(ee),de.position.end=Rs(ee.end)}function H(ee){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=de.children[de.children.length-1];je.position.end=Rs(ee.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(de.type)&&(P.call(this,ee),T.call(this,ee))}function O(){this.data.atHardBreak=!0}function q(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.value=ee}function G(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.value=ee}function $(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.value=ee}function z(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=de,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function B(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=de,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function L(ee){const de=this.sliceSerialize(ee),je=this.stack[this.stack.length-2];je.label=NO(de),je.identifier=jn(de).toLowerCase()}function Q(){const ee=this.stack[this.stack.length-1],de=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const xe=ee.children;je.children=xe}else je.alt=de}function N(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.url=ee}function K(){const ee=this.resume(),de=this.stack[this.stack.length-1];de.title=ee}function Y(){this.data.inReference=void 0}function A(){this.data.referenceType="collapsed"}function me(ee){const de=this.resume(),je=this.stack[this.stack.length-1];je.label=de,je.identifier=jn(this.sliceSerialize(ee)).toLowerCase(),this.data.referenceType="full"}function J(ee){this.data.characterReferenceType=ee.type}function ae(ee){const de=this.sliceSerialize(ee),je=this.data.characterReferenceType;let xe;je?(xe=EN(de,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):xe=_g(de);const Ae=this.stack[this.stack.length-1];Ae.value+=xe}function Z(ee){const de=this.stack.pop();de.position.end=Rs(ee.end)}function le(ee){T.call(this,ee);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(ee)}function he(ee){T.call(this,ee);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(ee)}function ye(){return{type:"blockquote",children:[]}}function Le(){return{type:"code",lang:null,meta:null,value:""}}function De(){return{type:"inlineCode",value:""}}function Qe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Je(){return{type:"emphasis",children:[]}}function V(){return{type:"heading",depth:0,children:[]}}function Ne(){return{type:"break"}}function ue(){return{type:"html",value:""}}function fe(){return{type:"image",title:null,url:"",alt:null}}function _e(){return{type:"link",title:null,url:"",children:[]}}function nt(ee){return{type:"list",ordered:ee.type==="listOrdered",start:null,spread:ee._spread,children:[]}}function at(ee){return{type:"listItem",spread:ee._spread,checked:null,children:[]}}function pt(){return{type:"paragraph",children:[]}}function Wt(){return{type:"strong",children:[]}}function Gt(){return{type:"text",value:""}}function Rt(){return{type:"thematicBreak"}}}function Rs(e){return{line:e.line,column:e.column,offset:e.offset}}function LN(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?LN(e,n):TO(e,n)}}function TO(e,t){let r;for(r in t)if(RN.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function zb(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Ho({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Ho({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Ho({start:t.start,end:t.end})+") is still open")}function CO(e){const t=this;t.parser=r;function r(n){return _O(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function jO(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function AO(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function IO(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function RO(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function LO(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function OO(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=Yl(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let l,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,u);const c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)}function PO(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function DO(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function ON(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const l=s[s.length-1];return l&&l.type==="text"?l.value+=n:s.push({type:"text",value:n}),s}function MO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return ON(e,t);const s={src:Yl(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function FO(e,t){const r={src:Yl(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function UO(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function BO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return ON(e,t);const s={href:Yl(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function HO(e,t){const r={href:Yl(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function $O(e,t,r){const n=e.all(t),s=r?zO(r):PN(t),i={},l=[];if(typeof t.checked=="boolean"){const d=n[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const d=n[o];(s||o!==0||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?l.push(...d.children):l.push(d)}const u=n[n.length-1];u&&(s||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,c),e.applyData(t,c)}function zO(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=PN(r[n])}return t}function PN(e){const t=e.spread;return t??e.children.length>1}function qO(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const l=n[s];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function VO(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function WO(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function GO(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function YO(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],l),s.push(l)}if(r.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=Xn(t.children[1]),u=Lh(t.children[t.children.length-1]);o&&u&&(l.position={start:o,end:u}),s.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function QO(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",l=r&&r.type==="table"?r.align:void 0,o=l?l.length:t.children.length;let u=-1;const c=[];for(;++u<o;){const h=t.children[u],f={},p=l?l[u]:void 0;p&&(f.align=p);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=e.all(h),e.patch(h,g),g=e.applyData(h,g)),c.push(g)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,d),e.applyData(t,d)}function KO(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const qb=9,Vb=32;function ZO(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const i=[];for(;n;)i.push(Wb(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return i.push(Wb(t.slice(s),s>0,!1)),i.join("")}function Wb(e,t,r){let n=0,s=e.length;if(t){let i=e.codePointAt(n);for(;i===qb||i===Vb;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(s-1);for(;i===qb||i===Vb;)s--,i=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function XO(e,t){const r={type:"text",value:ZO(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function JO(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const eP={blockquote:jO,break:AO,code:IO,delete:RO,emphasis:LO,footnoteReference:OO,heading:PO,html:DO,imageReference:MO,image:FO,inlineCode:UO,linkReference:BO,link:HO,listItem:$O,list:qO,paragraph:VO,root:WO,strong:GO,table:YO,tableCell:KO,tableRow:QO,text:XO,thematicBreak:JO,toml:Mc,yaml:Mc,definition:Mc,footnoteDefinition:Mc};function Mc(){}const DN=-1,Dh=0,zo=1,Ud=2,Tg=3,Cg=4,jg=5,Ag=6,MN=7,FN=8,Gb=typeof self=="object"?self:globalThis,tP=(e,t)=>{const r=(s,i)=>(e.set(i,s),s),n=s=>{if(e.has(s))return e.get(s);const[i,l]=t[s];switch(i){case Dh:case DN:return r(l,s);case zo:{const o=r([],s);for(const u of l)o.push(n(u));return o}case Ud:{const o=r({},s);for(const[u,c]of l)o[n(u)]=n(c);return o}case Tg:return r(new Date(l),s);case Cg:{const{source:o,flags:u}=l;return r(new RegExp(o,u),s)}case jg:{const o=r(new Map,s);for(const[u,c]of l)o.set(n(u),n(c));return o}case Ag:{const o=r(new Set,s);for(const u of l)o.add(n(u));return o}case MN:{const{name:o,message:u}=l;return r(new Gb[o](u),s)}case FN:return r(BigInt(l),s);case"BigInt":return r(Object(BigInt(l)),s);case"ArrayBuffer":return r(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return r(new DataView(o),l)}}return r(new Gb[i](l),s)};return n},Yb=e=>tP(new Map,e)(0),ji="",{toString:rP}={},{keys:nP}=Object,fo=e=>{const t=typeof e;if(t!=="object"||!e)return[Dh,t];const r=rP.call(e).slice(8,-1);switch(r){case"Array":return[zo,ji];case"Object":return[Ud,ji];case"Date":return[Tg,ji];case"RegExp":return[Cg,ji];case"Map":return[jg,ji];case"Set":return[Ag,ji];case"DataView":return[zo,r]}return r.includes("Array")?[zo,r]:r.includes("Error")?[MN,r]:[Ud,r]},Fc=([e,t])=>e===Dh&&(t==="function"||t==="symbol"),sP=(e,t,r,n)=>{const s=(l,o)=>{const u=n.push(l)-1;return r.set(o,u),u},i=l=>{if(r.has(l))return r.get(l);let[o,u]=fo(l);switch(o){case Dh:{let d=l;switch(u){case"bigint":o=FN,d=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);d=null;break;case"undefined":return s([DN],l)}return s([o,d],l)}case zo:{if(u){let f=l;return u==="DataView"?f=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(f=new Uint8Array(l)),s([u,[...f]],l)}const d=[],h=s([o,d],l);for(const f of l)d.push(i(f));return h}case Ud:{if(u)switch(u){case"BigInt":return s([u,l.toString()],l);case"Boolean":case"Number":case"String":return s([u,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const d=[],h=s([o,d],l);for(const f of nP(l))(e||!Fc(fo(l[f])))&&d.push([i(f),i(l[f])]);return h}case Tg:return s([o,l.toISOString()],l);case Cg:{const{source:d,flags:h}=l;return s([o,{source:d,flags:h}],l)}case jg:{const d=[],h=s([o,d],l);for(const[f,p]of l)(e||!(Fc(fo(f))||Fc(fo(p))))&&d.push([i(f),i(p)]);return h}case Ag:{const d=[],h=s([o,d],l);for(const f of l)(e||!Fc(fo(f)))&&d.push(i(f));return h}}const{message:c}=l;return s([o,{name:u,message:c}],l)};return i},Qb=(e,{json:t,lossy:r}={})=>{const n=[];return sP(!(t||r),!!t,new Map,n)(e),n},di=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Yb(Qb(e,t)):structuredClone(e):(e,t)=>Yb(Qb(e,t));function aP(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function iP(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function lP(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||aP,n=e.options.footnoteBackLabel||iP,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[u]);if(!c)continue;const d=e.all(c),h=String(c.identifier).toUpperCase(),f=Yl(h.toLowerCase());let p=0;const g=[],y=e.footnoteCounts.get(h);for(;y!==void 0&&++p<=y;){g.length>0&&g.push({type:"text",value:" "});let b=typeof r=="string"?r:r(u,p);typeof b=="string"&&(b={type:"text",value:b}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,p),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const b=E.children[E.children.length-1];b&&b.type==="text"?b.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...g)}else d.push(...g);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(c,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...di(l),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const Mh=function(e){if(e==null)return dP;if(typeof e=="function")return Fh(e);if(typeof e=="object")return Array.isArray(e)?oP(e):uP(e);if(typeof e=="string")return cP(e);throw new Error("Expected function, string, or object as test")};function oP(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=Mh(e[r]);return Fh(n);function n(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function uP(e){const t=e;return Fh(r);function r(n){const s=n;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function cP(e){return Fh(t);function t(r){return r&&r.type===e}}function Fh(e){return t;function t(r,n,s){return!!(hP(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function dP(){return!0}function hP(e){return e!==null&&typeof e=="object"&&"type"in e}const UN=[],fP=!0,Fp=!1,mP="skip";function BN(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const i=Mh(s),l=n?-1:1;o(e,void 0,[])();function o(u,c,d){const h=u&&typeof u=="object"?u:{};if(typeof h.type=="string"){const p=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(u.type+(p?"<"+p+">":""))+")"})}return f;function f(){let p=UN,g,y,E;if((!t||i(u,c,d[d.length-1]||void 0))&&(p=pP(r(u,d)),p[0]===Fp))return p;if("children"in u&&u.children){const x=u;if(x.children&&p[0]!==mP)for(y=(n?x.children.length:-1)+l,E=d.concat(x);y>-1&&y<x.children.length;){const b=x.children[y];if(g=o(b,y,E)(),g[0]===Fp)return g;y=typeof g[1]=="number"?g[1]:y+l}}return p}}}function pP(e){return Array.isArray(e)?e:typeof e=="number"?[fP,e]:e==null?UN:[e]}function Uh(e,t,r,n){let s,i,l;typeof t=="function"&&typeof r!="function"?(i=void 0,l=t,s=r):(i=t,l=r,s=n),BN(e,i,o,s);function o(u,c){const d=c[c.length-1],h=d?d.children.indexOf(u):void 0;return l(u,h,d)}}const Up={}.hasOwnProperty,gP={};function xP(e,t){const r=t||gP,n=new Map,s=new Map,i=new Map,l={...eP,...r.handlers},o={all:c,applyData:bP,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:u,options:r,patch:yP,wrap:wP};return Uh(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?n:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),o;function u(d,h){const f=d.type,p=o.handlers[f];if(Up.call(o.handlers,f)&&p)return p(o,d,h);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in d){const{children:y,...E}=d,x=di(E);return x.children=o.all(d),x}return di(d)}return(o.options.unknownHandler||vP)(o,d,h)}function c(d){const h=[];if("children"in d){const f=d.children;let p=-1;for(;++p<f.length;){const g=o.one(f[p],d);if(g){if(p&&f[p-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=Kb(g.value)),!Array.isArray(g)&&g.type==="element")){const y=g.children[0];y&&y.type==="text"&&(y.value=Kb(y.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function yP(e,t){e.position&&(t.position=pN(e))}function bP(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const l="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:l}}r.type==="element"&&i&&Object.assign(r.properties,di(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function vP(e,t){const r=t.data||{},n="value"in t&&!(Up.call(r,"hProperties")||Up.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function wP(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function Kb(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function Zb(e,t){const r=xP(e,t),n=r.one(e,void 0),s=lP(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function EP(e,t){return e&&"run"in e?async function(r,n){const s=Zb(r,{file:n,...t});await e.run(s,n)}:function(r,n){return Zb(r,{file:n,...e||t})}}function Xb(e){if(e)throw e}var nd=Object.prototype.hasOwnProperty,HN=Object.prototype.toString,Jb=Object.defineProperty,e1=Object.getOwnPropertyDescriptor,t1=function(t){return typeof Array.isArray=="function"?Array.isArray(t):HN.call(t)==="[object Array]"},r1=function(t){if(!t||HN.call(t)!=="[object Object]")return!1;var r=nd.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&nd.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||nd.call(t,s)},n1=function(t,r){Jb&&r.name==="__proto__"?Jb(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},s1=function(t,r){if(r==="__proto__")if(nd.call(t,r)){if(e1)return e1(t,r).value}else return;return t[r]},NP=function e(){var t,r,n,s,i,l,o=arguments[0],u=1,c=arguments.length,d=!1;for(typeof o=="boolean"&&(d=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=s1(o,r),s=s1(t,r),o!==s&&(d&&s&&(r1(s)||(i=t1(s)))?(i?(i=!1,l=n&&t1(n)?n:[]):l=n&&r1(n)?n:{},n1(o,{name:r,newValue:e(d,l,s)})):typeof s<"u"&&n1(o,{name:r,newValue:s}));return o};const Gf=Zd(NP);function Bp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function kP(){const e=[],t={run:r,use:n};return t;function r(...s){let i=-1;const l=s.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...s);function o(u,...c){const d=e[++i];let h=-1;if(u){l(u);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,d?_P(d,o)(...c):l(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function _P(e,t){let r;return n;function n(...l){const o=e.length>l.length;let u;o&&l.push(s);try{u=e.apply(this,l)}catch(c){const d=c;if(o&&r)throw d;return s(d)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,s):u instanceof Error?s(u):i(u))}function s(l,...o){r||(r=!0,t(l,...o))}function i(l){s(null,l)}}const Mn={basename:SP,dirname:TP,extname:CP,join:jP,sep:"/"};function SP(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');ec(e);let r=0,n=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let l=-1,o=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else l<0&&(i=!0,l=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(n=s):(o=-1,n=l));return r===n?n=l:n<0&&(n=e.length),e.slice(r,n)}function TP(e){if(ec(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function CP(e){ec(e);let t=e.length,r=-1,n=0,s=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){n=t+1;break}continue}r<0&&(l=!0,r=t+1),o===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function jP(...e){let t=-1,r;for(;++t<e.length;)ec(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":AP(r)}function AP(e){ec(e);const t=e.codePointAt(0)===47;let r=IP(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function IP(e,t){let r="",n=0,s=-1,i=0,l=-1,o,u;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(u=r.lastIndexOf("/"),u!==r.length-1){u<0?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf("/")),s=l,i=0;continue}}else if(r.length>0){r="",n=0,s=l,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),n=l-s-1;s=l,i=0}else o===46&&i>-1?i++:i=-1}return r}function ec(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const RP={cwd:LP};function LP(){return"/"}function Hp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function OP(e){if(typeof e=="string")e=new URL(e);else if(!Hp(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return PP(e)}function PP(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const Yf=["history","path","basename","stem","extname","dirname"];class $N{constructor(t){let r;t?Hp(t)?r={path:t}:typeof t=="string"||DP(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":RP.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Yf.length;){const i=Yf[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)Yf.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?Mn.basename(this.path):void 0}set basename(t){Kf(t,"basename"),Qf(t,"basename"),this.path=Mn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Mn.dirname(this.path):void 0}set dirname(t){a1(this.basename,"dirname"),this.path=Mn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Mn.extname(this.path):void 0}set extname(t){if(Qf(t,"extname"),a1(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Mn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Hp(t)&&(t=OP(t)),Kf(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Mn.basename(this.path,this.extname):void 0}set stem(t){Kf(t,"stem"),Qf(t,"stem"),this.path=Mn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new mr(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Qf(e,t){if(e&&e.includes(Mn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Mn.sep+"`")}function Kf(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function a1(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function DP(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const MP=function(e){const n=this.constructor.prototype,s=n[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},FP={}.hasOwnProperty;class Ig extends MP{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=kP()}copy(){const t=new Ig;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(Gf(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(Jf("data",this.frozen),this.namespace[t]=r,this):FP.call(this.namespace,t)&&this.namespace[t]||void 0:t?(Jf("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=Uc(t),n=this.parser||this.Parser;return Zf("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),Zf("process",this.parser||this.Parser),Xf("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,l){const o=Uc(t),u=n.parse(o);n.run(u,o,function(d,h,f){if(d||!h||!f)return c(d);const p=h,g=n.stringify(p,f);HP(g)?f.value=g:f.result=g,c(d,f)});function c(d,h){d||!h?l(d):i?i(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),Zf("processSync",this.parser||this.Parser),Xf("processSync",this.compiler||this.Compiler),this.process(t,s),l1("processSync","process",r),n;function s(i,l){r=!0,Xb(i),n=l}}run(t,r,n){i1(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(l,o){const u=Uc(r);s.run(t,u,c);function c(d,h,f){const p=h||t;d?o(d):l?l(p):n(void 0,p,f)}}}runSync(t,r){let n=!1,s;return this.run(t,r,i),l1("runSync","run",n),s;function i(l,o){Xb(l),s=o,n=!0}}stringify(t,r){this.freeze();const n=Uc(r),s=this.compiler||this.Compiler;return Xf("stringify",s),i1(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(Jf("use",this.frozen),t!=null)if(typeof t=="function")u(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")u(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...h]=c;u(d,h)}else l(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function l(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(s.settings=Gf(!0,s.settings,c.settings))}function o(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const h=c[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function u(c,d){let h=-1,f=-1;for(;++h<n.length;)if(n[h][0]===c){f=h;break}if(f===-1)n.push([c,...d]);else if(d.length>0){let[p,...g]=d;const y=n[f][1];Bp(y)&&Bp(p)&&(p=Gf(!0,y,p)),n[f]=[c,p,...g]}}}}const UP=new Ig().freeze();function Zf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Xf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Jf(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function i1(e){if(!Bp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function l1(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Uc(e){return BP(e)?e:new $N(e)}function BP(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function HP(e){return typeof e=="string"||$P(e)}function $P(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const zP="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",o1=[],u1={allowDangerousHtml:!0},qP=/^(https?|ircs?|mailto|xmpp)$/i,VP=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function zN(e){const t=e.allowedElements,r=e.allowElement,n=e.children||"",s=e.className,i=e.components,l=e.disallowedElements,o=e.rehypePlugins||o1,u=e.remarkPlugins||o1,c=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...u1}:u1,d=e.skipHtml,h=e.unwrapDisallowed,f=e.urlTransform||WP,p=UP().use(CO).use(u).use(EP,c).use(o),g=new $N;typeof n=="string"&&(g.value=n);for(const b of VP)Object.hasOwn(e,b.from)&&(""+b.from+(b.to?"use `"+b.to+"` instead":"remove it")+zP+b.id,void 0);const y=p.parse(g);let E=p.runSync(y,g);return s&&(E={type:"element",tagName:"div",properties:{className:s},children:E.type==="root"?E.children:[E]}),Uh(E,x),cR(E,{Fragment:a.Fragment,components:i,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function x(b,v,_){if(b.type==="raw"&&_&&typeof v=="number")return d?_.children.splice(v,1):_.children[v]={type:"text",value:b.value},v;if(b.type==="element"){let k;for(k in qf)if(Object.hasOwn(qf,k)&&Object.hasOwn(b.properties,k)){const S=b.properties[k],I=qf[k];(I===null||I.includes(b.tagName))&&(b.properties[k]=f(String(S||""),k,b))}}if(b.type==="element"){let k=t?!t.includes(b.tagName):l?l.includes(b.tagName):!1;if(!k&&r&&typeof v=="number"&&(k=!r(b,v,_)),k&&_&&typeof v=="number")return h&&b.children?_.children.splice(v,1,...b.children):_.children.splice(v,1),v}}}function WP(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||qP.test(e.slice(0,t))?e:""}function c1(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(t);for(;s!==-1;)n++,s=r.indexOf(t,s+t.length);return n}function GP(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function YP(e,t,r){const s=Mh((r||{}).ignore||[]),i=QP(t);let l=-1;for(;++l<i.length;)BN(e,"text",o);function o(c,d){let h=-1,f;for(;++h<d.length;){const p=d[h],g=f?f.children:void 0;if(s(p,g?g.indexOf(p):void 0,f))return;f=p}if(f)return u(c,d)}function u(c,d){const h=d[d.length-1],f=i[l][0],p=i[l][1];let g=0;const E=h.children.indexOf(c);let x=!1,b=[];f.lastIndex=0;let v=f.exec(c.value);for(;v;){const _=v.index,k={index:v.index,input:v.input,stack:[...d,c]};let S=p(...v,k);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?f.lastIndex=_+1:(g!==_&&b.push({type:"text",value:c.value.slice(g,_)}),Array.isArray(S)?b.push(...S):S&&b.push(S),g=_+v[0].length,x=!0),!f.global)break;v=f.exec(c.value)}return x?(g<c.value.length&&b.push({type:"text",value:c.value.slice(g)}),h.children.splice(E,1,...b)):b=[c],E+b.length}}function QP(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let n=-1;for(;++n<r.length;){const s=r[n];t.push([KP(s[0]),ZP(s[1])])}return t}function KP(e){return typeof e=="string"?new RegExp(GP(e),"g"):e}function ZP(e){return typeof e=="function"?e:function(){return e}}const em="phrasing",tm=["autolink","link","image","label"];function XP(){return{transforms:[aD],enter:{literalAutolink:eD,literalAutolinkEmail:rm,literalAutolinkHttp:rm,literalAutolinkWww:rm},exit:{literalAutolink:sD,literalAutolinkEmail:nD,literalAutolinkHttp:tD,literalAutolinkWww:rD}}}function JP(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:em,notInConstruct:tm},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:em,notInConstruct:tm},{character:":",before:"[ps]",after:"\\/",inConstruct:em,notInConstruct:tm}]}}function eD(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function rm(e){this.config.enter.autolinkProtocol.call(this,e)}function tD(e){this.config.exit.autolinkProtocol.call(this,e)}function rD(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function nD(e){this.config.exit.autolinkEmail.call(this,e)}function sD(e){this.exit(e)}function aD(e){YP(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,iD],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),lD]],{ignore:["link","linkReference"]})}function iD(e,t,r,n,s){let i="";if(!qN(s)||(/^w/i.test(t)&&(r=t+r,t="",i="http://"),!oD(r)))return!1;const l=uD(r+n);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function lD(e,t,r,n){return!qN(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function oD(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function uD(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],n=r.indexOf(")");const s=c1(e,"(");let i=c1(e,")");for(;n!==-1&&s>i;)e+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[e,r]}function qN(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||ci(r)||Oh(r))&&(!t||r!==47)}VN.peek=vD;function cD(){return{enter:{gfmFootnoteDefinition:hD,gfmFootnoteDefinitionLabelString:fD,gfmFootnoteCall:gD,gfmFootnoteCallString:xD},exit:{gfmFootnoteDefinition:pD,gfmFootnoteDefinitionLabelString:mD,gfmFootnoteCall:bD,gfmFootnoteCallString:yD}}}function dD(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:wD,footnoteReference:VN}}}function hD(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function fD(){this.buffer()}function mD(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=jn(this.sliceSerialize(e)).toLowerCase()}function pD(e){this.exit(e)}function gD(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function xD(){this.buffer()}function yD(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=jn(this.sliceSerialize(e)).toLowerCase()}function bD(e){this.exit(e)}function VN(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteReference"),o=r.enter("reference");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),l(),i+=s.move("]"),i}function vD(){return"["}function wD(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteDefinition"),o=r.enter("label");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),i+=s.move("]:"+(e.children&&e.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(e,s.current()),ED)),l(),i}function ED(e,t,r){return t===0?e:(r?"":"    ")+e}const ND=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];WN.peek=CD;function kD(){return{canContainEols:["delete"],enter:{strikethrough:SD},exit:{strikethrough:TD}}}function _D(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:ND}],handlers:{delete:WN}}}function SD(e){this.enter({type:"delete",children:[]},e)}function TD(e){this.exit(e)}function WN(e,t,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let l=s.move("~~");return l+=r.containerPhrasing(e,{...s.current(),before:l,after:"~"}),l+=s.move("~~"),i(),l}function CD(){return"~"}function jD(e){return e.length}function AD(e,t){const r=t||{},n=(r.align||[]).concat(),s=r.stringLength||jD,i=[],l=[],o=[],u=[];let c=0,d=-1;for(;++d<e.length;){const y=[],E=[];let x=-1;for(e[d].length>c&&(c=e[d].length);++x<e[d].length;){const b=ID(e[d][x]);if(r.alignDelimiters!==!1){const v=s(b);E[x]=v,(u[x]===void 0||v>u[x])&&(u[x]=v)}y.push(b)}l[d]=y,o[d]=E}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=d1(n[h]);else{const y=d1(n);for(;++h<c;)i[h]=y}h=-1;const f=[],p=[];for(;++h<c;){const y=i[h];let E="",x="";y===99?(E=":",x=":"):y===108?E=":":y===114&&(x=":");let b=r.alignDelimiters===!1?1:Math.max(1,u[h]-E.length-x.length);const v=E+"-".repeat(b)+x;r.alignDelimiters!==!1&&(b=E.length+b+x.length,b>u[h]&&(u[h]=b),p[h]=b),f[h]=v}l.splice(1,0,f),o.splice(1,0,p),d=-1;const g=[];for(;++d<l.length;){const y=l[d],E=o[d];h=-1;const x=[];for(;++h<c;){const b=y[h]||"";let v="",_="";if(r.alignDelimiters!==!1){const k=u[h]-(E[h]||0),S=i[h];S===114?v=" ".repeat(k):S===99?k%2?(v=" ".repeat(k/2+.5),_=" ".repeat(k/2-.5)):(v=" ".repeat(k/2),_=v):_=" ".repeat(k)}r.delimiterStart!==!1&&!h&&x.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&b==="")&&(r.delimiterStart!==!1||h)&&x.push(" "),r.alignDelimiters!==!1&&x.push(v),x.push(b),r.alignDelimiters!==!1&&x.push(_),r.padding!==!1&&x.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&x.push("|")}g.push(r.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return g.join(`
`)}function ID(e){return e==null?"":String(e)}function d1(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const h1={}.hasOwnProperty;function GN(e,t){const r=t||{};function n(s,...i){let l=n.invalid;const o=n.handlers;if(s&&h1.call(s,e)){const u=String(s[e]);l=h1.call(o,u)?o[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function RD(e,t,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const l=r.indentLines(r.containerFlow(e,i.current()),LD);return s(),l}function LD(e,t,r){return">"+(r?"":" ")+e}function OD(e,t){return f1(e,t.inConstruct,!0)&&!f1(e,t.notInConstruct,!1)}function f1(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function m1(e,t,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&OD(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function PD(e,t){const r=String(e);let n=r.indexOf(t),s=n,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>l&&(l=i):i=1,s=n+t.length,n=r.indexOf(t,s);return l}function DD(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function MD(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function FD(e,t,r,n){const s=MD(r),i=e.value||"",l=s==="`"?"GraveAccent":"Tilde";if(DD(e,r)){const h=r.enter("codeIndented"),f=r.indentLines(i,UD);return h(),f}const o=r.createTracker(n),u=s.repeat(Math.max(PD(i,s)+1,3)),c=r.enter("codeFenced");let d=o.move(u);if(e.lang){const h=r.enter(`codeFencedLang${l}`);d+=o.move(r.safe(e.lang,{before:d,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=r.enter(`codeFencedMeta${l}`);d+=o.move(" "),d+=o.move(r.safe(e.meta,{before:d,after:`
`,encode:["`"],...o.current()})),h()}return d+=o.move(`
`),i&&(d+=o.move(i+`
`)),d+=o.move(u),c(),d}function UD(e,t,r){return(r?"":"    ")+e}function Rg(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function BD(e,t,r,n){const s=Rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("definition");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("[");return c+=u.move(r.safe(r.associationId(e),{before:c,after:"]",...u.current()})),c+=u.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),l(),c}function HD(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function Eu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Bd(e,t,r){const n=Rl(e),s=Rl(t);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}YN.peek=$D;function YN(e,t,r,n){const s=HD(r),i=r.enter("emphasis"),l=r.createTracker(n),o=l.move(s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Bd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Eu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Bd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Eu(h));const p=l.move(s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function $D(e,t,r){return r.options.emphasis||"*"}function zD(e,t){let r=!1;return Uh(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,Fp}),!!((!e.depth||e.depth<3)&&kg(e)&&(t.options.setext||r))}function qD(e,t,r,n){const s=Math.max(Math.min(6,e.depth||1),1),i=r.createTracker(n);if(zD(e,r)){const d=r.enter("headingSetext"),h=r.enter("phrasing"),f=r.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const l="#".repeat(s),o=r.enter("headingAtx"),u=r.enter("phrasing");i.move(l+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=Eu(c.charCodeAt(0))+c.slice(1)),c=c?l+" "+c:l,r.options.closeAtx&&(c+=" "+l),u(),o(),c}QN.peek=VD;function QN(e){return e.value||""}function VD(){return"<"}KN.peek=WD;function KN(e,t,r,n){const s=Rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("image");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("![");return c+=u.move(r.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),l(),c}function WD(){return"!"}ZN.peek=GD;function ZN(e,t,r,n){const s=e.referenceType,i=r.enter("imageReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("![");const c=r.safe(e.alt,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function GD(){return"!"}XN.peek=YD;function XN(e,t,r){let n=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const l=r.unsafe[i],o=r.compilePattern(l);let u;if(l.atBreak)for(;u=o.exec(n);){let c=u.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(u.index+1)}}return s+n+s}function YD(){return"`"}function JN(e,t){const r=kg(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}ek.peek=QD;function ek(e,t,r,n){const s=Rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.createTracker(n);let o,u;if(JN(e,r)){const d=r.stack;r.stack=[],o=r.enter("autolink");let h=l.move("<");return h+=l.move(r.containerPhrasing(e,{before:h,after:">",...l.current()})),h+=l.move(">"),o(),r.stack=d,h}o=r.enter("link"),u=r.enter("label");let c=l.move("[");return c+=l.move(r.containerPhrasing(e,{before:c,after:"](",...l.current()})),c+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(u=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(e.title,{before:c,after:s,...l.current()})),c+=l.move(s),u()),c+=l.move(")"),o(),c}function QD(e,t,r){return JN(e,r)?"<":"["}tk.peek=KD;function tk(e,t,r,n){const s=e.referenceType,i=r.enter("linkReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("[");const c=r.containerPhrasing(e,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function KD(){return"["}function Lg(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function ZD(e){const t=Lg(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function XD(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function rk(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function JD(e,t,r,n){const s=r.enter("list"),i=r.bulletCurrent;let l=e.ordered?XD(r):Lg(r);const o=e.ordered?l==="."?")":".":ZD(r);let u=t&&r.bulletLastUsed?l===r.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&d&&(!d.children||!d.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(u=!0),rk(r)===l&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=o),r.bulletCurrent=l;const c=r.containerFlow(e,n);return r.bulletLastUsed=l,r.bulletCurrent=i,s(),c}function eM(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function tM(e,t,r,n){const s=eM(r);let i=r.bulletCurrent||Lg(r);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=r.createTracker(n);o.move(i+" ".repeat(l-i.length)),o.shift(l);const u=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),d);return u(),c;function d(h,f,p){return f?(p?"":" ".repeat(l))+h:(p?i:i+" ".repeat(l-i.length))+h}}function rM(e,t,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),l=r.containerPhrasing(e,n);return i(),s(),l}const nM=Mh(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function sM(e,t,r,n){return(e.children.some(function(l){return nM(l)})?r.containerPhrasing:r.containerFlow).call(r,e,n)}function aM(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}nk.peek=iM;function nk(e,t,r,n){const s=aM(r),i=r.enter("strong"),l=r.createTracker(n),o=l.move(s+s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=Bd(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Eu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=Bd(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Eu(h));const p=l.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function iM(e,t,r){return r.options.strong||"*"}function lM(e,t,r,n){return r.safe(e.value,n)}function oM(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function uM(e,t,r){const n=(rk(r)+(r.options.ruleSpaces?" ":"")).repeat(oM(r));return r.options.ruleSpaces?n.slice(0,-1):n}const sk={blockquote:RD,break:m1,code:FD,definition:BD,emphasis:YN,hardBreak:m1,heading:qD,html:QN,image:KN,imageReference:ZN,inlineCode:XN,link:ek,linkReference:tk,list:JD,listItem:tM,paragraph:rM,root:sM,strong:nk,text:lM,thematicBreak:uM};function cM(){return{enter:{table:dM,tableData:p1,tableHeader:p1,tableRow:fM},exit:{codeText:mM,table:hM,tableData:nm,tableHeader:nm,tableRow:nm}}}function dM(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function hM(e){this.exit(e),this.data.inTable=void 0}function fM(e){this.enter({type:"tableRow",children:[]},e)}function nm(e){this.exit(e)}function p1(e){this.enter({type:"tableCell",children:[]},e)}function mM(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,pM));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function pM(e,t){return t==="|"?t:e}function gM(e){const t=e||{},r=t.tableCellPadding,n=t.tablePipeAlign,s=t.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:l,tableCell:u,tableRow:o}};function l(p,g,y,E){return c(d(p,y,E),p.align)}function o(p,g,y,E){const x=h(p,y,E),b=c([x]);return b.slice(0,b.indexOf(`
`))}function u(p,g,y,E){const x=y.enter("tableCell"),b=y.enter("phrasing"),v=y.containerPhrasing(p,{...E,before:i,after:i});return b(),x(),v}function c(p,g){return AD(p,{align:g,alignDelimiters:n,padding:r,stringLength:s})}function d(p,g,y){const E=p.children;let x=-1;const b=[],v=g.enter("table");for(;++x<E.length;)b[x]=h(E[x],g,y);return v(),b}function h(p,g,y){const E=p.children;let x=-1;const b=[],v=g.enter("tableRow");for(;++x<E.length;)b[x]=u(E[x],p,g,y);return v(),b}function f(p,g,y){let E=sk.inlineCode(p,g,y);return y.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function xM(){return{exit:{taskListCheckValueChecked:g1,taskListCheckValueUnchecked:g1,paragraph:bM}}}function yM(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:vM}}}function g1(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function bM(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=t.children;let i=-1,l;for(;++i<s.length;){const o=s[i];if(o.type==="paragraph"){l=o;break}}l===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function vM(e,t,r,n){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=r.createTracker(n);i&&o.move(l);let u=sk.listItem(e,t,r,{...n,...o.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(d){return d+l}}function wM(){return[XP(),cD(),kD(),cM(),xM()]}function EM(e){return{extensions:[JP(),dD(),_D(),gM(e),yM()]}}const NM={tokenize:jM,partial:!0},ak={tokenize:AM,partial:!0},ik={tokenize:IM,partial:!0},lk={tokenize:RM,partial:!0},kM={tokenize:LM,partial:!0},ok={name:"wwwAutolink",tokenize:TM,previous:ck},uk={name:"protocolAutolink",tokenize:CM,previous:dk},_s={name:"emailAutolink",tokenize:SM,previous:hk},Jn={};function _M(){return{text:Jn}}let Ra=48;for(;Ra<123;)Jn[Ra]=_s,Ra++,Ra===58?Ra=65:Ra===91&&(Ra=97);Jn[43]=_s;Jn[45]=_s;Jn[46]=_s;Jn[95]=_s;Jn[72]=[_s,uk];Jn[104]=[_s,uk];Jn[87]=[_s,ok];Jn[119]=[_s,ok];function SM(e,t,r){const n=this;let s,i;return l;function l(h){return!$p(h)||!hk.call(n,n.previous)||Og(n.events)?r(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return $p(h)?(e.consume(h),o):h===64?(e.consume(h),u):r(h)}function u(h){return h===46?e.check(kM,d,c)(h):h===45||h===95||or(h)?(i=!0,e.consume(h),u):d(h)}function c(h){return e.consume(h),s=!0,u}function d(h){return i&&s&&br(n.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):r(h)}}function TM(e,t,r){const n=this;return s;function s(l){return l!==87&&l!==119||!ck.call(n,n.previous)||Og(n.events)?r(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(NM,e.attempt(ak,e.attempt(ik,i),r),r)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function CM(e,t,r){const n=this;let s="",i=!1;return l;function l(h){return(h===72||h===104)&&dk.call(n,n.previous)&&!Og(n.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),o):r(h)}function o(h){if(br(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),u}return r(h)}function u(h){return h===47?(e.consume(h),i?c:(i=!0,u)):r(h)}function c(h){return h===null||Fd(h)||dt(h)||ci(h)||Oh(h)?r(h):e.attempt(ak,e.attempt(ik,d),r)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function jM(e,t,r){let n=0;return s;function s(l){return(l===87||l===119)&&n<3?(n++,e.consume(l),s):l===46&&n===3?(e.consume(l),i):r(l)}function i(l){return l===null?r(l):t(l)}}function AM(e,t,r){let n,s,i;return l;function l(c){return c===46||c===95?e.check(lk,u,o)(c):c===null||dt(c)||ci(c)||c!==45&&Oh(c)?u(c):(i=!0,e.consume(c),l)}function o(c){return c===95?n=!0:(s=n,n=void 0),e.consume(c),l}function u(c){return s||n||!i?r(c):t(c)}}function IM(e,t){let r=0,n=0;return s;function s(l){return l===40?(r++,e.consume(l),s):l===41&&n<r?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(lk,t,i)(l):l===null||dt(l)||ci(l)?t(l):(e.consume(l),s)}function i(l){return l===41&&n++,e.consume(l),s}}function RM(e,t,r){return n;function n(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),n):o===38?(e.consume(o),i):o===93?(e.consume(o),s):o===60||o===null||dt(o)||ci(o)?t(o):r(o)}function s(o){return o===null||o===40||o===91||dt(o)||ci(o)?t(o):n(o)}function i(o){return br(o)?l(o):r(o)}function l(o){return o===59?(e.consume(o),n):br(o)?(e.consume(o),l):r(o)}}function LM(e,t,r){return n;function n(i){return e.consume(i),s}function s(i){return or(i)?r(i):t(i)}}function ck(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||dt(e)}function dk(e){return!br(e)}function hk(e){return!(e===47||$p(e))}function $p(e){return e===43||e===45||e===46||e===95||or(e)}function Og(e){let t=e.length,r=!1;for(;t--;){const n=e[t][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const OM={tokenize:$M,partial:!0};function PM(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:UM,continuation:{tokenize:BM},exit:HM}},text:{91:{name:"gfmFootnoteCall",tokenize:FM},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:DM,resolveTo:MM}}}}function DM(e,t,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let l;for(;s--;){const u=n.events[s][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return o;function o(u){if(!l||!l._balanced)return r(u);const c=jn(n.sliceSerialize({start:l.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function MM(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[r+1],e[r+2],["enter",n,t],e[r+3],e[r+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",n,t]];return e.splice(r,e.length-r+1,...o),e}function FM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,l;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),u}function u(h){return h!==94?r(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!l||h===null||h===91||dt(h))return r(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(jn(n.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(h)}return dt(h)||(l=!0),i++,e.consume(h),h===92?d:c}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,c):c(h)}}function UM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,l=0,o;return u;function u(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):r(g)}function d(g){if(l>999||g===93&&!o||g===null||g===91||dt(g))return r(g);if(g===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return i=jn(n.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return dt(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}function f(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),s.includes(i)||s.push(i),tt(e,p,"gfmFootnoteDefinitionWhitespace")):r(g)}function p(g){return t(g)}}function BM(e,t,r){return e.check(Ju,t,e.attempt(OM,t,r))}function HM(e){e.exit("gfmFootnoteDefinition")}function $M(e,t,r){const n=this;return tt(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):r(i)}}function zM(e){let r=(e||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(l,o){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let c=u;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[u][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[u][1].end)},h={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[u][1].start)},f=[["enter",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["enter",h,o]],p=o.parser.constructs.insideSpan.null;p&&Wr(f,f.length,0,Ph(p,l.slice(c+1,u),o)),Wr(f,f.length,0,[["exit",h,o],["enter",l[u][1],o],["exit",l[u][1],o],["exit",d,o]]),Wr(l,c-1,u-c+3,f),u=c+f.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function i(l,o,u){const c=this.previous,d=this.events;let h=0;return f;function f(g){return c===126&&d[d.length-1][1].type!=="characterEscape"?u(g):(l.enter("strikethroughSequenceTemporary"),p(g))}function p(g){const y=Rl(c);if(g===126)return h>1?u(g):(l.consume(g),h++,p);if(h<2&&!r)return u(g);const E=l.exit("strikethroughSequenceTemporary"),x=Rl(g);return E._open=!x||x===2&&!!y,E._close=!y||y===2&&!!x,o(g)}}}class qM{constructor(){this.map=[]}add(t,r,n){VM(this,t,r,n)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];n.push(t.slice()),t.length=0;let s=n.pop();for(;s;){for(const i of s)t.push(i);s=n.pop()}this.map.length=0}}function VM(e,t,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=r,e.map[s][2].push(...n);return}s+=1}e.map.push([t,r,n])}}function WM(e,t){let r=!1;const n=[];for(;t<e.length;){const s=e[t];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return n}function GM(){return{flow:{null:{name:"table",tokenize:YM,resolveAll:QM}}}}function YM(e,t,r){const n=this;let s=0,i=0,l;return o;function o(T){let H=n.events.length-1;for(;H>-1;){const G=n.events[H][1].type;if(G==="lineEnding"||G==="linePrefix")H--;else break}const O=H>-1?n.events[H][1].type:null,q=O==="tableHead"||O==="tableRow"?S:u;return q===S&&n.parser.lazy[n.now().line]?r(T):q(T)}function u(T){return e.enter("tableHead"),e.enter("tableRow"),c(T)}function c(T){return T===124||(l=!0,i+=1),d(T)}function d(T){return T===null?r(T):Ce(T)?i>1?(i=0,n.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),p):r(T):Ge(T)?tt(e,d,"whitespace")(T):(i+=1,l&&(l=!1,s+=1),T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),l=!0,d):(e.enter("data"),h(T)))}function h(T){return T===null||T===124||dt(T)?(e.exit("data"),d(T)):(e.consume(T),T===92?f:h)}function f(T){return T===92||T===124?(e.consume(T),h):h(T)}function p(T){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(T):(e.enter("tableDelimiterRow"),l=!1,Ge(T)?tt(e,g,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):g(T))}function g(T){return T===45||T===58?E(T):T===124?(l=!0,e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),y):k(T)}function y(T){return Ge(T)?tt(e,E,"whitespace")(T):E(T)}function E(T){return T===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),x):T===45?(i+=1,x(T)):T===null||Ce(T)?_(T):k(T)}function x(T){return T===45?(e.enter("tableDelimiterFiller"),b(T)):k(T)}function b(T){return T===45?(e.consume(T),b):T===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),v):(e.exit("tableDelimiterFiller"),v(T))}function v(T){return Ge(T)?tt(e,_,"whitespace")(T):_(T)}function _(T){return T===124?g(T):T===null||Ce(T)?!l||s!==i?k(T):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(T)):k(T)}function k(T){return r(T)}function S(T){return e.enter("tableRow"),I(T)}function I(T){return T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),I):T===null||Ce(T)?(e.exit("tableRow"),t(T)):Ge(T)?tt(e,I,"whitespace")(T):(e.enter("data"),j(T))}function j(T){return T===null||T===124||dt(T)?(e.exit("data"),I(T)):(e.consume(T),T===92?P:j)}function P(T){return T===92||T===124?(e.consume(T),j):j(T)}}function QM(e,t){let r=-1,n=!0,s=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,u=0,c,d,h;const f=new qM;for(;++r<e.length;){const p=e[r],g=p[1];p[0]==="enter"?g.type==="tableHead"?(o=!1,u!==0&&(x1(f,t,u,c,d),d=void 0,u=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",c,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],l=[0,r+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",d,t]])),s=g.type==="tableDelimiterRow"?2:d?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(n=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],h=Bc(f,t,i,s,void 0,h),i=[0,0,0,0]),l[2]=r)):g.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(l[0]=l[1],h=Bc(f,t,i,s,void 0,h)),i=l,l=[i[1],r,0,0])):g.type==="tableHead"?(o=!0,u=r):g.type==="tableRow"||g.type==="tableDelimiterRow"?(u=r,i[1]!==0?(l[0]=l[1],h=Bc(f,t,i,s,r,h)):l[1]!==0&&(h=Bc(f,t,l,s,r,h)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(l[3]=r)}for(u!==0&&x1(f,t,u,c,d),f.consume(t.events),r=-1;++r<t.events.length;){const p=t.events[r];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=WM(t.events,r))}return e}function Bc(e,t,r,n,s,i){const l=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(i.end=Object.assign({},Ii(t.events,r[0])),e.add(r[0],0,[["exit",i,t]]));const u=Ii(t.events,r[1]);if(i={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(r[1],0,[["enter",i,t]]),r[2]!==0){const c=Ii(t.events,r[2]),d=Ii(t.events,r[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(r[2],0,[["enter",h,t]]),n!==2){const f=t.events[r[2]],p=t.events[r[3]];if(f[1].end=Object.assign({},p[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const g=r[2]+1,y=r[3]-r[2]-1;e.add(g,y,[])}}e.add(r[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},Ii(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function x1(e,t,r,n,s){const i=[],l=Ii(t.events,r);s&&(s.end=Object.assign({},l),i.push(["exit",s,t])),n.end=Object.assign({},l),i.push(["exit",n,t]),e.add(r+1,0,i)}function Ii(e,t){const r=e[t],n=r[0]==="enter"?"start":"end";return r[1][n]}const KM={name:"tasklistCheck",tokenize:XM};function ZM(){return{text:{91:KM}}}function XM(e,t,r){const n=this;return s;function s(u){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return dt(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):r(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(u)}function o(u){return Ce(u)?t(u):Ge(u)?e.check({tokenize:JM},t,r)(u):r(u)}}function JM(e,t,r){return tt(e,n,"whitespace");function n(s){return s===null?r(s):t(s)}}function e8(e){return wN([_M(),PM(),zM(e),GM(),ZM()])}const t8={};function fk(e){const t=this,r=e||t8,n=t.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),l=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(e8(r)),i.push(wM()),l.push(EM(r))}const y1=/[#.]/g;function r8(e,t){const r=e||"",n={};let s=0,i,l;for(;s<r.length;){y1.lastIndex=s;const o=y1.exec(r),u=r.slice(s,o?o.index:r.length);u&&(i?i==="#"?n.id=u:Array.isArray(n.className)?n.className.push(u):n.className=[u]:l=u,s+=u.length),o&&(i=o[0],s++)}return{type:"element",tagName:l||t||"div",properties:n,children:[]}}const zp={}.hasOwnProperty;function mk(e,t,r){const n=r&&i8(r);function s(i,l,...o){let u=-1,c;if(i==null){c={type:"root",children:[]};const d=l;o.unshift(d)}else if(c=r8(i,t),c.tagName=c.tagName.toLowerCase(),n&&zp.call(n,c.tagName)&&(c.tagName=n[c.tagName]),n8(l))o.unshift(l);else{let d;for(d in l)zp.call(l,d)&&s8(e,c.properties,d,l[d])}for(;++u<o.length;)qp(c.children,o[u]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function n8(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,r=Object.keys(e);for(const n of r){const s=t[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function s8(e,t,r,n){const s=Rh(e,r);let i=-1,l;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;l=n}else typeof n=="boolean"?l=n:typeof n=="string"?s.spaceSeparated?l=_b(n):s.commaSeparated?l=vb(n):s.commaOrSpaceSeparated?l=_b(vb(n).join(" ")):l=b1(s,s.property,n):Array.isArray(n)?l=n.concat():l=s.property==="style"?a8(n):String(n);if(Array.isArray(l)){const o=[];for(;++i<l.length;){const u=b1(s,s.property,l[i]);o[i]=u}l=o}if(s.property==="className"&&Array.isArray(t.className)){const o=l;l=t.className.concat(o)}t[s.property]=l}}function qp(e,t){let r=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)qp(e,t[r]);else if(typeof t=="object"&&"type"in t)t.type==="root"?qp(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function b1(e,t,r){if(typeof r=="string"){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(r===""||vu(r)===vu(t)))return!0}return r}function a8(e){const t=[];let r;for(r in e)zp.call(e,r)&&t.push([r,e[r]].join(": "));return t.join("; ")}function i8(e){const t={};let r=-1;for(;++r<e.length;)t[e[r].toLowerCase()]=e[r];return t}const l8=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],o8=mk(Xu,"div"),u8=mk(Ca,"g",l8);function c8(e){const t=String(e),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=r[l];if(o===void 0){const u=v1(t,r[l-1]);o=u===-1?t.length+1:u+1,r[l]=o}if(o>i)return{line:l+1,column:i-(l>0?r[l-1]:0)+1,offset:i};l++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const o=r[r.length-1],u=v1(t,o),c=u===-1?t.length+1:u+1;if(o===c)break;r.push(c)}const l=(i.line>1?r[i.line-2]:0)+i.column-1;if(l<r[i.line-1])return l}}}function v1(e,t){const r=e.indexOf("\r",t),n=e.indexOf(`
`,t);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const za={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},pk={}.hasOwnProperty,d8=Object.prototype;function h8(e,t){const r=t||{};return Pg({file:r.file||void 0,location:!1,schema:r.space==="svg"?Ca:Xu,verbose:r.verbose||!1},e)}function Pg(e,t){let r;switch(t.nodeName){case"#comment":{const n=t;return r={type:"comment",value:n.data},sd(e,n,r),r}case"#document":case"#document-fragment":{const n=t,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:gk(e,t.childNodes),data:{quirksMode:s}},e.file&&e.location){const i=String(e.file),l=c8(i),o=l.toPoint(0),u=l.toPoint(i.length);r.position={start:o,end:u}}return r}case"#documentType":{const n=t;return r={type:"doctype"},sd(e,n,r),r}case"#text":{const n=t;return r={type:"text",value:n.value},sd(e,n,r),r}default:return r=f8(e,t),r}}function gk(e,t){let r=-1;const n=[];for(;++r<t.length;){const s=Pg(e,t[r]);n.push(s)}return n}function f8(e,t){const r=e.schema;e.schema=t.namespaceURI===za.svg?Ca:Xu;let n=-1;const s={};for(;++n<t.attrs.length;){const o=t.attrs[n],u=(o.prefix?o.prefix+":":"")+o.name;pk.call(d8,u)||(s[u]=o.value)}const l=(e.schema.space==="svg"?u8:o8)(t.tagName,s,gk(e,t.childNodes));if(sd(e,t,l),l.tagName==="template"){const o=t,u=o.sourceCodeLocation,c=u&&u.startTag&&Vi(u.startTag),d=u&&u.endTag&&Vi(u.endTag),h=Pg(e,o.content);c&&d&&e.file&&(h.position={start:c.end,end:d.start}),l.content=h}return e.schema=r,l}function sd(e,t,r){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const n=m8(e,r,t.sourceCodeLocation);n&&(e.location=!0,r.position=n)}}function m8(e,t,r){const n=Vi(r);if(t.type==="element"){const s=t.children[t.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),e.verbose){const i={};let l;if(r.attrs)for(l in r.attrs)pk.call(r.attrs,l)&&(i[Rh(e.schema,l).property]=Vi(r.attrs[l]));r.startTag;const o=Vi(r.startTag),u=r.endTag?Vi(r.endTag):void 0,c={opening:o};u&&(c.closing=u),c.properties=i,t.data={position:c}}}return n}function Vi(e){const t=w1({line:e.startLine,column:e.startCol,offset:e.startOffset}),r=w1({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||r?{start:t,end:r}:void 0}function w1(e){return e.line&&e.column?e:void 0}const p8={},g8={}.hasOwnProperty,xk=GN("type",{handlers:{root:y8,element:N8,text:w8,comment:E8,doctype:v8}});function x8(e,t){const n=(t||p8).space;return xk(e,n==="svg"?Ca:Xu)}function y8(e,t){const r={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=Dg(e.children,r,t),Ql(e,r),r}function b8(e,t){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=Dg(e.children,r,t),Ql(e,r),r}function v8(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return Ql(e,t),t}function w8(e){const t={nodeName:"#text",value:e.value,parentNode:null};return Ql(e,t),t}function E8(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return Ql(e,t),t}function N8(e,t){const r=t;let n=r;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=Ca);const s=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&g8.call(e.properties,i)){const u=k8(n,i,e.properties[i]);u&&s.push(u)}}const l=n.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:s,namespaceURI:za[l],childNodes:[],parentNode:null};return o.childNodes=Dg(e.children,o,n),Ql(e,o),e.tagName==="template"&&e.content&&(o.content=b8(e.content,n)),o}function k8(e,t,r){const n=Rh(e,t);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?nN(r):hN(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=za[n.space]}return s}function Dg(e,t,r){let n=-1;const s=[];if(e)for(;++n<e.length;){const i=xk(e[n],r);i.parentNode=t,s.push(i)}return s}function Ql(e,t){const r=e.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,t.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const _8=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],S8=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),wt="";var C;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(C||(C={}));const Sr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function yk(e){return e>=55296&&e<=57343}function T8(e){return e>=56320&&e<=57343}function C8(e,t){return(e-55296)*1024+9216+t}function bk(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function vk(e){return e>=64976&&e<=65007||S8.has(e)}var X;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(X||(X={}));const j8=65536;class A8{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=j8,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,r){const{line:n,col:s,offset:i}=this,l=s+r,o=i+r;return{code:t,startLine:n,endLine:n,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(T8(r))return this.pos++,this._addGap(),C8(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,C.EOF;return this._err(X.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;const n=this.html.charCodeAt(r);return n===C.CARRIAGE_RETURN?C.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;let t=this.html.charCodeAt(this.pos);return t===C.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,C.LINE_FEED):t===C.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,yk(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===C.LINE_FEED||t===C.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){bk(t)?this._err(X.controlCharacterInInputStream):vk(t)&&this._err(X.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var We;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(We||(We={}));function wk(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}const Ek=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),I8=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var sm;const R8=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),L8=(sm=String.fromCodePoint)!==null&&sm!==void 0?sm:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function O8(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=R8.get(e))!==null&&t!==void 0?t:e}var Zt;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Zt||(Zt={}));const P8=32;var aa;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(aa||(aa={}));function Vp(e){return e>=Zt.ZERO&&e<=Zt.NINE}function D8(e){return e>=Zt.UPPER_A&&e<=Zt.UPPER_F||e>=Zt.LOWER_A&&e<=Zt.LOWER_F}function M8(e){return e>=Zt.UPPER_A&&e<=Zt.UPPER_Z||e>=Zt.LOWER_A&&e<=Zt.LOWER_Z||Vp(e)}function F8(e){return e===Zt.EQUALS||M8(e)}var Yt;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Yt||(Yt={}));var cs;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(cs||(cs={}));class Nk{constructor(t,r,n){this.decodeTree=t,this.emitCodePoint=r,this.errors=n,this.state=Yt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=cs.Strict}startEntity(t){this.decodeMode=t,this.state=Yt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,r){switch(this.state){case Yt.EntityStart:return t.charCodeAt(r)===Zt.NUM?(this.state=Yt.NumericStart,this.consumed+=1,this.stateNumericStart(t,r+1)):(this.state=Yt.NamedEntity,this.stateNamedEntity(t,r));case Yt.NumericStart:return this.stateNumericStart(t,r);case Yt.NumericDecimal:return this.stateNumericDecimal(t,r);case Yt.NumericHex:return this.stateNumericHex(t,r);case Yt.NamedEntity:return this.stateNamedEntity(t,r)}}stateNumericStart(t,r){return r>=t.length?-1:(t.charCodeAt(r)|P8)===Zt.LOWER_X?(this.state=Yt.NumericHex,this.consumed+=1,this.stateNumericHex(t,r+1)):(this.state=Yt.NumericDecimal,this.stateNumericDecimal(t,r))}addToNumericResult(t,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(r,i),s),this.consumed+=i}}stateNumericHex(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(Vp(s)||D8(s))r+=1;else return this.addToNumericResult(t,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,n,r,16),-1}stateNumericDecimal(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(Vp(s))r+=1;else return this.addToNumericResult(t,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,n,r,10),-1}emitNumericEntity(t,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Zt.SEMI)this.consumed+=1;else if(this.decodeMode===cs.Strict)return 0;return this.emitCodePoint(O8(this.result),this.consumed),this.errors&&(t!==Zt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&aa.VALUE_LENGTH)>>14;for(;r<t.length;r++,this.excess++){const l=t.charCodeAt(r);if(this.treeIndex=U8(n,s,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===cs.Attribute&&(i===0||F8(l))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&aa.VALUE_LENGTH)>>14,i!==0){if(l===Zt.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==cs.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:r,decodeTree:n}=this,s=(n[r]&aa.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[t]&~aa.VALUE_LENGTH:s[t+1],n),r===3&&this.emitCodePoint(s[t+2],n),n}end(){var t;switch(this.state){case Yt.NamedEntity:return this.result!==0&&(this.decodeMode!==cs.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Yt.NumericDecimal:return this.emitNumericEntity(0,2);case Yt.NumericHex:return this.emitNumericEntity(0,3);case Yt.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Yt.EntityStart:return 0}}}function kk(e){let t="";const r=new Nk(e,n=>t+=L8(n));return function(s,i){let l=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(l,o),r.startEntity(i);const c=r.write(s,o+1);if(c<0){l=o+r.end();break}l=o+c,o=c===0?l+1:l}const u=t+s.slice(l);return t="",u}}function U8(e,t,r,n){const s=(t&aa.BRANCH_LENGTH)>>7,i=t&aa.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const u=n-i;return u<0||u>=s?-1:e[r+u]-1}let l=r,o=l+s-1;for(;l<=o;){const u=l+o>>>1,c=e[u];if(c<n)l=u+1;else if(c>n)o=u-1;else return e[u+s]}return-1}kk(Ek);kk(I8);var ne;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(ne||(ne={}));var ei;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(ei||(ei={}));var ln;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(ln||(ln={}));var W;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(W||(W={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(m||(m={}));const B8=new Map([[W.A,m.A],[W.ADDRESS,m.ADDRESS],[W.ANNOTATION_XML,m.ANNOTATION_XML],[W.APPLET,m.APPLET],[W.AREA,m.AREA],[W.ARTICLE,m.ARTICLE],[W.ASIDE,m.ASIDE],[W.B,m.B],[W.BASE,m.BASE],[W.BASEFONT,m.BASEFONT],[W.BGSOUND,m.BGSOUND],[W.BIG,m.BIG],[W.BLOCKQUOTE,m.BLOCKQUOTE],[W.BODY,m.BODY],[W.BR,m.BR],[W.BUTTON,m.BUTTON],[W.CAPTION,m.CAPTION],[W.CENTER,m.CENTER],[W.CODE,m.CODE],[W.COL,m.COL],[W.COLGROUP,m.COLGROUP],[W.DD,m.DD],[W.DESC,m.DESC],[W.DETAILS,m.DETAILS],[W.DIALOG,m.DIALOG],[W.DIR,m.DIR],[W.DIV,m.DIV],[W.DL,m.DL],[W.DT,m.DT],[W.EM,m.EM],[W.EMBED,m.EMBED],[W.FIELDSET,m.FIELDSET],[W.FIGCAPTION,m.FIGCAPTION],[W.FIGURE,m.FIGURE],[W.FONT,m.FONT],[W.FOOTER,m.FOOTER],[W.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[W.FORM,m.FORM],[W.FRAME,m.FRAME],[W.FRAMESET,m.FRAMESET],[W.H1,m.H1],[W.H2,m.H2],[W.H3,m.H3],[W.H4,m.H4],[W.H5,m.H5],[W.H6,m.H6],[W.HEAD,m.HEAD],[W.HEADER,m.HEADER],[W.HGROUP,m.HGROUP],[W.HR,m.HR],[W.HTML,m.HTML],[W.I,m.I],[W.IMG,m.IMG],[W.IMAGE,m.IMAGE],[W.INPUT,m.INPUT],[W.IFRAME,m.IFRAME],[W.KEYGEN,m.KEYGEN],[W.LABEL,m.LABEL],[W.LI,m.LI],[W.LINK,m.LINK],[W.LISTING,m.LISTING],[W.MAIN,m.MAIN],[W.MALIGNMARK,m.MALIGNMARK],[W.MARQUEE,m.MARQUEE],[W.MATH,m.MATH],[W.MENU,m.MENU],[W.META,m.META],[W.MGLYPH,m.MGLYPH],[W.MI,m.MI],[W.MO,m.MO],[W.MN,m.MN],[W.MS,m.MS],[W.MTEXT,m.MTEXT],[W.NAV,m.NAV],[W.NOBR,m.NOBR],[W.NOFRAMES,m.NOFRAMES],[W.NOEMBED,m.NOEMBED],[W.NOSCRIPT,m.NOSCRIPT],[W.OBJECT,m.OBJECT],[W.OL,m.OL],[W.OPTGROUP,m.OPTGROUP],[W.OPTION,m.OPTION],[W.P,m.P],[W.PARAM,m.PARAM],[W.PLAINTEXT,m.PLAINTEXT],[W.PRE,m.PRE],[W.RB,m.RB],[W.RP,m.RP],[W.RT,m.RT],[W.RTC,m.RTC],[W.RUBY,m.RUBY],[W.S,m.S],[W.SCRIPT,m.SCRIPT],[W.SEARCH,m.SEARCH],[W.SECTION,m.SECTION],[W.SELECT,m.SELECT],[W.SOURCE,m.SOURCE],[W.SMALL,m.SMALL],[W.SPAN,m.SPAN],[W.STRIKE,m.STRIKE],[W.STRONG,m.STRONG],[W.STYLE,m.STYLE],[W.SUB,m.SUB],[W.SUMMARY,m.SUMMARY],[W.SUP,m.SUP],[W.TABLE,m.TABLE],[W.TBODY,m.TBODY],[W.TEMPLATE,m.TEMPLATE],[W.TEXTAREA,m.TEXTAREA],[W.TFOOT,m.TFOOT],[W.TD,m.TD],[W.TH,m.TH],[W.THEAD,m.THEAD],[W.TITLE,m.TITLE],[W.TR,m.TR],[W.TRACK,m.TRACK],[W.TT,m.TT],[W.U,m.U],[W.UL,m.UL],[W.SVG,m.SVG],[W.VAR,m.VAR],[W.WBR,m.WBR],[W.XMP,m.XMP]]);function Kl(e){var t;return(t=B8.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const se=m,H8={[ne.HTML]:new Set([se.ADDRESS,se.APPLET,se.AREA,se.ARTICLE,se.ASIDE,se.BASE,se.BASEFONT,se.BGSOUND,se.BLOCKQUOTE,se.BODY,se.BR,se.BUTTON,se.CAPTION,se.CENTER,se.COL,se.COLGROUP,se.DD,se.DETAILS,se.DIR,se.DIV,se.DL,se.DT,se.EMBED,se.FIELDSET,se.FIGCAPTION,se.FIGURE,se.FOOTER,se.FORM,se.FRAME,se.FRAMESET,se.H1,se.H2,se.H3,se.H4,se.H5,se.H6,se.HEAD,se.HEADER,se.HGROUP,se.HR,se.HTML,se.IFRAME,se.IMG,se.INPUT,se.LI,se.LINK,se.LISTING,se.MAIN,se.MARQUEE,se.MENU,se.META,se.NAV,se.NOEMBED,se.NOFRAMES,se.NOSCRIPT,se.OBJECT,se.OL,se.P,se.PARAM,se.PLAINTEXT,se.PRE,se.SCRIPT,se.SECTION,se.SELECT,se.SOURCE,se.STYLE,se.SUMMARY,se.TABLE,se.TBODY,se.TD,se.TEMPLATE,se.TEXTAREA,se.TFOOT,se.TH,se.THEAD,se.TITLE,se.TR,se.TRACK,se.UL,se.WBR,se.XMP]),[ne.MATHML]:new Set([se.MI,se.MO,se.MN,se.MS,se.MTEXT,se.ANNOTATION_XML]),[ne.SVG]:new Set([se.TITLE,se.FOREIGN_OBJECT,se.DESC]),[ne.XLINK]:new Set,[ne.XML]:new Set,[ne.XMLNS]:new Set},Wp=new Set([se.H1,se.H2,se.H3,se.H4,se.H5,se.H6]);W.STYLE,W.SCRIPT,W.XMP,W.IFRAME,W.NOEMBED,W.NOFRAMES,W.PLAINTEXT;var R;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(R||(R={}));const Ot={DATA:R.DATA,RCDATA:R.RCDATA,RAWTEXT:R.RAWTEXT,SCRIPT_DATA:R.SCRIPT_DATA,PLAINTEXT:R.PLAINTEXT,CDATA_SECTION:R.CDATA_SECTION};function $8(e){return e>=C.DIGIT_0&&e<=C.DIGIT_9}function No(e){return e>=C.LATIN_CAPITAL_A&&e<=C.LATIN_CAPITAL_Z}function z8(e){return e>=C.LATIN_SMALL_A&&e<=C.LATIN_SMALL_Z}function Ds(e){return z8(e)||No(e)}function E1(e){return Ds(e)||$8(e)}function Hc(e){return e+32}function _k(e){return e===C.SPACE||e===C.LINE_FEED||e===C.TABULATION||e===C.FORM_FEED}function N1(e){return _k(e)||e===C.SOLIDUS||e===C.GREATER_THAN_SIGN}function q8(e){return e===C.NULL?X.nullCharacterReference:e>1114111?X.characterReferenceOutsideUnicodeRange:yk(e)?X.surrogateCharacterReference:vk(e)?X.noncharacterCharacterReference:bk(e)||e===C.CARRIAGE_RETURN?X.controlCharacterReference:null}class V8{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=R.DATA,this.returnState=R.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new A8(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new Nk(Ek,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(X.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(X.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=q8(n);s&&this._err(s,1)}}:void 0)}_err(t,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(t,r))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:We.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:We.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:We.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:We.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(wk(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(X.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=Kl(t.tagName),t.type===We.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(X.endTagWithAttributes),t.selfClosing&&this._err(X.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case We.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case We.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case We.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:We.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,r)}_emitCodePoint(t){const r=_k(t)?We.WHITESPACE_CHARACTER:t===C.NULL?We.NULL_CHARACTER:We.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(We.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=R.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?cs.Attribute:cs.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===R.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===R.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===R.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case R.DATA:{this._stateData(t);break}case R.RCDATA:{this._stateRcdata(t);break}case R.RAWTEXT:{this._stateRawtext(t);break}case R.SCRIPT_DATA:{this._stateScriptData(t);break}case R.PLAINTEXT:{this._statePlaintext(t);break}case R.TAG_OPEN:{this._stateTagOpen(t);break}case R.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case R.TAG_NAME:{this._stateTagName(t);break}case R.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case R.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case R.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case R.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case R.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case R.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case R.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case R.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case R.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case R.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case R.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case R.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case R.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case R.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case R.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case R.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case R.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case R.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case R.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case R.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case R.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case R.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case R.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case R.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case R.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case R.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case R.BOGUS_COMMENT:{this._stateBogusComment(t);break}case R.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case R.COMMENT_START:{this._stateCommentStart(t);break}case R.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case R.COMMENT:{this._stateComment(t);break}case R.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case R.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case R.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case R.COMMENT_END:{this._stateCommentEnd(t);break}case R.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case R.DOCTYPE:{this._stateDoctype(t);break}case R.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case R.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case R.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case R.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case R.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case R.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case R.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case R.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case R.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case R.CDATA_SECTION:{this._stateCdataSection(t);break}case R.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case R.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case R.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case R.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.TAG_OPEN;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitCodePoint(t);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case C.AMPERSAND:{this._startCharacterReference();break}case C.LESS_THAN_SIGN:{this.state=R.RCDATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.RAWTEXT_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(Ds(t))this._createStartTagToken(),this.state=R.TAG_NAME,this._stateTagName(t);else switch(t){case C.EXCLAMATION_MARK:{this.state=R.MARKUP_DECLARATION_OPEN;break}case C.SOLIDUS:{this.state=R.END_TAG_OPEN;break}case C.QUESTION_MARK:{this._err(X.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t);break}case C.EOF:{this._err(X.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(X.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=R.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(Ds(t))this._createEndTagToken(),this.state=R.TAG_NAME,this._stateTagName(t);else switch(t){case C.GREATER_THAN_SIGN:{this._err(X.missingEndTagName),this.state=R.DATA;break}case C.EOF:{this._err(X.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(X.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this.state=R.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.tagName+=wt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(No(t)?Hc(t):t)}}_stateRcdataLessThanSign(t){t===C.SOLIDUS?this.state=R.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=R.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){Ds(t)?(this.state=R.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=R.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=R.BEFORE_ATTRIBUTE_NAME,!1;case C.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=R.SELF_CLOSING_START_TAG,!1;case C.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=R.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===C.SOLIDUS?this.state=R.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){Ds(t)?(this.state=R.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case C.SOLIDUS:{this.state=R.SCRIPT_DATA_END_TAG_OPEN;break}case C.EXCLAMATION_MARK:{this.state=R.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=R.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){Ds(t)?(this.state=R.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===C.HYPHEN_MINUS?(this.state=R.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===C.HYPHEN_MINUS?(this.state=R.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=R.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_ESCAPED,this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.GREATER_THAN_SIGN:{this.state=R.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_ESCAPED,this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===C.SOLIDUS?this.state=R.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Ds(t)?(this._emitChars("<"),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){Ds(t)?(this.state=R.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(Sr.SCRIPT,!1)&&N1(this.preprocessor.peek(Sr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Sr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=R.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.GREATER_THAN_SIGN:{this.state=R.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(wt);break}case C.EOF:{this._err(X.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===C.SOLIDUS?(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(Sr.SCRIPT,!1)&&N1(this.preprocessor.peek(Sr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Sr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=R.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=R.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this.state=R.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._err(X.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=R.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=R.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this._leaveAttrName(),this.state=R.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._leaveAttrName(),this.state=R.BEFORE_ATTRIBUTE_VALUE;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:{this._err(X.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.name+=wt;break}default:this.currentAttr.name+=String.fromCodePoint(No(t)?Hc(t):t)}}_stateAfterAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:{this.state=R.SELF_CLOSING_START_TAG;break}case C.EQUALS_SIGN:{this.state=R.BEFORE_ATTRIBUTE_VALUE;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=R.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{this.state=R.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this.state=R.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingAttributeValue),this.state=R.DATA,this.emitCurrentTagToken();break}default:this.state=R.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=wt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case C.APOSTROPHE:{this.state=R.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=wt;break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=R.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),this.currentAttr.value+=wt;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:case C.EQUALS_SIGN:case C.GRAVE_ACCENT:{this._err(X.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=R.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this._leaveAttrValue(),this.state=R.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._err(X.missingWhitespaceBetweenAttributes),this.state=R.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case C.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=R.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(X.eofInTag),this._emitEOFToken();break}default:this._err(X.unexpectedSolidusInTag),this.state=R.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.data+=wt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(Sr.DASH_DASH,!0)?(this._createCommentToken(Sr.DASH_DASH.length+1),this.state=R.COMMENT_START):this._consumeSequenceIfMatch(Sr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Sr.DOCTYPE.length+1),this.state=R.DOCTYPE):this._consumeSequenceIfMatch(Sr.CDATA_START,!0)?this.inForeignNode?this.state=R.CDATA_SECTION:(this._err(X.cdataInHtmlContent),this._createCommentToken(Sr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=R.BOGUS_COMMENT):this._ensureHibernation()||(this._err(X.incorrectlyOpenedComment),this._createCommentToken(2),this.state=R.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_START_DASH;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptClosingOfEmptyComment),this.state=R.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=R.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptClosingOfEmptyComment),this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=R.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END_DASH;break}case C.LESS_THAN_SIGN:{r.data+="<",this.state=R.COMMENT_LESS_THAN_SIGN;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.data+=wt;break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case C.EXCLAMATION_MARK:{r.data+="!",this.state=R.COMMENT_LESS_THAN_SIGN_BANG;break}case C.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=R.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===C.HYPHEN_MINUS?this.state=R.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=R.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===C.HYPHEN_MINUS?this.state=R.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=R.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==C.GREATER_THAN_SIGN&&t!==C.EOF&&this._err(X.nestedComment),this.state=R.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=R.COMMENT_END;break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=R.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentComment(r);break}case C.EXCLAMATION_MARK:{this.state=R.COMMENT_END_BANG;break}case C.HYPHEN_MINUS:{r.data+="-";break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=R.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{r.data+="--!",this.state=R.COMMENT_END_DASH;break}case C.GREATER_THAN_SIGN:{this._err(X.incorrectlyClosedComment),this.state=R.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(X.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=R.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=R.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case C.EOF:{this._err(X.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingWhitespaceBeforeDoctypeName),this.state=R.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(No(t))this._createDoctypeToken(String.fromCharCode(Hc(t))),this.state=R.DOCTYPE_NAME;else switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.NULL:{this._err(X.unexpectedNullCharacter),this._createDoctypeToken(wt),this.state=R.DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=R.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.AFTER_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.name+=wt;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(No(t)?Hc(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Sr.PUBLIC,!1)?this.state=R.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Sr.SYSTEM,!1)?this.state=R.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(X.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.publicId="",this.state=R.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.publicId+=wt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=R.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.publicId+=wt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case C.GREATER_THAN_SIGN:{this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.QUOTATION_MARK:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=R.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(X.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(X.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=R.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(X.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.systemId+=wt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=R.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(X.unexpectedNullCharacter),r.systemId+=wt;break}case C.GREATER_THAN_SIGN:{this._err(X.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.EOF:{this._err(X.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(X.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=R.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=R.DATA;break}case C.NULL:{this._err(X.unexpectedNullCharacter);break}case C.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case C.RIGHT_SQUARE_BRACKET:{this.state=R.CDATA_SECTION_BRACKET;break}case C.EOF:{this._err(X.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===C.RIGHT_SQUARE_BRACKET?this.state=R.CDATA_SECTION_END:(this._emitChars("]"),this.state=R.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case C.GREATER_THAN_SIGN:{this.state=R.DATA;break}case C.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=R.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(C.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&E1(this.preprocessor.peek(1))?R.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){E1(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===C.SEMICOLON&&this._err(X.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const Sk=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),k1=new Set([...Sk,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),Hd=new Set([m.APPLET,m.CAPTION,m.HTML,m.MARQUEE,m.OBJECT,m.TABLE,m.TD,m.TEMPLATE,m.TH]),W8=new Set([...Hd,m.OL,m.UL]),G8=new Set([...Hd,m.BUTTON]),_1=new Set([m.ANNOTATION_XML,m.MI,m.MN,m.MO,m.MS,m.MTEXT]),S1=new Set([m.DESC,m.FOREIGN_OBJECT,m.TITLE]),Y8=new Set([m.TR,m.TEMPLATE,m.HTML]),Q8=new Set([m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML]),K8=new Set([m.TABLE,m.TEMPLATE,m.HTML]),Z8=new Set([m.TD,m.TH]);class X8{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===ne.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const s=this._indexOf(t)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==ne.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(Wp,ne.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Z8,ne.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(K8,ne.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Q8,ne.HTML)}clearBackToTableRowContext(){this.clearBackTo(Y8,ne.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInDynamicScope(t,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case ne.HTML:{if(s===t)return!0;if(r.has(s))return!1;break}case ne.SVG:{if(S1.has(s))return!1;break}case ne.MATHML:{if(_1.has(s))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,Hd)}hasInListItemScope(t){return this.hasInDynamicScope(t,W8)}hasInButtonScope(t){return this.hasInDynamicScope(t,G8)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case ne.HTML:{if(Wp.has(r))return!0;if(Hd.has(r))return!1;break}case ne.SVG:{if(S1.has(r))return!1;break}case ne.MATHML:{if(_1.has(r))return!1;break}}}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ne.HTML)switch(this.tagIDs[r]){case t:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===ne.HTML)switch(this.tagIDs[t]){case m.TBODY:case m.THEAD:case m.TFOOT:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ne.HTML)switch(this.tagIDs[r]){case t:return!0;case m.OPTION:case m.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Sk.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;k1.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&k1.has(this.currentTagId);)this.pop()}}const am=3;var $n;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})($n||($n={}));const T1={type:$n.Marker};class J8{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const u=this.entries[o];if(u.type===$n.Marker)break;const{element:c}=u;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===l){const d=this.treeAdapter.getAttrList(c);d.length===s&&n.push({idx:o,attrs:d})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<am)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<am)return;const s=new Map(r.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<n.length;l++){const o=n[l];o.attrs.every(u=>s.get(u.name)===u.value)&&(i+=1,i>=am&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(T1)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:$n.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:$n.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(T1);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===$n.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===$n.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===$n.Element&&r.element===t)}}const Ms={createDocument(){return{nodeName:"#document",mode:ln.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const s=e.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=t,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Ms.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Ms.isTextNode(r)){r.value+=t;return}}Ms.appendChild(e,Ms.createTextNode(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Ms.isTextNode(n)?n.value+=t:Ms.insertBefore(e,Ms.createTextNode(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},Tk="html",e9="about:legacy-compat",t9="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Ck=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],r9=[...Ck,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],n9=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),jk=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],s9=[...jk,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function C1(e,t){return t.some(r=>e.startsWith(r))}function a9(e){return e.name===Tk&&e.publicId===null&&(e.systemId===null||e.systemId===e9)}function i9(e){if(e.name!==Tk)return ln.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===t9)return ln.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),n9.has(r))return ln.QUIRKS;let n=t===null?r9:Ck;if(C1(r,n))return ln.QUIRKS;if(n=t===null?jk:s9,C1(r,n))return ln.LIMITED_QUIRKS}return ln.NO_QUIRKS}const j1={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},l9="definitionurl",o9="definitionURL",u9=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),c9=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:ne.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:ne.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:ne.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:ne.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:ne.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:ne.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:ne.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:ne.XML}],["xml:space",{prefix:"xml",name:"space",namespace:ne.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:ne.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:ne.XMLNS}]]),d9=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),h9=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function f9(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===ei.COLOR||n===ei.SIZE||n===ei.FACE)||h9.has(t)}function Ak(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===l9){e.attrs[t].name=o9;break}}function Ik(e){for(let t=0;t<e.attrs.length;t++){const r=u9.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function Mg(e){for(let t=0;t<e.attrs.length;t++){const r=c9.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function m9(e){const t=d9.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=Kl(e.tagName))}function p9(e,t){return t===ne.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function g9(e,t,r){if(t===ne.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===ei.ENCODING){const s=r[n].value.toLowerCase();return s===j1.TEXT_HTML||s===j1.APPLICATION_XML}}return t===ne.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function x9(e,t,r,n){return(!n||n===ne.HTML)&&g9(e,t,r)||(!n||n===ne.MATHML)&&p9(e,t)}const y9="hidden",b9=8,v9=3;var D;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(D||(D={}));const w9={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Rk=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),A1={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Ms,onParseError:null};class I1{constructor(t,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=D.INITIAL,this.originalInsertionMode=D.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...A1,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new V8(this.options,this),this.activeFormattingElements=new J8(this.treeAdapter),this.fragmentContextID=n?Kl(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new X8(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...A1,...r};t??(t=n.treeAdapter.createElement(W.TEMPLATE,ne.HTML,[]));const s=n.treeAdapter.createElement("documentmock",ne.HTML,[]),i=new this(n,s,t);return i.fragmentContextID===m.TEMPLATE&&i.tmplInsertionModeStack.unshift(D.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var s;if(!this.onParseError)return;const i=(s=t.location)!==null&&s!==void 0?s:w9,l={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,t,this.openElements.current),r){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===ne.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,ne.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=D.TEXT}switchToPlaintextParsing(){this.insertionMode=D.TEXT,this.originalInsertionMode=D.IN_BODY,this.tokenizer.state=Ot.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===W.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==ne.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=Ot.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=Ot.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=Ot.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=Ot.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",s=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,ne.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,ne.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(W.HTML,ne.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,l=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:u,endCol:c,endOffset:d}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(t),i=r.type===We.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===W.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===ne.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,ne.HTML)}_processToken(t){switch(t.type){case We.CHARACTER:{this.onCharacter(t);break}case We.NULL_CHARACTER:{this.onNullCharacter(t);break}case We.COMMENT:{this.onComment(t);break}case We.DOCTYPE:{this.onDoctype(t);break}case We.START_TAG:{this._processStartTag(t);break}case We.END_TAG:{this.onEndTag(t);break}case We.EOF:{this.onEof(t);break}case We.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return x9(t,s,i,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===$n.Marker||this.openElements.contains(s.element)),n=r<0?t-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=D.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=D.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=D.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=D.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=D.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=D.IN_TABLE;return}case m.BODY:{this.insertionMode=D.IN_BODY;return}case m.FRAMESET:{this.insertionMode=D.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?D.AFTER_HEAD:D.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=D.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=D.IN_HEAD;return}break}}this.insertionMode=D.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=D.IN_SELECT_IN_TABLE;return}}this.insertionMode=D.IN_SELECT}_isElementCausesFosterParenting(t){return Rk.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===ne.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return H8[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Z7(this,t);return}switch(this.insertionMode){case D.INITIAL:{mo(this,t);break}case D.BEFORE_HTML:{qo(this,t);break}case D.BEFORE_HEAD:{Vo(this,t);break}case D.IN_HEAD:{Wo(this,t);break}case D.IN_HEAD_NO_SCRIPT:{Go(this,t);break}case D.AFTER_HEAD:{Yo(this,t);break}case D.IN_BODY:case D.IN_CAPTION:case D.IN_CELL:case D.IN_TEMPLATE:{Ok(this,t);break}case D.TEXT:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{im(this,t);break}case D.IN_TABLE_TEXT:{Bk(this,t);break}case D.IN_COLUMN_GROUP:{$d(this,t);break}case D.AFTER_BODY:{zd(this,t);break}case D.AFTER_AFTER_BODY:{ad(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){K7(this,t);return}switch(this.insertionMode){case D.INITIAL:{mo(this,t);break}case D.BEFORE_HTML:{qo(this,t);break}case D.BEFORE_HEAD:{Vo(this,t);break}case D.IN_HEAD:{Wo(this,t);break}case D.IN_HEAD_NO_SCRIPT:{Go(this,t);break}case D.AFTER_HEAD:{Yo(this,t);break}case D.TEXT:{this._insertCharacters(t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{im(this,t);break}case D.IN_COLUMN_GROUP:{$d(this,t);break}case D.AFTER_BODY:{zd(this,t);break}case D.AFTER_AFTER_BODY:{ad(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){Gp(this,t);return}switch(this.insertionMode){case D.INITIAL:case D.BEFORE_HTML:case D.BEFORE_HEAD:case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:case D.IN_BODY:case D.IN_TABLE:case D.IN_CAPTION:case D.IN_COLUMN_GROUP:case D.IN_TABLE_BODY:case D.IN_ROW:case D.IN_CELL:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:case D.IN_TEMPLATE:case D.IN_FRAMESET:case D.AFTER_FRAMESET:{Gp(this,t);break}case D.IN_TABLE_TEXT:{po(this,t);break}case D.AFTER_BODY:{C9(this,t);break}case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{j9(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case D.INITIAL:{A9(this,t);break}case D.BEFORE_HEAD:case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:{this._err(t,X.misplacedDoctype);break}case D.IN_TABLE_TEXT:{po(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,X.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?X7(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case D.INITIAL:{mo(this,t);break}case D.BEFORE_HTML:{I9(this,t);break}case D.BEFORE_HEAD:{L9(this,t);break}case D.IN_HEAD:{Ln(this,t);break}case D.IN_HEAD_NO_SCRIPT:{D9(this,t);break}case D.AFTER_HEAD:{F9(this,t);break}case D.IN_BODY:{pr(this,t);break}case D.IN_TABLE:{Ll(this,t);break}case D.IN_TABLE_TEXT:{po(this,t);break}case D.IN_CAPTION:{O7(this,t);break}case D.IN_COLUMN_GROUP:{Bg(this,t);break}case D.IN_TABLE_BODY:{$h(this,t);break}case D.IN_ROW:{zh(this,t);break}case D.IN_CELL:{M7(this,t);break}case D.IN_SELECT:{zk(this,t);break}case D.IN_SELECT_IN_TABLE:{U7(this,t);break}case D.IN_TEMPLATE:{H7(this,t);break}case D.AFTER_BODY:{z7(this,t);break}case D.IN_FRAMESET:{q7(this,t);break}case D.AFTER_FRAMESET:{W7(this,t);break}case D.AFTER_AFTER_BODY:{Y7(this,t);break}case D.AFTER_AFTER_FRAMESET:{Q7(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?J7(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case D.INITIAL:{mo(this,t);break}case D.BEFORE_HTML:{R9(this,t);break}case D.BEFORE_HEAD:{O9(this,t);break}case D.IN_HEAD:{P9(this,t);break}case D.IN_HEAD_NO_SCRIPT:{M9(this,t);break}case D.AFTER_HEAD:{U9(this,t);break}case D.IN_BODY:{Hh(this,t);break}case D.TEXT:{k7(this,t);break}case D.IN_TABLE:{Nu(this,t);break}case D.IN_TABLE_TEXT:{po(this,t);break}case D.IN_CAPTION:{P7(this,t);break}case D.IN_COLUMN_GROUP:{D7(this,t);break}case D.IN_TABLE_BODY:{Yp(this,t);break}case D.IN_ROW:{$k(this,t);break}case D.IN_CELL:{F7(this,t);break}case D.IN_SELECT:{qk(this,t);break}case D.IN_SELECT_IN_TABLE:{B7(this,t);break}case D.IN_TEMPLATE:{$7(this,t);break}case D.AFTER_BODY:{Wk(this,t);break}case D.IN_FRAMESET:{V7(this,t);break}case D.AFTER_FRAMESET:{G7(this,t);break}case D.AFTER_AFTER_BODY:{ad(this,t);break}}}onEof(t){switch(this.insertionMode){case D.INITIAL:{mo(this,t);break}case D.BEFORE_HTML:{qo(this,t);break}case D.BEFORE_HEAD:{Vo(this,t);break}case D.IN_HEAD:{Wo(this,t);break}case D.IN_HEAD_NO_SCRIPT:{Go(this,t);break}case D.AFTER_HEAD:{Yo(this,t);break}case D.IN_BODY:case D.IN_TABLE:case D.IN_CAPTION:case D.IN_COLUMN_GROUP:case D.IN_TABLE_BODY:case D.IN_ROW:case D.IN_CELL:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:{Fk(this,t);break}case D.TEXT:{_7(this,t);break}case D.IN_TABLE_TEXT:{po(this,t);break}case D.IN_TEMPLATE:{Vk(this,t);break}case D.AFTER_BODY:case D.IN_FRAMESET:case D.AFTER_FRAMESET:case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{Ug(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===C.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:case D.TEXT:case D.IN_COLUMN_GROUP:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:case D.IN_FRAMESET:case D.AFTER_FRAMESET:{this._insertCharacters(t);break}case D.IN_BODY:case D.IN_CAPTION:case D.IN_CELL:case D.IN_TEMPLATE:case D.AFTER_BODY:case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{Lk(this,t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{im(this,t);break}case D.IN_TABLE_TEXT:{Uk(this,t);break}}}}function E9(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):Mk(e,t),r}function N9(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const s=e.openElements.items[n];if(s===t.element)break;e._isSpecialElement(s,e.openElements.tagIDs[n])&&(r=s)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function k9(e,t,r){let n=t,s=e.openElements.getCommonAncestor(t);for(let i=0,l=s;l!==r;i++,l=s){s=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),u=o&&i>=v9;!o||u?(u&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=_9(e,o),n===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function _9(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function S9(e,t,r){const n=e.treeAdapter.getTagName(t),s=Kl(n);if(e._isElementCausesFosterParenting(s))e._fosterParentElement(r);else{const i=e.treeAdapter.getNamespaceURI(t);s===m.TEMPLATE&&i===ne.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function T9(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=e.treeAdapter.createElement(s.tagName,n,s.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,s),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,i,s.tagID)}function Fg(e,t){for(let r=0;r<b9;r++){const n=E9(e,t);if(!n)break;const s=N9(e,n);if(!s)break;e.activeFormattingElements.bookmark=n;const i=k9(e,s,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),l&&S9(e,l,i),T9(e,s,n)}}function Gp(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function C9(e,t){e._appendCommentNode(t,e.openElements.items[0])}function j9(e,t){e._appendCommentNode(t,e.document)}function Ug(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],s=e.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function A9(e,t){e._setDocumentType(t);const r=t.forceQuirks?ln.QUIRKS:i9(t);a9(t)||e._err(t,X.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=D.BEFORE_HTML}function mo(e,t){e._err(t,X.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,ln.QUIRKS),e.insertionMode=D.BEFORE_HTML,e._processToken(t)}function I9(e,t){t.tagID===m.HTML?(e._insertElement(t,ne.HTML),e.insertionMode=D.BEFORE_HEAD):qo(e,t)}function R9(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&qo(e,t)}function qo(e,t){e._insertFakeRootElement(),e.insertionMode=D.BEFORE_HEAD,e._processToken(t)}function L9(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.HEAD:{e._insertElement(t,ne.HTML),e.headElement=e.openElements.current,e.insertionMode=D.IN_HEAD;break}default:Vo(e,t)}}function O9(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?Vo(e,t):e._err(t,X.endTagWithoutMatchingOpenElement)}function Vo(e,t){e._insertFakeElement(W.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=D.IN_HEAD,e._processToken(t)}function Ln(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,Ot.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Ot.RAWTEXT):(e._insertElement(t,ne.HTML),e.insertionMode=D.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,Ot.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,Ot.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=D.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(D.IN_TEMPLATE);break}case m.HEAD:{e._err(t,X.misplacedStartTagForHeadElement);break}default:Wo(e,t)}}function P9(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=D.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{Wo(e,t);break}case m.TEMPLATE:{vi(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function vi(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,X.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,X.endTagWithoutMatchingOpenElement)}function Wo(e,t){e.openElements.pop(),e.insertionMode=D.AFTER_HEAD,e._processToken(t)}function D9(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{Ln(e,t);break}case m.NOSCRIPT:{e._err(t,X.nestedNoscriptInHead);break}default:Go(e,t)}}function M9(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=D.IN_HEAD;break}case m.BR:{Go(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function Go(e,t){const r=t.type===We.EOF?X.openElementsLeftAfterEof:X.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=D.IN_HEAD,e._processToken(t)}function F9(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.BODY:{e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=D.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,ne.HTML),e.insertionMode=D.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,X.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),Ln(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,X.misplacedStartTagForHeadElement);break}default:Yo(e,t)}}function U9(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{Yo(e,t);break}case m.TEMPLATE:{vi(e,t);break}default:e._err(t,X.endTagWithoutMatchingOpenElement)}}function Yo(e,t){e._insertFakeElement(W.BODY,m.BODY),e.insertionMode=D.IN_BODY,Bh(e,t)}function Bh(e,t){switch(t.type){case We.CHARACTER:{Ok(e,t);break}case We.WHITESPACE_CHARACTER:{Lk(e,t);break}case We.COMMENT:{Gp(e,t);break}case We.START_TAG:{pr(e,t);break}case We.END_TAG:{Hh(e,t);break}case We.EOF:{Fk(e,t);break}}}function Lk(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Ok(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function B9(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function H9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function $9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_FRAMESET)}function z9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML)}function q9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),Wp.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,ne.HTML)}function V9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function W9(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),r||(e.formElement=e.openElements.current))}function G9(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const s=e.openElements.tagIDs[n];if(r===m.LI&&s===m.LI||(r===m.DD||r===m.DT)&&(s===m.DD||s===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s);break}if(s!==m.ADDRESS&&s!==m.DIV&&s!==m.P&&e._isSpecialElement(e.openElements.items[n],s))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML)}function Y9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.tokenizer.state=Ot.PLAINTEXT}function Q9(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.framesetOk=!1}function K9(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(W.A);r&&(Fg(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Z9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function X9(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(Fg(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,ne.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function J9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function e7(e,t){e.treeAdapter.getDocumentMode(e.document)!==ln.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=D.IN_TABLE}function Pk(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ne.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Dk(e){const t=wk(e,ei.TYPE);return t!=null&&t.toLowerCase()===y9}function t7(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ne.HTML),Dk(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function r7(e,t){e._appendElement(t,ne.HTML),t.ackSelfClosing=!0}function n7(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,ne.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function s7(e,t){t.tagName=W.IMG,t.tagID=m.IMG,Pk(e,t)}function a7(e,t){e._insertElement(t,ne.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Ot.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=D.TEXT}function i7(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Ot.RAWTEXT)}function l7(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Ot.RAWTEXT)}function R1(e,t){e._switchToTextParsing(t,Ot.RAWTEXT)}function o7(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===D.IN_TABLE||e.insertionMode===D.IN_CAPTION||e.insertionMode===D.IN_TABLE_BODY||e.insertionMode===D.IN_ROW||e.insertionMode===D.IN_CELL?D.IN_SELECT_IN_TABLE:D.IN_SELECT}function u7(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML)}function c7(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,ne.HTML)}function d7(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,ne.HTML)}function h7(e,t){e._reconstructActiveFormattingElements(),Ak(t),Mg(t),t.selfClosing?e._appendElement(t,ne.MATHML):e._insertElement(t,ne.MATHML),t.ackSelfClosing=!0}function f7(e,t){e._reconstructActiveFormattingElements(),Ik(t),Mg(t),t.selfClosing?e._appendElement(t,ne.SVG):e._insertElement(t,ne.SVG),t.ackSelfClosing=!0}function L1(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ne.HTML)}function pr(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{Z9(e,t);break}case m.A:{K9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{q9(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{z9(e,t);break}case m.LI:case m.DD:case m.DT:{G9(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{Pk(e,t);break}case m.HR:{n7(e,t);break}case m.RB:case m.RTC:{c7(e,t);break}case m.RT:case m.RP:{d7(e,t);break}case m.PRE:case m.LISTING:{V9(e,t);break}case m.XMP:{i7(e,t);break}case m.SVG:{f7(e,t);break}case m.HTML:{B9(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{Ln(e,t);break}case m.BODY:{H9(e,t);break}case m.FORM:{W9(e,t);break}case m.NOBR:{X9(e,t);break}case m.MATH:{h7(e,t);break}case m.TABLE:{e7(e,t);break}case m.INPUT:{t7(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{r7(e,t);break}case m.IMAGE:{s7(e,t);break}case m.BUTTON:{Q9(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{J9(e,t);break}case m.IFRAME:{l7(e,t);break}case m.SELECT:{o7(e,t);break}case m.OPTION:case m.OPTGROUP:{u7(e,t);break}case m.NOEMBED:case m.NOFRAMES:{R1(e,t);break}case m.FRAMESET:{$9(e,t);break}case m.TEXTAREA:{a7(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?R1(e,t):L1(e,t);break}case m.PLAINTEXT:{Y9(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:L1(e,t)}}function m7(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=D.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function p7(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=D.AFTER_BODY,Wk(e,t))}function g7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function x7(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function y7(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(W.P,m.P),e._closePElement()}function b7(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function v7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function w7(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function E7(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function N7(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(W.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function Mk(e,t){const r=t.tagName,n=t.tagID;for(let s=e.openElements.stackTop;s>0;s--){const i=e.openElements.items[s],l=e.openElements.tagIDs[s];if(n===l&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(i)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=s&&e.openElements.shortenToLength(s);break}if(e._isSpecialElement(i,l))break}}function Hh(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{Fg(e,t);break}case m.P:{y7(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{g7(e,t);break}case m.LI:{b7(e);break}case m.DD:case m.DT:{v7(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{w7(e);break}case m.BR:{N7(e);break}case m.BODY:{m7(e,t);break}case m.HTML:{p7(e,t);break}case m.FORM:{x7(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{E7(e,t);break}case m.TEMPLATE:{vi(e,t);break}default:Mk(e,t)}}function Fk(e,t){e.tmplInsertionModeStack.length>0?Vk(e,t):Ug(e,t)}function k7(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function _7(e,t){e._err(t,X.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function im(e,t){if(Rk.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=D.IN_TABLE_TEXT,t.type){case We.CHARACTER:{Bk(e,t);break}case We.WHITESPACE_CHARACTER:{Uk(e,t);break}}else tc(e,t)}function S7(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_CAPTION}function T7(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_COLUMN_GROUP}function C7(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(W.COLGROUP,m.COLGROUP),e.insertionMode=D.IN_COLUMN_GROUP,Bg(e,t)}function j7(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_TABLE_BODY}function A7(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(W.TBODY,m.TBODY),e.insertionMode=D.IN_TABLE_BODY,$h(e,t)}function I7(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function R7(e,t){Dk(t)?e._appendElement(t,ne.HTML):tc(e,t),t.ackSelfClosing=!0}function L7(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,ne.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function Ll(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{A7(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{Ln(e,t);break}case m.COL:{C7(e,t);break}case m.FORM:{L7(e,t);break}case m.TABLE:{I7(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{j7(e,t);break}case m.INPUT:{R7(e,t);break}case m.CAPTION:{S7(e,t);break}case m.COLGROUP:{T7(e,t);break}default:tc(e,t)}}function Nu(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{vi(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:tc(e,t)}}function tc(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Bh(e,t),e.fosterParentingEnabled=r}function Uk(e,t){e.pendingCharacterTokens.push(t)}function Bk(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function po(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)tc(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Hk=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function O7(e,t){const r=t.tagID;Hk.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_TABLE,Ll(e,t)):pr(e,t)}function P7(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_TABLE,r===m.TABLE&&Nu(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Hh(e,t)}}function Bg(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.COL:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{Ln(e,t);break}default:$d(e,t)}}function D7(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=D.IN_TABLE);break}case m.TEMPLATE:{vi(e,t);break}case m.COL:break;default:$d(e,t)}}function $d(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=D.IN_TABLE,e._processToken(t))}function $h(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(W.TR,m.TR),e.insertionMode=D.IN_ROW,zh(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE,Ll(e,t));break}default:Ll(e,t)}}function Yp(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE,Nu(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:Nu(e,t)}}function zh(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,ne.HTML),e.insertionMode=D.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,$h(e,t));break}default:Ll(e,t)}}function $k(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,Yp(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,Yp(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:Nu(e,t)}}function M7(e,t){const r=t.tagID;Hk.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),zh(e,t)):pr(e,t)}function F7(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),$k(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:Hh(e,t)}}function zk(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,ne.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,ne.HTML);break}case m.HR:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{Ln(e,t);break}}}function qk(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{vi(e,t);break}}}function U7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):zk(e,t)}function B7(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):qk(e,t)}function H7(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{Ln(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=D.IN_TABLE,e.insertionMode=D.IN_TABLE,Ll(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=D.IN_COLUMN_GROUP,e.insertionMode=D.IN_COLUMN_GROUP,Bg(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=D.IN_TABLE_BODY,e.insertionMode=D.IN_TABLE_BODY,$h(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=D.IN_ROW,e.insertionMode=D.IN_ROW,zh(e,t);break}default:e.tmplInsertionModeStack[0]=D.IN_BODY,e.insertionMode=D.IN_BODY,pr(e,t)}}function $7(e,t){t.tagID===m.TEMPLATE&&vi(e,t)}function Vk(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):Ug(e,t)}function z7(e,t){t.tagID===m.HTML?pr(e,t):zd(e,t)}function Wk(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=D.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else zd(e,t)}function zd(e,t){e.insertionMode=D.IN_BODY,Bh(e,t)}function q7(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.FRAMESET:{e._insertElement(t,ne.HTML);break}case m.FRAME:{e._appendElement(t,ne.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{Ln(e,t);break}}}function V7(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=D.AFTER_FRAMESET))}function W7(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.NOFRAMES:{Ln(e,t);break}}}function G7(e,t){t.tagID===m.HTML&&(e.insertionMode=D.AFTER_AFTER_FRAMESET)}function Y7(e,t){t.tagID===m.HTML?pr(e,t):ad(e,t)}function ad(e,t){e.insertionMode=D.IN_BODY,Bh(e,t)}function Q7(e,t){switch(t.tagID){case m.HTML:{pr(e,t);break}case m.NOFRAMES:{Ln(e,t);break}}}function K7(e,t){t.chars=wt,e._insertCharacters(t)}function Z7(e,t){e._insertCharacters(t),e.framesetOk=!1}function Gk(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==ne.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function X7(e,t){if(f9(t))Gk(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===ne.MATHML?Ak(t):n===ne.SVG&&(m9(t),Ik(t)),Mg(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function J7(e,t){if(t.tagID===m.P||t.tagID===m.BR){Gk(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===ne.HTML){e._endTagOutsideForeignContent(t);break}const s=e.treeAdapter.getTagName(n);if(s.toLowerCase()===t.tagName){t.tagName=s,e.openElements.shortenToLength(r);break}}}W.AREA,W.BASE,W.BASEFONT,W.BGSOUND,W.BR,W.COL,W.EMBED,W.FRAME,W.HR,W.IMG,W.INPUT,W.KEYGEN,W.LINK,W.META,W.PARAM,W.SOURCE,W.TRACK,W.WBR;const eF=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,tF=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),O1={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function Yk(e,t){const r=dF(e),n=GN("type",{handlers:{root:rF,element:nF,text:sF,comment:Kk,doctype:aF,raw:lF},unknown:oF}),s={parser:r?new I1(O1):I1.getFragmentParser(void 0,O1),handle(o){n(o,s)},stitches:!1,options:t||{}};n(e,s),Zl(s,Xn());const i=r?s.parser.document:s.parser.getFragment(),l=h8(i,{file:s.options.file});return s.stitches&&Uh(l,"comment",function(o,u,c){const d=o;if(d.value.stitch&&c&&u!==void 0){const h=c.children;return h[u]=d.value.stitch,u}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function Qk(e,t){let r=-1;if(e)for(;++r<e.length;)t.handle(e[r])}function rF(e,t){Qk(e.children,t)}function nF(e,t){uF(e,t),Qk(e.children,t),cF(e,t)}function sF(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const r={type:We.CHARACTER,chars:e.value,location:rc(e)};Zl(t,Xn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function aF(e,t){const r={type:We.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:rc(e)};Zl(t,Xn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function iF(e,t){t.stitches=!0;const r=hF(e);if("children"in e&&"children"in r){const n=Yk({type:"root",children:e.children},t.options);r.children=n.children}Kk({type:"comment",value:{stitch:r}},t)}function Kk(e,t){const r=e.value,n={type:We.COMMENT,data:r,location:rc(e)};Zl(t,Xn(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function lF(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,Zk(t,Xn(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(eF,"&lt;$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=t.parser.tokenizer._consume();t.parser.tokenizer._callState(r)}}function oF(e,t){const r=e;if(t.options.passThrough&&t.options.passThrough.includes(r.type))iF(r,t);else{let n="";throw tF.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function Zl(e,t){Zk(e,t);const r=e.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=e.parser.tokenizer.preprocessor.line,r.location.endCol=e.parser.tokenizer.preprocessor.col+1,r.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Ot.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function Zk(e,t){if(t&&t.offset!==void 0){const r={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=r}}function uF(e,t){const r=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Ot.PLAINTEXT)return;Zl(t,Xn(e));const n=t.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:za.html;s===za.html&&r==="svg"&&(s=za.svg);const i=x8({...e,children:[]},{space:s===za.svg?"svg":"html"}),l={type:We.START_TAG,tagName:r,tagID:Kl(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:rc(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=r}function cF(e,t){const r=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&_8.includes(r)||t.parser.tokenizer.state===Ot.PLAINTEXT)return;Zl(t,Lh(e));const n={type:We.END_TAG,tagName:r,tagID:Kl(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:rc(e)};t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken),r===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Ot.RCDATA||t.parser.tokenizer.state===Ot.RAWTEXT||t.parser.tokenizer.state===Ot.SCRIPT_DATA)&&(t.parser.tokenizer.state=Ot.DATA)}function dF(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function rc(e){const t=Xn(e)||{line:void 0,column:void 0,offset:void 0},r=Lh(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function hF(e){return"children"in e?di({...e,children:[]}):di(e)}function Xk(e){return function(t,r){return Yk(t,{...e,file:r})}}const La=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],P1={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...La,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...La],h2:[["className","sr-only"]],img:[...La,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...La,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...La],table:[...La],ul:[...La,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Hs={}.hasOwnProperty;function fF(e,t){let r={type:"root",children:[]};const n={schema:t?{...P1,...t}:P1,stack:[]},s=Jk(n,e);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function Jk(e,t){if(t&&typeof t=="object"){const r=t;switch(typeof r.type=="string"?r.type:""){case"comment":return mF(e,r);case"doctype":return pF(e,r);case"element":return gF(e,r);case"root":return xF(e,r);case"text":return yF(e,r)}}}function mF(e,t){if(e.schema.allowComments){const r=typeof t.value=="string"?t.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return nc(i,t),i}}function pF(e,t){if(e.schema.allowDoctypes){const r={type:"doctype"};return nc(r,t),r}}function gF(e,t){const r=typeof t.tagName=="string"?t.tagName:"";e.stack.push(r);const n=e_(e,t.children),s=bF(e,t.properties);e.stack.pop();let i=!1;if(r&&r!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(r))&&(i=!0,e.schema.ancestors&&Hs.call(e.schema.ancestors,r))){const o=e.schema.ancestors[r];let u=-1;for(i=!1;++u<o.length;)e.stack.includes(o[u])&&(i=!0)}if(!i)return e.schema.strip&&!e.schema.strip.includes(r)?n:void 0;const l={type:"element",tagName:r,properties:s,children:n};return nc(l,t),l}function xF(e,t){const n={type:"root",children:e_(e,t.children)};return nc(n,t),n}function yF(e,t){const n={type:"text",value:typeof t.value=="string"?t.value:""};return nc(n,t),n}function e_(e,t){const r=[];if(Array.isArray(t)){const n=t;let s=-1;for(;++s<n.length;){const i=Jk(e,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function bF(e,t){const r=e.stack[e.stack.length-1],n=e.schema.attributes,s=e.schema.required,i=n&&Hs.call(n,r)?n[r]:void 0,l=n&&Hs.call(n,"*")?n["*"]:void 0,o=t&&typeof t=="object"?t:{},u={};let c;for(c in o)if(Hs.call(o,c)){const d=o[c];let h=D1(e,M1(i,c),c,d);h==null&&(h=D1(e,M1(l,c),c,d)),h!=null&&(u[c]=h)}if(s&&Hs.call(s,r)){const d=s[r];for(c in d)Hs.call(d,c)&&!Hs.call(u,c)&&(u[c]=d[c])}return u}function D1(e,t,r,n){return t?Array.isArray(n)?vF(e,t,r,n):t_(e,t,r,n):void 0}function vF(e,t,r,n){let s=-1;const i=[];for(;++s<n.length;){const l=t_(e,t,r,n[s]);(typeof l=="number"||typeof l=="string")&&i.push(l)}return i}function t_(e,t,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&wF(e,r,n)){if(typeof t=="object"&&t.length>1){let s=!1,i=0;for(;++i<t.length;){const l=t[i];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(n))){s=!0;break}}else if(l===n){s=!0;break}}if(!s)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(r)?e.schema.clobberPrefix+n:n}}function wF(e,t,r){const n=e.schema.protocols&&Hs.call(e.schema.protocols,t)?e.schema.protocols[t]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),l=s.indexOf("?"),o=s.indexOf("#"),u=s.indexOf("/");if(i<0||u>-1&&i>u||l>-1&&i>l||o>-1&&i>o)return!0;let c=-1;for(;++c<n.length;){const d=n[c];if(i===d.length&&s.slice(0,d.length)===d)return!0}return!1}function nc(e,t){const r=pN(t);t.data&&(e.data=di(t.data)),r&&(e.position=r)}function M1(e,t){let r,n=-1;if(e)for(;++n<e.length;){const s=e[n],i=typeof s=="string"?s:s[0];if(i===t)return s;i==="data*"&&(r=s)}if(t.length>4&&t.slice(0,4).toLowerCase()==="data")return r}function r_(e){return function(t){return fF(t,e)}}function id({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(zN,{remarkPlugins:[fk],rehypePlugins:[Xk,r_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function EF({onClose:e,onSelectImage:t}){const[r,n]=w.useState("upload"),[s,i]=w.useState(null),[l,o]=w.useState([]),[u,c]=w.useState(!1),[d,h]=w.useState(null),[f,p]=w.useState(""),[g,y]=w.useState(""),E=async()=>{if(!s)return;c(!0);const b=`${Date.now()}-${s.name}`,{error:v}=await te.storage.from("images").upload(b,s);if(v){alert("Upload error: "+v.message),c(!1);return}const{publicURL:_,error:k}=te.storage.from("images").getPublicUrl(b);if(k){alert("Error getting public URL: "+k.message),c(!1);return}t(_,f,g),c(!1),e()},x=async()=>{c(!0);const{data:b,error:v}=await te.storage.from("images").list("",{limit:100});if(v){alert("Error listing images: "+v.message),c(!1);return}const _=b.map(k=>{const{publicURL:S}=te.storage.from("images").getPublicUrl(k.name);return S});o(_),c(!1)};return _n.useEffect(()=>{r==="select"&&x()},[r]),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Select an Image"}),a.jsx("button",{onClick:e,children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex gap-4 mb-4",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>n("upload"),children:"Upload"}),a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>n("select"),children:"Select"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Width (e.g., 300px or 100%)"}),a.jsx("input",{type:"text",value:f,onChange:b=>p(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Height (e.g., 200px)"}),a.jsx("input",{type:"text",value:g,onChange:b=>y(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),r==="upload"?a.jsxs("div",{children:[a.jsx("input",{type:"file",accept:"image/*",onChange:b=>{b.target.files&&b.target.files[0]&&i(b.target.files[0])}}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(U,{variant:"primary",onClick:E,loading:u,children:"Upload Image"})})]}):a.jsxs("div",{children:[u?a.jsx("p",{children:"Loading images..."}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((b,v)=>a.jsx("img",{src:b,alt:"Stored",className:`cursor-pointer border ${d===b?"border-blue-500":"border-gray-200"}`,onClick:()=>h(b)},v))}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx(U,{variant:"secondary",onClick:()=>n("upload"),children:"Back to Upload"}),a.jsx(U,{variant:"primary",onClick:()=>{d&&(t(d,f,g),e())},disabled:!d,children:"Select Image"})]})]})]})})}function NF({entry:e,onClose:t,onSave:r,onSaveAsTemplate:n}){const[s,i]=w.useState(e),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState(!1),f=async()=>{c(!0);try{await r(s)}finally{c(!1)}},p=async()=>{if(n){c(!0);try{await n(s)}finally{c(!1)}}},g=(y,E,x)=>{let b=`![Image description](${y})`;if(E||x){const v=[];E&&v.push(`width="${E}"`),x&&v.push(`height="${x}"`),b+=`{${v.join(" ")}}`}i({...s,content:s.content+`
`+b+`
`})};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"border-b p-4 flex items-center justify-between bg-white",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(U,{variant:"secondary",icon:Eh,onClick:t,children:"Back"}),a.jsx("h2",{className:"text-xl font-bold",children:s.title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"secondary",icon:l?xE:yE,onClick:()=>o(!l),children:l?"Edit":"Preview"}),n&&a.jsx(U,{variant:"secondary",onClick:p,loading:u,children:"Save as Template"}),a.jsx(U,{variant:"primary",icon:tr,onClick:f,loading:u,children:"Save"})]})]}),!l&&a.jsxs("div",{className:"border-b p-2 flex items-center gap-2 bg-white",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:e4,onClick:()=>{const y=document.querySelector("textarea");if(y){const E=y.selectionStart,x=y.selectionEnd,b=y.value,v=b.substring(0,E),_=b.substring(E,x),k=b.substring(x);i({...s,content:`${v}**${_}**${k}`})}},children:"Bold"}),a.jsx(U,{variant:"secondary",size:"sm",icon:p4,onClick:()=>{const y=document.querySelector("textarea");if(y){const E=y.selectionStart,x=y.selectionEnd,b=y.value,v=b.substring(0,E),_=b.substring(E,x),k=b.substring(x);i({...s,content:`${v}_${_}_${k}`})}},children:"Italic"}),a.jsx("div",{className:"w-px h-6 bg-gray-300"}),a.jsx(U,{variant:"secondary",size:"sm",icon:O4,onClick:()=>{i({...s,content:s.content+`
| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
`})},children:"Table"}),a.jsx(U,{variant:"secondary",size:"sm",icon:Cp,onClick:()=>h(!0),children:"Image"}),a.jsx(U,{variant:"secondary",size:"sm",icon:x4,onClick:()=>{i({...s,content:s.content+"[Link text](https://example.com)"})},children:"Link"}),a.jsx(U,{variant:"secondary",size:"sm",icon:Al,onClick:()=>{i({...s,content:s.content+`
> ### Note
> This is a note block for important information.
`})},children:"Note"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs("div",{className:"h-full flex",children:[!l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:s.title,onChange:y=>i({...s,title:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:s.category,onChange:y=>i({...s,category:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx("textarea",{value:s.content,onChange:y=>i({...s,content:y.target.value}),rows:20,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono bg-white"})]})]})}),l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50 homebrew",children:a.jsxs("div",{className:"max-w-4xl mx-auto prose",children:[a.jsx("h1",{children:s.title}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.category})}),a.jsx(id,{content:s.content})]})})]})}),d&&a.jsx(EF,{onClose:()=>h(!1),onSelectImage:(y,E,x)=>{g(y,E,x)}})]})}function kF(){const{user:e,isAdmin:t}=Vt(),r=hn(),[n,s]=w.useState(""),[i,l]=w.useState(null),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState([]),[p,g]=w.useState(new Set),{data:y=[],isLoading:E,error:x}=Ut({queryKey:["compendiumEntries"],queryFn:_5}),{data:b=[],isLoading:v,error:_}=Ut({queryKey:["compendiumTemplates"],queryFn:S5}),k=E||v,S=(x==null?void 0:x.message)||(_==null?void 0:_.message)||null;w.useEffect(()=>{I()},[]);const I=()=>{const z=localStorage.getItem("compendium_bookmarks");z&&f(JSON.parse(z))},j=z=>{const B=z.content.slice(0,100)+"...";f(L=>{const N=L.some(K=>K.id===z.id)?L.filter(K=>K.id!==z.id):[...L,{...z,preview:B}];return localStorage.setItem("compendium_bookmarks",JSON.stringify(N)),N})},P=z=>{g(B=>{const L=new Set(B);return L.has(z)?L.delete(z):L.add(z),L})},T=w.useMemo(()=>{if(n)return[];const z=y.reduce((B,L)=>{const Q=L.category??"Uncategorized";return B[Q]||(B[Q]=[]),B[Q].push(L),B},{});return Object.entries(z).sort(([B],[L])=>B.localeCompare(L))},[y,n]),H=w.useMemo(()=>n?y.filter(z=>z.title.toLowerCase().includes(n.toLowerCase())||z.content.toLowerCase().includes(n.toLowerCase())):[],[y,n]),O=At({mutationFn:async z=>{if(z.id){const{error:B}=await te.from("compendium").update({title:z.title,content:z.content,category:z.category,updated_at:new Date().toISOString()}).eq("id",z.id);if(B)throw B}else{const{error:B}=await te.from("compendium").insert([{title:z.title,content:z.content,category:z.category,created_by:e==null?void 0:e.id}]);if(B)throw B}},onSuccess:()=>{r.invalidateQueries({queryKey:["compendiumEntries"]}),d(null)},onError:z=>{console.error("Save error:",z)}}),q=z=>{O.mutate(z)},G=()=>{d({title:"",content:"",category:i||"",created_by:e==null?void 0:e.id})},$=()=>{u(null),s("")};return k?a.jsx($e,{size:"lg",className:"mx-auto mt-12"}):S?a.jsx(Ie,{message:S,className:"m-8"}):a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsx("div",{className:"w-80 bg-white border-r flex flex-col",children:a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Compendium"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:$,children:"Home"}),t()&&a.jsx(U,{variant:"primary",size:"sm",icon:Jt,onClick:G,children:"New Entry"})]})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search compendium...",value:n,onChange:z=>s(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n===""&&a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(([z,B])=>a.jsxs("div",{className:"border-b",children:[a.jsxs("div",{onClick:()=>P(z),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[p.has(z)?a.jsx(Nh,{className:"w-4 h-4 text-gray-500"}):a.jsx(Fa,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:z})]}),a.jsx("span",{className:"text-sm text-gray-500",children:B.length})]}),p.has(z)&&a.jsx("div",{className:"bg-gray-50",children:B.map(L=>a.jsx("div",{onClick:()=>u(L),className:`px-8 py-2 cursor-pointer hover:bg-gray-100 ${(o==null?void 0:o.id)===L.id?"bg-blue-50":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:L.title}),h.some(Q=>Q.id===L.id)&&a.jsx(Hy,{className:"w-4 h-4 text-blue-500"})]})},L.id))})]},z))})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-95 z-10 p-6 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Search Results"}),a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>s(""),children:"Clear Search"})]}),H.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:H.map(z=>a.jsxs("div",{onClick:()=>{u(z),s("")},className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:z.title}),a.jsx("div",{className:"homebrew",children:a.jsx(id,{content:z.content.slice(0,200)+"..."})})]},z.id))}):a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-gray-500",children:['No results found for "',n,'".']})})]}),o&&!n?a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:h.some(z=>z.id===o.id)?Hy:r4,onClick:()=>j(o),children:h.some(z=>z.id===o.id)?"Bookmarked":"Bookmark"}),t()&&a.jsx(U,{variant:"secondary",size:"sm",icon:Qu,onClick:()=>d(o),children:"Edit"})]})]}),a.jsx("div",{className:"homebrew",children:a.jsx(id,{content:o.content})})]}):!o&&!n&&a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bookmarked Entries"}),h.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(z=>a.jsxs("div",{onClick:()=>u(z),className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:z.title}),a.jsx("div",{className:"homebrew",children:a.jsx(id,{content:z.preview})})]},z.id))}):a.jsxs("div",{className:"text-center",children:[a.jsx(Yu,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Welcome to the Compendium"}),a.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Use the sidebar to search and browse entries, or add new ones if you're an admin."})]})]})]}),c&&a.jsx(NF,{entry:c,onClose:()=>d(null),onSave:q})]})}async function _F(e,t){if(!e)return[];let r=te.from("parties").select(`
    id,
    name,
    description,
    created_by,
    created_at,
    members:party_members!left (
      characters!inner (
        *
      )
    )
  `);t?r=r.eq("created_by",e):r=r.eq("members.characters.user_id",e);const{data:n,error:s}=await r.order("created_at",{ascending:!1});if(s)throw console.error("Error fetching parties:",s),new Error(s.message||"Failed to fetch parties");return(n||[]).map(l=>({...l,members:(l.members||[]).map(o=>o.characters?Wl(o.characters):null).filter(o=>!!o)}))}async function n_(e){if(!e)return[];const{data:t,error:r}=await te.from("party_members").select("character_id");if(r)throw console.error("Error fetching party member IDs:",r),new Error(r.message||"Failed to fetch member data");const n=(t||[]).map(o=>o.character_id);let s=te.from("characters").select("*").eq("user_id",e);n.length>0&&(s=s.not("id","in",`(${n.join(",")})`));const{data:i,error:l}=await s;if(l)throw console.error("Error fetching available characters:",l),new Error(l.message||"Failed to fetch available characters");return(i||[]).map(Wl)}async function SF(e){if(!e)return null;const{data:t,error:r}=await te.from("parties").select(`
      id,
      name,
      description,
      created_by,
      created_at,
			invite_code,
      members:party_members (
        characters (
          *
        )
      )
    `).eq("id",e).single();if(r)throw console.error("Error fetching party by ID:",r),r.code==="PGRST116"?new Error("Party not found"):new Error(r.message||"Failed to fetch party");return t?{...t,members:(t.members||[]).map(s=>s.characters?Wl(s.characters):null).filter(s=>!!s)}:null}async function TF(e,t){const{error:r}=await te.from("party_members").delete().match({party_id:e,character_id:t});if(r)throw console.error("Error removing party member:",r),new Error(r.message||"Failed to remove party member")}async function CF(e){const{error:t}=await te.from("parties").delete().eq("id",e);if(t)throw console.error("Error deleting party:",t),new Error(t.message||"Failed to delete party")}function jF(){const{user:e,isDM:t}=Vt(),r=fn(),n=hn(),[s,i]=w.useState(!1),[l,o]=w.useState(""),[u,c]=w.useState([]),{data:d=[],isLoading:h,error:f}=Ut({queryKey:["parties",e==null?void 0:e.id,t()],queryFn:()=>_F(e==null?void 0:e.id,t()),enabled:!!e}),{data:p=[],isLoading:g,error:y}=Ut({queryKey:["availableCharacters",e==null?void 0:e.id],queryFn:()=>n_(e==null?void 0:e.id),enabled:!!e&&s}),E=h||s&&g,x=(f==null?void 0:f.message)||(y==null?void 0:y.message)||null,b=At({mutationFn:async({name:_,characterIds:k})=>{if(!_.trim())throw new Error("Party name is required");if(!e)throw new Error("User not authenticated");const{data:S,error:I}=await te.from("parties").insert([{name:_,created_by:e.id}]).select().single();if(I)throw I;if(!S)throw new Error("Party creation failed");if(k.length>0){const j=k.map(T=>({party_id:S.id,character_id:T})),{error:P}=await te.from("party_members").insert(j);if(P)throw await te.from("parties").delete().eq("id",S.id),P}return S},onSuccess:()=>{n.invalidateQueries({queryKey:["parties",e==null?void 0:e.id,t()]}),n.invalidateQueries({queryKey:["availableCharacters",e==null?void 0:e.id]}),o(""),c([]),i(!1)}}),v=()=>{b.mutate({name:l,characterIds:u})};return E&&!s?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx($e,{size:"lg"})}):x&&!s?a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:x})}):a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Cn,{className:"w-6 h-6 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Adventure Parties"})]}),t()&&a.jsx(U,{variant:"primary",icon:Jt,onClick:()=>i(!0),disabled:s,children:"Create Party"})]}),x&&!b.error&&!s&&a.jsx("div",{className:"mb-6",children:a.jsx(Ie,{message:x})}),s&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Party"}),b.error&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:b.error.message})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partyName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name"}),a.jsx("input",{type:"text",id:"partyName",value:l,onChange:_=>o(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Initial Characters (Optional)"}),g?a.jsx($e,{}):y?a.jsx(Ie,{message:y.message}):p.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-60 overflow-y-auto p-2 border rounded-md",children:p.map(_=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer ${u.includes(_.id||"")?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>{_.id&&c(k=>k.includes(_.id)?k.filter(S=>S!==_.id):[...k,_.id])},children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ui,{className:"w-4 h-4 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-sm",children:_.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[_.kin," ",_.profession]})]})]})},_.id))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No available characters to add."})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(U,{variant:"secondary",onClick:()=>i(!1),disabled:b.isPending,children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:v,loading:b.isPending,disabled:!l.trim()||b.isPending,children:"Create Party"})]})]})]}),!s&&(d.length>0?a.jsx("div",{className:"grid gap-6",children:d.map(_=>a.jsxs("div",{onClick:()=>r(`/party/${_.id}`),className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg hover:border-blue-400 border border-transparent transition-all cursor-pointer",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:_.name}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[_.members.map(k=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ui,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:k.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[k.kin," ",k.profession]})]})]})},k.id)),_.members.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic col-span-full",children:"No members yet."})]})]},_.id))}):a.jsx(Rp,{icon:Cn,title:"No Adventure Parties",description:t()?"You haven't created any parties yet.":"You're not currently in any adventure parties.",action:t()?a.jsx(U,{variant:"primary",icon:Jt,onClick:()=>i(!0),children:"Create Your First Party"}):void 0}))]})}function Hg({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(zN,{remarkPlugins:[fk],rehypePlugins:[Xk,r_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function AF(){const{user:e,isDM:t}=Vt(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState([]),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(null),[g,y]=w.useState(""),[E,x]=w.useState(""),[b,v]=w.useState(""),[_,k]=w.useState(""),[S,I]=w.useState(""),[j,P]=w.useState("all"),[T,H]=w.useState(!0),[O,q]=w.useState(null),[G,$]=w.useState(null),z=w.useCallback(()=>{y(""),x(""),v(""),k(""),$(null)},[]),B=()=>{z(),h(!0),p(null),c(null)},L=Z=>{c(Z),p(Z.id),h(!1),y(Z.title),x(Z.content),v(Z.character_id||""),k(Z.party_id||""),$(null)},Q=()=>{h(!1),p(null),z(),f&&c(null)},N=w.useCallback(async()=>{if(e){H(!0),q(null);try{const Z=new Map,{data:le,error:he}=await te.from("notes").select("*, character:characters(name), party:parties(name)").eq("user_id",e.id);if(he)throw he;if((le||[]).forEach(Le=>Z.set(Le.id,Le)),t()){const{data:Le,error:De}=await te.from("parties").select("id").eq("created_by",e.id);if(De)throw De;const Qe=(Le||[]).map(Je=>Je.id);if(Qe.length>0){const{data:Je,error:V}=await te.from("notes").select("*, character:characters(name), party:parties(name)").in("party_id",Qe);if(V)throw V;(Je||[]).forEach(Ne=>Z.set(Ne.id,Ne))}}const ye=Array.from(Z.values()).sort((Le,De)=>new Date(De.created_at).getTime()-new Date(Le.created_at).getTime());n(ye)}catch(Z){console.error("Error loading notes:",Z),q(Z instanceof Error?Z.message:"Failed to load notes"),n([])}finally{H(!1)}}},[e,t]),K=w.useCallback(async()=>{if(e)try{const{data:Z,error:le}=await te.from("characters").select("id, name").eq("user_id",e.id);if(le)throw le;i(Z||[])}catch(Z){console.error("Error loading characters:",Z),q(le=>le||(Z instanceof Error?Z.message:"Failed to load characters"))}},[e]),Y=w.useCallback(async()=>{if(!(!e||!t()))try{const{data:Z,error:le}=await te.from("parties").select("id, name").eq("created_by",e.id);if(le)throw le;o(Z||[])}catch(Z){console.error("Error loading parties:",Z),q(le=>le||(Z instanceof Error?Z.message:"Failed to load parties"))}},[e,t]);w.useEffect(()=>{e?(N(),K(),t()&&Y()):(H(!1),n([]),i([]),o([]),c(null),Q())},[e,t,N,K,Y]);async function A(){if(!e){$("User not authenticated.");return}if(!g.trim()){$("Title is required.");return}$(null);const Z=b||null,le=_||null;if(Z&&le){$("A note can be linked to either a character OR a party, not both.");return}const he={title:g.trim(),content:E,user_id:e.id,character_id:Z,party_id:le,updated_at:new Date().toISOString()};try{let ye=null;if(f){const{data:Le,error:De}=await te.from("notes").update(he).eq("id",f).select("*, character:characters(name), party:parties(name)").single();if(De)throw De;ye=Le}else{const{updated_at:Le,...De}=he,{data:Qe,error:Je}=await te.from("notes").insert([De]).select("*, character:characters(name), party:parties(name)").single();if(Je)throw Je;ye=Qe}Q(),await N(),ye&&c(ye)}catch(ye){console.error("Error saving note:",ye),$(ye instanceof Error?`Failed to save note: ${ye.message}`:"An unknown error occurred.")}}async function me(Z){if(window.confirm("Are you sure you want to delete this note?"))try{q(null);const{error:le}=await te.from("notes").delete().eq("id",Z);if(le)throw le;await N(),(u==null?void 0:u.id)===Z&&c(null),f===Z&&Q()}catch(le){console.error("Error deleting note:",le),q(le instanceof Error?`Failed to delete note: ${le.message}`:"An unknown error occurred.")}}const J=r.filter(Z=>{const le=Z.title.toLowerCase().includes(S.toLowerCase())||Z.content.toLowerCase().includes(S.toLowerCase()),he=j==="all"||j==="personal"&&!Z.character_id&&!Z.party_id||j==="character"&&!!Z.character_id||j==="party"&&!!Z.party_id;return le&&he});if(T&&r.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[a.jsx($e,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading notes..."})]});const ae=d||f;return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(Yu,{className:"w-6 h-6 text-blue-600"}),"Notes"]}),a.jsx(U,{variant:"primary",size:"sm",icon:Jt,onClick:B,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:S,onChange:Z=>I(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:j,onChange:Z=>P(Z.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white","aria-label":"Filter notes",children:[a.jsx("option",{value:"all",children:"All Notes"}),a.jsx("option",{value:"personal",children:"My Personal Notes"}),a.jsx("option",{value:"character",children:"Character Notes"}),a.jsx("option",{value:"party",children:"Party Notes"})]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Nh,{className:"w-4 h-4 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[O&&!ae&&a.jsx("div",{className:"p-4",children:a.jsx(Ie,{message:O,onClose:()=>q(null)})}),J.length>0?J.map(Z=>a.jsxs("div",{onClick:()=>{(!f||f!==Z.id)&&(c(Z),h(!1),p(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(u==null?void 0:u.id)===Z.id&&!ae?"bg-blue-50 border-l-4 border-blue-500":""} ${f===Z.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:Z.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:Z.content.substring(0,50)+(Z.content.length>50?"...":"")}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Z.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:["Char: ",Z.character.name]}):Z.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-xs",children:["Party: ",Z.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-xs",children:"Personal"})})]},Z.id)):!T&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Al,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),S||j!=="all"?"No notes match.":"No notes yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:ae?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Note":"Create New Note"}),a.jsx("button",{onClick:Q,className:"text-gray-500 hover:text-gray-700","aria-label":"Close form",children:a.jsx(Dt,{className:"w-5 h-5"})})]}),G&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:G,onClose:()=>$(null)})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"title",value:g,onChange:Z=>y(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter note title",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"character",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Character (Optional)"}),a.jsxs("select",{id:"character",value:b,onChange:Z=>{v(Z.target.value),Z.target.value&&k("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!_,children:[a.jsx("option",{value:"",children:"None"}),s.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),t()&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Party (Optional, DM Only)"}),a.jsxs("select",{id:"party",value:_,onChange:Z=>{k(Z.target.value),Z.target.value&&v("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!b,children:[a.jsx("option",{value:"",children:"None"}),l.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"content",value:E,onChange:Z=>x(Z.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter note content..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use Markdown for formatting."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx(U,{variant:"secondary",onClick:Q,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:tr,onClick:A,disabled:!g.trim(),children:f?"Update Note":"Save Note"})]})]})]}):u?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:u.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:u.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["Character: ",u.character.name]}):u.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Party: ",u.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Personal"})})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:Qu,onClick:()=>L(u),children:"Edit"}),a.jsx(U,{variant:"danger_outline",size:"sm",icon:cr,onClick:()=>me(u.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Hg,{content:u.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(u.created_at).toLocaleDateString(),u.updated_at&&new Date(u.updated_at).getTime()!==new Date(u.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(u.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Al,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),O&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ie,{message:O,onClose:()=>q(null)})})]})})]})}var et;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const i={};for(const l of s)i[l]=l;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),l={};for(const o of i)l[o]=s[o];return e.objectValues(l)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&i.push(l);return i},e.find=(s,i)=>{for(const l of s)if(i(l))return l},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(et||(et={}));var Qp;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(Qp||(Qp={}));const ve=et.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ls=e=>{switch(typeof e){case"undefined":return ve.undefined;case"string":return ve.string;case"number":return isNaN(e)?ve.nan:ve.number;case"boolean":return ve.boolean;case"function":return ve.function;case"bigint":return ve.bigint;case"symbol":return ve.symbol;case"object":return Array.isArray(e)?ve.array:e===null?ve.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ve.promise:typeof Map<"u"&&e instanceof Map?ve.map:typeof Set<"u"&&e instanceof Set?ve.set:typeof Date<"u"&&e instanceof Date?ve.date:ve.object;default:return ve.unknown}},ie=et.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),IF=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Gr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},s=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let o=n,u=0;for(;u<l.path.length;){const c=l.path[u];u===l.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(l))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),n}static assert(t){if(!(t instanceof Gr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,et.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Gr.create=e=>new Gr(e);const Ol=(e,t)=>{let r;switch(e.code){case ie.invalid_type:e.received===ve.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case ie.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,et.jsonStringifyReplacer)}`;break;case ie.unrecognized_keys:r=`Unrecognized key(s) in object: ${et.joinValues(e.keys,", ")}`;break;case ie.invalid_union:r="Invalid input";break;case ie.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${et.joinValues(e.options)}`;break;case ie.invalid_enum_value:r=`Invalid enum value. Expected ${et.joinValues(e.options)}, received '${e.received}'`;break;case ie.invalid_arguments:r="Invalid function arguments";break;case ie.invalid_return_type:r="Invalid function return type";break;case ie.invalid_date:r="Invalid date";break;case ie.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:et.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case ie.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case ie.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case ie.custom:r="Invalid input";break;case ie.invalid_intersection_types:r="Intersection results could not be merged";break;case ie.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ie.not_finite:r="Number must be finite";break;default:r=t.defaultError,et.assertNever(e)}return{message:r}};let s_=Ol;function RF(e){s_=e}function qd(){return s_}const Vd=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],l={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)o=c(l,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},LF=[];function pe(e,t){const r=qd(),n=Vd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Ol?void 0:Ol].filter(s=>!!s)});e.common.issues.push(n)}class fr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return Pe;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const i=await s.key,l=await s.value;n.push({key:i,value:l})}return fr.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:i,value:l}=s;if(i.status==="aborted"||l.status==="aborted")return Pe;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const Pe=Object.freeze({status:"aborted"}),Wi=e=>({status:"dirty",value:e}),wr=e=>({status:"valid",value:e}),Kp=e=>e.status==="aborted",Zp=e=>e.status==="dirty",hi=e=>e.status==="valid",ku=e=>typeof Promise<"u"&&e instanceof Promise;function Wd(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function a_(e,t,r,n,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var ke;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ke||(ke={}));var ko,_o;class Qn{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const F1=(e,t)=>{if(hi(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Gr(e.common.issues);return this._error=r,this._error}}};function Fe(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(l,o)=>{var u,c;const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}},description:s}}class ze{get description(){return this._def.description}_getType(t){return ls(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:ls(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new fr,ctx:{common:t.parent.common,data:t.data,parsedType:ls(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(ku(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ls(t)},i=this._parseSync({data:t,path:s.path,parent:s});return F1(s,i)}"~validate"(t){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ls(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return hi(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>hi(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ls(t)},s=this._parse({data:t,path:n.path,parent:n}),i=await(ku(s)?s:Promise.resolve(s));return F1(n,i)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const l=t(s),o=()=>i.addIssue({code:ie.custom,...n(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new Rn({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Wn.create(this,this._def)}nullable(){return wa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return An.create(this)}promise(){return Dl.create(this,this._def)}or(t){return Cu.create([this,t],this._def)}and(t){return ju.create(this,t,this._def)}transform(t){return new Rn({...Fe(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Ou({...Fe(this._def),innerType:this,defaultValue:r,typeName:Oe.ZodDefault})}brand(){return new $g({typeName:Oe.ZodBranded,type:this,...Fe(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Pu({...Fe(this._def),innerType:this,catchValue:r,typeName:Oe.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return sc.create(this,t)}readonly(){return Du.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const OF=/^c[^\s-]{8,}$/i,PF=/^[0-9a-z]+$/,DF=/^[0-9A-HJKMNP-TV-Z]{26}$/i,MF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,FF=/^[a-z0-9_-]{21}$/i,UF=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,BF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,HF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$F="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let lm;const zF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,VF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,WF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,GF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,YF=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,i_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",QF=new RegExp(`^${i_}$`);function l_(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function KF(e){return new RegExp(`^${l_(e)}$`)}function o_(e){let t=`${i_}T${l_(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function ZF(e,t){return!!((t==="v4"||!t)&&zF.test(e)||(t==="v6"||!t)&&VF.test(e))}function XF(e,t){if(!UF.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function JF(e,t){return!!((t==="v4"||!t)&&qF.test(e)||(t==="v6"||!t)&&WF.test(e))}class kn extends ze{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ve.string){const i=this._getOrReturnCtx(t);return pe(i,{code:ie.invalid_type,expected:ve.string,received:i.parsedType}),Pe}const n=new fr;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(s=this._getOrReturnCtx(t,s),l?pe(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&pe(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")HF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"email",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lm||(lm=new RegExp($F,"u")),lm.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"emoji",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")MF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"uuid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")FF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"nanoid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")OF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")PF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid2",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")DF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ulid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),pe(s,{validation:"url",code:ie.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"regex",code:ie.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?o_(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?QF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?KF(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?BF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"duration",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?ZF(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ip",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?XF(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"jwt",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?JF(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cidr",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?GF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?YF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64url",code:ie.invalid_string,message:i.message}),n.dirty()):et.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:ie.invalid_string,...ke.errToObj(n)})}_addCheck(t){return new kn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ke.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ke.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ke.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ke.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ke.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ke.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ke.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ke.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ke.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ke.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ke.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ke.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ke.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...ke.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ke.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ke.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ke.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ke.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ke.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ke.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ke.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ke.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ke.errToObj(r)})}nonempty(t){return this.min(1,ke.errToObj(t))}trim(){return new kn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new kn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new kn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}kn.create=e=>{var t;return new kn({checks:[],typeName:Oe.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Fe(e)})};function eU(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(e.toFixed(s).replace(".","")),l=parseInt(t.toFixed(s).replace(".",""));return i%l/Math.pow(10,s)}class ya extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ve.number){const i=this._getOrReturnCtx(t);return pe(i,{code:ie.invalid_type,expected:ve.number,received:i.parsedType}),Pe}let n;const s=new fr;for(const i of this._def.checks)i.kind==="int"?et.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?eU(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.not_finite,message:i.message}),s.dirty()):et.assertNever(i);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ke.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ke.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ke.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ke.toString(r))}setLimit(t,r,n,s){return new ya({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ke.toString(s)}]})}_addCheck(t){return new ya({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ke.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ke.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ke.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ke.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ke.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ke.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ke.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ke.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ke.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&et.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}ya.create=e=>new ya({checks:[],typeName:Oe.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Fe(e)});class ba extends ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ve.bigint)return this._getInvalidInput(t);let n;const s=new fr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):et.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return pe(r,{code:ie.invalid_type,expected:ve.bigint,received:r.parsedType}),Pe}gte(t,r){return this.setLimit("min",t,!0,ke.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ke.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ke.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ke.toString(r))}setLimit(t,r,n,s){return new ba({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ke.toString(s)}]})}_addCheck(t){return new ba({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ke.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ke.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ke.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ke.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ke.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}ba.create=e=>{var t;return new ba({checks:[],typeName:Oe.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Fe(e)})};class _u extends ze{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ve.boolean){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.boolean,received:n.parsedType}),Pe}return wr(t.data)}}_u.create=e=>new _u({typeName:Oe.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Fe(e)});class fi extends ze{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ve.date){const i=this._getOrReturnCtx(t);return pe(i,{code:ie.invalid_type,expected:ve.date,received:i.parsedType}),Pe}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pe(i,{code:ie.invalid_date}),Pe}const n=new fr;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:ie.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):et.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new fi({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ke.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ke.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}fi.create=e=>new fi({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Oe.ZodDate,...Fe(e)});class Gd extends ze{_parse(t){if(this._getType(t)!==ve.symbol){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.symbol,received:n.parsedType}),Pe}return wr(t.data)}}Gd.create=e=>new Gd({typeName:Oe.ZodSymbol,...Fe(e)});class Su extends ze{_parse(t){if(this._getType(t)!==ve.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.undefined,received:n.parsedType}),Pe}return wr(t.data)}}Su.create=e=>new Su({typeName:Oe.ZodUndefined,...Fe(e)});class Tu extends ze{_parse(t){if(this._getType(t)!==ve.null){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.null,received:n.parsedType}),Pe}return wr(t.data)}}Tu.create=e=>new Tu({typeName:Oe.ZodNull,...Fe(e)});class Pl extends ze{constructor(){super(...arguments),this._any=!0}_parse(t){return wr(t.data)}}Pl.create=e=>new Pl({typeName:Oe.ZodAny,...Fe(e)});class ti extends ze{constructor(){super(...arguments),this._unknown=!0}_parse(t){return wr(t.data)}}ti.create=e=>new ti({typeName:Oe.ZodUnknown,...Fe(e)});class vs extends ze{_parse(t){const r=this._getOrReturnCtx(t);return pe(r,{code:ie.invalid_type,expected:ve.never,received:r.parsedType}),Pe}}vs.create=e=>new vs({typeName:Oe.ZodNever,...Fe(e)});class Yd extends ze{_parse(t){if(this._getType(t)!==ve.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.void,received:n.parsedType}),Pe}return wr(t.data)}}Yd.create=e=>new Yd({typeName:Oe.ZodVoid,...Fe(e)});class An extends ze{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==ve.array)return pe(r,{code:ie.invalid_type,expected:ve.array,received:r.parsedType}),Pe;if(s.exactLength!==null){const l=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(l||o)&&(pe(r,{code:l?ie.too_big:ie.too_small,minimum:o?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(pe(r,{code:ie.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(pe(r,{code:ie.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>s.type._parseAsync(new Qn(r,l,r.path,o)))).then(l=>fr.mergeArray(n,l));const i=[...r.data].map((l,o)=>s.type._parseSync(new Qn(r,l,r.path,o)));return fr.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new An({...this._def,minLength:{value:t,message:ke.toString(r)}})}max(t,r){return new An({...this._def,maxLength:{value:t,message:ke.toString(r)}})}length(t,r){return new An({...this._def,exactLength:{value:t,message:ke.toString(r)}})}nonempty(t){return this.min(1,t)}}An.create=(e,t)=>new An({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...Fe(t)});function Ri(e){if(e instanceof Nt){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Wn.create(Ri(n))}return new Nt({...e._def,shape:()=>t})}else return e instanceof An?new An({...e._def,type:Ri(e.element)}):e instanceof Wn?Wn.create(Ri(e.unwrap())):e instanceof wa?wa.create(Ri(e.unwrap())):e instanceof Kn?Kn.create(e.items.map(t=>Ri(t))):e}class Nt extends ze{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=et.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ve.object){const c=this._getOrReturnCtx(t);return pe(c,{code:ie.invalid_type,expected:ve.object,received:c.parsedType}),Pe}const{status:n,ctx:s}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof vs&&this._def.unknownKeys==="strip"))for(const c in s.data)l.includes(c)||o.push(c);const u=[];for(const c of l){const d=i[c],h=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new Qn(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof vs){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")o.length>0&&(pe(s,{code:ie.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new Qn(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const h=await d.key,f=await d.value;c.push({key:h,value:f,alwaysSet:d.alwaysSet})}return c}).then(c=>fr.mergeObjectSync(n,c)):fr.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return ke.errToObj,new Nt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var s,i,l,o;const u=(l=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&l!==void 0?l:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=ke.errToObj(t).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Nt({...this._def,unknownKeys:"strip"})}passthrough(){return new Nt({...this._def,unknownKeys:"passthrough"})}extend(t){return new Nt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Nt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Oe.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Nt({...this._def,catchall:t})}pick(t){const r={};return et.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Nt({...this._def,shape:()=>r})}omit(t){const r={};return et.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Nt({...this._def,shape:()=>r})}deepPartial(){return Ri(this)}partial(t){const r={};return et.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}),new Nt({...this._def,shape:()=>r})}required(t){const r={};return et.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Wn;)i=i._def.innerType;r[n]=i}}),new Nt({...this._def,shape:()=>r})}keyof(){return u_(et.objectKeys(this.shape))}}Nt.create=(e,t)=>new Nt({shape:()=>e,unknownKeys:"strip",catchall:vs.create(),typeName:Oe.ZodObject,...Fe(t)});Nt.strictCreate=(e,t)=>new Nt({shape:()=>e,unknownKeys:"strict",catchall:vs.create(),typeName:Oe.ZodObject,...Fe(t)});Nt.lazycreate=(e,t)=>new Nt({shape:e,unknownKeys:"strip",catchall:vs.create(),typeName:Oe.ZodObject,...Fe(t)});class Cu extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Gr(o.ctx.common.issues));return pe(r,{code:ie.invalid_union,unionErrors:l}),Pe}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(s);{let i;const l=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(u=>new Gr(u));return pe(r,{code:ie.invalid_union,unionErrors:o}),Pe}}get options(){return this._def.options}}Cu.create=(e,t)=>new Cu({options:e,typeName:Oe.ZodUnion,...Fe(t)});const ns=e=>e instanceof Iu?ns(e.schema):e instanceof Rn?ns(e.innerType()):e instanceof Ru?[e.value]:e instanceof va?e.options:e instanceof Lu?et.objectValues(e.enum):e instanceof Ou?ns(e._def.innerType):e instanceof Su?[void 0]:e instanceof Tu?[null]:e instanceof Wn?[void 0,...ns(e.unwrap())]:e instanceof wa?[null,...ns(e.unwrap())]:e instanceof $g||e instanceof Du?ns(e.unwrap()):e instanceof Pu?ns(e._def.innerType):[];class qh extends ze{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.object)return pe(r,{code:ie.invalid_type,expected:ve.object,received:r.parsedType}),Pe;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(pe(r,{code:ie.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Pe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const s=new Map;for(const i of r){const l=ns(i.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of l){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new qh({typeName:Oe.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:s,...Fe(n)})}}function Xp(e,t){const r=ls(e),n=ls(t);if(e===t)return{valid:!0,data:e};if(r===ve.object&&n===ve.object){const s=et.objectKeys(t),i=et.objectKeys(e).filter(o=>s.indexOf(o)!==-1),l={...e,...t};for(const o of i){const u=Xp(e[o],t[o]);if(!u.valid)return{valid:!1};l[o]=u.data}return{valid:!0,data:l}}else if(r===ve.array&&n===ve.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const l=e[i],o=t[i],u=Xp(l,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===ve.date&&n===ve.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ju extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(i,l)=>{if(Kp(i)||Kp(l))return Pe;const o=Xp(i.value,l.value);return o.valid?((Zp(i)||Zp(l))&&r.dirty(),{status:r.value,value:o.data}):(pe(n,{code:ie.invalid_intersection_types}),Pe)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>s(i,l)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ju.create=(e,t,r)=>new ju({left:e,right:t,typeName:Oe.ZodIntersection,...Fe(r)});class Kn extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ve.array)return pe(n,{code:ie.invalid_type,expected:ve.array,received:n.parsedType}),Pe;if(n.data.length<this._def.items.length)return pe(n,{code:ie.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Pe;!this._def.rest&&n.data.length>this._def.items.length&&(pe(n,{code:ie.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Qn(n,l,n.path,o)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>fr.mergeArray(r,l)):fr.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Kn({...this._def,rest:t})}}Kn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kn({items:e,typeName:Oe.ZodTuple,rest:null,...Fe(t)})};class Au extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ve.object)return pe(n,{code:ie.invalid_type,expected:ve.object,received:n.parsedType}),Pe;const s=[],i=this._def.keyType,l=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new Qn(n,o,n.path,o)),value:l._parse(new Qn(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?fr.mergeObjectAsync(r,s):fr.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof ze?new Au({keyType:t,valueType:r,typeName:Oe.ZodRecord,...Fe(n)}):new Au({keyType:kn.create(),valueType:t,typeName:Oe.ZodRecord,...Fe(r)})}}class Qd extends ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ve.map)return pe(n,{code:ie.invalid_type,expected:ve.map,received:n.parsedType}),Pe;const s=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([o,u],c)=>({key:s._parse(new Qn(n,o,n.path,[c,"key"])),value:i._parse(new Qn(n,u,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of l){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return Pe;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of l){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return Pe;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}}}}Qd.create=(e,t,r)=>new Qd({valueType:t,keyType:e,typeName:Oe.ZodMap,...Fe(r)});class mi extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ve.set)return pe(n,{code:ie.invalid_type,expected:ve.set,received:n.parsedType}),Pe;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(pe(n,{code:ie.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(pe(n,{code:ie.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function l(u){const c=new Set;for(const d of u){if(d.status==="aborted")return Pe;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const o=[...n.data.values()].map((u,c)=>i._parse(new Qn(n,u,n.path,c)));return n.common.async?Promise.all(o).then(u=>l(u)):l(o)}min(t,r){return new mi({...this._def,minSize:{value:t,message:ke.toString(r)}})}max(t,r){return new mi({...this._def,maxSize:{value:t,message:ke.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}mi.create=(e,t)=>new mi({valueType:e,minSize:null,maxSize:null,typeName:Oe.ZodSet,...Fe(t)});class ll extends ze{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.function)return pe(r,{code:ie.invalid_type,expected:ve.function,received:r.parsedType}),Pe;function n(o,u){return Vd({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qd(),Ol].filter(c=>!!c),issueData:{code:ie.invalid_arguments,argumentsError:u}})}function s(o,u){return Vd({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qd(),Ol].filter(c=>!!c),issueData:{code:ie.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},l=r.data;if(this._def.returns instanceof Dl){const o=this;return wr(async function(...u){const c=new Gr([]),d=await o._def.args.parseAsync(u,i).catch(p=>{throw c.addIssue(n(u,p)),c}),h=await Reflect.apply(l,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(p=>{throw c.addIssue(s(h,p)),c})})}else{const o=this;return wr(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Gr([n(u,c.error)]);const d=Reflect.apply(l,this,c.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Gr([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new ll({...this._def,args:Kn.create(t).rest(ti.create())})}returns(t){return new ll({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new ll({args:t||Kn.create([]).rest(ti.create()),returns:r||ti.create(),typeName:Oe.ZodFunction,...Fe(n)})}}class Iu extends ze{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Iu.create=(e,t)=>new Iu({getter:e,typeName:Oe.ZodLazy,...Fe(t)});class Ru extends ze{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return pe(r,{received:r.data,code:ie.invalid_literal,expected:this._def.value}),Pe}return{status:"valid",value:t.data}}get value(){return this._def.value}}Ru.create=(e,t)=>new Ru({value:e,typeName:Oe.ZodLiteral,...Fe(t)});function u_(e,t){return new va({values:e,typeName:Oe.ZodEnum,...Fe(t)})}class va extends ze{constructor(){super(...arguments),ko.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{expected:et.joinValues(n),received:r.parsedType,code:ie.invalid_type}),Pe}if(Wd(this,ko)||a_(this,ko,new Set(this._def.values)),!Wd(this,ko).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{received:r.data,code:ie.invalid_enum_value,options:n}),Pe}return wr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return va.create(t,{...this._def,...r})}exclude(t,r=this._def){return va.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}ko=new WeakMap;va.create=u_;class Lu extends ze{constructor(){super(...arguments),_o.set(this,void 0)}_parse(t){const r=et.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==ve.string&&n.parsedType!==ve.number){const s=et.objectValues(r);return pe(n,{expected:et.joinValues(s),received:n.parsedType,code:ie.invalid_type}),Pe}if(Wd(this,_o)||a_(this,_o,new Set(et.getValidEnumValues(this._def.values))),!Wd(this,_o).has(t.data)){const s=et.objectValues(r);return pe(n,{received:n.data,code:ie.invalid_enum_value,options:s}),Pe}return wr(t.data)}get enum(){return this._def.values}}_o=new WeakMap;Lu.create=(e,t)=>new Lu({values:e,typeName:Oe.ZodNativeEnum,...Fe(t)});class Dl extends ze{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.promise&&r.common.async===!1)return pe(r,{code:ie.invalid_type,expected:ve.promise,received:r.parsedType}),Pe;const n=r.parsedType===ve.promise?r.data:Promise.resolve(r.data);return wr(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Dl.create=(e,t)=>new Dl({type:e,typeName:Oe.ZodPromise,...Fe(t)});class Rn extends ze{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:l=>{pe(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const l=s.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return Pe;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?Pe:u.status==="dirty"||r.value==="dirty"?Wi(u.value):u});{if(r.value==="aborted")return Pe;const o=this._def.schema._parseSync({data:l,path:n.path,parent:n});return o.status==="aborted"?Pe:o.status==="dirty"||r.value==="dirty"?Wi(o.value):o}}if(s.type==="refinement"){const l=o=>{const u=s.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Pe:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Pe:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!hi(l))return l;const o=s.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>hi(l)?Promise.resolve(s.transform(l.value,i)).then(o=>({status:r.value,value:o})):l);et.assertNever(s)}}Rn.create=(e,t,r)=>new Rn({schema:e,typeName:Oe.ZodEffects,effect:t,...Fe(r)});Rn.createWithPreprocess=(e,t,r)=>new Rn({schema:t,effect:{type:"preprocess",transform:e},typeName:Oe.ZodEffects,...Fe(r)});class Wn extends ze{_parse(t){return this._getType(t)===ve.undefined?wr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Wn.create=(e,t)=>new Wn({innerType:e,typeName:Oe.ZodOptional,...Fe(t)});class wa extends ze{_parse(t){return this._getType(t)===ve.null?wr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}wa.create=(e,t)=>new wa({innerType:e,typeName:Oe.ZodNullable,...Fe(t)});class Ou extends ze{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===ve.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Ou.create=(e,t)=>new Ou({innerType:e,typeName:Oe.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Fe(t)});class Pu extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return ku(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Gr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Gr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Pu.create=(e,t)=>new Pu({innerType:e,typeName:Oe.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Fe(t)});class Kd extends ze{_parse(t){if(this._getType(t)!==ve.nan){const n=this._getOrReturnCtx(t);return pe(n,{code:ie.invalid_type,expected:ve.nan,received:n.parsedType}),Pe}return{status:"valid",value:t.data}}}Kd.create=e=>new Kd({typeName:Oe.ZodNaN,...Fe(e)});const tU=Symbol("zod_brand");class $g extends ze{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class sc extends ze{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Pe:i.status==="dirty"?(r.dirty(),Wi(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Pe:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new sc({in:t,out:r,typeName:Oe.ZodPipeline})}}class Du extends ze{_parse(t){const r=this._def.innerType._parse(t),n=s=>(hi(s)&&(s.value=Object.freeze(s.value)),s);return ku(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Du.create=(e,t)=>new Du({innerType:e,typeName:Oe.ZodReadonly,...Fe(t)});function U1(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function c_(e,t={},r){return e?Pl.create().superRefine((n,s)=>{var i,l;const o=e(n);if(o instanceof Promise)return o.then(u=>{var c,d;if(!u){const h=U1(t,n),f=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;s.addIssue({code:"custom",...h,fatal:f})}});if(!o){const u=U1(t,n),c=(l=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...u,fatal:c})}}):Pl.create()}const rU={object:Nt.lazycreate};var Oe;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Oe||(Oe={}));const nU=(e,t={message:`Input not instance of ${e.name}`})=>c_(r=>r instanceof e,t),d_=kn.create,h_=ya.create,sU=Kd.create,aU=ba.create,f_=_u.create,iU=fi.create,lU=Gd.create,oU=Su.create,uU=Tu.create,cU=Pl.create,dU=ti.create,hU=vs.create,fU=Yd.create,mU=An.create,pU=Nt.create,gU=Nt.strictCreate,xU=Cu.create,yU=qh.create,bU=ju.create,vU=Kn.create,wU=Au.create,EU=Qd.create,NU=mi.create,kU=ll.create,_U=Iu.create,SU=Ru.create,TU=va.create,CU=Lu.create,jU=Dl.create,B1=Rn.create,AU=Wn.create,IU=wa.create,RU=Rn.createWithPreprocess,LU=sc.create,OU=()=>d_().optional(),PU=()=>h_().optional(),DU=()=>f_().optional(),MU={string:e=>kn.create({...e,coerce:!0}),number:e=>ya.create({...e,coerce:!0}),boolean:e=>_u.create({...e,coerce:!0}),bigint:e=>ba.create({...e,coerce:!0}),date:e=>fi.create({...e,coerce:!0})},FU=Pe;var zr=Object.freeze({__proto__:null,defaultErrorMap:Ol,setErrorMap:RF,getErrorMap:qd,makeIssue:Vd,EMPTY_PATH:LF,addIssueToContext:pe,ParseStatus:fr,INVALID:Pe,DIRTY:Wi,OK:wr,isAborted:Kp,isDirty:Zp,isValid:hi,isAsync:ku,get util(){return et},get objectUtil(){return Qp},ZodParsedType:ve,getParsedType:ls,ZodType:ze,datetimeRegex:o_,ZodString:kn,ZodNumber:ya,ZodBigInt:ba,ZodBoolean:_u,ZodDate:fi,ZodSymbol:Gd,ZodUndefined:Su,ZodNull:Tu,ZodAny:Pl,ZodUnknown:ti,ZodNever:vs,ZodVoid:Yd,ZodArray:An,ZodObject:Nt,ZodUnion:Cu,ZodDiscriminatedUnion:qh,ZodIntersection:ju,ZodTuple:Kn,ZodRecord:Au,ZodMap:Qd,ZodSet:mi,ZodFunction:ll,ZodLazy:Iu,ZodLiteral:Ru,ZodEnum:va,ZodNativeEnum:Lu,ZodPromise:Dl,ZodEffects:Rn,ZodTransformer:Rn,ZodOptional:Wn,ZodNullable:wa,ZodDefault:Ou,ZodCatch:Pu,ZodNaN:Kd,BRAND:tU,ZodBranded:$g,ZodPipeline:sc,ZodReadonly:Du,custom:c_,Schema:ze,ZodSchema:ze,late:rU,get ZodFirstPartyTypeKind(){return Oe},coerce:MU,any:cU,array:mU,bigint:aU,boolean:f_,date:iU,discriminatedUnion:yU,effect:B1,enum:TU,function:kU,instanceof:nU,intersection:bU,lazy:_U,literal:SU,map:EU,nan:sU,nativeEnum:CU,never:hU,null:uU,nullable:IU,number:h_,object:pU,oboolean:DU,onumber:PU,optional:AU,ostring:OU,pipeline:LU,preprocess:RU,promise:jU,record:wU,set:NU,strictObject:gU,string:d_,symbol:lU,transformer:B1,tuple:vU,undefined:oU,union:xU,unknown:dU,void:fU,NEVER:FU,ZodIssueCode:ie,quotelessJson:IF,ZodError:Gr});const UU=zr.object({email:zr.string().email({message:"Invalid email address"}),password:zr.string().min(1,{message:"Password is required"})}),BU=zr.object({username:zr.string().min(3,{message:"Username must be at least 3 characters long"}).max(50,{message:"Username cannot exceed 50 characters"}),email:zr.string().email({message:"Invalid email address"}),password:zr.string().min(8,{message:"Password must be at least 8 characters long"}),confirmPassword:zr.string(),role:zr.enum(["player","dm"],{required_error:"Please select a role"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),HU=zr.object({currentPassword:zr.string().min(1,"Current password is required"),newPassword:zr.string().min(8,"New password must be at least 8 characters"),confirmNewPassword:zr.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"New passwords don't match",path:["confirmNewPassword"]});function $U(){const[e,t]=w.useState(""),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(null),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState({}),{updateUserPassword:g}=Vt(),y=async E=>{E.preventDefault(),o(null),c(null),p({});const x=HU.safeParse({currentPassword:e,newPassword:r,confirmPassword:s});if(!x.success){const b={};x.error.errors.forEach(v=>{const _=v.path[0];_?b[_]=v.message:o(v.message)}),p(b),!l&&Object.keys(b).length>0&&o("Please fix the errors in the form.");return}h(!0);try{const{currentPassword:b,newPassword:v}=x.data;await g(b,v),c("Password updated successfully!"),t(""),n(""),i("")}catch(b){console.error("Password update error:",b),o(b instanceof Error?b.message:"Failed to update password.")}finally{h(!1)}};return a.jsxs("form",{onSubmit:y,className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Change Password"}),l&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(qt,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),u&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(kh,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:u})})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Bo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"current-password",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:E=>t(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.currentPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.currentPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.currentPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Bo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"new-password",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:E=>n(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.newPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.newPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.newPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Bo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirm-password",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s,onChange:E=>i(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.confirmPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.confirmPassword})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",loading:d,disabled:d,children:"Update Password"})})]})}async function m_(e){if(!e)return console.error("getUserProfile: No user ID provided."),null;try{const{data:t,error:r,status:n}=await te.from("users").select("id, username, first_name, last_name, avatar_url, bio").eq("id",e).single();if(r){if(n===406||r.code==="PGRST116")return console.warn(`No profile found for user ID: ${e}. This might be expected.`),null;throw console.error("Error fetching user profile:",r.message),new Error(`Failed to fetch user profile: ${r.message}`)}return t}catch(t){throw console.error("Unexpected error in getUserProfile:",t),t instanceof Error?t:new Error("An unknown error occurred while fetching the user profile.")}}async function zU(e,t){if(!e)throw new Error("updateUserProfile: No user ID provided.");if(!t||Object.keys(t).length===0)throw new Error("updateUserProfile: No updates provided.");const r={username:t.username,first_name:t.first_name,last_name:t.last_name,avatar_url:t.avatar_url,bio:t.bio};if(Object.keys(r).forEach(n=>{const s=n;r[s]===void 0&&delete r[s]}),Object.keys(r).length===0){console.warn("updateUserProfile: No valid fields to update after filtering.");const n=await m_(e);if(!n)throw new Error("Could not retrieve current profile after filtering updates.");return n}try{const{data:n,error:s}=await te.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select("id, username, first_name, last_name, avatar_url, bio").single();if(s)throw console.error("Error updating user profile:",s.message),s.code==="23505"?s.message.includes("users_username_key")?new Error(`Failed to update profile: Username '${r.username}' is already taken.`):new Error(`Failed to update profile: ${s.details||"A unique value constraint was violated."}`):new Error(`Failed to update user profile: ${s.message}`);if(!n)throw new Error("Failed to update user profile: No data returned.");return n}catch(n){throw console.error("Unexpected error in updateUserProfile:",n),n instanceof Error?n:new Error("An unknown error occurred while updating the user profile.")}}async function qU(e){if(!e)throw new Error("updateUserAuthEmail: No new email provided.");if(!/\S+@\S+\.\S+/.test(e))throw new Error("updateUserAuthEmail: Invalid email format provided.");try{const{data:t,error:r}=await te.auth.updateUser({email:e});if(r)throw console.error("Error updating user auth email:",r.message),r.message.includes("User not found")||r.status===404?new Error("Failed to initiate email update: Could not find the current user."):r.message.includes("Email rate limit exceeded")?new Error("Failed to initiate email update: Please wait before trying again."):r.message.includes("same as the existing email")?new Error("The new email address is the same as the current one."):new Error(`Failed to initiate email update: ${r.message}`);console.log("User auth email update initiated. Verification required.",t)}catch(t){throw console.error("Unexpected error in updateUserAuthEmail:",t),t instanceof Error?t:new Error("An unknown error occurred while updating the user's email.")}}function VU(){var I;const{user:e,session:t}=Vt(),[r,n]=w.useState(null),[s,i]=w.useState({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState(!0),[f,p]=w.useState(!1),[g,y]=w.useState(null),[E,x]=w.useState(null),b=w.useCallback(async j=>{var P,T,H;h(!0),y(null),x(null);try{const O=await m_(j.id),q=j.email??"";O?(n(O),i({first_name:O.first_name??"",last_name:O.last_name??"",username:O.username??((P=j.user_metadata)==null?void 0:P.username)??"",avatar_url:O.avatar_url??"",bio:O.bio??""})):(console.warn("User profile not found in 'users' table, initializing form with defaults/metadata."),i({first_name:"",last_name:"",username:((T=j.user_metadata)==null?void 0:T.username)??"",avatar_url:"",bio:""})),o(q),c(q)}catch(O){console.error("Failed to load profile:",O),y(O instanceof Error?O.message:"Failed to load profile data.");const q=(e==null?void 0:e.email)??"";o(q),c(q),i({first_name:"",last_name:"",username:((H=e==null?void 0:e.user_metadata)==null?void 0:H.username)??"",avatar_url:"",bio:""})}finally{h(!1)}},[]);w.useEffect(()=>{e?b(e):(h(!1),n(null),i({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),o(""),c(""),y(null),x(null))},[e,b]);const v=j=>{const{name:P,value:T}=j.target;i(H=>({...H,[P]:T})),y(null),x(null)},_=j=>{o(j.target.value),y(null),x(null)},k=async j=>{var q;if(j.preventDefault(),!e){y("You must be logged in to update your profile.");return}p(!0),y(null),x(null);let P=!1,T=!1,H="",O=!1;try{const G={},$=r??{username:((q=e.user_metadata)==null?void 0:q.username)??"",first_name:null,last_name:null,avatar_url:null,bio:null};if(s.first_name!==($.first_name??"")&&(G.first_name=s.first_name),s.last_name!==($.last_name??"")&&(G.last_name=s.last_name),s.username!==($.username??"")&&(G.username=s.username),s.avatar_url!==($.avatar_url??"")&&(G.avatar_url=s.avatar_url),s.bio!==($.bio??"")&&(G.bio=s.bio),Object.keys(G).length>0){O=!0;const B=await zU(e.id,G);n(L=>L?{...L,...B}:B),i({first_name:B.first_name??"",last_name:B.last_name??"",username:B.username??"",avatar_url:B.avatar_url??"",bio:B.bio??""}),P=!0}else P=!0;const z=l.trim();if(z!==u){if(!z)throw new Error("Email cannot be empty.");O=!0,await qU(z),T=!0,H=" Email update initiated. Please check both your current and new email addresses for a verification link to complete the change."}if(O){let B="";P&&Object.keys(G).length>0&&(B+="Profile fields updated successfully."),B+=H,x(B.trim())}else x("No changes were detected.")}catch(G){console.error("Failed to update profile:",G);const $=G instanceof Error?G.message:"An unknown error occurred during update.";y($)}finally{p(!1)}},S=j=>{var H;const P=j.currentTarget;P.style.display="none";const T=(H=P.parentElement)==null?void 0:H.querySelector(".fallback-icon");T&&(T.style.display="flex")};return d?a.jsx("div",{className:"flex justify-center items-center h-40",children:a.jsx($e,{})}):!e||!t?a.jsx("p",{className:"text-center text-red-600",children:"Please log in to view or edit your profile."}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8",children:[a.jsx("div",{className:"relative w-24 h-24",children:a.jsxs("div",{className:"w-full h-full rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border",children:[s.avatar_url&&a.jsx("img",{src:s.avatar_url,alt:"Profile",className:"w-full h-full object-cover",onError:S,style:{display:"block"}},s.avatar_url),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center fallback-icon",style:{display:s.avatar_url?"none":"flex"},children:a.jsx(yi,{className:"w-12 h-12 text-gray-400"})})]})}),a.jsxs("div",{className:"flex-grow w-full sm:w-auto",children:[a.jsx("h3",{className:"font-medium text-lg text-center sm:text-left",children:s.username||((I=e==null?void 0:e.user_metadata)==null?void 0:I.username)||"User"}),a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center sm:justify-start gap-1",children:[a.jsx(fg,{className:"w-4 h-4"}),l||"No email set"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{htmlFor:"avatar_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar URL"}),a.jsx("input",{id:"avatar_url",name:"avatar_url",type:"url",value:s.avatar_url??"",onChange:v,placeholder:"https://example.com/avatar.png",className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("form",{onSubmit:k,className:"space-y-6",children:[E&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(kh,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Success!"})," ",E]})]}),g&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(qt,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Error!"})," ",g]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),a.jsx("input",{id:"first_name",name:"first_name",type:"text",value:s.first_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),a.jsx("input",{id:"last_name",name:"last_name",type:"text",value:s.last_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:l,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":"email-description"}),a.jsx("p",{id:"email-description",className:"text-xs text-gray-500 mt-1",children:"Changing your email requires verification via links sent to both addresses."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",value:s.username??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be unique. Used for display and potentially logging in."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),a.jsx("textarea",{id:"bio",name:"bio",value:s.bio??"",onChange:v,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Tell us a little about yourself..."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(U,{type:"submit",variant:"primary",icon:tr,loading:f,disabled:f||d,children:"Save Changes"})})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-12",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Change Password"}),a.jsx($U,{})]})]})}function WU(){const[e,t]=w.useState("system"),[r,n]=w.useState("medium"),[s,i]=w.useState(!1),[l,o]=w.useState(!1),u=async c=>{c.preventDefault(),o(!0),await new Promise(d=>setTimeout(d,1e3)),o(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Appearance Settings"}),a.jsxs("form",{onSubmit:u,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("light"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="light"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(CE,{className:"w-6 h-6 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Light"})]}),a.jsxs("button",{type:"button",onClick:()=>t("dark"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="dark"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(EE,{className:"w-6 h-6 text-blue-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Dark"})]}),a.jsxs("button",{type:"button",onClick:()=>t("system"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="system"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(E4,{className:"w-6 h-6 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"System"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),a.jsxs("select",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"small",children:"Small"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"large",children:"Large"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:c=>i(c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reduce motion"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimize animations and transitions"})]}),a.jsxs("div",{className:"p-6 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsx("div",{className:`p-4 rounded-lg ${e==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:a.jsx("p",{className:`${r==="small"?"text-sm":r==="large"?"text-lg":"text-base"}`,children:"This is how your content will look with the selected theme and font size."})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:tr,loading:l,children:"Save Changes"})})]})]})}function GU(){const[e,t]=w.useState({email:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,systemUpdates:!1},desktop:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,diceRolls:!0},sounds:{enabled:!0,volume:80,diceRolls:!0,notifications:!0}}),[r,n]=w.useState(!1),s=async i=>{i.preventDefault(),n(!0),await new Promise(l=>setTimeout(l,1e3)),n(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Notification Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(fg,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Email Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.email).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,email:{...e.email,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(g4,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Desktop Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.desktop).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,desktop:{...e.desktop,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(pE,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Sound Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.enabled,onChange:i=>t({...e,sounds:{...e.sounds,enabled:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Enable Sounds"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Volume (",e.sounds.volume,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",value:e.sounds.volume,onChange:i=>t({...e,sounds:{...e.sounds,volume:parseInt(i.target.value)}}),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.diceRolls,onChange:i=>t({...e,sounds:{...e.sounds,diceRolls:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Dice Roll Sounds"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.notifications,onChange:i=>t({...e,sounds:{...e.sounds,notifications:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Notification Sounds"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:tr,loading:r,children:"Save Changes"})})]})]})}const YU=[{value:"en",label:"English"},{value:"et",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"sv",label:"Swedish"}],QU=[{value:"Europe/Tallinn",label:"Europe/Tallinn (UTC+2)"},{value:"Europe/Helsinki",label:"Europe/Helsinki (UTC+2)"},{value:"Europe/Stockholm",label:"Europe/Stockholm (UTC+1)"},{value:"UTC",label:"UTC"}],KU=[{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"YYYY-MM-DD",label:"YYYY-MM-DD"}],ZU=[{value:"24h",label:"24-hour (14:30)"},{value:"12h",label:"12-hour (2:30 PM)"}];function XU(){const[e,t]=w.useState({language:"en",timeZone:"Europe/Tallinn",dateFormat:"DD/MM/YYYY",timeFormat:"24h",firstDayOfWeek:1,useMetricSystem:!0}),[r,n]=w.useState(!1),s=async o=>{o.preventDefault(),n(!0),await new Promise(u=>setTimeout(u,1e3)),n(!1)},i=new Date,l=new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"long",timeZone:e.timeZone}).format(i);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Localization Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(vE,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Language & Region"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interface Language"}),a.jsx("select",{value:e.language,onChange:o=>t({...e,language:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:YU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),a.jsx("select",{value:e.timeZone,onChange:o=>t({...e,timeZone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:QU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ug,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Date & Time Format"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),a.jsx("select",{value:e.dateFormat,onChange:o=>t({...e,dateFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:KU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),a.jsx("select",{value:e.timeFormat,onChange:o=>t({...e,timeFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:ZU.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Day of Week"}),a.jsxs("select",{value:e.firstDayOfWeek,onChange:o=>t({...e,firstDayOfWeek:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"Monday"}),a.jsx("option",{value:0,children:"Sunday"})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(_h,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Measurement System"})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.useMetricSystem,onChange:o=>t({...e,useMetricSystem:o.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Use Metric System"})]})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current date and time: ",l]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:tr,loading:r,children:"Save Changes"})})]})]})}function JU({onClose:e,onUserCreated:t}){const[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState("player"),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(!1),[g,y]=w.useState(null),[E,x]=w.useState(!1),[b,v]=w.useState([]),[_,k]=w.useState(!1),[S,I]=w.useState(null),j=async()=>{k(!0),I(null);const{data:H,error:O}=await te.from("users").select("*");O?I(O.message):v(H),k(!1)};w.useEffect(()=>{j()},[]);const P=async H=>{H.preventDefault(),c(null),p(!0);try{const O=Math.random().toString(36).slice(-12),{data:q,error:G}=await te.auth.signUp({email:r,password:O,options:{data:{username:s}}});if(G)throw G;if(!q.user)throw new Error("Failed to create user");const{error:$}=await te.from("users").update({role:l}).eq("id",q.user.id);if($)throw $;const z=new URL(window.location.origin);z.searchParams.set("email",r),z.searchParams.set("password",O),y(z.toString()),h(!0),t(),j()}catch(O){c(O instanceof Error?O.message:"Failed to create user")}finally{p(!1)}},T=async()=>{if(g)try{await navigator.clipboard.writeText(g),x(!0),setTimeout(()=>x(!1),2e3)}catch{c("Failed to copy link to clipboard")}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),u&&a.jsxs("div",{className:"mb-6 flex items-start gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]}),d&&g?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"User Created Successfully!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Share the following link with the user to let them sign in:"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:g,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50"}),a.jsx(U,{variant:"secondary",icon:E?tl:cg,onClick:T,children:E?"Copied!":"Copy"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{variant:"primary",onClick:e,children:"Done"})})]}):a.jsxs("form",{onSubmit:P,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:r,onChange:H=>n(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{type:"text",required:!0,value:s,onChange:H=>i(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{value:l,onChange:H=>o(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"player",children:"Player"}),a.jsx("option",{value:"dm",children:"Dungeon Master"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(U,{variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(U,{type:"submit",variant:"primary",icon:yi,loading:f,children:"Create User"})]})]})]}),a.jsxs("div",{className:"p-6 border-t",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Created Users"}),_?a.jsx("p",{children:"Loading users..."}):S?a.jsxs("p",{className:"text-red-600",children:["Error loading users: ",S]}):b.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(H=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.username}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.email}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.role}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(H.created_at).toLocaleString()}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:H.account_status||"N/A"})]},H.id))})]})}):a.jsx("p",{children:"No users found."})]})]})})}function eB(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState("all"),[d,h]=w.useState(!1),f=w.useCallback(async()=>{n(!0),i(null);try{const{data:x,error:b}=await te.from("users").select("id, email, username, role, created_at, last_login, first_name, last_name, is_active").order("created_at",{ascending:!1});if(b)throw b;t(x||[])}catch(x){console.error("Error fetching users:",x),i(`Failed to load users: ${x.message||"Unknown error"}`),t([])}finally{n(!1)}},[]);w.useEffect(()=>{f()},[f]);const p=()=>{h(!1),f()},g=e.filter(x=>{const b=l.toLowerCase(),v=x.username&&x.username.toLowerCase().includes(b)||x.email&&x.email.toLowerCase().includes(b)||x.first_name&&x.first_name.toLowerCase().includes(b)||x.last_name&&x.last_name.toLowerCase().includes(b),_=u==="all"||x.role&&x.role.toLowerCase()===u.toLowerCase();return v&&_}),y=x=>{const b=x==null?void 0:x.toLowerCase();return b==="admin"?"bg-purple-100 text-purple-800":b==="dm"||b==="dungeon master"?"bg-blue-100 text-blue-800":b==="player"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},E=x=>x.username?x.username:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.first_name?x.first_name:x.email.split("@")[0];return a.jsxs("div",{className:"space-y-6 p-4 md:p-6 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"User Management"}),a.jsx(U,{variant:"primary",icon:Jt,onClick:()=>h(!0),className:"w-full sm:w-auto",children:"Create User"})]}),s&&a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg shadow-sm",children:[a.jsx(qt,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Error Loading Users"}),a.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(xa,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, username...",value:l,onChange:x=>o(x.target.value),className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-colors",disabled:r})]}),a.jsxs("div",{className:"relative md:min-w-[200px]",children:[a.jsx(Ns,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:u,onChange:x=>c(x.target.value),className:"w-full pl-11 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white shadow-sm transition-colors",disabled:r,children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"player",children:"Players"}),a.jsx("option",{value:"dm",children:"Dungeon Masters"}),a.jsx("option",{value:"admin",children:"Administrators"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),r&&e.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):!r&&e.length===0&&!s?a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Users,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500",children:"There are currently no users to display. Try creating one!"})]}):a.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold",children:[x.first_name?x.first_name.charAt(0).toUpperCase():x.email.charAt(0).toUpperCase(),x.last_name?x.last_name.charAt(0).toUpperCase():x.username?x.username.charAt(0).toUpperCase():""]}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:E(x)}),a.jsx("div",{className:"text-xs text-gray-500",children:x.email})]})]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${y(x.role||"N/A")}`,children:x.role?x.role.charAt(0).toUpperCase()+x.role.slice(1):"N/A"})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:x.is_active===void 0||x.is_active===null?a.jsx("span",{className:"text-xs text-gray-500",children:"Unknown"}):x.is_active?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:[a.jsx(kh,{className:"w-3.5 h-3.5 mr-1.5"})," Active"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:[a.jsx(rl,{className:"w-3.5 h-3.5 mr-1.5"})," Inactive"]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:x.last_login?new Date(x.last_login).toLocaleString():"Never"}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"icon",size:"sm",title:"Edit User",className:"text-gray-500 hover:text-blue-600",children:a.jsx(mg,{className:"w-4 h-4"})}),a.jsx(U,{variant:"icon",size:"sm",title:"Delete User",className:"text-gray-500 hover:text-red-600",children:a.jsx(cr,{className:"w-4 h-4"})})]})})]},x.id))})]})}),g.length===0&&!r&&e.length>0&&a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(xa,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Match Your Search"}),a.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term or role filter."})]}),d&&a.jsx(JU,{onClose:()=>h(!1),onUserCreated:p})]})}var p_={exports:{}},tB="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",rB=tB,nB=rB;function g_(){}function x_(){}x_.resetWarningCache=g_;var sB=function(){function e(n,s,i,l,o,u){if(u!==nB){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:x_,resetWarningCache:g_};return r.PropTypes=r,r};p_.exports=sB();var aB=p_.exports;const $c=Zd(aB);function Jp(){return Jp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jp.apply(this,arguments)}function iB(e,t){if(e==null)return{};var r=lB(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lB(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var zg=w.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,s=e.size,i=s===void 0?24:s,l=iB(e,["color","size"]);return _n.createElement("svg",Jp({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),_n.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_n.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});zg.propTypes={color:$c.string,size:$c.oneOfType([$c.string,$c.number])};zg.displayName="X";function oB({entry:e,onChange:t}){const[r,n]=w.useState(e),[s,i]=w.useState({gold:0,silver:0,copper:0}),[l,o]=w.useState([]);w.useEffect(()=>{if(n(e),e.cost){const d=e.cost.split(",").map(f=>f.trim()),h={gold:0,silver:0,copper:0};d.forEach(f=>{f.includes("gold")?h.gold=parseInt(f.replace("gold","").trim())||0:f.includes("silver")?h.silver=parseInt(f.replace("silver","").trim())||0:f.includes("copper")&&(h.copper=parseInt(f.replace("copper","").trim())||0)}),i(h)}e.features&&o(e.features)},[e]);const u=(d,h)=>{const f=parseInt(h)||0,p={...s,[d]:f};i(p),t("cost",`${p.gold} gold, ${p.silver} silver, ${p.copper} copper`)},c=d=>{const h=l.filter((f,p)=>p!==d);o(h),t("features",h)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:d=>t("name",d.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:r.category||"",onChange:d=>t("category",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"ARMOR & HELMETS",children:"Armor & Helmets"}),a.jsx("option",{value:"MELEE WEAPONS",children:"Melee Weapons"}),a.jsx("option",{value:"RANGED WEAPONS",children:"Ranged Weapons"}),a.jsx("option",{value:"CLOTHES",children:"Clothes"}),a.jsx("option",{value:"MUSICAL INSTRUMENTS",children:"Musical Instruments"}),a.jsx("option",{value:"TRADE GOODS",children:"Trade Goods"}),a.jsx("option",{value:"STUDIES & MAGIC",children:"Studies & Magic"}),a.jsx("option",{value:"LIGHT SOURCES",children:"Light Sources"}),a.jsx("option",{value:"TOOLS",children:"Tools"}),a.jsx("option",{value:"CONTAINERS",children:"Containers"}),a.jsx("option",{value:"MEDICINE",children:"Medicine"}),a.jsx("option",{value:"SERVICES",children:"Services"}),a.jsx("option",{value:"HUNTING & FISHING",children:"Hunting & Fishing"}),a.jsx("option",{value:"MEANS OF TRAVEL",children:"Means of Travel"}),a.jsx("option",{value:"ANIMALS",children:"Animals"})]})]}),r.category==="ARMOR & HELMETS"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor Rating"}),a.jsx("input",{type:"number",value:r.armor_rating||"",onChange:d=>t("armor_rating",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),r.category==="MELEE WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),r.category==="RANGED WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.gold,onChange:d=>u("gold",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Gold"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.silver,onChange:d=>u("silver",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Silver"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.copper,onChange:d=>u("copper",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Copper"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supply"}),a.jsxs("select",{value:r.supply||"",onChange:d=>t("supply",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Supply"}),a.jsx("option",{value:"Common",children:"Common"}),a.jsx("option",{value:"Uncommon",children:"Uncommon"}),a.jsx("option",{value:"Rare",children:"Rare"}),a.jsx("option",{value:"Unique",children:"Unique"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:r.weight||"",onChange:d=>t("weight",parseFloat(d.target.value)),className:"w-full px-3 py-2 border rounded-md",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effect/Description"}),a.jsx("textarea",{value:r.effect||"",onChange:d=>t("effect",d.target.value.toUpperCase()),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((d,h)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md px-2 py-1 text-sm",children:[a.jsx("span",{children:d}),a.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-2 text-red-500 hover:text-red-700",children:a.jsx(zg,{className:"w-4 h-4"})})]},h)),a.jsx("input",{type:"text",onKeyDown:d=>{if(d.key==="Enter"&&d.currentTarget.value.trim()){d.preventDefault();const h=d.currentTarget.value.trim(),f=[...l,h];o(f),t("features",f),d.currentTarget.value=""}},className:"px-3 py-2 border rounded-md",placeholder:"Add feature..."})]})]})]})}const uB=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:r=>t("heroic_ability",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abilities"}),(e.abilities||[]).map((r,n)=>a.jsxs("div",{className:"flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",placeholder:"Ability Description",value:r.description||"",onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],description:s.target.value},t("abilities",i)},className:"border rounded-md px-2 py-1 flex-1"}),a.jsx("input",{type:"number",placeholder:"Willpower Points",value:r.willpower_points||0,onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],willpower_points:parseInt(s.target.value)},t("abilities",i)},className:"border rounded-md px-2 py-1 w-20",min:"0"}),a.jsx("button",{onClick:()=>{const s=[...e.abilities||[]];s.splice(n,1),t("abilities",s)},className:"text-red-600",children:"Remove"})]},n)),a.jsx("button",{onClick:()=>{const r=[...e.abilities||[],{description:"",willpower_points:0}];t("abilities",r)},className:"mt-2 text-blue-600",children:"Add Ability"})]})]}),cB=({entry:e,onChange:t})=>{const[r,n]=w.useState("skills"),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null);w.useEffect(()=>{(async()=>{o(!0),c(null);const{data:E,error:x}=await te.from("game_skills").select("id, name, is_magic").order("name",{ascending:!0});x?(console.error("Error fetching skills:",x),c("Failed to load skills from the database.")):i(E||[]),o(!1)})()},[]);const d=w.useMemo(()=>s.filter(y=>y.is_magic===!0),[s]),h=e.starting_equipment||["","",""],f=e.equipment_description||["","",""],p=(y,E,x)=>{if(E==="equipment"){const b=[...h];b[y]=x,t("starting_equipment",b)}else{const b=[...f];b[y]=x,t("equipment_description",b)}},g=y=>{t("is_magic",y),y||t("associated_skill",null)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:y=>t("name",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:y=>t("description",y.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"space-y-4 p-4 border rounded-md bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"is_magic",type:"checkbox",checked:e.is_magic||!1,onChange:y=>g(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_magic",className:"text-sm font-medium text-gray-900",children:"Is this a magic profession?"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"associated_skill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Associated Magic Skill"}),a.jsxs("select",{id:"associated_skill",value:e.associated_skill||"",onChange:y=>t("associated_skill",y.target.value||null),className:"w-full px-3 py-2 border rounded-md disabled:bg-gray-200 disabled:cursor-not-allowed",disabled:!e.is_magic||l||!!u,children:[l&&a.jsx("option",{children:"Loading magic skills..."}),u&&a.jsx("option",{children:"Error loading skills"}),!l&&!u&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"",children:"None"}),d.length>0?d.map(y=>a.jsx("option",{value:y.name,children:y.name},y.id)):a.jsx("option",{disabled:!0,children:"No skills marked as magic were found"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute"}),a.jsx("input",{type:"text",value:e.key_attribute||"",onChange:y=>t("key_attribute",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:y=>t("heroic_ability",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Magic School"}),a.jsxs("select",{value:e.magic_school_id||"",onChange:y=>t("magic_school_id",y.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"Animist",children:"Animist"}),a.jsx("option",{value:"Elementalist",children:"Elementalist"}),a.jsx("option",{value:"Mentalist",children:"Mentalist"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex border-b",children:[a.jsx("button",{type:"button",onClick:()=>n("skills"),className:`px-4 py-2 -mb-px font-medium ${r==="skills"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Skills"}),a.jsx("button",{type:"button",onClick:()=>n("startingEquipment"),className:`px-4 py-2 -mb-px font-medium ${r==="startingEquipment"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Starting Equipment"})]}),r==="skills"&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),l&&a.jsx("p",{className:"text-sm text-gray-500",children:"Loading skills..."}),u&&a.jsx("p",{className:"text-sm text-red-600",children:u}),!l&&!u&&a.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map(y=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:e.skills?e.skills.includes(y.name):!1,onChange:E=>{let x=e.skills?[...e.skills]:[];E.target.checked?x.push(y.name):x=x.filter(b=>b!==y.name),t("skills",x)}}),a.jsx("span",{className:"text-sm",children:y.name})]},y.id))})]}),r==="startingEquipment"&&a.jsx("div",{className:"mt-4 space-y-4",children:[0,1,2].map(y=>a.jsxs("div",{className:"border p-2 rounded-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment Option ",y+1]}),a.jsx("input",{type:"text",placeholder:"Enter equipment (e.g., Horn or Flute, knife, torch)",value:h[y]||"",onChange:E=>p(y,"equipment",E.target.value),className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (e.g., D6 food rations, D8 silver)",value:f[y]||"",onChange:E=>p(y,"description",E.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})]},y))})]})]})},dB=({entry:e,onChange:t})=>{const{skills:r,loading:n,error:s}=$E(),[i,l]=w.useState(!1),[o,u]=w.useState(!1),[c,d]=w.useState({}),h=w.useCallback(()=>{if(n||!r||r.length===0)return;u(!0);const g=e.requirement;let y={};if(bg(g))y=g,console.log("AbilityForm: Initial requirement is already name-based:",g);else if(yb(g)){console.log("AbilityForm: Initial requirement is UUID-based, converting:",g);const E=new Map(r.map(x=>[x.id,x.name]));for(const[x,b]of Object.entries(g)){const v=E.get(x);v?y[v]=b:console.warn(`AbilityForm: Could not find skill name for UUID ${x} during initialization.`)}console.log("AbilityForm: Converted to name-based requirements:",y)}else typeof g=="string"||g===null||g===void 0?(console.log("AbilityForm: Initial requirement is simple string, null, or undefined:",g),y={}):(console.warn("AbilityForm: Unrecognized requirement format during initialization:",g),y={});d(y),u(!1)},[e.requirement,r,n]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{t("requirement",c)},[c,t]);const f=(g,y)=>{typeof g=="string"&&d(E=>{const x={...E};return y?x.hasOwnProperty(g)||(x[g]=null):delete x[g],x})},p=(g,y)=>{if(typeof g!="string")return;const E=y===""?null:parseInt(y,10);c.hasOwnProperty(g)&&d(x=>({...x,[g]:isNaN(E)?null:E}))};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{id:"ability-name",type:"text",value:e.name||"",onChange:g=>t("name",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{id:"ability-description",value:e.description||"",onChange:g=>t("description",g.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-willpower_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Willpower Cost"}),a.jsx("input",{id:"ability-willpower_cost",type:"number",value:e.willpower_cost===null||e.willpower_cost===void 0?"":e.willpower_cost,onChange:g=>t("willpower_cost",g.target.value===""?null:parseInt(g.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-profession",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profession (Optional)"}),a.jsx("input",{id:"ability-profession",type:"text",value:e.profession||"",onChange:g=>t("profession",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain profession."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-kin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kin (Optional)"}),a.jsx("input",{id:"ability-kin",type:"text",value:e.kin||"",onChange:g=>t("kin",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain kin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Requirements (Optional)"}),a.jsxs("details",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden",open:i,onToggle:g=>l(g.target.open),children:[a.jsx("summary",{className:"px-3 py-2 cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-t-md",children:Object.keys(c).length>0?`${Object.keys(c).length} skill(s) selected`:"Select required skills..."}),a.jsx("div",{className:"p-4 border-t border-gray-200 max-h-60 overflow-y-auto",children:n||o?a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx($e,{size:"md"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading skills..."})]}):s?a.jsx(Ie,{message:`Error loading skills: ${s}`}):r.length===0?a.jsx("p",{className:"text-gray-500",children:"No skills available."}):a.jsx("ul",{className:"space-y-2",children:r.map(g=>{const y=g.name,E=c.hasOwnProperty(y),x=c[y];return a.jsxs("li",{className:"flex items-center space-x-3",children:[" ",a.jsx("input",{id:`skill-req-${g.id}`,type:"checkbox",checked:E,onChange:b=>f(y,b.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`skill-req-${g.id}`,className:"flex-1 text-sm text-gray-700",children:[g.name," ",g.attribute?`(${g.attribute})`:""]}),E&&a.jsx("input",{type:"number",min:"1",placeholder:"Level (Opt.)",value:x??"",onChange:b=>p(y,b.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500"})]},g.id)})})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select skills required for this ability and optionally specify a minimum level. Requirements are now stored by skill name."}),typeof e.requirement=="string"&&e.requirement&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:a.jsxs("p",{className:"text-xs text-yellow-700",children:[a.jsx("strong",{children:"Note:"}),' This ability has a non-skill requirement text: "',e.requirement,'". Saving will overwrite this if skills are selected above.']})}),yb(e.requirement)&&o&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded",children:a.jsx("p",{className:"text-xs text-orange-700",children:"Attempting to convert legacy UUID-based requirements..."})})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]})};function y_(e){return typeof e!="object"||e===null||!e.type?!1:e.type==="logical"?(e.operator==="AND"||e.operator==="OR")&&Array.isArray(e.conditions)&&e.conditions.every(y_):["spell","school","skill","attribute"].includes(e.type)?typeof e.name=="string":e.type==="anySchool"}function hB({entry:e,onChange:t,magicSchools:r=[]}){const[n,s]=w.useState(""),[i,l]=w.useState(null);w.useEffect(()=>{if(e.prerequisite)try{typeof e.prerequisite=="object"&&e.prerequisite!==null?s(JSON.stringify(e.prerequisite,null,2)):typeof e.prerequisite=="string"&&(JSON.parse(e.prerequisite),s(JSON.stringify(JSON.parse(e.prerequisite),null,2)))}catch{s(e.prerequisite)}else s("")},[e.prerequisite]);const o=c=>{const d=c.target.value;if(s(d),d.trim()===""){t("prerequisite",null),l(null);return}try{const h=JSON.parse(d);y_(h)?(t("prerequisite",JSON.stringify(h)),l(null)):l("Invalid prerequisite JSON structure. Please check the format.")}catch{l("Invalid JSON. Please ensure correct JSON syntax.")}},u=c=>{const{name:d,value:h,type:f}=c.target;let p=h;f==="number"&&c.target instanceof HTMLInputElement&&(p=h===""?null:parseInt(h,10),isNaN(p)&&(p=null)),d==="school_id"&&h===""&&(p=null),t(d,p)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("input",{type:"text",name:"name",id:"name",value:e.name||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),a.jsx("textarea",{name:"description",id:"description",rows:3,value:e.description||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"school_id",className:"block text-sm font-medium text-gray-700",children:"Magic School"}),a.jsxs("select",{name:"school_id",id:"school_id",value:e.school_id||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white",children:[a.jsx("option",{value:"",children:"General"}),r.map(c=>a.jsx("option",{value:c.id,children:c.name},c.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rank",className:"block text-sm font-medium text-gray-700",children:"Rank (0 for Trick)"}),a.jsx("input",{type:"number",name:"rank",id:"rank",min:"0",max:"5",value:e.rank??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"casting_time",className:"block text-sm font-medium text-gray-700",children:"Casting Time"}),a.jsx("input",{type:"text",name:"casting_time",id:"casting_time",value:e.casting_time||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"range",className:"block text-sm font-medium text-gray-700",children:"Range"}),a.jsx("input",{type:"text",name:"range",id:"range",value:e.range||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),a.jsx("input",{type:"text",name:"duration",id:"duration",value:e.duration||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"willpower_cost",className:"block text-sm font-medium text-gray-700",children:"Willpower Cost"}),a.jsx("input",{type:"number",name:"willpower_cost",id:"willpower_cost",min:"0",value:e.willpower_cost??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"prerequisite",className:"block text-sm font-medium text-gray-700",children:"Learning Prerequisite (JSON or leave empty)"}),a.jsx("textarea",{name:"prerequisite",id:"prerequisite",rows:6,value:n,onChange:o,placeholder:'JSON for learning, e.g., {"type": "spell", "name": "Light"}. Leave empty for no prerequisite.',className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 focus:outline-none sm:text-sm ${i?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),i&&a.jsx("p",{className:"mt-2 text-sm text-red-600",children:i}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Use JSON format for learning prerequisites. Examples: ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "anySchool"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "spell", "name": "Example Spell"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "logical", "operator": "AND", "conditions": [...]}'})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"requirement",className:"block text-sm font-medium text-gray-700",children:"Casting Requirement (Text or leave empty)"}),a.jsx("textarea",{name:"requirement",id:"requirement",rows:3,value:e.requirement||"",onChange:u,placeholder:"e.g., Requires a free hand, or Verbal component only. Leave empty if none.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe any requirements for casting the spell (e.g., components, conditions)."})]})]})}const fB=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Name"}),a.jsx("input",{id:"skill-name",type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx("textarea",{id:"skill-description",value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[a.jsx("input",{id:"is_magic_skill",type:"checkbox",checked:e.is_magic||!1,onChange:r=>t("is_magic",r.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"is_magic_skill",className:"text-sm font-medium text-gray-900",children:"Is this a magic skill?"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Check if this skill is related to magic or spellcasting."})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-attribute",className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute (Optional)"}),a.jsx("input",{id:"skill-attribute",type:"text",value:e.attribute||"",onChange:r=>t("attribute",r.target.value||null),placeholder:"e.g., STR, AGL, WIL...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The primary attribute associated with this skill."})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]}),mB=["Small","Normal","Large","Huge","Swarm"],H1=()=>({FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0}),pB=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:"",effects:[]}),gB=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:""});function xB({entry:e,onChange:t}){const[r,n]=w.useState({...e,stats:e.stats||H1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))});w.useEffect(()=>{n({...e,stats:e.stats||H1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))})},[e]);const s=w.useCallback((f,p)=>{const g={...r,[f]:p};n(g),t(f,p)},[r,t]),i=w.useCallback((f,p)=>{const g={...r.stats,[f]:p};s("stats",g)},[r.stats,s]),l=w.useCallback(()=>{const f=[...r.attacks,pB()];s("attacks",f)},[r.attacks,s]),o=w.useCallback((f,p,g)=>{const y=[...r.attacks];y[f]={...y[f],[p]:g},s("attacks",y)},[r.attacks,s]),u=w.useCallback(f=>{const p=r.attacks.filter((g,y)=>y!==f);s("attacks",p)},[r.attacks,s]),c=w.useCallback(f=>{const p=[...r.attacks];p[f].effects=[...p[f].effects||[],gB()],s("attacks",p)},[r.attacks,s]),d=w.useCallback((f,p,g,y)=>{const E=[...r.attacks];E[f].effects&&(E[f].effects[p]={...E[f].effects[p],[g]:y},s("attacks",E))},[r.attacks,s]),h=w.useCallback((f,p)=>{const g=[...r.attacks];g[f].effects&&(g[f].effects=g[f].effects.filter((y,E)=>E!==p),s("attacks",g))},[r.attacks,s]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:f=>s("name",f.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:r.category||"",onChange:f=>s("category",f.target.value),placeholder:"e.g., Beast, Undead, Humanoid",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:r.description||"",onChange:f=>s("description",f.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Statistics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferocity"}),a.jsx("input",{type:"number",value:r.stats.FEROCITY,onChange:f=>i("FEROCITY",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),a.jsx("select",{value:r.stats.SIZE,onChange:f=>i("SIZE",f.target.value),className:"w-full px-3 py-2 border rounded-md",children:mB.map(f=>a.jsx("option",{value:f,children:f},f))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movement"}),a.jsx("input",{type:"number",value:r.stats.MOVEMENT,onChange:f=>i("MOVEMENT",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor"}),a.jsx("input",{type:"number",value:r.stats.ARMOR,onChange:f=>i("ARMOR",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HP"}),a.jsx("input",{type:"number",value:r.stats.HP,onChange:f=>i("HP",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effects Summary"}),a.jsx("textarea",{value:r.effectsSummary||"",onChange:f=>s("effectsSummary",f.target.value),rows:3,placeholder:"Describe any special effects or abilities here...",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attacks (D6 Rollable Table)"}),a.jsx(U,{variant:"secondary",size:"sm",icon:Pd,onClick:l,children:"Add Attack"})]}),r.attacks.length===0&&a.jsx("p",{className:"text-gray-500",children:'No attacks defined. Click "Add Attack" to create one.'}),r.attacks.map((f,p)=>a.jsxs("div",{className:"p-3 border rounded-md mb-4 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-2",children:[a.jsx("input",{type:"text",placeholder:"Roll Values (e.g., 1, 2-3)",value:f.roll_values,onChange:g=>o(p,"roll_values",g.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"text",placeholder:"Attack Name",value:f.name,onChange:g=>o(p,"name",g.target.value),className:"md:col-span-2 px-3 py-2 border rounded-md"})]}),a.jsx("textarea",{placeholder:"Attack Description",value:f.description,onChange:g=>o(p,"description",g.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsxs("div",{className:"ml-4 mt-2 p-3 border-l-2 border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Effects (Optional D6 Table)"}),a.jsx(U,{variant:"outline",size:"xs",icon:Pd,onClick:()=>c(p),children:"Add Effect"})]}),f.effects.length===0&&a.jsx("p",{className:"text-gray-500",children:'No effects for this attack. Click "Add Effect" to create one.'}),f.effects.map((g,y)=>a.jsxs("div",{className:"p-2 border rounded-md mb-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-1",children:[a.jsx("input",{type:"text",placeholder:"Roll (e.g., 1-2)",value:g.roll_values,onChange:E=>d(p,y,"roll_values",E.target.value),className:"px-2 py-1 border rounded-md text-sm"}),a.jsx("input",{type:"text",placeholder:"Effect Name",value:g.name,onChange:E=>d(p,y,"name",E.target.value),className:"md:col-span-2 px-2 py-1 border rounded-md text-sm"})]}),a.jsx("textarea",{placeholder:"Effect Description",value:g.description,onChange:E=>d(p,y,"description",E.target.value),rows:1,className:"w-full px-2 py-1 border rounded-md text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(U,{variant:"danger",size:"xs",icon:cr,onClick:()=>h(p,y),children:"Remove Effect"})})]},g.id))]}),a.jsx("div",{className:"text-right",children:a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>u(p),children:"Remove Attack"})})]},f.id))]})]})}const om=({title:e,items:t,onAdd:r,onRemove:n,onUpdate:s})=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),t.map((i,l)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:i,onChange:o=>s(l,o.target.value),className:"w-full px-3 py-2 border rounded-md flex-grow",placeholder:`Enter ${e.replace(/s$/,"").toLowerCase()}...`}),a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>n(l),"aria-label":`Remove ${e.slice(0,-1)}`})]},l)),a.jsxs(U,{variant:"secondary",size:"sm",icon:Jt,onClick:r,children:["Add ",e.replace(/s$/,"")]})]}),yB=({entry:e,onChange:t})=>{const r=(n,s,i,l)=>{const o=[...e[n]||[]];switch(s){case"add":o.push("");break;case"remove":i!==void 0&&o.splice(i,1);break;case"update":i!==void 0&&l!==void 0&&(o[i]=l);break}t(n,o)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio-name",className:"block text-sm font-medium text-gray-700",children:"Set Name"}),a.jsx("input",{id:"bio-name",type:"text",value:e.name||"",onChange:n=>t("name",n.target.value),className:"mt-1 w-full px-3 py-2 border rounded-md",placeholder:"e.g., General, Human Commoner, Elven Ranger"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"A unique name for this collection of bio options."})]}),a.jsx(om,{title:"Appearance Options",items:e.appearance||[],onAdd:()=>r("appearance","add"),onRemove:n=>r("appearance","remove",n),onUpdate:(n,s)=>r("appearance","update",n,s)}),a.jsx(om,{title:"Mementos",items:e.mementos||[],onAdd:()=>r("mementos","add"),onRemove:n=>r("mementos","remove",n),onUpdate:(n,s)=>r("mementos","update",n,s)}),a.jsx(om,{title:"Flaws / Weak Spots",items:e.flaws||[],onAdd:()=>r("flaws","add"),onRemove:n=>r("flaws","remove",n),onUpdate:(n,s)=>r("flaws","update",n,s)})]})};function bB(e){const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),[o,u]=w.useState(e),c=w.useCallback(g=>{switch(g){case"spells":return"game_spells";case"items":return"game_items";case"abilities":return"heroic_abilities";case"kin":return"kin";case"profession":return"professions";case"skills":return"game_skills";case"monsters":return"monsters";case"bio":return"bio_data";default:throw console.error(`Invalid data category passed to getTableName: ${g}`),new Error(`Invalid data category: ${g}`)}},[]),d=w.useCallback(async g=>{s(!0),l(null);let y;try{y=c(g),console.log(`[useGameData] Attempting to load category: ${g}, using table: ${y}`);let E=te.from(y);g==="spells"?E=E.select(`
                *,
                magic_schools ( name )
              `):E=E.select("*"),E=E.order("name"),console.log(`[useGameData] Executing query for table: ${y}`);const{data:x,error:b}=await E;if(b)throw console.error(`[useGameData] Supabase fetch error for ${y}:`,b),b;const v=(x||[]).map(_=>{var S;let k={..._};if(g==="spells"&&(k.magic_schools=(S=_.magic_schools)==null?void 0:S.name),g==="abilities"&&typeof _.requirement=="string")try{k.requirement=JSON.parse(_.requirement)}catch{}return k});console.log(`[useGameData] Loaded ${v.length} entries for ${g} from ${y}`),r(v)}catch(E){const x=y||g;console.error(`[useGameData] Error in loadEntries for ${x}:`,E);const b=(E==null?void 0:E.message)||`Failed to load ${x}`,v=E!=null&&E.details?`: ${E.details}`:"";l(`${b}${v}`),r([])}finally{s(!1)}},[c]),h=w.useCallback(async(g,y,E,x)=>{let b="";try{x(null),s(!0),b=c(g);const{id:v,..._}=y;let k={..._};if(!k.name||String(k.name).trim()==="")throw new Error(`Cannot save ${g} without a name.`);if(g==="abilities"&&(k.willpower_cost=k.willpower_cost===""||k.willpower_cost===void 0?null:Number(k.willpower_cost),typeof k.requirement=="object"&&k.requirement!==null?Object.keys(k.requirement).length>0?k.requirement=JSON.stringify(k.requirement):k.requirement=null:(k.requirement===""||k.requirement===void 0)&&(k.requirement=null),k.kin=k.kin||null,k.profession=k.profession||null),g==="spells"&&(k.rank=Number(k.rank??0),k.willpower_cost=Number(k.willpower_cost??0),k.school_id=k.school_id||null,k.requirement=k.requirement||null),g==="skills"&&(k.attribute=k.attribute||null),g==="monsters"){const j=y;if(k.stats=j.stats||{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0},k.attacks=j.attacks||[],Array.isArray(k.attacks)&&(k.attacks=k.attacks.map(P=>{const{id:T,effects:H,...O}=P;return Array.isArray(H)&&(O.effects=H.map(q=>{const{id:G,...$}=q;return $})),O})),!v){const{data:P,error:T}=await te.auth.getSession();if(T||!P.session)throw new Error("User not authenticated. Cannot save monster.");k.created_by=P.session.user.id}}console.log(`[useGameData] Saving entry to ${b} (ID: ${v||"new"}):`,k);let S=null,I=null;if(v){const{data:j,error:P}=await te.from(b).update(k).eq("id",v).select().single();S=P,I=j}else{const{data:j,error:P}=await te.from(b).insert([k]).select().single();S=P,I=j}if(S)throw console.error(`[useGameData] Supabase Save Error (${b}):`,S),S;I?(console.log(`[useGameData] Save operation successful for ${g} (ID: ${I.id})`),E(I)):(console.warn(`[useGameData] Save operation for ${g} (ID: ${v||"new"}) did not return data. Using input data for callback.`),E({...y,id:v||(I==null?void 0:I.id)})),await d(g)}catch(v){const _=b||g,k=(v==null?void 0:v.message)||(typeof v=="string"?v:"An unexpected error occurred during save."),S=v!=null&&v.details?` (Details: ${v.details})`:"",I=v!=null&&v.code?` (Code: ${v.code})`:"",j=`Error saving ${_}: ${k}${S}${I}`;console.error(`[useGameData] Error in handleSave for ${_}:`,v),x(j)}finally{s(!1)}},[c,d]),f=w.useCallback(async(g,y)=>{if(!window.confirm(`Are you sure you want to delete this ${g} entry (ID: ${y})? This action cannot be undone.`))return;let E="";try{l(null),s(!0),E=c(g),console.log(`[useGameData] Deleting entry from ${E}, ID: ${y}`);const{error:x}=await te.from(E).delete().eq("id",y);if(x)throw console.error(`[useGameData] Error deleting from ${E}:`,x),x;console.log(`[useGameData] Delete successful for ID: ${y} in ${g}`),await d(g)}catch(x){const b=E||g,v=(x==null?void 0:x.message)||"An unexpected error occurred during deletion.",_=x!=null&&x.details?` (Details: ${x.details})`:"",k=x!=null&&x.code?` (Code: ${x.code})`:"",S=`Error deleting ${b}: ${v}${_}${k}`;console.error(`[useGameData] Error in handleDelete for ${b}:`,x),l(S)}finally{s(!1)}},[c,d]),p=w.useCallback(g=>{console.log(`[useGameData] Switching category from ${o} to ${g}`),u(g),d(g)},[o,d]);return w.useEffect(()=>{console.log(`[useGameData] Initial load effect for category: ${e}`);try{c(e),d(e)}catch(g){console.error(`[useGameData] Invalid initial category: ${e}`,g),l(`Invalid initial category: ${e}`),s(!1)}},[e,c,d]),{entries:t,loading:n,error:i,activeCategory:o,switchCategory:p,handleSave:h,handleDelete:f}}const vB=[{id:"items",label:"Items",icon:ui},{id:"spells",label:"Spells",icon:Md},{id:"abilities",label:"Abilities",icon:bs},{id:"kin",label:"Kin",icon:Cn},{id:"profession",label:"Professions",icon:n4},{id:"skills",label:"Skills",icon:j4},{id:"monsters",label:"Monsters",icon:Dd},{id:"bio",label:"Bio Options",icon:t4}],$1=e=>{try{if(bg(e)){const t=Object.entries(e);return t.length===0?"None":t.map(([r,n])=>`${r}${n!==null?` (Lvl ${n})`:""}`).join(", ")||"None"}if(typeof e=="string"&&e)return e;if(typeof e=="object"&&e!==null){const t=Object.keys(e);if(t.length>0)return/^[0-9a-fA-F]{8}-/.test(t[0])?`${t.length} skill(s) (Legacy UUIDs)`:t.length===1&&typeof e[t[0]]=="object"?`Requirement: ${t[0]} (Invalid Format)`:`${t.length} requirement(s) (Unknown format)`}return"None"}catch(t){return console.error("Error formatting requirement:",e,t),"Error: Invalid Format"}};function b_(){const[e,t]=w.useState(null),[r,n]=w.useState(""),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,p]=w.useState([]),{entries:g,loading:y,error:E,handleSave:x,handleDelete:b,switchCategory:v,activeCategory:_}=bB("items"),k=w.useCallback(async()=>{const{data:L,error:Q}=await te.from("game_items").select("category");Q?console.error("Error fetching item categories:",Q):L&&c([...new Set(L.map(N=>N.category).filter(Boolean))])},[]),S=w.useCallback(async()=>{const{data:L,error:Q}=await te.from("magic_schools").select("id, name").order("name");Q?console.error("Error fetching magic schools:",Q):L&&h(L)},[]),I=w.useCallback(async()=>{const{data:L,error:Q}=await te.from("monsters").select("category");Q?console.error("Error fetching monster categories:",Q):L&&p([...new Set(L.map(N=>N.category).filter(Boolean))])},[]);w.useEffect(()=>{o(""),_==="items"?k():_==="spells"?S():_==="monsters"&&I()},[_,k,S,I]);const j=w.useCallback(L=>{t(null),i(null),_==="items"&&k(),_==="monsters"&&I()},[_,k,I]),P=w.useCallback(async()=>{e&&await x(_,e,j,i)},[e,_,x,j]),T=w.useCallback(async L=>{L&&(await b(_,L),_==="items"&&k(),_==="monsters"&&I())},[_,b,k,I]),H=w.useCallback((L,Q)=>{t(N=>N?{...N,[L]:Q}:null)},[]),O=w.useCallback(()=>{i(null);let L={name:""};switch(_){case"spells":L={...L,description:"",rank:1,school_id:null,casting_time:"",range:"",duration:"",willpower_cost:0};break;case"items":L={...L,description:"",category:"",cost:0,weight:0};break;case"abilities":L={...L,description:"",willpower_cost:null,requirement:{},profession:null,kin:null};break;case"kin":L={...L,description:"",key_attribute:"",typical_profession:"",kin_abilities:[]};break;case"profession":L={...L,description:"",key_attribute:"",skills:[]};break;case"skills":L={...L,description:"",attribute:null};break;case"monsters":L={name:"",description:"",category:"",stats:{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:10},attacks:[]};break;case"bio":L={name:"",appearance:[],mementos:[],flaws:[]};break}t(L)},[_]),q=w.useCallback(()=>{if(!e)return null;switch(_){case"spells":return a.jsx(hB,{entry:e,onChange:H,magicSchools:d});case"items":return a.jsx(oB,{entry:e,onChange:H});case"abilities":return a.jsx(dB,{entry:e,onChange:H});case"kin":return a.jsx(uB,{entry:e,onChange:H});case"profession":return a.jsx(cB,{entry:e,onChange:H});case"skills":return a.jsx(fB,{entry:e,onChange:H});case"monsters":return a.jsx(xB,{entry:e,onChange:H});case"bio":return a.jsx(yB,{entry:e,onChange:H});default:return a.jsx("p",{children:"No form available for this category."})}},[e,_,H,d]),G=w.useMemo(()=>g.filter(L=>{var N,K,Y,A;if(!((N=L.name)==null?void 0:N.toLowerCase().includes(r.toLowerCase())))return!1;if(l){if(_==="items")return((K=L.category)==null?void 0:K.toLowerCase())===l.toLowerCase();if(_==="spells"){const me=(Y=L.magic_schools)==null?void 0:Y.name;return l==="General"?!me:(me==null?void 0:me.toLowerCase())===l.toLowerCase()}if(_==="monsters")return((A=L.category)==null?void 0:A.toLowerCase())===l.toLowerCase()}return!0}),[g,r,l,_]),$=w.useCallback(()=>{t(null),i(null)},[]),z=w.useMemo(()=>_==="items"?u.sort():_==="spells"?["General",...d.map(L=>L.name)].sort():_==="monsters"?f.sort():[],[_,u,d,f]),B=w.useMemo(()=>{const L=[{header:"Name",accessor:N=>N.name}],Q="text-sm text-gray-600 max-w-xs truncate";switch(_){case"spells":return[...L,{header:"School",accessor:N=>{var K;return((K=N.magic_schools)==null?void 0:K.name)||"General"}},{header:"Rank",accessor:N=>N.rank===0?"Trick":`Rank ${N.rank}`},{header:"WP Cost",accessor:N=>`${N.willpower_cost} WP`}];case"items":return[...L,{header:"Category",accessor:N=>N.category},{header:"Cost",accessor:N=>N.cost},{header:"Weight",accessor:N=>N.weight}];case"abilities":return[...L,{header:"WP Cost",accessor:N=>N.willpower_cost??"N/A"},{header:"Requirement",accessor:N=>$1(N.requirement),className:Q,titleAccessor:N=>$1(N.requirement)}];case"kin":return[...L,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Typical Profession",accessor:N=>N.typical_profession}];case"profession":return[...L,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Skills",accessor:N=>Array.isArray(N.skills)?N.skills.join(", "):"",className:Q}];case"skills":return[...L,{header:"Attribute",accessor:N=>N.attribute||"N/A"},{header:"Description",accessor:N=>N.description,className:Q,titleAccessor:N=>N.description||""}];case"monsters":return[...L,{header:"Category",accessor:N=>N.category},{header:"HP",accessor:N=>{var K;return(K=N.stats)==null?void 0:K.HP}},{header:"Armor",accessor:N=>{var K;return(K=N.stats)==null?void 0:K.ARMOR}},{header:"Size",accessor:N=>{var K;return(K=N.stats)==null?void 0:K.SIZE}}];case"bio":return[...L,{header:"Appearance",accessor:N=>`${(N.appearance||[]).length} options`},{header:"Mementos",accessor:N=>`${(N.mementos||[]).length} options`},{header:"Flaws",accessor:N=>`${(N.flaws||[]).length} options`}];default:return L}},[_]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Game Data Management"}),a.jsx(U,{variant:"primary",icon:Jt,onClick:O,disabled:y,children:"Add Entry"})]}),E&&a.jsx(Ie,{message:`Error loading data: ${E}`}),a.jsx("div",{className:"flex gap-4 border-b overflow-x-auto pb-2",children:vB.map(({id:L,label:Q,icon:N})=>a.jsxs("button",{onClick:()=>v(L),className:`px-4 py-2 font-medium flex items-center gap-2 whitespace-nowrap ${_===L?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:y,children:[a.jsx(N,{className:"w-5 h-5"}),Q]},L))}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:`Search ${_}...`,value:r,onChange:L=>n(L.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg",disabled:y})]}),z.length>0&&a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-48",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:l,onChange:L=>o(L.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",disabled:y,children:[a.jsxs("option",{value:"",children:["All ",_==="spells"?"Schools":"Categories"]}),z.map(L=>a.jsx("option",{value:L,children:L},L))]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),y&&!g.length?a.jsxs("p",{className:"text-center py-4",children:["Loading ",_,"..."]}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[B.map(L=>a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:L.header},L.header)),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:G.map(L=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[B.map(Q=>a.jsx("td",{className:`px-4 py-2 align-top ${Q.className||""}`,title:Q.titleAccessor?Q.titleAccessor(L):void 0,children:Q.accessor(L)},Q.header)),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:Qu,onClick:()=>{i(null),t(L)},disabled:!L.id,children:"Edit"}),a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>L.id&&T(L.id),disabled:!L.id||y,children:"Delete"})]})})]},L.id||L.name))})]}),G.length===0&&!y&&!E&&a.jsx("p",{className:"text-center text-gray-500 py-4",children:r||l?`No ${_} found matching filters.`:`No entries for '${_}'.`})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white py-2 z-10 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.id?`Edit ${_}`:`New ${_}`}),a.jsx("button",{onClick:$,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),s&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:s})}),a.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:q()}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6 sticky bottom-0 bg-white py-3 z-10 border-t",children:[a.jsx(U,{variant:"secondary",onClick:$,disabled:y,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:tr,onClick:P,disabled:y,children:y?"Saving...":e.id?"Update Entry":"Save Entry"})]})]})})]})}function wB(){const{user:e}=Vt(),[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(""),[h,f]=w.useState(null),[p,g]=w.useState(!1),y=async E=>{E.preventDefault();try{if(!i.trim()||!o.trim()||!c.trim()){f("All fields are required");return}if(!e){f("You must be logged in to create or edit entries");return}if(n){const{error:x}=await te.from("compendium").update({title:i,content:o,category:c}).eq("id",n);if(x)throw x}else{const{error:x}=await te.from("compendium").insert([{title:i,content:o,category:c,created_by:e.id}]);if(x)throw x}l(""),u(""),d(""),r(!1),s(null)}catch(x){f(x instanceof Error?x.message:"Failed to save entry")}};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>g(!1),className:`p-2 rounded-lg ${p?"text-gray-600 hover:bg-gray-100":"bg-blue-100 text-blue-700"}`,children:a.jsx(xE,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>g(!0),className:`p-2 rounded-lg ${p?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(yE,{className:"w-5 h-5"})})]})]}),p?a.jsx("div",{className:"min-h-[300px] p-4 border border-gray-300 rounded-md bg-white overflow-auto",children:a.jsx(Hg,{content:o})}):a.jsx("textarea",{value:o,onChange:E=>u(E.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:`# Heading 1
## Heading 2

Regular text with **bold** and *italic* formatting.

> Blockquote for important notes

| Table | Header |
|--------|---------|
| Cell 1 | Cell 2 |`})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null),l(""),u(""),d(""),g(!1)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(tr,{className:"w-5 h-5"}),n?"Update Entry":"Save Entry"]})]})]})})}function EB(){const[e,t]=w.useState("users"),r=()=>{switch(e){case"users":return a.jsx(eB,{});case"gameData":return a.jsx(b_,{});case"compendium":return a.jsx(wB,{});default:return null}},n=[{key:"users",label:"Users",Icon:yu}];return a.jsxs("div",{className:"",children:[n.length>0&&a.jsx("nav",{className:"border-b",children:a.jsx("ul",{className:"flex -mb-px",children:n.map(({key:s,label:i,Icon:l})=>a.jsx("li",{className:"mr-6",children:a.jsxs("button",{onClick:()=>t(s),className:e===s?"flex items-center py-2 px-4 text-blue-600 border-b-2 border-blue-600 font-semibold":"flex items-center py-2 px-4 text-gray-600 hover:text-gray-800 hover:border-b-2 hover:border-gray-300",children:[a.jsx(l,{className:"w-5 h-5 mr-2"}),i]})},s))})}),a.jsx("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:r()})]})}function z1({children:e,className:t="",onClick:r}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 ${t} ${r?"cursor-pointer":""}`,onClick:r,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:r?n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),r())}:void 0,children:e})}const um=[{id:"profile",label:"Profile Settings",icon:yi,description:"Manage your personal information and account settings"},{id:"appearance",label:"Appearance",icon:k4,description:"Customize the look and feel of the application"},{id:"notifications",label:"Notifications",icon:pE,description:"Configure your notification preferences"},{id:"localization",label:"Localization",icon:vE,description:"Set your language, timezone and regional preferences"},{id:"game-data",label:"Game Data Editor",icon:ui,description:"Edit game data such as spells and items",adminOnly:!0},{id:"admin",label:"Admin Panel",icon:bs,description:"System administration and user management",adminOnly:!0}];function NB(){const{isAdmin:e}=Vt(),[t,r]=w.useState(()=>"profile"),n=i=>{const l=um.find(o=>o.id===i);l&&(!l.adminOnly||e())?r(i):l!=null&&l.adminOnly&&!e()&&(console.warn("Attempted to access admin settings without privileges."),r("profile"))};_n.useEffect(()=>{const i=um.find(l=>l.id===t);i!=null&&i.adminOnly&&!e()&&r("profile")},[t,e]);const s=()=>{switch(t){case"profile":return a.jsx(VU,{});case"appearance":return a.jsx(WU,{});case"notifications":return a.jsx(GU,{});case"localization":return a.jsx(XU,{});case"game-data":return e()?a.jsx(b_,{}):a.jsx(Po,{to:"/settings",replace:!0});case"admin":return e()?a.jsx(EB,{}):a.jsx(Po,{to:"/settings",replace:!0});default:return a.jsx(Po,{to:"/settings",replace:!0})}};return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(kE,{className:"w-8 h-8 text-gray-700"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 md:col-span-4 space-y-4",children:um.filter(i=>!i.adminOnly||e()).map(i=>a.jsx(z1,{onClick:()=>n(i.id),className:`cursor-pointer transition-all ${t===i.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${t===i.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:a.jsx(i.icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium",children:i.label}),a.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),a.jsx(Fa,{className:`w-5 h-5 ${t===i.id?"text-blue-500":"text-gray-400"}`})]})},i.id))}),a.jsx("div",{className:"col-span-12 md:col-span-8",children:a.jsx(z1,{children:s()})})]})]})}function kB(){const[e,t]=w.useState(!0),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState("player"),[f,p]=w.useState(null),[g,y]=w.useState(null),[E,x]=w.useState({}),[b,v]=w.useState(!1),[_,k]=w.useState(navigator.onLine),{signIn:S,signUp:I}=Vt(),j=fn(),P=Sa();w.useEffect(()=>{var $;($=P.state)!=null&&$.message&&(y(P.state.message),j(P.pathname,{replace:!0,state:{}}))},[P,j]),w.useEffect(()=>{const $=()=>k(!0),z=()=>k(!1);return window.addEventListener("online",$),window.addEventListener("offline",z),()=>{window.removeEventListener("online",$),window.removeEventListener("offline",z)}},[]);const T=()=>{n(""),i(""),o(""),c(""),h("player"),p(null),y(null),x({})},H=()=>{t(!e),T()},O=async()=>{const $=UU.safeParse({email:r.trim(),password:s});if(!$.success){const z={};return $.error.errors.forEach(B=>{B.path[0]&&(z[String(B.path[0])]=B.message)}),x(z),p("Please fix the errors in the form."),!1}try{v(!0);const{email:z,password:B}=$.data;return await S(z,B),!0}catch(z){return p(z instanceof Error?z.message:"Login failed. Please try again."),!1}finally{v(!1)}},q=async()=>{const $=BU.safeParse({username:l.trim(),email:r.trim(),password:s,confirmPassword:u,role:d});if(!$.success){const z={};return $.error.errors.forEach(B=>{B.path[0]&&(z[String(B.path[0])]=B.message)}),x(z),p("Please fix the errors in the form."),!1}try{v(!0);const{email:z,password:B,username:L,role:Q}=$.data;return await I(z,B,L,Q),y("Registration successful! Please check your email to verify your account before logging in."),t(!0),T(),n(z),!0}catch(z){return p(z instanceof Error?z.message:"Signup failed. Please try again."),!1}finally{v(!1)}},G=async $=>{if($.preventDefault(),p(null),y(null),x({}),!_){p("No internet connection");return}e?await O():await q()};return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(bs,{className:"mx-auto h-12 w-12 text-blue-600"}),a.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:e?"Log in to DragonBane":"Create your DragonBane Account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e?"Enter your details to access your account":"Fill in the details to register"})]}),!_&&a.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(qt,{className:"h-5 w-5 text-yellow-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No internet connection"}),a.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Please check your internet connection and try again."})]})]})}),f&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(qt,{className:"h-5 w-5 text-red-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:e?"Login Error":"Signup Error"}),a.jsx("p",{className:"mt-2 text-sm text-red-700",children:f})]})]})}),g&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(qt,{className:"h-5 w-5 text-green-400 mr-2"})," ",a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),a.jsx("p",{className:"mt-2 text-sm text-green-700",children:g})]})]})}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:G,noValidate:!0,children:[a.jsxs("div",{className:"space-y-4",children:[!e&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(yi,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,autoComplete:"username",value:l,onChange:$=>o($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.username?"border-red-500":"border-gray-300"}`,placeholder:"Choose a username",disabled:b})]}),E.username&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.username})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(fg,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:r,onChange:$=>n($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address",disabled:b})]}),E.email&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.email})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Bo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:e?"current-password":"new-password",value:s,onChange:$=>i($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password",disabled:b})]}),E.password&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.password})]}),!e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Bo,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,autoComplete:"new-password",value:u,onChange:$=>c($.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password",disabled:b})]}),E.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.confirmPassword})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Register as"}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"player",checked:d==="player",onChange:()=>h("player"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Player"})]}),a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"dm",checked:d==="dm",onChange:()=>h("dm"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Dungeon Master (DM)"})]})]}),E.role&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.role})]})]})]}),a.jsx(U,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:!_||b,icon:e?Sh:yu,iconPosition:"left",children:e?"Log in":"Sign up"})]}),a.jsx("div",{className:"text-sm text-center",children:a.jsx("button",{type:"button",onClick:H,className:"font-medium text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:b,children:e?"Don't have an account? Sign up":"Already have an account? Log in"})})]})})}const q1=({type:e})=>a.jsx("span",{className:"font-semibold text-xs uppercase",children:e}),_B={d4:4,d6:6,d8:8,d10:10,d12:12,d20:20};function V1(e){return Math.floor(Math.random()*_B[e])+1}function SB(){const{showDiceRoller:e,toggleDiceRoller:t,currentConfig:r,dicePool:n,addDie:s,removeLastDie:i,clearDicePool:l,isBoonActive:o,isBaneActive:u,setBoon:c,setBane:d,addRollToHistory:h,rollHistory:f,clearHistory:p}=Zn(),{markSkillInSession:g}=hr(),[y,E]=w.useState([]),[x,b]=w.useState([]),[v,_]=w.useState(null),[k,S]=w.useState(!1),[I,j]=w.useState(void 0),[P,T]=w.useState(!1),H=(r==null?void 0:r.rollMode)==="skillCheck",O=(r==null?void 0:r.rollMode)==="deathRoll",q=(r==null?void 0:r.rollMode)==="rallyRoll",G=(r==null?void 0:r.rollMode)==="recoveryRoll",$=(r==null?void 0:r.rollMode)==="advancementRoll",z=w.useCallback(()=>{if(n.length===0)return;E([]),b([]),_(null),S(!1),j(void 0);const N=n.map(le=>({type:le,value:V1(le)}));let K=[],Y=N.reduce((le,he)=>le+he.value,0),A=Y,me=!1,J,ae=r==null?void 0:r.skillName;if((o||u)&&n.length===1&&n[0]==="d20"){K=[{type:"d20",value:V1("d20")}];const le=N[0].value,he=K[0].value;A=o?Math.min(le,he):Math.max(le,he),Y=A}else n.length===1&&n[0]==="d20"&&(A=N[0].value,Y=A);if(n.length===1&&n[0]==="d20"){const le=A;le===1&&(me=!0,Y="Dragon!",J=!0),le===20&&(me=!0,Y="Demon!",J=!1),(r==null?void 0:r.targetValue)!==void 0&&!me&&(H||q||$||O)&&(J=le<=r.targetValue),H&&ae&&(le===1||le===20)&&g(ae)}else G&&n.length===1&&n[0]==="d6"&&(A=N[0].value,Y=A,J=void 0,me=!1);E(N),b(K),_(Y),S(me),j(J);const Z={description:(r==null?void 0:r.description)||`${n.join(", ")} Roll`,dicePool:[...n],results:N,boonResults:K.length>0?K:void 0,finalOutcome:Y,isBoon:o,isBane:u,targetValue:r==null?void 0:r.targetValue,isSuccess:J,isCritical:me,skillName:ae};h(Z),r!=null&&r.onRollComplete&&r.onRollComplete(Z),r!=null&&r.onRoll&&r.onRoll({total:A})},[n,o,u,r,h,g,G,H,q,$,O]);if(w.useEffect(()=>{e||(E([]),b([]),_(null),S(!1),j(void 0),T(!1))},[e]),!e)return null;const B=()=>r!=null&&r.description?r.description:O?"Death Save (d20 vs CON)":q?"Rally Roll (d20 vs WIL, Bane)":G?"Recovery Roll (1d6 HP)":$?"Advancement Roll (d20 vs Skill)":H?"Skill Check (d20 vs Skill)":"Dice Roller",L=()=>O?a.jsx(Dd,{className:"w-5 h-5"}):q?a.jsx(SE,{className:"w-5 h-5"}):G?a.jsx(hg,{className:"w-5 h-5"}):$?a.jsx(Eo,{className:"w-5 h-5"}):H?a.jsx(ur,{className:"w-5 h-5"}):a.jsx(ur,{className:"w-5 h-5"}),Q=O||q||G||$;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center text-lg font-semibold",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[L()," ",B()]}),a.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-800",children:a.jsx(Dt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:P?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Roll History"}),a.jsxs(U,{onClick:p,variant:"danger",size:"xs",disabled:f.length===0,children:[a.jsx(cr,{className:"w-3 h-3 mr-1"})," Clear"]})]}),f.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No rolls yet."}):a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(N=>a.jsxs("li",{className:"text-xs border-b pb-1",children:[a.jsx("p",{className:"font-medium",children:N.description}),a.jsxs("p",{children:["Pool: ",N.dicePool.join(", ")," ",N.isBoon?"(Boon)":"",N.isBane?"(Bane)":""]}),a.jsxs("p",{children:["Rolls: ",N.results.map(K=>K.value).join(", ")," ",N.boonResults?`| Boon/Bane: ${N.boonResults.map(K=>K.value).join(", ")}`:""]}),a.jsxs("p",{children:["Outcome: ",a.jsx("span",{className:"font-semibold",children:String(N.finalOutcome)}),N.targetValue!==void 0&&` (vs ${N.targetValue})`,N.isSuccess===!0&&a.jsx("span",{className:"text-green-600 ml-1",children:"(Success)"}),N.isSuccess===!1&&a.jsx("span",{className:"text-red-600 ml-1",children:"(Failure)"}),N.isCritical&&a.jsx("span",{className:"text-purple-600 ml-1",children:"(Critical!)"})]}),N.skillName&&a.jsxs("p",{className:"text-gray-500",children:["Skill: ",N.skillName]})]},N.id))})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-3 border rounded bg-gray-50 min-h-[50px] flex flex-wrap gap-2 items-center",children:n.length===0?a.jsx("span",{className:"text-gray-500 italic",children:"Dice pool is empty"}):n.map((N,K)=>a.jsxs("button",{onClick:()=>!Q&&i(),className:`px-2 py-1 border rounded shadow-sm flex items-center ${Q?"bg-gray-300 cursor-not-allowed":"bg-white hover:bg-red-50 hover:border-red-300"}`,title:Q?void 0:"Remove last die",disabled:Q,children:[a.jsx(q1,{type:N}),!Q&&a.jsx(Dt,{className:"w-3 h-3 ml-1 text-red-500"})]},K))}),!Q&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-4",children:["d4","d6","d8","d10","d12","d20"].map(N=>a.jsx(U,{onClick:()=>s(N),variant:"outline",size:"sm",className:"flex justify-center items-center",children:a.jsx(q1,{type:N})},N))}),n.length===1&&n[0]==="d20"&&!Q&&a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsxs(U,{onClick:()=>c(!o),variant:o?"success":"outline",size:"sm",className:`flex items-center ${o?"ring-2 ring-green-400 ring-offset-1":""}`,children:[a.jsx(Th,{className:`w-4 h-4 mr-1 ${o?"text-white":"text-green-500"}`})," Boon"]}),a.jsxs(U,{onClick:()=>d(!u),variant:u?"danger":"outline",size:"sm",className:`flex items-center ${u?"ring-2 ring-red-400 ring-offset-1":""}`,children:[a.jsx(I4,{className:`w-4 h-4 mr-1 ${u?"text-white":"text-red-500"}`})," Bane"]})]}),y.length>0&&a.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50 border-blue-200 text-center",children:[a.jsxs("p",{className:"text-sm text-blue-700 mb-1",children:["Rolled: ",y.map(N=>N.value).join(", "),x.length>0&&` | Boon/Bane: ${x.map(N=>N.value).join(", ")}`]}),a.jsx("p",{className:`text-2xl font-bold ${k?"text-purple-600":"text-blue-900"}`,children:String(v)}),(r==null?void 0:r.targetValue)!==void 0&&!k&&a.jsxs("p",{className:"text-sm text-gray-600",children:["(Target: ",r.targetValue,")"]}),I===!0&&!k&&a.jsx("p",{className:"text-green-600 font-semibold mt-1",children:"Success!"}),I===!1&&!k&&a.jsx("p",{className:"text-red-600 font-semibold mt-1",children:"Failure!"})]})]})}),a.jsxs("div",{className:"p-4 border-t flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{children:[a.jsxs(U,{onClick:()=>T(!P),variant:"secondary",size:"sm",children:[a.jsx(f4,{className:"w-4 h-4 mr-1"})," ",P?"Roller":"History"]}),!P&&!Q&&a.jsxs(U,{onClick:l,variant:"ghost",size:"sm",className:"ml-2 text-red-600 hover:bg-red-100",disabled:n.length===0,children:[a.jsx(cr,{className:"w-4 h-4 mr-1"})," Clear Pool"]})]}),!P&&a.jsxs(U,{onClick:z,disabled:n.length===0,size:"lg",children:[a.jsx(ur,{className:"w-5 h-5 mr-2"})," Roll"]})]})]})})}function TB({children:e}){const{user:t}=Vt(),r=Sa();return t?a.jsx(a.Fragment,{children:e}):a.jsx(Po,{to:"/login",state:{from:r},replace:!0})}function CB({textToCopy:e}){const[t,r]=w.useState(!1),n=async()=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Failed to copy text: ",s)}};return a.jsx(U,{variant:"ghost",size:"icon",onClick:n,"aria-label":t?"Copied":"Copy to clipboard",children:t?a.jsx(tl,{className:"w-5 h-5 text-green-500"}):a.jsx(cg,{className:"w-5 h-5 text-gray-500"})})}function jB({partyId:e,isDM:t}){const{user:r}=Vt(),[n,s]=w.useState([]),[i,l]=w.useState([]),[o,u]=w.useState(null),[c,d]=w.useState(!1),[h,f]=w.useState(null),[p,g]=w.useState(""),[y,E]=w.useState(""),[x,b]=w.useState(""),[v,_]=w.useState("all"),[k,S]=w.useState(""),[I,j]=w.useState(!0),[P,T]=w.useState(null),[H,O]=w.useState(null),q=w.useCallback(()=>{g(""),E(""),b(v==="all"?"":v),O(null)},[v]),G=()=>{q(),d(!0),f(null),u(null)},$=Y=>{u(Y),f(Y.id),d(!1),g(Y.title),E(Y.content),b(Y.category),O(null)},z=()=>{d(!1),f(null),q(),h&&u(null)},B=w.useCallback(async()=>{if(e){j(!0),T(null);try{const{data:Y,error:A}=await te.from("notes").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(A)throw A;s(Y||[]);const me=Array.from(new Set((Y==null?void 0:Y.map(J=>J.category).filter(Boolean))||[]));l(me)}catch(Y){console.error("Error loading party notes:",Y),T(Y instanceof Error?Y.message:"Failed to load party notes"),s([])}finally{j(!1)}}},[e]);w.useEffect(()=>{B()},[B]);const L=async()=>{if(!r){O("User not authenticated.");return}if(!p.trim()){O("Note title cannot be empty.");return}if(!x.trim()){O("Note category cannot be empty.");return}O(null);const Y={title:p.trim(),content:y||"",category:x.trim(),party_id:e,user_id:r.id,updated_at:new Date().toISOString()};try{let A=null;if(h){const{data:me,error:J}=await te.from("notes").update(Y).eq("id",h).select().single();if(J)throw J;A=me}else{const{updated_at:me,...J}=Y,{data:ae,error:Z}=await te.from("notes").insert([J]).select().single();if(Z)throw Z;A=ae}z(),await B(),A&&u(A)}catch(A){console.error("Error saving note:",A);let me="Failed to save note.";A instanceof Error&&(A.message.includes("RLS")?me="Permission denied. Could not save the note due to security policies.":"code"in A&&A.code==="23505"?me="A note with this title might already exist in this party.":me=`Failed to save note: ${A.message}`),O(me)}},Q=async Y=>{if(window.confirm("Are you sure you want to delete this note?"))try{T(null);const{error:A}=await te.from("notes").delete().eq("id",Y);if(A)throw A;await B(),(o==null?void 0:o.id)===Y&&u(null),h===Y&&z()}catch(A){console.error("Error deleting note:",A),T(A instanceof Error?`Failed to delete note: ${A.message}`:"An unknown error occurred while deleting.")}},N=n.filter(Y=>{const A=Y.title.toLowerCase().includes(k.toLowerCase())||Y.content.toLowerCase().includes(k.toLowerCase()),me=v==="all"||Y.category===v;return A&&me});if(I&&n.length===0&&!e)return a.jsx("div",{className:"p-4",children:a.jsx(Ie,{message:"Party ID is missing. Cannot load notes."})});if(I&&n.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:[" ",a.jsx($e,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading party notes..."})]});const K=c||h;return a.jsxs("div",{className:"flex h-[calc(100vh-150px)] overflow-hidden bg-gray-50",children:[" ",a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Yu,{className:"w-5 h-5 text-indigo-600"}),"Party Notes"]}),a.jsx(U,{variant:"primary",size:"sm",icon:Jt,onClick:G,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:k,onChange:Y=>S(Y.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsxs("select",{id:"category-filter",value:v,onChange:Y=>_(Y.target.value),className:"w-full pl-9 pr-7 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white text-sm","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(Y=>a.jsx("option",{value:Y,children:Y},Y))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Nh,{className:"w-3 h-3 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[P&&!K&&a.jsx("div",{className:"p-3",children:a.jsx(Ie,{message:P,onClose:()=>T(null)})}),N.length>0?N.map(Y=>a.jsxs("div",{onClick:()=>{(!h||h!==Y.id)&&(u(Y),d(!1),f(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(o==null?void 0:o.id)===Y.id&&!K?"bg-indigo-50 border-l-4 border-indigo-500":""} ${h===Y.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:Y.title}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-0.5",children:[a.jsx(Gy,{className:"w-2.5 h-2.5"}),a.jsx("span",{className:"truncate",children:Y.category})]})]},Y.id)):!I&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Al,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),k||v!=="all"?"No notes match filters.":"No notes in this party yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:K?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Edit Party Note":"Create New Party Note"}),a.jsx("button",{onClick:z,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100","aria-label":"Close form",children:a.jsx(Dt,{className:"w-5 h-5"})})]}),H&&a.jsx("div",{className:"mb-4",children:a.jsx(Ie,{message:H,onClose:()=>O(null)})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"note-title",type:"text",value:p,onChange:Y=>g(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{id:"note-category",type:"text",value:x,onChange:Y=>b(Y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Quests, Locations, NPCs",list:"category-suggestions",required:!0}),i.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("datalist",{id:"category-suggestions",children:i.map(Y=>a.jsx("option",{value:Y},Y))}),a.jsxs("select",{value:x,onChange:Y=>b(Y.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white text-sm","aria-label":"Select existing category",children:[a.jsx("option",{value:"",disabled:!0,children:"Select existing..."}),i.map(Y=>a.jsx("option",{value:Y,children:Y},Y))]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"note-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"note-content",value:y,onChange:Y=>E(Y.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your notes here..."})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-3",children:[a.jsx(U,{variant:"secondary",onClick:z,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:tr,onClick:L,disabled:I||!p.trim()||!x.trim(),children:I?"Saving...":h?"Update Note":"Save Note"})]})]}):o?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx(Gy,{className:"w-3 h-3"}),a.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-700",children:o.category})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:Qu,onClick:()=>$(o),children:"Edit"}),a.jsx(U,{variant:"danger_outline",size:"sm",icon:cr,onClick:()=>Q(o.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Hg,{content:o.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(o.created_at).toLocaleDateString(),o.updated_at&&new Date(o.updated_at).getTime()!==new Date(o.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(o.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Al,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a party note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),P&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ie,{message:P,onClose:()=>T(null)})})]})})]})}async function AB(e){if(!e)return console.warn("fetchTasks called without partyId"),[];const{data:t,error:r}=await te.from("party_tasks").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching tasks:",r),new Error(r.message||"Failed to fetch tasks");return t||[]}async function IB(e,t){if(!t)throw new Error("User must be authenticated to create a task.");if(!e.party_id)throw new Error("Party ID is required to create a task.");if(!e.title||e.title.trim()==="")throw new Error("Task title cannot be empty.");const{data:r,error:n}=await te.from("party_tasks").insert({party_id:e.party_id,title:e.title,description:e.description,created_by_user_id:t.id,status:"open"}).select().single();if(n)throw console.error("Error creating task:",n),new Error(n.message||"Failed to create task");if(!r)throw new Error("Task creation did not return data.");return r}async function RB(e,t){if(!e)throw new Error("Task ID is required to update a task.");const r={...t};t.status&&(t.status==="completed"?r.completed_at=new Date().toISOString():t.status==="open"&&(r.completed_at=null));const{data:n,error:s}=await te.from("party_tasks").update(r).eq("id",e).select().single();if(s)throw console.error("Error updating task:",s),new Error(s.message||"Failed to update task");if(!n)throw new Error("Task update did not return data.");return n}async function LB(e){if(!e)throw new Error("Task ID is required to delete a task.");const{error:t}=await te.from("party_tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),new Error(t.message||"Failed to delete task")}function OB(){const e=fn(),{setGlobalError:t}=AE(),r=w.useCallback((i,l)=>{const o=i instanceof Error?i.message:String(i);sl.handleError(i,{action:l==null?void 0:l.action,additionalData:{critical:l==null?void 0:l.critical}}),(l==null?void 0:l.showError)!==!1&&t(o),l!=null&&l.redirect&&e(l.redirect),l!=null&&l.critical&&e("/error",{state:{error:o}})},[e,t]),n=w.useCallback((i,l)=>{sl.handleAuthError(i,{action:l==null?void 0:l.action});const o=i instanceof Error?i.message:String(i);t(o),e((l==null?void 0:l.redirect)||"/login")},[e,t]),s=w.useCallback((i,l)=>{sl.handleNetworkError(i,{action:l==null?void 0:l.action}),t("Network error. Please check your connection and try again."),l!=null&&l.retry&&setTimeout(l.retry,1e3)},[t]);return{handleError:r,handleAuthError:n,handleNetworkError:s}}function PB({partyId:e,isDM:t}){const{user:r}=Vt(),n=hn(),{handleError:s}=OB(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(!1),{data:h,isLoading:f,error:p}=Ut({queryKey:["partyTasks",e],queryFn:()=>AB(e),enabled:!!e}),g=At({mutationFn:k=>IB(k,r),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]}),l(""),u(""),d(!1)},onError:k=>{s(k,{action:"creating task"})}}),y=At({mutationFn:({taskId:k,updates:S})=>RB(k,S),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"updating task"})}}),E=At({mutationFn:k=>LB(k),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"deleting task"})}}),x=k=>{if(k.preventDefault(),!i.trim()){s(new Error("Task title cannot be empty."),{action:"adding task",showError:!0});return}g.mutate({party_id:e,title:i.trim(),description:o.trim()||void 0})},b=k=>{y.mutate({taskId:k.id,updates:{status:k.status==="open"?"completed":"open"}})},v=k=>{window.confirm("Are you sure you want to delete this task?")&&E.mutate(k)},_=k=>t||k.created_by_user_id===(r==null?void 0:r.id);return f?a.jsx($e,{}):p?a.jsx(Ie,{message:`Failed to load tasks: ${p.message}`}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Party Tasks"}),t&&a.jsx(U,{icon:c?void 0:Jt,onClick:()=>d(!c),variant:c?"secondary":"primary",children:c?"Cancel":"Add Task"})]}),t&&c&&a.jsxs("form",{onSubmit:x,className:"p-4 border rounded-lg bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"newTaskTitle",className:"block text-sm font-medium text-gray-700",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"newTaskTitle",value:i,onChange:k=>l(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g., Clear out the goblin cave",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"newTaskDescription",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),a.jsx("textarea",{id:"newTaskDescription",value:o,onChange:k=>u(k.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Any additional details about the task..."})]}),a.jsx(U,{type:"submit",loading:g.isPending,icon:Jt,children:"Add Task"})]}),h&&h.length>0?a.jsx("ul",{className:"space-y-3",children:h.map(k=>{var S;return a.jsxs("li",{className:`p-4 border rounded-lg flex items-start justify-between gap-4 ${k.status==="completed"?"bg-green-50 border-green-200":"bg-white"}`,children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>b(k),loading:y.isPending&&((S=y.variables)==null?void 0:S.taskId)===k.id,className:k.status==="completed"?"text-green-600 hover:text-green-700":"text-gray-400 hover:text-gray-600","aria-label":k.status==="completed"?"Mark as open":"Mark as completed",children:k.status==="completed"?a.jsx(gu,{size:20}):a.jsx(l4,{size:20})}),a.jsx("h3",{className:`text-lg font-medium ${k.status==="completed"?"line-through text-gray-500":""}`,children:k.title})]}),k.description&&a.jsx("p",{className:`mt-1 text-sm ${k.status==="completed"?"text-gray-400":"text-gray-600"}`,children:k.description}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Added on: ",new Date(k.created_at).toLocaleDateString(),k.completed_at&&k.status==="completed"&&a.jsxs("span",{children:[" | Completed on: ",new Date(k.completed_at).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:_(k)&&a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>v(k.id),loading:E.isPending&&E.variables===k.id,className:"text-red-500 hover:text-red-700","aria-label":"Delete task",children:a.jsx(cr,{size:18})})})]},k.id)})}):a.jsxs("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(Ku,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tasks yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t?"Get started by adding a new task for your party.":"The DM hasn't added any tasks yet."}),t&&!c&&a.jsx(U,{onClick:()=>d(!0),className:"mt-4",icon:Jt,children:"Add First Task"})]})]})}function DB({partyId:e,members:t,isDM:r}){var Q;const n=hn(),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null),[d,h]=w.useState(""),[f,p]=w.useState("all"),[g,y]=w.useState(""),[E,x]=w.useState([]),[b,v]=w.useState([]),[_,k]=w.useState(!1),{data:S=[],isLoading:I,error:j}=Ut({queryKey:["gameItems"],queryFn:jh,staleTime:1e3*60*10}),P=N=>{if(N)return S.find(K=>K.name===N)};w.useEffect(()=>{T(),H()},[e]);async function T(){try{o(!0),c(null);const{data:N,error:K}=await te.from("party_inventory").select("*").eq("party_id",e);if(K)throw K;i(N||[])}catch(N){c(N instanceof Error?N.message:"Failed to load inventory"),i([])}finally{o(!1)}}async function H(){try{const{data:N,error:K}=await te.from("party_inventory_log").select("*").eq("party_id",e).order("timestamp",{ascending:!1}).limit(50);if(K)throw K;v(N||[])}catch(N){console.error("Failed to load transaction log:",N),v([])}}const O=async()=>{if(!(!g||E.length===0))try{c(null);const N=t.find(K=>K.id===g);if(!N)throw new Error("Character not found");await Promise.all(E.map(async K=>{const Y=s.find(he=>he.id===K);if(!Y||!Y.name||Y.quantity<1)return;let A;if(Y.quantity>1?{error:A}=await te.from("party_inventory").update({quantity:Y.quantity-1}).eq("id",Y.id):{error:A}=await te.from("party_inventory").delete().eq("id",Y.id),A)throw A;const me=N.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},J=me.inventory||[],ae=P(Y.name);if(ae){const he=J.findIndex(ye=>ye.name===ae.name);if(he>-1)J[he].quantity+=1;else{const ye={...ae,id:void 0,quantity:1,originalName:ae.name};J.push(ye)}}else{console.warn(`Details not found for item: ${Y.name}. Transferring with basic info.`);const he={name:Y.name,quantity:1,originalName:Y.name,description:Y.description,category:Y.category},ye=J.findIndex(Le=>Le.name===he.name);ye>-1?J[ye].quantity+=1:J.push(he)}const{error:Z}=await te.from("characters").update({equipment:{...me,inventory:J}}).eq("id",N.id);if(Z)throw Z;const{error:le}=await te.from("party_inventory_log").insert([{party_id:e,item_name:Y.name,quantity:1,from_type:"party",from_id:e,to_type:"character",to_id:N.id}]);if(le)throw le})),await Promise.all([T(),H(),n.invalidateQueries({queryKey:["character",N.id]}),n.invalidateQueries({queryKey:["party",e]})]),x([])}catch(N){c(N instanceof Error?N.message:"Failed to transfer items"),await T()}},q=async(N,K)=>{try{c(null);const Y=t.find(he=>he.id===N);if(!Y)throw new Error("Character not found");if(!K.name){console.warn("Attempted to transfer an item without a name.");return}const A=Y.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}};let me=A.inventory||[];const J=me.findIndex(he=>he.name===K.name);if(J===-1){console.warn(`Item "${K.name}" not found in character ${N}'s inventory.`);return}me[J].quantity>1?me[J].quantity-=1:me=[...me.slice(0,J),...me.slice(J+1)];const{error:ae}=await te.from("characters").update({equipment:{...A,inventory:me}}).eq("id",Y.id);if(ae)throw ae;const Z=s.find(he=>he.name===K.name);if(Z){const{error:he}=await te.from("party_inventory").update({quantity:Z.quantity+1}).eq("id",Z.id);if(he)throw he}else{const{error:he}=await te.from("party_inventory").insert([{party_id:e,name:K.name,quantity:1,category:K.category||"misc",description:K.description||K.effect}]).select();if(he)throw he}const{error:le}=await te.from("party_inventory_log").insert([{party_id:e,item_name:K.name,quantity:1,from_type:"character",from_id:Y.id,to_type:"party",to_id:e}]);if(le)throw le;await Promise.all([T(),H(),n.invalidateQueries({queryKey:["character",Y.id]}),n.invalidateQueries({queryKey:["party",e]})])}catch(Y){c(Y instanceof Error?Y.message:"Failed to transfer item to party")}},G=s.map(N=>N.category).filter(N=>typeof N=="string"&&N.trim()!==""),$=["all",...new Set(G)],z=s.filter(N=>{const Y=(N.name||"").toLowerCase().includes(d.toLowerCase()),A=f==="all"||N.category===f;return Y&&A}),B=t.find(N=>N.id===g),L=((Q=B==null?void 0:B.equipment)==null?void 0:Q.inventory)??[];return a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 lg:col-span-7",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Party Inventory"}),a.jsx(U,{variant:"secondary",onClick:()=>k(!_),children:_?"Hide History":"Show History"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search items...",value:d,onChange:N=>h(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("select",{value:f,onChange:N=>p(N.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:$.map(N=>a.jsx("option",{value:N,children:N==="all"?"All Categories":N},N))})]})]}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[l?a.jsx($e,{}):u?a.jsx(Ie,{message:u}):z.map(N=>a.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer ${E.includes(N.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-100"}`,onClick:()=>{N.id?x(K=>K.includes(N.id)?K.filter(Y=>Y!==N.id):[...K,N.id]):console.warn("Attempted to select an item without an ID:",N)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:N.name||"Unnamed Item"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",N.quantity]})]}),N.category&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100",children:N.category})]}),N.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:N.description})]},N.id)),!l&&z.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:d||f!=="all"?"No items found matching filters.":"Party inventory is empty."})})]})]})}),a.jsxs("div",{className:"col-span-12 lg:col-span-5",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Transfer Items"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Character"}),a.jsxs("select",{value:g,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Choose a character..."}),t.map(N=>a.jsxs("option",{value:N.id,children:[N.name," (",N.kin," ",N.profession,")"]},N.id))]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsx(U,{variant:"secondary",icon:Eh,disabled:!g||E.length===0,onClick:O,title:"Transfer selected items from Party to Character",children:"To Character"})}),g&&B&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-4",children:[B.name,"'s Inventory"]}),a.jsxs("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded p-2",children:[L.map((N,K)=>a.jsxs("div",{className:"p-2 border-b flex items-center justify-between text-sm",children:[a.jsxs("span",{children:[N.name||"Unnamed Item"," (Qty: ",N.quantity,")"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:hE,onClick:()=>q(g,N),disabled:!N.name,title:N.name?`Transfer ${N.name} to Party`:"Cannot transfer unnamed item",children:"Give"})]},N.id||`${N.name||"unknown"}-${K}`)),L.length===0&&a.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Character inventory is empty."})]})]})]}),_&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transaction History"}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[b.map(N=>{var K,Y;return a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"font-medium",children:[N.item_name||"Unknown Item"," (Qty: ",N.quantity,")"]}),a.jsx("span",{className:"text-gray-500 text-xs",children:new Date(N.timestamp).toLocaleString()})]}),a.jsxs("p",{className:"text-gray-600 text-xs",children:[N.from_type==="party"?"Party":((K=t.find(A=>A.id===N.from_id))==null?void 0:K.name)||"Unknown Char","  ",N.to_type==="party"?"Party":((Y=t.find(A=>A.id===N.to_id))==null?void 0:Y.name)||"Unknown Char"]})]},N.id)}),b.length===0&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:"No transactions recorded yet."})]})]})]})]})}async function MB(){const{data:e,error:t}=await te.from("monsters").select("*").order("name");if(t)throw console.error("Error fetching all monsters:",t),t;return e||[]}function FB(e){const t=hn();w.useEffect(()=>{if(!e)return;const r=[],n=te.channel(`encounter:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"encounters",filter:`id=eq.${e}`},i=>{console.log("Encounter updated:",i),t.invalidateQueries({queryKey:["encounterDetails",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter channel error for ${e}:`,l)});r.push(n);const s=te.channel(`encounter_combatants:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${e}`},i=>{console.log("Encounter combatants changed:",i),t.invalidateQueries({queryKey:["encounterCombatants",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter_combatants:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter combatants channel error for ${e}:`,l)});return r.push(s),()=>{console.log(`Unsubscribing from encounter channels for ${e}`),r.forEach(i=>te.removeChannel(i))}},[e,t])}function W1({description:e,attackName:t}){const{toggleDiceRoller:r}=Zn(),n=/(\d*d\d+)/gi,s=e.split(n);return a.jsx("p",{className:"text-gray-800 mt-1",children:s.map((i,l)=>i.match(n)?a.jsx("button",{className:"font-bold text-blue-600 hover:underline bg-blue-100 px-1 py-0.5 rounded-md mx-0.5",onClick:()=>r==null?void 0:r({dice:i.toLowerCase(),label:`${t} - Damage Roll`}),children:i},l):a.jsx("span",{children:i},l))})}function UB({partyId:e,partyMembers:t,isDM:r}){var qg,Vg,Wg,Gg;const n=hn(),{toggleDiceRoller:s}=Zn(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(null),[h,f]=w.useState(!1),[p,g]=w.useState("details"),[y,E]=w.useState("idle"),[x,b]=w.useState(!1),[v,_]=w.useState(""),[k,S]=w.useState(""),[I,j]=w.useState(""),[P,T]=w.useState(1),[H,O]=w.useState(""),[q,G]=w.useState(""),[$,z]=w.useState({}),[B,L]=w.useState(!1),[Q,N]=w.useState(""),[K,Y]=w.useState(""),[A,me]=w.useState([]),[J,ae]=w.useState(!1),[Z,le]=w.useState(null),[he,ye]=w.useState({}),[Le,De]=w.useState({}),[Qe,Je]=w.useState(null),{data:V,isLoading:Ne,error:ue}=Ut({queryKey:["allEncounters",e],queryFn:()=>U5(e),enabled:!!e}),fe=w.useMemo(()=>c||(V&&V.length>0?V[0].id:null),[c,V]);w.useEffect(()=>{Ne||g(!V||V.length===0?"create":"details")},[V,Ne]);const{data:_e,isLoading:nt,error:at}=Ut({queryKey:["encounterDetails",fe],queryFn:()=>fe?JE(fe):Promise.resolve(null),enabled:!!fe}),{data:pt,isLoading:Wt,error:Gt}=Ut({queryKey:["encounterCombatants",fe],queryFn:()=>fe?yg(fe):Promise.resolve([]),enabled:!!fe}),{data:Rt,isLoading:ee,error:de}=Ut({queryKey:["allMonsters"],queryFn:MB});FB(fe);const je=w.useMemo(()=>new Map((Rt??[]).map(F=>[F.id,F])),[Rt]),xe=w.useMemo(()=>(pt==null?void 0:pt.slice().sort((F,ge)=>{const Re=F.initiative_roll??-1/0,Ke=ge.initiative_roll??-1/0;return Re!==Ke?Ke-Re:(F.display_name??"").localeCompare(ge.display_name??"")}))||[],[pt]),Ae=w.useMemo(()=>xe.find(F=>F.id===Qe),[xe,Qe]);w.useEffect(()=>{if(!xe)return;const F={};xe.forEach(ge=>{F[ge.id]={current_hp:String(ge.current_hp??ge.max_hp??0),current_wp:ge.max_wp!=null?String(ge.current_wp??ge.max_wp??""):void 0,initiative_roll:ge.initiative_roll!=null?String(ge.initiative_roll):""}}),z(F)},[xe]),w.useEffect(()=>{_e&&(N(_e.name),Y(_e.description||""))},[_e]);const Tt=At({mutationFn:F=>eN(e,F.name,F.description),onSuccess:F=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(F.id),g("details"),l(""),u("")}}),Zr=At({mutationFn:B5,onSuccess:(F,ge)=>{n.invalidateQueries({queryKey:["allEncounters",e]}),c===ge&&d(null)}}),Mr=At({mutationFn:({encounterId:F,name:ge})=>H5(F,ge),onSuccess:F=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(F.id)}}),Fr=At({mutationFn:F=>{if(!fe)throw new Error("No active encounter");return $5(fe,F)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",fe]}),_(""),S(""),j(""),T(1),O(""),G(""),b(!1)}}),Ur=At({mutationFn:F=>bu(F.id,F.updates),onSuccess:F=>{n.setQueryData(["encounterCombatants",fe],ge=>(ge==null?void 0:ge.map(Re=>Re.id===F.id?F:Re))??[])}}),Ct=At({mutationFn:z5,onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",fe]})}}),pn=At({mutationFn:F=>{if(!fe)throw new Error("No active encounter to update");return Ah(fe,F)},onSuccess:F=>{n.setQueryData(["encounterDetails",fe],F),n.invalidateQueries({queryKey:["allEncounters",e]}),L(!1)}}),kr=At({mutationFn:F=>{if(!fe)throw new Error("No active encounter");return q5(fe,F)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",fe]}),me([])}}),Vh=At({mutationFn:({id1:F,id2:ge})=>V5(F,ge),onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",fe]}),ae(!1),le(null)}}),ac=At({mutationFn:()=>{if(!fe)throw new Error("No encounter to start");return W5(fe)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",fe]}),n.invalidateQueries({queryKey:["allEncounters",e]})}}),Ee=At({mutationFn:()=>{if(!fe)throw new Error("No encounter to end");return G5(fe)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",fe]}),n.invalidateQueries({queryKey:["allEncounters",e]})}}),Ve=At({mutationFn:F=>{if(!fe)throw new Error("No encounter to log");return Ih(fe,F)}}),qe=At({mutationFn:()=>{if(!fe)throw new Error("No encounter for next round");return Y5(fe)},onSuccess:async()=>{n.setQueryData(["encounterCombatants",fe],F=>(F==null?void 0:F.map(ge=>({...ge,initiative_roll:null})))??[]),me([]),Je(null),Ve.mutate({type:"round_advanced",ts:Date.now(),round:((_e==null?void 0:_e.current_round)??0)+1}),n.invalidateQueries({queryKey:["encounterDetails",fe]})}});w.useEffect(()=>{if((_e==null?void 0:_e.status)==="active"&&xe.length>0&&!Qe){const F=xe[0];Je(F.id),Ve.mutate({type:"turn_start",ts:Date.now(),who:F.id,name:F.display_name})}(_e==null?void 0:_e.status)!=="active"&&Je(null)},[xe,_e==null?void 0:_e.status,_e==null?void 0:_e.current_round]);const it=F=>{F.preventDefault(),i.trim()&&Tt.mutate({name:i.trim(),description:o.trim()||void 0})},ot=(F,ge)=>Mr.mutate({encounterId:F,name:`${ge} (Copy)`}),ut=F=>{d(F),f(!1)},Bt=()=>{!v||!fe||Fr.mutate({type:"character",characterId:v,initiativeRoll:H?parseInt(H):null})},wi=()=>{var Ke;const F=Rt==null?void 0:Rt.find(vt=>vt.id===k);if(!F||!fe)return;const ge=((Ke=F.stats)==null?void 0:Ke.FEROCITY)??1,Re=I.trim()||F.name;for(let vt=1;vt<=P;vt++){const ct=P>1?`${Re} ${vt}`:Re;for(let Ts=1;Ts<=ge;Ts++){const Gh=ge>1?`${ct} (Action ${Ts})`:ct;Fr.mutate({type:"monster",monsterId:k,customName:Gh,instanceCount:1,initiativeRoll:q?parseInt(q):null})}}},Ss=F=>{const ge=$[F],Re=xe.find(ct=>ct.id===F);if(!ge||!Re)return;const Ke={},vt=parseInt(ge.current_hp,10);if(!isNaN(vt)&&vt!==Re.current_hp){Ke.current_hp=vt;const ct=vt-(Re.current_hp??0);Ve.mutate({type:"hp_change",ts:Date.now(),who:F,name:Re.display_name,delta:ct,from:Re.current_hp,to:vt})}if(ge.initiative_roll!=null){const ct=ge.initiative_roll.trim()===""?null:parseInt(ge.initiative_roll,10);(ct===null||!isNaN(ct))&&ct!==Re.initiative_roll&&(Ke.initiative_roll=ct)}if(Re.max_wp!=null&&ge.current_wp!=null){const ct=ge.current_wp.trim()===""?null:parseInt(ge.current_wp,10);if((ct===null||!isNaN(ct))&&ct!==Re.current_wp){Ke.current_wp=ct;const Ts=(ct??0)-(Re.current_wp??0);Ve.mutate({type:"wp_change",ts:Date.now(),who:F,name:Re.display_name,delta:Ts,from:Re.current_wp,to:ct})}}Object.keys(Ke).length>0&&Ur.mutate({id:F,updates:Ke})},Wh=()=>{A.length!==0&&kr.mutate(A)},Se=F=>{J&&(Z?Z!==F&&Vh.mutate({id1:Z,id2:F}):le(F))},Xr=F=>ye(ge=>({...ge,[F]:!ge[F]})),Jr=(F,ge)=>{if(!ge.attacks||ge.attacks.length===0)return;const Re=Math.floor(Math.random()*6)+1,Ke=ge.attacks.find(vt=>vt.roll_values.split(",").includes(String(Re)));De(vt=>({...vt,[F]:Ke||null})),Ve.mutate({type:"monster_attack",ts:Date.now(),who:F,name:ge.name,roll:Re,attack:Ke?{name:Ke.name,desc:Ke.description}:null})},Aa=F=>{if(Qe&&Qe!==F){const Re=xe.find(Ke=>Ke.id===Qe);Re&&Ve.mutate({type:"turn_end",ts:Date.now(),who:Qe,name:Re.display_name})}Je(F);const ge=xe.find(Re=>Re.id===F);ge&&Ve.mutate({type:"turn_start",ts:Date.now(),who:F,name:ge.display_name})},E_=()=>{if(!Qe||!xe||xe.length===0)return;const F=xe.findIndex(Re=>Re.id===Qe),ge=F+1;if(ge<xe.length)Aa(xe[ge].id);else{const Re=xe[F];Re&&Ve.mutate({type:"turn_end",ts:Date.now(),who:Qe,name:Re.display_name}),Je(null)}},N_=w.useMemo(()=>{const F=new Set(xe.map(ge=>ge.character_id));return t.filter(ge=>!F.has(ge.id))},[t,xe]),Ei=w.useMemo(()=>Rt==null?void 0:Rt.find(F=>F.id===k),[Rt,k]);if(!r)return a.jsx("div",{className:"p-4 text-center text-gray-600",children:a.jsx("p",{children:"Only the DM can view and manage encounter details."})});if(Ne||ee)return a.jsx($e,{});if(ue||de)return a.jsx(Ie,{message:(ue==null?void 0:ue.message)||(de==null?void 0:de.message)||"Error loading data"});const gt=_e;return a.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[a.jsx("div",{className:"sticky top-0 z-30 bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 p-4 shadow-sm rounded-lg",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Encounter"}),gt&&a.jsxs("div",{className:"text-sm text-gray-700 mt-1 flex items-center gap-3",children:[a.jsxs("span",{children:["Status: ",a.jsx("span",{className:`font-semibold ${gt.status==="active"?"text-green-600":gt.status==="planning"?"text-yellow-600":"text-blue-600"}`,children:gt.status})]}),gt.status==="active"&&gt.current_round>0&&a.jsxs("span",{children:["Round: ",a.jsx("span",{className:"font-semibold",children:gt.current_round})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{onClick:()=>f(!0),Icon:y4,variant:"secondary",children:"Encounters"}),a.jsx(U,{onClick:()=>s==null?void 0:s(),Icon:js,variant:"outline",children:"Dice"}),a.jsx(U,{onClick:()=>g("create"),Icon:Pd,children:"New"}),(gt==null?void 0:gt.status)==="planning"&&a.jsx(U,{onClick:()=>ac.mutate(),Icon:S4,children:"Start"}),(gt==null?void 0:gt.status)==="active"&&a.jsxs(a.Fragment,{children:[a.jsx(U,{onClick:()=>qe.mutate(),Icon:R4,children:"Next Round"}),a.jsx(U,{onClick:()=>b(!0),Icon:Ti,variant:"outline",children:"Reinforcements"}),a.jsx(U,{onClick:()=>Ee.mutate(),Icon:TE,variant:"secondary",children:"End"})]})]})]})}),p==="create"?a.jsxs("form",{onSubmit:it,className:"bg-white p-6 rounded-lg shadow space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create New Encounter"}),a.jsx("input",{type:"text",placeholder:"Encounter Name",value:i,onChange:F=>l(F.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md"}),a.jsx("textarea",{placeholder:"Description (optional)",value:o,onChange:F=>u(F.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{type:"submit",Icon:Pd,isLoading:Tt.isPending,children:"Create Encounter"}),V&&V.length>0&&a.jsx(U,{variant:"secondary",onClick:()=>g("details"),children:"Cancel"})]})]}):nt||!gt?a.jsx($e,{}):at?a.jsx(Ie,{message:at.message}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:B?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:Q,onChange:F=>N(F.target.value),className:"w-full px-3 py-2 border rounded-md text-xl font-semibold",placeholder:"Encounter Name"}),a.jsx("textarea",{value:K,onChange:F=>Y(F.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md text-gray-600 mt-2",placeholder:"Description"}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(U,{size:"sm",onClick:()=>pn.mutate({name:Q,description:K}),isLoading:pn.isPending,Icon:tr,children:"Save"}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>L(!1),Icon:rl,children:"Cancel"})]})]}):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:gt.name}),gt.description&&a.jsx("p",{className:"text-gray-600",children:gt.description})]}),a.jsx(U,{size:"sm",variant:"ghost",onClick:()=>L(!0),Icon:mg,"aria-label":"Edit"})]}),a.jsxs("div",{className:"text-sm mt-2",children:["Status: ",a.jsx("span",{className:`font-medium ${gt.status==="active"?"text-green-600":"text-yellow-600"}`,children:gt.status}),gt.current_round>0&&gt.status==="active"&&a.jsxs("span",{className:"ml-3",children:["Round: ",gt.current_round]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("section",{className:"lg:col-span-3 space-y-4",children:gt.status==="planning"?a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow lg:sticky lg:top-24 self-start",children:[a.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Build the encounter"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h5",{className:"text-base font-medium flex items-center gap-2",children:[a.jsx(Cn,{className:"w-5 h-5"})," Add Combatants"]}),y!=="idle"&&a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>E("idle"),Icon:Eh,children:"Back"})]}),y==="idle"&&a.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2",children:[a.jsx(U,{onClick:()=>E("characters"),Icon:yu,size:"lg",variant:"outline",children:"Add Party Members"}),a.jsx(U,{onClick:()=>E("monsters"),Icon:Ti,size:"lg",variant:"outline",children:"Add Monsters"})]}),y==="characters"&&a.jsxs("div",{className:"space-y-2 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Party Member"}),a.jsxs("select",{value:v,onChange:F=>_(F.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Party Member"}),N_.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:H,onChange:F=>O(F.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:js,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Party Initiative",onRoll:F=>O(String(F.total))})})]}),a.jsx(U,{onClick:Bt,Icon:yu,isLoading:Fr.isPending,disabled:!v,children:"Add Member"})]}),y==="monsters"&&a.jsxs("div",{className:"space-y-2 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:F=>S(F.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),Rt==null?void 0:Rt.map(F=>a.jsxs("option",{value:F.id,children:[F.name," ",F.category&&`(${F.category})`]},F.id))]}),Ei&&a.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-white rounded border",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"HP:"})," ",((qg=Ei.stats)==null?void 0:qg.HP)||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Ferocity:"})," ",((Vg=Ei.stats)==null?void 0:Vg.FEROCITY)||"N/A"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:I,onChange:F=>j(F.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:P,onChange:F=>T(Math.max(1,parseInt(F.target.value)||1)),min:"1",className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:q,onChange:F=>G(F.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:js,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Monster Initiative",onRoll:F=>G(String(F.total))})})]}),a.jsxs(U,{onClick:wi,Icon:Ti,isLoading:Fr.isPending,disabled:!k,children:["Add Monster",P>1?`s (${P})`:""]})]})]}):a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow lg:sticky lg:top-24 self-start",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Combat Log"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Events are persisted via ",a.jsx("code",{children:"appendEncounterLog"}),"."]})]})}),a.jsxs("section",{className:"lg:col-span-5 space-y-4",children:[gt.status==="active"&&a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-400 p-4 rounded-lg shadow-md",children:[a.jsxs("h4",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Sh,{className:"w-5 h-5"})," Now Acting"]}),Ae?a.jsxs("div",{children:[a.jsx("p",{className:"text-xl font-bold mt-1",children:Ae.display_name}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsx(U,{size:"sm",Icon:a4,onClick:E_,children:"Next Turn"}),a.jsx(U,{size:"sm",Icon:Uo,variant:"secondary",children:"Damage/Heal"}),Ae.monster_id&&je.get(Ae.monster_id)&&a.jsx(U,{size:"sm",Icon:js,variant:"danger_outline",onClick:()=>Jr(Ae.id,je.get(Ae.monster_id)),children:"Roll Attack"}),a.jsx(U,{size:"sm",Icon:jp,variant:"outline",onClick:()=>Je(null),children:"Clear Actor"})]}),Ae.monster_id&&Le[Ae.id]&&a.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:Le[Ae.id].name}),a.jsx(W1,{description:Le[Ae.id].description,attackName:Le[Ae.id].name})]})]}):a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:xe.length>0?"End of round. Ready for the next round.":"Add combatants to begin."})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-lg font-medium",children:"Turn Order"}),gt.status!=="completed"&&xe.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"selectAll",checked:A.length===xe.length&&xe.length>0,onChange:F=>me(F.target.checked?xe.map(ge=>ge.id):[])}),a.jsx("label",{htmlFor:"selectAll",className:"text-sm font-medium",children:"All"})]}),a.jsxs(U,{size:"sm",onClick:Wh,Icon:js,isLoading:kr.isPending,disabled:A.length===0,children:["Roll (",A.length,")"]}),a.jsx(U,{size:"sm",variant:J?"danger":"secondary",onClick:()=>{ae(!J),le(null)},Icon:JA,children:J?"Cancel Swap":"Swap"})]})]}),xe.length===0?a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No combatants in the encounter yet."}):a.jsx("ul",{className:"divide-y divide-gray-200",children:xe.map(F=>{var ge;return a.jsxs("li",{className:`flex flex-wrap items-center justify-between py-2 px-2 -mx-2 rounded-md transition-all ${J?"cursor-pointer hover:bg-blue-50":""} ${Z===F.id?"ring-2 ring-blue-500":""} ${Qe===F.id?"bg-blue-100":""}`,onClick:()=>J?Se(F.id):Aa(F.id),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",className:"ml-1",checked:A.includes(F.id),onChange:Re=>{Re.target.checked?me(Ke=>[...Ke,F.id]):me(Ke=>Ke.filter(vt=>vt!==F.id))},onClick:Re=>Re.stopPropagation()}),a.jsx("span",{className:"w-8 text-center text-lg font-bold text-gray-700",children:F.initiative_roll??"-"}),a.jsx("span",{className:"font-medium",children:F.display_name})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:Re=>Re.stopPropagation(),children:[a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((ge=$[F.id])==null?void 0:ge.initiative_roll)??"",onChange:Re=>z(Ke=>({...Ke,[F.id]:{...Ke[F.id],initiative_roll:Re.target.value}})),placeholder:"Init"}),a.jsx(U,{size:"icon_sm",variant:"ghost",onClick:()=>s==null?void 0:s({dice:"1d20",label:`Initiative for ${F.display_name}`,onRoll:Re=>z(Ke=>({...Ke,[F.id]:{...Ke[F.id],initiative_roll:String(Re.total)}}))}),children:a.jsx(js,{className:"w-4 h-4"})}),a.jsx(U,{size:"icon_sm",onClick:()=>Ss(F.id),children:a.jsx(tr,{className:"w-4 h-4"})})]})]},F.id)})})]})]}),a.jsxs("section",{className:"lg:col-span-4 space-y-5",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-red-700",children:[a.jsx(Ti,{className:"w-5 h-5"})," Monsters"]}),Wt?a.jsx($e,{}):Gt?a.jsx(Ie,{message:Gt.message}):xe.filter(F=>F.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No monsters yet."}):xe.filter(F=>F.monster_id).map(F=>{var vt,ct,Ts;const ge=F.monster_id?je.get(F.monster_id.trim()):void 0,Re=!!he[F.id],Ke=Le[F.id];return a.jsxs("article",{className:`border-l-4 rounded-r-lg shadow p-3 transition-all ${Qe===F.id?"border-red-600 bg-red-50":"border-red-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-bold truncate",children:F.display_name}),a.jsx("p",{className:"text-xs text-red-800",children:(ge==null?void 0:ge.name)??"Monster"})]}),a.jsx(U,{size:"sm",variant:"danger",onClick:()=>Ct.mutate(F.id),Icon:cr,isLoading:Ct.isPending&&Ct.variables===F.id})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Uo,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",value:((vt=$[F.id])==null?void 0:vt.current_hp)??"",onChange:Gh=>z(Yg=>({...Yg,[F.id]:{...Yg[F.id],current_hp:Gh.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",F.max_hp]})]}),a.jsx(U,{size:"sm",onClick:()=>Ss(F.id),Icon:tr,isLoading:Ur.isPending&&((ct=Ur.variables)==null?void 0:ct.id)===F.id})]}),a.jsxs("div",{className:"mt-3 border-t pt-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700",children:"Attacks"}),a.jsxs(U,{size:"sm",variant:"ghost",onClick:()=>Xr(F.id),children:[Re?"Hide":"Show",Re?a.jsx(s4,{className:"w-4 h-4 ml-1"}):a.jsx(Nh,{className:"w-4 h-4 ml-1"})]})]}),Re&&a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsx(U,{size:"sm",Icon:js,onClick:()=>ge&&Jr(F.id,ge),disabled:!((Ts=ge==null?void 0:ge.attacks)!=null&&Ts.length),children:"Roll Attack"}),Ke&&a.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:Ke.name}),a.jsx(W1,{description:Ke.description,attackName:Ke.name})]})]})]})]},F.id)})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-blue-700",children:[a.jsx(Cn,{className:"w-5 h-5"})," Party"]}),Wt?a.jsx($e,{}):Gt?a.jsx(Ie,{message:Gt.message}):xe.filter(F=>!F.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No party members yet."}):xe.filter(F=>!F.monster_id).map(F=>{var ge,Re,Ke;return a.jsxs("div",{className:`p-3 rounded-lg border-l-4 shadow transition-all ${Qe===F.id?"border-blue-600 bg-blue-50":"border-blue-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:F.display_name}),a.jsx("p",{className:"text-xs text-gray-600",children:"Player Character"})]}),a.jsx(U,{size:"sm",variant:"danger",onClick:()=>Ct.mutate(F.id),Icon:cr,isLoading:Ct.isPending&&Ct.variables===F.id})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Uo,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((ge=$[F.id])==null?void 0:ge.current_hp)??"",onChange:vt=>z(ct=>({...ct,[F.id]:{...ct[F.id],current_hp:vt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",F.max_hp]})]}),F.max_wp!=null&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 text-yellow-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((Re=$[F.id])==null?void 0:Re.current_wp)??"",onChange:vt=>z(ct=>({...ct,[F.id]:{...ct[F.id],current_wp:vt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",F.max_wp]})]}),a.jsx(U,{size:"sm",onClick:()=>Ss(F.id),Icon:tr,isLoading:Ur.isPending&&((Ke=Ur.variables)==null?void 0:Ke.id)===F.id})]})]},F.id)})]})]})]}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[a.jsx(Ti,{className:"w-5 h-5"})," Add Reinforcements"]}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>b(!1),Icon:rl,children:"Cancel"})]}),a.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:F=>S(F.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),Rt==null?void 0:Rt.map(F=>a.jsxs("option",{value:F.id,children:[F.name," ",F.category&&`(${F.category})`]},F.id))]}),Ei&&a.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-gray-50 rounded border",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"HP:"})," ",((Wg=Ei.stats)==null?void 0:Wg.HP)||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Ferocity:"})," ",((Gg=Ei.stats)==null?void 0:Gg.FEROCITY)||"N/A"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:I,onChange:F=>j(F.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:P,onChange:F=>T(Math.max(1,parseInt(F.target.value)||1)),min:1,className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:q,onChange:F=>G(F.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:js,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Reinforcement Initiative",onRoll:F=>G(String(F.total))})})]}),a.jsxs(U,{onClick:wi,Icon:Ti,isLoading:Fr.isPending,disabled:!k,className:"w-full",children:["Add Monster",P>1?`s (${P})`:""," to Fight"]})]})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl space-y-4 max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"All Encounters"}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>f(!1),Icon:rl,children:"Close"})]}),a.jsx("div",{className:"overflow-y-auto space-y-2 border-t pt-4",children:(V??[]).map(F=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-md ${fe===F.id?"bg-blue-100":"bg-gray-50"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:F.name}),a.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Status: ",F.status]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{size:"sm",onClick:()=>ut(F.id),disabled:fe===F.id,children:"Select"}),a.jsx(U,{size:"sm",variant:"outline",Icon:cg,onClick:()=>ot(F.id,F.name),children:"Duplicate"}),a.jsx(U,{size:"sm",variant:"danger",Icon:cr,onClick:()=>Zr.mutate(F.id),children:"Delete"})]})]},F.id))})]})})]})]})}const v_=w.createContext(void 0);function w_(){const e=w.useContext(v_);if(!e)throw new Error("useDropdown must be used within a DropdownMenu");return e}function BB({children:e}){const[t,r]=w.useState(!1),n=w.useRef(null);return w.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&r(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),a.jsx(v_.Provider,{value:{isOpen:t,setIsOpen:r},children:a.jsx("div",{className:"relative inline-block text-left",ref:n,children:e})})}function HB({children:e}){const{isOpen:t,setIsOpen:r}=w_();return a.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),r(s=>!s)},className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-expanded":t,"aria-haspopup":"true",children:e||a.jsx(dg,{className:"w-5 h-5"})})}function $B({children:e}){const{isOpen:t,setIsOpen:r}=w_();return t?a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",children:a.jsx("div",{className:"py-1",role:"none",onClick:()=>r(!1),children:e})}):null}function G1({onSelect:e,children:t,className:r}){return a.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),e()},className:`flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 ${r}`,role:"menuitem",children:t})}function zB(){return a.jsx("div",{className:"border-t border-gray-100 my-1"})}function qB(){const{id:e}=rg(),t=fn(),{user:r,isDM:n}=Vt(),s=hn(),[i,l]=w.useState(!1),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState("members"),{data:p,isLoading:g,error:y}=Ut({queryKey:["party",e],queryFn:()=>SF(e),enabled:!!e}),E=At({mutationFn:j=>{if(!e)throw new Error("Party ID is missing");return TF(e,j)},onSuccess:()=>{s.invalidateQueries({queryKey:["party",e]}),s.invalidateQueries({queryKey:["availableCharacters"]}),u(null),d(null)}}),x=At({mutationFn:()=>{if(!e)throw new Error("Party ID is missing");return CF(e)},onSuccess:()=>{s.invalidateQueries({queryKey:["parties"]}),t("/adventure-party")}}),b=j=>{d(j),u("removeMember")},v=()=>{c&&E.mutate(c)},_=()=>{x.mutate()},k=r&&p&&r.id===p.created_by&&n(),S=p!=null&&p.invite_code?`${window.location.origin}/party/join/${p.invite_code}`:"";if(g)return a.jsx("div",{className:"flex justify-center items-center p-8",children:a.jsx($e,{size:"lg"})});if(y)return a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:y.message})});if(!p)return a.jsx("div",{className:"p-8",children:a.jsx(Ie,{message:"Party not found."})});const I=[{id:"members",label:"Members",icon:Cn},{id:"notes",label:"Notes",icon:N4},{id:"tasks",label:"Tasks",icon:o4},{id:"inventory",label:"Inventory",icon:mE},{id:"encounter",label:"Encounter",icon:pg}];return a.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[a.jsxs("div",{className:"bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:p.name}),a.jsx("p",{className:"text-gray-500 mt-1",children:"A band of brave adventurers."})]}),k&&a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsxs(BB,{children:[a.jsx(HB,{children:a.jsx(U,{variant:"outline",size:"icon","aria-label":"Party Actions",children:a.jsx(dg,{className:"h-5 w-5"})})}),a.jsxs($B,{children:[a.jsxs(G1,{onSelect:()=>l(j=>!j),children:[a.jsx(yu,{className:"w-4 h-4"}),"Invite Player"]}),a.jsx(zB,{}),a.jsxs(G1,{onSelect:()=>u("deleteParty"),className:"text-red-500 hover:text-red-700 hover:bg-red-50 focus:bg-red-50",children:[a.jsx(cr,{className:"w-4 h-4"}),"Delete Party"]})]})]})})]}),i&&k&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800",children:"Share this link to invite players:"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-white p-2 rounded-md",children:[a.jsx("input",{type:"text",readOnly:!0,value:S,className:"w-full bg-transparent text-gray-700 focus:outline-none"}),a.jsx(CB,{textToCopy:S})]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-6 px-6","aria-label":"Tabs",children:I.map(j=>a.jsxs("button",{onClick:()=>f(j.id),className:`shrink-0 flex items-center gap-2 px-1 py-4 text-sm font-medium border-b-2 ${h===j.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(j.icon,{className:"w-5 h-5"}),j.label]},j.id))})}),a.jsxs("div",{className:"p-6",children:[h==="members"&&a.jsx("div",{className:"space-y-4",children:p.members.length>0?p.members.map(j=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-2 bg-gray-200 rounded-full",children:a.jsx(ui,{className:"w-6 h-6 text-gray-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.kin," ",j.profession]})]})]}),k&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"outline",size:"sm",onClick:()=>t(`/character/${j.id}`),"aria-label":`View ${j.name}'s sheet`,icon:bE,children:"View Sheet"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>b(j.id),"aria-label":`Remove ${j.name}`,children:a.jsx(Yy,{className:"w-5 h-5 text-red-500"})})]})]},j.id)):a.jsx("p",{className:"text-center text-gray-500 py-8",children:"This party has no members yet. Invite someone!"})}),h==="notes"&&a.jsx(jB,{partyId:e,isDM:k}),h==="tasks"&&a.jsx(PB,{partyId:e,isDM:k}),h==="inventory"&&a.jsx(DB,{partyId:e,members:p.members,isDM:k}),h==="encounter"&&a.jsx(UB,{partyId:e,partyMembers:p.members,isDM:k})]})]}),a.jsx(Lp,{isOpen:o==="removeMember",onClose:()=>u(null),onConfirm:v,title:"Remove Member",description:"Are you sure you want to remove this character from the party? This action cannot be undone.",confirmText:"Remove",isDestructive:!0,isLoading:E.isPending,icon:a.jsx(Yy,{className:"w-6 h-6 text-red-500"})}),a.jsx(Lp,{isOpen:o==="deleteParty",onClose:()=>u(null),onConfirm:_,title:"Delete Party",description:"Are you sure you want to permanently delete this party? All members will be removed. This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:x.isPending,icon:a.jsx(_E,{className:"w-6 h-6 text-red-500"})})]})}function VB(){var p;const{inviteCode:e}=rg();console.log("Invite Code from URL:",e);const t=fn(),{user:r}=Vt(),n=hn(),[s,i]=w.useState(""),{data:l=[],isLoading:o,error:u}=Ut({queryKey:["availableCharacters",r==null?void 0:r.id],queryFn:()=>n_(r==null?void 0:r.id),enabled:!!r}),c=At({mutationFn:async g=>{if(!g)throw new Error("Please select a character");if(!e)throw new Error("Invite code is missing");const{data:y,error:E}=await te.rpc("join_party_with_character",{p_invite_code:e,p_character_id:g});if(E)throw E.message.includes("invalid_invite_code")?new Error("This invite link is invalid or has expired."):E.message.includes("character_already_in_a_party")?new Error("This character is already in a party."):E.message.includes("user_already_in_party")?new Error("You are already a member of this party."):E;return y},onSuccess:g=>{const y=g==null?void 0:g.party_id;y?(n.invalidateQueries({queryKey:["parties"]}),n.invalidateQueries({queryKey:["party",y]}),n.invalidateQueries({queryKey:["availableCharacters",r==null?void 0:r.id]}),t(`/party/${y}`)):t("/adventure-party")}}),d=()=>{s&&c.mutate(s)},h=o,f=(u==null?void 0:u.message)||((p=c.error)==null?void 0:p.message);return h?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsx($e,{size:"lg"})}):f?a.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[a.jsx(Ie,{message:f}),a.jsx(U,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(Cn,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Join an Adventure"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"You've been invited to join a new party!"})]}),l.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-center text-gray-700",children:"Select one of your available characters to join with."}),a.jsx("div",{className:"space-y-3",children:l.map(g=>a.jsxs("div",{onClick:()=>i(g.id),className:`p-4 border rounded-lg cursor-pointer transition-all flex items-center justify-between ${s===g.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-500":"border-gray-200 hover:border-blue-400"}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:g.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[g.kin," ",g.profession]})]}),s===g.id&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx(tl,{className:"w-4 h-4 text-white"})})]},g.id))}),a.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[a.jsx(U,{variant:"secondary",onClick:()=>t("/adventure-party"),children:"Cancel"}),a.jsx(U,{variant:"primary",loading:c.isPending,disabled:!s||c.isPending,onClick:d,children:"Join with Selected Character"})]})]}):a.jsxs("div",{className:"text-center py-8 border-t mt-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any available characters to join with."}),a.jsx(U,{variant:"primary",onClick:()=>t("/"),children:"Create a Character"})]})]})})}function WB(){return a.jsxs(a.Fragment,{children:[" ",a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-white focus:text-blue-600",children:"Skip to main content"}),a.jsxs(wy,{children:[a.jsx(en,{path:"/login",element:a.jsx(kB,{})}),a.jsx(en,{path:"*",element:a.jsx(TB,{children:a.jsxs(a.Fragment,{children:[a.jsx(J4,{}),a.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:a.jsxs(wy,{children:[a.jsx(en,{path:"/",element:a.jsx(M5,{})}),a.jsx(en,{path:"/character/:id",element:a.jsx(jI,{})}),a.jsx(en,{path:"/compendium",element:a.jsx(kF,{})}),a.jsx(en,{path:"/adventure-party",element:a.jsx(jF,{})}),a.jsx(en,{path:"/party/:id",element:a.jsx(qB,{})}),a.jsx(en,{path:"/party/join/:inviteCode",element:a.jsx(VB,{})}),a.jsx(en,{path:"/notes",element:a.jsx(AF,{})}),a.jsx(en,{path:"/settings",element:a.jsx(NB,{})}),a.jsx(en,{path:"*",element:a.jsx(Po,{to:"/",replace:!0})})]})}),a.jsx(SB,{})]})})})]})]})}function GB(){const{showWarning:e,extendSession:t}=G4();return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-amber-100 rounded-full",children:a.jsx(_h,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Session Timeout Warning"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your session will expire in 30 seconds due to inactivity."})]})]}),a.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(qt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-amber-700",children:'Click "Continue Session" to stay logged in, or your session will end automatically.'})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{variant:"primary",onClick:t,children:"Continue Session"})})]})}):null}function YB(){return a.jsx(jj,{children:a.jsx(Y4,{children:a.jsxs(C2,{client:LE,children:[a.jsx(B4,{children:a.jsx(q4,{children:a.jsx(W4,{children:a.jsx(X4,{children:a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(WB,{}),a.jsx(GB,{})]})})})})}),!1]})})})}g2(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsxs(C2,{client:LE,children:[" ",a.jsx(YB,{})]})}));export{Zd as g};
