var C_=Object.defineProperty;var tx=e=>{throw TypeError(e)};var j_=(e,t,r)=>t in e?C_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var wc=(e,t,r)=>j_(e,typeof t!="symbol"?t+"":t,r),uf=(e,t,r)=>t.has(e)||tx("Cannot "+r);var F=(e,t,r)=>(uf(e,t,"read from private field"),r?r.call(e):t.get(e)),ke=(e,t,r)=>t.has(e)?tx("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),xe=(e,t,r,n)=>(uf(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Fe=(e,t,r)=>(uf(e,t,"access private method"),r);var Ec=(e,t,r,n)=>({set _(s){xe(e,t,s,r)},get _(){return F(e,t,n)}});function A_(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function I_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var dv={exports:{}},hh={},hv={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ku=Symbol.for("react.element"),R_=Symbol.for("react.portal"),L_=Symbol.for("react.fragment"),O_=Symbol.for("react.strict_mode"),P_=Symbol.for("react.profiler"),D_=Symbol.for("react.provider"),M_=Symbol.for("react.context"),F_=Symbol.for("react.forward_ref"),U_=Symbol.for("react.suspense"),B_=Symbol.for("react.memo"),H_=Symbol.for("react.lazy"),rx=Symbol.iterator;function $_(e){return e===null||typeof e!="object"?null:(e=rx&&e[rx]||e["@@iterator"],typeof e=="function"?e:null)}var fv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mv=Object.assign,pv={};function Wl(e,t,r){this.props=e,this.context=t,this.refs=pv,this.updater=r||fv}Wl.prototype.isReactComponent={};Wl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gv(){}gv.prototype=Wl.prototype;function f0(e,t,r){this.props=e,this.context=t,this.refs=pv,this.updater=r||fv}var m0=f0.prototype=new gv;m0.constructor=f0;mv(m0,Wl.prototype);m0.isPureReactComponent=!0;var nx=Array.isArray,xv=Object.prototype.hasOwnProperty,p0={current:null},yv={key:!0,ref:!0,__self:!0,__source:!0};function bv(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)xv.call(t,n)&&!yv.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Ku,type:e,key:i,ref:l,props:s,_owner:p0.current}}function z_(e,t){return{$$typeof:Ku,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function g0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ku}function q_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var sx=/\/+/g;function cf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?q_(""+e.key):t.toString(36)}function td(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ku:case R_:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+cf(l,0):n,nx(s)?(r="",e!=null&&(r=e.replace(sx,"$&/")+"/"),td(s,t,r,"",function(c){return c})):s!=null&&(g0(s)&&(s=z_(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(sx,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",nx(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+cf(i,o);l+=td(i,t,r,u,s)}else if(u=$_(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+cf(i,o++),l+=td(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Nc(e,t,r){if(e==null)return e;var n=[],s=0;return td(e,n,"","",function(i){return t.call(r,i,s++)}),n}function V_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Nr={current:null},rd={transition:null},W_={ReactCurrentDispatcher:Nr,ReactCurrentBatchConfig:rd,ReactCurrentOwner:p0};function vv(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Nc,forEach:function(e,t,r){Nc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Nc(e,function(){t++}),t},toArray:function(e){return Nc(e,function(t){return t})||[]},only:function(e){if(!g0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=Wl;Ve.Fragment=L_;Ve.Profiler=P_;Ve.PureComponent=f0;Ve.StrictMode=O_;Ve.Suspense=U_;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W_;Ve.act=vv;Ve.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=mv({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=p0.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)xv.call(t,u)&&!yv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Ku,type:e.type,key:s,ref:i,props:n,_owner:l}};Ve.createContext=function(e){return e={$$typeof:M_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:D_,_context:e},e.Consumer=e};Ve.createElement=bv;Ve.createFactory=function(e){var t=bv.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:F_,render:e}};Ve.isValidElement=g0;Ve.lazy=function(e){return{$$typeof:H_,_payload:{_status:-1,_result:e},_init:V_}};Ve.memo=function(e,t){return{$$typeof:B_,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=rd.transition;rd.transition={};try{e()}finally{rd.transition=t}};Ve.unstable_act=vv;Ve.useCallback=function(e,t){return Nr.current.useCallback(e,t)};Ve.useContext=function(e){return Nr.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return Nr.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return Nr.current.useEffect(e,t)};Ve.useId=function(){return Nr.current.useId()};Ve.useImperativeHandle=function(e,t,r){return Nr.current.useImperativeHandle(e,t,r)};Ve.useInsertionEffect=function(e,t){return Nr.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return Nr.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return Nr.current.useMemo(e,t)};Ve.useReducer=function(e,t,r){return Nr.current.useReducer(e,t,r)};Ve.useRef=function(e){return Nr.current.useRef(e)};Ve.useState=function(e){return Nr.current.useState(e)};Ve.useSyncExternalStore=function(e,t,r){return Nr.current.useSyncExternalStore(e,t,r)};Ve.useTransition=function(){return Nr.current.useTransition()};Ve.version="18.3.1";hv.exports=Ve;var E=hv.exports;const Tn=dh(E),G_=A_({__proto__:null,default:Tn},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_=E,Q_=Symbol.for("react.element"),K_=Symbol.for("react.fragment"),Z_=Object.prototype.hasOwnProperty,X_=Y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J_={key:!0,ref:!0,__self:!0,__source:!0};function wv(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Z_.call(t,n)&&!J_.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Q_,type:e,key:i,ref:l,props:s,_owner:X_.current}}hh.Fragment=K_;hh.jsx=wv;hh.jsxs=wv;dv.exports=hh;var a=dv.exports,Ev={exports:{}},Qr={},Nv={exports:{}},kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,X){var N=P.length;P.push(X);e:for(;0<N;){var V=N-1>>>1,H=P[V];if(0<s(H,X))P[V]=X,P[N]=H,N=V;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var X=P[0],N=P.pop();if(N!==X){P[0]=N;e:for(var V=0,H=P.length,j=H>>>1;V<j;){var he=2*(V+1)-1,J=P[he],q=he+1,$=P[q];if(0>s(J,N))q<H&&0>s($,J)?(P[V]=$,P[q]=N,V=q):(P[V]=J,P[he]=N,V=he);else if(q<H&&0>s($,N))P[V]=$,P[q]=N,V=q;else break e}}return X}function s(P,X){var N=P.sortIndex-X.sortIndex;return N!==0?N:P.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],d=1,h=null,f=3,p=!1,g=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(P){for(var X=r(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=P)n(c),X.sortIndex=X.expirationTime,t(u,X);else break;X=r(c)}}function _(P){if(y=!1,w(P),!g)if(r(u)!==null)g=!0,W(k);else{var X=r(c);X!==null&&K(_,X.startTime-P)}}function k(P,X){g=!1,y&&(y=!1,x(R),R=-1),p=!0;var N=f;try{for(w(X),h=r(u);h!==null&&(!(h.expirationTime>X)||P&&!z());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var H=V(h.expirationTime<=X);X=e.unstable_now(),typeof H=="function"?h.callback=H:h===r(u)&&n(u),w(X)}else n(u);h=r(u)}if(h!==null)var j=!0;else{var he=r(c);he!==null&&K(_,he.startTime-X),j=!1}return j}finally{h=null,f=N,p=!1}}var S=!1,A=null,R=-1,L=5,T=-1;function z(){return!(e.unstable_now()-T<L)}function O(){if(A!==null){var P=e.unstable_now();T=P;var X=!0;try{X=A(!0,P)}finally{X?Y():(S=!1,A=null)}}else S=!1}var Y;if(typeof b=="function")Y=function(){b(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,B=G.port2;G.port1.onmessage=O,Y=function(){B.postMessage(null)}}else Y=function(){v(O,0)};function W(P){A=P,S||(S=!0,Y())}function K(P,X){R=v(function(){P(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,W(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(P){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var N=f;f=X;try{return P()}finally{f=N}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,X){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var N=f;f=P;try{return X()}finally{f=N}},e.unstable_scheduleCallback=function(P,X,N){var V=e.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?V+N:V):N=V,P){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=N+H,P={id:d++,callback:X,priorityLevel:P,startTime:N,expirationTime:H,sortIndex:-1},N>V?(P.sortIndex=N,t(c,P),r(u)===null&&P===r(c)&&(y?(x(R),R=-1):y=!0,K(_,N-V))):(P.sortIndex=H,t(u,P),g||p||(g=!0,W(k))),P},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(P){var X=f;return function(){var N=f;f=X;try{return P.apply(this,arguments)}finally{f=N}}}})(kv);Nv.exports=kv;var eS=Nv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tS=E,Yr=eS;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _v=new Set,au={};function Ni(e,t){Al(e,t),Al(e+"Capture",t)}function Al(e,t){for(au[e]=t,e=0;e<t.length;e++)_v.add(t[e])}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),km=Object.prototype.hasOwnProperty,rS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ax={},ix={};function nS(e){return km.call(ix,e)?!0:km.call(ax,e)?!1:rS.test(e)?ix[e]=!0:(ax[e]=!0,!1)}function sS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aS(e,t,r,n){if(t===null||typeof t>"u"||sS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function kr(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tr[e]=new kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tr[t]=new kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tr[e]=new kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tr[e]=new kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tr[e]=new kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tr[e]=new kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tr[e]=new kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tr[e]=new kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tr[e]=new kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var x0=/[\-:]([a-z])/g;function y0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x0,y0);tr[t]=new kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x0,y0);tr[t]=new kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x0,y0);tr[t]=new kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tr[e]=new kr(e,1,!1,e.toLowerCase(),null,!1,!1)});tr.xlinkHref=new kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tr[e]=new kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function b0(e,t,r,n){var s=tr.hasOwnProperty(t)?tr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aS(t,r,s,n)&&(r=null),n||s===null?nS(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var As=tS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kc=Symbol.for("react.element"),$i=Symbol.for("react.portal"),zi=Symbol.for("react.fragment"),v0=Symbol.for("react.strict_mode"),_m=Symbol.for("react.profiler"),Sv=Symbol.for("react.provider"),Tv=Symbol.for("react.context"),w0=Symbol.for("react.forward_ref"),Sm=Symbol.for("react.suspense"),Tm=Symbol.for("react.suspense_list"),E0=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),Cv=Symbol.for("react.offscreen"),lx=Symbol.iterator;function lo(e){return e===null||typeof e!="object"?null:(e=lx&&e[lx]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,df;function To(e){if(df===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);df=t&&t[1]||""}return`
`+df+e}var hf=!1;function ff(e,t){if(!e||hf)return"";hf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{hf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?To(e):""}function iS(e){switch(e.tag){case 5:return To(e.type);case 16:return To("Lazy");case 13:return To("Suspense");case 19:return To("SuspenseList");case 0:case 2:case 15:return e=ff(e.type,!1),e;case 11:return e=ff(e.type.render,!1),e;case 1:return e=ff(e.type,!0),e;default:return""}}function Cm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zi:return"Fragment";case $i:return"Portal";case _m:return"Profiler";case v0:return"StrictMode";case Sm:return"Suspense";case Tm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Tv:return(e.displayName||"Context")+".Consumer";case Sv:return(e._context.displayName||"Context")+".Provider";case w0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case E0:return t=e.displayName||null,t!==null?t:Cm(e.type)||"Memo";case $s:t=e._payload,e=e._init;try{return Cm(e(t))}catch{}}return null}function lS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cm(t);case 8:return t===v0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function va(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function jv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oS(e){var t=jv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function _c(e){e._valueTracker||(e._valueTracker=oS(e))}function Av(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=jv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function bd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jm(e,t){var r=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ox(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=va(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Iv(e,t){t=t.checked,t!=null&&b0(e,"checked",t,!1)}function Am(e,t){Iv(e,t);var r=va(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Im(e,t.type,r):t.hasOwnProperty("defaultValue")&&Im(e,t.type,va(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ux(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Im(e,t,r){(t!=="number"||bd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Co=Array.isArray;function rl(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+va(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Rm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ue(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ue(92));if(Co(r)){if(1<r.length)throw Error(ue(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:va(r)}}function Rv(e,t){var r=va(t.value),n=va(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function dx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Lv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Lv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sc,Ov=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sc=Sc||document.createElement("div"),Sc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function iu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uS=["Webkit","ms","Moz","O"];Object.keys(Mo).forEach(function(e){uS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Mo[t]=Mo[e]})});function Pv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Mo.hasOwnProperty(e)&&Mo[e]?(""+t).trim():t+"px"}function Dv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Pv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var cS=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Om(e,t){if(t){if(cS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ue(62))}}function Pm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dm=null;function N0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mm=null,nl=null,sl=null;function hx(e){if(e=Ju(e)){if(typeof Mm!="function")throw Error(ue(280));var t=e.stateNode;t&&(t=xh(t),Mm(e.stateNode,e.type,t))}}function Mv(e){nl?sl?sl.push(e):sl=[e]:nl=e}function Fv(){if(nl){var e=nl,t=sl;if(sl=nl=null,hx(e),t)for(e=0;e<t.length;e++)hx(t[e])}}function Uv(e,t){return e(t)}function Bv(){}var mf=!1;function Hv(e,t,r){if(mf)return e(t,r);mf=!0;try{return Uv(e,t,r)}finally{mf=!1,(nl!==null||sl!==null)&&(Bv(),Fv())}}function lu(e,t){var r=e.stateNode;if(r===null)return null;var n=xh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ue(231,t,typeof r));return r}var Fm=!1;if(Ns)try{var oo={};Object.defineProperty(oo,"passive",{get:function(){Fm=!0}}),window.addEventListener("test",oo,oo),window.removeEventListener("test",oo,oo)}catch{Fm=!1}function dS(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Fo=!1,vd=null,wd=!1,Um=null,hS={onError:function(e){Fo=!0,vd=e}};function fS(e,t,r,n,s,i,l,o,u){Fo=!1,vd=null,dS.apply(hS,arguments)}function mS(e,t,r,n,s,i,l,o,u){if(fS.apply(this,arguments),Fo){if(Fo){var c=vd;Fo=!1,vd=null}else throw Error(ue(198));wd||(wd=!0,Um=c)}}function ki(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function $v(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fx(e){if(ki(e)!==e)throw Error(ue(188))}function pS(e){var t=e.alternate;if(!t){if(t=ki(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return fx(s),e;if(i===n)return fx(s),t;i=i.sibling}throw Error(ue(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(ue(189))}}if(r.alternate!==n)throw Error(ue(190))}if(r.tag!==3)throw Error(ue(188));return r.stateNode.current===r?e:t}function zv(e){return e=pS(e),e!==null?qv(e):null}function qv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qv(e);if(t!==null)return t;e=e.sibling}return null}var Vv=Yr.unstable_scheduleCallback,mx=Yr.unstable_cancelCallback,gS=Yr.unstable_shouldYield,xS=Yr.unstable_requestPaint,Lt=Yr.unstable_now,yS=Yr.unstable_getCurrentPriorityLevel,k0=Yr.unstable_ImmediatePriority,Wv=Yr.unstable_UserBlockingPriority,Ed=Yr.unstable_NormalPriority,bS=Yr.unstable_LowPriority,Gv=Yr.unstable_IdlePriority,fh=null,Zn=null;function vS(e){if(Zn&&typeof Zn.onCommitFiberRoot=="function")try{Zn.onCommitFiberRoot(fh,e,void 0,(e.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:NS,wS=Math.log,ES=Math.LN2;function NS(e){return e>>>=0,e===0?32:31-(wS(e)/ES|0)|0}var Tc=64,Cc=4194304;function jo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=jo(o):(i&=l,i!==0&&(n=jo(i)))}else l=r&~s,l!==0?n=jo(l):i!==0&&(n=jo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Cn(t),s=1<<r,n|=e[r],t&=~s;return n}function kS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _S(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Cn(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=kS(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function Bm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yv(){var e=Tc;return Tc<<=1,!(Tc&4194240)&&(Tc=64),e}function pf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Zu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cn(t),e[t]=r}function SS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Cn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function _0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Cn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var it=0;function Qv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Kv,S0,Zv,Xv,Jv,Hm=!1,jc=[],ca=null,da=null,ha=null,ou=new Map,uu=new Map,Gs=[],TS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function px(e,t){switch(e){case"focusin":case"focusout":ca=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":ha=null;break;case"pointerover":case"pointerout":ou.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":uu.delete(t.pointerId)}}function uo(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ju(t),t!==null&&S0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function CS(e,t,r,n,s){switch(t){case"focusin":return ca=uo(ca,e,t,r,n,s),!0;case"dragenter":return da=uo(da,e,t,r,n,s),!0;case"mouseover":return ha=uo(ha,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ou.set(i,uo(ou.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,uu.set(i,uo(uu.get(i)||null,e,t,r,n,s)),!0}return!1}function ew(e){var t=Ga(e.target);if(t!==null){var r=ki(t);if(r!==null){if(t=r.tag,t===13){if(t=$v(r),t!==null){e.blockedOn=t,Jv(e.priority,function(){Zv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function nd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=$m(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Dm=n,r.target.dispatchEvent(n),Dm=null}else return t=Ju(r),t!==null&&S0(t),e.blockedOn=r,!1;t.shift()}return!0}function gx(e,t,r){nd(e)&&r.delete(t)}function jS(){Hm=!1,ca!==null&&nd(ca)&&(ca=null),da!==null&&nd(da)&&(da=null),ha!==null&&nd(ha)&&(ha=null),ou.forEach(gx),uu.forEach(gx)}function co(e,t){e.blockedOn===t&&(e.blockedOn=null,Hm||(Hm=!0,Yr.unstable_scheduleCallback(Yr.unstable_NormalPriority,jS)))}function cu(e){function t(s){return co(s,e)}if(0<jc.length){co(jc[0],e);for(var r=1;r<jc.length;r++){var n=jc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ca!==null&&co(ca,e),da!==null&&co(da,e),ha!==null&&co(ha,e),ou.forEach(t),uu.forEach(t),r=0;r<Gs.length;r++)n=Gs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Gs.length&&(r=Gs[0],r.blockedOn===null);)ew(r),r.blockedOn===null&&Gs.shift()}var al=As.ReactCurrentBatchConfig,kd=!0;function AS(e,t,r,n){var s=it,i=al.transition;al.transition=null;try{it=1,T0(e,t,r,n)}finally{it=s,al.transition=i}}function IS(e,t,r,n){var s=it,i=al.transition;al.transition=null;try{it=4,T0(e,t,r,n)}finally{it=s,al.transition=i}}function T0(e,t,r,n){if(kd){var s=$m(e,t,r,n);if(s===null)_f(e,t,n,_d,r),px(e,n);else if(CS(s,e,t,r,n))n.stopPropagation();else if(px(e,n),t&4&&-1<TS.indexOf(e)){for(;s!==null;){var i=Ju(s);if(i!==null&&Kv(i),i=$m(e,t,r,n),i===null&&_f(e,t,n,_d,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else _f(e,t,n,null,r)}}var _d=null;function $m(e,t,r,n){if(_d=null,e=N0(n),e=Ga(e),e!==null)if(t=ki(e),t===null)e=null;else if(r=t.tag,r===13){if(e=$v(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _d=e,null}function tw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yS()){case k0:return 1;case Wv:return 4;case Ed:case bS:return 16;case Gv:return 536870912;default:return 16}default:return 16}}var ia=null,C0=null,sd=null;function rw(){if(sd)return sd;var e,t=C0,r=t.length,n,s="value"in ia?ia.value:ia.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return sd=s.slice(e,1<n?1-n:void 0)}function ad(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ac(){return!0}function xx(){return!1}function Kr(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ac:xx,this.isPropagationStopped=xx,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ac)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ac)},persist:function(){},isPersistent:Ac}),t}var Gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},j0=Kr(Gl),Xu=Tt({},Gl,{view:0,detail:0}),RS=Kr(Xu),gf,xf,ho,mh=Tt({},Xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:A0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ho&&(ho&&e.type==="mousemove"?(gf=e.screenX-ho.screenX,xf=e.screenY-ho.screenY):xf=gf=0,ho=e),gf)},movementY:function(e){return"movementY"in e?e.movementY:xf}}),yx=Kr(mh),LS=Tt({},mh,{dataTransfer:0}),OS=Kr(LS),PS=Tt({},Xu,{relatedTarget:0}),yf=Kr(PS),DS=Tt({},Gl,{animationName:0,elapsedTime:0,pseudoElement:0}),MS=Kr(DS),FS=Tt({},Gl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),US=Kr(FS),BS=Tt({},Gl,{data:0}),bx=Kr(BS),HS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$S={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zS[e])?!!t[e]:!1}function A0(){return qS}var VS=Tt({},Xu,{key:function(e){if(e.key){var t=HS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ad(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?$S[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:A0,charCode:function(e){return e.type==="keypress"?ad(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ad(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WS=Kr(VS),GS=Tt({},mh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vx=Kr(GS),YS=Tt({},Xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:A0}),QS=Kr(YS),KS=Tt({},Gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZS=Kr(KS),XS=Tt({},mh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),JS=Kr(XS),eT=[9,13,27,32],I0=Ns&&"CompositionEvent"in window,Uo=null;Ns&&"documentMode"in document&&(Uo=document.documentMode);var tT=Ns&&"TextEvent"in window&&!Uo,nw=Ns&&(!I0||Uo&&8<Uo&&11>=Uo),wx=" ",Ex=!1;function sw(e,t){switch(e){case"keyup":return eT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qi=!1;function rT(e,t){switch(e){case"compositionend":return aw(t);case"keypress":return t.which!==32?null:(Ex=!0,wx);case"textInput":return e=t.data,e===wx&&Ex?null:e;default:return null}}function nT(e,t){if(qi)return e==="compositionend"||!I0&&sw(e,t)?(e=rw(),sd=C0=ia=null,qi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nw&&t.locale!=="ko"?null:t.data;default:return null}}var sT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sT[e.type]:t==="textarea"}function iw(e,t,r,n){Mv(n),t=Sd(t,"onChange"),0<t.length&&(r=new j0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Bo=null,du=null;function aT(e){xw(e,0)}function ph(e){var t=Gi(e);if(Av(t))return e}function iT(e,t){if(e==="change")return t}var lw=!1;if(Ns){var bf;if(Ns){var vf="oninput"in document;if(!vf){var kx=document.createElement("div");kx.setAttribute("oninput","return;"),vf=typeof kx.oninput=="function"}bf=vf}else bf=!1;lw=bf&&(!document.documentMode||9<document.documentMode)}function _x(){Bo&&(Bo.detachEvent("onpropertychange",ow),du=Bo=null)}function ow(e){if(e.propertyName==="value"&&ph(du)){var t=[];iw(t,du,e,N0(e)),Hv(aT,t)}}function lT(e,t,r){e==="focusin"?(_x(),Bo=t,du=r,Bo.attachEvent("onpropertychange",ow)):e==="focusout"&&_x()}function oT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ph(du)}function uT(e,t){if(e==="click")return ph(t)}function cT(e,t){if(e==="input"||e==="change")return ph(t)}function dT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var On=typeof Object.is=="function"?Object.is:dT;function hu(e,t){if(On(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!km.call(t,s)||!On(e[s],t[s]))return!1}return!0}function Sx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Tx(e,t){var r=Sx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sx(r)}}function uw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cw(){for(var e=window,t=bd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=bd(e.document)}return t}function R0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function hT(e){var t=cw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&uw(r.ownerDocument.documentElement,r)){if(n!==null&&R0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Tx(r,i);var l=Tx(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fT=Ns&&"documentMode"in document&&11>=document.documentMode,Vi=null,zm=null,Ho=null,qm=!1;function Cx(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;qm||Vi==null||Vi!==bd(n)||(n=Vi,"selectionStart"in n&&R0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ho&&hu(Ho,n)||(Ho=n,n=Sd(zm,"onSelect"),0<n.length&&(t=new j0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vi)))}function Ic(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Wi={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionend:Ic("Transition","TransitionEnd")},wf={},dw={};Ns&&(dw=document.createElement("div").style,"AnimationEvent"in window||(delete Wi.animationend.animation,delete Wi.animationiteration.animation,delete Wi.animationstart.animation),"TransitionEvent"in window||delete Wi.transitionend.transition);function gh(e){if(wf[e])return wf[e];if(!Wi[e])return e;var t=Wi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in dw)return wf[e]=t[r];return e}var hw=gh("animationend"),fw=gh("animationiteration"),mw=gh("animationstart"),pw=gh("transitionend"),gw=new Map,jx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sa(e,t){gw.set(e,t),Ni(t,[e])}for(var Ef=0;Ef<jx.length;Ef++){var Nf=jx[Ef],mT=Nf.toLowerCase(),pT=Nf[0].toUpperCase()+Nf.slice(1);Sa(mT,"on"+pT)}Sa(hw,"onAnimationEnd");Sa(fw,"onAnimationIteration");Sa(mw,"onAnimationStart");Sa("dblclick","onDoubleClick");Sa("focusin","onFocus");Sa("focusout","onBlur");Sa(pw,"onTransitionEnd");Al("onMouseEnter",["mouseout","mouseover"]);Al("onMouseLeave",["mouseout","mouseover"]);Al("onPointerEnter",["pointerout","pointerover"]);Al("onPointerLeave",["pointerout","pointerover"]);Ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ao));function Ax(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,mS(n,t,void 0,e),e.currentTarget=null}function xw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;Ax(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;Ax(s,o,c),i=u}}}if(wd)throw e=Um,wd=!1,Um=null,e}function yt(e,t){var r=t[Qm];r===void 0&&(r=t[Qm]=new Set);var n=e+"__bubble";r.has(n)||(yw(t,e,2,!1),r.add(n))}function kf(e,t,r){var n=0;t&&(n|=4),yw(r,e,n,t)}var Rc="_reactListening"+Math.random().toString(36).slice(2);function fu(e){if(!e[Rc]){e[Rc]=!0,_v.forEach(function(r){r!=="selectionchange"&&(gT.has(r)||kf(r,!1,e),kf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rc]||(t[Rc]=!0,kf("selectionchange",!1,t))}}function yw(e,t,r,n){switch(tw(t)){case 1:var s=AS;break;case 4:s=IS;break;default:s=T0}r=s.bind(null,t,r,e),s=void 0,!Fm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function _f(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=Ga(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}Hv(function(){var c=i,d=N0(r),h=[];e:{var f=gw.get(e);if(f!==void 0){var p=j0,g=e;switch(e){case"keypress":if(ad(r)===0)break e;case"keydown":case"keyup":p=WS;break;case"focusin":g="focus",p=yf;break;case"focusout":g="blur",p=yf;break;case"beforeblur":case"afterblur":p=yf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=yx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=OS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=QS;break;case hw:case fw:case mw:p=MS;break;case pw:p=ZS;break;case"scroll":p=RS;break;case"wheel":p=JS;break;case"copy":case"cut":case"paste":p=US;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=vx}var y=(t&4)!==0,v=!y&&e==="scroll",x=y?f!==null?f+"Capture":null:f;y=[];for(var b=c,w;b!==null;){w=b;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=lu(b,x),_!=null&&y.push(mu(b,_,w)))),v)break;b=b.return}0<y.length&&(f=new p(f,g,null,r,d),h.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==Dm&&(g=r.relatedTarget||r.fromElement)&&(Ga(g)||g[ks]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?Ga(g):null,g!==null&&(v=ki(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(y=yx,_="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(y=vx,_="onPointerLeave",x="onPointerEnter",b="pointer"),v=p==null?f:Gi(p),w=g==null?f:Gi(g),f=new y(_,b+"leave",p,r,d),f.target=v,f.relatedTarget=w,_=null,Ga(d)===c&&(y=new y(x,b+"enter",g,r,d),y.target=w,y.relatedTarget=v,_=y),v=_,p&&g)t:{for(y=p,x=g,b=0,w=y;w;w=Ii(w))b++;for(w=0,_=x;_;_=Ii(_))w++;for(;0<b-w;)y=Ii(y),b--;for(;0<w-b;)x=Ii(x),w--;for(;b--;){if(y===x||x!==null&&y===x.alternate)break t;y=Ii(y),x=Ii(x)}y=null}else y=null;p!==null&&Ix(h,f,p,y,!1),g!==null&&v!==null&&Ix(h,v,g,y,!0)}}e:{if(f=c?Gi(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=iT;else if(Nx(f))if(lw)k=cT;else{k=oT;var S=lT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=uT);if(k&&(k=k(e,c))){iw(h,k,r,d);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&Im(f,"number",f.value)}switch(S=c?Gi(c):window,e){case"focusin":(Nx(S)||S.contentEditable==="true")&&(Vi=S,zm=c,Ho=null);break;case"focusout":Ho=zm=Vi=null;break;case"mousedown":qm=!0;break;case"contextmenu":case"mouseup":case"dragend":qm=!1,Cx(h,r,d);break;case"selectionchange":if(fT)break;case"keydown":case"keyup":Cx(h,r,d)}var A;if(I0)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else qi?sw(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(nw&&r.locale!=="ko"&&(qi||R!=="onCompositionStart"?R==="onCompositionEnd"&&qi&&(A=rw()):(ia=d,C0="value"in ia?ia.value:ia.textContent,qi=!0)),S=Sd(c,R),0<S.length&&(R=new bx(R,e,null,r,d),h.push({event:R,listeners:S}),A?R.data=A:(A=aw(r),A!==null&&(R.data=A)))),(A=tT?rT(e,r):nT(e,r))&&(c=Sd(c,"onBeforeInput"),0<c.length&&(d=new bx("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=A))}xw(h,t)})}function mu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Sd(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lu(e,r),i!=null&&n.unshift(mu(e,i,s)),i=lu(e,t),i!=null&&n.push(mu(e,i,s))),e=e.return}return n}function Ii(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ix(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=lu(r,i),u!=null&&l.unshift(mu(r,u,o))):s||(u=lu(r,i),u!=null&&l.push(mu(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var xT=/\r\n?/g,yT=/\u0000|\uFFFD/g;function Rx(e){return(typeof e=="string"?e:""+e).replace(xT,`
`).replace(yT,"")}function Lc(e,t,r){if(t=Rx(t),Rx(e)!==t&&r)throw Error(ue(425))}function Td(){}var Vm=null,Wm=null;function Gm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ym=typeof setTimeout=="function"?setTimeout:void 0,bT=typeof clearTimeout=="function"?clearTimeout:void 0,Lx=typeof Promise=="function"?Promise:void 0,vT=typeof queueMicrotask=="function"?queueMicrotask:typeof Lx<"u"?function(e){return Lx.resolve(null).then(e).catch(wT)}:Ym;function wT(e){setTimeout(function(){throw e})}function Sf(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),cu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);cu(t)}function fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ox(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Yl=Math.random().toString(36).slice(2),Kn="__reactFiber$"+Yl,pu="__reactProps$"+Yl,ks="__reactContainer$"+Yl,Qm="__reactEvents$"+Yl,ET="__reactListeners$"+Yl,NT="__reactHandles$"+Yl;function Ga(e){var t=e[Kn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ks]||r[Kn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ox(e);e!==null;){if(r=e[Kn])return r;e=Ox(e)}return t}e=r,r=e.parentNode}return null}function Ju(e){return e=e[Kn]||e[ks],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ue(33))}function xh(e){return e[pu]||null}var Km=[],Yi=-1;function Ta(e){return{current:e}}function bt(e){0>Yi||(e.current=Km[Yi],Km[Yi]=null,Yi--)}function mt(e,t){Yi++,Km[Yi]=e.current,e.current=t}var wa={},dr=Ta(wa),Or=Ta(!1),ci=wa;function Il(e,t){var r=e.type.contextTypes;if(!r)return wa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(e){return e=e.childContextTypes,e!=null}function Cd(){bt(Or),bt(dr)}function Px(e,t,r){if(dr.current!==wa)throw Error(ue(168));mt(dr,t),mt(Or,r)}function bw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ue(108,lS(e)||"Unknown",s));return Tt({},r,n)}function jd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wa,ci=dr.current,mt(dr,e),mt(Or,Or.current),!0}function Dx(e,t,r){var n=e.stateNode;if(!n)throw Error(ue(169));r?(e=bw(e,t,ci),n.__reactInternalMemoizedMergedChildContext=e,bt(Or),bt(dr),mt(dr,e)):bt(Or),mt(Or,r)}var ms=null,yh=!1,Tf=!1;function vw(e){ms===null?ms=[e]:ms.push(e)}function kT(e){yh=!0,vw(e)}function Ca(){if(!Tf&&ms!==null){Tf=!0;var e=0,t=it;try{var r=ms;for(it=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ms=null,yh=!1}catch(s){throw ms!==null&&(ms=ms.slice(e+1)),Vv(k0,Ca),s}finally{it=t,Tf=!1}}return null}var Qi=[],Ki=0,Ad=null,Id=0,sn=[],an=0,di=null,bs=1,vs="";function $a(e,t){Qi[Ki++]=Id,Qi[Ki++]=Ad,Ad=e,Id=t}function ww(e,t,r){sn[an++]=bs,sn[an++]=vs,sn[an++]=di,di=e;var n=bs;e=vs;var s=32-Cn(n)-1;n&=~(1<<s),r+=1;var i=32-Cn(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,bs=1<<32-Cn(t)+s|r<<s|n,vs=i+e}else bs=1<<i|r<<s|n,vs=e}function L0(e){e.return!==null&&($a(e,1),ww(e,1,0))}function O0(e){for(;e===Ad;)Ad=Qi[--Ki],Qi[Ki]=null,Id=Qi[--Ki],Qi[Ki]=null;for(;e===di;)di=sn[--an],sn[an]=null,vs=sn[--an],sn[an]=null,bs=sn[--an],sn[an]=null}var Vr=null,qr=null,Et=!1,kn=null;function Ew(e,t){var r=un(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Mx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Vr=e,qr=fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Vr=e,qr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=di!==null?{id:bs,overflow:vs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=un(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Vr=e,qr=null,!0):!1;default:return!1}}function Zm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xm(e){if(Et){var t=qr;if(t){var r=t;if(!Mx(e,t)){if(Zm(e))throw Error(ue(418));t=fa(r.nextSibling);var n=Vr;t&&Mx(e,t)?Ew(n,r):(e.flags=e.flags&-4097|2,Et=!1,Vr=e)}}else{if(Zm(e))throw Error(ue(418));e.flags=e.flags&-4097|2,Et=!1,Vr=e}}}function Fx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vr=e}function Oc(e){if(e!==Vr)return!1;if(!Et)return Fx(e),Et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Gm(e.type,e.memoizedProps)),t&&(t=qr)){if(Zm(e))throw Nw(),Error(ue(418));for(;t;)Ew(e,t),t=fa(t.nextSibling)}if(Fx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){qr=fa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}qr=null}}else qr=Vr?fa(e.stateNode.nextSibling):null;return!0}function Nw(){for(var e=qr;e;)e=fa(e.nextSibling)}function Rl(){qr=Vr=null,Et=!1}function P0(e){kn===null?kn=[e]:kn.push(e)}var _T=As.ReactCurrentBatchConfig;function fo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ue(309));var n=r.stateNode}if(!n)throw Error(ue(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(ue(284));if(!r._owner)throw Error(ue(290,e))}return e}function Pc(e,t){throw e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ux(e){var t=e._init;return t(e._payload)}function kw(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=xa(x,b),x.index=0,x.sibling=null,x}function i(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,b,w,_){return b===null||b.tag!==6?(b=Of(w,x.mode,_),b.return=x,b):(b=s(b,w),b.return=x,b)}function u(x,b,w,_){var k=w.type;return k===zi?d(x,b,w.props.children,_,w.key):b!==null&&(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$s&&Ux(k)===b.type)?(_=s(b,w.props),_.ref=fo(x,b,w),_.return=x,_):(_=hd(w.type,w.key,w.props,null,x.mode,_),_.ref=fo(x,b,w),_.return=x,_)}function c(x,b,w,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=Pf(w,x.mode,_),b.return=x,b):(b=s(b,w.children||[]),b.return=x,b)}function d(x,b,w,_,k){return b===null||b.tag!==7?(b=li(w,x.mode,_,k),b.return=x,b):(b=s(b,w),b.return=x,b)}function h(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Of(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case kc:return w=hd(b.type,b.key,b.props,null,x.mode,w),w.ref=fo(x,null,b),w.return=x,w;case $i:return b=Pf(b,x.mode,w),b.return=x,b;case $s:var _=b._init;return h(x,_(b._payload),w)}if(Co(b)||lo(b))return b=li(b,x.mode,w,null),b.return=x,b;Pc(x,b)}return null}function f(x,b,w,_){var k=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:o(x,b,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case kc:return w.key===k?u(x,b,w,_):null;case $i:return w.key===k?c(x,b,w,_):null;case $s:return k=w._init,f(x,b,k(w._payload),_)}if(Co(w)||lo(w))return k!==null?null:d(x,b,w,_,null);Pc(x,w)}return null}function p(x,b,w,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,o(b,x,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case kc:return x=x.get(_.key===null?w:_.key)||null,u(b,x,_,k);case $i:return x=x.get(_.key===null?w:_.key)||null,c(b,x,_,k);case $s:var S=_._init;return p(x,b,w,S(_._payload),k)}if(Co(_)||lo(_))return x=x.get(w)||null,d(b,x,_,k,null);Pc(b,_)}return null}function g(x,b,w,_){for(var k=null,S=null,A=b,R=b=0,L=null;A!==null&&R<w.length;R++){A.index>R?(L=A,A=null):L=A.sibling;var T=f(x,A,w[R],_);if(T===null){A===null&&(A=L);break}e&&A&&T.alternate===null&&t(x,A),b=i(T,b,R),S===null?k=T:S.sibling=T,S=T,A=L}if(R===w.length)return r(x,A),Et&&$a(x,R),k;if(A===null){for(;R<w.length;R++)A=h(x,w[R],_),A!==null&&(b=i(A,b,R),S===null?k=A:S.sibling=A,S=A);return Et&&$a(x,R),k}for(A=n(x,A);R<w.length;R++)L=p(A,x,R,w[R],_),L!==null&&(e&&L.alternate!==null&&A.delete(L.key===null?R:L.key),b=i(L,b,R),S===null?k=L:S.sibling=L,S=L);return e&&A.forEach(function(z){return t(x,z)}),Et&&$a(x,R),k}function y(x,b,w,_){var k=lo(w);if(typeof k!="function")throw Error(ue(150));if(w=k.call(w),w==null)throw Error(ue(151));for(var S=k=null,A=b,R=b=0,L=null,T=w.next();A!==null&&!T.done;R++,T=w.next()){A.index>R?(L=A,A=null):L=A.sibling;var z=f(x,A,T.value,_);if(z===null){A===null&&(A=L);break}e&&A&&z.alternate===null&&t(x,A),b=i(z,b,R),S===null?k=z:S.sibling=z,S=z,A=L}if(T.done)return r(x,A),Et&&$a(x,R),k;if(A===null){for(;!T.done;R++,T=w.next())T=h(x,T.value,_),T!==null&&(b=i(T,b,R),S===null?k=T:S.sibling=T,S=T);return Et&&$a(x,R),k}for(A=n(x,A);!T.done;R++,T=w.next())T=p(A,x,R,T.value,_),T!==null&&(e&&T.alternate!==null&&A.delete(T.key===null?R:T.key),b=i(T,b,R),S===null?k=T:S.sibling=T,S=T);return e&&A.forEach(function(O){return t(x,O)}),Et&&$a(x,R),k}function v(x,b,w,_){if(typeof w=="object"&&w!==null&&w.type===zi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case kc:e:{for(var k=w.key,S=b;S!==null;){if(S.key===k){if(k=w.type,k===zi){if(S.tag===7){r(x,S.sibling),b=s(S,w.props.children),b.return=x,x=b;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$s&&Ux(k)===S.type){r(x,S.sibling),b=s(S,w.props),b.ref=fo(x,S,w),b.return=x,x=b;break e}r(x,S);break}else t(x,S);S=S.sibling}w.type===zi?(b=li(w.props.children,x.mode,_,w.key),b.return=x,x=b):(_=hd(w.type,w.key,w.props,null,x.mode,_),_.ref=fo(x,b,w),_.return=x,x=_)}return l(x);case $i:e:{for(S=w.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=s(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=Pf(w,x.mode,_),b.return=x,x=b}return l(x);case $s:return S=w._init,v(x,b,S(w._payload),_)}if(Co(w))return g(x,b,w,_);if(lo(w))return y(x,b,w,_);Pc(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,w),b.return=x,x=b):(r(x,b),b=Of(w,x.mode,_),b.return=x,x=b),l(x)):r(x,b)}return v}var Ll=kw(!0),_w=kw(!1),Rd=Ta(null),Ld=null,Zi=null,D0=null;function M0(){D0=Zi=Ld=null}function F0(e){var t=Rd.current;bt(Rd),e._currentValue=t}function Jm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function il(e,t){Ld=e,D0=Zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Lr=!0),e.firstContext=null)}function dn(e){var t=e._currentValue;if(D0!==e)if(e={context:e,memoizedValue:t,next:null},Zi===null){if(Ld===null)throw Error(ue(308));Zi=e,Ld.dependencies={lanes:0,firstContext:e}}else Zi=Zi.next=e;return t}var Ya=null;function U0(e){Ya===null?Ya=[e]:Ya.push(e)}function Sw(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,U0(t)):(r.next=s.next,s.next=r),t.interleaved=r,_s(e,n)}function _s(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var zs=!1;function B0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ws(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xe&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,_s(e,r)}return s=n.interleaved,s===null?(t.next=t,U0(n)):(t.next=s.next,s.next=t),n.interleaved=t,_s(e,r)}function id(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_0(e,r)}}function Bx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Od(e,t,r,n){var s=e.updateQueue;zs=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;l=0,d=c=u=null,o=i;do{var f=o.lane,p=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,y=o;switch(f=t,p=r,y.tag){case 1:if(g=y.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=Tt({},h,f);break e;case 2:zs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=p,u=h):d=d.next=p,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);fi|=l,e.lanes=l,e.memoizedState=h}}function Hx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ue(191,s));s.call(n)}}}var ec={},Xn=Ta(ec),gu=Ta(ec),xu=Ta(ec);function Qa(e){if(e===ec)throw Error(ue(174));return e}function H0(e,t){switch(mt(xu,t),mt(gu,e),mt(Xn,ec),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Lm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Lm(t,e)}bt(Xn),mt(Xn,t)}function Ol(){bt(Xn),bt(gu),bt(xu)}function Cw(e){Qa(xu.current);var t=Qa(Xn.current),r=Lm(t,e.type);t!==r&&(mt(gu,e),mt(Xn,r))}function $0(e){gu.current===e&&(bt(Xn),bt(gu))}var _t=Ta(0);function Pd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cf=[];function z0(){for(var e=0;e<Cf.length;e++)Cf[e]._workInProgressVersionPrimary=null;Cf.length=0}var ld=As.ReactCurrentDispatcher,jf=As.ReactCurrentBatchConfig,hi=0,St=null,Ht=null,Yt=null,Dd=!1,$o=!1,yu=0,ST=0;function sr(){throw Error(ue(321))}function q0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!On(e[r],t[r]))return!1;return!0}function V0(e,t,r,n,s,i){if(hi=i,St=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ld.current=e===null||e.memoizedState===null?AT:IT,e=r(n,s),$o){i=0;do{if($o=!1,yu=0,25<=i)throw Error(ue(301));i+=1,Yt=Ht=null,t.updateQueue=null,ld.current=RT,e=r(n,s)}while($o)}if(ld.current=Md,t=Ht!==null&&Ht.next!==null,hi=0,Yt=Ht=St=null,Dd=!1,t)throw Error(ue(300));return e}function W0(){var e=yu!==0;return yu=0,e}function $n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?St.memoizedState=Yt=e:Yt=Yt.next=e,Yt}function hn(){if(Ht===null){var e=St.alternate;e=e!==null?e.memoizedState:null}else e=Ht.next;var t=Yt===null?St.memoizedState:Yt.next;if(t!==null)Yt=t,Ht=e;else{if(e===null)throw Error(ue(310));Ht=e,e={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Yt===null?St.memoizedState=Yt=e:Yt=Yt.next=e}return Yt}function bu(e,t){return typeof t=="function"?t(e):t}function Af(e){var t=hn(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=Ht,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var d=c.lane;if((hi&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,l=n):u=u.next=h,St.lanes|=d,fi|=d}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,On(n,t.memoizedState)||(Lr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,St.lanes|=i,fi|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function If(e){var t=hn(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);On(i,t.memoizedState)||(Lr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function jw(){}function Aw(e,t){var r=St,n=hn(),s=t(),i=!On(n.memoizedState,s);if(i&&(n.memoizedState=s,Lr=!0),n=n.queue,G0(Lw.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Yt!==null&&Yt.memoizedState.tag&1){if(r.flags|=2048,vu(9,Rw.bind(null,r,n,s,t),void 0,null),Zt===null)throw Error(ue(349));hi&30||Iw(r,t,s)}return s}function Iw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=St.updateQueue,t===null?(t={lastEffect:null,stores:null},St.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rw(e,t,r,n){t.value=r,t.getSnapshot=n,Ow(t)&&Pw(e)}function Lw(e,t,r){return r(function(){Ow(t)&&Pw(e)})}function Ow(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!On(e,r)}catch{return!0}}function Pw(e){var t=_s(e,1);t!==null&&jn(t,e,1,-1)}function $x(e){var t=$n();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:e},t.queue=e,e=e.dispatch=jT.bind(null,St,e),[t.memoizedState,e]}function vu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=St.updateQueue,t===null?(t={lastEffect:null,stores:null},St.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Dw(){return hn().memoizedState}function od(e,t,r,n){var s=$n();St.flags|=e,s.memoizedState=vu(1|t,r,void 0,n===void 0?null:n)}function bh(e,t,r,n){var s=hn();n=n===void 0?null:n;var i=void 0;if(Ht!==null){var l=Ht.memoizedState;if(i=l.destroy,n!==null&&q0(n,l.deps)){s.memoizedState=vu(t,r,i,n);return}}St.flags|=e,s.memoizedState=vu(1|t,r,i,n)}function zx(e,t){return od(8390656,8,e,t)}function G0(e,t){return bh(2048,8,e,t)}function Mw(e,t){return bh(4,2,e,t)}function Fw(e,t){return bh(4,4,e,t)}function Uw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Bw(e,t,r){return r=r!=null?r.concat([e]):null,bh(4,4,Uw.bind(null,t,e),r)}function Y0(){}function Hw(e,t){var r=hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&q0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $w(e,t){var r=hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&q0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function zw(e,t,r){return hi&21?(On(r,t)||(r=Yv(),St.lanes|=r,fi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=r)}function TT(e,t){var r=it;it=r!==0&&4>r?r:4,e(!0);var n=jf.transition;jf.transition={};try{e(!1),t()}finally{it=r,jf.transition=n}}function qw(){return hn().memoizedState}function CT(e,t,r){var n=ga(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Vw(e))Ww(t,r);else if(r=Sw(e,t,r,n),r!==null){var s=wr();jn(r,e,n,s),Gw(r,t,n)}}function jT(e,t,r){var n=ga(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Vw(e))Ww(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,On(o,l)){var u=t.interleaved;u===null?(s.next=s,U0(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=Sw(e,t,s,n),r!==null&&(s=wr(),jn(r,e,n,s),Gw(r,t,n))}}function Vw(e){var t=e.alternate;return e===St||t!==null&&t===St}function Ww(e,t){$o=Dd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Gw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_0(e,r)}}var Md={readContext:dn,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useInsertionEffect:sr,useLayoutEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useMutableSource:sr,useSyncExternalStore:sr,useId:sr,unstable_isNewReconciler:!1},AT={readContext:dn,useCallback:function(e,t){return $n().memoizedState=[e,t===void 0?null:t],e},useContext:dn,useEffect:zx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,od(4194308,4,Uw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return od(4194308,4,e,t)},useInsertionEffect:function(e,t){return od(4,2,e,t)},useMemo:function(e,t){var r=$n();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=$n();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=CT.bind(null,St,e),[n.memoizedState,e]},useRef:function(e){var t=$n();return e={current:e},t.memoizedState=e},useState:$x,useDebugValue:Y0,useDeferredValue:function(e){return $n().memoizedState=e},useTransition:function(){var e=$x(!1),t=e[0];return e=TT.bind(null,e[1]),$n().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=St,s=$n();if(Et){if(r===void 0)throw Error(ue(407));r=r()}else{if(r=t(),Zt===null)throw Error(ue(349));hi&30||Iw(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,zx(Lw.bind(null,n,i,e),[e]),n.flags|=2048,vu(9,Rw.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=$n(),t=Zt.identifierPrefix;if(Et){var r=vs,n=bs;r=(n&~(1<<32-Cn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=yu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ST++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},IT={readContext:dn,useCallback:Hw,useContext:dn,useEffect:G0,useImperativeHandle:Bw,useInsertionEffect:Mw,useLayoutEffect:Fw,useMemo:$w,useReducer:Af,useRef:Dw,useState:function(){return Af(bu)},useDebugValue:Y0,useDeferredValue:function(e){var t=hn();return zw(t,Ht.memoizedState,e)},useTransition:function(){var e=Af(bu)[0],t=hn().memoizedState;return[e,t]},useMutableSource:jw,useSyncExternalStore:Aw,useId:qw,unstable_isNewReconciler:!1},RT={readContext:dn,useCallback:Hw,useContext:dn,useEffect:G0,useImperativeHandle:Bw,useInsertionEffect:Mw,useLayoutEffect:Fw,useMemo:$w,useReducer:If,useRef:Dw,useState:function(){return If(bu)},useDebugValue:Y0,useDeferredValue:function(e){var t=hn();return Ht===null?t.memoizedState=e:zw(t,Ht.memoizedState,e)},useTransition:function(){var e=If(bu)[0],t=hn().memoizedState;return[e,t]},useMutableSource:jw,useSyncExternalStore:Aw,useId:qw,unstable_isNewReconciler:!1};function bn(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ep(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var vh={isMounted:function(e){return(e=e._reactInternals)?ki(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=wr(),s=ga(e),i=ws(n,s);i.payload=t,r!=null&&(i.callback=r),t=ma(e,i,s),t!==null&&(jn(t,e,s,n),id(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=wr(),s=ga(e),i=ws(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ma(e,i,s),t!==null&&(jn(t,e,s,n),id(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=wr(),n=ga(e),s=ws(r,n);s.tag=2,t!=null&&(s.callback=t),t=ma(e,s,n),t!==null&&(jn(t,e,n,r),id(t,e,n))}};function qx(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!hu(r,n)||!hu(s,i):!0}function Yw(e,t,r){var n=!1,s=wa,i=t.contextType;return typeof i=="object"&&i!==null?i=dn(i):(s=Pr(t)?ci:dr.current,n=t.contextTypes,i=(n=n!=null)?Il(e,s):wa),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&vh.enqueueReplaceState(t,t.state,null)}function tp(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},B0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=dn(i):(i=Pr(t)?ci:dr.current,s.context=Il(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ep(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&vh.enqueueReplaceState(s,s.state,null),Od(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Pl(e,t){try{var r="",n=t;do r+=iS(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Rf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function rp(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var LT=typeof WeakMap=="function"?WeakMap:Map;function Qw(e,t,r){r=ws(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ud||(Ud=!0,hp=n),rp(e,t)},r}function Kw(e,t,r){r=ws(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){rp(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){rp(e,t),typeof n!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Wx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new LT;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=GT.bind(null,e,t,r),t.then(e,e))}function Gx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Yx(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ws(-1,1),t.tag=2,ma(r,t,1))),r.lanes|=1),e)}var OT=As.ReactCurrentOwner,Lr=!1;function br(e,t,r,n){t.child=e===null?_w(t,null,r,n):Ll(t,e.child,r,n)}function Qx(e,t,r,n,s){r=r.render;var i=t.ref;return il(t,s),n=V0(e,t,r,n,i,s),r=W0(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ss(e,t,s)):(Et&&r&&L0(t),t.flags|=1,br(e,t,n,s),t.child)}function Kx(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!rg(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Zw(e,t,i,n,s)):(e=hd(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:hu,r(l,n)&&e.ref===t.ref)return Ss(e,t,s)}return t.flags|=1,e=xa(i,n),e.ref=t.ref,e.return=t,t.child=e}function Zw(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(hu(i,n)&&e.ref===t.ref)if(Lr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Lr=!0);else return t.lanes=e.lanes,Ss(e,t,s)}return np(e,t,r,n,s)}function Xw(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Ji,$r),$r|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(Ji,$r),$r|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,mt(Ji,$r),$r|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,mt(Ji,$r),$r|=n;return br(e,t,s,r),t.child}function Jw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function np(e,t,r,n,s){var i=Pr(r)?ci:dr.current;return i=Il(t,i),il(t,s),r=V0(e,t,r,n,i,s),n=W0(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ss(e,t,s)):(Et&&n&&L0(t),t.flags|=1,br(e,t,r,s),t.child)}function Zx(e,t,r,n,s){if(Pr(r)){var i=!0;jd(t)}else i=!1;if(il(t,s),t.stateNode===null)ud(e,t),Yw(t,r,n),tp(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=dn(c):(c=Pr(r)?ci:dr.current,c=Il(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&Vx(t,l,n,c),zs=!1;var f=t.memoizedState;l.state=f,Od(t,n,l,s),u=t.memoizedState,o!==n||f!==u||Or.current||zs?(typeof d=="function"&&(ep(t,r,d,n),u=t.memoizedState),(o=zs||qx(t,r,o,n,f,u,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Tw(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:bn(t.type,o),l.props=c,h=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=dn(u):(u=Pr(r)?ci:dr.current,u=Il(t,u));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==u)&&Vx(t,l,n,u),zs=!1,f=t.memoizedState,l.state=f,Od(t,n,l,s);var g=t.memoizedState;o!==h||f!==g||Or.current||zs?(typeof p=="function"&&(ep(t,r,p,n),g=t.memoizedState),(c=zs||qx(t,r,c,n,f,g,u)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return sp(e,t,r,n,i,s)}function sp(e,t,r,n,s,i){Jw(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&Dx(t,r,!1),Ss(e,t,i);n=t.stateNode,OT.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=Ll(t,e.child,null,i),t.child=Ll(t,null,o,i)):br(e,t,o,i),t.memoizedState=n.state,s&&Dx(t,r,!0),t.child}function e2(e){var t=e.stateNode;t.pendingContext?Px(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Px(e,t.context,!1),H0(e,t.containerInfo)}function Xx(e,t,r,n,s){return Rl(),P0(s),t.flags|=256,br(e,t,r,n),t.child}var ap={dehydrated:null,treeContext:null,retryLane:0};function ip(e){return{baseLanes:e,cachePool:null,transitions:null}}function t2(e,t,r){var n=t.pendingProps,s=_t.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),mt(_t,s&1),e===null)return Xm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Nh(l,n,0,null),e=li(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=ip(r),t.memoizedState=ap,e):Q0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return PT(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=xa(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=xa(o,i):(i=li(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?ip(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=ap,n}return i=e.child,e=i.sibling,n=xa(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Q0(e,t){return t=Nh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dc(e,t,r,n){return n!==null&&P0(n),Ll(t,e.child,null,r),e=Q0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function PT(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=Rf(Error(ue(422))),Dc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Nh({mode:"visible",children:n.children},s,0,null),i=li(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Ll(t,e.child,null,l),t.child.memoizedState=ip(l),t.memoizedState=ap,i);if(!(t.mode&1))return Dc(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ue(419)),n=Rf(i,n,void 0),Dc(e,t,l,n)}if(o=(l&e.childLanes)!==0,Lr||o){if(n=Zt,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,_s(e,s),jn(n,e,s,-1))}return tg(),n=Rf(Error(ue(421))),Dc(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=YT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,qr=fa(s.nextSibling),Vr=t,Et=!0,kn=null,e!==null&&(sn[an++]=bs,sn[an++]=vs,sn[an++]=di,bs=e.id,vs=e.overflow,di=t),t=Q0(t,n.children),t.flags|=4096,t)}function Jx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Jm(e.return,t,r)}function Lf(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function r2(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(br(e,t,n.children,r),n=_t.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jx(e,r,t);else if(e.tag===19)Jx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mt(_t,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Pd(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Lf(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Pd(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Lf(t,!0,r,null,i);break;case"together":Lf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ud(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ss(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),fi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,r=xa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function DT(e,t,r){switch(t.tag){case 3:e2(t),Rl();break;case 5:Cw(t);break;case 1:Pr(t.type)&&jd(t);break;case 4:H0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;mt(Rd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mt(_t,_t.current&1),t.flags|=128,null):r&t.child.childLanes?t2(e,t,r):(mt(_t,_t.current&1),e=Ss(e,t,r),e!==null?e.sibling:null);mt(_t,_t.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return r2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),mt(_t,_t.current),n)break;return null;case 22:case 23:return t.lanes=0,Xw(e,t,r)}return Ss(e,t,r)}var n2,lp,s2,a2;n2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};lp=function(){};s2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Qa(Xn.current);var i=null;switch(r){case"input":s=jm(e,s),n=jm(e,n),i=[];break;case"select":s=Tt({},s,{value:void 0}),n=Tt({},n,{value:void 0}),i=[];break;case"textarea":s=Rm(e,s),n=Rm(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Td)}Om(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(au.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(au.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&yt("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};a2=function(e,t,r,n){r!==n&&(t.flags|=4)};function mo(e,t){if(!Et)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ar(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function MT(e,t,r){var n=t.pendingProps;switch(O0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(t),null;case 1:return Pr(t.type)&&Cd(),ar(t),null;case 3:return n=t.stateNode,Ol(),bt(Or),bt(dr),z0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Oc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kn!==null&&(pp(kn),kn=null))),lp(e,t),ar(t),null;case 5:$0(t);var s=Qa(xu.current);if(r=t.type,e!==null&&t.stateNode!=null)s2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ue(166));return ar(t),null}if(e=Qa(Xn.current),Oc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Kn]=t,n[pu]=i,e=(t.mode&1)!==0,r){case"dialog":yt("cancel",n),yt("close",n);break;case"iframe":case"object":case"embed":yt("load",n);break;case"video":case"audio":for(s=0;s<Ao.length;s++)yt(Ao[s],n);break;case"source":yt("error",n);break;case"img":case"image":case"link":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"input":ox(n,i),yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},yt("invalid",n);break;case"textarea":cx(n,i),yt("invalid",n)}Om(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Lc(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Lc(n.textContent,o,e),s=["children",""+o]):au.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&yt("scroll",n)}switch(r){case"input":_c(n),ux(n,i,!0);break;case"textarea":_c(n),dx(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Td)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Lv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Kn]=t,e[pu]=n,n2(e,t,!1,!1),t.stateNode=e;e:{switch(l=Pm(r,n),r){case"dialog":yt("cancel",e),yt("close",e),s=n;break;case"iframe":case"object":case"embed":yt("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ao.length;s++)yt(Ao[s],e);s=n;break;case"source":yt("error",e),s=n;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=n;break;case"details":yt("toggle",e),s=n;break;case"input":ox(e,n),s=jm(e,n),yt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Tt({},n,{value:void 0}),yt("invalid",e);break;case"textarea":cx(e,n),s=Rm(e,n),yt("invalid",e);break;default:s=n}Om(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?Dv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Ov(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&iu(e,u):typeof u=="number"&&iu(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(au.hasOwnProperty(i)?u!=null&&i==="onScroll"&&yt("scroll",e):u!=null&&b0(e,i,u,l))}switch(r){case"input":_c(e),ux(e,n,!1);break;case"textarea":_c(e),dx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+va(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?rl(e,!!n.multiple,i,!1):n.defaultValue!=null&&rl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Td)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ar(t),null;case 6:if(e&&t.stateNode!=null)a2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ue(166));if(r=Qa(xu.current),Qa(Xn.current),Oc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Kn]=t,(i=n.nodeValue!==r)&&(e=Vr,e!==null))switch(e.tag){case 3:Lc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Lc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Kn]=t,t.stateNode=n}return ar(t),null;case 13:if(bt(_t),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Et&&qr!==null&&t.mode&1&&!(t.flags&128))Nw(),Rl(),t.flags|=98560,i=!1;else if(i=Oc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ue(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));i[Kn]=t}else Rl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ar(t),i=!1}else kn!==null&&(pp(kn),kn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?zt===0&&(zt=3):tg())),t.updateQueue!==null&&(t.flags|=4),ar(t),null);case 4:return Ol(),lp(e,t),e===null&&fu(t.stateNode.containerInfo),ar(t),null;case 10:return F0(t.type._context),ar(t),null;case 17:return Pr(t.type)&&Cd(),ar(t),null;case 19:if(bt(_t),i=t.memoizedState,i===null)return ar(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)mo(i,!1);else{if(zt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Pd(e),l!==null){for(t.flags|=128,mo(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(_t,_t.current&1|2),t.child}e=e.sibling}i.tail!==null&&Lt()>Dl&&(t.flags|=128,n=!0,mo(i,!1),t.lanes=4194304)}else{if(!n)if(e=Pd(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),mo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Et)return ar(t),null}else 2*Lt()-i.renderingStartTime>Dl&&r!==1073741824&&(t.flags|=128,n=!0,mo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Lt(),t.sibling=null,r=_t.current,mt(_t,n?r&1|2:r&1),t):(ar(t),null);case 22:case 23:return eg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?$r&1073741824&&(ar(t),t.subtreeFlags&6&&(t.flags|=8192)):ar(t),null;case 24:return null;case 25:return null}throw Error(ue(156,t.tag))}function FT(e,t){switch(O0(t),t.tag){case 1:return Pr(t.type)&&Cd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ol(),bt(Or),bt(dr),z0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $0(t),null;case 13:if(bt(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));Rl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return bt(_t),null;case 4:return Ol(),null;case 10:return F0(t.type._context),null;case 22:case 23:return eg(),null;case 24:return null;default:return null}}var Mc=!1,lr=!1,UT=typeof WeakSet=="function"?WeakSet:Set,be=null;function Xi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){At(e,t,n)}else r.current=null}function op(e,t,r){try{r()}catch(n){At(e,t,n)}}var ey=!1;function BT(e,t){if(Vm=kd,e=cw(),R0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=l+s),h!==i||n!==0&&h.nodeType!==3||(u=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++d===n&&(u=l),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Wm={focusedElem:e,selectionRange:r},kd=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,v=g.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:bn(t.type,y),v);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(_){At(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return g=ey,ey=!1,g}function zo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&op(t,r,i)}s=s.next}while(s!==n)}}function wh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function up(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function i2(e){var t=e.alternate;t!==null&&(e.alternate=null,i2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Kn],delete t[pu],delete t[Qm],delete t[ET],delete t[NT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function l2(e){return e.tag===5||e.tag===3||e.tag===4}function ty(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||l2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Td));else if(n!==4&&(e=e.child,e!==null))for(cp(e,t,r),e=e.sibling;e!==null;)cp(e,t,r),e=e.sibling}function dp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(dp(e,t,r),e=e.sibling;e!==null;)dp(e,t,r),e=e.sibling}var Jt=null,En=!1;function Ls(e,t,r){for(r=r.child;r!==null;)o2(e,t,r),r=r.sibling}function o2(e,t,r){if(Zn&&typeof Zn.onCommitFiberUnmount=="function")try{Zn.onCommitFiberUnmount(fh,r)}catch{}switch(r.tag){case 5:lr||Xi(r,t);case 6:var n=Jt,s=En;Jt=null,Ls(e,t,r),Jt=n,En=s,Jt!==null&&(En?(e=Jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Jt.removeChild(r.stateNode));break;case 18:Jt!==null&&(En?(e=Jt,r=r.stateNode,e.nodeType===8?Sf(e.parentNode,r):e.nodeType===1&&Sf(e,r),cu(e)):Sf(Jt,r.stateNode));break;case 4:n=Jt,s=En,Jt=r.stateNode.containerInfo,En=!0,Ls(e,t,r),Jt=n,En=s;break;case 0:case 11:case 14:case 15:if(!lr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&op(r,t,l),s=s.next}while(s!==n)}Ls(e,t,r);break;case 1:if(!lr&&(Xi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){At(r,t,o)}Ls(e,t,r);break;case 21:Ls(e,t,r);break;case 22:r.mode&1?(lr=(n=lr)||r.memoizedState!==null,Ls(e,t,r),lr=n):Ls(e,t,r);break;default:Ls(e,t,r)}}function ry(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new UT),t.forEach(function(n){var s=QT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function yn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Jt=o.stateNode,En=!1;break e;case 3:Jt=o.stateNode.containerInfo,En=!0;break e;case 4:Jt=o.stateNode.containerInfo,En=!0;break e}o=o.return}if(Jt===null)throw Error(ue(160));o2(i,l,s),Jt=null,En=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){At(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)u2(t,e),t=t.sibling}function u2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yn(t,e),Bn(e),n&4){try{zo(3,e,e.return),wh(3,e)}catch(y){At(e,e.return,y)}try{zo(5,e,e.return)}catch(y){At(e,e.return,y)}}break;case 1:yn(t,e),Bn(e),n&512&&r!==null&&Xi(r,r.return);break;case 5:if(yn(t,e),Bn(e),n&512&&r!==null&&Xi(r,r.return),e.flags&32){var s=e.stateNode;try{iu(s,"")}catch(y){At(e,e.return,y)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Iv(s,i),Pm(o,l);var c=Pm(o,i);for(l=0;l<u.length;l+=2){var d=u[l],h=u[l+1];d==="style"?Dv(s,h):d==="dangerouslySetInnerHTML"?Ov(s,h):d==="children"?iu(s,h):b0(s,d,h,c)}switch(o){case"input":Am(s,i);break;case"textarea":Rv(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?rl(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?rl(s,!!i.multiple,i.defaultValue,!0):rl(s,!!i.multiple,i.multiple?[]:"",!1))}s[pu]=i}catch(y){At(e,e.return,y)}}break;case 6:if(yn(t,e),Bn(e),n&4){if(e.stateNode===null)throw Error(ue(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(y){At(e,e.return,y)}}break;case 3:if(yn(t,e),Bn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{cu(t.containerInfo)}catch(y){At(e,e.return,y)}break;case 4:yn(t,e),Bn(e);break;case 13:yn(t,e),Bn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(X0=Lt())),n&4&&ry(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(lr=(c=lr)||d,yn(t,e),lr=c):yn(t,e),Bn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(be=e,d=e.child;d!==null;){for(h=be=d;be!==null;){switch(f=be,p=f.child,f.tag){case 0:case 11:case 14:case 15:zo(4,f,f.return);break;case 1:Xi(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(y){At(n,r,y)}}break;case 5:Xi(f,f.return);break;case 22:if(f.memoizedState!==null){sy(h);continue}}p!==null?(p.return=f,be=p):sy(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,u=h.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=Pv("display",l))}catch(y){At(e,e.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(y){At(e,e.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yn(t,e),Bn(e),n&4&&ry(e);break;case 21:break;default:yn(t,e),Bn(e)}}function Bn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(l2(r)){var n=r;break e}r=r.return}throw Error(ue(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(iu(s,""),n.flags&=-33);var i=ty(e);dp(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=ty(e);cp(e,o,l);break;default:throw Error(ue(161))}}catch(u){At(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function HT(e,t,r){be=e,c2(e)}function c2(e,t,r){for(var n=(e.mode&1)!==0;be!==null;){var s=be,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||Mc;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||lr;o=Mc;var c=lr;if(Mc=l,(lr=u)&&!c)for(be=s;be!==null;)l=be,u=l.child,l.tag===22&&l.memoizedState!==null?ay(s):u!==null?(u.return=l,be=u):ay(s);for(;i!==null;)be=i,c2(i),i=i.sibling;be=s,Mc=o,lr=c}ny(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,be=i):ny(e)}}function ny(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:lr||wh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!lr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:bn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Hx(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hx(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&cu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}lr||t.flags&512&&up(t)}catch(f){At(t,t.return,f)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function sy(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function ay(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wh(4,t)}catch(u){At(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){At(t,s,u)}}var i=t.return;try{up(t)}catch(u){At(t,i,u)}break;case 5:var l=t.return;try{up(t)}catch(u){At(t,l,u)}}}catch(u){At(t,t.return,u)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var $T=Math.ceil,Fd=As.ReactCurrentDispatcher,K0=As.ReactCurrentOwner,cn=As.ReactCurrentBatchConfig,Xe=0,Zt=null,Ft=null,er=0,$r=0,Ji=Ta(0),zt=0,wu=null,fi=0,Eh=0,Z0=0,qo=null,Ir=null,X0=0,Dl=1/0,hs=null,Ud=!1,hp=null,pa=null,Fc=!1,la=null,Bd=0,Vo=0,fp=null,cd=-1,dd=0;function wr(){return Xe&6?Lt():cd!==-1?cd:cd=Lt()}function ga(e){return e.mode&1?Xe&2&&er!==0?er&-er:_T.transition!==null?(dd===0&&(dd=Yv()),dd):(e=it,e!==0||(e=window.event,e=e===void 0?16:tw(e.type)),e):1}function jn(e,t,r,n){if(50<Vo)throw Vo=0,fp=null,Error(ue(185));Zu(e,r,n),(!(Xe&2)||e!==Zt)&&(e===Zt&&(!(Xe&2)&&(Eh|=r),zt===4&&Ys(e,er)),Dr(e,n),r===1&&Xe===0&&!(t.mode&1)&&(Dl=Lt()+500,yh&&Ca()))}function Dr(e,t){var r=e.callbackNode;_S(e,t);var n=Nd(e,e===Zt?er:0);if(n===0)r!==null&&mx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&mx(r),t===1)e.tag===0?kT(iy.bind(null,e)):vw(iy.bind(null,e)),vT(function(){!(Xe&6)&&Ca()}),r=null;else{switch(Qv(n)){case 1:r=k0;break;case 4:r=Wv;break;case 16:r=Ed;break;case 536870912:r=Gv;break;default:r=Ed}r=y2(r,d2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function d2(e,t){if(cd=-1,dd=0,Xe&6)throw Error(ue(327));var r=e.callbackNode;if(ll()&&e.callbackNode!==r)return null;var n=Nd(e,e===Zt?er:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Hd(e,n);else{t=n;var s=Xe;Xe|=2;var i=f2();(Zt!==e||er!==t)&&(hs=null,Dl=Lt()+500,ii(e,t));do try{VT();break}catch(o){h2(e,o)}while(!0);M0(),Fd.current=i,Xe=s,Ft!==null?t=0:(Zt=null,er=0,t=zt)}if(t!==0){if(t===2&&(s=Bm(e),s!==0&&(n=s,t=mp(e,s))),t===1)throw r=wu,ii(e,0),Ys(e,n),Dr(e,Lt()),r;if(t===6)Ys(e,n);else{if(s=e.current.alternate,!(n&30)&&!zT(s)&&(t=Hd(e,n),t===2&&(i=Bm(e),i!==0&&(n=i,t=mp(e,i))),t===1))throw r=wu,ii(e,0),Ys(e,n),Dr(e,Lt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ue(345));case 2:za(e,Ir,hs);break;case 3:if(Ys(e,n),(n&130023424)===n&&(t=X0+500-Lt(),10<t)){if(Nd(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){wr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Ym(za.bind(null,e,Ir,hs),t);break}za(e,Ir,hs);break;case 4:if(Ys(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-Cn(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=Lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*$T(n/1960))-n,10<n){e.timeoutHandle=Ym(za.bind(null,e,Ir,hs),n);break}za(e,Ir,hs);break;case 5:za(e,Ir,hs);break;default:throw Error(ue(329))}}}return Dr(e,Lt()),e.callbackNode===r?d2.bind(null,e):null}function mp(e,t){var r=qo;return e.current.memoizedState.isDehydrated&&(ii(e,t).flags|=256),e=Hd(e,t),e!==2&&(t=Ir,Ir=r,t!==null&&pp(t)),e}function pp(e){Ir===null?Ir=e:Ir.push.apply(Ir,e)}function zT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ys(e,t){for(t&=~Z0,t&=~Eh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Cn(t),n=1<<r;e[r]=-1,t&=~n}}function iy(e){if(Xe&6)throw Error(ue(327));ll();var t=Nd(e,0);if(!(t&1))return Dr(e,Lt()),null;var r=Hd(e,t);if(e.tag!==0&&r===2){var n=Bm(e);n!==0&&(t=n,r=mp(e,n))}if(r===1)throw r=wu,ii(e,0),Ys(e,t),Dr(e,Lt()),r;if(r===6)throw Error(ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,za(e,Ir,hs),Dr(e,Lt()),null}function J0(e,t){var r=Xe;Xe|=1;try{return e(t)}finally{Xe=r,Xe===0&&(Dl=Lt()+500,yh&&Ca())}}function mi(e){la!==null&&la.tag===0&&!(Xe&6)&&ll();var t=Xe;Xe|=1;var r=cn.transition,n=it;try{if(cn.transition=null,it=1,e)return e()}finally{it=n,cn.transition=r,Xe=t,!(Xe&6)&&Ca()}}function eg(){$r=Ji.current,bt(Ji)}function ii(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,bT(r)),Ft!==null)for(r=Ft.return;r!==null;){var n=r;switch(O0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Cd();break;case 3:Ol(),bt(Or),bt(dr),z0();break;case 5:$0(n);break;case 4:Ol();break;case 13:bt(_t);break;case 19:bt(_t);break;case 10:F0(n.type._context);break;case 22:case 23:eg()}r=r.return}if(Zt=e,Ft=e=xa(e.current,null),er=$r=t,zt=0,wu=null,Z0=Eh=fi=0,Ir=qo=null,Ya!==null){for(t=0;t<Ya.length;t++)if(r=Ya[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}Ya=null}return e}function h2(e,t){do{var r=Ft;try{if(M0(),ld.current=Md,Dd){for(var n=St.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Dd=!1}if(hi=0,Yt=Ht=St=null,$o=!1,yu=0,K0.current=null,r===null||r.return===null){zt=1,wu=t,Ft=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=er,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Gx(l);if(p!==null){p.flags&=-257,Yx(p,l,o,i,t),p.mode&1&&Wx(i,c,t),t=p,u=c;var g=t.updateQueue;if(g===null){var y=new Set;y.add(u),t.updateQueue=y}else g.add(u);break e}else{if(!(t&1)){Wx(i,c,t),tg();break e}u=Error(ue(426))}}else if(Et&&o.mode&1){var v=Gx(l);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Yx(v,l,o,i,t),P0(Pl(u,o));break e}}i=u=Pl(u,o),zt!==4&&(zt=2),qo===null?qo=[i]:qo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Qw(i,u,t);Bx(i,x);break e;case 1:o=u;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(pa===null||!pa.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Kw(i,o,t);Bx(i,_);break e}}i=i.return}while(i!==null)}p2(r)}catch(k){t=k,Ft===r&&r!==null&&(Ft=r=r.return);continue}break}while(!0)}function f2(){var e=Fd.current;return Fd.current=Md,e===null?Md:e}function tg(){(zt===0||zt===3||zt===2)&&(zt=4),Zt===null||!(fi&268435455)&&!(Eh&268435455)||Ys(Zt,er)}function Hd(e,t){var r=Xe;Xe|=2;var n=f2();(Zt!==e||er!==t)&&(hs=null,ii(e,t));do try{qT();break}catch(s){h2(e,s)}while(!0);if(M0(),Xe=r,Fd.current=n,Ft!==null)throw Error(ue(261));return Zt=null,er=0,zt}function qT(){for(;Ft!==null;)m2(Ft)}function VT(){for(;Ft!==null&&!gS();)m2(Ft)}function m2(e){var t=x2(e.alternate,e,$r);e.memoizedProps=e.pendingProps,t===null?p2(e):Ft=t,K0.current=null}function p2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=FT(r,t),r!==null){r.flags&=32767,Ft=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{zt=6,Ft=null;return}}else if(r=MT(r,t,$r),r!==null){Ft=r;return}if(t=t.sibling,t!==null){Ft=t;return}Ft=t=e}while(t!==null);zt===0&&(zt=5)}function za(e,t,r){var n=it,s=cn.transition;try{cn.transition=null,it=1,WT(e,t,r,n)}finally{cn.transition=s,it=n}return null}function WT(e,t,r,n){do ll();while(la!==null);if(Xe&6)throw Error(ue(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ue(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(SS(e,i),e===Zt&&(Ft=Zt=null,er=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fc||(Fc=!0,y2(Ed,function(){return ll(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=cn.transition,cn.transition=null;var l=it;it=1;var o=Xe;Xe|=4,K0.current=null,BT(e,r),u2(r,e),hT(Wm),kd=!!Vm,Wm=Vm=null,e.current=r,HT(r),xS(),Xe=o,it=l,cn.transition=i}else e.current=r;if(Fc&&(Fc=!1,la=e,Bd=s),i=e.pendingLanes,i===0&&(pa=null),vS(r.stateNode),Dr(e,Lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ud)throw Ud=!1,e=hp,hp=null,e;return Bd&1&&e.tag!==0&&ll(),i=e.pendingLanes,i&1?e===fp?Vo++:(Vo=0,fp=e):Vo=0,Ca(),null}function ll(){if(la!==null){var e=Qv(Bd),t=cn.transition,r=it;try{if(cn.transition=null,it=16>e?16:e,la===null)var n=!1;else{if(e=la,la=null,Bd=0,Xe&6)throw Error(ue(331));var s=Xe;for(Xe|=4,be=e.current;be!==null;){var i=be,l=i.child;if(be.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(be=c;be!==null;){var d=be;switch(d.tag){case 0:case 11:case 15:zo(8,d,i)}var h=d.child;if(h!==null)h.return=d,be=h;else for(;be!==null;){d=be;var f=d.sibling,p=d.return;if(i2(d),d===c){be=null;break}if(f!==null){f.return=p,be=f;break}be=p}}}var g=i.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}be=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,be=l;else e:for(;be!==null;){if(i=be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zo(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,be=x;break e}be=i.return}}var b=e.current;for(be=b;be!==null;){l=be;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,be=w;else e:for(l=b;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wh(9,o)}}catch(k){At(o,o.return,k)}if(o===l){be=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,be=_;break e}be=o.return}}if(Xe=s,Ca(),Zn&&typeof Zn.onPostCommitFiberRoot=="function")try{Zn.onPostCommitFiberRoot(fh,e)}catch{}n=!0}return n}finally{it=r,cn.transition=t}}return!1}function ly(e,t,r){t=Pl(r,t),t=Qw(e,t,1),e=ma(e,t,1),t=wr(),e!==null&&(Zu(e,1,t),Dr(e,t))}function At(e,t,r){if(e.tag===3)ly(e,e,r);else for(;t!==null;){if(t.tag===3){ly(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(pa===null||!pa.has(n))){e=Pl(r,e),e=Kw(t,e,1),t=ma(t,e,1),e=wr(),t!==null&&(Zu(t,1,e),Dr(t,e));break}}t=t.return}}function GT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=wr(),e.pingedLanes|=e.suspendedLanes&r,Zt===e&&(er&r)===r&&(zt===4||zt===3&&(er&130023424)===er&&500>Lt()-X0?ii(e,0):Z0|=r),Dr(e,t)}function g2(e,t){t===0&&(e.mode&1?(t=Cc,Cc<<=1,!(Cc&130023424)&&(Cc=4194304)):t=1);var r=wr();e=_s(e,t),e!==null&&(Zu(e,t,r),Dr(e,r))}function YT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),g2(e,r)}function QT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ue(314))}n!==null&&n.delete(t),g2(e,r)}var x2;x2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Or.current)Lr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Lr=!1,DT(e,t,r);Lr=!!(e.flags&131072)}else Lr=!1,Et&&t.flags&1048576&&ww(t,Id,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ud(e,t),e=t.pendingProps;var s=Il(t,dr.current);il(t,r),s=V0(null,t,n,e,s,r);var i=W0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(n)?(i=!0,jd(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,B0(t),s.updater=vh,t.stateNode=s,s._reactInternals=t,tp(t,n,e,r),t=sp(null,t,n,!0,i,r)):(t.tag=0,Et&&i&&L0(t),br(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ud(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=ZT(n),e=bn(n,e),s){case 0:t=np(null,t,n,e,r);break e;case 1:t=Zx(null,t,n,e,r);break e;case 11:t=Qx(null,t,n,e,r);break e;case 14:t=Kx(null,t,n,bn(n.type,e),r);break e}throw Error(ue(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),np(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),Zx(e,t,n,s,r);case 3:e:{if(e2(t),e===null)throw Error(ue(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Tw(e,t),Od(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Pl(Error(ue(423)),t),t=Xx(e,t,n,r,s);break e}else if(n!==s){s=Pl(Error(ue(424)),t),t=Xx(e,t,n,r,s);break e}else for(qr=fa(t.stateNode.containerInfo.firstChild),Vr=t,Et=!0,kn=null,r=_w(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Rl(),n===s){t=Ss(e,t,r);break e}br(e,t,n,r)}t=t.child}return t;case 5:return Cw(t),e===null&&Xm(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,Gm(n,s)?l=null:i!==null&&Gm(n,i)&&(t.flags|=32),Jw(e,t),br(e,t,l,r),t.child;case 6:return e===null&&Xm(t),null;case 13:return t2(e,t,r);case 4:return H0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ll(t,null,n,r):br(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),Qx(e,t,n,s,r);case 7:return br(e,t,t.pendingProps,r),t.child;case 8:return br(e,t,t.pendingProps.children,r),t.child;case 12:return br(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,mt(Rd,n._currentValue),n._currentValue=l,i!==null)if(On(i.value,l)){if(i.children===s.children&&!Or.current){t=Ss(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=ws(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Jm(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(ue(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Jm(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}br(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,il(t,r),s=dn(s),n=n(s),t.flags|=1,br(e,t,n,r),t.child;case 14:return n=t.type,s=bn(n,t.pendingProps),s=bn(n.type,s),Kx(e,t,n,s,r);case 15:return Zw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),ud(e,t),t.tag=1,Pr(n)?(e=!0,jd(t)):e=!1,il(t,r),Yw(t,n,s),tp(t,n,s,r),sp(null,t,n,!0,e,r);case 19:return r2(e,t,r);case 22:return Xw(e,t,r)}throw Error(ue(156,t.tag))};function y2(e,t){return Vv(e,t)}function KT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(e,t,r,n){return new KT(e,t,r,n)}function rg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ZT(e){if(typeof e=="function")return rg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w0)return 11;if(e===E0)return 14}return 2}function xa(e,t){var r=e.alternate;return r===null?(r=un(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function hd(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")rg(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case zi:return li(r.children,s,i,t);case v0:l=8,s|=8;break;case _m:return e=un(12,r,t,s|2),e.elementType=_m,e.lanes=i,e;case Sm:return e=un(13,r,t,s),e.elementType=Sm,e.lanes=i,e;case Tm:return e=un(19,r,t,s),e.elementType=Tm,e.lanes=i,e;case Cv:return Nh(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Sv:l=10;break e;case Tv:l=9;break e;case w0:l=11;break e;case E0:l=14;break e;case $s:l=16,n=null;break e}throw Error(ue(130,e==null?e:typeof e,""))}return t=un(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function li(e,t,r,n){return e=un(7,e,n,t),e.lanes=r,e}function Nh(e,t,r,n){return e=un(22,e,n,t),e.elementType=Cv,e.lanes=r,e.stateNode={isHidden:!1},e}function Of(e,t,r){return e=un(6,e,null,t),e.lanes=r,e}function Pf(e,t,r){return t=un(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function XT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pf(0),this.expirationTimes=pf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pf(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ng(e,t,r,n,s,i,l,o,u){return e=new XT(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=un(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},B0(i),e}function JT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$i,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function b2(e){if(!e)return wa;e=e._reactInternals;e:{if(ki(e)!==e||e.tag!==1)throw Error(ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ue(171))}if(e.tag===1){var r=e.type;if(Pr(r))return bw(e,r,t)}return t}function v2(e,t,r,n,s,i,l,o,u){return e=ng(r,n,!0,e,s,i,l,o,u),e.context=b2(null),r=e.current,n=wr(),s=ga(r),i=ws(n,s),i.callback=t??null,ma(r,i,s),e.current.lanes=s,Zu(e,s,n),Dr(e,n),e}function kh(e,t,r,n){var s=t.current,i=wr(),l=ga(s);return r=b2(r),t.context===null?t.context=r:t.pendingContext=r,t=ws(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ma(s,t,l),e!==null&&(jn(e,s,l,i),id(e,s,l)),l}function $d(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function oy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function sg(e,t){oy(e,t),(e=e.alternate)&&oy(e,t)}function eC(){return null}var w2=typeof reportError=="function"?reportError:function(e){console.error(e)};function ag(e){this._internalRoot=e}_h.prototype.render=ag.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));kh(e,t,null,null)};_h.prototype.unmount=ag.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mi(function(){kh(null,e,null,null)}),t[ks]=null}};function _h(e){this._internalRoot=e}_h.prototype.unstable_scheduleHydration=function(e){if(e){var t=Xv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gs.length&&t!==0&&t<Gs[r].priority;r++);Gs.splice(r,0,e),r===0&&ew(e)}};function ig(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uy(){}function tC(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=$d(l);i.call(c)}}var l=v2(t,n,e,0,null,!1,!1,"",uy);return e._reactRootContainer=l,e[ks]=l.current,fu(e.nodeType===8?e.parentNode:e),mi(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=$d(u);o.call(c)}}var u=ng(e,0,!1,null,null,!1,!1,"",uy);return e._reactRootContainer=u,e[ks]=u.current,fu(e.nodeType===8?e.parentNode:e),mi(function(){kh(t,u,r,n)}),u}function Th(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=$d(l);o.call(u)}}kh(t,l,e,s)}else l=tC(r,t,e,s,n);return $d(l)}Kv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=jo(t.pendingLanes);r!==0&&(_0(t,r|1),Dr(t,Lt()),!(Xe&6)&&(Dl=Lt()+500,Ca()))}break;case 13:mi(function(){var n=_s(e,1);if(n!==null){var s=wr();jn(n,e,1,s)}}),sg(e,1)}};S0=function(e){if(e.tag===13){var t=_s(e,134217728);if(t!==null){var r=wr();jn(t,e,134217728,r)}sg(e,134217728)}};Zv=function(e){if(e.tag===13){var t=ga(e),r=_s(e,t);if(r!==null){var n=wr();jn(r,e,t,n)}sg(e,t)}};Xv=function(){return it};Jv=function(e,t){var r=it;try{return it=e,t()}finally{it=r}};Mm=function(e,t,r){switch(t){case"input":if(Am(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=xh(n);if(!s)throw Error(ue(90));Av(n),Am(n,s)}}}break;case"textarea":Rv(e,r);break;case"select":t=r.value,t!=null&&rl(e,!!r.multiple,t,!1)}};Uv=J0;Bv=mi;var rC={usingClientEntryPoint:!1,Events:[Ju,Gi,xh,Mv,Fv,J0]},po={findFiberByHostInstance:Ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nC={bundleType:po.bundleType,version:po.version,rendererPackageName:po.rendererPackageName,rendererConfig:po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:As.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=zv(e),e===null?null:e.stateNode},findFiberByHostInstance:po.findFiberByHostInstance||eC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uc.isDisabled&&Uc.supportsFiber)try{fh=Uc.inject(nC),Zn=Uc}catch{}}Qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rC;Qr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ig(t))throw Error(ue(200));return JT(e,t,null,r)};Qr.createRoot=function(e,t){if(!ig(e))throw Error(ue(299));var r=!1,n="",s=w2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ng(e,1,!1,null,null,r,!1,n,s),e[ks]=t.current,fu(e.nodeType===8?e.parentNode:e),new ag(t)};Qr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=zv(t),e=e===null?null:e.stateNode,e};Qr.flushSync=function(e){return mi(e)};Qr.hydrate=function(e,t,r){if(!Sh(t))throw Error(ue(200));return Th(null,e,t,!0,r)};Qr.hydrateRoot=function(e,t,r){if(!ig(e))throw Error(ue(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=w2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=v2(t,null,e,1,r??null,s,!1,i,l),e[ks]=t.current,fu(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new _h(t)};Qr.render=function(e,t,r){if(!Sh(t))throw Error(ue(200));return Th(null,e,t,!1,r)};Qr.unmountComponentAtNode=function(e){if(!Sh(e))throw Error(ue(40));return e._reactRootContainer?(mi(function(){Th(null,null,e,!1,function(){e._reactRootContainer=null,e[ks]=null})}),!0):!1};Qr.unstable_batchedUpdates=J0;Qr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sh(r))throw Error(ue(200));if(e==null||e._reactInternals===void 0)throw Error(ue(38));return Th(e,t,r,!1,n)};Qr.version="18.3.1-next-f1338f8080-20240426";function E2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E2)}catch(e){console.error(e)}}E2(),Ev.exports=Qr;var sC=Ev.exports,N2,cy=sC;N2=cy.createRoot,cy.hydrateRoot;var Ql=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pi=typeof window>"u"||"Deno"in globalThis;function nn(){}function aC(e,t){return typeof e=="function"?e(t):e}function gp(e){return typeof e=="number"&&e>=0&&e!==1/0}function k2(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ol(e,t){return typeof e=="function"?e(t):e}function _n(e,t){return typeof e=="function"?e(t):e}function dy(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==lg(l,t.options))return!1}else if(!Eu(t.queryKey,l))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||i&&!i(t))}function hy(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(gi(t.options.mutationKey)!==gi(i))return!1}else if(!Eu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function lg(e,t){return((t==null?void 0:t.queryKeyHashFn)||gi)(e)}function gi(e){return JSON.stringify(e,(t,r)=>xp(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Eu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Eu(e[r],t[r])):!1}function _2(e,t){if(e===t)return e;const r=fy(e)&&fy(t);if(r||xp(e)&&xp(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{};let u=0;for(let c=0;c<l;c++){const d=r?c:i[c];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=_2(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return s===l&&u===s?e:o}return t}function zd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function fy(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function xp(e){if(!my(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!my(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function my(e){return Object.prototype.toString.call(e)==="[object Object]"}function iC(e){return new Promise(t=>{setTimeout(t,e)})}function yp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?_2(e,t):t}function lC(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function oC(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var og=Symbol();function S2(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===og?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Xa,Ks,xl,tv,uC=(tv=class extends Ql{constructor(){super();ke(this,Xa);ke(this,Ks);ke(this,xl);xe(this,xl,t=>{if(!pi&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){F(this,Ks)||this.setEventListener(F(this,xl))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Ks))==null||t.call(this),xe(this,Ks,void 0))}setEventListener(t){var r;xe(this,xl,t),(r=F(this,Ks))==null||r.call(this),xe(this,Ks,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){F(this,Xa)!==t&&(xe(this,Xa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof F(this,Xa)=="boolean"?F(this,Xa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Xa=new WeakMap,Ks=new WeakMap,xl=new WeakMap,tv),ug=new uC,yl,Zs,bl,rv,cC=(rv=class extends Ql{constructor(){super();ke(this,yl,!0);ke(this,Zs);ke(this,bl);xe(this,bl,t=>{if(!pi&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){F(this,Zs)||this.setEventListener(F(this,bl))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Zs))==null||t.call(this),xe(this,Zs,void 0))}setEventListener(t){var r;xe(this,bl,t),(r=F(this,Zs))==null||r.call(this),xe(this,Zs,t(this.setOnline.bind(this)))}setOnline(t){F(this,yl)!==t&&(xe(this,yl,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return F(this,yl)}},yl=new WeakMap,Zs=new WeakMap,bl=new WeakMap,rv),qd=new cC;function bp(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function dC(e){return Math.min(1e3*2**e,3e4)}function T2(e){return(e??"online")==="online"?qd.isOnline():!0}var C2=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Df(e){return e instanceof C2}function j2(e){let t=!1,r=0,n=!1,s;const i=bp(),l=y=>{var v;n||(f(new C2(y)),(v=e.abort)==null||v.call(e))},o=()=>{t=!0},u=()=>{t=!1},c=()=>ug.isFocused()&&(e.networkMode==="always"||qd.isOnline())&&e.canRun(),d=()=>T2(e.networkMode)&&e.canRun(),h=y=>{var v;n||(n=!0,(v=e.onSuccess)==null||v.call(e,y),s==null||s(),i.resolve(y))},f=y=>{var v;n||(n=!0,(v=e.onError)==null||v.call(e,y),s==null||s(),i.reject(y))},p=()=>new Promise(y=>{var v;s=x=>{(n||c())&&y(x)},(v=e.onPause)==null||v.call(e)}).then(()=>{var y;s=void 0,n||(y=e.onContinue)==null||y.call(e)}),g=()=>{if(n)return;let y;const v=r===0?e.initialPromise:void 0;try{y=v??e.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(h).catch(x=>{var S;if(n)return;const b=e.retry??(pi?0:3),w=e.retryDelay??dC,_=typeof w=="function"?w(r,x):w,k=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,x);if(t||!k){f(x);return}r++,(S=e.onFail)==null||S.call(e,r,x),iC(_).then(()=>c()?void 0:p()).then(()=>{t?f(x):g()})})};return{promise:i,cancel:l,continue:()=>(s==null||s(),i),cancelRetry:o,continueRetry:u,canStart:d,start:()=>(d()?g():p().then(g),i)}}var hC=e=>setTimeout(e,0);function fC(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=hC;const i=o=>{t?e.push(o):s(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||l()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var $t=fC(),Ja,nv,A2=(nv=class{constructor(){ke(this,Ja)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),gp(this.gcTime)&&xe(this,Ja,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(pi?1/0:5*60*1e3))}clearGcTimeout(){F(this,Ja)&&(clearTimeout(F(this,Ja)),xe(this,Ja,void 0))}},Ja=new WeakMap,nv),vl,wl,rn,ei,ir,Wu,ti,vn,us,sv,mC=(sv=class extends A2{constructor(t){super();ke(this,vn);ke(this,vl);ke(this,wl);ke(this,rn);ke(this,ei);ke(this,ir);ke(this,Wu);ke(this,ti);xe(this,ti,!1),xe(this,Wu,t.defaultOptions),this.setOptions(t.options),this.observers=[],xe(this,ei,t.client),xe(this,rn,F(this,ei).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,xe(this,vl,pC(this.options)),this.state=t.state??F(this,vl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=F(this,ir))==null?void 0:t.promise}setOptions(t){this.options={...F(this,Wu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&F(this,rn).remove(this)}setData(t,r){const n=yp(this.state.data,t,this.options);return Fe(this,vn,us).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Fe(this,vn,us).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=F(this,ir))==null?void 0:n.promise;return(s=F(this,ir))==null||s.cancel(t),r?r.then(nn).catch(nn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(F(this,vl))}isActive(){return this.observers.some(t=>_n(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===og||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!k2(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,ir))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,ir))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),F(this,rn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(F(this,ir)&&(F(this,ti)?F(this,ir).cancel({revert:!0}):F(this,ir).cancelRetry()),this.scheduleGc()),F(this,rn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,vn,us).call(this,{type:"invalidate"})}fetch(t,r){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(F(this,ir))return F(this,ir).continueRetry(),F(this,ir).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(xe(this,ti,!0),n.signal)})},i=()=>{const h=S2(this.options,r),f={client:F(this,ei),queryKey:this.queryKey,meta:this.meta};return s(f),xe(this,ti,!1),this.options.persister?this.options.persister(h,f,this):h(f)},l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:F(this,ei),state:this.state,fetchFn:i};s(l),(u=this.options.behavior)==null||u.onFetch(l,this),xe(this,wl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=l.fetchOptions)==null?void 0:c.meta))&&Fe(this,vn,us).call(this,{type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta});const o=h=>{var f,p,g,y;Df(h)&&h.silent||Fe(this,vn,us).call(this,{type:"error",error:h}),Df(h)||((p=(f=F(this,rn).config).onError)==null||p.call(f,h,this),(y=(g=F(this,rn).config).onSettled)==null||y.call(g,this.state.data,h,this)),this.scheduleGc()};return xe(this,ir,j2({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,p,g,y;if(h===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(v){o(v);return}(p=(f=F(this,rn).config).onSuccess)==null||p.call(f,h,this),(y=(g=F(this,rn).config).onSettled)==null||y.call(g,h,this.state.error,this),this.scheduleGc()},onError:o,onFail:(h,f)=>{Fe(this,vn,us).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{Fe(this,vn,us).call(this,{type:"pause"})},onContinue:()=>{Fe(this,vn,us).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),F(this,ir).start()}},vl=new WeakMap,wl=new WeakMap,rn=new WeakMap,ei=new WeakMap,ir=new WeakMap,Wu=new WeakMap,ti=new WeakMap,vn=new WeakSet,us=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...I2(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Df(s)&&s.revert&&F(this,wl)?{...F(this,wl),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),$t.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),F(this,rn).notify({query:this,type:"updated",action:t})})},sv);function I2(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:T2(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function pC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Vn,av,gC=(av=class extends Ql{constructor(t={}){super();ke(this,Vn);this.config=t,xe(this,Vn,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??lg(s,r);let l=this.get(i);return l||(l=new mC({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){F(this,Vn).has(t.queryHash)||(F(this,Vn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=F(this,Vn).get(t.queryHash);r&&(t.destroy(),r===t&&F(this,Vn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){$t.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return F(this,Vn).get(t)}getAll(){return[...F(this,Vn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>dy(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>dy(t,n)):r}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){$t.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){$t.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Vn=new WeakMap,av),Wn,xr,ri,Gn,Ms,iv,xC=(iv=class extends A2{constructor(t){super();ke(this,Gn);ke(this,Wn);ke(this,xr);ke(this,ri);this.mutationId=t.mutationId,xe(this,xr,t.mutationCache),xe(this,Wn,[]),this.state=t.state||R2(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){F(this,Wn).includes(t)||(F(this,Wn).push(t),this.clearGcTimeout(),F(this,xr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){xe(this,Wn,F(this,Wn).filter(r=>r!==t)),this.scheduleGc(),F(this,xr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){F(this,Wn).length||(this.state.status==="pending"?this.scheduleGc():F(this,xr).remove(this))}continue(){var t;return((t=F(this,ri))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,u,c,d,h,f,p,g,y,v,x,b,w,_,k,S,A,R;const r=()=>{Fe(this,Gn,Ms).call(this,{type:"continue"})};xe(this,ri,j2({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(L,T)=>{Fe(this,Gn,Ms).call(this,{type:"failed",failureCount:L,error:T})},onPause:()=>{Fe(this,Gn,Ms).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>F(this,xr).canRun(this)}));const n=this.state.status==="pending",s=!F(this,ri).canStart();try{if(n)r();else{Fe(this,Gn,Ms).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(i=F(this,xr).config).onMutate)==null?void 0:l.call(i,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&Fe(this,Gn,Ms).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const L=await F(this,ri).start();return await((d=(c=F(this,xr).config).onSuccess)==null?void 0:d.call(c,L,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,L,t,this.state.context)),await((g=(p=F(this,xr).config).onSettled)==null?void 0:g.call(p,L,null,this.state.variables,this.state.context,this)),await((v=(y=this.options).onSettled)==null?void 0:v.call(y,L,null,t,this.state.context)),Fe(this,Gn,Ms).call(this,{type:"success",data:L}),L}catch(L){try{throw await((b=(x=F(this,xr).config).onError)==null?void 0:b.call(x,L,t,this.state.context,this)),await((_=(w=this.options).onError)==null?void 0:_.call(w,L,t,this.state.context)),await((S=(k=F(this,xr).config).onSettled)==null?void 0:S.call(k,void 0,L,this.state.variables,this.state.context,this)),await((R=(A=this.options).onSettled)==null?void 0:R.call(A,void 0,L,t,this.state.context)),L}finally{Fe(this,Gn,Ms).call(this,{type:"error",error:L})}}finally{F(this,xr).runNext(this)}}},Wn=new WeakMap,xr=new WeakMap,ri=new WeakMap,Gn=new WeakSet,Ms=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),$t.batch(()=>{F(this,Wn).forEach(n=>{n.onMutationUpdate(t)}),F(this,xr).notify({mutation:this,type:"updated",action:t})})},iv);function R2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var gs,wn,Gu,lv,yC=(lv=class extends Ql{constructor(t={}){super();ke(this,gs);ke(this,wn);ke(this,Gu);this.config=t,xe(this,gs,new Set),xe(this,wn,new Map),xe(this,Gu,0)}build(t,r,n){const s=new xC({mutationCache:this,mutationId:++Ec(this,Gu)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){F(this,gs).add(t);const r=Bc(t);if(typeof r=="string"){const n=F(this,wn).get(r);n?n.push(t):F(this,wn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(F(this,gs).delete(t)){const r=Bc(t);if(typeof r=="string"){const n=F(this,wn).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&F(this,wn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Bc(t);if(typeof r=="string"){const n=F(this,wn).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=Bc(t);if(typeof r=="string"){const s=(n=F(this,wn).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){$t.batch(()=>{F(this,gs).forEach(t=>{this.notify({type:"removed",mutation:t})}),F(this,gs).clear(),F(this,wn).clear()})}getAll(){return Array.from(F(this,gs))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>hy(r,n))}findAll(t={}){return this.getAll().filter(r=>hy(t,r))}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return $t.batch(()=>Promise.all(t.map(r=>r.continue().catch(nn))))}},gs=new WeakMap,wn=new WeakMap,Gu=new WeakMap,lv);function Bc(e){var t;return(t=e.options.scope)==null?void 0:t.id}function py(e){return{onFetch:(t,r)=>{var d,h,f,p,g;const n=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],l=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let y=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},x=S2(t.options,t.fetchOptions),b=async(w,_,k)=>{if(y)return Promise.reject();if(_==null&&w.pages.length)return Promise.resolve(w);const S={client:t.client,queryKey:t.queryKey,pageParam:_,direction:k?"backward":"forward",meta:t.options.meta};v(S);const A=await x(S),{maxPages:R}=t.options,L=k?oC:lC;return{pages:L(w.pages,A,R),pageParams:L(w.pageParams,_,R)}};if(s&&i.length){const w=s==="backward",_=w?bC:gy,k={pages:i,pageParams:l},S=_(n,k);o=await b(k,S,w)}else{const w=e??i.length;do{const _=u===0?l[0]??n.initialPageParam:gy(n,o);if(u>0&&_==null)break;o=await b(o,_),u++}while(u<w)}return o};t.options.persister?t.fetchFn=()=>{var y,v;return(v=(y=t.options).persister)==null?void 0:v.call(y,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function gy(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function bC(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var jt,Xs,Js,El,Nl,ea,kl,_l,ov,vC=(ov=class{constructor(e={}){ke(this,jt);ke(this,Xs);ke(this,Js);ke(this,El);ke(this,Nl);ke(this,ea);ke(this,kl);ke(this,_l);xe(this,jt,e.queryCache||new gC),xe(this,Xs,e.mutationCache||new yC),xe(this,Js,e.defaultOptions||{}),xe(this,El,new Map),xe(this,Nl,new Map),xe(this,ea,0)}mount(){Ec(this,ea)._++,F(this,ea)===1&&(xe(this,kl,ug.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,jt).onFocus())})),xe(this,_l,qd.subscribe(async e=>{e&&(await this.resumePausedMutations(),F(this,jt).onOnline())})))}unmount(){var e,t;Ec(this,ea)._--,F(this,ea)===0&&((e=F(this,kl))==null||e.call(this),xe(this,kl,void 0),(t=F(this,_l))==null||t.call(this),xe(this,_l,void 0))}isFetching(e){return F(this,jt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return F(this,Xs).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,jt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=F(this,jt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ol(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return F(this,jt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=F(this,jt).get(n.queryHash),i=s==null?void 0:s.state.data,l=aC(t,i);if(l!==void 0)return F(this,jt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return $t.batch(()=>F(this,jt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=F(this,jt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=F(this,jt);$t.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=F(this,jt);return $t.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=$t.batch(()=>F(this,jt).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(nn).catch(nn)}invalidateQueries(e,t={}){return $t.batch(()=>(F(this,jt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=$t.batch(()=>F(this,jt).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(nn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(nn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=F(this,jt).build(this,t);return r.isStaleByTime(ol(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(nn).catch(nn)}fetchInfiniteQuery(e){return e.behavior=py(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(nn).catch(nn)}ensureInfiniteQueryData(e){return e.behavior=py(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return qd.isOnline()?F(this,Xs).resumePausedMutations():Promise.resolve()}getQueryCache(){return F(this,jt)}getMutationCache(){return F(this,Xs)}getDefaultOptions(){return F(this,Js)}setDefaultOptions(e){xe(this,Js,e)}setQueryDefaults(e,t){F(this,El).set(gi(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...F(this,El).values()],r={};return t.forEach(n=>{Eu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){F(this,Nl).set(gi(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...F(this,Nl).values()],r={};return t.forEach(n=>{Eu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...F(this,Js).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=lg(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===og&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...F(this,Js).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){F(this,jt).clear(),F(this,Xs).clear()}},jt=new WeakMap,Xs=new WeakMap,Js=new WeakMap,El=new WeakMap,Nl=new WeakMap,ea=new WeakMap,kl=new WeakMap,_l=new WeakMap,ov),jr,Ge,Yu,yr,ni,Sl,ta,ra,Qu,Tl,Cl,si,ai,na,jl,st,Io,vp,wp,Ep,Np,kp,_p,Sp,L2,uv,wC=(uv=class extends Ql{constructor(t,r){super();ke(this,st);ke(this,jr);ke(this,Ge);ke(this,Yu);ke(this,yr);ke(this,ni);ke(this,Sl);ke(this,ta);ke(this,ra);ke(this,Qu);ke(this,Tl);ke(this,Cl);ke(this,si);ke(this,ai);ke(this,na);ke(this,jl,new Set);this.options=r,xe(this,jr,t),xe(this,ra,null),xe(this,ta,bp()),this.options.experimental_prefetchInRender||F(this,ta).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(F(this,Ge).addObserver(this),xy(F(this,Ge),this.options)?Fe(this,st,Io).call(this):this.updateResult(),Fe(this,st,Np).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Tp(F(this,Ge),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Tp(F(this,Ge),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,st,kp).call(this),Fe(this,st,_p).call(this),F(this,Ge).removeObserver(this)}setOptions(t){const r=this.options,n=F(this,Ge);if(this.options=F(this,jr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof _n(this.options.enabled,F(this,Ge))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,st,Sp).call(this),F(this,Ge).setOptions(this.options),r._defaulted&&!zd(this.options,r)&&F(this,jr).getQueryCache().notify({type:"observerOptionsUpdated",query:F(this,Ge),observer:this});const s=this.hasListeners();s&&yy(F(this,Ge),n,this.options,r)&&Fe(this,st,Io).call(this),this.updateResult(),s&&(F(this,Ge)!==n||_n(this.options.enabled,F(this,Ge))!==_n(r.enabled,F(this,Ge))||ol(this.options.staleTime,F(this,Ge))!==ol(r.staleTime,F(this,Ge)))&&Fe(this,st,vp).call(this);const i=Fe(this,st,wp).call(this);s&&(F(this,Ge)!==n||_n(this.options.enabled,F(this,Ge))!==_n(r.enabled,F(this,Ge))||i!==F(this,na))&&Fe(this,st,Ep).call(this,i)}getOptimisticResult(t){const r=F(this,jr).getQueryCache().build(F(this,jr),t),n=this.createResult(r,t);return NC(this,n)&&(xe(this,yr,n),xe(this,Sl,this.options),xe(this,ni,F(this,Ge).state)),n}getCurrentResult(){return F(this,yr)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){F(this,jl).add(t)}getCurrentQuery(){return F(this,Ge)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=F(this,jr).defaultQueryOptions(t),n=F(this,jr).getQueryCache().build(F(this,jr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Fe(this,st,Io).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),F(this,yr)))}createResult(t,r){var L;const n=F(this,Ge),s=this.options,i=F(this,yr),l=F(this,ni),o=F(this,Sl),c=t!==n?t.state:F(this,Yu),{state:d}=t;let h={...d},f=!1,p;if(r._optimisticResults){const T=this.hasListeners(),z=!T&&xy(t,r),O=T&&yy(t,n,r,s);(z||O)&&(h={...h,...I2(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:v}=h;p=h.data;let x=!1;if(r.placeholderData!==void 0&&p===void 0&&v==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,x=!0):T=typeof r.placeholderData=="function"?r.placeholderData((L=F(this,Cl))==null?void 0:L.state.data,F(this,Cl)):r.placeholderData,T!==void 0&&(v="success",p=yp(i==null?void 0:i.data,T,r),f=!0)}if(r.select&&p!==void 0&&!x)if(i&&p===(l==null?void 0:l.data)&&r.select===F(this,Qu))p=F(this,Tl);else try{xe(this,Qu,r.select),p=r.select(p),p=yp(i==null?void 0:i.data,p,r),xe(this,Tl,p),xe(this,ra,null)}catch(T){xe(this,ra,T)}F(this,ra)&&(g=F(this,ra),p=F(this,Tl),y=Date.now(),v="error");const b=h.fetchStatus==="fetching",w=v==="pending",_=v==="error",k=w&&b,S=p!==void 0,R={status:v,fetchStatus:h.fetchStatus,isPending:w,isSuccess:v==="success",isError:_,isInitialLoading:k,isLoading:k,data:p,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:b,isRefetching:b&&!w,isLoadingError:_&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&S,isStale:cg(t,r),refetch:this.refetch,promise:F(this,ta)};if(this.options.experimental_prefetchInRender){const T=Y=>{R.status==="error"?Y.reject(R.error):R.data!==void 0&&Y.resolve(R.data)},z=()=>{const Y=xe(this,ta,R.promise=bp());T(Y)},O=F(this,ta);switch(O.status){case"pending":t.queryHash===n.queryHash&&T(O);break;case"fulfilled":(R.status==="error"||R.data!==O.value)&&z();break;case"rejected":(R.status!=="error"||R.error!==O.reason)&&z();break}}return R}updateResult(){const t=F(this,yr),r=this.createResult(F(this,Ge),this.options);if(xe(this,ni,F(this,Ge).state),xe(this,Sl,this.options),F(this,ni).data!==void 0&&xe(this,Cl,F(this,Ge)),zd(r,t))return;xe(this,yr,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!F(this,jl).size)return!0;const l=new Set(i??F(this,jl));return this.options.throwOnError&&l.add("error"),Object.keys(F(this,yr)).some(o=>{const u=o;return F(this,yr)[u]!==t[u]&&l.has(u)})};Fe(this,st,L2).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,st,Np).call(this)}},jr=new WeakMap,Ge=new WeakMap,Yu=new WeakMap,yr=new WeakMap,ni=new WeakMap,Sl=new WeakMap,ta=new WeakMap,ra=new WeakMap,Qu=new WeakMap,Tl=new WeakMap,Cl=new WeakMap,si=new WeakMap,ai=new WeakMap,na=new WeakMap,jl=new WeakMap,st=new WeakSet,Io=function(t){Fe(this,st,Sp).call(this);let r=F(this,Ge).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(nn)),r},vp=function(){Fe(this,st,kp).call(this);const t=ol(this.options.staleTime,F(this,Ge));if(pi||F(this,yr).isStale||!gp(t))return;const n=k2(F(this,yr).dataUpdatedAt,t)+1;xe(this,si,setTimeout(()=>{F(this,yr).isStale||this.updateResult()},n))},wp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(F(this,Ge)):this.options.refetchInterval)??!1},Ep=function(t){Fe(this,st,_p).call(this),xe(this,na,t),!(pi||_n(this.options.enabled,F(this,Ge))===!1||!gp(F(this,na))||F(this,na)===0)&&xe(this,ai,setInterval(()=>{(this.options.refetchIntervalInBackground||ug.isFocused())&&Fe(this,st,Io).call(this)},F(this,na)))},Np=function(){Fe(this,st,vp).call(this),Fe(this,st,Ep).call(this,Fe(this,st,wp).call(this))},kp=function(){F(this,si)&&(clearTimeout(F(this,si)),xe(this,si,void 0))},_p=function(){F(this,ai)&&(clearInterval(F(this,ai)),xe(this,ai,void 0))},Sp=function(){const t=F(this,jr).getQueryCache().build(F(this,jr),this.options);if(t===F(this,Ge))return;const r=F(this,Ge);xe(this,Ge,t),xe(this,Yu,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},L2=function(t){$t.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(F(this,yr))}),F(this,jr).getQueryCache().notify({query:F(this,Ge),type:"observerResultsUpdated"})})},uv);function EC(e,t){return _n(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function xy(e,t){return EC(e,t)||e.state.data!==void 0&&Tp(e,t,t.refetchOnMount)}function Tp(e,t,r){if(_n(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&cg(e,t)}return!1}function yy(e,t,r,n){return(e!==t||_n(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&cg(e,r)}function cg(e,t){return _n(t.enabled,e)!==!1&&e.isStaleByTime(ol(t.staleTime,e))}function NC(e,t){return!zd(e.getCurrentResult(),t)}var sa,aa,Ar,xs,Es,fd,Cp,cv,kC=(cv=class extends Ql{constructor(r,n){super();ke(this,Es);ke(this,sa);ke(this,aa);ke(this,Ar);ke(this,xs);xe(this,sa,r),this.setOptions(n),this.bindMethods(),Fe(this,Es,fd).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=F(this,sa).defaultMutationOptions(r),zd(this.options,n)||F(this,sa).getMutationCache().notify({type:"observerOptionsUpdated",mutation:F(this,Ar),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&gi(n.mutationKey)!==gi(this.options.mutationKey)?this.reset():((s=F(this,Ar))==null?void 0:s.state.status)==="pending"&&F(this,Ar).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=F(this,Ar))==null||r.removeObserver(this)}onMutationUpdate(r){Fe(this,Es,fd).call(this),Fe(this,Es,Cp).call(this,r)}getCurrentResult(){return F(this,aa)}reset(){var r;(r=F(this,Ar))==null||r.removeObserver(this),xe(this,Ar,void 0),Fe(this,Es,fd).call(this),Fe(this,Es,Cp).call(this)}mutate(r,n){var s;return xe(this,xs,n),(s=F(this,Ar))==null||s.removeObserver(this),xe(this,Ar,F(this,sa).getMutationCache().build(F(this,sa),this.options)),F(this,Ar).addObserver(this),F(this,Ar).execute(r)}},sa=new WeakMap,aa=new WeakMap,Ar=new WeakMap,xs=new WeakMap,Es=new WeakSet,fd=function(){var n;const r=((n=F(this,Ar))==null?void 0:n.state)??R2();xe(this,aa,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Cp=function(r){$t.batch(()=>{var n,s,i,l,o,u,c,d;if(F(this,xs)&&this.hasListeners()){const h=F(this,aa).variables,f=F(this,aa).context;(r==null?void 0:r.type)==="success"?((s=(n=F(this,xs)).onSuccess)==null||s.call(n,r.data,h,f),(l=(i=F(this,xs)).onSettled)==null||l.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((u=(o=F(this,xs)).onError)==null||u.call(o,r.error,h,f),(d=(c=F(this,xs)).onSettled)==null||d.call(c,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(F(this,aa))})})},cv),O2=E.createContext(void 0),Zr=e=>{const t=E.useContext(O2);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},P2=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(O2.Provider,{value:e,children:t})),D2=E.createContext(!1),_C=()=>E.useContext(D2);D2.Provider;function SC(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var TC=E.createContext(SC()),CC=()=>E.useContext(TC);function M2(e,t){return typeof e=="function"?e(...t):!!e}function jp(){}var jC=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},AC=e=>{E.useEffect(()=>{e.clearReset()},[e])},IC=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||M2(r,[e.error,n])),RC=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},LC=(e,t)=>e.isLoading&&e.isFetching&&!t,OC=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,by=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function PC(e,t,r){var h,f,p,g,y;const n=Zr(),s=_C(),i=CC(),l=n.defaultQueryOptions(e);(f=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",RC(l),jC(l,i),AC(i);const o=!n.getQueryCache().get(l.queryHash),[u]=E.useState(()=>new t(n,l)),c=u.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(v=>{const x=d?u.subscribe($t.batchCalls(v)):jp;return u.updateResult(),x},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),E.useEffect(()=>{u.setOptions(l)},[l,u]),OC(l,c))throw by(l,u,i);if(IC({result:c,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((g=(p=n.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||g.call(p,l,c),l.experimental_prefetchInRender&&!pi&&LC(c,s)){const v=o?by(l,u,i):(y=n.getQueryCache().get(l.queryHash))==null?void 0:y.promise;v==null||v.catch(jp).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function It(e,t){return PC(e,wC)}function wt(e,t){const r=Zr(),[n]=E.useState(()=>new kC(r,e));E.useEffect(()=>{n.setOptions(e)},[n,e]);const s=E.useSyncExternalStore(E.useCallback(l=>n.subscribe($t.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=E.useCallback((l,o)=>{n.mutate(l,o).catch(jp)},[n]);if(s.error&&M2(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nu(){return Nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nu.apply(this,arguments)}var oa;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(oa||(oa={}));const vy="popstate";function DC(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return Ap("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Vd(s)}return FC(t,r,null,e)}function Pt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function F2(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function MC(){return Math.random().toString(36).substr(2,8)}function wy(e,t){return{usr:e.state,key:e.key,idx:t}}function Ap(e,t,r,n){return r===void 0&&(r=null),Nu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Kl(t):t,{state:r,key:t&&t.key||n||MC()})}function Vd(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Kl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function FC(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=oa.Pop,u=null,c=d();c==null&&(c=0,l.replaceState(Nu({},l.state,{idx:c}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=oa.Pop;let v=d(),x=v==null?null:v-c;c=v,u&&u({action:o,location:y.location,delta:x})}function f(v,x){o=oa.Push;let b=Ap(y.location,v,x);c=d()+1;let w=wy(b,c),_=y.createHref(b);try{l.pushState(w,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(_)}i&&u&&u({action:o,location:y.location,delta:1})}function p(v,x){o=oa.Replace;let b=Ap(y.location,v,x);c=d();let w=wy(b,c),_=y.createHref(b);l.replaceState(w,"",_),i&&u&&u({action:o,location:y.location,delta:0})}function g(v){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof v=="string"?v:Vd(v);return b=b.replace(/ $/,"%20"),Pt(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let y={get action(){return o},get location(){return e(s,l)},listen(v){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(vy,h),u=v,()=>{s.removeEventListener(vy,h),u=null}},createHref(v){return t(s,v)},createURL:g,encodeLocation(v){let x=g(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(v){return l.go(v)}};return y}var Ey;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Ey||(Ey={}));function UC(e,t,r){return r===void 0&&(r="/"),BC(e,t,r)}function BC(e,t,r,n){let s=typeof t=="string"?Kl(t):t,i=dg(s.pathname||"/",r);if(i==null)return null;let l=U2(e);HC(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=JC(i);o=KC(l[u],c)}return o}function U2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(Pt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=ya([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(Pt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),U2(i.children,t,d,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:YC(c,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of B2(i.path))s(i,l,u)}),t}function B2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=B2(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function HC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:QC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const $C=/^:[\w-]+$/,zC=3,qC=2,VC=1,WC=10,GC=-2,Ny=e=>e==="*";function YC(e,t){let r=e.split("/"),n=r.length;return r.some(Ny)&&(n+=GC),t&&(n+=qC),r.filter(s=>!Ny(s)).reduce((s,i)=>s+($C.test(i)?zC:i===""?VC:WC),n)}function QC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function KC(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=ZC({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),l.push({params:s,pathname:ya([i,h.pathname]),pathnameBase:nj(ya([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ya([i,h.pathnameBase]))}return l}function ZC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=XC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let y=o[h]||"";l=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[h];return p&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function XC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),F2(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function JC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return F2(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function dg(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ej(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Kl(e):e;return{pathname:r?r.startsWith("/")?r:tj(r,t):t,search:sj(n),hash:aj(s)}}function tj(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Mf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rj(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function hg(e,t){let r=rj(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function fg(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Kl(e):(s=Nu({},e),Pt(!s.pathname||!s.pathname.includes("?"),Mf("?","pathname","search",s)),Pt(!s.pathname||!s.pathname.includes("#"),Mf("#","pathname","hash",s)),Pt(!s.search||!s.search.includes("#"),Mf("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let u=ej(s,o),c=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const ya=e=>e.join("/").replace(/\/\/+/g,"/"),nj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,aj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ij(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const H2=["post","put","patch","delete"];new Set(H2);const lj=["get",...H2];new Set(lj);/**
 * React Router v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(this,arguments)}const mg=E.createContext(null),oj=E.createContext(null),ja=E.createContext(null),Ch=E.createContext(null),Is=E.createContext({outlet:null,matches:[],isDataRoute:!1}),$2=E.createContext(null);function uj(e,t){let{relative:r}=t===void 0?{}:t;Zl()||Pt(!1);let{basename:n,navigator:s}=E.useContext(ja),{hash:i,pathname:l,search:o}=q2(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:ya([n,l])),s.createHref({pathname:u,search:o,hash:i})}function Zl(){return E.useContext(Ch)!=null}function Aa(){return Zl()||Pt(!1),E.useContext(Ch).location}function z2(e){E.useContext(ja).static||E.useLayoutEffect(e)}function fn(){let{isDataRoute:e}=E.useContext(Is);return e?Ej():cj()}function cj(){Zl()||Pt(!1);let e=E.useContext(mg),{basename:t,future:r,navigator:n}=E.useContext(ja),{matches:s}=E.useContext(Is),{pathname:i}=Aa(),l=JSON.stringify(hg(s,r.v7_relativeSplatPath)),o=E.useRef(!1);return z2(()=>{o.current=!0}),E.useCallback(function(c,d){if(d===void 0&&(d={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=fg(c,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ya([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,l,i,e])}function pg(){let{matches:e}=E.useContext(Is),t=e[e.length-1];return t?t.params:{}}function q2(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=E.useContext(ja),{matches:s}=E.useContext(Is),{pathname:i}=Aa(),l=JSON.stringify(hg(s,n.v7_relativeSplatPath));return E.useMemo(()=>fg(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function dj(e,t){return hj(e,t)}function hj(e,t,r,n){Zl()||Pt(!1);let{navigator:s}=E.useContext(ja),{matches:i}=E.useContext(Is),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=Aa(),d;if(t){var h;let v=typeof t=="string"?Kl(t):t;u==="/"||(h=v.pathname)!=null&&h.startsWith(u)||Pt(!1),d=v}else d=c;let f=d.pathname||"/",p=f;if(u!=="/"){let v=u.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=UC(e,{pathname:p}),y=xj(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:ya([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:ya([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&y?E.createElement(Ch.Provider,{value:{location:ku({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:oa.Pop}},y):y}function fj(){let e=wj(),t=ij(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),r?E.createElement("pre",{style:s},r):null,null)}const mj=E.createElement(fj,null);class pj extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?E.createElement(Is.Provider,{value:this.props.routeContext},E.createElement($2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gj(e){let{routeContext:t,match:r,children:n}=e,s=E.useContext(mg);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(Is.Provider,{value:t},n)}function xj(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Pt(!1),l=l.slice(0,Math.min(l.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:p}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||g){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let p,g=!1,y=null,v=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,y=h.route.errorElement||mj,u&&(c<0&&f===0?(Nj("route-fallback"),g=!0,v=null):c===f&&(g=!0,v=h.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),b=()=>{let w;return p?w=y:g?w=v:h.route.Component?w=E.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,E.createElement(gj,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?E.createElement(pj,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var V2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(V2||{}),W2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(W2||{});function yj(e){let t=E.useContext(mg);return t||Pt(!1),t}function bj(e){let t=E.useContext(oj);return t||Pt(!1),t}function vj(e){let t=E.useContext(Is);return t||Pt(!1),t}function G2(e){let t=vj(),r=t.matches[t.matches.length-1];return r.route.id||Pt(!1),r.route.id}function wj(){var e;let t=E.useContext($2),r=bj(),n=G2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Ej(){let{router:e}=yj(V2.UseNavigateStable),t=G2(W2.UseNavigateStable),r=E.useRef(!1);return z2(()=>{r.current=!0}),E.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ku({fromRouteId:t},i)))},[e,t])}const ky={};function Nj(e,t,r){ky[e]||(ky[e]=!0)}const _y={};function kj(e,t){_y[t]||(_y[t]=!0,console.warn(t))}const Sy=(e,t,r)=>kj(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function _j(e,t){(e==null?void 0:e.v7_startTransition)===void 0&&Sy("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&Sy("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Wo(e){let{to:t,replace:r,state:n,relative:s}=e;Zl()||Pt(!1);let{future:i,static:l}=E.useContext(ja),{matches:o}=E.useContext(Is),{pathname:u}=Aa(),c=fn(),d=fg(t,hg(o,i.v7_relativeSplatPath),u,s==="path"),h=JSON.stringify(d);return E.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function tn(e){Pt(!1)}function Sj(e){let{basename:t="/",children:r=null,location:n,navigationType:s=oa.Pop,navigator:i,static:l=!1,future:o}=e;Zl()&&Pt(!1);let u=t.replace(/^\/*/,"/"),c=E.useMemo(()=>({basename:u,navigator:i,static:l,future:ku({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Kl(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:g="default"}=n,y=E.useMemo(()=>{let v=dg(d,u);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:g},navigationType:s}},[u,d,h,f,p,g,s]);return y==null?null:E.createElement(ja.Provider,{value:c},E.createElement(Ch.Provider,{children:r,value:y}))}function Ty(e){let{children:t,location:r}=e;return dj(Ip(t),r)}new Promise(()=>{});function Ip(e,t){t===void 0&&(t=[]);let r=[];return E.Children.forEach(e,(n,s)=>{if(!E.isValidElement(n))return;let i=[...t,s];if(n.type===E.Fragment){r.push.apply(r,Ip(n.props.children,i));return}n.type!==tn&&Pt(!1),!n.props.index||!n.props.children||Pt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Ip(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(this,arguments)}function Tj(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Cj(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jj(e,t){return e.button===0&&(!t||t==="_self")&&!Cj(e)}const Aj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ij="6";try{window.__reactRouterVersion=Ij}catch{}const Rj="startTransition",Cy=G_[Rj];function Lj(e){let{basename:t,children:r,future:n,window:s}=e,i=E.useRef();i.current==null&&(i.current=DC({window:s,v5Compat:!0}));let l=i.current,[o,u]=E.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},d=E.useCallback(h=>{c&&Cy?Cy(()=>u(h)):u(h)},[u,c]);return E.useLayoutEffect(()=>l.listen(d),[l,d]),E.useEffect(()=>_j(n),[n]),E.createElement(Sj,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const Oj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lp=E.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:d,viewTransition:h}=t,f=Tj(t,Aj),{basename:p}=E.useContext(ja),g,y=!1;if(typeof c=="string"&&Pj.test(c)&&(g=c,Oj))try{let w=new URL(window.location.href),_=c.startsWith("//")?new URL(w.protocol+c):new URL(c),k=dg(_.pathname,p);_.origin===w.origin&&k!=null?c=k+_.search+_.hash:y=!0}catch{}let v=uj(c,{relative:s}),x=Dj(c,{replace:l,state:o,target:u,preventScrollReset:d,relative:s,viewTransition:h});function b(w){n&&n(w),w.defaultPrevented||x(w)}return E.createElement("a",Rp({},f,{href:g||v,onClick:y||i?n:b,ref:r,target:u}))});var jy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(jy||(jy={}));var Ay;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ay||(Ay={}));function Dj(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=fn(),c=Aa(),d=q2(e,{relative:l});return E.useCallback(h=>{if(jj(h,r)){h.preventDefault();let f=n!==void 0?n:Vd(c)===Vd(d);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,d,n,s,r,e,i,l,o])}const Mj="modulepreload",Fj=function(e){return"/"+e},Iy={},Ml=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=Fj(u),u in Iy)return;Iy[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Mj,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Uj=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:n}=await Promise.resolve().then(()=>Xl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class gg extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Bj extends gg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Hj extends gg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class $j extends gg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Op;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Op||(Op={}));var zj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class qj{constructor(t,{headers:r={},customFetch:n,region:s=Op.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Uj(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return zj(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:l}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let c;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=l):typeof l=="string"?(o["Content-Type"]="text/plain",c=l):typeof FormData<"u"&&l instanceof FormData?c=l:(o["Content-Type"]="application/json",c=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(g=>{throw new Bj(g)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Hj(d);if(!d.ok)throw new $j(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var Rr={},xg={},jh={},tc={},Ah={},Ih={},Vj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fl=Vj();const Wj=Fl.fetch,Y2=Fl.fetch.bind(Fl),Q2=Fl.Headers,Gj=Fl.Request,Yj=Fl.Response,Xl=Object.freeze(Object.defineProperty({__proto__:null,Headers:Q2,Request:Gj,Response:Yj,default:Y2,fetch:Wj},Symbol.toStringTag,{value:"Module"})),Qj=I_(Xl);var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});let Kj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Rh.default=Kj;var K2=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ih,"__esModule",{value:!0});const Zj=K2(Qj),Xj=K2(Rh);let Jj=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Zj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,u;let c=null,d=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const y=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");y&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const y=await i.text();try{c=JSON.parse(y),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,p="OK")}catch{i.status===404&&y===""?(f=204,p="No Content"):c={message:y}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new Xj.default(c)}return{error:c,data:d,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var l,o,u;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Ih.default=Jj;var e3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ah,"__esModule",{value:!0});const t3=e3(Ih);let r3=class extends t3.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:l="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${c}"; options=${u};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ah.default=r3;var n3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tc,"__esModule",{value:!0});const s3=n3(Ah);let a3=class extends s3.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};tc.default=a3;var i3=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jh,"__esModule",{value:!0});const go=i3(tc);let l3=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&(this.headers.Prefer=`count=${n}`),new go.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new go.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const l="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new go.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new go.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new go.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};jh.default=l3;var Lh={},Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.version=void 0;Oh.version="0.0.0-automated";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.DEFAULT_HEADERS=void 0;const o3=Oh;Lh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${o3.version}`};var Z2=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xg,"__esModule",{value:!0});const u3=Z2(jh),c3=Z2(tc),d3=Lh;let h3=class X2{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},d3.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new u3.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new X2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let l;const o=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new c3.default({method:l,url:o,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};xg.default=h3;var Jl=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.PostgrestError=Rr.PostgrestBuilder=Rr.PostgrestTransformBuilder=Rr.PostgrestFilterBuilder=Rr.PostgrestQueryBuilder=Rr.PostgrestClient=void 0;const J2=Jl(xg);Rr.PostgrestClient=J2.default;const eE=Jl(jh);Rr.PostgrestQueryBuilder=eE.default;const tE=Jl(tc);Rr.PostgrestFilterBuilder=tE.default;const rE=Jl(Ah);Rr.PostgrestTransformBuilder=rE.default;const nE=Jl(Ih);Rr.PostgrestBuilder=nE.default;const sE=Jl(Rh);Rr.PostgrestError=sE.default;var f3=Rr.default={PostgrestClient:J2.default,PostgrestQueryBuilder:eE.default,PostgrestFilterBuilder:tE.default,PostgrestTransformBuilder:rE.default,PostgrestBuilder:nE.default,PostgrestError:sE.default};const{PostgrestClient:m3,PostgrestQueryBuilder:vH,PostgrestFilterBuilder:wH,PostgrestTransformBuilder:EH,PostgrestBuilder:NH,PostgrestError:kH}=f3,p3="2.11.2",g3={"X-Client-Info":`realtime-js/${p3}`},x3="1.0.0",aE=1e4,y3=1e3;var ul;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ul||(ul={}));var Hr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Hr||(Hr={}));var Nn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Nn||(Nn={}));var Pp;(function(e){e.websocket="websocket"})(Pp||(Pp={}));var Va;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Va||(Va={}));class b3{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const c=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class iE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ht;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ht||(ht={}));const Ry=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,l)=>(i[l]=v3(l,e,t,s),i),{})},v3=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?lE(i,l):Dp(l)},lE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return k3(t,r)}switch(e){case ht.bool:return w3(t);case ht.float4:case ht.float8:case ht.int2:case ht.int4:case ht.int8:case ht.numeric:case ht.oid:return E3(t);case ht.json:case ht.jsonb:return N3(t);case ht.timestamp:return _3(t);case ht.abstime:case ht.date:case ht.daterange:case ht.int4range:case ht.int8range:case ht.money:case ht.reltime:case ht.text:case ht.time:case ht.timestamptz:case ht.timetz:case ht.tsrange:case ht.tstzrange:return Dp(t);default:return Dp(t)}},Dp=e=>e,w3=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},E3=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},N3=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},k3=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>lE(t,o))}return e},_3=e=>typeof e=="string"?e.replace(" ","T"):e,oE=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ff{constructor(t,r,n={},s=aE){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ly;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ly||(Ly={}));class Go{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Go.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=Go.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Go.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,d)=>{l[c]||(u[c]=d)}),this.map(l,(c,d)=>{const h=i[c];if(h){const f=d.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),g=d.filter(v=>p.indexOf(v.presence_ref)<0),y=h.filter(v=>f.indexOf(v.presence_ref)<0);g.length>0&&(o[c]=g),y.length>0&&(u[c]=y)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),d.length>0){const h=t[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);t[o].unshift(...f)}n(o,d,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Oy;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Oy||(Oy={}));var Py;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Py||(Py={}));var fs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(fs||(fs={}));class yg{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ff(this,Nn.join,this.params,this.timeout),this.rejoinTimer=new iE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Hr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Nn.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Go(this),this.broadcastEndpointURL=oE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:l,private:o}}=this.params;this._onError(d=>t==null?void 0:t(fs.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(fs.CLOSED));const u={},c={broadcast:i,presence:l,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(fs.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,g=[];for(let y=0;y<p;y++){const v=f[y],{filter:{event:x,schema:b,table:w,filter:_}}=v,k=d&&d[y];if(k&&k.event===x&&k.schema===b&&k.table===w&&k.filter===_)g.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),t==null||t(fs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(fs.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(fs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(fs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Hr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new Ff(this,Nn.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ff(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:d}=Nn;if(n&&[o,u,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,y,v;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((v=(y=p.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===l}).map(p=>p.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(p=>{var g,y,v,x,b,w;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in p){const _=p.id,k=(g=p.filter)===null||g===void 0?void 0:g.event;return _&&((y=r.ids)===null||y===void 0?void 0:y.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(b=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return _==="*"||_===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===l}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:y,table:v,commit_timestamp:x,type:b,errors:w}=g;f=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(g))}p.callback(f,n)})}_isClosed(){return this.state===Hr.closed}_isJoined(){return this.state===Hr.joined}_isJoining(){return this.state===Hr.joining}_isLeaving(){return this.state===Hr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&yg.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Nn.close,{},t)}_onError(t){this._on(Nn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ry(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ry(t.columns,t.old_record)),r}}const S3=()=>{},T3=typeof WebSocket<"u",C3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class j3{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=g3,this.params={},this.timeout=aE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=S3,this.conn=null,this.sendBuffer=[],this.serializer=new b3,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...o)=>Ml(async()=>{const{default:u}=await Promise.resolve().then(()=>Xl);return{default:u}},void 0).then(({default:u})=>u(...o)):l=fetch,(...o)=>l(...o)},this.endPoint=`${t}/${Pp.websocket}`,this.httpEndpoint=oE(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,l)=>l(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new iE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(T3){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new A3(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ml(async()=>{const{default:t}=await import("./browser-DlJfKBlf.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:x3}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ul.connecting:return Va.Connecting;case ul.open:return Va.Open;case ul.closing:return Va.Closing;default:return Va.Closed}}isConnected(){return this.connectionState()===Va.Open}channel(t,r={config:{}}){const n=new yg(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(Nn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(y3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:l}=r;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${l&&"("+l+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,l)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Nn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([C3],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class A3{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ul.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class bg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class I3 extends bg{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Mp extends bg{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var R3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const uE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:n}=await Promise.resolve().then(()=>Xl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},L3=()=>R3(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ml(()=>Promise.resolve().then(()=>Xl),void 0)).Response:Response}),Fp=e=>{if(Array.isArray(e))return e.map(r=>Fp(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Fp(n)}),t};var _i=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Uf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),O3=(e,t,r)=>_i(void 0,void 0,void 0,function*(){const n=yield L3();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new I3(Uf(s),e.status||500))}).catch(s=>{t(new Mp(Uf(s),s))}):t(new Mp(Uf(e),e))}),P3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function rc(e,t,r,n,s,i){return _i(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,P3(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>O3(u,o,n))})})}function Wd(e,t,r,n){return _i(this,void 0,void 0,function*(){return rc(e,"GET",t,r,n)})}function qs(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return rc(e,"POST",t,n,s,r)})}function D3(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return rc(e,"PUT",t,n,s,r)})}function M3(e,t,r,n){return _i(this,void 0,void 0,function*(){return rc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function cE(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return rc(e,"DELETE",t,n,s,r)})}var Sr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const F3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Dy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class U3{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=uE(s)}uploadOrUpdate(t,r,n,s){return Sr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Dy),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Gt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Sr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:Dy.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(Gt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return Sr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield qs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new bg("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Gt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield qs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Gt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Sr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield qs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(Gt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Sr(this,void 0,void 0,function*(){try{const s=yield qs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(Gt(s))return{data:null,error:s};throw s}})}download(t,r){return Sr(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Wd(this.fetch,`${this.url}/${s}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Gt(o))return{data:null,error:o};throw o}})}info(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Wd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Fp(n),error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}})}exists(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield M3(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Gt(n)&&n instanceof Mp){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Sr(this,void 0,void 0,function*(){try{return{data:yield cE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Sr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},F3),r),{prefix:t||""});return{data:yield qs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Gt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const B3="2.7.1",H3={"X-Client-Info":`storage-js/${B3}`};var Ri=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class $3{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},H3),r),this.fetch=uE(n)}listBuckets(){return Ri(this,void 0,void 0,function*(){try{return{data:yield Wd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Gt(t))return{data:null,error:t};throw t}})}getBucket(t){return Ri(this,void 0,void 0,function*(){try{return{data:yield Wd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ri(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ri(this,void 0,void 0,function*(){try{return{data:yield D3(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ri(this,void 0,void 0,function*(){try{return{data:yield qs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ri(this,void 0,void 0,function*(){try{return{data:yield cE(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}}class z3 extends $3{constructor(t,r={},n){super(t,r,n)}from(t){return new U3(this.url,this.headers,t,this.fetch)}}const q3="2.49.4";let Ro="";typeof Deno<"u"?Ro="deno":typeof document<"u"?Ro="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ro="react-native":Ro="node";const V3={"X-Client-Info":`supabase-js-${Ro}/${q3}`},W3={headers:V3},G3={schema:"public"},Y3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Q3={};var K3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Z3=e=>{let t;return e?t=e:typeof fetch>"u"?t=Y2:t=fetch,(...r)=>t(...r)},X3=()=>typeof Headers>"u"?Q2:Headers,J3=(e,t,r)=>{const n=Z3(r),s=X3();return(i,l)=>K3(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},l),{headers:c}))})};var eA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};function tA(e){return e.replace(/\/$/,"")}function rA(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:l,auth:o,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>eA(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const dE="2.69.1",Ui=30*1e3,Up=3,Bf=Up*Ui,nA="http://localhost:9999",sA="supabase.auth.token",aA={"X-Client-Info":`gotrue-js/${dE}`},Bp="X-Supabase-Api-Version",hE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},iA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,lA=6e5;class vg extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Me(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class oA extends vg{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function uA(e){return Me(e)&&e.name==="AuthApiError"}class fE extends vg{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ia extends vg{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Fs extends Ia{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cA(e){return Me(e)&&e.name==="AuthSessionMissingError"}class Hf extends Ia{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hc extends Ia{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class $c extends Ia{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function dA(e){return Me(e)&&e.name==="AuthImplicitGrantRedirectError"}class My extends Ia{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hp extends Ia{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function $f(e){return Me(e)&&e.name==="AuthRetryableFetchError"}class Fy extends Ia{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Yo extends Ia{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Uy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),By=` 	
\r=`.split(""),hA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<By.length;t+=1)e[By[t].charCodeAt(0)]=-2;for(let t=0;t<Uy.length;t+=1)e[Uy[t].charCodeAt(0)]=t;return e})();function mE(e,t,r){const n=hA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Hy(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{pA(l,n,r)};for(let l=0;l<e.length;l+=1)mE(e.charCodeAt(l),s,i);return t.join("")}function fA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function mA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}fA(n,t)}}function pA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function gA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)mE(e.charCodeAt(s),r,n);return new Uint8Array(t)}function xA(e){const t=[];return mA(e,r=>t.push(r)),new Uint8Array(t)}function yA(e){return Math.round(Date.now()/1e3)+e}function bA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Hn=()=>typeof window<"u"&&typeof document<"u",Ua={tested:!1,writable:!1},Qo=()=>{if(!Hn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ua.tested)return Ua.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ua.tested=!0,Ua.writable=!0}catch{Ua.tested=!0,Ua.writable=!1}return Ua.writable};function vA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const pE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:n}=await Promise.resolve().then(()=>Xl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},wA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",gE=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},zc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},qc=async(e,t)=>{await e.removeItem(t)};class Ph{constructor(){this.promise=new Ph.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ph.promiseConstructor=Promise;function zf(e){const t=e.split(".");if(t.length!==3)throw new Yo("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!iA.test(t[n]))throw new Yo("JWT not in base64url format");return{header:JSON.parse(Hy(t[0])),payload:JSON.parse(Hy(t[1])),signature:gA(t[2]),raw:{header:t[0],payload:t[1]}}}async function EA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function NA(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function kA(e){return("0"+e.toString(16)).substr(-2)}function _A(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,kA).join("")}async function SA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function TA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await SA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Li(e,t,r=!1){const n=_A();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await gE(e,`${t}-code-verifier`,s);const i=await TA(n);return[i,n===i?"plain":"s256"]}const CA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jA(e){const t=e.headers.get(Bp);if(!t||!t.match(CA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function AA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function IA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var RA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const qa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),LA=[502,503,504];async function $y(e){var t;if(!wA(e))throw new Hp(qa(e),0);if(LA.includes(e.status))throw new Hp(qa(e),e.status);let r;try{r=await e.json()}catch(i){throw new fE(qa(i),i)}let n;const s=jA(e);if(s&&s.getTime()>=hE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Fy(qa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Fs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Fy(qa(r),e.status,r.weak_password.reasons);throw new oA(qa(r),e.status||500,n)}const OA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function We(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Bp]||(i[Bp]=hE["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await PA(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function PA(e,t,r,n,s,i){const l=OA(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new Hp(qa(u),0)}if(o.ok||await $y(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await $y(u)}}function Us(e){var t;let r=null;UA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=yA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function zy(e){const t=Us(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Qs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function DA(e){return{data:e,error:null}}function MA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=RA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function FA(e){return e}function UA(e){return e.access_token&&e.refresh_token&&e.expires_in}var BA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class HA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=pE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await We(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await We(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Qs})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=BA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await We(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:MA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Me(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await We(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Qs})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:FA});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,p=(u=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(g.split(";")[1].split("=")[1]);c[`${v}Page`]=y}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Me(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await We(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Qs})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await We(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Qs})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await We(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Qs})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await We(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await We(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}}const $A={getItem:e=>Qo()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Qo()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Qo()&&globalThis.localStorage.removeItem(e)}};function qy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function zA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Oi={debug:!!(globalThis&&Qo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class xE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class qA extends xE{}async function VA(e,t,r){Oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Oi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new qA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Oi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}zA();const WA={url:nA,storageKey:sA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Vy(e,t,r){return await r()}class _u{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_u.nextInstanceID,_u.nextInstanceID+=1,this.instanceID>0&&Hn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},WA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new HA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=pE(s.fetch),this.lock=s.lock||Vy,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Hn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=VA:this.lock=Vy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Qo()?this.storage=$A:(this.memoryStorage={},this.storage=qy(this.memoryStorage)):(this.memoryStorage={},this.storage=qy(this.memoryStorage)),Hn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dE}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=vA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Hn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),dA(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Me(r)?{error:r}:{error:new fE("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Us}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Me(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Li(this.storage,this.storageKey)),i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:Us})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Us})}else throw new Hc("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Me(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:zy})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:zy})}else throw new Hc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Hf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await zc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:l}=await We(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Us});if(await qc(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Hf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(Me(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Us}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Hf}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Li(this.storage,this.storageKey));const{error:h}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:d}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Hc("You must provide either an email or phone number.")}catch(o){if(Me(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Us});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Me(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Li(this.storage,this.storageKey)),await We(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:DA})}catch(i){if(Me(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Fs;const{error:s}=await We(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Me(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await We(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await We(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new Hc("You must provide either an email or phone number and a type")}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await zc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Bf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!l&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Qs}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fs}:await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Qs})})}catch(r){if(Me(r))return cA(r)&&(await this._removeSession(),await qc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Fs;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await Li(this.storage,this.storageKey));const{data:c,error:d}=await We(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:Qs});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Fs;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=zf(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Me(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Fs;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Hn())throw new $c("No browser detected.");if(t.error||t.error_description||t.error_code)throw new $c(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new My("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $c("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new My("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new $c("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;u&&(f=parseInt(u));const p=f-d;p*1e3<=Ui&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=f-h;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:y,error:v}=await this._getUser(i);if(v)throw v;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Me(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await zc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(uA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await qc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=bA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Li(this.storage,this.storageKey,!0));try{return await We(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Me(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await We(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Hn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Me(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await We(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await NA(async s=>(s>0&&await EA(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await We(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Us})),(s,i)=>{const l=200*Math.pow(2,s);return i&&$f(i)&&Date.now()+l-n<Ui})}catch(n){if(this._debug(r,"error",n),Me(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Hn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await zc(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Bf;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Bf}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),$f(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Fs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ph;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Fs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Me(i)){const l={session:null,error:i};return $f(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await gE(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await qc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Hn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ui);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Ui);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ui}ms, refresh threshold is ${Up} ticks`),s<=Up&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof xE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Hn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await Li(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await We(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await We(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(Me(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Me(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=zf(s.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n||(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+lA>Date.now()))return n;const{data:s,error:i}=await We(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Yo("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(l=>l.kid===t),!n)throw new Yo("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=zf(n);if(AA(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:l},error:null}}const c=IA(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,l,xA(`${o}.${u}`)))throw new Yo("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}}_u.nextInstanceID=0;const GA=_u;class YA extends GA{constructor(t){super(t)}}var QA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class KA{constructor(t,r,n){var s,i,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=tA(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:G3,realtime:Q3,auth:Object.assign(Object.assign({},Y3),{storageKey:u}),global:W3},d=rA(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=J3(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new m3(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new qj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new z3(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return QA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:l,lock:o,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:l,lock:o,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new j3(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZA=(e,t,r)=>new KA(e,t,r),XA="https://tkenxulvmzhhkuhfvcpt.supabase.co",JA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrZW54dWx2bXpoaGt1aGZ2Y3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgwOTEwNzgsImV4cCI6MjA1MzY2NzA3OH0.UJPzvtHD6k6rJ09BlFYkdYEyHC3sx3h1rpAG8DULSHI",qf={maxRetries:3,retryDelay:1e3,retryCondition:e=>{var t,r,n,s,i;return(e==null?void 0:e.status)===500||(e==null?void 0:e.status)===503||(e==null?void 0:e.status)===504||(e==null?void 0:e.status)===429||((t=e==null?void 0:e.message)==null?void 0:t.includes("Database error"))||((r=e==null?void 0:e.message)==null?void 0:r.includes("unexpected_failure"))||((n=e==null?void 0:e.message)==null?void 0:n.includes("schema"))||((s=e==null?void 0:e.message)==null?void 0:s.includes("network"))||((i=e==null?void 0:e.message)==null?void 0:i.includes("timeout"))}},re=ZA(XA,JA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"dragonbane_auth",flowType:"implicit"},global:{headers:{"X-Client-Info":"dragonbane-character-manager"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}},maxRetries:qf.maxRetries,retryDelay:qf.retryDelay,retryCondition:qf.retryCondition});re.auth.onAuthStateChange((e,t)=>{(e==="USER_DELETED"||e==="SIGNED_OUT")&&console.log("Auth event:",e),e==="TOKEN_REFRESHED"&&console.log("Token refreshed successfully"),e==="SIGNED_OUT"&&!t&&console.error("Auth error: Session ended unexpectedly")});window.addEventListener("online",()=>{re.auth.startAutoRefresh()});window.addEventListener("offline",()=>{re.auth.stopAutoRefresh()});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yE=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var t4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},u)=>E.createElement("svg",{ref:u,...t4,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:yE("lucide",s),...o},[...l.map(([c,d])=>E.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=(e,t)=>{const r=E.forwardRef(({className:n,...s},i)=>E.createElement(r4,{ref:i,iconNode:t,className:yE(`lucide-${e4(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=ne("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=ne("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=ne("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z",key:"wvr1b5"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}],["path",{d:"M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5",key:"xk3gvk"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=ne("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=ne("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=ne("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=ne("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=ne("BookUser",[["path",{d:"M15 13a3 3 0 1 0-6 0",key:"10j68g"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=ne("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=ne("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=ne("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=ne("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=ne("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=ne("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=ne("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=ne("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=ne("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=ne("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=ne("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=ne("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=ne("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=ne("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=ne("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=ne("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=ne("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=ne("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=ne("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=ne("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=ne("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=ne("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=ne("Dice4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=ne("Dice6",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=ne("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=ne("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=ne("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=ne("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=ne("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=ne("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=ne("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=ne("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=ne("HeartCrack",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"m12 13-1-1 2-2-3-3 2-2",key:"xjdxli"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=ne("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=ne("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=ne("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=ne("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=ne("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=ne("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=ne("LampDesk",[["path",{d:"m14 5-3 3 2 7 8-8-7-2Z",key:"1b0msb"}],["path",{d:"m14 5-3 3-3-3 3-3 3 3Z",key:"1uemms"}],["path",{d:"M9.5 6.5 4 12l3 6",key:"1bx08v"}],["path",{d:"M3 22v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2H3Z",key:"wap775"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=ne("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=ne("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=ne("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=ne("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=ne("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=ne("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=ne("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=ne("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=ne("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=ne("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=ne("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=ne("Notebook",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=ne("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=ne("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=ne("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=ne("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=ne("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=ne("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=ne("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=ne("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=ne("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=ne("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=ne("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=ne("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=ne("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=ne("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ne("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=ne("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=ne("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=ne("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=ne("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=ne("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=ne("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=ne("SquareMinus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=ne("SquareUser",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 21v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2",key:"1m6ac2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=ne("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=ne("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=ne("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=ne("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=ne("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=ne("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=ne("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=ne("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=ne("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=ne("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=ne("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=ne("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=ne("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=ne("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=ne("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=ne("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=ne("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=ne("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=ne("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),OE=E.createContext(void 0);function Y4({children:e}){const[t,r]=E.useState(null),[n,s]=E.useState(!1),[i,l]=E.useState(null);return a.jsxs(OE.Provider,{value:{setGlobalError:r,setGlobalLoading:s,setGlobalWarning:l},children:[n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})})}),i&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(oc,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-yellow-700",children:i})}),a.jsx("button",{onClick:()=>l(null),className:"text-yellow-500 hover:text-yellow-700",children:a.jsx(Rt,{className:"w-5 h-5"})})]})})}),t&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Dt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-700",children:t})}),a.jsx("button",{onClick:()=>r(null),className:"text-red-500 hover:text-red-700",children:a.jsx(Rt,{className:"w-5 h-5"})})]})})}),e]})}function PE(){const e=E.useContext(OE);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}async function Q4(e,t,r,n){const{data:s,error:i}=await re.auth.signUp({email:e,password:t,options:{data:{username:r.trim(),role:n}}});if(i)throw i.message.includes("User already registered")?new Error("An account with this email already exists."):(console.error("Sign up error (auth):",i.message),new Error(`Authentication error: ${i.message}`));if(!s.user)throw console.error("Sign up error: User object not returned after sign up."),new Error("Sign up failed: Could not retrieve user information.");const{error:l}=await re.from("users").insert({id:s.user.id,username:r.trim(),role:n,email:e});if(l)throw console.error("Sign up error (profile creation):",l.message),new Error(`Account created, but failed to set up user profile: ${l.message}. Please contact support.`);return s.user}async function K4(e,t){const{data:r,error:n}=await re.auth.signInWithPassword({email:e,password:t});if(n)throw n;if(r.user){const{error:s}=await re.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.user.id);s&&console.error("Failed to update user timestamps on login:",s.message)}if(!r.session){const{data:s,error:i}=await re.auth.getSession();if(i)throw i;return{user:r.user,session:s.session}}return{user:r.user,session:r.session}}async function Z4(){const{error:e}=await re.auth.signOut();if(e)throw console.error("Sign out error:",e.message),e}const tb=["player","dm","admin"],DE=E.createContext(void 0);function qt(){const e=E.useContext(DE);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function X4({children:e}){const[t,r]=E.useState(null),[n,s]=E.useState(null),[i,l]=E.useState(null),[o,u]=E.useState(!0),[c,d]=E.useState(!1),h=fn(),{setGlobalError:f}=PE(),p=E.useCallback(async k=>{var S,A,R;try{const{data:L}=await re.auth.getSession(),T=(R=(A=(S=L==null?void 0:L.session)==null?void 0:S.user)==null?void 0:A.user_metadata)==null?void 0:R.role;if(T&&tb.includes(T))return T;const{data:z,error:O}=await re.from("users").select("role").eq("id",k).single();if(O)return console.error("Error fetching user role from table:",O.message),"player";const Y=z==null?void 0:z.role;return Y&&tb.includes(Y)?Y:"player"}catch(L){return console.error("Unexpected error in fetchUserRole:",L),"player"}},[]);E.useEffect(()=>{re.auth.getSession().then(({data:{session:S}})=>{s(S),r((S==null?void 0:S.user)??null)}).catch(S=>{console.error("Error getting initial session:",S),r(null),s(null),u(!1)});const{data:k}=re.auth.onAuthStateChange((S,A)=>{s(A),r((A==null?void 0:A.user)??null)});return()=>{var S;(S=k==null?void 0:k.subscription)==null||S.unsubscribe()}},[]),E.useEffect(()=>{t?p(t.id).then(l).finally(()=>{u(!1)}):(l(null),u(!1))},[t,p]);const g=async(k,S,A,R)=>{try{d(!0),f(null),await Q4(k,S,A,R)}catch(L){throw f(L instanceof Error?L.message:"Signup failed"),L}finally{d(!1)}},y=async(k,S)=>{try{d(!0),f(null),await K4(k,S),h("/")}catch(A){let R="Authentication failed. Please check your credentials.";throw A instanceof Error&&(A.message.includes("Invalid login credentials")?R="Incorrect email or password.":A.message.includes("Email not confirmed")?R="Please verify your email address before logging in.":A.message.includes("network error")||A.message.includes("Failed to fetch")?R="Network error. Please check your connection and try again.":R=A.message.length>100?"An unexpected authentication error occurred.":A.message),f(R),new Error(R)}finally{d(!1)}},v=E.useCallback(async()=>{if(!c)try{d(!0),await Z4(),r(null),s(null),l(null),f(null),h("/login")}catch(k){console.error("Sign out error:",k),f("Failed to sign out")}finally{d(!1)}},[c,h,f]),x=()=>i==="admin",b=()=>i==="dm"||i==="admin",w=()=>i==="player",_=o||c;return a.jsx(DE.Provider,{value:{user:t,session:n,role:i,isLoading:_,signIn:y,signUp:g,signOut:v,isAdmin:x,isDM:b,isPlayer:w},children:e})}const ME=E.createContext(void 0),Vc=30*60*1e3,rb=30*1e3,J4=10*1e3;function e6({children:e}){const{signOut:t}=qt(),r=fn(),n=E.useRef(Date.now()),s=E.useRef(null),i=E.useRef(null),[l,o]=E.useState(!1),u=E.useCallback(()=>{s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{o(!0)},Vc-rb),s.current=setTimeout(async()=>{await t(),r("/login",{state:{message:"Your session has expired due to inactivity."}})},Vc),n.current=Date.now(),o(!1)},[t,r]),c=E.useCallback(()=>{u()},[u]);return E.useEffect(()=>{const d=["mousedown","keydown","scroll","mousemove","click","touchstart"];let h;function f(g,y){let v;return function(...b){const w=()=>{clearTimeout(v),g(...b)};clearTimeout(v),v=setTimeout(w,y)}}const p=f(()=>{Date.now()-n.current>1e3&&u()},1e3);return d.forEach(g=>{document.addEventListener(g,p)}),h=window.setInterval(()=>{const g=Date.now()-n.current;g>=Vc-rb&&o(!0),g>=Vc&&(t(),r("/login",{state:{message:"Your session has expired due to inactivity."}}))},J4),u(),()=>{d.forEach(g=>{document.removeEventListener(g,p)}),s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),window.clearInterval(h)}},[u,t,r]),a.jsx(ME.Provider,{value:{showWarning:l,extendSession:c},children:e})}function t6(){const e=E.useContext(ME);if(e===void 0)throw new Error("useSessionTimeout must be used within a SessionTimeoutProvider");return e}const qn=class qn{constructor(){wc(this,"environment");this.environment="production"}static getInstance(){return qn.instance||(qn.instance=new qn),qn.instance}logError(t,r={},n="medium"){const s={error:t,context:{...r,timestamp:new Date().toISOString(),path:window.location.pathname},severity:n};this.environment==="development"&&console.error("Error Report:",{message:t.message,stack:t.stack,...s.context,severity:n}),this.environment==="production"&&this.sendToErrorTrackingService(s)}async sendToErrorTrackingService(t){try{console.error("Production Error:",t)}catch(r){console.error("Failed to send error report:",r)}}static handleError(t,r){const n=qn.getInstance();t instanceof Error?n.logError(t,r):n.logError(new Error(String(t)),r)}static handleNetworkError(t,r){const n=qn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("network")||t.message.toLowerCase().includes("connection")||t.message.toLowerCase().includes("offline");n.logError(t,{...r,additionalData:{isNetworkError:s}},s?"high":"medium")}}static handleAuthError(t,r){const n=qn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("auth")||t.message.toLowerCase().includes("unauthorized")||t.message.toLowerCase().includes("forbidden");n.logError(t,{...r,additionalData:{isAuthError:s}},s?"high":"medium")}}};wc(qn,"instance");let fl=qn;class r6 extends E.Component{constructor(r){super(r);wc(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){fl.handleError(r,{action:"render",additionalData:{componentStack:n.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(oc,{className:"w-8 h-8 text-red-500"}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Something went wrong"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. The application has encountered an unexpected error."}),this.state.error&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-red-700 font-mono break-all",children:this.state.error.message||"No error message available"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(CE,{className:"w-5 h-5"}),"Refresh Page"]}),a.jsxs(Lp,{to:"/",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(v4,{className:"w-5 h-5"}),"Go Home"]})]})]})}):this.props.children}}const FE=new vC({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1,retry:1}}}),n6=/(\d+)?d(\d+)/i;function s6(e){const t=e.match(n6);if(!t){const i=`d${e.replace(/\D/g,"")}`;return["d4","d6","d8","d10","d12","d20"].includes(i)?[i]:(console.warn(`Invalid dice string format: "${e}". Could not parse.`),[])}const r=parseInt(t[1]||"1",10),n=parseInt(t[2],10),s=`d${n}`;return["d4","d6","d8","d10","d12","d20"].includes(s)?Array(r).fill(s):(console.warn(`Invalid die type in string: "d${n}" from "${e}".`),[])}const UE=E.createContext(void 0),a6=20;function i6({children:e}){const[t,r]=E.useState(!1),[n,s]=E.useState(null),[i,l]=E.useState([]),[o,u]=E.useState([]),[c,d]=E.useState(!1),[h,f]=E.useState(!1),p=E.useCallback(k=>{r(S=>{const A=!S;if(A){const R={...k};R.label&&!R.description&&(R.description=R.label),s(R||null);let L=[];k!=null&&k.dice?L=s6(k.dice):k!=null&&k.initialDice&&(L=k.initialDice),(k==null?void 0:k.rollMode)==="deathRoll"?L=["d20"]:(k==null?void 0:k.rollMode)==="recoveryRoll"?L=["d6"]:(k==null?void 0:k.rollMode)==="rallyRoll"?L=["d20"]:(k==null?void 0:k.rollMode)==="skillCheck"&&L.length===0?L=["d20"]:(k==null?void 0:k.rollMode)==="advancementRoll"&&(L=["d20"]),l(L),d(!1),f((k==null?void 0:k.requiresBane)||(k==null?void 0:k.rollMode)==="rallyRoll"||!1)}else s(null),l([]),d(!1),f(!1);return A})},[]),g=E.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l(S=>[...S,k]),(c||h)&&(d(!1),f(!1)))},[c,h,n]),y=E.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||l(S=>{if(S.length===0)return[];if(k){const A=S.lastIndexOf(k);if(A!==-1){const R=[...S];return R.splice(A,1),R}}return S.slice(0,-1)})},[n]),v=E.useCallback(()=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l([]),d(!1),f(!1))},[n]),x=E.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(d(!0),f(!1),l(["d20"])):d(!1))},[n]),b=E.useCallback(k=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(k?(f(!0),d(!1),l(["d20"])):(n==null?void 0:n.rollMode)!=="rallyRoll"&&f(!1))},[n]),w=E.useCallback(k=>{u(S=>{const R=[{...k,id:crypto.randomUUID(),timestamp:Date.now()},...S];return R.length>a6&&R.pop(),R})},[]),_=E.useCallback(()=>{u([])},[]);return a.jsx(UE.Provider,{value:{showDiceRoller:t,currentConfig:n,dicePool:i,rollHistory:o,isBoonActive:c,isBaneActive:h,toggleDiceRoller:p,addDie:g,removeLastDie:y,clearDicePool:v,setBoon:x,setBane:b,addRollToHistory:w,clearHistory:_},children:e})}function Mn(){const e=E.useContext(UE);if(e===void 0)throw new Error("useDice must be used within a DiceProvider");return e}function l6(){const e=Aa(),{signOut:t,isAdmin:r,isDM:n,role:s}=qt(),{toggleDiceRoller:i}=Mn(),[l,o]=E.useState(!1),u=E.useRef(null),c=f=>e.pathname===f,d=[{path:"/",label:"Characters",icon:An,roles:["player","dm","admin"]},{path:"/compendium",label:"Compendium",icon:nc,roles:["player","dm","admin"]},{path:"/adventure-party",label:"Adventure Party",icon:xi,roles:["player","dm","admin"]},{path:"/notes",label:"Notes",icon:Ul,roles:["player","dm","admin"]},{path:"/settings",label:"Settings",icon:jE,roles:["player","dm","admin"]}],h=()=>{l&&o(!1)};return E.useEffect(()=>{const f=p=>{u.current&&!u.current.contains(p.target)&&o(!1)};return l?document.addEventListener("mousedown",f):document.removeEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[l]),a.jsxs("nav",{className:"bg-gray-800 text-white",ref:u,children:[a.jsx("div",{className:"container mx-auto px-4",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0"}),a.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-4",children:d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(Lp,{to:f,onClick:h,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-5 h-5"}),a.jsx("span",{children:p})]},f))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Open Dice Roller",children:[a.jsx(ur,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Dice"})]}),a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700",title:`Current role: ${s}`,children:[r()?a.jsx(Yy,{className:"w-5 h-5 text-yellow-400"}):n()?a.jsx(Cs,{className:"w-5 h-5 text-blue-400"}):a.jsx(An,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:r()?"Admin":n()?"DM":"Player"})]}),a.jsxs("button",{onClick:()=>{t(),h()},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Log Out",children:[a.jsx(Yd,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Log Out"})]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center",children:[a.jsx("button",{onClick:i,className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white mr-2",title:"Open Dice Roller",children:a.jsx(ur,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>o(!l),className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white","aria-expanded":l,"aria-controls":"mobile-menu",children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),l?a.jsx(Rt,{className:"block h-6 w-6"}):a.jsx(T4,{className:"block h-6 w-6"})]})]})]})}),l&&a.jsx("div",{className:"md:hidden absolute top-16 inset-x-0 bg-gray-800 z-50 shadow-lg",id:"mobile-menu",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(Lp,{to:f,onClick:h,className:`flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-6 h-6"}),a.jsx("span",{children:p})]},f)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700 w-full",children:r()?a.jsxs(a.Fragment,{children:[a.jsx(Yy,{className:"w-5 h-5 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}):n()?a.jsxs(a.Fragment,{children:[a.jsx(Cs,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-sm font-medium",children:"DM"})]}):a.jsxs(a.Fragment,{children:[a.jsx(An,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Player"})]})})}),a.jsxs("button",{onClick:()=>{t(),h()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:[a.jsx(Yd,{className:"w-6 h-6"}),a.jsx("span",{children:"Log Out"})]})]})})]})}function o6({character:e}){const t=r=>r>=16?"text-purple-600":r>=14?"text-blue-600":r>=12?"text-green-600":r>=10?"text-yellow-600":"text-gray-600";return a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.kin," ",e.profession]})]}),a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.age})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Cs,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:t(e.attributes.STR),children:e.attributes.STR})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ba,{className:"w-4 h-4 text-pink-600"}),a.jsx("span",{className:t(e.attributes.CON),children:e.attributes.CON})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bh,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{className:t(e.attributes.AGL),children:e.attributes.AGL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(wE,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:t(e.attributes.INT),children:e.attributes.INT})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(In,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:t(e.attributes.WIL),children:e.attributes.WIL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(An,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:t(e.attributes.CHA),children:e.attributes.CHA})]})]}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsx("p",{className:"line-clamp-2",children:e.appearance||"No appearance set"})})]})})}const u6={},nb=e=>{let t;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const p=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(g=>g(t,p))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(u6?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,s,u);return u},c6=e=>e?nb(e):nb;var BE={exports:{}},HE={},$E={exports:{}},zE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bl=E;function d6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var h6=typeof Object.is=="function"?Object.is:d6,f6=Bl.useState,m6=Bl.useEffect,p6=Bl.useLayoutEffect,g6=Bl.useDebugValue;function x6(e,t){var r=t(),n=f6({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return p6(function(){s.value=r,s.getSnapshot=t,Wf(s)&&i({inst:s})},[e,r,t]),m6(function(){return Wf(s)&&i({inst:s}),e(function(){Wf(s)&&i({inst:s})})},[e]),g6(r),r}function Wf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!h6(e,r)}catch{return!0}}function y6(e,t){return t()}var b6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?y6:x6;zE.useSyncExternalStore=Bl.useSyncExternalStore!==void 0?Bl.useSyncExternalStore:b6;$E.exports=zE;var v6=$E.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hh=E,w6=v6;function E6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var N6=typeof Object.is=="function"?Object.is:E6,k6=w6.useSyncExternalStore,_6=Hh.useRef,S6=Hh.useEffect,T6=Hh.useMemo,C6=Hh.useDebugValue;HE.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=_6(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=T6(function(){function u(p){if(!c){if(c=!0,d=p,p=n(p),s!==void 0&&l.hasValue){var g=l.value;if(s(g,p))return h=g}return h=p}if(g=h,N6(d,p))return g;var y=n(p);return s!==void 0&&s(g,y)?(d=p,g):(d=p,h=y)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,r,n,s]);var o=k6(e,i[0],i[1]);return S6(function(){l.hasValue=!0,l.value=o},[o]),C6(o),o};BE.exports=HE;var j6=BE.exports;const A6=dh(j6),qE={},{useDebugValue:I6}=Tn,{useSyncExternalStoreWithSelector:R6}=A6;let sb=!1;const L6=e=>e;function O6(e,t=L6,r){(qE?"production":void 0)!=="production"&&r&&!sb&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sb=!0);const n=R6(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return I6(n),n}const ab=e=>{(qE?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?c6(e):e,r=(n,s)=>O6(t,n,s);return Object.assign(r,t),r},VE=e=>e?ab(e):ab,es=VE(e=>({step:0,character:{},setStep:t=>e({step:t}),updateCharacter:t=>e(r=>({character:{...r.character,...t}})),resetCharacter:()=>e({character:{},step:0})}));async function P6(){const{data:e,error:t}=await re.from("kin").select("id, name, description, heroic_ability");if(t)throw console.error("Error fetching kin list:",t),new Error(t.message||"Failed to fetch kin list");return e||[]}async function D6(e){if(!e||e.length===0)return[];const t=e.map(s=>s.trim()).filter(s=>s);if(t.length===0)return[];const{data:r,error:n}=await re.from("heroic_abilities").select("id, name, description, willpower_cost, requirement").in("name",t);if(n)throw console.error("Error fetching ability details by names:",n),new Error(n.message||"Failed to fetch ability details");return(r||[]).map(s=>({id:s.id,name:s.name,description:s.description,willpower_cost:s.willpower_cost,requirement:s.requirement}))}function He({size:e="md",className:t=""}){const r={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-4",lg:"w-12 h-12 border-4"};return a.jsx("div",{className:`flex items-center justify-center ${t}`,role:"status",children:a.jsx("div",{className:`${r[e]} animate-spin rounded-full border-gray-200 border-t-blue-600`,"aria-label":"Loading..."})})}function Ne({message:e,onClose:t}){return e?a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 flex items-start justify-between",role:"alert",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(dl,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{className:"block sm:inline",children:e})]}),t&&a.jsx("button",{onClick:t,className:"ml-4 p-1 text-red-500 hover:text-red-700 hover:bg-red-200 rounded-full transition-colors","aria-label":"Close error message",children:a.jsx(Rt,{className:"w-4 h-4"})})]}):null}const ib=e=>e?e.split(",").map(t=>t.trim()).filter(t=>t):[];function M6(){const{character:e,updateCharacter:t}=es(),[r,n]=E.useState(null),{data:s=[],isLoading:i,error:l}=It({queryKey:["kinListWithHeroicAbility"],queryFn:P6,retry:!1});E.useEffect(()=>{if(e.kin&&s.length>0&&!r){const g=s.find(y=>y.name===e.kin);if(g){n(g.id);const y=ib(g.heroic_ability);JSON.stringify(e.kinAbilityNames)!==JSON.stringify(y)&&t({kinAbilityNames:y})}}},[e.kin,s,r,e.kinAbilityNames,t]);const o=g=>{n(g.id);const y=ib(g.heroic_ability);t({kin:g.name,kinAbilityNames:y})},u=E.useMemo(()=>s.find(g=>g.id===r),[s,r]),c=E.useMemo(()=>e.kinAbilityNames||[],[e.kinAbilityNames]),{data:d=[],isLoading:h,error:f}=It({queryKey:["abilityDetails",c.sort().join(",")],queryFn:()=>D6(c),enabled:c.length>0,staleTime:10*60*1e3,retry:!1}),p=g=>a.jsxs("div",{className:"mb-4 p-3 border rounded bg-gray-50 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-md text-gray-800",children:g.name}),g.willpower_cost!=null&&a.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:["Willpower Cost: ",g.willpower_cost]}),g.requirement&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requirement: ",g.requirement]}),a.jsx("p",{className:"text-sm text-gray-700 mt-2",children:g.description})]},g.id);if(i)return a.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:a.jsx(He,{size:"lg"})});if(l){const g=l instanceof Error?l.message:"Failed to load Kin options.";return console.error("Error loading Kin:",l),a.jsx(Ne,{title:"Error Loading Kin",message:g})}return a.jsxs("div",{className:"flex space-x-6 h-[60vh]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Kin List"}),a.jsx("ul",{className:"space-y-1",children:s.map(g=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md text-sm ${r===g.id?"bg-blue-100 font-semibold text-blue-800":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>o(g),children:g.name},g.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:u?a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-1",children:u.name}),a.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:u.description}),a.jsx("hr",{className:"my-4 border-gray-300"}),a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Kin Abilities"}),h?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(He,{})}):f?a.jsx(Ne,{title:"Error Loading Abilities",message:f.message||"Failed to load ability details."}):d.length>0?d.map(p):c.length>0&&!h?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-orange-600 italic mb-2",children:"Could not fetch full details for the following abilities (check names in database):"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:c.map(g=>a.jsx("li",{children:g},g))})]}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific heroic abilities listed for this Kin."})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"Select a kin from the list to view details and abilities."})})})]})}async function F6(){const{data:e,error:t}=await re.from("professions").select("*").order("name");if(t)throw console.error("Error fetching profession list:",t),new Error(t.message||"Failed to fetch profession list");return e||[]}async function U6(e){const{data:t,error:r}=await re.from("heroic_abilities").select("*").eq("profession",e);if(r)throw console.error("Error fetching heroic abilities:",r),new Error(r.message||"Failed to fetch heroic abilities");return t||[]}async function B6(){const{data:e,error:t}=await re.from("game_spells").select(`
      *,
      magic_schools ( name )
    `).order("name",{ascending:!0});if(t)throw console.error("Error fetching spells:",t),new Error(t.message||"Failed to fetch spells");return e||[]}async function zp(){const{data:e,error:t}=await re.from("magic_schools").select("id, name, description").order("name",{ascending:!0});if(t)throw console.error("Error fetching magic schools:",t),new Error(t.message||"Failed to fetch magic schools");return e||[]}function H6(){const{character:e,updateCharacter:t}=es(),[r,n]=E.useState(null),[s,i]=E.useState([]),[l,o]=E.useState(null),[u,c]=E.useState(!1),[d,h]=E.useState(null),{data:f=[],isLoading:p,error:g}=It({queryKey:["professions"],queryFn:F6}),{data:y=[],isLoading:v,error:x}=It({queryKey:["magicSchools"],queryFn:zp});E.useEffect(()=>{if(e.profession&&f.length>0){const A=f.find(R=>R.name===e.profession);if(A&&(n(A),A.magic_school_id===null&&e.professionHeroicAbilityName&&b(A.name,e.professionHeroicAbilityName),e.professionHeroicAbilityName&&s.length>0)){const R=s.find(L=>L.name===e.professionHeroicAbilityName);R&&o(R)}}},[e.profession,f,e.professionHeroicAbilityName]);const b=async(A,R)=>{c(!0),h(null);try{const T=await U6(A);i(T);const z=R??e.professionHeroicAbilityName;if(z){const O=T.find(Y=>Y.name===z);o(O||null)}else o(null)}catch(L){h(L instanceof Error?L.message:"Failed to load heroic abilities"),i([]),o(null)}finally{c(!1)}};E.useEffect(()=>{r&&r.magic_school_id===null?b(r.name):(i([]),o(null),e.professionHeroicAbilityName&&t({professionHeroicAbilityName:null}))},[r]);const w=A=>{var L;n(A),A.magic_school_id!==null&&((L=y.find(T=>T.id===A.magic_school_id))==null||L.name);const R={profession:A.name,key_attribute:A.key_attribute,magicSchool:A.magic_school_id??null,professionHeroicAbilityName:null};A.magic_school_id!==null&&o(null),t(R)},_=A=>{o(A),t({professionHeroicAbilityName:A.name})},k=A=>{var R;return A===null||y.length===0?null:((R=y.find(L=>L.id===A))==null?void 0:R.name)??`ID: ${A}`},S=(A,R)=>{if(!Array.isArray(A)||A.length===0)return a.jsxs("p",{className:"text-sm text-gray-500",children:["No ",R.toLowerCase()," listed."]});const L=A.filter(T=>typeof T=="string");return L.length===0?a.jsxs("p",{className:"text-sm text-gray-500",children:["No valid ",R.toLowerCase()," listed."]}):a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:L.map((T,z)=>a.jsx("li",{children:T},z))})};return p||v?a.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:a.jsx(He,{size:"lg"})}):g||x?a.jsx(Ne,{message:(g==null?void 0:g.message)||(x==null?void 0:x.message)||"Failed to load required data."}):(r&&console.log("Selected Profession Data:",r),a.jsxs("div",{className:"flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6 h-[80vh]",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 overflow-y-auto max-h-[30vh] md:max-h-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Profession List"}),a.jsx("ul",{className:"space-y-2",children:f.map(A=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md border ${(r==null?void 0:r.id)===A.id?"bg-blue-100 border-blue-300 font-semibold":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>w(A),children:A.name},A.id))})]}),a.jsx("div",{className:"w-full md:w-2/3 md:pl-4 overflow-y-auto max-h-[calc(80vh-30vh-2rem)] md:max-h-full",children:r?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:r.description})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Key Attribute"}),a.jsx("p",{className:"text-gray-700",children:r.key_attribute})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Skills"}),S(r.skills,"Skills")]}),r.starting_equipment&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Starting Equipment"}),S(r.starting_equipment,"Starting Equipment")]}),r.equipment_description&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Equipment Notes"}),S(r.equipment_description,"Equipment Notes")]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Heroic Ability / Magic"}),r.magic_school_id!==null?a.jsxs("p",{className:"text-gray-600",children:["As a mage of the ",a.jsx("strong",{children:k(r.magic_school_id)??"Unknown School"})," school, you don't get a starting heroic ability. Instead, you get your magic."]}):a.jsxs(a.Fragment,{children:[u&&a.jsx(He,{size:"sm"}),d&&a.jsx(Ne,{message:d}),!u&&!d&&s.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(A=>a.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${(l==null?void 0:l.id)===A.id?"border-green-500 bg-green-50 ring-2 ring-green-300":"border-gray-200 hover:border-green-300 hover:bg-green-50"}`,onClick:()=>_(A),children:[a.jsx("h5",{className:"font-semibold text-lg mb-2",children:A.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.description}),a.jsxs("p",{className:"text-sm text-blue-600",children:["Willpower Cost: ",A.willpower_cost??"N/A"," WP"]}),A.requirement&&typeof A.requirement=="string"&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requirement: ",A.requirement]})]},A.id))}):!u&&!d&&a.jsx("p",{className:"text-gray-600",children:"No specific heroic abilities listed for this profession, or none available."})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg sticky bottom-0",children:[a.jsxs("p",{className:"text-blue-800 font-medium",children:["Selected: ",a.jsx("strong",{children:r.name}),r.magic_school_id!==null&&a.jsxs(a.Fragment,{children:[" (Magic School: ",a.jsx("strong",{children:k(r.magic_school_id)??"N/A"}),")"]}),r.magic_school_id===null&&e.professionHeroicAbilityName&&a.jsxs(a.Fragment,{children:[" with Heroic Ability: ",a.jsx("strong",{children:e.professionHeroicAbilityName})]})]}),r.magic_school_id===null&&!e.professionHeroicAbilityName&&s.length>0&&!u&&a.jsx("p",{className:"text-amber-700 mt-2 text-sm",children:"Please select a heroic ability above to continue."}),r.magic_school_id===null&&s.length===0&&!u&&!d&&a.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"No heroic ability selection required for this profession."})]})]}):a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500 text-lg",children:"Select a profession from the list to view details."})})})]}))}const Wc={Young:{attributes:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},skillPoints:8},Adult:{attributes:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},skillPoints:10},Old:{attributes:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0},skillPoints:12}};function $6(){const{character:e,updateCharacter:t}=es(),r=n=>n===0?"No change":n>0?`+${n}`:n;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Details"}),a.jsx("p",{className:"text-gray-600",children:"Choose a name that fits your character's background and select their age category. Age affects your starting attributes and the number of skill points available during character creation."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Character Name"}),a.jsxs("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Si,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:e.name||"",onChange:n=>t({name:n.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter character name"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Age Category"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Young","Adult","Old"].map(n=>a.jsxs("div",{className:`relative rounded-lg border p-6 cursor-pointer transition-all ${e.age===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>t({age:n}),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(wg,{className:`h-5 w-5 ${e.age===n?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium",children:n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Attribute Modifiers"}),a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:Object.entries(Wc[n].attributes).map(([s,i])=>i!==0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-gray-600",children:[s,":"]}),a.jsx("span",{className:i>0?"text-green-600":"text-red-600",children:r(i)})]},s))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Skill Points"}),a.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[Wc[n].skillPoints," points"]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[n==="Young"&&"Quick to learn, physically developing",n==="Adult"&&"Balanced attributes and experience",n==="Old"&&"Wise and knowledgeable, physically declining"]})]})]},n))})]})]}),(e.name||e.age)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[e.name&&a.jsxs("p",{className:"text-green-800",children:["Name: ",a.jsx("strong",{children:e.name})]}),e.age&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-green-800",children:["Age Category: ",a.jsx("strong",{children:e.age})]}),a.jsxs("p",{className:"text-sm text-green-700",children:["Starting Skill Points: ",a.jsx("strong",{children:Wc[e.age].skillPoints})]}),Object.entries(Wc[e.age].attributes).filter(([n,s])=>s!==0).map(([n,s])=>a.jsxs("p",{className:"text-sm text-green-700",children:[n," Modifier: ",a.jsx("strong",{children:r(s)})]},n))]})]})})]})}const Gf=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,Yf=e=>e<=12?"None":e<=15?"+D4":"+D6",Mi=()=>{const e=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return e.sort((t,r)=>r-t),e.slice(0,3).reduce((t,r)=>t+r,0)},z6=()=>({STR:Mi(),CON:Mi(),AGL:Mi(),INT:Mi(),WIL:Mi(),CHA:Mi()}),q6={Young:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},Adult:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},Old:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0}};function V6(){var f,p,g,y,v,x;const{character:e,updateCharacter:t}=es(),[r,n]=E.useState({STR:{value:((f=e.attributes)==null?void 0:f.STR)||0,baseChance:0},CON:{value:((p=e.attributes)==null?void 0:p.CON)||0,baseChance:0},AGL:{value:((g=e.attributes)==null?void 0:g.AGL)||0,baseChance:0},INT:{value:((y=e.attributes)==null?void 0:y.INT)||0,baseChance:0},WIL:{value:((v=e.attributes)==null?void 0:v.WIL)||0,baseChance:0},CHA:{value:((x=e.attributes)==null?void 0:x.CHA)||0,baseChance:0}}),[s,i]=E.useState(!1),l=b=>e.age?q6[e.age][b]:0,o=(b,w)=>{const _=l(b);return w+_},u=()=>{i(!0);const b=z6(),w=Object.entries(b).reduce((k,[S,A])=>({...k,[S]:o(S,A)}),{}),_=Object.entries(b).reduce((k,[S,A])=>({...k,[S]:{value:A,baseChance:Gf(o(S,A))}}),{});n(_),t({attributes:w,current_hp:w.CON,current_wp:w.WIL,magic_school:e.magicSchool??null}),i(!1)},c=(b,w)=>{const _=Math.max(3,Math.min(18,parseInt(w)||0)),k=o(b,_),S={...r,[b]:{value:_,baseChance:Gf(k)}};n(S);const A=Object.entries(S).reduce((R,[L,{value:T}])=>({...R,[L]:o(L,T)}),{});t({attributes:A,current_hp:A.CON,current_wp:A.WIL,magic_school:e.magicSchool??null})},d=()=>{if(!e.kin||!r.AGL.value)return 0;const b={Human:10,Halfling:8,Dwarf:8,Elf:10,Mallard:8,Wolfkin:12}[e.kin],w=o("AGL",r.AGL.value);let _=0;return w<=6?_=-4:w<=9?_=-2:w<=12?_=0:w<=15?_=2:_=4,b+_},h=e.key_attribute;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Assign Attributes"}),a.jsxs("p",{className:"text-gray-600",children:["Roll or manually enter your character's attributes. Each attribute is determined by rolling 4D6 and removing the lowest die, giving you a score between 3 and 18. ",e.age&&"Age modifiers will be automatically applied."]}),e.profession&&a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-blue-800",children:["Selected Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&a.jsxs(a.Fragment,{children:[" (Key Attribute: ",a.jsx("strong",{children:e.key_attribute}),")"]})]})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?a.jsx(CE,{className:"w-5 h-5 animate-spin"}):a.jsx(ur,{className:"w-5 h-5"}),"Roll All Attributes"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([b,{value:w,baseChance:_}])=>{const k=l(b),S=o(b,w),A=h===b;return a.jsxs("div",{className:`p-4 border rounded-lg shadow-sm bg-white ${A?"bg-yellow-100 border-yellow-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-lg font-medium",children:b}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Base Chance: ",Gf(S)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",min:"3",max:"18",value:w||"",onChange:R=>c(b,R.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),k!==0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Age Modifier:"}),a.jsx("span",{className:k>0?"text-green-600":"text-red-600",children:k>0?`+${k}`:k})]}),w>0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Final Value:"}),a.jsx("span",{className:"font-medium text-blue-600",children:S})]})]}),(b==="STR"||b==="AGL")&&S>12&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Damage Bonus: ",Yf(S)]})]},b)})}),e.kin&&Object.values(r).every(b=>b.value>0)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"Movement"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d()})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"STR Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:Yf(o("STR",r.STR.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"AGL Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:Yf(o("AGL",r.AGL.value))})]})]})}),e.age&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Age Modifiers Applied"}),a.jsxs("p",{className:"text-sm text-amber-700",children:[e.age==="Young"&&"Young: +1 CON, +1 AGL",e.age==="Adult"&&"Adult: No attribute modifiers",e.age==="Old"&&"Old: -2 STR, -2 CON, -2 AGL, +1 INT, +1 WIL"]})]})]})]})}function W6(e){const[t,r]=E.useState([]),[n,s]=E.useState([]),[i,l]=E.useState(!0),[o,u]=E.useState(null);return E.useEffect(()=>{async function c(){try{l(!0),u(null);const{data:d,error:h}=await re.from("game_spells").select("*").eq("rank",0).order("name");if(h)throw h;r(d||[]);let f=re.from("game_spells").select(`
            *,
            magic_schools ( name )
          `).eq("rank",1).order("name");e?f=f.or(`school_id.is.null,school_id.eq.${e}`):f=f.is("school_id",null);const{data:p,error:g}=await f;if(g)throw g;s(p||[])}catch(d){console.error("Error loading spells:",d),u(d instanceof Error?d.message:"Failed to load spells")}finally{l(!1)}}c()},[e]),{tricks:t,spells:n,loading:i,error:o}}const Qf={"6d2d7686-da89-4c42-a763-6b143c1dac60":"Elementalist","b500058b-543f-4c44-a097-911102245236":"Mentalist","e7836c1c-517a-41f8-bd71-92ba20d9c9e1":"Animist"};function G6(){var b;const{character:e,updateCharacter:t}=es(),[r,n]=E.useState([]),[s,i]=E.useState([]),[l,o]=E.useState("all"),[u,c]=E.useState(1),d=(b=e.profession)==null?void 0:b.includes("Mage"),h=d&&e.magicSchool?e.magicSchool:null;if(!d)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Only mages can learn and cast spells. Continue to the next step."})});if(h===null)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please go back to the Profession step and select a magic school before choosing spells."})]})]})});const{tricks:f,spells:p,loading:g}=W6(h),y=(w,_)=>{_==="trick"?r.includes(w)?n(r.filter(k=>k!==w)):r.length<3&&n([...r,w]):s.includes(w)?i(s.filter(k=>k!==w)):s.length<3&&i([...s,w])},v=p.filter(w=>l==="general"?w.school_id===null:l==="school"?w.school_id===h:w.rank===u);if(g)return a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(_4,{className:"w-8 h-8 animate-spin text-blue-600"})});const x=()=>{t({spells:{general:[...r,...s.filter(w=>{var _;return((_=p.find(k=>k.name===w))==null?void 0:_.school_id)===null})],school:{name:Qf[h]||"Unknown",spells:s.filter(w=>{var _;return((_=p.find(k=>k.name===w))==null?void 0:_.school_id)===h})}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Magic"}),a.jsxs("p",{className:"text-gray-600",children:["As a newly created mage, you may choose three rank 1 spells and three magic tricks. You can select spells from both General Magic and your chosen school of magic (",Qf[h]||"General",")."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Your Magic School"}),a.jsx("p",{className:"text-sm text-blue-700",children:Qf[h]||"General Magic"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Magic Tricks"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",r.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(w=>{var _;return a.jsxs("div",{onClick:()=>y(w.name,"trick"),className:`p-4 border rounded-lg cursor-pointer transition-all ${r.includes(w.name)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(hl,{className:`w-5 h-5 ${r.includes(w.name)?"text-purple-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:w.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=w.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:w.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",w.casting_time]}),a.jsxs("p",{children:["Duration: ",w.duration]}),w.requirement&&a.jsxs("p",{children:["Requirement: ",w.requirement]})]})]},w.name)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Rank 1 Spells"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("select",{value:u,onChange:w=>c(parseInt(w.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[...Array(10)].map((w,_)=>a.jsxs("option",{value:_+1,children:["Rank ",_+1]},_+1))}),a.jsx(Ra,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:l,onChange:w=>o(w.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Spells"}),a.jsx("option",{value:"general",children:"General Magic"}),a.jsx("option",{value:"school",children:"School Spells"})]})]})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",s.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(w=>{var _;return a.jsxs("div",{onClick:()=>y(w.name,"spell"),className:`p-4 border rounded-lg cursor-pointer transition-all ${s.includes(w.name)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(hl,{className:`w-5 h-5 ${s.includes(w.name)?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:w.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((_=w.magic_schools)==null?void 0:_.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:w.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",w.range]}),a.jsxs("p",{children:["Duration: ",w.duration]}),w.requirement!=="None"&&a.jsxs("p",{children:["Requirement: ",w.requirement]})]})]},w.name)})})]}),(r.length<3||s.length<3)&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select 3 magic tricks and 3 rank 1 spells to continue."})]})]}),a.jsxs("button",{onClick:x,disabled:r.length<3||s.length<3,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(hl,{className:"w-5 h-5"}),"Save Spell Selections"]})]})}function WE(){const[e,t]=E.useState([]),[r,n]=E.useState(!0),[s,i]=E.useState(null);return E.useEffect(()=>{async function l(){n(!0),i(null),console.log("useSkills: Fetching skills...");try{const{data:o,error:u}=await re.from("game_skills").select("*").order("name");if(u)throw console.error("useSkills: Supabase error fetching skills:",u),new Error(u.message||"Failed to fetch skills from database");if(console.log("useSkills: Raw data received from Supabase:",o),Array.isArray(o)){let d=!1;o.forEach((h,f)=>{if(h&&typeof h=="object"){const p=Object.keys(h);p.length>0&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(p[0])&&(!("id"in h)||!("name"in h))&&(console.warn(`useSkills: Potential problematic object structure found at index ${f}:`,h),d=!0),(typeof h.id!="string"||typeof h.name!="string")&&console.warn(`useSkills: Item at index ${f} missing 'id' or 'name', or they have wrong types:`,h)}else console.warn(`useSkills: Invalid non-object item found in fetched data at index ${f}:`,h),d=!0}),d||console.log("useSkills: Initial check of fetched data structure passed.")}else console.warn("useSkills: Fetched data is not an array:",o);const c=Array.isArray(o)?o:[];t(c),console.log(`useSkills: Successfully processed and set ${c.length} skills.`)}catch(o){console.error("useSkills: Error during fetch or processing:",o);const u=o instanceof Error?o.message:"An unknown error occurred while fetching skills";i(u),t([])}finally{n(!1),console.log("useSkills: Fetch finished.")}}l()},[]),{skills:e,loading:r,error:s}}const Gc=e=>{switch(e){case"Young":return 2;case"Adult":return 4;case"Old":return 6;default:return 0}},Y6={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},lb=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],Kf=["Animism","Elementalism","Mentalism"];function Q6(){const{character:e,updateCharacter:t}=es(),{skills:r,loading:n,error:s}=WE(),[i,l]=E.useState([]),[o,u]=E.useState([]),[c,d]=E.useState("profession"),[h,f]=E.useState("all"),[p,g]=E.useState([]),[y,v]=E.useState(!1),[x,b]=E.useState(null),[w,_]=E.useState([]),[k,S]=E.useState(!1),A=E.useMemo(()=>{var V;return(V=e.profession)==null?void 0:V.toLowerCase().includes("mage")},[e.profession]);E.useEffect(()=>{A&&(S(!0),re.from("magic_schools").select("id, name").then(({data:V,error:H})=>{if(H)throw H;_(V||[])}).catch(V=>console.error("Failed to fetch magic schools:",V)).finally(()=>S(!1)))},[A]);const R=E.useMemo(()=>{const V=e.magicSchool;if(typeof V=="object"&&V!==null&&"name"in V&&typeof V.name=="string")return V.name;if(typeof V=="string"&&w.length>0){const H=w.find(j=>j.id===V);return H?H.name:null}return null},[e.magicSchool,w]);E.useEffect(()=>{async function V(){if(e.profession){v(!0),b(null);try{const{data:H,error:j}=await re.from("professions").select("skills").eq("name",e.profession).single();if(j)throw j;g(Array.isArray(H==null?void 0:H.skills)?H.skills.filter(he=>typeof he=="string"):[])}catch(H){b(H instanceof Error?H.message:"Failed to load profession skills.")}finally{v(!1)}}}V()},[e.profession]);const L=E.useMemo(()=>n||y||!Array.isArray(r)?[]:r.filter(V=>V&&p.includes(V.name)),[r,n,y,p]),T=E.useMemo(()=>{if(n||!Array.isArray(r))return[];const V=r.filter(H=>H&&!i.includes(H.name));return A&&R?V.filter(H=>!Kf.includes(H.name)||H.name===R):V.filter(H=>!Kf.includes(H.name))},[r,n,i,A,R]),z=E.useMemo(()=>{const V=H=>Kf.includes(H);switch(h){case"combat":return T.filter(H=>lb.includes(H.name));case"general":return T.filter(H=>!lb.includes(H.name)&&!V(H.name));case"magic":return T.filter(H=>V(H.name));default:return T}},[T,h]),O=(V,H)=>{const j=H==="profession"?6:Gc(e.age||"");(H==="profession"?l:u)(J=>J.includes(V)?J.filter(q=>q!==V):J.length<j?[...J,V]:J)},Y=()=>{c==="profession"&&i.length===6?d("additional"):c==="additional"&&o.length===Gc(e.age||"")&&t({trainedSkills:[...new Set([...i,...o])]})},G=(V,H)=>{if(!(V!=null&&V.id)||!V.name)return null;const j=Y6[V.name]||"N/A",he=H==="profession"?i.includes(V.name):o.includes(V.name),q=(H==="profession"?i.length>=6:o.length>=Gc(e.age||""))&&!he;return a.jsxs("div",{onClick:()=>!q&&O(V.name,H),className:`p-4 border rounded-lg transition-all ${q?"bg-gray-100 opacity-60 cursor-not-allowed":"cursor-pointer"} ${he?"border-blue-500 bg-blue-50 ring-1 ring-blue-500":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Su,{className:`w-5 h-5 flex-shrink-0 ${he?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h5",{className:"font-medium",children:V.name}),a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:j})]})]}),V.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.description})]},V.id)};if(n||k)return a.jsx(He,{size:"lg",className:"my-8"});if(s)return a.jsx(Ne,{message:`Skills Error: ${s}`});if(!e.profession||!e.age)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession and age first."})});if(A&&!R)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"As a Mage, please select a magic school first."})]})]})});const B=i.length,W=o.length,K=6,P=Gc(e.age),X=B===K,N=W===P;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Select Skills"}),e.profession&&a.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-sm",children:[a.jsxs("p",{className:"text-indigo-800",children:["Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&` (Key Attribute: ${e.key_attribute})`,A&&R&&` (School: ${R})`]}),a.jsxs("p",{className:"text-indigo-700 mt-1",children:["Age: ",a.jsx("strong",{children:e.age})," (Grants ",P," additional skill points)"]})]}),a.jsx("p",{className:"text-gray-600 text-sm",children:c==="profession"?`Choose ${K} skills from your profession's list below.`:`Choose ${P} additional skills based on your age (${e.age}).`})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Selection Progress"}),a.jsx("p",{className:"text-sm text-blue-700",children:c==="profession"?`Professional Skills: ${B}/${K}`:`Additional Skills: ${W}/${P}`})]})]}),c==="additional"&&a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx(Ra,{className:"w-4 h-4 text-gray-500"}),a.jsx("label",{htmlFor:"skillFilter",className:"text-sm font-medium text-gray-700",children:"Filter:"}),a.jsxs("select",{id:"skillFilter",value:h,onChange:V=>f(V.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Available"}),a.jsx("option",{value:"combat",children:"Combat"}),a.jsx("option",{value:"general",children:"General"}),A&&a.jsx("option",{value:"magic",children:"Magic"})]})]}),c==="profession"&&y&&a.jsx(He,{size:"md",className:"my-4"}),c==="profession"&&x&&a.jsx(Ne,{message:`Profession Skills Error: ${x}`}),!y&&!x&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c==="profession"&&L.map(V=>G(V,"profession")),c==="additional"&&z.map(V=>G(V,"additional")),c==="profession"&&L.length===0&&!y&&!x&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No specific skills found for this profession."}),c==="additional"&&z.length===0&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No skills match the current filter."})]}),(c==="profession"&&!X&&B>0||c==="additional"&&!N&&W>0)&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:c==="profession"?`Please select ${K-B} more skill(s).`:`Please select ${P-W} more skill(s).`})]})]}),a.jsxs("button",{onClick:Y,disabled:c==="profession"&&!X||c==="additional"&&!N||y,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[y?a.jsx(Yn,{className:"w-5 h-5 animate-spin"}):a.jsx(Su,{className:"w-5 h-5"}),c==="profession"?"Continue to Additional Skills":"Confirm Skill Selections"]})]})}function GE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=GE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function YE(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=GE(e))&&(n&&(n+=" "),n+=t);return n}const ob=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,ub=YE,K6=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return ub(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(c=>{const d=r==null?void 0:r[c],h=i==null?void 0:i[c];if(d===null)return null;const f=ob(d)||ob(h);return s[c][f]}),o=r&&Object.entries(r).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(g=>{let[y,v]=g;return Array.isArray(v)?v.includes({...i,...o}[y]):{...i,...o}[y]===v})?[...c,h,f]:c},[]);return ub(e,l,u,r==null?void 0:r.class,r==null?void 0:r.className)},Tg="-",Z6=e=>{const t=J6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(Tg);return o[0]===""&&o.length!==1&&o.shift(),QE(o,t)||X6(l)},getConflictingClassGroupIds:(l,o)=>{const u=r[l]||[];return o&&n[l]?[...u,...n[l]]:u}}},QE=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?QE(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(Tg);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},cb=/^\[(.+)\]$/,X6=e=>{if(cb.test(e)){const t=cb.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},J6=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return t5(Object.entries(e.classGroups),r).forEach(([i,l])=>{qp(l,n,i,t)}),n},qp=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:db(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(e5(s)){qp(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{qp(l,db(t,i),r,n)})})},db=(e,t)=>{let r=e;return t.split(Tg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},e5=e=>e.isThemeGetter,t5=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,r5=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},KE="!",n5=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const u=[];let c=0,d=0,h;for(let v=0;v<o.length;v++){let x=o[v];if(c===0){if(x===s&&(n||o.slice(v,v+i)===t)){u.push(o.slice(d,v)),d=v+i;continue}if(x==="/"){h=v;continue}}x==="["?c++:x==="]"&&c--}const f=u.length===0?o:o.substring(d),p=f.startsWith(KE),g=p?f.substring(1):f,y=h&&h>d?h-d:void 0;return{modifiers:u,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}};return r?o=>r({className:o,parseClassName:l}):l},s5=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},a5=e=>({cache:r5(e.cacheSize),parseClassName:n5(e),...Z6(e)}),i5=/\s+/,l5=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(i5);let o="";for(let u=l.length-1;u>=0;u-=1){const c=l[u],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(c);let g=!!p,y=n(g?f.substring(0,p):f);if(!y){if(!g){o=c+(o.length>0?" "+o:o);continue}if(y=n(f),!y){o=c+(o.length>0?" "+o:o);continue}g=!1}const v=s5(d).join(":"),x=h?v+KE:v,b=x+y;if(i.includes(b))continue;i.push(b);const w=s(y,g);for(let _=0;_<w.length;++_){const k=w[_];i.push(x+k)}o=c+(o.length>0?" "+o:o)}return o};function o5(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=ZE(t))&&(n&&(n+=" "),n+=r);return n}const ZE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=ZE(e[n]))&&(r&&(r+=" "),r+=t);return r};function u5(e,...t){let r,n,s,i=l;function l(u){const c=t.reduce((d,h)=>h(d),e());return r=a5(c),n=r.cache.get,s=r.cache.set,i=o,o(u)}function o(u){const c=n(u);if(c)return c;const d=l5(u,r);return s(u,d),d}return function(){return i(o5.apply(null,arguments))}}const xt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},XE=/^\[(?:([a-z-]+):)?(.+)\]$/i,c5=/^\d+\/\d+$/,d5=new Set(["px","full","screen"]),h5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,f5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,m5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,p5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,g5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ls=e=>ml(e)||d5.has(e)||c5.test(e),Os=e=>eo(e,"length",k5),ml=e=>!!e&&!Number.isNaN(Number(e)),Zf=e=>eo(e,"number",ml),xo=e=>!!e&&Number.isInteger(Number(e)),x5=e=>e.endsWith("%")&&ml(e.slice(0,-1)),De=e=>XE.test(e),Ps=e=>h5.test(e),y5=new Set(["length","size","percentage"]),b5=e=>eo(e,y5,JE),v5=e=>eo(e,"position",JE),w5=new Set(["image","url"]),E5=e=>eo(e,w5,S5),N5=e=>eo(e,"",_5),yo=()=>!0,eo=(e,t,r)=>{const n=XE.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},k5=e=>f5.test(e)&&!m5.test(e),JE=()=>!1,_5=e=>p5.test(e),S5=e=>g5.test(e),T5=()=>{const e=xt("colors"),t=xt("spacing"),r=xt("blur"),n=xt("brightness"),s=xt("borderColor"),i=xt("borderRadius"),l=xt("borderSpacing"),o=xt("borderWidth"),u=xt("contrast"),c=xt("grayscale"),d=xt("hueRotate"),h=xt("invert"),f=xt("gap"),p=xt("gradientColorStops"),g=xt("gradientColorStopPositions"),y=xt("inset"),v=xt("margin"),x=xt("opacity"),b=xt("padding"),w=xt("saturate"),_=xt("scale"),k=xt("sepia"),S=xt("skew"),A=xt("space"),R=xt("translate"),L=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",De,t],O=()=>[De,t],Y=()=>["",ls,Os],G=()=>["auto",ml,De],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],W=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],P=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",De],N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[ml,De];return{cacheSize:500,separator:":",theme:{colors:[yo],spacing:[ls,Os],blur:["none","",Ps,De],brightness:V(),borderColor:[e],borderRadius:["none","","full",Ps,De],borderSpacing:O(),borderWidth:Y(),contrast:V(),grayscale:X(),hueRotate:V(),invert:X(),gap:O(),gradientColorStops:[e],gradientColorStopPositions:[x5,Os],inset:z(),margin:z(),opacity:V(),padding:O(),saturate:V(),scale:V(),sepia:X(),skew:V(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",De]}],container:["container"],columns:[{columns:[Ps]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),De]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",xo,De]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",De]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",xo,De]}],"grid-cols":[{"grid-cols":[yo]}],"col-start-end":[{col:["auto",{span:["full",xo,De]},De]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[yo]}],"row-start-end":[{row:["auto",{span:[xo,De]},De]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",De]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",De]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...P()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...P(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...P(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",De,t]}],"min-w":[{"min-w":[De,t,"min","max","fit"]}],"max-w":[{"max-w":[De,t,"none","full","min","max","fit","prose",{screen:[Ps]},Ps]}],h:[{h:[De,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[De,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[De,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[De,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ps,Os]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Zf]}],"font-family":[{font:[yo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",De]}],"line-clamp":[{"line-clamp":["none",ml,Zf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ls,De]}],"list-image":[{"list-image":["none",De]}],"list-style-type":[{list:["none","disc","decimal",De]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...W(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ls,Os]}],"underline-offset":[{"underline-offset":["auto",ls,De]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",De]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",De]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),v5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",b5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},E5]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...W(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:W()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...W()]}],"outline-offset":[{"outline-offset":[ls,De]}],"outline-w":[{outline:[ls,Os]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[ls,Os]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ps,N5]}],"shadow-color":[{shadow:[yo]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Ps,De]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",De]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",De]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",De]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[xo,De]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",De]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",De]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",De]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ls,Os,Zf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},C5=u5(T5);function j5(...e){return C5(YE(e))}const A5=K6("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",danger:"bg-red-600 text-white hover:bg-red-700",danger_outline:"border border-red-500 text-red-600 hover:bg-red-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"primary",size:"default"}}),U=Tn.forwardRef(({className:e,variant:t,size:r,icon:n,iconPosition:s="left",fullWidth:i,loading:l,children:o,...u},c)=>{const d=l||u.disabled;return a.jsxs("button",{className:j5(A5({variant:t,size:r,className:e}),i&&"w-full",l&&"relative"),ref:c,disabled:d,...u,children:[l&&a.jsx(Yn,{className:`animate-spin h-4 w-4 ${o?s==="left"?"mr-2":"ml-2":""}`}),!l&&n&&s==="left"&&a.jsx(n,{className:`h-4 w-4 ${o?"mr-2":""}`}),!l&&o,!l&&n&&s==="right"&&a.jsx(n,{className:`h-4 w-4 ${o?"ml-2":""}`})]})});U.displayName="Button";async function uc(e){let t=re.from("game_items").select("*");e&&e!=="all"&&typeof e=="string"&&(t=t.eq("category",e.toUpperCase()));const{data:r,error:n}=await t.order("category").order("name");if(n)throw console.error("Error fetching game items:",n),new Error(n.message||"Failed to fetch game items");return r||[]}function I5(e){const t={gold:0,silver:0,copper:0};if(!e||typeof e!="string")return t;const r=e.toLowerCase().split(/,\s*|\s+/);for(let n=0;n<r.length;n++){const s=parseInt(r[n]);if(!isNaN(s)&&n+1<r.length){const i=r[n+1];i.startsWith("gold")||i.startsWith("g")?(t.gold=s,n++):i.startsWith("silver")||i.startsWith("s")?(t.silver=s,n++):(i.startsWith("copper")||i.startsWith("c"))&&(t.copper=s,n++)}}return Cg(t)}function R5(e){if(!e)return"0 copper";const t=[];return e.gold>0&&t.push(`${e.gold} gold`),e.silver>0&&t.push(`${e.silver} silver`),e.copper>0&&t.push(`${e.copper} copper`),t.length>0?t.join(", "):"0 copper"}function Cg(e){let{gold:t,silver:r,copper:n}=e;return r+=Math.floor(n/100),n%=100,t+=Math.floor(r/100),r%=100,{gold:t,silver:r,copper:n}}function L5(e,t){const r=e.gold*1e4+e.silver*100+e.copper,n=t.gold*1e4+t.silver*100+t.copper;if(r<n)return{success:!1,newMoney:e};let s=r-n;const i=Math.floor(s/1e4);s%=1e4;const l=Math.floor(s/100);return s%=100,{success:!0,newMoney:{gold:i,silver:l,copper:s}}}function O5(){var T,z;const{character:e,updateCharacter:t}=es(),[r,n]=E.useState(null),[s,i]=E.useState([]),[l,o]=E.useState(!1),[u,c]=E.useState(!1),[d,h]=E.useState({}),[f,p]=E.useState(!0),[g,y]=E.useState(""),{data:v=[],isLoading:x,error:b}=It({queryKey:["gameItems"],queryFn:uc,staleTime:1e3*60*10});E.useEffect(()=>{async function O(){if(!e.profession){y("Profession not selected."),p(!1);return}try{p(!0),y("");const{data:Y,error:G}=await re.from("professions").select("starting_equipment, equipment_description").eq("name",e.profession).single();if(G)throw G;if(Y){const B=Y,W=(B.starting_equipment||[]).map((K,P)=>({option:P+1,items:K.split(",").map(X=>X.trim()).filter(Boolean),description:(B.equipment_description||[])[P]||""}));i(W)}}catch{y("Failed to load equipment options.")}finally{p(!1)}}O()},[e.profession]);const w=O=>{const G=O.split(" or ")[0].trim().replace(/^\d+\s+/,"");return v.find(B=>B.name.toLowerCase()===G.toLowerCase())},_=O=>{const Y=O.match(/^(\d*D\d+)/i);if(!Y)return null;const G=Y[1],B=G.toUpperCase().split("D"),W=B[0]===""?1:parseInt(B[0]),K=parseInt(B[1]),P=O.slice(G.length).trim();return{count:W,sides:K,rest:P}},k=(O,Y)=>{let G=0;for(let B=0;B<O;B++)G+=Math.floor(Math.random()*Y)+1;return G},S=O=>{n(O),o(!1)},A=()=>{var G,B;if(r===null)return;const O=s.find(W=>W.option===r);if(!O)return;if(O.items.some(W=>_(W)||W.toLowerCase().includes(" or "))){const W=O.items.reduce((K,P,X)=>(P.toLowerCase().includes(" or ")?K[X]=P.split(/\s+or\s+/i)[0].trim():K[X]="",K),{});h(W),c(!0)}else t({startingEquipment:{option:r,items:O.items},equipment:{money:((G=e.equipment)==null?void 0:G.money)||{gold:0,silver:0,copper:0},equipped:((B=e.equipment)==null?void 0:B.equipped)||{weapons:[]},inventory:[...O.items]}}),o(!0)},R=()=>{var W,K;if(r===null)return;const O=s.find(P=>P.option===r);if(!O)return;const G={...((W=e.equipment)==null?void 0:W.money)||{gold:0,silver:0,copper:0}},B=[];O.items.forEach((P,X)=>{if(P.toLowerCase().includes(" or "))B.push(d[X]||P.split(/\s+or\s+/i)[0].trim());else{const N=_(P);if(N){const V=d[X]?parseInt(d[X]):k(N.count,N.sides),H=N.rest.toLowerCase();H.includes("gold")?G.gold+=V:H.includes("silver")?G.silver+=V:H.includes("copper")?G.copper+=V:B.push(`${V} ${N.rest}`)}else B.push(P)}}),t({startingEquipment:{option:r,items:B},equipment:{money:Cg(G),equipped:((K=e.equipment)==null?void 0:K.equipped)||{weapons:[]},inventory:[...B]}}),c(!1),o(!0)},L=r!==null&&((T=s.find(O=>O.option===r))==null?void 0:T.items.every((O,Y)=>O.toLowerCase().includes(" or ")||_(O)?!!d[Y]:!0));return f||x?a.jsx(He,{}):g||b?a.jsx(Ne,{message:g||(b==null?void 0:b.message)||"Failed to load data."}):e.profession?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Starting Equipment"}),a.jsxs("p",{className:"text-gray-600",children:["Select one of the equipment packages for your ",e.profession,"."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Equipment Selection"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Items with ",a.jsx(Qy,{className:"inline w-4 h-4 text-amber-600"})," require a roll, items with ",a.jsx(Xy,{className:"inline w-4 h-4 text-purple-600"})," offer a choice."]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(O=>a.jsxs("div",{onClick:()=>S(O.option),className:`p-6 border rounded-lg cursor-pointer transition-all ${r===O.option?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Tu,{className:"w-6 h-6 text-gray-500"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold",children:["Option ",O.option]}),a.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Equipment List:"}),a.jsx("ul",{className:"space-y-1.5",children:O.items.map((Y,G)=>{const B=!!_(Y),W=Y.toLowerCase().includes(" or "),K=w(Y);return a.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-600",children:[B?a.jsx(Qy,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):W?a.jsx(Xy,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):a.jsx(Su,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a.jsx("span",{children:Y}),(K==null?void 0:K.effect)&&a.jsxs("span",{className:"relative group flex items-center",children:[a.jsx(Pn,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-xs bg-gray-800 text-white text-xs p-2 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-20 pointer-events-none",children:[a.jsx("p",{className:"font-bold",children:K.name}),a.jsx("p",{children:K.effect}),a.jsxs("p",{className:"mt-1 text-gray-300",children:["Weight: ",K.weight,", Cost: ",K.cost]})]})]})]},G)})})]}),r===O.option&&a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[a.jsx(Su,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Selected"})]})]},O.option))}),!r&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Equipment Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select a starting equipment package."})]})]}),a.jsxs("button",{onClick:A,disabled:!r||l,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${l?"bg-green-600 text-white cursor-default":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[a.jsx(vE,{className:"w-5 h-5"}),l?"Equipment Confirmed":"Confirm Equipment Selection"]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Resolve Dice Rolls & Selections"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-5 h-5"})})]}),(((z=s.find(O=>O.option===r))==null?void 0:z.items)||[]).map((O,Y)=>{if(O.toLowerCase().includes(" or ")){const B=O.split(/\s+or\s+/i).map(W=>W.trim());return a.jsxs("div",{className:"mb-4 p-3 border rounded bg-purple-50 border-purple-200",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:O}),a.jsxs("select",{value:d[Y]||"",onChange:W=>h(K=>({...K,[Y]:W.target.value})),className:"mt-1 w-full border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select one..."}),B.map((W,K)=>a.jsx("option",{value:W,children:W},K))]})]},Y)}const G=_(O);return G?a.jsxs("div",{className:"mb-4 p-3 border rounded bg-amber-50 border-amber-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium",children:O}),a.jsxs(U,{size:"sm",variant:"secondary",onClick:()=>{const B=k(G.count,G.sides);h(W=>({...W,[Y]:B.toString()}))},children:["Roll ",G.count,"D",G.sides]})]}),a.jsx("input",{type:"number",min:G.count,max:G.count*G.sides,value:d[Y]||"",onChange:B=>{const W=B.target.value;if(W==="")h(K=>({...K,[Y]:""}));else{const K=parseInt(W);if(!isNaN(K)){const P=Math.max(G.count,Math.min(G.count*G.sides,K));h(X=>({...X,[Y]:P.toString()}))}}},className:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:`Enter result (${G.count}-${G.count*G.sides})`})]},Y):null}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(U,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:R,disabled:!L,children:"Confirm Rolls/Choices"})]})]})})]}):a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession first."})})}async function P5(){const{data:e,error:t}=await re.from("compendium").select("*").order("category").order("title");if(t)throw console.error("Error fetching compendium entries:",t),new Error(t.message||"Failed to load compendium entries");return e||[]}async function D5(){const{data:e,error:t}=await re.from("compendium_templates").select("*").order("category").order("name");if(t)throw console.error("Error fetching compendium templates:",t),new Error(t.message||"Failed to load compendium templates");return e||[]}async function M5(){const{data:e,error:t}=await re.from("bio_data").select("appearance, mementos, flaws");if(t)throw console.error("Error fetching bio data:",t),new Error(t.message||"Failed to load bio data");const r=new Set,n=new Set,s=new Set;return(e||[]).forEach(i=>{(i.appearance||[]).forEach(l=>r.add(l)),(i.mementos||[]).forEach(l=>n.add(l)),(i.flaws||[]).forEach(l=>s.add(l))}),{appearance:Array.from(r).sort(),mementos:Array.from(n).sort(),flaws:Array.from(s).sort()}}const hb=["Diminutive","Short","Below Average","Average","Above Average","Tall","Towering"],fb=["Gaunt","Slight","Lean","Wiry","Average","Athletic","Muscular","Stocky","Heavy"],mb=["Raven Black","Chestnut Brown","Sandy Blonde","Fiery Red","Ash Gray","Snow White","Auburn"],pb=["Slicked Back","Short & Spiky","Long & Flowing","Ornate Braids","Messy Bun","Curly Mop","Shaved Sides","Tonsure","Bald"],gb=["Chocolate Brown","Sky Blue","Emerald Green","Stormy Gray","Warm Hazel","Amber"],xb=["Pale","Fair","Light","Olive","Ruddy","Tan","Dark","Ebony"],yb=["Deep Blue","Crimson","Silver","Violet","Pastel Pink"],bb=["Lilac","Gold","Silver","Blood Red","All White (No Pupil)"],vb=["Simple traveler's clothes","Ragged commoner's garb","Well-made leather armor","Sturdy chainmail hauberk","Flamboyant noble's attire","Scholar's robes and spectacles","Mysterious hooded cloak","Practical hunter's leathers","Grim ritual vestments","Colorful entertainer's outfit","Tailored city guard uniform","Patched and worn adventurer's gear"],Yc=({label:e,placeholder:t,options:r,value:n,onChange:s,mode:i,onModeChange:l,onRandomize:o,isLoading:u=!1,rows:c=3})=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),a.jsxs("button",{onClick:()=>l(i==="manual"?"select":"manual"),className:"flex items-center gap-1 text-xs text-gray-600 hover:text-blue-600",title:`Switch to ${i==="manual"?"selection":"manual"} mode`,children:[i==="manual"?a.jsx(q4,{className:"w-4 h-4"}):a.jsx(V4,{className:"w-4 h-4"}),a.jsx("span",{children:i==="manual"?"Manual":"Select"})]})]}),i==="manual"?a.jsx("textarea",{value:n,onChange:d=>s(d.target.value),placeholder:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:c}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("select",{value:n,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:u||r.length===0,children:[a.jsx("option",{value:"",children:u?"Loading...":"Select an option..."}),r.map(d=>a.jsx("option",{value:d,children:d},d))]}),a.jsx(U,{variant:"secondary",size:"icon",onClick:o,disabled:u||r.length===0,"aria-label":`Randomize ${e}`,icon:ur})]})]});function F5(){const{character:e,updateCharacter:t}=es(),{data:r,isLoading:n}=It({queryKey:["bioData"],queryFn:M5,staleTime:1e3*60*5}),[s,i]=E.useState({height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",distinctiveFeatures:"",clothing:"",memento:"",flaw:""}),[l,o]=E.useState({distinctiveFeatures:"select",clothing:"select",memento:"select",flaw:"select"}),u=(x,b)=>{i(w=>({...w,[x]:b}))},c=(x,b)=>{o(w=>({...w,[x]:b})),i(w=>({...w,[x]:""}))},d=x=>!x||x.length===0?"":x[Math.floor(Math.random()*x.length)],h=(x,b)=>{b&&b.length>0&&i(w=>({...w,[x]:d(b)}))},f=()=>{i(x=>({...x,height:d(hb),build:d(fb)}))},p=()=>{const x=Math.random()<.05?d(yb):d(mb),b=Math.random()<.05?d(bb):d(gb);i(w=>({...w,hairColor:x,hairStyle:d(pb),eyeColor:b,skinTone:d(xb)}))},g=()=>{const x=[];s.height&&s.build&&x.push(`A ${s.height.toLowerCase()}, ${s.build.toLowerCase()} individual`),s.hairStyle&&s.hairColor&&(s.hairStyle.toLowerCase()==="bald"?x.push("with a bald head"):x.push(`with ${s.hairStyle.toLowerCase()} ${s.hairColor.toLowerCase()} hair`)),s.eyeColor&&x.push(`${s.eyeColor.toLowerCase()} eyes`),s.skinTone&&x.push(`and ${s.skinTone.toLowerCase()} skin`);let b=x.join(", ").replace(/,([^,]*)$/," and$1")+".";return s.distinctiveFeatures&&(b+=` They are notable for ${s.distinctiveFeatures.toLowerCase()}.`),s.clothing&&(b+=` They typically wear ${s.clothing.toLowerCase()}.`),b},y=()=>{const x=g();t({appearance:x,mementos:s.memento?[s.memento]:[],weak_spot:s.flaw})},v=()=>Object.values(s).every(x=>x.trim()!=="");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Character Appearance"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Describe your character's physical appearance, clothing, and defining traits."})]}),a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Character Details"}),a.jsxs("p",{className:"text-sm text-blue-700",children:[e.kin,"  ",e.age,"  ",e.profession]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(L4,{className:"w-5 h-5 text-gray-500"}),"Physical Characteristics"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:ur,onClick:f,children:"Randomize"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),a.jsxs("select",{value:s.height,onChange:x=>u("height",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select height..."}),hb.map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build"}),a.jsxs("select",{value:s.build,onChange:x=>u("build",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select build..."}),fb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800",children:[a.jsx(Si,{className:"w-5 h-5 text-gray-500"}),"Hair and Face"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:ur,onClick:p,children:"Randomize"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Color"}),a.jsxs("select",{value:s.hairColor,onChange:x=>u("hairColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...mb,...yb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Style"}),a.jsxs("select",{value:s.hairStyle,onChange:x=>u("hairStyle",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select style..."}),pb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eye Color"}),a.jsxs("select",{value:s.eyeColor,onChange:x=>u("eyeColor",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select color..."}),[...gb,...bb].map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skin Tone"}),a.jsxs("select",{value:s.skinTone,onChange:x=>u("skinTone",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select tone..."}),xb.map(x=>a.jsx("option",{value:x,children:x},x))]})]})]})]}),a.jsx("div",{className:"space-y-4 md:col-span-2",children:a.jsxs("h4",{className:"font-medium flex items-center gap-2 text-gray-800 border-b pb-2",children:[a.jsx(hl,{className:"w-5 h-5 text-gray-500"}),"Traits & Possessions"]})}),a.jsx(Yc,{label:"Distinctive Feature",placeholder:"Scars, tattoos, birthmarks...",options:(r==null?void 0:r.appearance)||[],value:s.distinctiveFeatures,onChange:x=>u("distinctiveFeatures",x),mode:l.distinctiveFeatures,onModeChange:x=>c("distinctiveFeatures",x),onRandomize:()=>h("distinctiveFeatures",r==null?void 0:r.appearance),isLoading:n}),a.jsx(Yc,{label:"Typical Clothing",placeholder:"Describe typical clothing...",options:vb,value:s.clothing,onChange:x=>u("clothing",x),mode:l.clothing,onModeChange:x=>c("clothing",x),onRandomize:()=>h("clothing",vb)}),a.jsx(Yc,{label:"Memento",placeholder:"A locket, a worn coin...",options:(r==null?void 0:r.mementos)||[],value:s.memento,onChange:x=>u("memento",x),mode:l.memento,onModeChange:x=>c("memento",x),onRandomize:()=>h("memento",r==null?void 0:r.mementos),isLoading:n}),a.jsx(Yc,{label:"Flaw / Weak Spot",placeholder:"A fear of heights, a gambling problem...",options:(r==null?void 0:r.flaws)||[],value:s.flaw,onChange:x=>u("flaw",x),mode:l.flaw,onModeChange:x=>c("flaw",x),onRandomize:()=>h("flaw",r==null?void 0:r.flaws),isLoading:n})]}),v()?a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg space-y-3",children:[a.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"Appearance Preview"}),a.jsx("p",{className:"text-sm text-green-700",children:g()})]}):a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Description"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please fill in all appearance details to see a preview and save."})]})]}),a.jsx(U,{onClick:y,disabled:!v(),icon:Qt,className:"w-full justify-center",children:"Save Appearance"})]})}const bo=[{title:"Kin",component:M6},{title:"Profession",component:H6},{title:"Name & Age",component:$6},{title:"Attributes",component:V6},{title:"Magic",component:G6},{title:"Trained Skills",component:Q6},{title:"Gear",component:O5},{title:"Appearance",component:F5}],U5=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,wb={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},B5=["Mentalism","Animism","Elementalism"];function H5(){const{user:e}=qt(),{step:t,setStep:r,character:n,resetCharacter:s}=es(),[i,l]=Tn.useState(null),[o,u]=Tn.useState(!1),c=fn(),d=Zr(),h=bo[t].component,[f,p]=E.useState([]);E.useEffect(()=>{re.from("magic_schools").select("id, name").then(({data:v,error:x})=>{x?console.error("Failed to fetch magic schools in wizard:",x):p(v||[])})},[]);const g=()=>{var v;switch(t){case 0:return!!n.kin&&n.kinAbilityNames!==void 0&&n.kinAbilityNames.length>0;case 1:const x=n.magicSchool!==null&&n.magicSchool!==void 0;return!!n.profession&&(x||n.professionHeroicAbilityName!==void 0);case 2:return!!n.name&&n.name.trim().length>0&&!!n.age;case 3:return n.attributes&&Object.values(n.attributes).every(b=>b>0);case 4:return n.magicSchool?((v=n.spells)==null?void 0:v.general)&&n.spells.general.length>=3:!0;case 5:return n.trainedSkills&&n.trainedSkills.length>=6&&!!n.attributes;case 6:return n.startingEquipment&&n.startingEquipment.items.length>=0;case 7:return!!n.appearance&&n.appearance.trim().length>0&&!!n.mementos&&n.mementos.length>0&&!!n.weak_spot&&n.weak_spot.trim().length>0;default:return!1}},y=async()=>{var x,b,w,_,k;const v=es.getState().character;if(!e||!v.attributes){l("User or attributes missing.");return}if(!g()){l("Please complete all required fields for the final step before saving.");return}try{u(!0),l(null);const S={},A=new Set(v.trainedSkills||[]),R=(x=v.profession)==null?void 0:x.toLowerCase().includes("mage"),L=R&&typeof v.magicSchool=="string"?(b=f.find(G=>G.id===v.magicSchool))==null?void 0:b.name:null;for(const G in wb){const B=wb[G];if(!B5.includes(G)||R&&G===L){const K=v.attributes[B]??10,P=U5(K);S[G]=A.has(G)?P*2:P}}const T=[...v.kinAbilityNames||[],...v.professionHeroicAbilityName?[v.professionHeroicAbilityName]:[]].filter(Boolean),z={user_id:e.id,name:(w=v.name)==null?void 0:w.trim(),kin:v.kin,profession:v.profession,magic_school:R?v.magicSchool:null,age:v.age,attributes:v.attributes,trained_skills:v.trainedSkills||[],skill_levels:S,equipment:v.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},appearance:(_=v.appearance)==null?void 0:_.trim(),conditions:{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},spells:v.spells||null,starting_equipment:v.startingEquipment||{items:[],money:{gold:0,silver:0,copper:0}},experience:{marked_skills:[]},max_hp:v.attributes.CON,current_hp:v.attributes.CON,max_wp:v.attributes.WIL,current_wp:v.attributes.WIL,heroic_ability:T,memento:((k=v.mementos)==null?void 0:k[0])||null,weak_spot:v.weak_spot||null},{data:O,error:Y}=await re.from("characters").insert(z).select().single();if(Y)throw Y;await d.invalidateQueries({queryKey:["characters",e.id]}),s(),c(`/characters/${O.id}`)}catch(S){const A=S instanceof Error?S.message:"Failed to save character";l(`Failed to save character: ${A}`)}finally{u(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-8 my-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Create New Character"}),a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Step ",t+1," of ",bo.length]})]}),a.jsx("div",{className:"flex space-x-1",children:bo.map((v,x)=>a.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden bg-gray-200",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${x<t?"bg-blue-500":x===t?"bg-blue-300":"bg-gray-200"}`,style:{width:x===t?"50%":"100%"}})},v.title))}),a.jsx("p",{className:"text-center text-lg font-semibold mt-3 text-gray-700",children:bo[t].title})]}),i&&a.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-red-50 border border-red-300 rounded-lg shadow-sm",children:[a.jsx(Dt,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Creation Error"}),a.jsx("p",{className:"text-sm text-red-700",children:i})]})]}),a.jsx("div",{className:"min-h-[400px] mb-8",children:a.jsx(h,{})}),a.jsxs("div",{className:"flex justify-between items-center mt-8 border-t pt-6",children:[a.jsx("button",{onClick:()=>r(t-1),disabled:t===0||o,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t===bo.length-1?a.jsxs("button",{onClick:y,disabled:!g()||o,className:`inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":g()?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"}`,children:[a.jsx(Qt,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Saving Character...":"Create Character"]}):a.jsx("button",{onClick:()=>r(t+1),disabled:!g()||o,className:`inline-flex items-center px-5 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ${!g()||o?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Next Step"})]})]})}function Vp({icon:e,title:t,description:r,action:n}){return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 mb-6",children:r}),n]})}const eN="*, magic_school:magic_schools!left(*)",to=e=>{const t={STR:10,AGL:10,INT:10,CON:10,WIL:10,CHA:10},r=e.attributes||{},n={STR:r.STR??t.STR,AGL:r.AGL??t.AGL,INT:r.INT??t.INT,CHA:r.CHA??t.CHA,CON:r.CON??t.CON,WIL:r.WIL??t.WIL},s=e.max_hp??n.CON,i=e.max_wp??n.WIL;let l={};if(typeof e.skill_levels=="string")try{l=JSON.parse(e.skill_levels)}catch{}else typeof e.skill_levels=="object"&&e.skill_levels!==null&&(l=e.skill_levels);const o=e.equipment||{};return{id:e.id,user_id:e.user_id,name:e.name||"Unnamed Character",kin:e.kin||"Unknown",profession:e.profession||"Unknown",age:e.age,appearance:e.appearance||"",background:e.background||"",notes:e.notes||"",portrait_url:e.portrait_url,magicSchool:e.magic_school||null,memento:e.memento||"",flaw:e.weak_spot||"",attributes:n,max_hp:s,current_hp:e.current_hp??s,max_wp:i,current_wp:e.current_wp??i,skill_levels:l,trainedSkills:e.trained_skills||[],spells:e.spells||{known:[]},heroic_abilities:e.heroic_ability||[],equipment:{inventory:o.inventory||[],equipped:o.equipped||{weapons:[]},money:o.money||{gold:0,silver:0,copper:0}},conditions:e.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},is_rallied:e.is_rallied??!1,death_rolls_passed:e.death_rolls_passed??0,death_rolls_failed:e.death_rolls_failed??0,experience:e.experience??0,teacher:e.teacher||null,reputation:e.reputation??0,corruption:e.corruption??0,created_at:e.created_at,updated_at:e.updated_at,party_id:e.party_id,party_info:e.party_info}};async function $5(e){if(!e)return[];const{data:t,error:r}=await re.from("characters").select(eN).eq("user_id",e).order("created_at",{ascending:!1});if(r)throw new Error(r.message||"Failed to fetch characters");return(t||[]).map(to)}async function z5(e,t){if(!e||!t)return console.warn("fetchCharacterById requires both character ID and user ID."),null;try{const{data:r,error:n}=await re.rpc("get_character_details_with_party",{p_character_id:e,p_user_id:t});return n?(console.error("Error fetching character via RPC:",n),null):r?to(r):null}catch(r){return console.error("Unexpected error in fetchCharacterById:",r),null}}async function tN(e,t){const r={...t};r.heroic_abilities&&(r.heroic_ability=r.heroic_abilities,delete r.heroic_abilities),r.trainedSkills&&(r.trained_skills=r.trainedSkills,delete r.trainedSkills),r.magicSchool&&(r.magic_school=r.magicSchool,delete r.magicSchool),r.updated_at=new Date().toISOString();const{data:n,error:s}=await re.from("characters").update(r).eq("id",e).select(eN).single();if(s)throw new Error(s.message||"Failed to update character");return n?to(n):null}async function q5(e){if(e.length===0)return;const{error:t}=await re.from("characters").delete().in("id",e);if(t)throw new Error(t.message||"Failed to delete characters")}const rN=Tn.forwardRef(({className:e,...t},r)=>a.jsx("input",{ref:r,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed ${e}`,...t}));rN.displayName="Input";function V5({isOpen:e,onClose:t,onJoin:r}){const[n,s]=E.useState(""),[i,l]=E.useState(""),[o,u]=E.useState(!1),c=async()=>{l("");const h=n.match(/party\/join\/([^/?]+)/);if(h&&h[1]){const f=h[1];u(!0);try{await r(f),d()}catch(p){console.error("Join operation failed:",p)}finally{u(!1)}}else l("Invalid party invite link. Please paste the full link.")},d=()=>{s(""),l(""),u(!1),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity","aria-labelledby":"join-party-title",role:"dialog","aria-modal":"true",onClick:d,children:a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md m-4 transform transition-all",onClick:h=>h.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{id:"join-party-title",className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ac,{className:"w-6 h-6 text-blue-600"}),"Join an Adventure Party"]}),a.jsx("button",{onClick:d,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600","aria-label":"Close dialog",disabled:o,children:a.jsx(Rt,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Paste the invite link you received from your Dungeon Master to join their party."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party-link",className:"sr-only",children:"Party Invite Link"}),a.jsx(rN,{id:"party-link",type:"text",value:n,onChange:h=>s(h.target.value),placeholder:"https://.../party/join/...",className:"w-full","aria-describedby":"link-error",disabled:o}),i&&a.jsx("p",{id:"link-error",className:"text-red-500 text-sm mt-2",children:i})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(U,{variant:"secondary",onClick:d,disabled:o,children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:c,disabled:!n||o,children:o?"Joining...":"Join Party"})]})]})}):null}function Wp({isOpen:e,onClose:t,onConfirm:r,title:n,description:s,confirmText:i="Confirm",cancelText:l="Cancel",isLoading:o=!1,isDestructive:u=!1,icon:c}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[c&&a.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${u?"bg-red-100":"bg-blue-100"}`,children:c}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",id:"modal-title",children:n}),a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:s})})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3",children:[a.jsx(U,{variant:"secondary",onClick:t,disabled:o,className:"mt-3 sm:mt-0 w-full sm:w-auto",children:l}),a.jsx(U,{variant:u?"danger":"primary",onClick:r,loading:o,className:"w-full sm:w-auto",children:i})]})]})}):null}function W5(){const{user:e}=qt(),t=fn(),r=Zr(),[n,s]=E.useState(!1),[i,l]=E.useState(!1),[o,u]=E.useState([]),[c,d]=E.useState(!1),{data:h=[],isLoading:f,error:p}=It({queryKey:["characters",e==null?void 0:e.id],queryFn:()=>$5(e==null?void 0:e.id),enabled:!!e}),g=wt({mutationFn:q5,onSuccess:()=>{r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]}),u([]),d(!1)},onError:v=>{console.error("Failed to delete characters:",v),d(!1)}}),y=(v,x)=>{if(v.shiftKey)v.preventDefault(),u(b=>b.includes(x)?b.filter(w=>w!==x):[...b,x]);else{if(o.length>0)return;t(`/character/${x}`)}};return f?a.jsx("div",{className:"p-8 flex justify-center items-center h-full",children:a.jsx(He,{size:"lg"})}):p?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:p.message||"Failed to load characters"})}):e?a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Characters"}),h.length>0&&!n&&a.jsxs("div",{className:"relative group flex items-center",children:[a.jsx(Pn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600 cursor-pointer transition-colors"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 z-10 mb-2 w-max max-w-xs -translate-x-1/2 transform rounded-lg bg-gray-900 px-3 py-2 text-center text-sm font-normal text-white opacity-0 transition-opacity duration-300 group-hover:opacity-100 pointer-events-none",children:["Hold ",a.jsx("kbd",{className:"px-2 py-1.5 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg",children:"Shift"})," and click cards to select multiple for deletion.",a.jsx("div",{className:"absolute left-1/2 top-full h-0 w-0 -translate-x-1/2 border-x-4 border-x-transparent border-t-4 border-t-gray-900"})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[o.length>0&&a.jsxs(U,{variant:"danger",icon:cr,onClick:()=>d(!0),loading:g.isPending,children:["Delete (",o.length,")"]}),a.jsx(U,{variant:"secondary",icon:ac,onClick:()=>l(!0),children:"Join Party"}),a.jsx(U,{variant:"primary",icon:Xt,onClick:()=>s(!0),children:"Create Character"})]})]}),n?a.jsx(H5,{onComplete:()=>{s(!1),r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]})}}):h.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(v=>a.jsxs("div",{className:"relative group cursor-pointer",onClick:x=>y(x,v.id),children:[a.jsx("div",{className:`absolute inset-0 rounded-lg border-2 transition-all duration-200 pointer-events-none ${o.includes(v.id)?"border-red-500 shadow-lg":"border-transparent group-hover:border-blue-500"}`}),a.jsx(o6,{character:v})]},v.id))}):a.jsx(Vp,{icon:Xt,title:"No Characters Yet",description:"Create your first character to begin your adventure.",action:a.jsx(U,{variant:"primary",icon:Xt,onClick:()=>s(!0),children:"Create Your First Character"})}),a.jsx(V5,{isOpen:i,onClose:()=>l(!1),onJoin:v=>{l(!1),t(`/party/join/${v}`)}}),a.jsx(Wp,{isOpen:c,onClose:()=>d(!1),onConfirm:()=>{o.length>0&&g.mutate(o)},title:`Delete ${o.length} ${o.length>1?"Characters":"Character"}?`,description:"Are you sure you want to permanently delete the selected character(s)? All of their data will be lost. This action cannot be undone.",confirmText:`Yes, Delete ${o.length}`,isLoading:g.isPending,isDestructive:!0,icon:a.jsx(oc,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})})]}):a.jsx("div",{className:"p-8",children:a.jsx(Vp,{icon:Dt,title:"Authentication Required",description:"Please sign in to view your characters."})})}async function G5(e){const{data:t,error:r}=await re.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async function Y5(e){const{data:t,error:r}=await re.from("encounters").select("*").eq("id",e).single();if(r)throw r;return t}async function nN(e){const{data:t,error:r}=await re.from("encounter_combatants").select("*").eq("encounter_id",e).order("initiative_roll",{ascending:!1,nullsLast:!0}).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching encounter combatants:",r),r;return t||[]}async function Q5(e){const{data:t,error:r}=await re.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1}).limit(1).single();if(r&&r.code!=="PGRST116")throw r;return t}async function K5(e,t,r){const{data:n,error:s}=await re.from("encounters").insert({party_id:e,name:t,description:r,status:"planning",log:[]}).select().single();if(s)throw s;return n}async function Z5(e,t){const{data:r,error:n}=await re.rpc("duplicate_encounter_with_combatants",{p_encounter_id:e,p_new_name:t});if(n)throw n;return r}async function X5(e){const{data:t,error:r}=await re.rpc("add_character_to_encounter",{p_encounter_id:e.encounterId,p_character_id:e.characterId,p_initiative_roll:e.initiativeRoll});if(r)throw r;return t}async function J5(e){const{data:t,error:r}=await re.rpc("add_monster_to_encounter",{p_encounter_id:e.encounterId,p_monster_id:e.monsterId,p_custom_name:e.customName,p_initiative_roll:e.initiativeRoll});if(r)throw r;return t}async function jg(e,t){const{data:r,error:n}=await re.from("encounters").update(t).eq("id",e).select().single();if(n)throw n;return r}async function sN(e,t){const{data:r,error:n}=await re.from("encounter_combatants").update(t).eq("id",e).select().single();if(n)throw n;return r}async function eI(e,t){const{error:r}=await re.rpc("append_to_log",{p_encounter_id:e,p_log_entry:t});if(r)throw r}const tI=e=>jg(e,{status:"active",current_round:1}),rI=e=>jg(e,{status:"completed"});async function nI(e){const{error:t}=await re.from("encounters").delete().eq("id",e);if(t)throw t}async function sI(e){const{error:t}=await re.from("encounter_combatants").delete().eq("id",e);if(t)throw t}async function aI(e,t){const{data:r,error:n}=await re.rpc("roll_initiative_for_combatants",{p_encounter_id:e,p_combatant_ids:t});if(n)throw n;return r}async function iI(e,t){const{data:r,error:n}=await re.rpc("swap_combatant_initiative",{p_combatant_id_1:e,p_combatant_id_2:t});if(n)throw n;return r}const rr=VE((e,t)=>({character:null,isLoading:!0,isSaving:!1,error:null,saveError:null,markedSkillsThisSession:new Set,allGameItems:[],isLoadingGameItems:!1,allHeroicAbilities:[],isLoadingAbilities:!1,activeStatusMessage:null,statusMessageTimeoutId:null,activeEncounter:null,currentCombatant:null,encounterCombatants:[],isLoadingEncounter:!1,encounterError:null,fetchCharacter:async(r,n)=>{e({isLoading:!0,error:null});try{await Promise.all([t()._loadGameItems(),t()._loadAllHeroicAbilities()]);const s=await z5(r,n);if(!s)throw new Error(`Character with ID ${r} not found.`);e({character:s,isLoading:!1}),s!=null&&s.party_id?t().fetchActiveEncounter(s.party_id,s.id):t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch character";e({error:i,isLoading:!1})}},fetchActiveEncounter:async(r,n)=>{e({isLoadingEncounter:!0});try{const s=await Q5(r);if(s&&s.status==="active"){const i=await nN(s.id),l=i.find(u=>u.character_id===n),o=i.sort((u,c)=>(u.initiative_roll??100)-(c.initiative_roll??100));e({activeEncounter:s,currentCombatant:l??null,encounterCombatants:o})}else t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch encounter";e({encounterError:i})}finally{e({isLoadingEncounter:!1})}},setCharacter:r=>{e({character:r}),!r||!r.party_id?t().clearActiveEncounter():t().fetchActiveEncounter(r.party_id,r.id)},_saveCharacter:async r=>{var s;const n=(s=t().character)==null?void 0:s.id;if(!n){const i="Cannot save: Character ID is missing.";throw e({saveError:i}),new Error(i)}e({isSaving:!0,saveError:null});try{await tN(n,r),e(i=>i.character?{character:{...i.character,...r,updated_at:new Date().toISOString()},isSaving:!1}:{})}catch(i){const l=i instanceof Error?i.message:"Failed to save character";throw e({saveError:l,isSaving:!1}),i}},_loadGameItems:async()=>{if(!(t().isLoadingGameItems||t().allGameItems.length>0)){e({isLoadingGameItems:!0});try{const r=await uc();e({allGameItems:r,isLoadingGameItems:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load game items";e({isLoadingGameItems:!1,error:n})}}},_loadAllHeroicAbilities:async()=>{if(!(t().isLoadingAbilities||t().allHeroicAbilities.length>0)){e({isLoadingAbilities:!0});try{const{data:r,error:n}=await re.from("heroic_abilities").select("*").order("name");if(n)throw n;e({allHeroicAbilities:r||[],isLoadingAbilities:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load heroic abilities";e({isLoadingAbilities:!1,error:n})}}},updateCharacterData:async r=>t()._saveCharacter(r),adjustStat:async(r,n)=>{const s=t().character;if(s){if(r==="current_hp"){const i=s.current_hp??0,l=s.max_hp??10,o=Math.max(0,Math.min(l,i+n));if(o!==i){const u={current_hp:o};i<=0&&o>0&&(u.death_rolls_passed=0,u.death_rolls_failed=0,u.is_rallied=!1),await t()._saveCharacter(u)}}else if(r==="current_wp"){const i=s.current_wp??0,l=s.max_wp??10,o=Math.max(0,Math.min(l,i+n));o!==i&&await t()._saveCharacter({current_wp:o})}}},toggleCondition:async r=>{const n=t().character;if(!n)return;const s=n.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i={...s,[r]:!s[r]};await t()._saveCharacter({conditions:i})},performRest:async(r,n)=>{const s=t().character;if(!s)return;const i={},l=s.current_hp??0,o=s.max_hp??10,u=s.current_wp??0,c=s.max_wp??10,d=()=>Math.floor(Math.random()*6)+1;if(r==="round")i.current_wp=Math.min(c,u+d());else if(r==="stretch"){if(l<=0){t().setActiveStatusMessage("Cannot take Stretch Rest while dying.",3e3);return}const h=n?d()+d():d();i.current_hp=Math.min(o,l+h),i.current_wp=Math.min(c,u+d());const p={...s.conditions??{}};for(const g of Object.keys(p))if(p[g]===!0){p[g]=!1,i.conditions=p;break}}else r==="shift"&&(i.current_hp=o,i.current_wp=c,i.conditions={exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i.death_rolls_failed=0,i.death_rolls_passed=0,i.is_rallied=!1);Object.keys(i).length>0&&await t()._saveCharacter(i)},setDeathRollState:async(r,n,s)=>{const i={death_rolls_passed:r,death_rolls_failed:n};s!==void 0&&(i.is_rallied=s),await t()._saveCharacter(i)},updateAttribute:async(r,n)=>{const s=t().character;if(!s)return;const l={attributes:{...s.attributes||{},[r]:n}};r==="CON"&&s.max_hp==null&&(l.max_hp=n,l.current_hp=Math.min(s.current_hp??0,n)),r==="WIL"&&s.max_wp==null&&(l.max_wp=n,l.current_wp=Math.min(s.current_wp??0,n)),await t()._saveCharacter(l)},updateCurrentHP:async r=>{var s;const n=((s=t().character)==null?void 0:s.max_hp)??10;if(r>n){console.warn("Attempted to set current_hp higher than max_hp. Operation blocked.");return}await t()._saveCharacter({current_hp:r})},updateWillpowerPoints:async r=>{var s;const n=((s=t().character)==null?void 0:s.max_wp)??10;if(r>n){console.warn("Attempted to set current_wp higher than max_wp. Operation blocked.");return}await t()._saveCharacter({current_wp:r})},updateConditions:async r=>t()._saveCharacter({conditions:r}),updateInventory:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,inventory:r}})},updateEquipped:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,equipped:r}})},updateMoney:async r=>{var n;return t()._saveCharacter({equipment:{...(n=t().character)==null?void 0:n.equipment,money:r}})},updateNotes:async r=>t()._saveCharacter({notes:r}),updateExperience:async r=>t()._saveCharacter({experience:r}),updateReputation:async r=>t()._saveCharacter({reputation:r}),updateCorruption:async r=>t()._saveCharacter({corruption:r}),updateAppearance:async r=>t()._saveCharacter({appearance:r}),updateDeathRolls:async(r,n)=>{const s=t().character;s&&(r==="failed"?await t().setDeathRollState(s.death_rolls_passed??0,n,s.is_rallied):await t().setDeathRollState(n,s.death_rolls_failed??0,s.is_rallied))},updateSkillLevel:async(r,n)=>{const s=t().character;if(!s)return;const l={...s.skill_levels||{},[r]:n};await t()._saveCharacter({skill_levels:l})},increaseSkillLevel:async r=>{var u;const n=t().character;if(!n)return;const s=n.skill_levels||{},i=s[r]??0;if(i>=18)return;const l=Math.min(i+1,18),o={skill_levels:{...s,[r]:l}};((u=n.teacher)==null?void 0:u.skillUnderStudy)===r&&(o.teacher=null),await t()._saveCharacter(o)},addHeroicAbility:async r=>{const n=t().character;if(!n)return;const s=n.heroic_abilities||[];await t()._saveCharacter({heroic_abilities:[...s,r]})},increaseMaxStat:async(r,n)=>{const s=t().character;if(!(s!=null&&s.id))throw new Error("Character ID not found for RPC call.");e({isSaving:!0,saveError:null});try{const{error:i}=await re.rpc("increase_character_max_stat",{character_id_input:s.id,stat_name:r,amount_increase:n});if(i)throw new Error(`PostgreSQL Function Error: ${i.message}`);e({isSaving:!1})}catch(i){const l=i instanceof Error?i.message:"A failure occurred in increaseMaxStat";throw e({saveError:l,isSaving:!1}),i}},learnSpell:async r=>{const n=t().character;if(!n)return;const s=n.spells??{school:{name:null,spells:[]},general:[]};if(!s.school){const{data:l}=await re.from("magic_schools").select("name").eq("id",n.magic_school).single();s.school={name:(l==null?void 0:l.name)??null,spells:[]}}let i;if(r.school_id){const l=s.school.spells||[];l.includes(r.name)||(i={...s,school:{...s.school,spells:[...l,r.name]}})}else{const l=s.general||[];l.includes(r.name)||(i={...s,general:[...l,r.name]})}i&&await t()._saveCharacter({spells:i})},addMagicSchool:async(r,n)=>{const s=t().character;if(!s)return;const l={skill_levels:{...s.skill_levels,[r.name]:n}};s.magic_school||(l.magic_school=r.id),await t()._saveCharacter(l)},setSkillUnderStudy:async r=>{await t()._saveCharacter({teacher:r?{skillUnderStudy:r}:null})},markSkillThisSession:r=>{e(n=>({markedSkillsThisSession:new Set(n.markedSkillsThisSession).add(r)}))},clearMarkedSkillsThisSession:()=>e({markedSkillsThisSession:new Set}),setActiveStatusMessage:(r,n=3e4)=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:r});const s=setTimeout(()=>{e({activeStatusMessage:null,statusMessageTimeoutId:null})},n);e({statusMessageTimeoutId:s})},clearActiveStatusMessage:()=>{clearTimeout(t().statusMessageTimeoutId),e({activeStatusMessage:null,statusMessageTimeoutId:null})},drawInitiative:async()=>{const{currentCombatant:r}=t();if(r){const n=Math.floor(Math.random()*10)+1;await t().setInitiativeForCombatant(r.id,n)}},setInitiativeForCombatant:async(r,n)=>{e({isSaving:!0,saveError:null});try{await sN(r,{initiative_roll:n}),t().setActiveStatusMessage(`Initiative set to ${n}`,4e3)}catch(s){const i=s instanceof Error?s.message:"Failed to set initiative";e({saveError:i})}finally{e({isSaving:!1})}},clearActiveEncounter:()=>{e({activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null,encounterCombatants:[]})}})),lI=[{kin:"Human",movement:10},{kin:"Halfling",movement:8},{kin:"Dwarf",movement:8},{kin:"Elf",movement:10},{kin:"Mallard",movement:8},{kin:"Wolfkin",movement:12}];function oI(e,t){var s;const r=((s=lI.find(i=>i.kin===e))==null?void 0:s.movement)||10;let n=0;return t<=6?n=-4:t<=9?n=-2:t<=12?n=0:t<=15?n=2:n=4,r+n}const Xf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},uI=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming"],cI=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],dI=["Mentalism","Animism","Elementalism"],hI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,fI=(e,t,r)=>{var l,o;console.warn(`[SkillsModal] Calculating fallback level for ${t}.`);const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=hI(s);return n?i*2:i};function mI({onClose:e}){const{toggleDiceRoller:t}=Mn(),{character:r}=rr(),n=!!(r!=null&&r.magicSchool&&typeof r.magicSchool=="object"),s=n?r.magicSchool.name:null;if(!r)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6",children:a.jsx(He,{})})});const i=E.useMemo(()=>s?dI.filter(h=>h===s).map(h=>({name:h,attr:Xf[h]})):[],[s]),l=h=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[h],o=(h,f,p)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:f,description:`${h} Check`,requiresBane:p,skillName:h}),e()},u=uI.map(h=>({name:h,attr:Xf[h]})).sort((h,f)=>h.name.localeCompare(f.name)),c=cI.map(h=>({name:h,attr:Xf[h]})).sort((h,f)=>h.name.localeCompare(f.name)),d=h=>{var v,x,b;const f=((v=r.trainedSkills)==null?void 0:v.includes(h.name))??!1,p=((x=r.skill_levels)==null?void 0:x[h.name])??fI(r,h.name,h.attr),g=l(h.attr),y=((b=r.conditions)==null?void 0:b[g])??!1;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${y?"bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"hover:bg-gray-100"}`,onClick:()=>o(h.name,p,y),title:`Click to roll ${h.name} (Target  ${p}${y?", Bane":""})`,children:[a.jsxs("div",{children:[a.jsx("span",{className:`${f?"font-bold":""} ${y?"text-red-700":"text-gray-800"}`,children:h.name}),a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",h.attr,")"]}),y&&a.jsx("span",{className:"text-xs text-red-600 font-semibold ml-2",children:"(Bane)"})]}),a.jsxs("span",{className:`font-medium text-sm ${y?"text-red-700":"text-gray-600"}`,children:["Target: ",p]})]},h.name)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Skills (D20 Check)"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click a skill to roll a D20 check. Roll  Skill Level for success. 1 is Dragon (Crit Success), 20 is Demon (Crit Fail). Conditions apply Bane (roll 2d20, take highest/worst). Trained skills are bolded."})]}),a.jsxs("div",{className:`grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-6 p-6 overflow-y-auto flex-grow`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"General Skills"}),a.jsx("div",{className:"space-y-1",children:u.map(d)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Weapon Skills"}),a.jsx("div",{className:"space-y-1",children:c.map(d)})]}),n&&s&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold mb-4 text-gray-700",children:["Magic Skill (",s,")"]}),a.jsx("div",{className:"space-y-1",children:i.length>0?i.map(d):a.jsxs("p",{className:"text-sm text-gray-500 italic px-2 py-1",children:['No matching magic skill found for "',s,'".']})})]})]}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,children:"Close"})})]})})}function pI(e){var h,f;const[t,r]=E.useState([]),[n,s]=E.useState(!0),[i,l]=E.useState(null),o=rr(p=>p.character),u=E.useMemo(()=>{if(!(o!=null&&o.spells))return[];let p=[];if(o.spells.general&&(Array.isArray(o.spells.general)?p=p.concat(o.spells.general):console.warn("[useSpells] character.spells.general is not an array:",o.spells.general)),o.spells.school&&o.spells.school.spells){const g=o.spells.school.spells;Array.isArray(g)?p=p.concat(g):console.warn("[useSpells] character.spells.school.spells is not an array:",g)}return Array.from(new Set(p))},[o==null?void 0:o.spells]);E.useEffect(()=>{if(!e||u.length===0){s(!1),r([]);return}async function p(){s(!0),l(null);try{const{data:g,error:y}=await re.from("game_spells").select(`
            *,
            power_level,
            magic_schools ( name )
          `).in("name",u).order("rank",{ascending:!0}).order("name",{ascending:!0});if(y)throw y;r(g||[])}catch(g){console.error("Error loading learned spell details:",g),l(g instanceof Error?g.message:"Failed to load spell details"),r([])}finally{s(!1)}}p()},[e,u]);const c=E.useMemo(()=>t.map(p=>({id:p.id,name:p.name,schoolId:p.school_id,rank:p.rank,requirement:p.requirement,castingTime:p.casting_time,range:p.range,duration:p.duration,description:p.description,willpowerCost:p.willpower_cost,createdAt:p.created_at,powerLevel:p.power_level})),[t]),d=E.useMemo(()=>{var p,g;return((g=(p=o==null?void 0:o.spells)==null?void 0:p.school)==null?void 0:g.name)??null},[(f=(h=o==null?void 0:o.spells)==null?void 0:h.school)==null?void 0:f.name]);return{learnedSpells:c,characterSchoolName:d,loading:n,error:i}}const aN=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,gI=(e,t)=>{var l,o;const r="WIL",n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=aN(s);return n?i*2:i};function xI({onClose:e}){var he;const[t,r]=E.useState(null),[n,s]=E.useState(null),[i,l]=E.useState(null),[o,u]=E.useState("prepared"),[c,d]=E.useState({}),[h,f]=E.useState("all"),{toggleDiceRoller:p}=Mn(),{character:g,updateCharacterData:y,isSaving:v,setActiveStatusMessage:x}=rr(),{learnedSpells:b,characterSchoolName:w,loading:_,error:k}=pI(g==null?void 0:g.id),S=((he=g==null?void 0:g.attributes)==null?void 0:he.INT)??10,A=aN(S),R=E.useMemo(()=>new Set((g==null?void 0:g.prepared_spells)??[]),[g==null?void 0:g.prepared_spells]),L=E.useMemo(()=>b.filter(J=>J.rank>0&&R.has(J.id)).length,[b,R]),T=L<A,z=async(J,q)=>{const $=b.find(Te=>Te.id===J),Z=q?"Unprepare":"Prepare";if(console.log(`[SpellcastingView - Prepare] START: Initiating toggle for spell "${($==null?void 0:$.name)||"Unknown"}". Action: ${Z}`),s(null),!g){console.error("[SpellcastingView - Prepare] FAILED: Character object is not available.");return}const te=g.prepared_spells??[];let ge;if(q)ge=te.filter(Te=>Te!==J);else{if(!T){const Te=`Preparation limit reached (${A} based on INT ${S}).`;console.warn(`[SpellcastingView - Prepare] FAILED (UI Rule): ${Te}`),s(Te);return}ge=[...te,J]}const we={prepared_spells:ge};console.log("[SpellcastingView - Prepare] BEFORE_SAVE: Calling updateCharacterData with payload:",we);try{await y(we),console.log(`[SpellcastingView - Prepare] SUCCESS: updateCharacterData promise resolved for spell "${($==null?void 0:$.name)||"Unknown"}".`)}catch(Te){console.error(`[SpellcastingView - Prepare] FAILED (catch block): Caught an error during update for spell "${($==null?void 0:$.name)||"Unknown"}".`,{wasTryingTo:Z.toLowerCase(),intendedUpdatePayload:we,originalError:Te}),s(Te instanceof Error?Te.message:"Failed to update preparation")}finally{console.log(`[SpellcastingView - Prepare] END: Finished toggle attempt for spell "${($==null?void 0:$.name)||"Unknown"}".`)}},{preparedSpellsList:O,grimoireSpellsList:Y}=E.useMemo(()=>{const J=b.filter(te=>te.rank===0),q=b.filter(te=>te.rank>0&&R.has(te.id)),$=[...J,...q].sort((te,ge)=>te.rank-ge.rank||te.name.localeCompare(ge.name)),Z=[...b].sort((te,ge)=>te.rank-ge.rank||te.name.localeCompare(ge.name));return{preparedSpellsList:$,grimoireSpellsList:Z}},[b,R]),G=E.useMemo(()=>{const J=new Set(b.map(q=>q.rank));return Array.from(J).sort((q,$)=>q-$)},[b]),B=E.useMemo(()=>{const J=[{label:"All",value:"all"}];return G.forEach(q=>{q===0?J.push({label:"Trick",value:0}):q>=1&&q<=9&&J.push({label:`Rank ${q}`,value:q})}),J},[G]),W=E.useMemo(()=>{const J=o==="prepared"?O:Y;return h==="all"?J:J.filter(q=>q.rank===h)},[o,O,Y,h]),{actualMagicSkillName:K,magicSkillValue:P,isMagicSkillAffected:X}=E.useMemo(()=>{var te;if(!g||!w)return{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1};const J=["Animism","Elementalism","Mentalism","Symbolism","General Magic"],q=g.skill_levels||{},$=new Set([...g.trainedSkills||[],...Object.keys(q)]);let Z=null;if(w==="Animism"&&$.has("Animism")?Z="Animism":w==="Elementalism"&&$.has("Elementalism")?Z="Elementalism":w==="Mentalism"&&$.has("Mentalism")?Z="Mentalism":(Z=J.find(ge=>$.has(ge))??null,!Z&&$.has(w)&&(Z=w)),Z){const ge=q[Z],we=ge!==void 0?ge:gI(g,Z),Te=((te=g.conditions)==null?void 0:te.scared)??!1;return{actualMagicSkillName:Z,magicSkillValue:we,isMagicSkillAffected:Te}}return console.warn(`[SpellcastingView] Could not determine actual magic skill for school '${w}'.`),{actualMagicSkillName:null,magicSkillValue:null,isMagicSkillAffected:!1}},[g,w]);if(E.useEffect(()=>{const J={};b.forEach(q=>{q.powerLevel==="yes"&&(J[q.id]=c[q.id]||1)}),d(J)},[b]),!g)return null;const N=async J=>{l(J.id),r(null);try{const q=g.current_wp??g.attributes.WIL,$=Number(J.willpowerCost??0),Z=c[J.id]||1,te=J.powerLevel==="yes",ge=te?$+(Z-1)*2:$;if(q<ge)throw new Error(`Insufficient Willpower Points (Need ${ge}, Have ${q})`);const we=q-ge;await y({current_wp:we}),x(`Casted ${J.name}${te?` (Lvl ${Z})`:""} for ${ge} WP.`)}catch(q){console.error("Error casting spell:",q),r(q instanceof Error?q.message:"Failed to cast spell")}finally{l(null)}},V=(J,q)=>{d($=>{const Z=$[J]||1,te=Math.max(1,Math.min(3,Z+q));return{...$,[J]:te}})},H=()=>{!K||P===null||p({initialDice:["d20"],rollMode:"skillCheck",targetValue:P,description:`${K} Check`,requiresBane:X,skillName:K})},j=({spell:J,isPreparedView:q})=>{const $=R.has(J.id),Z=J.rank===0,te=!Z&&($||T),ge=J.powerLevel==="yes",we=c[J.id]||1,Te=Number(J.willpowerCost??0),ze=ge?Te+(we-1)*2:Te,Ze=(g.current_wp??g.attributes.WIL)<ze;let Ct=`Rank ${J.rank}`,ot="bg-amber-100",pt="text-amber-800",Ye="border-amber-200";return J.rank===0?(Ct="Trick",ot="bg-gray-100",pt="text-gray-800",Ye="border-gray-300"):J.rank<=1?(ot="bg-blue-100",pt="text-blue-800",Ye="border-blue-200"):J.rank<=3&&(ot="bg-purple-100",pt="text-purple-800",Ye="border-purple-200"),a.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm flex flex-col justify-between ${!q&&!Z?"opacity-70":""}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-base text-gray-900",children:J.name}),!q&&a.jsx("div",{className:"ml-2 flex-shrink-0",children:Z?a.jsx(Kd,{className:"w-5 h-5 text-green-500",title:"Tricks are always prepared"}):a.jsx("button",{onClick:()=>z(J.id,$),disabled:!te||v,className:"disabled:opacity-50 disabled:cursor-not-allowed",title:$?"Unprepare":T?"Prepare":`Limit reached (${A})`,children:$?a.jsx(Kd,{className:"w-5 h-5 text-blue-600 hover:text-blue-800"}):a.jsx(RE,{className:`w-5 h-5 ${T?"text-gray-400 hover:text-gray-600":"text-gray-300"}`})})})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${ot} ${pt} border ${Ye}`,children:Ct}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(In,{size:14,className:"text-gray-400"}),a.jsxs("span",{children:[ze," WP",ge&&we>1&&a.jsxs("span",{className:"text-xs text-blue-600",children:[" (Lvl ",we,")"]})]})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-2 mb-4",children:[J.requirement&&a.jsxs("p",{className:"text-amber-700 bg-amber-50 px-2 py-1 rounded border border-amber-200",children:[a.jsx("span",{className:"font-medium",children:"Requirement:"})," ",J.requirement]}),a.jsxs("p",{className:"whitespace-normal break-words",children:[a.jsx("span",{className:"font-medium",children:"Description:"})," ",J.description||"No description."]}),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1 text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Uh,{size:12})," ",J.castingTime]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(H4,{size:12})," ",J.range]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(wg,{size:12})," ",J.duration]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(In,{size:12})," ",Te," WP ",ge?"(Base)":""]})]})]})]}),q&&a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center justify-center gap-1",children:ge?a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"primary",size:"sm",onClick:()=>V(J.id,-1),disabled:we<=1||!!i||v,className:"px-2",title:"Decrease level",children:a.jsx(SE,{size:14})}),a.jsx(U,{variant:"primary",size:"sm",onClick:()=>N(J),loading:i===J.id||v,disabled:!!i||v||Ze,className:"flex-grow min-w-[80px]",title:Ze?`Need ${ze} WP`:`Cast Lvl ${we}`,children:i===J.id?"":`Cast Lvl ${we}`}),a.jsx(U,{variant:"primary",size:"sm",onClick:()=>V(J.id,1),disabled:we>=3||!!i||v,className:"px-2",title:"Increase level",children:a.jsx(Xt,{size:14})})]}):a.jsx(U,{variant:"primary",size:"sm",onClick:()=>N(J),loading:i===J.id||v,disabled:!!i||v||Ze,className:"w-full",title:Ze?`Need ${ze} WP`:`Cast ${J.name}`,children:i===J.id?"":"Cast"})})}),!q&&!Z&&a.jsx("div",{className:"mt-auto pt-3 text-center text-xs text-gray-400 italic",children:$?"Prepared":"Prepare in Grimoire"})]})};return _?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:[a.jsx(He,{}),a.jsx("p",{className:"text-center mt-2 text-gray-600",children:"Loading spells..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-7xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 text-gray-800 mb-1",children:[a.jsx(hl,{className:"w-6 h-6 text-purple-600"}),"Spellcasting"]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Current WP: ",a.jsx("strong",{className:"font-semibold",children:g.current_wp??g.attributes.WIL})," / ",g.attributes.WIL]}),K&&P!==null&&a.jsxs("div",{className:`flex items-center gap-1 cursor-pointer px-2 py-0.5 rounded transition-colors ${X?"text-red-700 bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 ring-1 ring-indigo-200"}`,onClick:H,title:`Click to roll ${K} (Target  ${P}${X?", Bane":""})`,children:[a.jsx(ur,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"font-medium",children:[K,":"]}),a.jsx("span",{children:P}),X&&a.jsx("span",{className:"text-xs font-semibold",children:"(Bane)"})]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none focus:outline-none mt-[-4px]",children:""})]}),t&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Casting Error"}),a.jsx("p",{className:"text-xs text-red-700",children:t})]}),n&&a.jsxs("div",{className:"mb-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Preparation Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:n})]}),k&&a.jsxs("div",{className:"mb-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Spell Data Error"}),a.jsx("p",{className:"text-xs text-red-700",children:k})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-6",children:[a.jsxs("button",{onClick:()=>{u("prepared"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="prepared"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Zd,{size:16})," Prepared (",O.length,")"]}),a.jsxs("button",{onClick:()=>{u("grimoire"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="grimoire"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(cl,{size:16})," Grimoire (",b.length,")"]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"py-3 px-1 text-sm text-gray-500",children:["Preparation Slots: ",a.jsxs("span",{className:"font-medium",children:[L," / ",A]})," (INT ",S,")"]})]})}),b.length>0&&B.length>1&&a.jsxs("div",{className:"pt-4 flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-600 flex items-center gap-1 mr-1 shrink-0",children:[a.jsx(Ra,{size:14})," Filter:"]}),B.map(J=>a.jsx(U,{variant:h===J.value?"primary":"outline",size:"xs",onClick:()=>f(J.value),className:`px-2.5 py-1 ${h===J.value?"":"text-gray-600 bg-white hover:bg-gray-50"}`,children:J.label},J.value))]})]}),a.jsx("div",{className:"overflow-y-auto flex-grow p-6 bg-gray-50",children:W.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:W.map(J=>a.jsx(j,{spell:J,isPreparedView:o==="prepared"},J.id))}):a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[_&&a.jsx("p",{children:"Loading spells..."}),!_&&k&&a.jsx("p",{children:"Could not load spell details."}),!_&&!k&&a.jsxs(a.Fragment,{children:[o==="prepared"&&O.length===0&&a.jsx("p",{children:"No spells prepared. Go to the Grimoire tab. Tricks are always prepared."}),o==="grimoire"&&Y.length===0&&a.jsx("p",{children:"Character has not learned any spells."}),W.length===0&&a.jsx("p",{children:"No spells match the selected rank filter."})]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,disabled:!!i||v,children:"Close"})})]})})}const vo=(e,t)=>{const r=/(?:(\d+)\s*x\s+)|(?:x\s*(\d+))|(?:[(\[]x?(\d+)[)\]])|^(\d+)\s+/,n=e.match(r);let s=1,i=e.trim();if(n){const o=n[1]||n[2]||n[3]||n[4];o&&(s=parseInt(o,10)),i=e.replace(n[0],"").trim()}const l=t.find(o=>o.name.toLowerCase()===i.toLowerCase());return{id:`item-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:i,quantity:s,originalName:e,...l}},Eb=e=>{let t=e.name;return e.quantity>1&&(t+=` (x${e.quantity})`),e.unit&&(t+=` (${e.unit})`),t},wo=(e,t)=>{const r=e.findIndex(s=>s.name===t.name&&!s.unit&&!t.unit),n=[...e];return r>-1?n[r].quantity+=t.quantity:n.push(t),n},yI=["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS","CLOTHES","MUSICAL INSTRUMENTS","TRADE GOODS","STUDIES & MAGIC","LIGHT SOURCES","TOOLS","CONTAINERS","MEDICINE","SERVICES","HUNTING & FISHING","MEANS OF TRAVEL","ANIMALS"],bI=[{name:"Armor & Weapons",categories:["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS"],Icon:Cs},{name:"Clothing & Accessories",categories:["CLOTHES"],Icon:Tu},{name:"Musical & Trade Goods",categories:["MUSICAL INSTRUMENTS","TRADE GOODS"],Icon:Zy},{name:"Magic & Studies",categories:["STUDIES & MAGIC"],Icon:O4},{name:"Light & Tools",categories:["LIGHT SOURCES","TOOLS"],Icon:G4},{name:"Containers & Medicine",categories:["CONTAINERS","MEDICINE"],Icon:Tu},{name:"Services",categories:["SERVICES"],Icon:Zy},{name:"Hunting & Travel",categories:["HUNTING & FISHING","MEANS OF TRAVEL"],Icon:bE},{name:"Animals",categories:["ANIMALS"],Icon:ic}];function vI({onClose:e}){var K,P,X,N,V,H,j,he,J;const{isAdmin:t,isDM:r}=qt(),[n,s]=E.useState(null),[i,l]=E.useState("inventory"),[o,u]=E.useState({search:"",category:"all"}),[c,d]=E.useState({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""}),[h,f]=E.useState(!1),[p,g]=E.useState(null),{character:y,updateCharacterData:v,updateInventory:x,isSaving:b,saveError:w}=rr(),{data:_=[],isLoading:k}=It({queryKey:["gameItems"],queryFn:uc,staleTime:1/0});if(E.useEffect(()=>{var q;if(y&&_.length>0){const $=(q=y.equipment)==null?void 0:q.inventory;if($&&$.length>0&&typeof $[0]=="string"){let Z=[];for(const te of $)Z=wo(Z,vo(te,_));x(Z)}}},[y,_,x]),!y)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 text-center",children:a.jsx(He,{})})});const S=q=>_.find($=>{var Z;return((Z=$.name)==null?void 0:Z.toLowerCase())===q.toLowerCase()}),A=(q,$)=>{var ge;const Z=((ge=y.equipment)==null?void 0:ge.money)||{gold:0,silver:0,copper:0},te=Math.max(0,(Z[q]||0)+$);v({equipment:{...y.equipment,money:Cg({...Z,[q]:te})}})},R=()=>{var $,Z;if(!c.name||!c.cost){s("Name and cost are required");return}const q={id:`custom-${Date.now()}`,name:c.name.trim(),quantity:c.quantity,unit:(($=c.unit)==null?void 0:$.trim())||void 0,originalName:Eb(c),...c};x(wo(((Z=y.equipment)==null?void 0:Z.inventory)||[],q)),f(!1),d({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""})},L=q=>{var te;const $=[...((te=y.equipment)==null?void 0:te.inventory)||[]],Z={...$[q]};Z.quantity>1?(Z.quantity-=1,$[q]=Z):$.splice(q,1),x($)},T=(q,$)=>{var ot,pt;const Z=S(q.name);if(!Z){s(`Details not found for: ${q.name}`);return}const te=structuredClone(y.equipment),ge=te.inventory[$];ge.quantity>1?ge.quantity-=1:te.inventory.splice($,1);const we=((ot=Z.category)==null?void 0:ot.toUpperCase())||"",Te=we.includes("WEAPON")||Z.name.toLowerCase().includes("shield"),ze=we==="ARMOR & HELMETS"&&!Te&&!Z.name.toLowerCase().includes("helmet"),Ze=we==="ARMOR & HELMETS"&&!Te&&!ze;let Ct=null;if(Te){if((((pt=te.equipped.weapons)==null?void 0:pt.length)||0)>=3){s("Max 3 weapons/shields at hand.");return}const Ye={name:q.name,grip:Z.grip||"1H",range:Z.range,damage:Z.damage,durability:Z.durability,features:Z.features||[]};te.equipped.weapons||(te.equipped.weapons=[]),te.equipped.weapons.push(Ye)}else ze?(te.equipped.armor&&(Ct=vo(te.equipped.armor,_)),te.equipped.armor=q.name):Ze&&(te.equipped.helmet&&(Ct=vo(te.equipped.helmet,_)),te.equipped.helmet=q.name);Ct&&(te.inventory=wo(te.inventory,Ct)),v({equipment:te})},z=(q,$)=>{var ge,we,Te;const Z=structuredClone(y.equipment);let te=null;q==="armor"?(te=Z.equipped.armor||null,Z.equipped.armor=void 0):q==="helmet"?(te=Z.equipped.helmet||null,Z.equipped.helmet=void 0):q==="weapon"&&typeof $=="number"&&(te=((we=(ge=Z.equipped.weapons)==null?void 0:ge[$])==null?void 0:we.name)||null,(Te=Z.equipped.weapons)==null||Te.splice($,1)),te&&(Z.inventory=wo(Z.inventory,vo(te,_)),v({equipment:Z}))},O=q=>{const $=I5(q.cost);if(!$){s("Invalid item cost.");return}const{success:Z,newMoney:te}=L5(y.equipment.money,$);if(!Z){s("Not enough money.");return}const ge=wo(y.equipment.inventory,vo(q.name,_));v({equipment:{...y.equipment,inventory:ge,money:te}})},Y=q=>{const $=[...y.equipment.inventory||[]];$.splice(q,1),x($)},G=(((K=y.equipment)==null?void 0:K.inventory)||[]).filter(q=>{var $;return typeof q=="object"&&(($=q.name)==null?void 0:$.toLowerCase().includes(o.search.toLowerCase()))}),B=_.filter(q=>{if(!p)return!1;const $=p.categories.includes(q.category||"");return q.name.toLowerCase().includes(o.search.toLowerCase())&&$}),W=()=>{var $,Z;const q=($=y.equipment)==null?void 0:$.equipped;return!q||!q.armor&&!q.helmet&&(!q.weapons||q.weapons.length===0)?null:a.jsxs("div",{className:"mt-6 pt-4 border-t",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-600 mb-3",children:"Equipped Items"}),a.jsxs("div",{className:"space-y-2",children:[q.armor&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[q.armor," (Armor)"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:Vf,onClick:()=>z("armor",q.armor),disabled:b,children:"Unequip"})]}),q.helmet&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[q.helmet," (Helmet)"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:Vf,onClick:()=>z("helmet",q.helmet),disabled:b,children:"Unequip"})]}),(Z=q.weapons)==null?void 0:Z.map((te,ge)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[te.name," (",te.grip==="Shield"?"Shield":`${te.grip} Weapon`,")"]}),a.jsx(U,{variant:"secondary",size:"xs",icon:Vf,onClick:()=>z("weapon",ge),disabled:b,children:"Unequip"})]},`${te.name}-${ge}`))]})]})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-4 md:p-6 border-b flex-shrink-0 bg-gray-50 rounded-t-lg",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800",children:i.charAt(0).toUpperCase()+i.slice(1)}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:[a.jsx(m4,{className:"w-4 h-4"}),R5(((P=y.equipment)==null?void 0:P.money)||{gold:0,silver:0,copper:0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{size:"sm",variant:i==="inventory"?"primary":"secondary",onClick:()=>l("inventory"),children:"Inventory"}),a.jsx(U,{size:"sm",variant:i==="shop"?"primary":"secondary",onClick:()=>l("shop"),children:"Shop"}),a.jsx(U,{size:"sm",variant:i==="money"?"primary":"secondary",onClick:()=>l("money"),children:"Money"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-800 rounded-full hover:bg-gray-200",children:a.jsx(Rt,{className:"w-5 h-5"})})]})]}),i==="inventory"&&a.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search inventory...",value:o.search,onChange:q=>u({...o,search:q.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]}),(t()||r())&&a.jsx(U,{variant:"secondary",size:"sm",icon:Xt,onClick:()=>f(!0),children:"Custom Item"})]}),i==="shop"&&p&&a.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:Dh,onClick:()=>g(null),children:"Back"}),a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:`Search in ${p.name}...`,value:o.search,onChange:q=>u({...o,search:q.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]})]})]}),a.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto flex-1 bg-white",children:[(k||b)&&a.jsxs("div",{className:"flex justify-center items-center py-10",children:[a.jsx(He,{}),a.jsx("span",{className:"ml-2",children:b?"Saving...":"Loading..."})]}),i==="money"&&!b&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Gold"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("gold",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((N=(X=y.equipment)==null?void 0:X.money)==null?void 0:N.gold)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("gold",1),children:"+"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Silver"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("silver",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((H=(V=y.equipment)==null?void 0:V.money)==null?void 0:H.silver)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("silver",1),children:"+"})]})]}),a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-3 text-center",children:"Copper"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("copper",-1),children:"-"}),a.jsx("span",{className:"text-xl font-bold min-w-[3ch] text-center",children:((he=(j=y.equipment)==null?void 0:j.money)==null?void 0:he.copper)||0}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>A("copper",1),children:"+"})]})]})]})}),i==="shop"&&!b&&(p?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B.map(q=>a.jsxs("div",{className:"flex flex-col p-3 border rounded-lg",children:[a.jsxs("div",{className:"flex-1 mb-2",children:[a.jsx("h4",{className:"font-medium text-sm",children:q.name}),a.jsx("p",{className:"text-xs text-gray-500",children:q.category})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t",children:[a.jsx("span",{className:"text-xs font-semibold text-green-700",children:q.cost||"N/A"}),a.jsx(U,{variant:"primary",size:"xs",onClick:()=>O(q),disabled:!q.cost,children:"Buy"})]})]},q.id))}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:bI.map(q=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-4 border rounded-lg hover:shadow-lg cursor-pointer",onClick:()=>g(q),children:[a.jsx(q.Icon,{className:"w-10 h-10 text-blue-600 mb-2"}),a.jsx("span",{className:"font-medium text-center text-sm",children:q.name})]},q.name))})),i==="inventory"&&!b&&a.jsxs(a.Fragment,{children:[W(),a.jsx("h3",{className:"font-medium text-sm text-gray-600 mt-6 mb-3 pt-4 border-t",children:"Inventory Items"}),a.jsxs("div",{className:"space-y-3",children:[G.map((q,$)=>{var Te,ze,Ze,Ct;const Z=y.equipment.inventory.findIndex(ot=>ot.id===q.id),te=S(q.name),ge=te&&(((Te=te.category)==null?void 0:Te.toUpperCase().includes("WEAPON"))||((ze=te.category)==null?void 0:ze.toUpperCase().includes("ARMOR"))),we=q.quantity>0&&te&&(((Ze=te.category)==null?void 0:Ze.toUpperCase())==="MEDICINE"||((Ct=te.category)==null?void 0:Ct.toUpperCase())==="TRADE GOODS");return a.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between gap-2",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("h3",{className:"font-medium text-sm truncate",children:Eb(q)})}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[we&&a.jsx(U,{variant:"outline",size:"xs",icon:h4,onClick:()=>L(Z),children:"Use"}),ge&&a.jsx(U,{variant:"secondary",size:"xs",icon:Kd,onClick:()=>T(q,Z),children:"Equip"}),a.jsx(U,{variant:"dangerOutline",size:"xs",icon:cr,onClick:()=>Y(Z),children:"Drop"}),((te==null?void 0:te.effect)||(te==null?void 0:te.description))&&a.jsxs("span",{className:"relative group flex items-center",children:[a.jsx(Pn,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full right-0 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity z-20 pointer-events-none",children:[a.jsx("h5",{className:"font-bold mb-1 border-b pb-1",children:te.name}),a.jsx("p",{children:te.effect||te.description}),a.jsxs("p",{className:"mt-1 text-gray-300",children:["W: ",te.weight||"N/A",", Cost: ",te.cost||"N/A"]})]})]})]})]},q.id||`${q.name}-${$}`)}),(((J=y.equipment)==null?void 0:J.inventory)||[]).length===0&&!W()&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Tu,{className:"w-12 h-12 mx-auto text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"Inventory is empty."}),a.jsx(U,{variant:"link",size:"sm",onClick:()=>l("shop"),children:"Go to Shop"})]})]}),h&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-medium",children:"Create Custom Item"}),a.jsx("button",{onClick:()=>f(!1),className:"p-1",children:a.jsx(Rt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1",children:"Name"}),a.jsx("input",{type:"text",value:c.name,onChange:q=>d({...c,name:q.target.value}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Category"}),a.jsx("select",{value:c.category,onChange:q=>d({...c,category:q.target.value}),className:"w-full p-1.5 border rounded text-sm",children:yI.map(q=>a.jsx("option",{value:q,children:q},q))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Cost"}),a.jsx("input",{type:"text",value:c.cost,onChange:q=>d({...c,cost:q.target.value}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:c.weight,onChange:q=>d({...c,weight:Number(q.target.value)}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Quantity"}),a.jsx("input",{type:"number",value:c.quantity,onChange:q=>d({...c,quantity:Math.max(1,Number(q.target.value))}),className:"w-full p-1.5 border rounded text-sm"})]}),a.jsxs("div",{className:"md:col-span-3",children:[a.jsx("label",{className:"block text-xs mb-1",children:"Effect"}),a.jsx("textarea",{value:c.effect,onChange:q=>d({...c,effect:q.target.value}),className:"w-full p-1.5 border rounded text-sm",rows:2})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>f(!1),children:"Cancel"}),a.jsx(U,{variant:"primary",size:"sm",icon:Xt,onClick:R,children:"Add"})]})]})]})]})]})})}const Jf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},wI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,EI=(e,t,r)=>{var l,o;const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=wI(s);return n?i*2:i},NI=e=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[e],kI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}else if(typeof e=="object"&&e!==null)return e;return{}},Nb=e=>e?e.split("(")[0].trim():null,_I=e=>["d4","d6","d8","d10","d12","d20"].includes(e),em=e=>e?Array.isArray(e)?e.join(", "):e:"-";function SI({character:e}){var b,w,_,k,S,A;const{toggleDiceRoller:t}=Mn(),{data:r=[],isLoading:n,error:s}=It({queryKey:["gameItems"],queryFn:uc,staleTime:1e3*60*10}),i=R=>{if(R)return r.find(L=>{var T;return((T=L.name)==null?void 0:T.toLowerCase())===R.toLowerCase()})},l=()=>{var z,O,Y,G;let R=0;const L=(O=(z=e.equipment)==null?void 0:z.equipped)==null?void 0:O.armor,T=(G=(Y=e.equipment)==null?void 0:Y.equipped)==null?void 0:G.helmet;if(L){const B=i(L);R+=Number(B==null?void 0:B.armor_rating)||0}if(T){const B=i(T);R+=Number(B==null?void 0:B.armor_rating)||0}return R},o=(R,L)=>{const T=L==null?void 0:L.match(/(\d+)?d(\d+)/i);let z=["d6"],O="1d6";if(T){const V=T[1]?parseInt(T[1],10):1,H=`d${T[2]}`;_I(H)&&(z=Array(V).fill(H),O=`${V}d${T[2]}`)}let Y="",G=null;const B=i(R),W=B==null?void 0:B.skill,K=Nb(W),P=K?Jf[K]:null;P==="STR"?e.attributes.STR>15?(Y="d6",G="d6"):e.attributes.STR>12&&(Y="d4",G="d4"):P==="AGL"&&(e.attributes.AGL>15?(Y="d6",G="d6"):e.attributes.AGL>12&&(Y="d4",G="d4"));let X=O;Y&&(X+=` + ${Y}`);const N=[...z];G&&N.push(G),t({rollMode:"attackDamage",initialDice:N,description:`Damage roll for ${R} (${X})`})},u=(R,L,T)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:L,description:`${R} Check`,requiresBane:T,skillName:R})},c=l(),d=((w=(b=e.equipment)==null?void 0:b.equipped)==null?void 0:w.weapons)||[],h=kI(e.skill_levels),f=(k=(_=e.equipment)==null?void 0:_.equipped)==null?void 0:k.armor,p=(A=(S=e.equipment)==null?void 0:S.equipped)==null?void 0:A.helmet,g=f?i(f):void 0,y=p?i(p):void 0,v=g?em(g.features):"-",x=y?em(y.features):"-";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[" ",a.jsx(Cs,{className:"w-5 h-5 text-blue-600"})," Armor"]}),n?a.jsx(He,{size:"sm"}):s?a.jsx(Ne,{message:"Could not load item details for armor."}):a.jsxs("div",{className:"space-y-3",children:[" ",a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Body:"})," ",(g==null?void 0:g.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(g==null?void 0:g.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",g.armor_rating,")"]})]}),g&&g.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(Ky,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:v})]})]}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Helmet:"})," ",(y==null?void 0:y.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(y==null?void 0:y.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",y.armor_rating,")"]})]}),y&&y.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(Ky,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:x})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium mt-2",children:[a.jsx(Cs,{className:"w-4 h-4"}),a.jsxs("span",{children:["Total Armor Rating: ",c]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[a.jsx(xi,{className:"w-5 h-5 text-red-600"})," Weapons"]}),n?a.jsx(He,{size:"sm"}):s?a.jsx(Ne,{message:"Could not load item details for weapons."}):d.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No weapons equipped."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Weapon / Shield"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Grip"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Range"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Damage"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Features"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:d.map((R,L)=>{var K;const T=i(R.name),z=T==null?void 0:T.skill,O=Nb(z);let Y=null,G=!1,B=null;if(O&&Jf[O]){B=Jf[O],Y=(h==null?void 0:h[O])??EI(e,O,B);const P=NI(B);G=((K=e.conditions)==null?void 0:K[P])??!1}const W=em(R.features);return a.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:R.name}),a.jsx("td",{className:"px-4 py-2",children:R.grip||"-"}),a.jsx("td",{className:"px-4 py-2",children:R.range||"-"}),a.jsx("td",{className:"px-4 py-2",children:R.damage||"-"}),a.jsx("td",{className:"px-4 py-2",children:W}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[R.damage?a.jsxs(U,{variant:"link",size:"xs",onClick:()=>o(R.name,R.damage),className:"text-red-600 hover:text-red-800 font-medium p-0 flex items-center gap-1",title:`Roll damage for ${R.name} (${R.damage})`,children:[a.jsx(ur,{className:"w-3 h-3"}),"Damage"]}):null,O&&Y!==null?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(U,{variant:"link",size:"xs",onClick:()=>u(O,Y,G),className:`${G?"text-red-600 hover:text-red-800":"text-indigo-600 hover:text-indigo-800"} font-medium p-0 flex items-center gap-1`,title:`Roll ${O} check (Target  ${Y}${G?", Bane":""})`,children:[a.jsx(ur,{className:"w-3 h-3"}),O,": ",Y]}),G&&a.jsx("span",{className:"text-xs text-red-500 font-semibold",children:"(Bane)"})]}):z?a.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Skill '${z}' not found or level unavailable.`,children:["(",O||z," N/A)"]}):null]})})]},`${R.name}-${L}`)})})]})})]})]})}function Ag(e){return typeof e!="object"||e===null||Array.isArray(e)?!1:Object.values(e).every(t=>typeof t=="number"||t===null)}function kb(e){return typeof e!="object"||e===null?!1:typeof e.skill_id=="string"&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}const TI=e=>Object.entries(e).map(([t,r])=>r!==null?`${t} (Level ${r})`:t).join(", "),CI=e=>e?typeof e=="string"?e:Ag(e)?TI(e):typeof e=="object"?(console.warn("Unexpected requirement object format:",e),`Requires: ${Object.keys(e).join(", ")}`):(console.warn("Unexpected requirement type:",typeof e,e),"Unknown requirement format"):null;function jI({onClose:e}){const{character:t,allHeroicAbilities:r,isLoading:n,error:s,updateCharacterData:i,isSaving:l,setActiveStatusMessage:o}=rr(),[u,c]=E.useState(null);if(!t)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6",children:[a.jsx(He,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]})});const d=E.useMemo(()=>{if(!r||!t||!t.heroic_abilities)return[];const g=new Set(Array.isArray(t.heroic_abilities)?t.heroic_abilities:[]);return r.filter(y=>g.has(y.name))},[r,t]),h=async g=>{c(null);const y=g.willpower_cost,v=t.current_wp;if(y===null||y<=0){o(`Used Heroic Ability: ${g.name}`);return}if(typeof v!="number"){const x=`Cannot activate ${g.name}: Current Willpower is invalid.`;c(x);return}if(v>=y){const x=v-y;try{await i({current_wp:x}),o(`Used Heroic Ability: ${g.name} for ${y} WP.`)}catch(b){c(`Failed to update Willpower: ${b.message}`)}}else c(`Not enough Willpower. Required: ${y}, Available: ${v}`)},f=()=>n?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx(He,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]}):s?a.jsx("div",{className:"p-6",children:a.jsx(Ne,{message:`Failed to load required data: ${s}`})}):t.profession==="Mage"?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Magic Instead of Heroic Abilities"}),a.jsx("p",{className:"text-sm text-blue-700",children:"As a mage, you use magic instead of heroic abilities. Check the Spells tab to manage your capabilities."})]})]})}):d.length===0?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx(Pn,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"No Heroic Abilities Assigned"}),a.jsx("p",{className:"text-sm text-gray-700",children:"This character does not currently have any heroic abilities assigned."})]})]})}):a.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[u&&a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(AE,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800",children:"Activation Failed"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(g=>{const y=g.willpower_cost,v=t.current_wp,x=y===null||y<=0||typeof v=="number"&&v>=y,b=CI(g.requirement);return a.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:g.name}),a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded-full",children:y!==null&&y>0?a.jsxs(a.Fragment,{children:[a.jsx(lc,{className:"w-4 h-4 text-amber-500"}),a.jsxs("span",{children:[y," WP"]})]}):a.jsx("span",{className:"text-green-600",children:"Free"})})]}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:g.description}),b&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Requirement: ",b]})]}),a.jsxs(U,{onClick:()=>h(g),disabled:!x||l,loading:l,variant:x?"default":"secondary",size:"sm",className:"w-full mt-4",children:[a.jsx(In,{className:"w-4 h-4 mr-2"}),"Activate ",y!==null&&y>0?`(${y} WP)`:""]})]},g.id)})})]}),p=typeof t.current_wp=="number"?t.current_wp:"N/A";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(Bh,{className:"w-6 h-6 text-blue-600"}),"Heroic Abilities"]}),a.jsxs("p",{className:"text-gray-600",children:["Available Willpower: ",p," WP"]})]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-3xl leading-none","aria-label":"Close",children:""})]}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:f()}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(U,{variant:"outline",onClick:e,children:"Close"})})]})})}async function AI(){const{data:e,error:t}=await re.from("heroic_abilities").select(`
      id,
      name,
      description,
      willpower_cost,
      requirement,
      kin,        
      profession  
    `);if(t)throw console.error("Error fetching heroic abilities:",t),new Error(t.message||"Failed to fetch heroic abilities");return(e||[]).map(n=>({id:n.id,name:n.name,description:n.description,willpower_cost:n.willpower_cost,requirement:n.requirement,kin:n.kin,profession:n.profession}))}const iN={Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},os=e=>{const t=rr.getState().character,r=(t==null?void 0:t.skill_levels)||{};return(r==null?void 0:r[e])??0};function II(e){var s;const t={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",...iN},r=[],n=e.skill_levels||{};for(const i in n){const l=t[i];if(!l){console.warn(`[AdvancementSystem] Skill "${i}" exists on character but is missing from the attribute map.`);continue}const o=n[i],u=((s=e.trainedSkills)==null?void 0:s.includes(i))??!1;r.push({name:i,attribute:l,level:o,isTrained:u})}return r.sort((i,l)=>i.name.localeCompare(l.name)),r}const RI=(e,t)=>{var l,o;if(!t)return!1;if(!e.requirement)return!0;const r=e.requirement,n=t.attributes,s=t.skill_levels||{},i=Object.fromEntries(Object.entries(n).map(([u,c])=>[u.toUpperCase(),c]));if(typeof r=="string"){const u=r.split(" ");if(u.length===2){const c=u[0].toUpperCase(),d=parseInt(u[1],10);if(!isNaN(d)){if(c in i)return i[c]>=d;const h=(l=Object.entries(s).find(([f])=>f.toUpperCase()===c))==null?void 0:l[1];if(h!==void 0)return h>=d}}return!1}else if(typeof r=="object"&&r!==null){for(const[u,c]of Object.entries(r)){if(c==null)continue;const d=u.toUpperCase();if(d in i){if(i[d]<c)return!1}else{const h=(o=Object.entries(s).find(([f])=>f.toUpperCase()===d))==null?void 0:o[1];if(h===void 0||h<c)return!1}}return!0}return!1},lN=e=>{var n;if(!e)return[];const t=((n=e.school)==null?void 0:n.spells)??[],r=e.general??[];return Array.from(new Set([...t,...r].map(s=>s.toUpperCase())))},LI=(e,t,r,n)=>{if(!e)return!0;const s=lN(t.spells),i=t.skill_levels||{},l=t.attributes,o=y=>{let v=!1;switch(y.type){case"spell":v=s.includes(y.name.toUpperCase());break;case"school":v=(r==null?void 0:r.toUpperCase())===y.name.toUpperCase();break;case"anySchool":v=!!t.magicSchool;break;case"skill":const x=i[y.name];v=x!==void 0&&x>=y.value;break;case"attribute":const b=l[y.name.toUpperCase()];v=b!==void 0&&b>=y.value;break}return y.negate?!v:v};let u;const c=y=>{const v=y.operator.toUpperCase();if(v==="AND"){const x=y.conditions.every(b=>u(b));return y.negate?!x:x}else if(v==="OR"){const x=y.conditions.some(b=>u(b));return y.negate?!x:x}return!1};u=y=>"operator"in y?c(y):o(y);let d=null;try{e.trim().startsWith("{")&&(d=JSON.parse(e))}catch{}if(d)return u(d);const h=n.map(y=>y.name.toUpperCase()),f=r,p=y=>{const v=y.trim().toUpperCase();if(v==="ANY SCHOOL OF MAGIC")return!!t.magicSchool;if(s.includes(v))return!0;if(h.includes(v))return(f==null?void 0:f.toUpperCase())===v;const x=v.split(" ");if(x.length===2){const[b,w]=x,_=parseInt(w,10);if(!isNaN(_)){const k=Object.keys(l).find(A=>A.toUpperCase()===b);if(k)return l[k]>=_;const S=Object.keys(i).find(A=>A.toUpperCase()===b);if(S)return i[S]>=_}}return!1},g=y=>y.trim().split(/ AND /i).every(p);return e.trim().split(/ OR /i).some(g)};function OI({character:e,onClose:t}){var Da;const{character:r,markedSkillsThisSession:n,clearMarkedSkillsThisSession:s,increaseSkillLevel:i,addHeroicAbility:l,increaseMaxStat:o,setSkillUnderStudy:u,learnSpell:c,addMagicSchool:d,isSaving:h,saveError:f}=rr(),{toggleDiceRoller:p}=Mn(),[g,y]=E.useState(!1),[v,x]=E.useState(null),[b,w]=E.useState("initial"),[_,k]=E.useState(null),[S,A]=E.useState(0),[R,L]=E.useState(new Set),[T,z]=E.useState([]),[O,Y]=E.useState(0),[G,B]=E.useState(null),[W,K]=E.useState(null),[P,X]=E.useState([]),[N,V]=E.useState(!1),[H,j]=E.useState(null),[he,J]=E.useState(null),[q,$]=E.useState(null),[Z,te]=E.useState(null),[ge,we]=E.useState([]),[Te,ze]=E.useState([]),[Ze,Ct]=E.useState([]),[ot,pt]=E.useState(null),[Ye,pn]=E.useState(null),[at,as]=E.useState(!1),pr=r||e,Ie=E.useMemo(()=>pr?II(pr):[],[pr]),tt=(Da=r==null?void 0:r.teacher)==null?void 0:Da.skillUnderStudy,ji=()=>{k(null),B(null),$(null),A(0),L(new Set),z([]),Y(0),K(null),j(null),J(null),Ct([]),pt(null),pn(null),as(!1),V(!1)},se=()=>{ji(),w("enterMarks")},de=()=>{ji(),w("selectStudyType")},je=async()=>{if(!r||!r.magicSchool){k("Character has no magic school assigned."),w("selectStudyType");return}as(!0),k(null);try{let fe=Te.length>0?Te:await zp();Te.length===0&&ze(fe);let Se=ge.length>0?ge:await B6();ge.length===0&&we(Se);const Le=fe.find(Ut=>Ut.id===r.magicSchool.id),rt=Le?Le.name:null;te(rt);const ct=lN(r.spells),lt=Se.filter(Ut=>!ct.includes(Ut.name.toUpperCase())&&LI(Ut.prerequisite,r,rt,fe));Ct(lt),w("studyMagicSelectSpell")}catch(fe){console.error("Error loading magic data:",fe),k(fe instanceof Error?fe.message:"Failed to load magic study data."),w("selectStudyType")}finally{as(!1)}},Re=async fe=>{if(fe==="teacher")w("studyTeacherSelectSkill");else if(fe==="magic")je();else if(fe==="learnSchool"){as(!0),k(null);try{const Se=await zp();ze(Se),w("studyMagicSelectSchool")}catch(Se){console.error("Error loading magic schools:",Se),k(Se instanceof Error?Se.message:"Failed to load magic schools.")}finally{as(!1)}}},Je=fe=>{if(fe.preventDefault(),S>0){const Se=new Set;let Le=0;const rt=Ie.map(ct=>ct.name);for(const ct of n)Le<S&&rt.includes(ct)&&(Se.add(ct),Le++);L(Se),k(null),w("selectSkills")}else k("Please enter at least one Advancement Mark.")},gr=fe=>{L(Se=>{const Le=new Set(Se);return Le.has(fe)?Le.delete(fe):Le.size<S&&Le.add(fe),Le})},gn=()=>{if(R.size!==S){k(`Please select exactly ${S} skill(s).`);return}k(null),z(Array.from(R)),Y(0),B(null),w("rollSkills")},Vt=E.useCallback(async(fe,Se,Le)=>{const rt=Le==="study"?$:B,ct=os(fe);let lt=`Manual result for ${fe}: `;if(Se){lt+="Success! Skill increased.",await i(fe);const Ut=os(fe);lt+=` New Level: ${Ut}.`,Ut===18&&ct<18&&(Le==="endSession"&&K(fe),lt+=" Reached level 18!")}else lt+="Failure. Skill did not increase.";rt(lt)},[i]),xn=E.useCallback(async fe=>{if(!r||!fe.results||fe.results.length===0){B("Error: Roll failed due to missing data."),p();return}const{value:Se}=fe.results[0],{skillName:Le,targetValue:rt}=fe;if(!Le||rt===void 0){B("Error: Roll context missing skill information."),p();return}const ct=Se>rt;let lt=`Rolled ${Se} vs ${Le} (Target > ${rt}). `;await Vt(Le,ct,"endSession"),B(Ut=>lt+(Ut||"")),p()},[r,Vt,p]),nr=(fe,Se)=>{const Le=os(fe),rt=Se==="study"?$:B;if(Le>=18){rt(`Skill ${fe} is already at max level (18).`);return}rt(null),p({rollMode:"advancementRoll",targetValue:Le,skillName:fe,description:`Advancement Roll: ${fe} (D20 vs > ${Le})`,onRollComplete:Se==="study"?et:xn})},Nt=(fe,Se)=>{const Le=os(fe),rt=Se==="study"?$:B;if(Le>=18){rt(`Skill ${fe} is already at max level (18).`);return}x({skillName:fe,context:Se}),y(!0)},Xr=async fe=>{if(!v)return;const{skillName:Se,context:Le}=v;y(!1),await Vt(Se,fe,Le),x(null)},_r=()=>{B(null),W?(tf(),w("selectAbility")):O<T.length-1?Y(fe=>fe+1):Jr()},tf=async()=>{V(!0),k(null);try{const fe=await AI(),Se=rr.getState().character;if(!Se)throw new Error("Character data not available for ability filtering.");const Le=new Set((Se.heroic_abilities||[]).map(lt=>lt.toUpperCase())),rt=new Set(["ROBUST","FOCUSED","MAGIC TALENT"]),ct=fe.filter(lt=>{var en,is;const Ut=lt.name.toUpperCase(),Fr=rt.has(Ut);return(!lt.kin||lt.kin.toLowerCase()===((en=Se.kin)==null?void 0:en.toLowerCase()))&&(!lt.profession||lt.profession.toLowerCase()===((is=Se.profession)==null?void 0:is.toLowerCase()))&&RI(lt,Se)?Fr||!Le.has(Ut):!1});X(ct)}catch(fe){console.error("Error fetching abilities:",fe),k(fe instanceof Error?fe.message:"Failed to load heroic abilities.")}finally{V(!1)}},rf=fe=>{j(fe)},nf=async()=>{if(!H){k("Please select a heroic ability.");return}k(null),await l(H.name);const fe=H.name.toUpperCase();fe==="ROBUST"?await o("max_hp",2):fe==="FOCUSED"&&await o("max_wp",2),K(null),j(null),O<T.length-1?(Y(Se=>Se+1),w("rollSkills")):Jr()},Jr=()=>{s(),w("finished")},yc=fe=>{J(fe)},Pa=async()=>{if(!he){k("Please select a skill to study.");return}k(null),$(null),await u(he),w("studyTeacherRollSkill")},et=E.useCallback(async fe=>{if(!r||!fe.results||!fe.results.length){$("Error: Roll failed due to missing data."),p();return}const{value:Se}=fe.results[0],{skillName:Le,targetValue:rt}=fe;if(!Le||rt===void 0){$("Error: Roll context missing skill information."),p();return}const ct=Se>rt;let lt=`Studied ${Le}. Rolled ${Se} vs Target > ${rt}. `;await Vt(Le,ct,"study"),$(Ut=>lt+(Ut||"")),p()},[r,Vt,p]),gt=E.useCallback(async fe=>{var lt;if(!r||!((lt=fe.results)!=null&&lt.length)||!Ye){$("Error: Roll failed due to missing data."),p();return}const{value:Se}=fe.results[0],Le=fe.targetValue;if(Le===void 0){$("Error: Character INT value not found for roll."),p();return}const rt=Se>Le;let ct=`Attempting to learn ${Ye.name}. Rolled ${Se} vs INT > ${Le}. `;rt?(ct+=`Success! You have learned the basics of ${Ye.name}. The skill is added at your base chance of ${Le}.`,await d(Ye,Le)):ct+="Failure. You must study for another week to try again.",$(ct),p()},[r,Ye,d,p]),Un=()=>{if(!r||!Ye)return;const fe=r.attributes.INT;$(null),p({rollMode:"advancementRoll",targetValue:fe,skillName:`Learn ${Ye.name}`,description:`Learn Magic School: ${Ye.name} (D20 vs > ${fe})`,onRollComplete:gt})},sf=async()=>{if(!r||!Ye)return;const fe=r.attributes.INT;$(null);let Se=`Manually learned ${Ye.name}. Success! The skill is added at your base chance of ${fe}.`;await d(Ye,fe),$(Se)},af=fe=>{pt(fe)},lf=async()=>{if(!ot){k("Please select a spell to learn.");return}k(null);try{await c(ot),t()}catch(fe){console.error("Error learning spell:",fe),k(fe instanceof Error?fe.message:"Failed to learn the spell.")}},bc=()=>{J(null),$(null),pt(null),pn(null),Ct([]),t()},of=()=>{var fe;if(!pr&&b!=="initial")return a.jsx(He,{text:"Loading character data..."});switch(b){case"initial":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Choose an action to proceed."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(U,{onClick:se,className:"flex-1",children:[a.jsx(Lo,{className:"w-5 h-5 mr-2"})," End Session & Advance"]}),a.jsxs(U,{onClick:de,variant:"outline",className:"flex-1",children:[a.jsx(cl,{className:"w-5 h-5 mr-2"})," Study"]})]})]});case"enterMarks":return a.jsxs("form",{onSubmit:Je,className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"End Session Advancement"}),a.jsx("label",{htmlFor:"advancementMarks",className:"block font-medium text-gray-700",children:"How many Advancement Marks did you gain this session?"}),a.jsx("input",{type:"number",id:"advancementMarks",name:"advancementMarks",min:"1",value:S===0?"":S,onChange:ie=>A(parseInt(ie.target.value,10)||0),className:"w-full p-2 border rounded focus:ring-blue-500 focus:border-blue-500",required:!0}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>w("initial"),children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{type:"submit",disabled:S<=0,children:["Next ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]});case"selectSkills":return pr?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Select ",S," skill(s) to attempt advancement:"]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:Ie.length===0?a.jsx("p",{className:"text-gray-500 italic",children:"No skills found for this character."}):Ie.map(ie=>{const Bt=os(ie.name),Ur=Bt>=18,Fa=ie.name===tt;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Ur?"opacity-60 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",checked:R.has(ie.name),onChange:()=>gr(ie.name),disabled:Ur||!R.has(ie.name)&&R.size>=S,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${ie.isTrained?"font-semibold":""}`,children:ie.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",ie.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Bt]}),Ur&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"}),n.has(ie.name)&&!Ur&&a.jsx(lc,{className:"w-4 h-4 text-yellow-500 flex-shrink-0",title:"Marked this session (rolled 1 or 20)"}),Fa&&a.jsx(Lo,{className:"w-4 h-4 text-purple-600 flex-shrink-0 ml-1",title:"Currently studying with teacher"})]},ie.name)})}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",R.size," / ",S]}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>w("enterMarks"),children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:gn,disabled:R.size!==S,children:["Confirm Selection ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]}):a.jsx(He,{});case"rollSkills":if(T.length===0||!pr)return a.jsx(He,{text:"Preparing skill roll..."});const Se=T[O],Le=os(Se),rt=Le>=18,ct=!!G;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Attempting Advancement (",O+1," / ",T.length,")"]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Se}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Le]}),rt&&!ct&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Skipped."})]}),G&&a.jsx("div",{className:`p-3 rounded border text-center ${G.includes("Success")?"bg-green-50 border-green-200 text-green-800":G.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:G}),f&&a.jsx(Ne,{message:f}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!ct&&!rt&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:()=>nr(Se,"endSession"),disabled:h,loading:h,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Roll (D20 vs ",">"," ",Le,")"]}),a.jsxs(U,{variant:"outline",onClick:()=>Nt(Se,"endSession"),disabled:h,loading:h,children:[a.jsx(In,{className:"w-4 h-4 mr-1"})," Enter Manual Result"]})]}),(ct||rt&&!ct)&&a.jsxs(U,{onClick:_r,disabled:h,loading:h,children:[W?"Select Heroic Ability":O<T.length-1?"Next Skill":"Finish Session"," ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectAbility":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 flex items-center gap-2",children:[a.jsx(Mh,{className:"w-5 h-5"})," Skill ",a.jsx("span",{className:"font-bold",children:W})," reached level 18!"]}),a.jsx("p",{className:"text-gray-700",children:"Select a new Heroic Ability:"}),N&&a.jsx(He,{text:"Loading available abilities..."}),_&&a.jsx(Ne,{message:_}),!N&&P.length===0&&!_&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No eligible heroic abilities found for this character."}),!N&&P.length>0&&a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:P.map(ie=>a.jsxs("div",{onClick:()=>rf(ie),className:`p-3 rounded border cursor-pointer ${(H==null?void 0:H.id)===ie.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("p",{className:"font-semibold",children:ie.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ie.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[ie.willpower_cost&&a.jsxs("span",{children:["WP: ",ie.willpower_cost]}),ie.requirement&&typeof ie.requirement=="object"&&Object.keys(ie.requirement).length>0&&a.jsxs("span",{children:["Req: ",Object.entries(ie.requirement).filter(([,Bt])=>Bt!=null).map(([Bt,Ur])=>`${Bt} ${Ur}`).join(", ")]}),ie.requirement&&typeof ie.requirement=="string"&&a.jsxs("span",{children:["Req: ",ie.requirement]})]})]},ie.id))}),f&&a.jsx(Ne,{message:f}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsxs(U,{onClick:nf,disabled:!H||N||h||P.length===0&&!_&&!N,loading:h,children:["Confirm Ability & Continue ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectStudyType":const lt=!!(r!=null&&r.magicSchool),Ut=((fe=r==null?void 0:r.heroic_abilities)==null?void 0:fe.filter(ie=>ie.toUpperCase()==="MAGIC TALENT").length)??0,Fr=Object.keys((r==null?void 0:r.skill_levels)??{}).filter(ie=>iN[ie]).length,nt=Ut>Fr;return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Choose Study Method"}),a.jsx("p",{className:"text-gray-600",children:"How would you like to study to improve a skill or learn magic?"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs(U,{onClick:()=>Re("teacher"),className:"w-full",children:[a.jsx(Lo,{className:"w-5 h-5 mr-2"})," Find a Teacher (Skills)"]}),a.jsxs(U,{onClick:()=>Re("magic"),variant:"outline",className:"w-full",disabled:!lt||at,loading:at,children:[a.jsx(Zd,{className:"w-5 h-5 mr-2"})," Study Magic (Spells)"]}),a.jsxs(U,{onClick:()=>Re("learnSchool"),variant:"outline",className:"w-full sm:col-span-2",disabled:!nt||at,loading:at,children:[a.jsx(cl,{className:"w-5 h-5 mr-2"})," Learn a New Magic School"]})]}),!lt&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Dt,{className:"w-4 h-4 flex-shrink-0"})," Character must belong to a Magic School to study its spells."]}),!nt&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Dt,{className:"w-4 h-4 flex-shrink-0"})," Requires the 'Magic Talent' heroic ability. You must have one use of this ability for each school you wish to learn."]}),_&&a.jsx(Ne,{message:_}),a.jsx("div",{className:"flex justify-start",children:a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>w("initial"),children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]})})]});case"studyTeacherSelectSkill":return pr?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Study with a Teacher"}),a.jsx("p",{className:"text-gray-600",children:"Select one skill to focus on improving. You cannot study a skill currently being studied until it has been advanced or study is completed."}),tt&&a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded text-purple-800 text-sm flex items-center gap-2",children:[a.jsx(Pn,{className:"w-4 h-4 flex-shrink-0"}),"Currently studying: ",a.jsx("span",{className:"font-semibold",children:tt}),". Complete or advance this study first to pick another skill."]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:Ie.map(ie=>{const Bt=os(ie.name),Ur=Bt>=18,Fa=Ur||!!tt&&tt!==ie.name;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Fa?"opacity-60 cursor-not-allowed":he===ie.name?"bg-blue-100 border border-blue-300":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"radio",name:"studySkill",checked:he===ie.name,onChange:()=>yc(ie.name),disabled:Fa,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${ie.isTrained?"font-semibold":""}`,children:ie.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",ie.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",Bt]}),Ur&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"})]},ie.name)})}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>w("selectStudyType"),children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:Pa,disabled:!he||!!tt||h,loading:h,children:["Confirm Study Skill ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]}):a.jsx(He,{});case"studyTeacherRollSkill":const en=tt||he;if(!en||!pr)return a.jsx(Ne,{message:"Error: No skill selected or found for study, or character data missing."});const is=os(en),Ai=is>=18,Ma=!!q;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: ",en]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:en}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",is]}),Ai&&!Ma&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Study complete."})]}),q&&a.jsx("div",{className:`p-3 rounded border text-center ${q.includes("Success")?"bg-green-50 border-green-200 text-green-800":q.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:q}),f&&a.jsx(Ne,{message:f}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Ma&&!Ai&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:()=>nr(en,"study"),disabled:h,loading:h,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Roll (D20 vs ",">"," ",is,")"]}),a.jsxs(U,{variant:"outline",onClick:()=>Nt(en,"study"),disabled:h,loading:h,children:[a.jsx(In,{className:"w-4 h-4 mr-1"})," Enter Manual Result"]})]}),(Ma||Ai&&!Ma)&&a.jsxs(U,{onClick:bc,disabled:h,loading:h,children:["Finish Study ",a.jsx(Ka,{className:"w-4 h-4 ml-1"})]})]}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSpell":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(Zd,{className:"w-5 h-5 text-purple-600"})," Study Magic (Spells)"]}),Z&&a.jsxs("p",{className:"text-gray-600",children:["School: ",a.jsx("span",{className:"font-semibold",children:Z})]}),a.jsx("p",{className:"text-gray-600",children:"Select a spell to learn:"}),at&&a.jsx(He,{text:"Loading spells..."}),_&&a.jsx(Ne,{message:_}),!at&&Ze.length===0&&!_&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No new spells available to learn at this time, or prerequisites not met."}),!at&&Ze.length>0&&a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:Ze.map(ie=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(ot==null?void 0:ot.id)===ie.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSpell",checked:(ot==null?void 0:ot.id)===ie.id,onChange:()=>af(ie),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-semibold",children:[ie.name," ",a.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(Rank ",ie.rank??"N/A",")"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ie.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[ie.casting_time&&a.jsxs("span",{children:["Cast: ",ie.casting_time]}),ie.range&&a.jsxs("span",{children:["Range: ",ie.range]}),ie.duration&&a.jsxs("span",{children:["Duration: ",ie.duration]}),ie.willpower_cost&&a.jsxs("span",{children:["WP: ",ie.willpower_cost]}),ie.prerequisite&&a.jsxs("span",{className:"italic",children:["(Learn Req: ",ie.prerequisite,")"]}),ie.casting_requirement&&a.jsxs("span",{className:"italic",children:["(Cast Req: ",ie.casting_requirement,")"]})]})]})]},ie.id))}),f&&a.jsx(Ne,{message:f}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>{w("selectStudyType"),k(null)},children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:lf,disabled:!ot||at||h||Ze.length===0&&!_&&!at,loading:h,children:["Learn Selected Spell ",a.jsx(Ka,{className:"w-4 h-4 ml-1"})]})]}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSchool":const M=Object.keys((r==null?void 0:r.skill_levels)??{}),me=Te.filter(ie=>!M.includes(ie.name));return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(cl,{className:"w-5 h-5 text-purple-600"})," Learn a New Magic School"]}),a.jsx("p",{className:"text-gray-600",children:"Select a school of magic to study for a week. At the end of the week, you will roll against your INT to learn it."}),_&&a.jsx(Ne,{message:_}),!at&&me.length===0&&!_&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"There are no new magic schools available for you to learn."}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:me.map(ie=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(Ye==null?void 0:Ye.id)===ie.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSchool",checked:(Ye==null?void 0:Ye.id)===ie.id,onChange:()=>pn(ie),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("p",{className:"font-semibold",children:ie.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:ie.description})]})]},ie.id))}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(U,{type:"button",variant:"secondary",onClick:()=>{w("selectStudyType"),k(null)},children:[a.jsx(Pi,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(U,{onClick:()=>w("studyMagicRollSchool"),disabled:!Ye||h,loading:h,children:["Begin Study ",a.jsx(Vs,{className:"w-4 h-4 ml-1"})]})]})]});case"studyMagicRollSchool":if(!Ye||!r)return a.jsx(Ne,{message:"Error: No magic school selected or character data missing."});const Ee=r.attributes.INT,Be=!!q;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: Learn ",Ye.name]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:Ye.name}),a.jsxs("p",{className:"text-gray-600",children:["You must roll greater than your Intelligence (",Ee,") on a D20 to succeed."]})]}),q&&a.jsx("div",{className:`p-3 rounded border text-center ${q.includes("Success")?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:q}),f&&a.jsx(Ne,{message:f}),_&&a.jsx(Ne,{message:_}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!Be&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:Un,disabled:h,loading:h,children:[a.jsx(ur,{className:"w-4 h-4 mr-1"})," Roll (D20 vs ",">"," ",Ee,")"]}),a.jsxs(U,{variant:"outline",onClick:sf,disabled:h,loading:h,children:[a.jsx(In,{className:"w-4 h-4 mr-1"})," Succeed Manually"]})]}),Be&&a.jsxs(U,{onClick:bc,disabled:h,loading:h,children:["Finish ",a.jsx(Ka,{className:"w-4 h-4 ml-1"})]})]}),h&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"finished":return a.jsxs("div",{className:"text-center space-y-4 p-6 bg-green-50 rounded border border-green-200",children:[a.jsx(Ka,{className:"w-12 h-12 text-green-500 mx-auto"}),a.jsx("h4",{className:"text-xl font-semibold text-green-800",children:"Session Ended & Advancement Complete!"}),a.jsx("p",{className:"text-gray-700",children:"Character data has been updated. Marked skills for this session have been cleared."}),a.jsx(U,{onClick:t,children:"Done"})]});default:const dt=b;return a.jsxs("p",{children:["Unknown step: ",dt]})}},vc=()=>{if(!g||!v)return null;const{skillName:fe}=v,Se=os(fe);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-sm w-full p-6 shadow-xl",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Manual Advancement for ",a.jsx("span",{className:"text-blue-600",children:fe})]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2 mb-4",children:["A success is counted when the D20 roll is ",a.jsx("span",{className:"font-bold",children:"greater than"})," the skill's current level of ",a.jsx("span",{className:"font-bold",children:Se}),"."]}),a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs(U,{onClick:()=>Xr(!0),disabled:h,loading:h,className:"w-full",children:[a.jsx(z4,{className:"w-4 h-4 mr-2"})," Success"]}),a.jsxs(U,{onClick:()=>Xr(!1),disabled:h,loading:h,variant:"outline",className:"w-full",children:[a.jsx($4,{className:"w-4 h-4 mr-2"})," Failure"]})]}),a.jsx("div",{className:"mt-4 text-center",children:a.jsx("button",{onClick:()=>y(!1),className:"text-xs text-gray-500 hover:text-gray-700",children:"Cancel"})})]})})};return a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4 sticky top-0 bg-white z-10",children:[a.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(Lo,{className:"w-6 h-6 text-blue-600"}),"Character Advancement"]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600","aria-label":"Close advancement modal",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-6",children:of()})]}),vc()]})}function PI({character:e}){const{toggleDiceRoller:t}=Mn(),{setDeathRollState:r,adjustStat:n,isSaving:s}=rr(),[i,l]=E.useState(!1),[o,u]=E.useState(null),c=e.death_rolls_passed??0,d=e.death_rolls_failed??0,h=e.is_rallied??!1,f=e.attributes.CON,p=e.attributes.WIL,g=c>=3,y=d>=3,v=L=>{l(!1);const T=L.results[0].value,z=L.isCritical&&L.isSuccess,O=L.isCritical&&!L.isSuccess,Y=L.isSuccess;let G=c,B=d;z?(G+=2,u(`Rolled ${T} (Dragon! +2 Successes)`)):O?(B+=2,u(`Rolled ${T} (Demon! +2 Failures)`)):Y?(G+=1,u(`Rolled ${T} (Success vs CON ${f})`)):(B+=1,u(`Rolled ${T} (Failure vs CON ${f})`)),r(G,B,h),t()},x=L=>{l(!1);const T=L.results[0].value;L.isSuccess?(r(c,d,!0),u(`Rallied! (Rolled ${T} vs WIL ${p} w/ Bane)`)):(r(c,d,!1),u(`Rally Failed (Rolled ${T} vs WIL ${p} w/ Bane)`)),t()},b=L=>{l(!1);const T=L.results[0].value;u(`Recovered ${T} HP!`),n("current_hp",T),t()},w=()=>{i||g||y||(l(!0),u(null),t({rollMode:"deathRoll",targetValue:f,description:`Death Save (d20 vs CON ${f})`,onRollComplete:v}))},_=()=>{i||h||g||y||(l(!0),u(null),t({rollMode:"rallyRoll",targetValue:p,requiresBane:!0,description:`Rally Self (d20 vs WIL ${p}, Bane)`,onRollComplete:x}))},k=()=>{i||!g||y||(l(!0),u(null),t({rollMode:"recoveryRoll",description:"Recovery Roll (1d6 HP)",onRollComplete:b}))},S=L=>{if(g||y||s)return;const T=Math.max(0,Math.min(3,c+L));r(T,d,h)},A=L=>{if(g||y||s)return;const T=Math.max(0,Math.min(3,d+L));r(c,T,h)},R=(L,T,z,O,Y,G)=>a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(O,{className:`w-4 h-4 sm:w-5 sm:h-5 ${Y}`}),a.jsxs("span",{className:"font-medium text-xs sm:text-sm w-16 sm:w-20",children:[L,":"]}),a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{onClick:()=>G(-1),disabled:T===0||g||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Decrease ${L}`,children:a.jsx(SE,{className:"w-3 h-3"})}),[...Array(z)].map((B,W)=>a.jsx("div",{className:`w-3 h-3 sm:w-4 sm:h-4 rounded-full border ${W<T?L==="Successes"?"bg-green-500 border-green-600":"bg-red-500 border-red-600":"bg-gray-200 border-gray-300"}`},W)),a.jsx("button",{onClick:()=>G(1),disabled:T===z||g||y||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Increase ${L}`,children:a.jsx(Xt,{className:"w-3 h-3"})})]})]});return a.jsxs("div",{className:"p-3 rounded-lg shadow bg-red-50 border border-red-300 space-y-2",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm text-red-700",children:[a.jsx(Qd,{className:"w-4 h-4 text-red-600 animate-pulse"}),"DYING (",e.current_hp," HP)"]}),a.jsxs("div",{className:"space-y-1",children:[R("Successes",c,3,sc,"text-green-500",S),R("Failures",d,3,dl,"text-red-500",A)]}),o&&a.jsx("p",{className:"text-xs text-center text-gray-700 italic",children:o}),h&&!g&&!y&&a.jsxs("p",{className:"text-xs text-center text-yellow-800 bg-yellow-100 p-1 rounded border border-yellow-200 flex items-center justify-center gap-1",children:[a.jsx(Pn,{className:"w-3 h-3"})," Rallied! Can act, but still dying."]}),a.jsx("div",{className:"pt-1 space-y-2",children:y?a.jsx("div",{className:"text-center font-bold text-lg text-red-800 p-2 bg-red-200 rounded",children:"CHARACTER DIED"}):g?a.jsxs(U,{onClick:k,disabled:i||s,loading:i||s,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[a.jsx(kg,{className:"w-4 h-4 mr-1"})," Roll Recovery (1d6 HP)"]}):a.jsxs(a.Fragment,{children:[a.jsxs(U,{onClick:w,disabled:i||s,loading:i||s,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"sm",children:[a.jsx(Qd,{className:"w-4 h-4 mr-1"})," Roll Death Save (d20)"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(U,{onClick:_,disabled:i||s||h,loading:i||s,className:`w-full text-black ${h?"bg-gray-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,size:"sm",children:[a.jsx(IE,{className:"w-4 h-4 mr-1"})," ",h?"Rallied!":"Attempt Rally (Self)"]}),!h&&a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 p-2 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none",children:["Roll d20 vs WIL (",p,") with Bane. Success lets you act while dying.",a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-black rotate-45"})]})]})]})}),s&&a.jsx("div",{className:"text-xs text-center text-blue-600 italic mt-1",children:"Saving..."})]})}function DI(){const e=rr(r=>r.activeStatusMessage),t=rr(r=>r.clearActiveStatusMessage);return e?a.jsxs("div",{className:"my-3 p-3 bg-blue-100 border border-blue-300 rounded-lg shadow-sm flex items-center justify-between animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(In,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsxs("p",{className:"text-sm text-blue-800",children:["Activated: ",a.jsx("span",{className:"font-semibold",children:e})]})]}),a.jsx("button",{onClick:t,className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full transition-colors","aria-label":"Dismiss status message",children:a.jsx(Rt,{className:"w-4 h-4"})})]}):null}const tm=({label:e,value:t})=>a.jsxs("div",{children:[a.jsx("dt",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:e}),a.jsx("dd",{className:"text-base text-gray-900",children:t||a.jsx("span",{className:"text-gray-400 italic",children:"N/A"})})]}),rm=({label:e,children:t,icon:r})=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[a.jsx(r,{className:"w-4 h-4 text-gray-500"}),e]}),t]});function MI({onClose:e}){const{character:t,updateCharacterData:r,isSaving:n,saveError:s}=rr(),[i,l]=E.useState("bio"),[o,u]=E.useState(!1),[c,d]=E.useState(!1),[h,f]=E.useState(!1),p=E.useRef(null),[g,y]=E.useState(""),[v,x]=E.useState(""),[b,w]=E.useState(""),[_,k]=E.useState(""),[S,A]=E.useState(""),[R,L]=E.useState(!1),T=()=>{t&&(y(t.portrait_url||""),x(t.appearance||""),w(t.memento||""),k(t.flaw||""),A(t.notes||""))};E.useEffect(()=>{T()},[t]),E.useEffect(()=>{const B=W=>{p.current&&!p.current.contains(W.target)&&f(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]);const z=async B=>{t&&(await r(B),u(!1),d(!1),L(!1))},O=()=>{T(),u(!1),d(!1)},Y=()=>a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"absolute top-0 right-0",ref:p,children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>f(!h),children:a.jsx(Ng,{className:"w-5 h-5"})}),h&&a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:a.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[a.jsxs("button",{onClick:()=>{u(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx(I4,{className:"w-4 h-4"})," Edit Bio Details"]}),a.jsxs("button",{onClick:()=>{d(!0),f(!1)},className:"w-full text-left flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[a.jsx($p,{className:"w-4 h-4"})," Edit Portrait URL"]})]})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-6 p-4 border rounded-lg shadow-sm bg-slate-50",children:[a.jsx("div",{className:"w-full md:w-1/3 flex-shrink-0",children:c?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"portraitUrl",className:"block text-sm font-medium text-gray-700",children:"Portrait URL"}),a.jsx("input",{id:"portraitUrl",type:"text",value:g,onChange:B=>y(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://..."}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>{d(!1),T()},children:"Cancel"}),a.jsx(U,{size:"sm",onClick:()=>z({portrait_url:g}),disabled:n,children:n?"...":"Save"})]})]}):g?a.jsx("img",{src:g,alt:"Character Portrait",className:"w-full h-auto object-cover rounded-md border",onError:B=>{B.currentTarget.src="https://via.placeholder.com/150/CCCCCC/FFFFFF?text=Invalid+Image"}}):a.jsxs("button",{onClick:()=>d(!0),className:"w-full h-48 border-2 border-dashed rounded-md flex flex-col items-center justify-center text-gray-500 hover:bg-gray-100 hover:border-gray-400 transition-colors",children:[a.jsx($p,{className:"w-8 h-8 mb-2"}),a.jsx("span",{children:"Add Portrait"})]})}),a.jsxs("div",{className:"flex-grow space-y-4",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 border-b pb-2",children:t==null?void 0:t.name}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx(tm,{label:"Kin",value:t==null?void 0:t.kin}),a.jsx(tm,{label:"Profession",value:t==null?void 0:t.profession}),a.jsx(tm,{label:"Age",value:t==null?void 0:t.age})]}),o?a.jsxs(a.Fragment,{children:[a.jsx(rm,{label:"Appearance",icon:_E,children:a.jsx("textarea",{value:v,onChange:B=>x(B.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A brief description..."})}),a.jsx(rm,{label:"Memento",icon:lc,children:a.jsx("input",{type:"text",value:b,onChange:B=>w(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A cherished item..."})}),a.jsx(rm,{label:"Flaw",icon:y4,children:a.jsx("input",{type:"text",value:_,onChange:B=>k(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"A personal weakness..."})})]}):a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Appearance"}),a.jsx("p",{className:"text-gray-800 text-sm",children:v||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Memento"}),a.jsx("p",{className:"text-gray-800 text-sm",children:b||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-600",children:"Flaw"}),a.jsx("p",{className:"text-gray-800 text-sm",children:_||a.jsx("i",{className:"text-gray-500",children:"Not set."})})]})]})]})]}),o&&a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx(U,{variant:"secondary",onClick:O,children:"Cancel"}),a.jsx(U,{icon:Qt,onClick:()=>z({appearance:v,memento:b,flaw:_}),disabled:n,children:n?"Saving...":"Save Changes"})]})]}),G=()=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-end mb-4 gap-2",children:R?a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"secondary",onClick:()=>{A((t==null?void 0:t.notes)||""),L(!1)},children:"Cancel"}),a.jsx(U,{onClick:()=>z({notes:S}),disabled:n,icon:Qt,children:n?"Saving...":"Save Backstory"})]}):a.jsx(U,{onClick:()=>L(!0),icon:Sg,children:"Edit Backstory"})}),R?a.jsx("textarea",{value:S,onChange:B=>A(B.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"Write your character's life story here..."}):a.jsx("div",{className:"p-4 bg-gray-50 rounded-md border min-h-[200px]",children:S?a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:S}):a.jsx("p",{className:"text-gray-500 italic",children:"No backstory has been written yet."})})]});return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:e,children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex flex-col",onClick:B=>B.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Character Biography"}),a.jsx("p",{className:"text-sm text-gray-500",children:"View and edit personal details and history."})]}),a.jsx(U,{variant:"ghost",size:"icon",onClick:e,"aria-label":"Close modal",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-gray-200 px-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>l("bio"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="bio"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Si,{className:"w-5 h-5"})," Bio"]}),a.jsxs("button",{onClick:()=>l("backstory"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${i==="backstory"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(cl,{className:"w-5 h-5"})," Backstory"]})]})}),a.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[s&&a.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-800 rounded-md flex items-center gap-2",children:[a.jsx(oc,{className:"w-5 h-5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Save Error"}),a.jsx("p",{className:"text-sm",children:s})]})]}),i==="bio"?Y():G()]})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl h-[80vh] flex items-center justify-center",children:[a.jsx(He,{}),a.jsx("span",{className:"ml-2",children:"Loading character data..."})]})})}const Eo={actions:{title:"Actions",icon:cl,sections:[{title:"Common Actions",items:[{title:"Dash",description:"Doubles your movement rate for the round."},{title:"Pick Up Item",description:"Pick up an item within 2 meters or from your inventory."},{title:"Equip/Unequip",description:"Change your equipped armor, helmet, or weapons."},{title:"Break Down Door",description:"Use your action to damage a door or obstacle."},{title:"Pick Lock",description:"Requires a SLEIGHT OF HAND roll (bane without lockpicks)."},{title:"Use Item",description:"Use a potion or other consumable item."},{title:"Activate Ability",description:"Use one of your innate or heroic abilities."},{title:"Cast Spell",description:"Casting a spell typically counts as your action."},{title:"Helping",description:"Grant another character a boon on a roll by helping them."}]},{title:"Free Actions",items:[{title:"Draw Weapon",description:"Draw, exchange, or put away a weapon kept at hand."},{title:"Change Position",description:"Drop prone or stand up from being prone."},{title:"Drop Item",description:"Drop an item you are holding onto the ground."},{title:"Shout",description:"Say or shout a few words."}]}]},combat:{title:"Combat",icon:Bh,sections:[{title:"Attack Actions",items:[{title:"Melee Attack",description:"Attack an enemy within 2 meters (4m for long weapons)."},{title:"Ranged Attack",description:"Use a ranged weapon against targets within its range."},{title:"Parry",description:"A reaction to negate a melee or ranged attack (requires a shield for ranged). Replaces your next action."},{title:"Dodge",description:"A reaction to avoid a melee or ranged attack. Replaces your next action."}]},{title:"Special Attacks",items:[{title:"Find Weak Spot",description:"Take a bane on your attack. If you hit, the enemy is treated as unarmored."},{title:"Topple",description:"Opposed roll (your weapon skill vs enemy EVADE) to knock an enemy prone."},{title:"Disarm",description:"Opposed roll (your weapon skill vs enemy's) to make them drop their weapon."},{title:"Grapple",description:"Opposed BRAWLING roll to trap an enemy. Both you and the enemy fall to the ground."},{title:"Shove",description:"If your STR bonus is higher than the enemy's, you can push them 2 meters on a successful hit."}]},{title:"Sneak Attack & Ambush",items:[{title:"Sneak Attack",description:"Make a SNEAKING roll to attack an unaware target. On success, you get a boon and the target cannot parry or dodge."},{title:"Ambush",description:"When lying in wait, victims must make an AWARENESS roll to spot you. Those who fail are surprised."}]},{title:"Damage Types & Armor",items:[{title:"Leather/Studded",description:"Gains a +2 bonus to its armor rating against Bludgeoning damage."},{title:"Chainmail",description:"Gains a +2 bonus to its armor rating against Slashing damage."}]}]},health:{title:"Health",icon:ba,sections:[{title:"Healing & Resting",items:[{title:"First Aid",description:"Use the HEALING skill to save a dying character at zero HP."},{title:"Rally",description:"Use PERSUASION to get an ally at 0 HP back into the fight."},{title:"Round Rest",description:"(10 sec) Recover D6 WP. Once per shift."},{title:"Stretch Rest",description:"(15 min) Heal D6 HP (2D6 with a Healer), recover D6 WP, and heal one condition. Once per shift."},{title:"Shift Rest",description:"(6 hours) In a safe location, recover all HP & WP and heal all conditions."}]},{title:"Severe Injuries",description:"If you are reduced to zero HP but survive, you may suffer a severe injury. The healing time is halved with medical care (a successful HEALING roll each shift).",items:[{title:"Broken Nose (D6 Days)",description:"Bane on all AWARENESS rolls."},{title:"Scarred Face (2D6 Days)",description:"Bane on all PERFORMANCE and PERSUASION rolls."},{title:"Broken Ribs (D6 Days)",description:"Bane on all skills based on STR or AGL."},{title:"Deep Wounds (2D6 Days)",description:"Bane on STR/AGL skills. Every roll against such a skill inflicts D6 damage."},{title:"Broken Leg (3D6 Days)",description:"Your movement rate is halved."}]}]},journeys:{title:"Journeys",icon:S4,sections:[{title:"Wilderness Travel",items:[{title:"Pathfinder",description:"In pathless terrain, one character must be the pathfinder."},{title:"Bushcraft Roll",description:"The pathfinder must make a BUSHCRAFT roll every shift to find the way. Failure results in a mishap."},{title:"Rolling a Dragon",description:"The pathfinder finds a shortcut, doubling the distance covered in the shift."},{title:"Difficult Terrain",description:"If the terrain is difficult (swamp, dense jungle), the BUSHCRAFT roll gets a bane."}]},{title:"Mishaps (Examples)",items:[{title:"Fog",description:"Distance covered this shift is halved."},{title:"Lost",description:"The party makes no progress this shift and must roll again to find the way."},{title:"Sprained Ankle",description:"A random character suffers D6 damage."},{title:"Savage Animal",description:"A wild animal feels threatened and attacks the party."},{title:"Quicksand",description:"The ground collapses! Everyone must make a BUSHCRAFT roll to avoid sinking."}]}]}};function FI({onClose:e}){const[t,r]=E.useState("actions"),n=Eo[t].icon,s=()=>{const i=Eo[t];return a.jsx("div",{className:"space-y-8",children:i.sections.map(l=>a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-800 border-b pb-2",children:l.title}),l.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-4 italic",children:l.description}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:l.items.map(o=>a.jsx("div",{children:a.jsxs("p",{className:"text-gray-700",children:[a.jsxs("span",{className:"font-bold text-gray-900",children:[" ",o.title,":"]})," ",o.description]})},o.title))})]},l.title))})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full flex flex-col max-h-[90vh] shadow-xl",children:[a.jsxs("div",{className:"sticky top-0 bg-white flex justify-between items-center px-6 pt-6 pb-4 border-b z-20",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(n,{className:"w-6 h-6 text-indigo-600"})," Player Aid"]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"sticky top-[73px] bg-white flex border-b z-10",children:Object.keys(Eo).map(i=>{const l=Eo[i].icon,o=t===i;return a.jsxs("button",{onClick:()=>r(i),className:`flex-1 flex items-center justify-center gap-2 p-3 text-sm font-medium transition-colors ${o?"border-b-2 border-indigo-600 text-indigo-600 bg-indigo-50":"text-gray-500 hover:bg-gray-100 hover:text-gray-700"}`,children:[a.jsx(l,{className:"w-4 h-4"}),a.jsx("span",{children:Eo[i].title})]},i)})}),a.jsx("div",{className:"overflow-y-auto p-6",children:s()})]})})}function UI({}){var V,H,j,he,J,q,$;fn();const{toggleDiceRoller:e}=Mn(),{character:t,fetchCharacter:r,adjustStat:n,toggleCondition:s,performRest:i,isLoading:l,error:o,isSaving:u,saveError:c}=rr(),[d,h]=E.useState(!1),[f,p]=E.useState(!1),[g,y]=E.useState(!1),[v,x]=E.useState(!1),[b,w]=E.useState(!1),[_,k]=E.useState(!1),[S,A]=E.useState(!1),[R,L]=E.useState(!1),[T,z]=E.useState(!1);if(l)return a.jsx("div",{className:"p-4 text-center",children:"Loading character..."});if(o)return a.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading character: ",o]});if(!t)return a.jsx("div",{className:"p-4 text-center",children:"Character data is not available. Please select a character."});const O=Z=>{s(Z)},Y=async Z=>{p(!1),await i(Z,Z==="stretch"?T:void 0),z(!1)},G=(Z,te,ge,we)=>{var Ze;const Te=te??10,ze=((Ze=t.conditions)==null?void 0:Ze[we])??!1;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:Z}),a.jsx("span",{className:"text-xl",children:Te})]}),a.jsx("div",{className:"text-sm h-5",children:(Z==="STR"||Z==="AGL")&&Te>12&&a.jsxs("div",{className:"text-blue-400",children:["Damage Bonus: ",Te<=15?"+D4":"+D6"]})})]}),a.jsx("button",{onClick:()=>O(we),className:`absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${ze?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${u?"opacity-50 cursor-not-allowed":""}`,disabled:u,title:`Toggle ${we.charAt(0).toUpperCase()+we.slice(1)}`,children:we.toUpperCase().substring(0,3)})]})},B=()=>f?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(Wy,{className:"w-6 h-6"})," Choose Rest Type"]}),a.jsx("button",{onClick:()=>{p(!1),z(!1)},className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>Y("shift"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(Uh,{className:"w-5 h-5"}),u?"Resting...":"Take Shift Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Shift Rest (~6 hours):"})," Requires a safe location. Recovers all HP & WP, heals all standard conditions. Resets death roll state. Interruption negates effects."]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>Y("stretch"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition-colors",disabled:u||((t==null?void 0:t.current_hp)??0)<=0,children:[a.jsx(LE,{className:"w-5 h-5"}),u?"Resting...":"Take Stretch Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Stretch Rest (~15 mins):"})," Heal ",T?"2d6":"1d6"," HP, recover 1d6 WP, heal one standard condition. Can only be done once per Shift. Cannot be taken while dying. Interruption negates effects."]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:Z=>z(Z.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:"Healer present for Stretch Rest (requires successful HEALING roll)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Check this if another character is tending to you and succeeds on a HEALING roll during a Stretch Rest."})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>Y("round"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(TE,{className:"w-5 h-5"}),u?"Resting...":"Take Round Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Round Rest (~10 secs):"})," Recover 1d6 WP. No HP recovery. Can only be done once per Shift."]})]})]}),u&&a.jsx("div",{className:"mt-4 text-sm text-center text-gray-500",children:"Saving..."}),c&&a.jsxs("div",{className:"mt-4 text-sm text-center text-red-500",children:["Error: ",c]})]})}):null,W=()=>{var te;const Z=Object.keys((t==null?void 0:t.skill_levels)||{});return((te=t==null?void 0:t.profession)==null?void 0:te.endsWith("Mage"))||Z.some(ge=>["ELEMENTALISM","ANIMISM","MENTALISM"].includes(ge.toUpperCase()))},K=(t==null?void 0:t.current_hp)??0,P=(t==null?void 0:t.current_wp)??0,X=(t==null?void 0:t.max_hp)??10,N=(t==null?void 0:t.max_wp)??10;return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:t.name}),a.jsxs("p",{className:"text-gray-600 text-lg",children:[t.kin||"Unknown Kin"," ",t.profession||"Unknown Profession"," - Age: ",t.age||"Unknown"]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm transition-colors",children:[a.jsx(U4,{className:"w-4 h-4"})," Bio"]}),a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(Tu,{className:"w-4 h-4"})," Inventory"]}),a.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm transition-colors",children:[a.jsx(Wy,{className:"w-4 h-4"})," Rest"]}),a.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-black rounded-lg hover:bg-yellow-600 text-sm transition-colors",children:[a.jsx(Mh,{className:"w-4 h-4"})," Session"]}),a.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm transition-colors",title:"Player Aid",children:[a.jsx(d4,{className:"w-4 h-4"}),"Actions"]})]})]}),a.jsx(DI,{}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-x-4 gap-y-6",children:[G("STR",(V=t.attributes)==null?void 0:V.STR,a.jsx(p4,{}),"exhausted"),G("CON",(H=t.attributes)==null?void 0:H.CON,a.jsx(ba,{}),"sickly"),G("AGL",(j=t.attributes)==null?void 0:j.AGL,a.jsx(g4,{}),"dazed"),G("INT",(he=t.attributes)==null?void 0:he.INT,a.jsx(wE,{}),"angry"),G("WIL",(J=t.attributes)==null?void 0:J.WIL,a.jsx(In,{}),"scared"),G("CHA",(q=t.attributes)==null?void 0:q.CHA,a.jsx(W4,{}),"disheartened")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start",children:[a.jsxs("div",{className:"md:col-span-6 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(nc,{className:"w-4 h-4"})," Skills"]}),W()&&a.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm transition-colors",children:[a.jsx(hl,{className:"w-4 h-4"})," Spells"]}),a.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm transition-colors",children:[a.jsx(D4,{className:"w-4 h-4"})," Abilities"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 text-white rounded-lg text-sm self-start",children:[a.jsx("span",{className:"font-medium",children:"Movement:"}),a.jsxs("span",{className:"font-bold text-lg",children:[oI(t.kin,($=t.attributes)==null?void 0:$.AGL),"m"]})]})]}),a.jsxs("div",{className:"md:col-span-6 grid grid-cols-2 gap-4",children:[K>0?a.jsxs("div",{className:"p-3 rounded-lg shadow bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(kg,{className:"w-4 h-4 text-red-600"})," HP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[K," / ",X]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>n("current_hp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:u||K<=0,title:"Decrease HP",children:"-"}),a.jsx("button",{onClick:()=>n("current_hp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:K>=X||u,title:"Increase HP",children:"+"})]})]}):a.jsx(PI,{character:t}),a.jsxs("div",{className:"p-3 bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(In,{className:"w-4 h-4 text-blue-600"})," WP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[P," / ",N]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>n("current_wp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:P===0||u,title:"Decrease WP",children:"-"}),a.jsx("button",{onClick:()=>n("current_wp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:P>=N||u,title:"Increase WP",children:"+"})]})]})]})]}),a.jsx(SI,{character:t}),S&&a.jsx(MI,{onClose:()=>A(!1)}),g&&a.jsx(mI,{onClose:()=>y(!1)}),d&&a.jsx(xI,{onClose:()=>h(!1)}),v&&a.jsx(vI,{onClose:()=>x(!1)}),b&&a.jsx(OI,{character:t,onClose:()=>{w(!1),t!=null&&t.id&&(t!=null&&t.user_id)&&r(t.id,t.user_id)}}),_&&a.jsx(jI,{onClose:()=>k(!1)}),R&&a.jsx(FI,{onClose:()=>L(!1)}),B(),u&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50 animate-pulse",children:" Saving... "}),c&&a.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50",children:[" Save Error: ",c," "]})]})}const BI=({combatant:e})=>{var o;const{setInitiativeForCombatant:t,isSaving:r}=rr(),[n,s]=E.useState(((o=e.initiative_roll)==null?void 0:o.toString())??""),i=()=>{const u=parseInt(n,10);!isNaN(u)&&u>=1&&u<=10?t(e.id,u):alert("Please enter a number between 1 and 10.")};E.useEffect(()=>{var u;s(((u=e.initiative_roll)==null?void 0:u.toString())??"")},[e.initiative_roll]);const l=!!e.character_id;return a.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${l?"border-blue-500 bg-blue-50":"border-red-500 bg-red-50"}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"font-bold",children:e.display_name}),a.jsx("div",{className:"flex items-center gap-2 text-sm",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ba,{className:"w-4 h-4 text-red-600"}),a.jsxs("span",{children:[e.current_hp," / ",e.max_hp]})]})})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[a.jsx("input",{type:"number",value:n,onChange:u=>s(u.target.value),placeholder:"1-10",className:"w-20 px-2 py-1 border rounded-md",min:"1",max:"10",disabled:r}),a.jsx(U,{onClick:i,size:"sm",disabled:r,children:"Set"})]}),e.conditions&&Object.entries(e.conditions).filter(([,u])=>u).length>0&&a.jsxs("div",{className:"mt-2 text-xs text-red-700",children:["Conditions: ",Object.entries(e.conditions).filter(([,u])=>u).map(([u])=>u).join(", ")]})]})};function oN(){const{character:e,activeEncounter:t,encounterCombatants:r,isLoadingEncounter:n,fetchActiveEncounter:s}=rr(),[i,l]=E.useState(!1);if(E.useEffect(()=>{if(!(e!=null&&e.party_id)||!(e!=null&&e.id))return;const f=e.party_id,p=e.id;console.log(`Attempting to subscribe to real-time updates for Party ID: ${f}`);const g=re.channel(`party-encounter-updates-${f}`);return g.on("postgres_changes",{event:"*",schema:"public",table:"encounters",filter:`party_id=eq.${f}`},y=>{console.log("%cREAL-TIME UPDATE (Encounters): Refetching encounter.","color: cyan;",y),s(f,p)}),g.on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=in.(select id from encounters where party_id=eq.${f})`},y=>{console.log("%cREAL-TIME UPDATE (Combatants): Refetching encounter.","color: lightgreen;",y),s(f,p)}),g.subscribe((y,v)=>{y==="SUBSCRIBED"&&console.log("%cSuccessfully subscribed to real-time channel!","color: green; font-weight: bold;"),y==="CHANNEL_ERROR"&&console.error("%cCHANNEL_ERROR: Failed to subscribe.","color: red; font-weight: bold;",v)}),()=>{console.log(`Unsubscribing from party updates: ${f}`),re.removeChannel(g)}},[e,s]),!e)return null;const o=(t==null?void 0:t.status)==="active",u=o?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",c=o?"Encounter Active":"Party Chat",d=[...r].sort((f,p)=>(p.initiative_roll??0)-(f.initiative_roll??0)),h=o&&d.every(f=>f.initiative_roll!==null);return a.jsxs(a.Fragment,{children:[a.jsx("button",{className:`fixed bottom-4 right-4 p-4 rounded-full shadow-lg text-white transition-colors duration-200 z-40 ${u}`,onClick:()=>l(!i),"aria-label":c,children:o?a.jsx(ur,{size:24}):a.jsx(C4,{size:24})}),i&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-end z-30",onClick:()=>l(!1),children:a.jsxs("div",{className:"bg-white w-full max-w-sm h-full shadow-xl flex flex-col",onClick:f=>f.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:o?"Active Encounter":"Party Chat"}),a.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{size:24})})]}),a.jsx("div",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:n&&!t?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Yn,{className:"w-8 h-8 animate-spin text-gray-500"})}):t?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:t.name}),a.jsxs("p",{className:"text-sm",children:["Round: ",a.jsx("span",{className:"font-medium",children:t.current_round})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:h?"Turn Order":"Set Initiative"}),a.jsx("div",{className:"space-y-3",children:d.length>0?d.map(f=>a.jsx(BI,{combatant:f},f.id)):a.jsx("p",{className:"text-sm text-gray-500",children:"No combatants in this encounter yet."})})]})]}):a.jsx("div",{className:"text-gray-600 text-center",children:"No active encounter for your party."})})]})})]})}function HI(){const{id:e}=pg(),{user:t}=qt(),{character:r,isLoading:n,error:s,fetchCharacter:i,setCharacter:l}=rr();return E.useEffect(()=>{(async()=>{e&&(t!=null&&t.id)?await i(e,t.id):(l(null),console.warn("CharacterPage: Character ID or User ID is missing. Cannot load character."))})()},[e,t==null?void 0:t.id,i,l]),n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(He,{size:"lg"})}):s?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:s})}):r?a.jsxs(a.Fragment,{children:[a.jsx(UI,{}),a.jsx(oN,{})]}):a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:"Character not found, does not exist, or you may not have permission to view it."})})}function _b(e){const t=[],r=String(e||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const l=r.slice(s,n).trim();(l||!i)&&t.push(l),s=n+1,n=r.indexOf(",",s)}return t}function uN(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const $I=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,zI=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,qI={};function Sb(e,t){return(qI.jsx?zI:$I).test(e)}const VI=/[ \t\n\f\r]/g;function WI(e){return typeof e=="object"?e.type==="text"?Tb(e.value):!1:Tb(e)}function Tb(e){return e.replace(VI,"")===""}class cc{constructor(t,r,n){this.property=t,this.normal=r,n&&(this.space=n)}}cc.prototype.property={};cc.prototype.normal={};cc.prototype.space=null;function cN(e,t){const r={},n={};let s=-1;for(;++s<e.length;)Object.assign(r,e[s].property),Object.assign(n,e[s].normal);return new cc(r,n,t)}function ju(e){return e.toLowerCase()}class mn{constructor(t,r){this.property=t,this.attribute=r}}mn.prototype.space=null;mn.prototype.boolean=!1;mn.prototype.booleanish=!1;mn.prototype.overloadedBoolean=!1;mn.prototype.number=!1;mn.prototype.commaSeparated=!1;mn.prototype.spaceSeparated=!1;mn.prototype.commaOrSpaceSeparated=!1;mn.prototype.mustUseProperty=!1;mn.prototype.defined=!1;let GI=0;const Oe=Ti(),Mt=Ti(),dN=Ti(),ce=Ti(),ft=Ti(),pl=Ti(),Br=Ti();function Ti(){return 2**++GI}const Gp=Object.freeze(Object.defineProperty({__proto__:null,boolean:Oe,booleanish:Mt,commaOrSpaceSeparated:Br,commaSeparated:pl,number:ce,overloadedBoolean:dN,spaceSeparated:ft},Symbol.toStringTag,{value:"Module"})),nm=Object.keys(Gp);class Ig extends mn{constructor(t,r,n,s){let i=-1;if(super(t,r),Cb(this,"space",s),typeof n=="number")for(;++i<nm.length;){const l=nm[i];Cb(this,nm[i],(n&Gp[l])===Gp[l])}}}Ig.prototype.defined=!0;function Cb(e,t,r){r&&(e[t]=r)}const YI={}.hasOwnProperty;function ro(e){const t={},r={};let n;for(n in e.properties)if(YI.call(e.properties,n)){const s=e.properties[n],i=new Ig(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[ju(n)]=n,r[ju(i.attribute)]=n}return new cc(t,r,e.space)}const hN=ro({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),fN=ro({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function mN(e,t){return t in e?e[t]:t}function pN(e,t){return mN(e,t.toLowerCase())}const gN=ro({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:pN,properties:{xmlns:null,xmlnsXLink:null}}),xN=ro({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Mt,ariaAutoComplete:null,ariaBusy:Mt,ariaChecked:Mt,ariaColCount:ce,ariaColIndex:ce,ariaColSpan:ce,ariaControls:ft,ariaCurrent:null,ariaDescribedBy:ft,ariaDetails:null,ariaDisabled:Mt,ariaDropEffect:ft,ariaErrorMessage:null,ariaExpanded:Mt,ariaFlowTo:ft,ariaGrabbed:Mt,ariaHasPopup:null,ariaHidden:Mt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ft,ariaLevel:ce,ariaLive:null,ariaModal:Mt,ariaMultiLine:Mt,ariaMultiSelectable:Mt,ariaOrientation:null,ariaOwns:ft,ariaPlaceholder:null,ariaPosInSet:ce,ariaPressed:Mt,ariaReadOnly:Mt,ariaRelevant:null,ariaRequired:Mt,ariaRoleDescription:ft,ariaRowCount:ce,ariaRowIndex:ce,ariaRowSpan:ce,ariaSelected:Mt,ariaSetSize:ce,ariaSort:null,ariaValueMax:ce,ariaValueMin:ce,ariaValueNow:ce,ariaValueText:null,role:null}}),QI=ro({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:pN,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:pl,acceptCharset:ft,accessKey:ft,action:null,allow:null,allowFullScreen:Oe,allowPaymentRequest:Oe,allowUserMedia:Oe,alt:null,as:null,async:Oe,autoCapitalize:null,autoComplete:ft,autoFocus:Oe,autoPlay:Oe,blocking:ft,capture:null,charSet:null,checked:Oe,cite:null,className:ft,cols:ce,colSpan:null,content:null,contentEditable:Mt,controls:Oe,controlsList:ft,coords:ce|pl,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Oe,defer:Oe,dir:null,dirName:null,disabled:Oe,download:dN,draggable:Mt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Oe,formTarget:null,headers:ft,height:ce,hidden:Oe,high:ce,href:null,hrefLang:null,htmlFor:ft,httpEquiv:ft,id:null,imageSizes:null,imageSrcSet:null,inert:Oe,inputMode:null,integrity:null,is:null,isMap:Oe,itemId:null,itemProp:ft,itemRef:ft,itemScope:Oe,itemType:ft,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Oe,low:ce,manifest:null,max:null,maxLength:ce,media:null,method:null,min:null,minLength:ce,multiple:Oe,muted:Oe,name:null,nonce:null,noModule:Oe,noValidate:Oe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Oe,optimum:ce,pattern:null,ping:ft,placeholder:null,playsInline:Oe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Oe,referrerPolicy:null,rel:ft,required:Oe,reversed:Oe,rows:ce,rowSpan:ce,sandbox:ft,scope:null,scoped:Oe,seamless:Oe,selected:Oe,shadowRootClonable:Oe,shadowRootDelegatesFocus:Oe,shadowRootMode:null,shape:null,size:ce,sizes:null,slot:null,span:ce,spellCheck:Mt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ce,step:null,style:null,tabIndex:ce,target:null,title:null,translate:null,type:null,typeMustMatch:Oe,useMap:null,value:Mt,width:ce,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ft,axis:null,background:null,bgColor:null,border:ce,borderColor:null,bottomMargin:ce,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Oe,declare:Oe,event:null,face:null,frame:null,frameBorder:null,hSpace:ce,leftMargin:ce,link:null,longDesc:null,lowSrc:null,marginHeight:ce,marginWidth:ce,noResize:Oe,noHref:Oe,noShade:Oe,noWrap:Oe,object:null,profile:null,prompt:null,rev:null,rightMargin:ce,rules:null,scheme:null,scrolling:Mt,standby:null,summary:null,text:null,topMargin:ce,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ce,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Oe,disableRemotePlayback:Oe,prefix:null,property:null,results:ce,security:null,unselectable:null}}),KI=ro({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:mN,properties:{about:Br,accentHeight:ce,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ce,amplitude:ce,arabicForm:null,ascent:ce,attributeName:null,attributeType:null,azimuth:ce,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ce,by:null,calcMode:null,capHeight:ce,className:ft,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ce,diffuseConstant:ce,direction:null,display:null,dur:null,divisor:ce,dominantBaseline:null,download:Oe,dx:null,dy:null,edgeMode:null,editable:null,elevation:ce,enableBackground:null,end:null,event:null,exponent:ce,externalResourcesRequired:null,fill:null,fillOpacity:ce,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:pl,g2:pl,glyphName:pl,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ce,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ce,horizOriginX:ce,horizOriginY:ce,id:null,ideographic:ce,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ce,k:ce,k1:ce,k2:ce,k3:ce,k4:ce,kernelMatrix:Br,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ce,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ce,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ce,overlineThickness:ce,paintOrder:null,panose1:null,path:null,pathLength:ce,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ft,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ce,pointsAtY:ce,pointsAtZ:ce,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Br,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Br,rev:Br,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Br,requiredFeatures:Br,requiredFonts:Br,requiredFormats:Br,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ce,specularExponent:ce,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ce,strikethroughThickness:ce,string:null,stroke:null,strokeDashArray:Br,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ce,strokeOpacity:ce,strokeWidth:null,style:null,surfaceScale:ce,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Br,tabIndex:ce,tableValues:null,target:null,targetX:ce,targetY:ce,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Br,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ce,underlineThickness:ce,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ce,values:null,vAlphabetic:ce,vMathematical:ce,vectorEffect:null,vHanging:ce,vIdeographic:ce,version:null,vertAdvY:ce,vertOriginX:ce,vertOriginY:ce,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ce,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),ZI=/^data[-\w.:]+$/i,jb=/-[a-z]/g,XI=/[A-Z]/g;function $h(e,t){const r=ju(t);let n=t,s=mn;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&ZI.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(jb,eR);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!jb.test(i)){let l=i.replace(XI,JI);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}s=Ig}return new s(n,t)}function JI(e){return"-"+e.toLowerCase()}function eR(e){return e.charAt(1).toUpperCase()}const tR={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},dc=cN([fN,hN,gN,xN,QI],"html"),La=cN([fN,hN,gN,xN,KI],"svg");function Ab(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function yN(e){return e.join(" ").trim()}var bN={},Ib=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,rR=/\n/g,nR=/^\s*/,sR=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,aR=/^:\s*/,iR=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,lR=/^[;\s]*/,oR=/^\s+|\s+$/g,uR=`
`,Rb="/",Lb="*",Wa="",cR="comment",dR="declaration",hR=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(g){var y=g.match(rR);y&&(r+=y.length);var v=g.lastIndexOf(uR);n=~v?g.length-v:n+g.length}function i(){var g={line:r,column:n};return function(y){return y.position=new l(g),c(),y}}function l(g){this.start=g,this.end={line:r,column:n},this.source=t.source}l.prototype.content=e;function o(g){var y=new Error(t.source+":"+r+":"+n+": "+g);if(y.reason=g,y.filename=t.source,y.line=r,y.column=n,y.source=e,!t.silent)throw y}function u(g){var y=g.exec(e);if(y){var v=y[0];return s(v),e=e.slice(v.length),y}}function c(){u(nR)}function d(g){var y;for(g=g||[];y=h();)y!==!1&&g.push(y);return g}function h(){var g=i();if(!(Rb!=e.charAt(0)||Lb!=e.charAt(1))){for(var y=2;Wa!=e.charAt(y)&&(Lb!=e.charAt(y)||Rb!=e.charAt(y+1));)++y;if(y+=2,Wa===e.charAt(y-1))return o("End of comment missing");var v=e.slice(2,y-2);return n+=2,s(v),e=e.slice(y),n+=2,g({type:cR,comment:v})}}function f(){var g=i(),y=u(sR);if(y){if(h(),!u(aR))return o("property missing ':'");var v=u(iR),x=g({type:dR,property:Ob(y[0].replace(Ib,Wa)),value:v?Ob(v[0].replace(Ib,Wa)):Wa});return u(lR),x}}function p(){var g=[];d(g);for(var y;y=f();)y!==!1&&(g.push(y),d(g));return g}return c(),p()};function Ob(e){return e?e.replace(oR,Wa):Wa}var fR=Mr&&Mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bN,"__esModule",{value:!0});var Pb=bN.default=pR,mR=fR(hR);function pR(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,mR.default)(e),s=typeof t=="function";return n.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;s?t(l,o,i):o&&(r=r||{},r[l]=o)}}),r}const gR=Pb.default||Pb,zh=vN("end"),ns=vN("start");function vN(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function wN(e){const t=ns(e),r=zh(e);if(t&&r)return{start:t,end:r}}function Zo(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Db(e.position):"start"in e||"end"in e?Db(e):"line"in e||"column"in e?Yp(e):""}function Yp(e){return Mb(e&&e.line)+":"+Mb(e&&e.column)}function Db(e){return Yp(e&&e.start)+"-"+Yp(e&&e.end)}function Mb(e){return e&&typeof e=="number"?e:1}class fr extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},l=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof t=="string"?s=t:!i.cause&&t&&(l=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=o?o.line:void 0,this.name=Zo(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}fr.prototype.file="";fr.prototype.name="";fr.prototype.reason="";fr.prototype.message="";fr.prototype.stack="";fr.prototype.column=void 0;fr.prototype.line=void 0;fr.prototype.ancestors=void 0;fr.prototype.cause=void 0;fr.prototype.fatal=void 0;fr.prototype.place=void 0;fr.prototype.ruleId=void 0;fr.prototype.source=void 0;const Rg={}.hasOwnProperty,xR=new Map,yR=/[A-Z]/g,bR=/-([a-z])/g,vR=new Set(["table","tbody","thead","tfoot","tr"]),wR=new Set(["td","th"]),EN="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function ER(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=AR(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=jR(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?La:dc,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=NN(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function NN(e,t,r){if(t.type==="element")return NR(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return kR(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return SR(e,t,r);if(t.type==="mdxjsEsm")return _R(e,t);if(t.type==="root")return TR(e,t,r);if(t.type==="text")return CR(e,t)}function NR(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=La,e.schema=s),e.ancestors.push(t);const i=_N(e,t.tagName,!1),l=IR(e,t);let o=Og(e,t);return vR.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!WI(u):!0})),kN(e,l,i,t),Lg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function kR(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}Au(e,t.position)}function _R(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Au(e,t.position)}function SR(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=La,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:_N(e,t.name,!0),l=RR(e,t),o=Og(e,t);return kN(e,l,i,t),Lg(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function TR(e,t,r){const n={};return Lg(n,Og(e,t)),e.create(t,e.Fragment,n,r)}function CR(e,t){return t.value}function kN(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Lg(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function jR(e,t,r){return n;function n(s,i,l,o){const c=Array.isArray(l.children)?r:t;return o?c(i,l,o):c(i,l)}}function AR(e,t){return r;function r(n,s,i,l){const o=Array.isArray(i.children),u=ns(n);return t(s,i,l,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function IR(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&Rg.call(t.properties,s)){const i=LR(e,s,t.properties[s]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&wR.has(t.tagName)?n=o:r[l]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function RR(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else Au(e,t.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else Au(e,t.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function Og(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:xR;for(;++n<t.children.length;){const i=t.children[n];let l;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const c=s.get(u)||0;l=u+"-"+c,s.set(u,c+1)}}const o=NN(e,i,l);o!==void 0&&r.push(o)}return r}function LR(e,t,r){const n=$h(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?uN(r):yN(r)),n.property==="style"){let s=typeof r=="object"?r:OR(e,String(r));return e.stylePropertyNameCase==="css"&&(s=PR(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?tR[n.property]||n.property:n.attribute,r]}}function OR(e,t){const r={};try{gR(t,n)}catch(s){if(!e.ignoreInvalidStyle){const i=s,l=new fr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=EN+"#cannot-parse-style-attribute",l}}return r;function n(s,i){let l=s;l.slice(0,2)!=="--"&&(l.slice(0,4)==="-ms-"&&(l="ms-"+l.slice(4)),l=l.replace(bR,MR)),r[l]=i}}function _N(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,l;for(;++i<s.length;){const o=Sb(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}n=l}else n=Sb(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return Rg.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);Au(e)}function Au(e,t){const r=new fr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=EN+"#cannot-handle-mdx-estrees-without-createevaluater",r}function PR(e){const t={};let r;for(r in e)Rg.call(e,r)&&(t[DR(r)]=e[r]);return t}function DR(e){let t=e.replace(yR,FR);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function MR(e,t){return t.toUpperCase()}function FR(e){return"-"+e.toLowerCase()}const sm={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},UR={};function Pg(e,t){const r=UR,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return SN(e,n,s)}function SN(e,t,r){if(BR(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Fb(e.children,t,r)}return Array.isArray(e)?Fb(e,t,r):""}function Fb(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=SN(e[s],t,r);return n.join("")}function BR(e){return!!(e&&typeof e=="object")}const Ub=document.createElement("i");function Dg(e){const t="&"+e+";";Ub.innerHTML=t;const r=Ub.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Wr(e,t,r,n){const s=e.length;let i=0,l;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)l=Array.from(n),l.unshift(t,r),e.splice(...l);else for(r&&e.splice(t,r);i<n.length;)l=n.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function ln(e,t){return e.length>0?(Wr(e,e.length,0,t),e):t}const Bb={}.hasOwnProperty;function TN(e){const t={};let r=-1;for(;++r<e.length;)HR(t,e[r]);return t}function HR(e,t){let r;for(r in t){const s=(Bb.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let l;if(i)for(l in i){Bb.call(s,l)||(s[l]=[]);const o=i[l];$R(s[l],Array.isArray(o)?o:o?[o]:[])}}}function $R(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Wr(e,0,0,n)}function CN(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function Rn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const vr=Oa(/[A-Za-z]/),or=Oa(/[\dA-Za-z]/),zR=Oa(/[#-'*+\--9=?A-Z^-~]/);function Xd(e){return e!==null&&(e<32||e===127)}const Qp=Oa(/\d/),qR=Oa(/[\dA-Fa-f]/),VR=Oa(/[!-/:-@[-`{-~]/);function _e(e){return e!==null&&e<-2}function ut(e){return e!==null&&(e<0||e===32)}function qe(e){return e===-2||e===-1||e===32}const qh=Oa(new RegExp("\\p{P}|\\p{S}","u")),yi=Oa(/\s/);function Oa(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function no(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const i=e.charCodeAt(r);let l="";if(i===37&&or(e.charCodeAt(r+1))&&or(e.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),s=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(n,r),encodeURIComponent(l)),n=r+s+1,l=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function Ke(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(u){return qe(u)?(e.enter(r),o(u)):t(u)}function o(u){return qe(u)&&i++<s?(e.consume(u),o):(e.exit(r),t(u))}}const WR={tokenize:GR};function GR(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Ke(e,t,"linePrefix")}function s(o){return e.enter("paragraph"),i(o)}function i(o){const u=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=u),r=u,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return _e(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const YR={tokenize:QR},Hb={tokenize:KR};function QR(e){const t=this,r=[];let n=0,s,i,l;return o;function o(w){if(n<r.length){const _=r[n];return t.containerState=_[1],e.attempt(_[0].continuation,u,c)(w)}return c(w)}function u(w){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&b();const _=t.events.length;let k=_,S;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){S=t.events[k][1].end;break}x(n);let A=_;for(;A<t.events.length;)t.events[A][1].end={...S},A++;return Wr(t.events,k+1,0,t.events.slice(_)),t.events.length=A,c(w)}return o(w)}function c(w){if(n===r.length){if(!s)return f(w);if(s.currentConstruct&&s.currentConstruct.concrete)return g(w);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Hb,d,h)(w)}function d(w){return s&&b(),x(n),f(w)}function h(w){return t.parser.lazy[t.now().line]=n!==r.length,l=t.now().offset,g(w)}function f(w){return t.containerState={},e.attempt(Hb,p,g)(w)}function p(w){return n++,r.push([t.currentConstruct,t.containerState]),f(w)}function g(w){if(w===null){s&&b(),x(0),e.consume(w);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),y(w)}function y(w){if(w===null){v(e.exit("chunkFlow"),!0),x(0),e.consume(w);return}return _e(w)?(e.consume(w),v(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(w),y)}function v(w,_){const k=t.sliceStream(w);if(_&&k.push(null),w.previous=i,i&&(i.next=w),i=w,s.defineSkip(w.start),s.write(k),t.parser.lazy[w.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<l&&(!s.events[S][1].end||s.events[S][1].end.offset>l))return;const A=t.events.length;let R=A,L,T;for(;R--;)if(t.events[R][0]==="exit"&&t.events[R][1].type==="chunkFlow"){if(L){T=t.events[R][1].end;break}L=!0}for(x(n),S=A;S<t.events.length;)t.events[S][1].end={...T},S++;Wr(t.events,R+1,0,t.events.slice(A)),t.events.length=S}}function x(w){let _=r.length;for(;_-- >w;){const k=r[_];t.containerState=k[1],k[0].exit.call(t,e)}r.length=w}function b(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function KR(e,t,r){return Ke(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Hl(e){if(e===null||ut(e)||yi(e))return 1;if(qh(e))return 2}function Vh(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const Kp={name:"attention",resolveAll:ZR,tokenize:XR};function ZR(e,t){let r=-1,n,s,i,l,o,u,c,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h={...e[n][1].end},f={...e[r][1].start};$b(h,-u),$b(f,u),l={type:u>1?"strongSequence":"emphasisSequence",start:h,end:{...e[n][1].end}},o={type:u>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},i={type:u>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:u>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[n][1].end={...l.start},e[r][1].start={...o.end},c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=ln(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=ln(c,[["enter",s,t],["enter",l,t],["exit",l,t],["enter",i,t]]),c=ln(c,Vh(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=ln(c,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,c=ln(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,Wr(e,n-1,r-n+3,c),r=n+c.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function XR(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=Hl(n);let i;return l;function l(u){return i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const c=e.exit("attentionSequence"),d=Hl(u),h=!d||d===2&&s||r.includes(u),f=!s||s===2&&d||r.includes(n);return c._open=!!(i===42?h:h&&(s||!f)),c._close=!!(i===42?f:f&&(d||!h)),t(u)}}function $b(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const JR={name:"autolink",tokenize:eL};function eL(e,t,r){let n=0;return s;function s(p){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(p){return vr(p)?(e.consume(p),l):p===64?r(p):c(p)}function l(p){return p===43||p===45||p===46||or(p)?(n=1,o(p)):c(p)}function o(p){return p===58?(e.consume(p),n=0,u):(p===43||p===45||p===46||or(p))&&n++<32?(e.consume(p),o):(n=0,c(p))}function u(p){return p===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):p===null||p===32||p===60||Xd(p)?r(p):(e.consume(p),u)}function c(p){return p===64?(e.consume(p),d):zR(p)?(e.consume(p),c):r(p)}function d(p){return or(p)?h(p):r(p)}function h(p){return p===46?(e.consume(p),n=0,d):p===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):f(p)}function f(p){if((p===45||or(p))&&n++<63){const g=p===45?f:h;return e.consume(p),g}return r(p)}}const hc={partial:!0,tokenize:tL};function tL(e,t,r){return n;function n(i){return qe(i)?Ke(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||_e(i)?t(i):r(i)}}const jN={continuation:{tokenize:nL},exit:sL,name:"blockQuote",tokenize:rL};function rL(e,t,r){const n=this;return s;function s(l){if(l===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return r(l)}function i(l){return qe(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function nL(e,t,r){const n=this;return s;function s(l){return qe(l)?Ke(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(jN,t,r)(l)}}function sL(e){e.exit("blockQuote")}const AN={name:"characterEscape",tokenize:aL};function aL(e,t,r){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return VR(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(i)}}const IN={name:"characterReference",tokenize:iL};function iL(e,t,r){const n=this;let s=0,i,l;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),u}function u(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,l=or,d(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=qR,d):(e.enter("characterReferenceValue"),i=7,l=Qp,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return l===or&&!Dg(n.sliceSerialize(f))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(h)&&s++<i?(e.consume(h),d):r(h)}}const zb={partial:!0,tokenize:oL},qb={concrete:!0,name:"codeFenced",tokenize:lL};function lL(e,t,r){const n=this,s={partial:!0,tokenize:k};let i=0,l=0,o;return u;function u(S){return c(S)}function c(S){const A=n.events[n.events.length-1];return i=A&&A[1].type==="linePrefix"?A[2].sliceSerialize(A[1],!0).length:0,o=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===o?(l++,e.consume(S),d):l<3?r(S):(e.exit("codeFencedFenceSequence"),qe(S)?Ke(e,h,"whitespace")(S):h(S))}function h(S){return S===null||_e(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(zb,y,_)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||_e(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(S)):qe(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Ke(e,p,"whitespace")(S)):S===96&&S===o?r(S):(e.consume(S),f)}function p(S){return S===null||_e(S)?h(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(S))}function g(S){return S===null||_e(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(S)):S===96&&S===o?r(S):(e.consume(S),g)}function y(S){return e.attempt(s,_,v)(S)}function v(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&qe(S)?Ke(e,b,"linePrefix",i+1)(S):b(S)}function b(S){return S===null||_e(S)?e.check(zb,y,_)(S):(e.enter("codeFlowValue"),w(S))}function w(S){return S===null||_e(S)?(e.exit("codeFlowValue"),b(S)):(e.consume(S),w)}function _(S){return e.exit("codeFenced"),t(S)}function k(S,A,R){let L=0;return T;function T(B){return S.enter("lineEnding"),S.consume(B),S.exit("lineEnding"),z}function z(B){return S.enter("codeFencedFence"),qe(B)?Ke(S,O,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):O(B)}function O(B){return B===o?(S.enter("codeFencedFenceSequence"),Y(B)):R(B)}function Y(B){return B===o?(L++,S.consume(B),Y):L>=l?(S.exit("codeFencedFenceSequence"),qe(B)?Ke(S,G,"whitespace")(B):G(B)):R(B)}function G(B){return B===null||_e(B)?(S.exit("codeFencedFence"),A(B)):R(B)}}}function oL(e,t,r){const n=this;return s;function s(l){return l===null?r(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}const am={name:"codeIndented",tokenize:cL},uL={partial:!0,tokenize:dL};function cL(e,t,r){const n=this;return s;function s(c){return e.enter("codeIndented"),Ke(e,i,"linePrefix",5)(c)}function i(c){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?l(c):r(c)}function l(c){return c===null?u(c):_e(c)?e.attempt(uL,l,u)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||_e(c)?(e.exit("codeFlowValue"),l(c)):(e.consume(c),o)}function u(c){return e.exit("codeIndented"),t(c)}}function dL(e,t,r){const n=this;return s;function s(l){return n.parser.lazy[n.now().line]?r(l):_e(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):Ke(e,i,"linePrefix",5)(l)}function i(l){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):_e(l)?s(l):r(l)}}const hL={name:"codeText",previous:mL,resolve:fL,tokenize:pL};function fL(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function mL(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function pL(e,t,r){let n=0,s,i;return l;function l(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),u(h))}function u(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),u):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):_e(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||_e(h)?(e.exit("codeTextData"),u(h)):(e.consume(h),c)}function d(h){return h===96?(e.consume(h),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",c(h))}}class gL{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&No(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),No(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),No(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);No(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);No(this.left,r.reverse())}}}function No(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function RN(e){const t={};let r=-1,n,s,i,l,o,u,c;const d=new gL(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,xL(d,r)),r=t[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--;)if(l=d.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),l[1].type="lineEnding",s=i);else if(l[1].type!=="linePrefix")break;s&&(n[1].end={...d.get(s)[1].start},o=d.slice(s,r),o.unshift(n),d.splice(s,r-s+1,o))}}return Wr(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function xL(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const i=[],l=r._tokenizer||n.parser[r.contentType](r.start),o=l.events,u=[],c={};let d,h,f=-1,p=r,g=0,y=0;const v=[y];for(;p;){for(;e.get(++s)[1]!==p;);i.push(s),p._tokenizer||(d=n.sliceStream(p),p.next||d.push(null),h&&l.defineSkip(p.start),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(d),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),h=p,p=p.next}for(p=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(y=f+1,v.push(y),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(l.events=[],p?(p._tokenizer=void 0,p.previous=void 0):v.pop(),f=v.length;f--;){const x=o.slice(v[f],v[f+1]),b=i.pop();u.push([b,b+x.length-1]),e.splice(b,2,x)}for(u.reverse(),f=-1;++f<u.length;)c[g+u[f][0]]=g+u[f][1],g+=u[f][1]-u[f][0]-1;return c}const yL={resolve:vL,tokenize:wL},bL={partial:!0,tokenize:EL};function vL(e){return RN(e),e}function wL(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(o)}function s(o){return o===null?i(o):_e(o)?e.check(bL,l,i)(o):(e.consume(o),s)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function EL(e,t,r){const n=this;return s;function s(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Ke(e,i,"linePrefix")}function i(l){if(l===null||_e(l))return r(l);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(n.parser.constructs.flow,r,t)(l)}}function LN(e,t,r,n,s,i,l,o,u){const c=u||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(n),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||Xd(x)?r(x):(e.enter(n),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),y(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),p(x))}function p(x){return x===62?(e.exit("chunkString"),e.exit(o),f(x)):x===null||x===60||_e(x)?r(x):(e.consume(x),x===92?g:p)}function g(x){return x===60||x===62||x===92?(e.consume(x),p):p(x)}function y(x){return!d&&(x===null||x===41||ut(x))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(n),t(x)):d<c&&x===40?(e.consume(x),d++,y):x===41?(e.consume(x),d--,y):x===null||x===32||x===40||Xd(x)?r(x):(e.consume(x),x===92?v:y)}function v(x){return x===40||x===41||x===92?(e.consume(x),y):y(x)}}function ON(e,t,r,n,s,i){const l=this;let o=0,u;return c;function c(p){return e.enter(n),e.enter(s),e.consume(p),e.exit(s),e.enter(i),d}function d(p){return o>999||p===null||p===91||p===93&&!u||p===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?r(p):p===93?(e.exit(i),e.enter(s),e.consume(p),e.exit(s),e.exit(n),t):_e(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(p))}function h(p){return p===null||p===91||p===93||_e(p)||o++>999?(e.exit("chunkString"),d(p)):(e.consume(p),u||(u=!qe(p)),p===92?f:h)}function f(p){return p===91||p===92||p===93?(e.consume(p),o++,h):h(p)}}function PN(e,t,r,n,s,i){let l;return o;function o(f){return f===34||f===39||f===40?(e.enter(n),e.enter(s),e.consume(f),e.exit(s),l=f===40?41:f,u):r(f)}function u(f){return f===l?(e.enter(s),e.consume(f),e.exit(s),e.exit(n),t):(e.enter(i),c(f))}function c(f){return f===l?(e.exit(i),u(l)):f===null?r(f):_e(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Ke(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===l||f===null||_e(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?h:d)}function h(f){return f===l||f===92?(e.consume(f),d):d(f)}}function Xo(e,t){let r;return n;function n(s){return _e(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):qe(s)?Ke(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const NL={name:"definition",tokenize:_L},kL={partial:!0,tokenize:SL};function _L(e,t,r){const n=this;let s;return i;function i(p){return e.enter("definition"),l(p)}function l(p){return ON.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function o(p){return s=Rn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),u):r(p)}function u(p){return ut(p)?Xo(e,c)(p):c(p)}function c(p){return LN(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function d(p){return e.attempt(kL,h,h)(p)}function h(p){return qe(p)?Ke(e,f,"whitespace")(p):f(p)}function f(p){return p===null||_e(p)?(e.exit("definition"),n.parser.defined.push(s),t(p)):r(p)}}function SL(e,t,r){return n;function n(o){return ut(o)?Xo(e,s)(o):r(o)}function s(o){return PN(e,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return qe(o)?Ke(e,l,"whitespace")(o):l(o)}function l(o){return o===null||_e(o)?t(o):r(o)}}const TL={name:"hardBreakEscape",tokenize:CL};function CL(e,t,r){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return _e(i)?(e.exit("hardBreakEscape"),t(i)):r(i)}}const jL={name:"headingAtx",resolve:AL,tokenize:IL};function AL(e,t){let r=e.length-2,n=3,s,i;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},i={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Wr(e,n,r-n+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function IL(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),l(d)}function l(d){return d===35&&n++<6?(e.consume(d),l):d===null||ut(d)?(e.exit("atxHeadingSequence"),o(d)):r(d)}function o(d){return d===35?(e.enter("atxHeadingSequence"),u(d)):d===null||_e(d)?(e.exit("atxHeading"),t(d)):qe(d)?Ke(e,o,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function u(d){return d===35?(e.consume(d),u):(e.exit("atxHeadingSequence"),o(d))}function c(d){return d===null||d===35||ut(d)?(e.exit("atxHeadingText"),o(d)):(e.consume(d),c)}}const RL=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Vb=["pre","script","style","textarea"],LL={concrete:!0,name:"htmlFlow",resolveTo:DL,tokenize:ML},OL={partial:!0,tokenize:UL},PL={partial:!0,tokenize:FL};function DL(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function ML(e,t,r){const n=this;let s,i,l,o,u;return c;function c(j){return d(j)}function d(j){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(j),h}function h(j){return j===33?(e.consume(j),f):j===47?(e.consume(j),i=!0,y):j===63?(e.consume(j),s=3,n.interrupt?t:N):vr(j)?(e.consume(j),l=String.fromCharCode(j),v):r(j)}function f(j){return j===45?(e.consume(j),s=2,p):j===91?(e.consume(j),s=5,o=0,g):vr(j)?(e.consume(j),s=4,n.interrupt?t:N):r(j)}function p(j){return j===45?(e.consume(j),n.interrupt?t:N):r(j)}function g(j){const he="CDATA[";return j===he.charCodeAt(o++)?(e.consume(j),o===he.length?n.interrupt?t:O:g):r(j)}function y(j){return vr(j)?(e.consume(j),l=String.fromCharCode(j),v):r(j)}function v(j){if(j===null||j===47||j===62||ut(j)){const he=j===47,J=l.toLowerCase();return!he&&!i&&Vb.includes(J)?(s=1,n.interrupt?t(j):O(j)):RL.includes(l.toLowerCase())?(s=6,he?(e.consume(j),x):n.interrupt?t(j):O(j)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(j):i?b(j):w(j))}return j===45||or(j)?(e.consume(j),l+=String.fromCharCode(j),v):r(j)}function x(j){return j===62?(e.consume(j),n.interrupt?t:O):r(j)}function b(j){return qe(j)?(e.consume(j),b):T(j)}function w(j){return j===47?(e.consume(j),T):j===58||j===95||vr(j)?(e.consume(j),_):qe(j)?(e.consume(j),w):T(j)}function _(j){return j===45||j===46||j===58||j===95||or(j)?(e.consume(j),_):k(j)}function k(j){return j===61?(e.consume(j),S):qe(j)?(e.consume(j),k):w(j)}function S(j){return j===null||j===60||j===61||j===62||j===96?r(j):j===34||j===39?(e.consume(j),u=j,A):qe(j)?(e.consume(j),S):R(j)}function A(j){return j===u?(e.consume(j),u=null,L):j===null||_e(j)?r(j):(e.consume(j),A)}function R(j){return j===null||j===34||j===39||j===47||j===60||j===61||j===62||j===96||ut(j)?k(j):(e.consume(j),R)}function L(j){return j===47||j===62||qe(j)?w(j):r(j)}function T(j){return j===62?(e.consume(j),z):r(j)}function z(j){return j===null||_e(j)?O(j):qe(j)?(e.consume(j),z):r(j)}function O(j){return j===45&&s===2?(e.consume(j),W):j===60&&s===1?(e.consume(j),K):j===62&&s===4?(e.consume(j),V):j===63&&s===3?(e.consume(j),N):j===93&&s===5?(e.consume(j),X):_e(j)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(OL,H,Y)(j)):j===null||_e(j)?(e.exit("htmlFlowData"),Y(j)):(e.consume(j),O)}function Y(j){return e.check(PL,G,H)(j)}function G(j){return e.enter("lineEnding"),e.consume(j),e.exit("lineEnding"),B}function B(j){return j===null||_e(j)?Y(j):(e.enter("htmlFlowData"),O(j))}function W(j){return j===45?(e.consume(j),N):O(j)}function K(j){return j===47?(e.consume(j),l="",P):O(j)}function P(j){if(j===62){const he=l.toLowerCase();return Vb.includes(he)?(e.consume(j),V):O(j)}return vr(j)&&l.length<8?(e.consume(j),l+=String.fromCharCode(j),P):O(j)}function X(j){return j===93?(e.consume(j),N):O(j)}function N(j){return j===62?(e.consume(j),V):j===45&&s===2?(e.consume(j),N):O(j)}function V(j){return j===null||_e(j)?(e.exit("htmlFlowData"),H(j)):(e.consume(j),V)}function H(j){return e.exit("htmlFlow"),t(j)}}function FL(e,t,r){const n=this;return s;function s(l){return _e(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):r(l)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}function UL(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(hc,t,r)}}const BL={name:"htmlText",tokenize:HL};function HL(e,t,r){const n=this;let s,i,l;return o;function o(N){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(N),u}function u(N){return N===33?(e.consume(N),c):N===47?(e.consume(N),k):N===63?(e.consume(N),w):vr(N)?(e.consume(N),R):r(N)}function c(N){return N===45?(e.consume(N),d):N===91?(e.consume(N),i=0,g):vr(N)?(e.consume(N),b):r(N)}function d(N){return N===45?(e.consume(N),p):r(N)}function h(N){return N===null?r(N):N===45?(e.consume(N),f):_e(N)?(l=h,K(N)):(e.consume(N),h)}function f(N){return N===45?(e.consume(N),p):h(N)}function p(N){return N===62?W(N):N===45?f(N):h(N)}function g(N){const V="CDATA[";return N===V.charCodeAt(i++)?(e.consume(N),i===V.length?y:g):r(N)}function y(N){return N===null?r(N):N===93?(e.consume(N),v):_e(N)?(l=y,K(N)):(e.consume(N),y)}function v(N){return N===93?(e.consume(N),x):y(N)}function x(N){return N===62?W(N):N===93?(e.consume(N),x):y(N)}function b(N){return N===null||N===62?W(N):_e(N)?(l=b,K(N)):(e.consume(N),b)}function w(N){return N===null?r(N):N===63?(e.consume(N),_):_e(N)?(l=w,K(N)):(e.consume(N),w)}function _(N){return N===62?W(N):w(N)}function k(N){return vr(N)?(e.consume(N),S):r(N)}function S(N){return N===45||or(N)?(e.consume(N),S):A(N)}function A(N){return _e(N)?(l=A,K(N)):qe(N)?(e.consume(N),A):W(N)}function R(N){return N===45||or(N)?(e.consume(N),R):N===47||N===62||ut(N)?L(N):r(N)}function L(N){return N===47?(e.consume(N),W):N===58||N===95||vr(N)?(e.consume(N),T):_e(N)?(l=L,K(N)):qe(N)?(e.consume(N),L):W(N)}function T(N){return N===45||N===46||N===58||N===95||or(N)?(e.consume(N),T):z(N)}function z(N){return N===61?(e.consume(N),O):_e(N)?(l=z,K(N)):qe(N)?(e.consume(N),z):L(N)}function O(N){return N===null||N===60||N===61||N===62||N===96?r(N):N===34||N===39?(e.consume(N),s=N,Y):_e(N)?(l=O,K(N)):qe(N)?(e.consume(N),O):(e.consume(N),G)}function Y(N){return N===s?(e.consume(N),s=void 0,B):N===null?r(N):_e(N)?(l=Y,K(N)):(e.consume(N),Y)}function G(N){return N===null||N===34||N===39||N===60||N===61||N===96?r(N):N===47||N===62||ut(N)?L(N):(e.consume(N),G)}function B(N){return N===47||N===62||ut(N)?L(N):r(N)}function W(N){return N===62?(e.consume(N),e.exit("htmlTextData"),e.exit("htmlText"),t):r(N)}function K(N){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),P}function P(N){return qe(N)?Ke(e,X,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):X(N)}function X(N){return e.enter("htmlTextData"),l(N)}}const Mg={name:"labelEnd",resolveAll:VL,resolveTo:WL,tokenize:GL},$L={tokenize:YL},zL={tokenize:QL},qL={tokenize:KL};function VL(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&Wr(e,0,e.length,r),e}function WL(e,t){let r=e.length,n=0,s,i,l,o;for(;r--;)if(s=e[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(l){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(l=r);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},d={type:"labelText",start:{...e[i+n+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",u,t],["enter",c,t]],o=ln(o,e.slice(i+1,i+n+3)),o=ln(o,[["enter",d,t]]),o=ln(o,Vh(t.parser.constructs.insideSpan.null,e.slice(i+n+4,l-3),t)),o=ln(o,[["exit",d,t],e[l-2],e[l-1],["exit",c,t]]),o=ln(o,e.slice(l+1)),o=ln(o,[["exit",u,t]]),Wr(e,i,e.length,o),e}function GL(e,t,r){const n=this;let s=n.events.length,i,l;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return o;function o(f){return i?i._inactive?h(f):(l=n.parser.defined.includes(Rn(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),u):r(f)}function u(f){return f===40?e.attempt($L,d,l?d:h)(f):f===91?e.attempt(zL,d,l?c:h)(f):l?d(f):h(f)}function c(f){return e.attempt(qL,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,r(f)}}function YL(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return ut(h)?Xo(e,i)(h):i(h)}function i(h){return h===41?d(h):LN(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function l(h){return ut(h)?Xo(e,u)(h):d(h)}function o(h){return r(h)}function u(h){return h===34||h===39||h===40?PN(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function c(h){return ut(h)?Xo(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function QL(e,t,r){const n=this;return s;function s(o){return ON.call(n,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return n.parser.defined.includes(Rn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function l(o){return r(o)}}function KL(e,t,r){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):r(i)}}const ZL={name:"labelStartImage",resolveAll:Mg.resolveAll,tokenize:XL};function XL(e,t,r){const n=this;return s;function s(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):r(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const JL={name:"labelStartLink",resolveAll:Mg.resolveAll,tokenize:eO};function eO(e,t,r){const n=this;return s;function s(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const im={name:"lineEnding",tokenize:tO};function tO(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Ke(e,t,"linePrefix")}}const md={name:"thematicBreak",tokenize:rO};function rO(e,t,r){let n=0,s;return i;function i(c){return e.enter("thematicBreak"),l(c)}function l(c){return s=c,o(c)}function o(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):n>=3&&(c===null||_e(c))?(e.exit("thematicBreak"),t(c)):r(c)}function u(c){return c===s?(e.consume(c),n++,u):(e.exit("thematicBreakSequence"),qe(c)?Ke(e,o,"whitespace")(c):o(c))}}const Cr={continuation:{tokenize:iO},exit:oO,name:"list",tokenize:aO},nO={partial:!0,tokenize:uO},sO={partial:!0,tokenize:lO};function aO(e,t,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,l=0;return o;function o(p){const g=n.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!n.containerState.marker||p===n.containerState.marker:Qp(p)){if(n.containerState.type||(n.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),p===42||p===45?e.check(md,r,c)(p):c(p);if(!n.interrupt||p===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(p)}return r(p)}function u(p){return Qp(p)&&++l<10?(e.consume(p),u):(!n.interrupt||l<2)&&(n.containerState.marker?p===n.containerState.marker:p===41||p===46)?(e.exit("listItemValue"),c(p)):r(p)}function c(p){return e.enter("listItemMarker"),e.consume(p),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||p,e.check(hc,n.interrupt?r:d,e.attempt(nO,f,h))}function d(p){return n.containerState.initialBlankLine=!0,i++,f(p)}function h(p){return qe(p)?(e.enter("listItemPrefixWhitespace"),e.consume(p),e.exit("listItemPrefixWhitespace"),f):r(p)}function f(p){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(p)}}function iO(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(hc,s,i);function s(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Ke(e,t,"listItemIndent",n.containerState.size+1)(o)}function i(o){return n.containerState.furtherBlankLines||!qe(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,l(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(sO,t,l)(o))}function l(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,Ke(e,e.attempt(Cr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function lO(e,t,r){const n=this;return Ke(e,s,"listItemIndent",n.containerState.size+1);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===n.containerState.size?t(i):r(i)}}function oO(e){e.exit(this.containerState.type)}function uO(e,t,r){const n=this;return Ke(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const l=n.events[n.events.length-1];return!qe(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):r(i)}}const Wb={name:"setextUnderline",resolveTo:cO,tokenize:dO};function cO(e,t){let r=e.length,n,s,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!i&&e[r][1].type==="definition"&&(i=r);const l={type:"setextHeading",start:{...e[s][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",l,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=l,e.push(["exit",l,t]),e}function dO(e,t,r){const n=this;let s;return i;function i(c){let d=n.events.length,h;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){h=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),s=c,l(c)):r(c)}function l(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===s?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),qe(c)?Ke(e,u,"lineSuffix")(c):u(c))}function u(c){return c===null||_e(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const hO={tokenize:fO};function fO(e){const t=this,r=e.attempt(hc,n,e.attempt(this.parser.constructs.flowInitial,s,Ke(e,e.attempt(this.parser.constructs.flow,s,e.attempt(yL,s)),"linePrefix")));return r;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const mO={resolveAll:MN()},pO=DN("string"),gO=DN("text");function DN(e){return{resolveAll:MN(e==="text"?xO:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],i=r.attempt(s,l,o);return l;function l(d){return c(d)?i(d):o(d)}function o(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),u}function u(d){return c(d)?(r.exit("data"),i(d)):(r.consume(d),u)}function c(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const p=h[f];if(!p.previous||p.previous.call(n,n.previous))return!0}return!1}}}function MN(e){return t;function t(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(r,n):r}}function xO(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let i=s.length,l=-1,o=0,u;for(;i--;){const c=s[i];if(typeof c=="string"){for(l=c.length;c.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(c===-2)u=!0,o++;else if(c!==-1){i++;break}}if(o){const c={type:r===e.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:n.start._bufferIndex+l,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const yO={42:Cr,43:Cr,45:Cr,48:Cr,49:Cr,50:Cr,51:Cr,52:Cr,53:Cr,54:Cr,55:Cr,56:Cr,57:Cr,62:jN},bO={91:NL},vO={[-2]:am,[-1]:am,32:am},wO={35:jL,42:md,45:[Wb,md],60:LL,61:Wb,95:md,96:qb,126:qb},EO={38:IN,92:AN},NO={[-5]:im,[-4]:im,[-3]:im,33:ZL,38:IN,42:Kp,60:[JR,BL],91:JL,92:[TL,AN],93:Mg,95:Kp,96:hL},kO={null:[Kp,mO]},_O={null:[42,95]},SO={null:[]},TO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:_O,contentInitial:bO,disable:SO,document:yO,flow:wO,flowInitial:vO,insideSpan:kO,string:EO,text:NO},Symbol.toStringTag,{value:"Module"}));function CO(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let l=[],o=[];const u={attempt:A(k),check:A(S),consume:b,enter:w,exit:_,interrupt:A(S,{interrupt:!0})},c={code:null,containerState:{},defineSkip:y,events:[],now:g,parser:e,previous:null,sliceSerialize:f,sliceStream:p,write:h};let d=t.tokenize.call(c,u);return t.resolveAll&&i.push(t),c;function h(z){return l=ln(l,z),v(),l[l.length-1]!==null?[]:(R(t,0),c.events=Vh(i,c.events,c),c.events)}function f(z,O){return AO(p(z),O)}function p(z){return jO(l,z)}function g(){const{_bufferIndex:z,_index:O,line:Y,column:G,offset:B}=n;return{_bufferIndex:z,_index:O,line:Y,column:G,offset:B}}function y(z){s[z.line]=z.column,T()}function v(){let z;for(;n._index<l.length;){const O=l[n._index];if(typeof O=="string")for(z=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===z&&n._bufferIndex<O.length;)x(O.charCodeAt(n._bufferIndex));else x(O)}}function x(z){d=d(z)}function b(z){_e(z)?(n.line++,n.column=1,n.offset+=z===-3?2:1,T()):z!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=z}function w(z,O){const Y=O||{};return Y.type=z,Y.start=g(),c.events.push(["enter",Y,c]),o.push(Y),Y}function _(z){const O=o.pop();return O.end=g(),c.events.push(["exit",O,c]),O}function k(z,O){R(z,O.from)}function S(z,O){O.restore()}function A(z,O){return Y;function Y(G,B,W){let K,P,X,N;return Array.isArray(G)?H(G):"tokenize"in G?H([G]):V(G);function V(q){return $;function $(Z){const te=Z!==null&&q[Z],ge=Z!==null&&q.null,we=[...Array.isArray(te)?te:te?[te]:[],...Array.isArray(ge)?ge:ge?[ge]:[]];return H(we)(Z)}}function H(q){return K=q,P=0,q.length===0?W:j(q[P])}function j(q){return $;function $(Z){return N=L(),X=q,q.partial||(c.currentConstruct=q),q.name&&c.parser.constructs.disable.null.includes(q.name)?J():q.tokenize.call(O?Object.assign(Object.create(c),O):c,u,he,J)(Z)}}function he(q){return z(X,N),B}function J(q){return N.restore(),++P<K.length?j(K[P]):W}}}function R(z,O){z.resolveAll&&!i.includes(z)&&i.push(z),z.resolve&&Wr(c.events,O,c.events.length-O,z.resolve(c.events.slice(O),c)),z.resolveTo&&(c.events=z.resolveTo(c.events,c))}function L(){const z=g(),O=c.previous,Y=c.currentConstruct,G=c.events.length,B=Array.from(o);return{from:G,restore:W};function W(){n=z,c.previous=O,c.currentConstruct=Y,c.events.length=G,o=B,T()}}function T(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function jO(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let l;if(r===s)l=[e[r].slice(n,i)];else{if(l=e.slice(r,s),n>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(n):l.shift()}i>0&&l.push(e[s].slice(0,i))}return l}function AO(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const i=e[r];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&s)continue;l=" ";break}default:l=String.fromCharCode(i)}s=i===-2,n.push(l)}return n.join("")}function IO(e){const n={constructs:TN([TO,...(e||{}).extensions||[]]),content:s(WR),defined:[],document:s(YR),flow:s(hO),lazy:{},string:s(pO),text:s(gO)};return n;function s(i){return l;function l(o){return CO(n,i,o)}}}function RO(e){for(;!RN(e););return e}const Gb=/[\0\t\n\r]/g;function LO(){let e=1,t="",r=!0,n;return s;function s(i,l,o){const u=[];let c,d,h,f,p;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),h=0,t="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if(Gb.lastIndex=h,c=Gb.exec(i),f=c&&c.index!==void 0?c.index:i.length,p=i.charCodeAt(f),!c){t=i.slice(h);break}if(p===10&&h===f&&n)u.push(-3),n=void 0;else switch(n&&(u.push(-5),n=void 0),h<f&&(u.push(i.slice(h,f)),e+=f-h),p){case 0:{u.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,u.push(-2);e++<d;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:n=!0,e=1}h=f+1}return o&&(n&&u.push(-5),t&&u.push(t),u.push(null)),u}}const OO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function PO(e){return e.replace(OO,DO)}function DO(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return CN(r.slice(i?2:1),i?16:10)}return Dg(r)||e}const FN={}.hasOwnProperty;function MO(e,t,r){return typeof t!="string"&&(r=t,t=void 0),FO(r)(RO(IO(r).document().write(LO()(e,t,!0))))}function FO(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(pn),autolinkProtocol:L,autolinkEmail:L,atxHeading:i(Ct),blockQuote:i(ge),characterEscape:L,characterReference:L,codeFenced:i(we),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(we,l),codeText:i(Te,l),codeTextData:L,data:L,codeFlowValue:L,definition:i(ze),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Ze),hardBreakEscape:i(ot),hardBreakTrailing:i(ot),htmlFlow:i(pt,l),htmlFlowData:L,htmlText:i(pt,l),htmlTextData:L,image:i(Ye),label:l,link:i(pn),listItem:i(as),listItemValue:f,listOrdered:i(at,h),listUnordered:i(at),paragraph:i(pr),reference:j,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i(Ct),strong:i(Ie),thematicBreak:i(ji)},exit:{atxHeading:u(),atxHeadingSequence:k,autolink:u(),autolinkEmail:te,autolinkProtocol:Z,blockQuote:u(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:J,characterReferenceMarkerNumeric:J,characterReferenceValue:q,characterReference:$,codeFenced:u(v),codeFencedFence:y,codeFencedFenceInfo:p,codeFencedFenceMeta:g,codeFlowValue:T,codeIndented:u(x),codeText:u(B),codeTextData:T,data:T,definition:u(),definitionDestinationString:_,definitionLabelString:b,definitionTitleString:w,emphasis:u(),hardBreakEscape:u(O),hardBreakTrailing:u(O),htmlFlow:u(Y),htmlFlowData:T,htmlText:u(G),htmlTextData:T,image:u(K),label:X,labelText:P,lineEnding:z,link:u(W),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:he,resourceDestinationString:N,resourceTitleString:V,resource:H,setextHeading:u(R),setextHeadingLineSequence:A,setextHeadingText:S,strong:u(),thematicBreak:u()}};UN(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(se){let de={type:"root",children:[]};const je={stack:[de],tokenStack:[],config:t,enter:o,exit:c,buffer:l,resume:d,data:r},Re=[];let Je=-1;for(;++Je<se.length;)if(se[Je][1].type==="listOrdered"||se[Je][1].type==="listUnordered")if(se[Je][0]==="enter")Re.push(Je);else{const gr=Re.pop();Je=s(se,gr,Je)}for(Je=-1;++Je<se.length;){const gr=t[se[Je][0]];FN.call(gr,se[Je][1].type)&&gr[se[Je][1].type].call(Object.assign({sliceSerialize:se[Je][2].sliceSerialize},je),se[Je][1])}if(je.tokenStack.length>0){const gr=je.tokenStack[je.tokenStack.length-1];(gr[1]||Yb).call(je,void 0,gr[0])}for(de.position={start:Ds(se.length>0?se[0][1].start:{line:1,column:1,offset:0}),end:Ds(se.length>0?se[se.length-2][1].end:{line:1,column:1,offset:0})},Je=-1;++Je<t.transforms.length;)de=t.transforms[Je](de)||de;return de}function s(se,de,je){let Re=de-1,Je=-1,gr=!1,gn,Vt,xn,nr;for(;++Re<=je;){const Nt=se[Re];switch(Nt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Nt[0]==="enter"?Je++:Je--,nr=void 0;break}case"lineEndingBlank":{Nt[0]==="enter"&&(gn&&!nr&&!Je&&!xn&&(xn=Re),nr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:nr=void 0}if(!Je&&Nt[0]==="enter"&&Nt[1].type==="listItemPrefix"||Je===-1&&Nt[0]==="exit"&&(Nt[1].type==="listUnordered"||Nt[1].type==="listOrdered")){if(gn){let Xr=Re;for(Vt=void 0;Xr--;){const _r=se[Xr];if(_r[1].type==="lineEnding"||_r[1].type==="lineEndingBlank"){if(_r[0]==="exit")continue;Vt&&(se[Vt][1].type="lineEndingBlank",gr=!0),_r[1].type="lineEnding",Vt=Xr}else if(!(_r[1].type==="linePrefix"||_r[1].type==="blockQuotePrefix"||_r[1].type==="blockQuotePrefixWhitespace"||_r[1].type==="blockQuoteMarker"||_r[1].type==="listItemIndent"))break}xn&&(!Vt||xn<Vt)&&(gn._spread=!0),gn.end=Object.assign({},Vt?se[Vt][1].start:Nt[1].end),se.splice(Vt||Re,0,["exit",gn,Nt[2]]),Re++,je++}if(Nt[1].type==="listItemPrefix"){const Xr={type:"listItem",_spread:!1,start:Object.assign({},Nt[1].start),end:void 0};gn=Xr,se.splice(Re,0,["enter",Xr,Nt[2]]),Re++,je++,xn=void 0,nr=!0}}}return se[de][1]._spread=gr,je}function i(se,de){return je;function je(Re){o.call(this,se(Re),Re),de&&de.call(this,Re)}}function l(){this.stack.push({type:"fragment",children:[]})}function o(se,de,je){this.stack[this.stack.length-1].children.push(se),this.stack.push(se),this.tokenStack.push([de,je||void 0]),se.position={start:Ds(de.start),end:void 0}}function u(se){return de;function de(je){se&&se.call(this,je),c.call(this,je)}}function c(se,de){const je=this.stack.pop(),Re=this.tokenStack.pop();if(Re)Re[0].type!==se.type&&(de?de.call(this,se,Re[0]):(Re[1]||Yb).call(this,se,Re[0]));else throw new Error("Cannot close `"+se.type+"` ("+Zo({start:se.start,end:se.end})+"): its not open");je.position.end=Ds(se.end)}function d(){return Pg(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(se){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(se),10),this.data.expectingFirstListItemValue=void 0}}function p(){const se=this.resume(),de=this.stack[this.stack.length-1];de.lang=se}function g(){const se=this.resume(),de=this.stack[this.stack.length-1];de.meta=se}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const se=this.resume(),de=this.stack[this.stack.length-1];de.value=se.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const se=this.resume(),de=this.stack[this.stack.length-1];de.value=se.replace(/(\r?\n|\r)$/g,"")}function b(se){const de=this.resume(),je=this.stack[this.stack.length-1];je.label=de,je.identifier=Rn(this.sliceSerialize(se)).toLowerCase()}function w(){const se=this.resume(),de=this.stack[this.stack.length-1];de.title=se}function _(){const se=this.resume(),de=this.stack[this.stack.length-1];de.url=se}function k(se){const de=this.stack[this.stack.length-1];if(!de.depth){const je=this.sliceSerialize(se).length;de.depth=je}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function A(se){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(se).codePointAt(0)===61?1:2}function R(){this.data.setextHeadingSlurpLineEnding=void 0}function L(se){const je=this.stack[this.stack.length-1].children;let Re=je[je.length-1];(!Re||Re.type!=="text")&&(Re=tt(),Re.position={start:Ds(se.start),end:void 0},je.push(Re)),this.stack.push(Re)}function T(se){const de=this.stack.pop();de.value+=this.sliceSerialize(se),de.position.end=Ds(se.end)}function z(se){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=de.children[de.children.length-1];je.position.end=Ds(se.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(de.type)&&(L.call(this,se),T.call(this,se))}function O(){this.data.atHardBreak=!0}function Y(){const se=this.resume(),de=this.stack[this.stack.length-1];de.value=se}function G(){const se=this.resume(),de=this.stack[this.stack.length-1];de.value=se}function B(){const se=this.resume(),de=this.stack[this.stack.length-1];de.value=se}function W(){const se=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";se.type+="Reference",se.referenceType=de,delete se.url,delete se.title}else delete se.identifier,delete se.label;this.data.referenceType=void 0}function K(){const se=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";se.type+="Reference",se.referenceType=de,delete se.url,delete se.title}else delete se.identifier,delete se.label;this.data.referenceType=void 0}function P(se){const de=this.sliceSerialize(se),je=this.stack[this.stack.length-2];je.label=PO(de),je.identifier=Rn(de).toLowerCase()}function X(){const se=this.stack[this.stack.length-1],de=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const Re=se.children;je.children=Re}else je.alt=de}function N(){const se=this.resume(),de=this.stack[this.stack.length-1];de.url=se}function V(){const se=this.resume(),de=this.stack[this.stack.length-1];de.title=se}function H(){this.data.inReference=void 0}function j(){this.data.referenceType="collapsed"}function he(se){const de=this.resume(),je=this.stack[this.stack.length-1];je.label=de,je.identifier=Rn(this.sliceSerialize(se)).toLowerCase(),this.data.referenceType="full"}function J(se){this.data.characterReferenceType=se.type}function q(se){const de=this.sliceSerialize(se),je=this.data.characterReferenceType;let Re;je?(Re=CN(de,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Re=Dg(de);const Je=this.stack[this.stack.length-1];Je.value+=Re}function $(se){const de=this.stack.pop();de.position.end=Ds(se.end)}function Z(se){T.call(this,se);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(se)}function te(se){T.call(this,se);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(se)}function ge(){return{type:"blockquote",children:[]}}function we(){return{type:"code",lang:null,meta:null,value:""}}function Te(){return{type:"inlineCode",value:""}}function ze(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ze(){return{type:"emphasis",children:[]}}function Ct(){return{type:"heading",depth:0,children:[]}}function ot(){return{type:"break"}}function pt(){return{type:"html",value:""}}function Ye(){return{type:"image",title:null,url:"",alt:null}}function pn(){return{type:"link",title:null,url:"",children:[]}}function at(se){return{type:"list",ordered:se.type==="listOrdered",start:null,spread:se._spread,children:[]}}function as(se){return{type:"listItem",spread:se._spread,checked:null,children:[]}}function pr(){return{type:"paragraph",children:[]}}function Ie(){return{type:"strong",children:[]}}function tt(){return{type:"text",value:""}}function ji(){return{type:"thematicBreak"}}}function Ds(e){return{line:e.line,column:e.column,offset:e.offset}}function UN(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?UN(e,n):UO(e,n)}}function UO(e,t){let r;for(r in t)if(FN.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function Yb(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Zo({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Zo({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Zo({start:t.start,end:t.end})+") is still open")}function BO(e){const t=this;t.parser=r;function r(n){return MO(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function HO(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function $O(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function zO(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function qO(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function VO(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function WO(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=no(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let l,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,u);const c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)}function GO(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function YO(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function BN(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const l=s[s.length-1];return l&&l.type==="text"?l.value+=n:s.push({type:"text",value:n}),s}function QO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return BN(e,t);const s={src:no(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function KO(e,t){const r={src:no(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function ZO(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function XO(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return BN(e,t);const s={href:no(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function JO(e,t){const r={href:no(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function eP(e,t,r){const n=e.all(t),s=r?tP(r):HN(t),i={},l=[];if(typeof t.checked=="boolean"){const d=n[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const d=n[o];(s||o!==0||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?l.push(...d.children):l.push(d)}const u=n[n.length-1];u&&(s||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,c),e.applyData(t,c)}function tP(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=HN(r[n])}return t}function HN(e){const t=e.spread;return t??e.children.length>1}function rP(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const l=n[s];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function nP(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function sP(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function aP(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function iP(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],l),s.push(l)}if(r.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=ns(t.children[1]),u=zh(t.children[t.children.length-1]);o&&u&&(l.position={start:o,end:u}),s.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function lP(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",l=r&&r.type==="table"?r.align:void 0,o=l?l.length:t.children.length;let u=-1;const c=[];for(;++u<o;){const h=t.children[u],f={},p=l?l[u]:void 0;p&&(f.align=p);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=e.all(h),e.patch(h,g),g=e.applyData(h,g)),c.push(g)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,d),e.applyData(t,d)}function oP(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const Qb=9,Kb=32;function uP(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const i=[];for(;n;)i.push(Zb(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return i.push(Zb(t.slice(s),s>0,!1)),i.join("")}function Zb(e,t,r){let n=0,s=e.length;if(t){let i=e.codePointAt(n);for(;i===Qb||i===Kb;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(s-1);for(;i===Qb||i===Kb;)s--,i=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function cP(e,t){const r={type:"text",value:uP(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function dP(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const hP={blockquote:HO,break:$O,code:zO,delete:qO,emphasis:VO,footnoteReference:WO,heading:GO,html:YO,imageReference:QO,image:KO,inlineCode:ZO,linkReference:XO,link:JO,listItem:eP,list:rP,paragraph:nP,root:sP,strong:aP,table:iP,tableCell:oP,tableRow:lP,text:cP,thematicBreak:dP,toml:Qc,yaml:Qc,definition:Qc,footnoteDefinition:Qc};function Qc(){}const $N=-1,Wh=0,Jo=1,Jd=2,Fg=3,Ug=4,Bg=5,Hg=6,zN=7,qN=8,Xb=typeof self=="object"?self:globalThis,fP=(e,t)=>{const r=(s,i)=>(e.set(i,s),s),n=s=>{if(e.has(s))return e.get(s);const[i,l]=t[s];switch(i){case Wh:case $N:return r(l,s);case Jo:{const o=r([],s);for(const u of l)o.push(n(u));return o}case Jd:{const o=r({},s);for(const[u,c]of l)o[n(u)]=n(c);return o}case Fg:return r(new Date(l),s);case Ug:{const{source:o,flags:u}=l;return r(new RegExp(o,u),s)}case Bg:{const o=r(new Map,s);for(const[u,c]of l)o.set(n(u),n(c));return o}case Hg:{const o=r(new Set,s);for(const u of l)o.add(n(u));return o}case zN:{const{name:o,message:u}=l;return r(new Xb[o](u),s)}case qN:return r(BigInt(l),s);case"BigInt":return r(Object(BigInt(l)),s);case"ArrayBuffer":return r(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return r(new DataView(o),l)}}return r(new Xb[i](l),s)};return n},Jb=e=>fP(new Map,e)(0),Fi="",{toString:mP}={},{keys:pP}=Object,ko=e=>{const t=typeof e;if(t!=="object"||!e)return[Wh,t];const r=mP.call(e).slice(8,-1);switch(r){case"Array":return[Jo,Fi];case"Object":return[Jd,Fi];case"Date":return[Fg,Fi];case"RegExp":return[Ug,Fi];case"Map":return[Bg,Fi];case"Set":return[Hg,Fi];case"DataView":return[Jo,r]}return r.includes("Array")?[Jo,r]:r.includes("Error")?[zN,r]:[Jd,r]},Kc=([e,t])=>e===Wh&&(t==="function"||t==="symbol"),gP=(e,t,r,n)=>{const s=(l,o)=>{const u=n.push(l)-1;return r.set(o,u),u},i=l=>{if(r.has(l))return r.get(l);let[o,u]=ko(l);switch(o){case Wh:{let d=l;switch(u){case"bigint":o=qN,d=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);d=null;break;case"undefined":return s([$N],l)}return s([o,d],l)}case Jo:{if(u){let f=l;return u==="DataView"?f=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(f=new Uint8Array(l)),s([u,[...f]],l)}const d=[],h=s([o,d],l);for(const f of l)d.push(i(f));return h}case Jd:{if(u)switch(u){case"BigInt":return s([u,l.toString()],l);case"Boolean":case"Number":case"String":return s([u,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const d=[],h=s([o,d],l);for(const f of pP(l))(e||!Kc(ko(l[f])))&&d.push([i(f),i(l[f])]);return h}case Fg:return s([o,l.toISOString()],l);case Ug:{const{source:d,flags:h}=l;return s([o,{source:d,flags:h}],l)}case Bg:{const d=[],h=s([o,d],l);for(const[f,p]of l)(e||!(Kc(ko(f))||Kc(ko(p))))&&d.push([i(f),i(p)]);return h}case Hg:{const d=[],h=s([o,d],l);for(const f of l)(e||!Kc(ko(f)))&&d.push(i(f));return h}}const{message:c}=l;return s([o,{name:u,message:c}],l)};return i},e1=(e,{json:t,lossy:r}={})=>{const n=[];return gP(!(t||r),!!t,new Map,n)(e),n},bi=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Jb(e1(e,t)):structuredClone(e):(e,t)=>Jb(e1(e,t));function xP(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function yP(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function bP(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||xP,n=e.options.footnoteBackLabel||yP,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[u]);if(!c)continue;const d=e.all(c),h=String(c.identifier).toUpperCase(),f=no(h.toLowerCase());let p=0;const g=[],y=e.footnoteCounts.get(h);for(;y!==void 0&&++p<=y;){g.length>0&&g.push({type:"text",value:" "});let b=typeof r=="string"?r:r(u,p);typeof b=="string"&&(b={type:"text",value:b}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,p),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const v=d[d.length-1];if(v&&v.type==="element"&&v.tagName==="p"){const b=v.children[v.children.length-1];b&&b.type==="text"?b.value+=" ":v.children.push({type:"text",value:" "}),v.children.push(...g)}else d.push(...g);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(c,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...bi(l),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const Gh=function(e){if(e==null)return NP;if(typeof e=="function")return Yh(e);if(typeof e=="object")return Array.isArray(e)?vP(e):wP(e);if(typeof e=="string")return EP(e);throw new Error("Expected function, string, or object as test")};function vP(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=Gh(e[r]);return Yh(n);function n(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function wP(e){const t=e;return Yh(r);function r(n){const s=n;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function EP(e){return Yh(t);function t(r){return r&&r.type===e}}function Yh(e){return t;function t(r,n,s){return!!(kP(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function NP(){return!0}function kP(e){return e!==null&&typeof e=="object"&&"type"in e}const VN=[],_P=!0,Zp=!1,SP="skip";function WN(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const i=Gh(s),l=n?-1:1;o(e,void 0,[])();function o(u,c,d){const h=u&&typeof u=="object"?u:{};if(typeof h.type=="string"){const p=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(u.type+(p?"<"+p+">":""))+")"})}return f;function f(){let p=VN,g,y,v;if((!t||i(u,c,d[d.length-1]||void 0))&&(p=TP(r(u,d)),p[0]===Zp))return p;if("children"in u&&u.children){const x=u;if(x.children&&p[0]!==SP)for(y=(n?x.children.length:-1)+l,v=d.concat(x);y>-1&&y<x.children.length;){const b=x.children[y];if(g=o(b,y,v)(),g[0]===Zp)return g;y=typeof g[1]=="number"?g[1]:y+l}}return p}}}function TP(e){return Array.isArray(e)?e:typeof e=="number"?[_P,e]:e==null?VN:[e]}function Qh(e,t,r,n){let s,i,l;typeof t=="function"&&typeof r!="function"?(i=void 0,l=t,s=r):(i=t,l=r,s=n),WN(e,i,o,s);function o(u,c){const d=c[c.length-1],h=d?d.children.indexOf(u):void 0;return l(u,h,d)}}const Xp={}.hasOwnProperty,CP={};function jP(e,t){const r=t||CP,n=new Map,s=new Map,i=new Map,l={...hP,...r.handlers},o={all:c,applyData:IP,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:u,options:r,patch:AP,wrap:LP};return Qh(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?n:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),o;function u(d,h){const f=d.type,p=o.handlers[f];if(Xp.call(o.handlers,f)&&p)return p(o,d,h);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in d){const{children:y,...v}=d,x=bi(v);return x.children=o.all(d),x}return bi(d)}return(o.options.unknownHandler||RP)(o,d,h)}function c(d){const h=[];if("children"in d){const f=d.children;let p=-1;for(;++p<f.length;){const g=o.one(f[p],d);if(g){if(p&&f[p-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=t1(g.value)),!Array.isArray(g)&&g.type==="element")){const y=g.children[0];y&&y.type==="text"&&(y.value=t1(y.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function AP(e,t){e.position&&(t.position=wN(e))}function IP(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const l="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:l}}r.type==="element"&&i&&Object.assign(r.properties,bi(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function RP(e,t){const r=t.data||{},n="value"in t&&!(Xp.call(r,"hProperties")||Xp.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function LP(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function t1(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function r1(e,t){const r=jP(e,t),n=r.one(e,void 0),s=bP(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function OP(e,t){return e&&"run"in e?async function(r,n){const s=r1(r,{file:n,...t});await e.run(s,n)}:function(r,n){return r1(r,{file:n,...e||t})}}function n1(e){if(e)throw e}var pd=Object.prototype.hasOwnProperty,GN=Object.prototype.toString,s1=Object.defineProperty,a1=Object.getOwnPropertyDescriptor,i1=function(t){return typeof Array.isArray=="function"?Array.isArray(t):GN.call(t)==="[object Array]"},l1=function(t){if(!t||GN.call(t)!=="[object Object]")return!1;var r=pd.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&pd.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||pd.call(t,s)},o1=function(t,r){s1&&r.name==="__proto__"?s1(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},u1=function(t,r){if(r==="__proto__")if(pd.call(t,r)){if(a1)return a1(t,r).value}else return;return t[r]},PP=function e(){var t,r,n,s,i,l,o=arguments[0],u=1,c=arguments.length,d=!1;for(typeof o=="boolean"&&(d=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=u1(o,r),s=u1(t,r),o!==s&&(d&&s&&(l1(s)||(i=i1(s)))?(i?(i=!1,l=n&&i1(n)?n:[]):l=n&&l1(n)?n:{},o1(o,{name:r,newValue:e(d,l,s)})):typeof s<"u"&&o1(o,{name:r,newValue:s}));return o};const lm=dh(PP);function Jp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function DP(){const e=[],t={run:r,use:n};return t;function r(...s){let i=-1;const l=s.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...s);function o(u,...c){const d=e[++i];let h=-1;if(u){l(u);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,d?MP(d,o)(...c):l(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function MP(e,t){let r;return n;function n(...l){const o=e.length>l.length;let u;o&&l.push(s);try{u=e.apply(this,l)}catch(c){const d=c;if(o&&r)throw d;return s(d)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,s):u instanceof Error?s(u):i(u))}function s(l,...o){r||(r=!0,t(l,...o))}function i(l){s(null,l)}}const zn={basename:FP,dirname:UP,extname:BP,join:HP,sep:"/"};function FP(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');fc(e);let r=0,n=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let l=-1,o=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else l<0&&(i=!0,l=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(n=s):(o=-1,n=l));return r===n?n=l:n<0&&(n=e.length),e.slice(r,n)}function UP(e){if(fc(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function BP(e){fc(e);let t=e.length,r=-1,n=0,s=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){n=t+1;break}continue}r<0&&(l=!0,r=t+1),o===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function HP(...e){let t=-1,r;for(;++t<e.length;)fc(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":$P(r)}function $P(e){fc(e);const t=e.codePointAt(0)===47;let r=zP(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function zP(e,t){let r="",n=0,s=-1,i=0,l=-1,o,u;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(u=r.lastIndexOf("/"),u!==r.length-1){u<0?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf("/")),s=l,i=0;continue}}else if(r.length>0){r="",n=0,s=l,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),n=l-s-1;s=l,i=0}else o===46&&i>-1?i++:i=-1}return r}function fc(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const qP={cwd:VP};function VP(){return"/"}function e0(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function WP(e){if(typeof e=="string")e=new URL(e);else if(!e0(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return GP(e)}function GP(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const om=["history","path","basename","stem","extname","dirname"];class YN{constructor(t){let r;t?e0(t)?r={path:t}:typeof t=="string"||YP(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":qP.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<om.length;){const i=om[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)om.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?zn.basename(this.path):void 0}set basename(t){cm(t,"basename"),um(t,"basename"),this.path=zn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?zn.dirname(this.path):void 0}set dirname(t){c1(this.basename,"dirname"),this.path=zn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?zn.extname(this.path):void 0}set extname(t){if(um(t,"extname"),c1(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=zn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){e0(t)&&(t=WP(t)),cm(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?zn.basename(this.path,this.extname):void 0}set stem(t){cm(t,"stem"),um(t,"stem"),this.path=zn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new fr(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function um(e,t){if(e&&e.includes(zn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+zn.sep+"`")}function cm(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function c1(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function YP(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const QP=function(e){const n=this.constructor.prototype,s=n[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},KP={}.hasOwnProperty;class $g extends QP{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=DP()}copy(){const t=new $g;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(lm(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(fm("data",this.frozen),this.namespace[t]=r,this):KP.call(this.namespace,t)&&this.namespace[t]||void 0:t?(fm("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=Zc(t),n=this.parser||this.Parser;return dm("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),dm("process",this.parser||this.Parser),hm("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,l){const o=Zc(t),u=n.parse(o);n.run(u,o,function(d,h,f){if(d||!h||!f)return c(d);const p=h,g=n.stringify(p,f);JP(g)?f.value=g:f.result=g,c(d,f)});function c(d,h){d||!h?l(d):i?i(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),dm("processSync",this.parser||this.Parser),hm("processSync",this.compiler||this.Compiler),this.process(t,s),h1("processSync","process",r),n;function s(i,l){r=!0,n1(i),n=l}}run(t,r,n){d1(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(l,o){const u=Zc(r);s.run(t,u,c);function c(d,h,f){const p=h||t;d?o(d):l?l(p):n(void 0,p,f)}}}runSync(t,r){let n=!1,s;return this.run(t,r,i),h1("runSync","run",n),s;function i(l,o){n1(l),s=o,n=!0}}stringify(t,r){this.freeze();const n=Zc(r),s=this.compiler||this.Compiler;return hm("stringify",s),d1(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(fm("use",this.frozen),t!=null)if(typeof t=="function")u(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")u(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...h]=c;u(d,h)}else l(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function l(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(s.settings=lm(!0,s.settings,c.settings))}function o(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const h=c[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function u(c,d){let h=-1,f=-1;for(;++h<n.length;)if(n[h][0]===c){f=h;break}if(f===-1)n.push([c,...d]);else if(d.length>0){let[p,...g]=d;const y=n[f][1];Jp(y)&&Jp(p)&&(p=lm(!0,y,p)),n[f]=[c,p,...g]}}}}const ZP=new $g().freeze();function dm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function hm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function fm(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function d1(e){if(!Jp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function h1(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Zc(e){return XP(e)?e:new YN(e)}function XP(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function JP(e){return typeof e=="string"||eD(e)}function eD(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const tD="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",f1=[],m1={allowDangerousHtml:!0},rD=/^(https?|ircs?|mailto|xmpp)$/i,nD=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function QN(e){const t=e.allowedElements,r=e.allowElement,n=e.children||"",s=e.className,i=e.components,l=e.disallowedElements,o=e.rehypePlugins||f1,u=e.remarkPlugins||f1,c=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...m1}:m1,d=e.skipHtml,h=e.unwrapDisallowed,f=e.urlTransform||sD,p=ZP().use(BO).use(u).use(OP,c).use(o),g=new YN;typeof n=="string"&&(g.value=n);for(const b of nD)Object.hasOwn(e,b.from)&&(""+b.from+(b.to?"use `"+b.to+"` instead":"remove it")+tD+b.id,void 0);const y=p.parse(g);let v=p.runSync(y,g);return s&&(v={type:"element",tagName:"div",properties:{className:s},children:v.type==="root"?v.children:[v]}),Qh(v,x),ER(v,{Fragment:a.Fragment,components:i,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function x(b,w,_){if(b.type==="raw"&&_&&typeof w=="number")return d?_.children.splice(w,1):_.children[w]={type:"text",value:b.value},w;if(b.type==="element"){let k;for(k in sm)if(Object.hasOwn(sm,k)&&Object.hasOwn(b.properties,k)){const S=b.properties[k],A=sm[k];(A===null||A.includes(b.tagName))&&(b.properties[k]=f(String(S||""),k,b))}}if(b.type==="element"){let k=t?!t.includes(b.tagName):l?l.includes(b.tagName):!1;if(!k&&r&&typeof w=="number"&&(k=!r(b,w,_)),k&&_&&typeof w=="number")return h&&b.children?_.children.splice(w,1,...b.children):_.children.splice(w,1),w}}}function sD(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||rD.test(e.slice(0,t))?e:""}function p1(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(t);for(;s!==-1;)n++,s=r.indexOf(t,s+t.length);return n}function aD(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function iD(e,t,r){const s=Gh((r||{}).ignore||[]),i=lD(t);let l=-1;for(;++l<i.length;)WN(e,"text",o);function o(c,d){let h=-1,f;for(;++h<d.length;){const p=d[h],g=f?f.children:void 0;if(s(p,g?g.indexOf(p):void 0,f))return;f=p}if(f)return u(c,d)}function u(c,d){const h=d[d.length-1],f=i[l][0],p=i[l][1];let g=0;const v=h.children.indexOf(c);let x=!1,b=[];f.lastIndex=0;let w=f.exec(c.value);for(;w;){const _=w.index,k={index:w.index,input:w.input,stack:[...d,c]};let S=p(...w,k);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?f.lastIndex=_+1:(g!==_&&b.push({type:"text",value:c.value.slice(g,_)}),Array.isArray(S)?b.push(...S):S&&b.push(S),g=_+w[0].length,x=!0),!f.global)break;w=f.exec(c.value)}return x?(g<c.value.length&&b.push({type:"text",value:c.value.slice(g)}),h.children.splice(v,1,...b)):b=[c],v+b.length}}function lD(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let n=-1;for(;++n<r.length;){const s=r[n];t.push([oD(s[0]),uD(s[1])])}return t}function oD(e){return typeof e=="string"?new RegExp(aD(e),"g"):e}function uD(e){return typeof e=="function"?e:function(){return e}}const mm="phrasing",pm=["autolink","link","image","label"];function cD(){return{transforms:[xD],enter:{literalAutolink:hD,literalAutolinkEmail:gm,literalAutolinkHttp:gm,literalAutolinkWww:gm},exit:{literalAutolink:gD,literalAutolinkEmail:pD,literalAutolinkHttp:fD,literalAutolinkWww:mD}}}function dD(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:mm,notInConstruct:pm},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:mm,notInConstruct:pm},{character:":",before:"[ps]",after:"\\/",inConstruct:mm,notInConstruct:pm}]}}function hD(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function gm(e){this.config.enter.autolinkProtocol.call(this,e)}function fD(e){this.config.exit.autolinkProtocol.call(this,e)}function mD(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function pD(e){this.config.exit.autolinkEmail.call(this,e)}function gD(e){this.exit(e)}function xD(e){iD(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,yD],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),bD]],{ignore:["link","linkReference"]})}function yD(e,t,r,n,s){let i="";if(!KN(s)||(/^w/i.test(t)&&(r=t+r,t="",i="http://"),!vD(r)))return!1;const l=wD(r+n);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function bD(e,t,r,n){return!KN(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function vD(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function wD(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],n=r.indexOf(")");const s=p1(e,"(");let i=p1(e,")");for(;n!==-1&&s>i;)e+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[e,r]}function KN(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||yi(r)||qh(r))&&(!t||r!==47)}ZN.peek=RD;function ED(){return{enter:{gfmFootnoteDefinition:kD,gfmFootnoteDefinitionLabelString:_D,gfmFootnoteCall:CD,gfmFootnoteCallString:jD},exit:{gfmFootnoteDefinition:TD,gfmFootnoteDefinitionLabelString:SD,gfmFootnoteCall:ID,gfmFootnoteCallString:AD}}}function ND(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:LD,footnoteReference:ZN}}}function kD(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function _D(){this.buffer()}function SD(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=Rn(this.sliceSerialize(e)).toLowerCase()}function TD(e){this.exit(e)}function CD(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function jD(){this.buffer()}function AD(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=Rn(this.sliceSerialize(e)).toLowerCase()}function ID(e){this.exit(e)}function ZN(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteReference"),o=r.enter("reference");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),l(),i+=s.move("]"),i}function RD(){return"["}function LD(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteDefinition"),o=r.enter("label");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),i+=s.move("]:"+(e.children&&e.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(e,s.current()),OD)),l(),i}function OD(e,t,r){return t===0?e:(r?"":"    ")+e}const PD=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];XN.peek=BD;function DD(){return{canContainEols:["delete"],enter:{strikethrough:FD},exit:{strikethrough:UD}}}function MD(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:PD}],handlers:{delete:XN}}}function FD(e){this.enter({type:"delete",children:[]},e)}function UD(e){this.exit(e)}function XN(e,t,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let l=s.move("~~");return l+=r.containerPhrasing(e,{...s.current(),before:l,after:"~"}),l+=s.move("~~"),i(),l}function BD(){return"~"}function HD(e){return e.length}function $D(e,t){const r=t||{},n=(r.align||[]).concat(),s=r.stringLength||HD,i=[],l=[],o=[],u=[];let c=0,d=-1;for(;++d<e.length;){const y=[],v=[];let x=-1;for(e[d].length>c&&(c=e[d].length);++x<e[d].length;){const b=zD(e[d][x]);if(r.alignDelimiters!==!1){const w=s(b);v[x]=w,(u[x]===void 0||w>u[x])&&(u[x]=w)}y.push(b)}l[d]=y,o[d]=v}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=g1(n[h]);else{const y=g1(n);for(;++h<c;)i[h]=y}h=-1;const f=[],p=[];for(;++h<c;){const y=i[h];let v="",x="";y===99?(v=":",x=":"):y===108?v=":":y===114&&(x=":");let b=r.alignDelimiters===!1?1:Math.max(1,u[h]-v.length-x.length);const w=v+"-".repeat(b)+x;r.alignDelimiters!==!1&&(b=v.length+b+x.length,b>u[h]&&(u[h]=b),p[h]=b),f[h]=w}l.splice(1,0,f),o.splice(1,0,p),d=-1;const g=[];for(;++d<l.length;){const y=l[d],v=o[d];h=-1;const x=[];for(;++h<c;){const b=y[h]||"";let w="",_="";if(r.alignDelimiters!==!1){const k=u[h]-(v[h]||0),S=i[h];S===114?w=" ".repeat(k):S===99?k%2?(w=" ".repeat(k/2+.5),_=" ".repeat(k/2-.5)):(w=" ".repeat(k/2),_=w):_=" ".repeat(k)}r.delimiterStart!==!1&&!h&&x.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&b==="")&&(r.delimiterStart!==!1||h)&&x.push(" "),r.alignDelimiters!==!1&&x.push(w),x.push(b),r.alignDelimiters!==!1&&x.push(_),r.padding!==!1&&x.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&x.push("|")}g.push(r.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return g.join(`
`)}function zD(e){return e==null?"":String(e)}function g1(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const x1={}.hasOwnProperty;function JN(e,t){const r=t||{};function n(s,...i){let l=n.invalid;const o=n.handlers;if(s&&x1.call(s,e)){const u=String(s[e]);l=x1.call(o,u)?o[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function qD(e,t,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const l=r.indentLines(r.containerFlow(e,i.current()),VD);return s(),l}function VD(e,t,r){return">"+(r?"":" ")+e}function WD(e,t){return y1(e,t.inConstruct,!0)&&!y1(e,t.notInConstruct,!1)}function y1(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function b1(e,t,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&WD(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function GD(e,t){const r=String(e);let n=r.indexOf(t),s=n,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>l&&(l=i):i=1,s=n+t.length,n=r.indexOf(t,s);return l}function YD(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function QD(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function KD(e,t,r,n){const s=QD(r),i=e.value||"",l=s==="`"?"GraveAccent":"Tilde";if(YD(e,r)){const h=r.enter("codeIndented"),f=r.indentLines(i,ZD);return h(),f}const o=r.createTracker(n),u=s.repeat(Math.max(GD(i,s)+1,3)),c=r.enter("codeFenced");let d=o.move(u);if(e.lang){const h=r.enter(`codeFencedLang${l}`);d+=o.move(r.safe(e.lang,{before:d,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=r.enter(`codeFencedMeta${l}`);d+=o.move(" "),d+=o.move(r.safe(e.meta,{before:d,after:`
`,encode:["`"],...o.current()})),h()}return d+=o.move(`
`),i&&(d+=o.move(i+`
`)),d+=o.move(u),c(),d}function ZD(e,t,r){return(r?"":"    ")+e}function zg(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function XD(e,t,r,n){const s=zg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("definition");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("[");return c+=u.move(r.safe(r.associationId(e),{before:c,after:"]",...u.current()})),c+=u.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),l(),c}function JD(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function Iu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function eh(e,t,r){const n=Hl(e),s=Hl(t);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}ek.peek=eM;function ek(e,t,r,n){const s=JD(r),i=r.enter("emphasis"),l=r.createTracker(n),o=l.move(s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=eh(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Iu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=eh(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Iu(h));const p=l.move(s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function eM(e,t,r){return r.options.emphasis||"*"}function tM(e,t){let r=!1;return Qh(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,Zp}),!!((!e.depth||e.depth<3)&&Pg(e)&&(t.options.setext||r))}function rM(e,t,r,n){const s=Math.max(Math.min(6,e.depth||1),1),i=r.createTracker(n);if(tM(e,r)){const d=r.enter("headingSetext"),h=r.enter("phrasing"),f=r.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const l="#".repeat(s),o=r.enter("headingAtx"),u=r.enter("phrasing");i.move(l+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=Iu(c.charCodeAt(0))+c.slice(1)),c=c?l+" "+c:l,r.options.closeAtx&&(c+=" "+l),u(),o(),c}tk.peek=nM;function tk(e){return e.value||""}function nM(){return"<"}rk.peek=sM;function rk(e,t,r,n){const s=zg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("image");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("![");return c+=u.move(r.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),l(),c}function sM(){return"!"}nk.peek=aM;function nk(e,t,r,n){const s=e.referenceType,i=r.enter("imageReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("![");const c=r.safe(e.alt,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function aM(){return"!"}sk.peek=iM;function sk(e,t,r){let n=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const l=r.unsafe[i],o=r.compilePattern(l);let u;if(l.atBreak)for(;u=o.exec(n);){let c=u.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(u.index+1)}}return s+n+s}function iM(){return"`"}function ak(e,t){const r=Pg(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}ik.peek=lM;function ik(e,t,r,n){const s=zg(r),i=s==='"'?"Quote":"Apostrophe",l=r.createTracker(n);let o,u;if(ak(e,r)){const d=r.stack;r.stack=[],o=r.enter("autolink");let h=l.move("<");return h+=l.move(r.containerPhrasing(e,{before:h,after:">",...l.current()})),h+=l.move(">"),o(),r.stack=d,h}o=r.enter("link"),u=r.enter("label");let c=l.move("[");return c+=l.move(r.containerPhrasing(e,{before:c,after:"](",...l.current()})),c+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(u=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(e.title,{before:c,after:s,...l.current()})),c+=l.move(s),u()),c+=l.move(")"),o(),c}function lM(e,t,r){return ak(e,r)?"<":"["}lk.peek=oM;function lk(e,t,r,n){const s=e.referenceType,i=r.enter("linkReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("[");const c=r.containerPhrasing(e,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function oM(){return"["}function qg(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function uM(e){const t=qg(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function cM(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function ok(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function dM(e,t,r,n){const s=r.enter("list"),i=r.bulletCurrent;let l=e.ordered?cM(r):qg(r);const o=e.ordered?l==="."?")":".":uM(r);let u=t&&r.bulletLastUsed?l===r.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&d&&(!d.children||!d.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(u=!0),ok(r)===l&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=o),r.bulletCurrent=l;const c=r.containerFlow(e,n);return r.bulletLastUsed=l,r.bulletCurrent=i,s(),c}function hM(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function fM(e,t,r,n){const s=hM(r);let i=r.bulletCurrent||qg(r);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=r.createTracker(n);o.move(i+" ".repeat(l-i.length)),o.shift(l);const u=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),d);return u(),c;function d(h,f,p){return f?(p?"":" ".repeat(l))+h:(p?i:i+" ".repeat(l-i.length))+h}}function mM(e,t,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),l=r.containerPhrasing(e,n);return i(),s(),l}const pM=Gh(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function gM(e,t,r,n){return(e.children.some(function(l){return pM(l)})?r.containerPhrasing:r.containerFlow).call(r,e,n)}function xM(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}uk.peek=yM;function uk(e,t,r,n){const s=xM(r),i=r.enter("strong"),l=r.createTracker(n),o=l.move(s+s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=eh(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=Iu(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=eh(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+Iu(h));const p=l.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function yM(e,t,r){return r.options.strong||"*"}function bM(e,t,r,n){return r.safe(e.value,n)}function vM(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function wM(e,t,r){const n=(ok(r)+(r.options.ruleSpaces?" ":"")).repeat(vM(r));return r.options.ruleSpaces?n.slice(0,-1):n}const ck={blockquote:qD,break:b1,code:KD,definition:XD,emphasis:ek,hardBreak:b1,heading:rM,html:tk,image:rk,imageReference:nk,inlineCode:sk,link:ik,linkReference:lk,list:dM,listItem:fM,paragraph:mM,root:gM,strong:uk,text:bM,thematicBreak:wM};function EM(){return{enter:{table:NM,tableData:v1,tableHeader:v1,tableRow:_M},exit:{codeText:SM,table:kM,tableData:xm,tableHeader:xm,tableRow:xm}}}function NM(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function kM(e){this.exit(e),this.data.inTable=void 0}function _M(e){this.enter({type:"tableRow",children:[]},e)}function xm(e){this.exit(e)}function v1(e){this.enter({type:"tableCell",children:[]},e)}function SM(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,TM));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function TM(e,t){return t==="|"?t:e}function CM(e){const t=e||{},r=t.tableCellPadding,n=t.tablePipeAlign,s=t.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:l,tableCell:u,tableRow:o}};function l(p,g,y,v){return c(d(p,y,v),p.align)}function o(p,g,y,v){const x=h(p,y,v),b=c([x]);return b.slice(0,b.indexOf(`
`))}function u(p,g,y,v){const x=y.enter("tableCell"),b=y.enter("phrasing"),w=y.containerPhrasing(p,{...v,before:i,after:i});return b(),x(),w}function c(p,g){return $D(p,{align:g,alignDelimiters:n,padding:r,stringLength:s})}function d(p,g,y){const v=p.children;let x=-1;const b=[],w=g.enter("table");for(;++x<v.length;)b[x]=h(v[x],g,y);return w(),b}function h(p,g,y){const v=p.children;let x=-1;const b=[],w=g.enter("tableRow");for(;++x<v.length;)b[x]=u(v[x],p,g,y);return w(),b}function f(p,g,y){let v=ck.inlineCode(p,g,y);return y.stack.includes("tableCell")&&(v=v.replace(/\|/g,"\\$&")),v}}function jM(){return{exit:{taskListCheckValueChecked:w1,taskListCheckValueUnchecked:w1,paragraph:IM}}}function AM(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:RM}}}function w1(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function IM(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=t.children;let i=-1,l;for(;++i<s.length;){const o=s[i];if(o.type==="paragraph"){l=o;break}}l===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function RM(e,t,r,n){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=r.createTracker(n);i&&o.move(l);let u=ck.listItem(e,t,r,{...n,...o.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(d){return d+l}}function LM(){return[cD(),ED(),DD(),EM(),jM()]}function OM(e){return{extensions:[dD(),ND(),MD(),CM(e),AM()]}}const PM={tokenize:HM,partial:!0},dk={tokenize:$M,partial:!0},hk={tokenize:zM,partial:!0},fk={tokenize:qM,partial:!0},DM={tokenize:VM,partial:!0},mk={name:"wwwAutolink",tokenize:UM,previous:gk},pk={name:"protocolAutolink",tokenize:BM,previous:xk},Rs={name:"emailAutolink",tokenize:FM,previous:yk},ss={};function MM(){return{text:ss}}let Ba=48;for(;Ba<123;)ss[Ba]=Rs,Ba++,Ba===58?Ba=65:Ba===91&&(Ba=97);ss[43]=Rs;ss[45]=Rs;ss[46]=Rs;ss[95]=Rs;ss[72]=[Rs,pk];ss[104]=[Rs,pk];ss[87]=[Rs,mk];ss[119]=[Rs,mk];function FM(e,t,r){const n=this;let s,i;return l;function l(h){return!t0(h)||!yk.call(n,n.previous)||Vg(n.events)?r(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return t0(h)?(e.consume(h),o):h===64?(e.consume(h),u):r(h)}function u(h){return h===46?e.check(DM,d,c)(h):h===45||h===95||or(h)?(i=!0,e.consume(h),u):d(h)}function c(h){return e.consume(h),s=!0,u}function d(h){return i&&s&&vr(n.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):r(h)}}function UM(e,t,r){const n=this;return s;function s(l){return l!==87&&l!==119||!gk.call(n,n.previous)||Vg(n.events)?r(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(PM,e.attempt(dk,e.attempt(hk,i),r),r)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function BM(e,t,r){const n=this;let s="",i=!1;return l;function l(h){return(h===72||h===104)&&xk.call(n,n.previous)&&!Vg(n.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),o):r(h)}function o(h){if(vr(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),u}return r(h)}function u(h){return h===47?(e.consume(h),i?c:(i=!0,u)):r(h)}function c(h){return h===null||Xd(h)||ut(h)||yi(h)||qh(h)?r(h):e.attempt(dk,e.attempt(hk,d),r)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function HM(e,t,r){let n=0;return s;function s(l){return(l===87||l===119)&&n<3?(n++,e.consume(l),s):l===46&&n===3?(e.consume(l),i):r(l)}function i(l){return l===null?r(l):t(l)}}function $M(e,t,r){let n,s,i;return l;function l(c){return c===46||c===95?e.check(fk,u,o)(c):c===null||ut(c)||yi(c)||c!==45&&qh(c)?u(c):(i=!0,e.consume(c),l)}function o(c){return c===95?n=!0:(s=n,n=void 0),e.consume(c),l}function u(c){return s||n||!i?r(c):t(c)}}function zM(e,t){let r=0,n=0;return s;function s(l){return l===40?(r++,e.consume(l),s):l===41&&n<r?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(fk,t,i)(l):l===null||ut(l)||yi(l)?t(l):(e.consume(l),s)}function i(l){return l===41&&n++,e.consume(l),s}}function qM(e,t,r){return n;function n(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),n):o===38?(e.consume(o),i):o===93?(e.consume(o),s):o===60||o===null||ut(o)||yi(o)?t(o):r(o)}function s(o){return o===null||o===40||o===91||ut(o)||yi(o)?t(o):n(o)}function i(o){return vr(o)?l(o):r(o)}function l(o){return o===59?(e.consume(o),n):vr(o)?(e.consume(o),l):r(o)}}function VM(e,t,r){return n;function n(i){return e.consume(i),s}function s(i){return or(i)?r(i):t(i)}}function gk(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||ut(e)}function xk(e){return!vr(e)}function yk(e){return!(e===47||t0(e))}function t0(e){return e===43||e===45||e===46||e===95||or(e)}function Vg(e){let t=e.length,r=!1;for(;t--;){const n=e[t][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const WM={tokenize:e8,partial:!0};function GM(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:ZM,continuation:{tokenize:XM},exit:JM}},text:{91:{name:"gfmFootnoteCall",tokenize:KM},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:YM,resolveTo:QM}}}}function YM(e,t,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let l;for(;s--;){const u=n.events[s][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return o;function o(u){if(!l||!l._balanced)return r(u);const c=Rn(n.sliceSerialize({start:l.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function QM(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[r+1],e[r+2],["enter",n,t],e[r+3],e[r+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",n,t]];return e.splice(r,e.length-r+1,...o),e}function KM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,l;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),u}function u(h){return h!==94?r(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!l||h===null||h===91||ut(h))return r(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(Rn(n.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(h)}return ut(h)||(l=!0),i++,e.consume(h),h===92?d:c}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,c):c(h)}}function ZM(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,l=0,o;return u;function u(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):r(g)}function d(g){if(l>999||g===93&&!o||g===null||g===91||ut(g))return r(g);if(g===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return i=Rn(n.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return ut(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}function f(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),s.includes(i)||s.push(i),Ke(e,p,"gfmFootnoteDefinitionWhitespace")):r(g)}function p(g){return t(g)}}function XM(e,t,r){return e.check(hc,t,e.attempt(WM,t,r))}function JM(e){e.exit("gfmFootnoteDefinition")}function e8(e,t,r){const n=this;return Ke(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):r(i)}}function t8(e){let r=(e||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(l,o){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let c=u;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[u][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[u][1].end)},h={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[u][1].start)},f=[["enter",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["enter",h,o]],p=o.parser.constructs.insideSpan.null;p&&Wr(f,f.length,0,Vh(p,l.slice(c+1,u),o)),Wr(f,f.length,0,[["exit",h,o],["enter",l[u][1],o],["exit",l[u][1],o],["exit",d,o]]),Wr(l,c-1,u-c+3,f),u=c+f.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function i(l,o,u){const c=this.previous,d=this.events;let h=0;return f;function f(g){return c===126&&d[d.length-1][1].type!=="characterEscape"?u(g):(l.enter("strikethroughSequenceTemporary"),p(g))}function p(g){const y=Hl(c);if(g===126)return h>1?u(g):(l.consume(g),h++,p);if(h<2&&!r)return u(g);const v=l.exit("strikethroughSequenceTemporary"),x=Hl(g);return v._open=!x||x===2&&!!y,v._close=!y||y===2&&!!x,o(g)}}}class r8{constructor(){this.map=[]}add(t,r,n){n8(this,t,r,n)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];n.push(t.slice()),t.length=0;let s=n.pop();for(;s;){for(const i of s)t.push(i);s=n.pop()}this.map.length=0}}function n8(e,t,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=r,e.map[s][2].push(...n);return}s+=1}e.map.push([t,r,n])}}function s8(e,t){let r=!1;const n=[];for(;t<e.length;){const s=e[t];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return n}function a8(){return{flow:{null:{name:"table",tokenize:i8,resolveAll:l8}}}}function i8(e,t,r){const n=this;let s=0,i=0,l;return o;function o(T){let z=n.events.length-1;for(;z>-1;){const G=n.events[z][1].type;if(G==="lineEnding"||G==="linePrefix")z--;else break}const O=z>-1?n.events[z][1].type:null,Y=O==="tableHead"||O==="tableRow"?S:u;return Y===S&&n.parser.lazy[n.now().line]?r(T):Y(T)}function u(T){return e.enter("tableHead"),e.enter("tableRow"),c(T)}function c(T){return T===124||(l=!0,i+=1),d(T)}function d(T){return T===null?r(T):_e(T)?i>1?(i=0,n.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),p):r(T):qe(T)?Ke(e,d,"whitespace")(T):(i+=1,l&&(l=!1,s+=1),T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),l=!0,d):(e.enter("data"),h(T)))}function h(T){return T===null||T===124||ut(T)?(e.exit("data"),d(T)):(e.consume(T),T===92?f:h)}function f(T){return T===92||T===124?(e.consume(T),h):h(T)}function p(T){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(T):(e.enter("tableDelimiterRow"),l=!1,qe(T)?Ke(e,g,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):g(T))}function g(T){return T===45||T===58?v(T):T===124?(l=!0,e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),y):k(T)}function y(T){return qe(T)?Ke(e,v,"whitespace")(T):v(T)}function v(T){return T===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),x):T===45?(i+=1,x(T)):T===null||_e(T)?_(T):k(T)}function x(T){return T===45?(e.enter("tableDelimiterFiller"),b(T)):k(T)}function b(T){return T===45?(e.consume(T),b):T===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),w):(e.exit("tableDelimiterFiller"),w(T))}function w(T){return qe(T)?Ke(e,_,"whitespace")(T):_(T)}function _(T){return T===124?g(T):T===null||_e(T)?!l||s!==i?k(T):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(T)):k(T)}function k(T){return r(T)}function S(T){return e.enter("tableRow"),A(T)}function A(T){return T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),A):T===null||_e(T)?(e.exit("tableRow"),t(T)):qe(T)?Ke(e,A,"whitespace")(T):(e.enter("data"),R(T))}function R(T){return T===null||T===124||ut(T)?(e.exit("data"),A(T)):(e.consume(T),T===92?L:R)}function L(T){return T===92||T===124?(e.consume(T),R):R(T)}}function l8(e,t){let r=-1,n=!0,s=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,u=0,c,d,h;const f=new r8;for(;++r<e.length;){const p=e[r],g=p[1];p[0]==="enter"?g.type==="tableHead"?(o=!1,u!==0&&(E1(f,t,u,c,d),d=void 0,u=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",c,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],l=[0,r+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",d,t]])),s=g.type==="tableDelimiterRow"?2:d?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(n=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],h=Xc(f,t,i,s,void 0,h),i=[0,0,0,0]),l[2]=r)):g.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(l[0]=l[1],h=Xc(f,t,i,s,void 0,h)),i=l,l=[i[1],r,0,0])):g.type==="tableHead"?(o=!0,u=r):g.type==="tableRow"||g.type==="tableDelimiterRow"?(u=r,i[1]!==0?(l[0]=l[1],h=Xc(f,t,i,s,r,h)):l[1]!==0&&(h=Xc(f,t,l,s,r,h)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(l[3]=r)}for(u!==0&&E1(f,t,u,c,d),f.consume(t.events),r=-1;++r<t.events.length;){const p=t.events[r];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=s8(t.events,r))}return e}function Xc(e,t,r,n,s,i){const l=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(i.end=Object.assign({},Bi(t.events,r[0])),e.add(r[0],0,[["exit",i,t]]));const u=Bi(t.events,r[1]);if(i={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(r[1],0,[["enter",i,t]]),r[2]!==0){const c=Bi(t.events,r[2]),d=Bi(t.events,r[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(r[2],0,[["enter",h,t]]),n!==2){const f=t.events[r[2]],p=t.events[r[3]];if(f[1].end=Object.assign({},p[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const g=r[2]+1,y=r[3]-r[2]-1;e.add(g,y,[])}}e.add(r[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},Bi(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function E1(e,t,r,n,s){const i=[],l=Bi(t.events,r);s&&(s.end=Object.assign({},l),i.push(["exit",s,t])),n.end=Object.assign({},l),i.push(["exit",n,t]),e.add(r+1,0,i)}function Bi(e,t){const r=e[t],n=r[0]==="enter"?"start":"end";return r[1][n]}const o8={name:"tasklistCheck",tokenize:c8};function u8(){return{text:{91:o8}}}function c8(e,t,r){const n=this;return s;function s(u){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return ut(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):r(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(u)}function o(u){return _e(u)?t(u):qe(u)?e.check({tokenize:d8},t,r)(u):r(u)}}function d8(e,t,r){return Ke(e,n,"whitespace");function n(s){return s===null?r(s):t(s)}}function h8(e){return TN([MM(),GM(),t8(e),a8(),u8()])}const f8={};function bk(e){const t=this,r=e||f8,n=t.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),l=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(h8(r)),i.push(LM()),l.push(OM(r))}const N1=/[#.]/g;function m8(e,t){const r=e||"",n={};let s=0,i,l;for(;s<r.length;){N1.lastIndex=s;const o=N1.exec(r),u=r.slice(s,o?o.index:r.length);u&&(i?i==="#"?n.id=u:Array.isArray(n.className)?n.className.push(u):n.className=[u]:l=u,s+=u.length),o&&(i=o[0],s++)}return{type:"element",tagName:l||t||"div",properties:n,children:[]}}const r0={}.hasOwnProperty;function vk(e,t,r){const n=r&&y8(r);function s(i,l,...o){let u=-1,c;if(i==null){c={type:"root",children:[]};const d=l;o.unshift(d)}else if(c=m8(i,t),c.tagName=c.tagName.toLowerCase(),n&&r0.call(n,c.tagName)&&(c.tagName=n[c.tagName]),p8(l))o.unshift(l);else{let d;for(d in l)r0.call(l,d)&&g8(e,c.properties,d,l[d])}for(;++u<o.length;)n0(c.children,o[u]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function p8(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,r=Object.keys(e);for(const n of r){const s=t[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function g8(e,t,r,n){const s=$h(e,r);let i=-1,l;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;l=n}else typeof n=="boolean"?l=n:typeof n=="string"?s.spaceSeparated?l=Ab(n):s.commaSeparated?l=_b(n):s.commaOrSpaceSeparated?l=Ab(_b(n).join(" ")):l=k1(s,s.property,n):Array.isArray(n)?l=n.concat():l=s.property==="style"?x8(n):String(n);if(Array.isArray(l)){const o=[];for(;++i<l.length;){const u=k1(s,s.property,l[i]);o[i]=u}l=o}if(s.property==="className"&&Array.isArray(t.className)){const o=l;l=t.className.concat(o)}t[s.property]=l}}function n0(e,t){let r=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)n0(e,t[r]);else if(typeof t=="object"&&"type"in t)t.type==="root"?n0(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function k1(e,t,r){if(typeof r=="string"){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(r===""||ju(r)===ju(t)))return!0}return r}function x8(e){const t=[];let r;for(r in e)r0.call(e,r)&&t.push([r,e[r]].join(": "));return t.join("; ")}function y8(e){const t={};let r=-1;for(;++r<e.length;)t[e[r].toLowerCase()]=e[r];return t}const b8=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],v8=vk(dc,"div"),w8=vk(La,"g",b8);function E8(e){const t=String(e),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=r[l];if(o===void 0){const u=_1(t,r[l-1]);o=u===-1?t.length+1:u+1,r[l]=o}if(o>i)return{line:l+1,column:i-(l>0?r[l-1]:0)+1,offset:i};l++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const o=r[r.length-1],u=_1(t,o),c=u===-1?t.length+1:u+1;if(o===c)break;r.push(c)}const l=(i.line>1?r[i.line-2]:0)+i.column-1;if(l<r[i.line-1])return l}}}function _1(e,t){const r=e.indexOf("\r",t),n=e.indexOf(`
`,t);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const Za={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},wk={}.hasOwnProperty,N8=Object.prototype;function k8(e,t){const r=t||{};return Wg({file:r.file||void 0,location:!1,schema:r.space==="svg"?La:dc,verbose:r.verbose||!1},e)}function Wg(e,t){let r;switch(t.nodeName){case"#comment":{const n=t;return r={type:"comment",value:n.data},gd(e,n,r),r}case"#document":case"#document-fragment":{const n=t,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:Ek(e,t.childNodes),data:{quirksMode:s}},e.file&&e.location){const i=String(e.file),l=E8(i),o=l.toPoint(0),u=l.toPoint(i.length);r.position={start:o,end:u}}return r}case"#documentType":{const n=t;return r={type:"doctype"},gd(e,n,r),r}case"#text":{const n=t;return r={type:"text",value:n.value},gd(e,n,r),r}default:return r=_8(e,t),r}}function Ek(e,t){let r=-1;const n=[];for(;++r<t.length;){const s=Wg(e,t[r]);n.push(s)}return n}function _8(e,t){const r=e.schema;e.schema=t.namespaceURI===Za.svg?La:dc;let n=-1;const s={};for(;++n<t.attrs.length;){const o=t.attrs[n],u=(o.prefix?o.prefix+":":"")+o.name;wk.call(N8,u)||(s[u]=o.value)}const l=(e.schema.space==="svg"?w8:v8)(t.tagName,s,Ek(e,t.childNodes));if(gd(e,t,l),l.tagName==="template"){const o=t,u=o.sourceCodeLocation,c=u&&u.startTag&&el(u.startTag),d=u&&u.endTag&&el(u.endTag),h=Wg(e,o.content);c&&d&&e.file&&(h.position={start:c.end,end:d.start}),l.content=h}return e.schema=r,l}function gd(e,t,r){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const n=S8(e,r,t.sourceCodeLocation);n&&(e.location=!0,r.position=n)}}function S8(e,t,r){const n=el(r);if(t.type==="element"){const s=t.children[t.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),e.verbose){const i={};let l;if(r.attrs)for(l in r.attrs)wk.call(r.attrs,l)&&(i[$h(e.schema,l).property]=el(r.attrs[l]));r.startTag;const o=el(r.startTag),u=r.endTag?el(r.endTag):void 0,c={opening:o};u&&(c.closing=u),c.properties=i,t.data={position:c}}}return n}function el(e){const t=S1({line:e.startLine,column:e.startCol,offset:e.startOffset}),r=S1({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||r?{start:t,end:r}:void 0}function S1(e){return e.line&&e.column?e:void 0}const T8={},C8={}.hasOwnProperty,Nk=JN("type",{handlers:{root:A8,element:P8,text:L8,comment:O8,doctype:R8}});function j8(e,t){const n=(t||T8).space;return Nk(e,n==="svg"?La:dc)}function A8(e,t){const r={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=Gg(e.children,r,t),so(e,r),r}function I8(e,t){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=Gg(e.children,r,t),so(e,r),r}function R8(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return so(e,t),t}function L8(e){const t={nodeName:"#text",value:e.value,parentNode:null};return so(e,t),t}function O8(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return so(e,t),t}function P8(e,t){const r=t;let n=r;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=La);const s=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&C8.call(e.properties,i)){const u=D8(n,i,e.properties[i]);u&&s.push(u)}}const l=n.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:s,namespaceURI:Za[l],childNodes:[],parentNode:null};return o.childNodes=Gg(e.children,o,n),so(e,o),e.tagName==="template"&&e.content&&(o.content=I8(e.content,n)),o}function D8(e,t,r){const n=$h(e,t);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?uN(r):yN(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=Za[n.space]}return s}function Gg(e,t,r){let n=-1;const s=[];if(e)for(;++n<e.length;){const i=Nk(e[n],r);i.parentNode=t,s.push(i)}return s}function so(e,t){const r=e.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,t.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const M8=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],F8=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),vt="";var C;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(C||(C={}));const Tr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function kk(e){return e>=55296&&e<=57343}function U8(e){return e>=56320&&e<=57343}function B8(e,t){return(e-55296)*1024+9216+t}function _k(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function Sk(e){return e>=64976&&e<=65007||F8.has(e)}var ee;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ee||(ee={}));const H8=65536;class $8{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=H8,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,r){const{line:n,col:s,offset:i}=this,l=s+r,o=i+r;return{code:t,startLine:n,endLine:n,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(U8(r))return this.pos++,this._addGap(),B8(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,C.EOF;return this._err(ee.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;const n=this.html.charCodeAt(r);return n===C.CARRIAGE_RETURN?C.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;let t=this.html.charCodeAt(this.pos);return t===C.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,C.LINE_FEED):t===C.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,kk(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===C.LINE_FEED||t===C.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){_k(t)?this._err(ee.controlCharacterInInputStream):Sk(t)&&this._err(ee.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var $e;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})($e||($e={}));function Tk(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}const Ck=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),z8=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var ym;const q8=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),V8=(ym=String.fromCodePoint)!==null&&ym!==void 0?ym:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function W8(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=q8.get(e))!==null&&t!==void 0?t:e}var Kt;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Kt||(Kt={}));const G8=32;var ua;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(ua||(ua={}));function s0(e){return e>=Kt.ZERO&&e<=Kt.NINE}function Y8(e){return e>=Kt.UPPER_A&&e<=Kt.UPPER_F||e>=Kt.LOWER_A&&e<=Kt.LOWER_F}function Q8(e){return e>=Kt.UPPER_A&&e<=Kt.UPPER_Z||e>=Kt.LOWER_A&&e<=Kt.LOWER_Z||s0(e)}function K8(e){return e===Kt.EQUALS||Q8(e)}var Wt;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Wt||(Wt={}));var ys;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(ys||(ys={}));class jk{constructor(t,r,n){this.decodeTree=t,this.emitCodePoint=r,this.errors=n,this.state=Wt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ys.Strict}startEntity(t){this.decodeMode=t,this.state=Wt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,r){switch(this.state){case Wt.EntityStart:return t.charCodeAt(r)===Kt.NUM?(this.state=Wt.NumericStart,this.consumed+=1,this.stateNumericStart(t,r+1)):(this.state=Wt.NamedEntity,this.stateNamedEntity(t,r));case Wt.NumericStart:return this.stateNumericStart(t,r);case Wt.NumericDecimal:return this.stateNumericDecimal(t,r);case Wt.NumericHex:return this.stateNumericHex(t,r);case Wt.NamedEntity:return this.stateNamedEntity(t,r)}}stateNumericStart(t,r){return r>=t.length?-1:(t.charCodeAt(r)|G8)===Kt.LOWER_X?(this.state=Wt.NumericHex,this.consumed+=1,this.stateNumericHex(t,r+1)):(this.state=Wt.NumericDecimal,this.stateNumericDecimal(t,r))}addToNumericResult(t,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(r,i),s),this.consumed+=i}}stateNumericHex(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(s0(s)||Y8(s))r+=1;else return this.addToNumericResult(t,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,n,r,16),-1}stateNumericDecimal(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(s0(s))r+=1;else return this.addToNumericResult(t,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,n,r,10),-1}emitNumericEntity(t,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Kt.SEMI)this.consumed+=1;else if(this.decodeMode===ys.Strict)return 0;return this.emitCodePoint(W8(this.result),this.consumed),this.errors&&(t!==Kt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&ua.VALUE_LENGTH)>>14;for(;r<t.length;r++,this.excess++){const l=t.charCodeAt(r);if(this.treeIndex=Z8(n,s,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===ys.Attribute&&(i===0||K8(l))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&ua.VALUE_LENGTH)>>14,i!==0){if(l===Kt.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ys.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:r,decodeTree:n}=this,s=(n[r]&ua.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[t]&~ua.VALUE_LENGTH:s[t+1],n),r===3&&this.emitCodePoint(s[t+2],n),n}end(){var t;switch(this.state){case Wt.NamedEntity:return this.result!==0&&(this.decodeMode!==ys.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Wt.NumericDecimal:return this.emitNumericEntity(0,2);case Wt.NumericHex:return this.emitNumericEntity(0,3);case Wt.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Wt.EntityStart:return 0}}}function Ak(e){let t="";const r=new jk(e,n=>t+=V8(n));return function(s,i){let l=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(l,o),r.startEntity(i);const c=r.write(s,o+1);if(c<0){l=o+r.end();break}l=o+c,o=c===0?l+1:l}const u=t+s.slice(l);return t="",u}}function Z8(e,t,r,n){const s=(t&ua.BRANCH_LENGTH)>>7,i=t&ua.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const u=n-i;return u<0||u>=s?-1:e[r+u]-1}let l=r,o=l+s-1;for(;l<=o;){const u=l+o>>>1,c=e[u];if(c<n)l=u+1;else if(c>n)o=u-1;else return e[u+s]}return-1}Ak(Ck);Ak(z8);var ae;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(ae||(ae={}));var oi;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(oi||(oi={}));var on;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(on||(on={}));var Q;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(Q||(Q={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(m||(m={}));const X8=new Map([[Q.A,m.A],[Q.ADDRESS,m.ADDRESS],[Q.ANNOTATION_XML,m.ANNOTATION_XML],[Q.APPLET,m.APPLET],[Q.AREA,m.AREA],[Q.ARTICLE,m.ARTICLE],[Q.ASIDE,m.ASIDE],[Q.B,m.B],[Q.BASE,m.BASE],[Q.BASEFONT,m.BASEFONT],[Q.BGSOUND,m.BGSOUND],[Q.BIG,m.BIG],[Q.BLOCKQUOTE,m.BLOCKQUOTE],[Q.BODY,m.BODY],[Q.BR,m.BR],[Q.BUTTON,m.BUTTON],[Q.CAPTION,m.CAPTION],[Q.CENTER,m.CENTER],[Q.CODE,m.CODE],[Q.COL,m.COL],[Q.COLGROUP,m.COLGROUP],[Q.DD,m.DD],[Q.DESC,m.DESC],[Q.DETAILS,m.DETAILS],[Q.DIALOG,m.DIALOG],[Q.DIR,m.DIR],[Q.DIV,m.DIV],[Q.DL,m.DL],[Q.DT,m.DT],[Q.EM,m.EM],[Q.EMBED,m.EMBED],[Q.FIELDSET,m.FIELDSET],[Q.FIGCAPTION,m.FIGCAPTION],[Q.FIGURE,m.FIGURE],[Q.FONT,m.FONT],[Q.FOOTER,m.FOOTER],[Q.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[Q.FORM,m.FORM],[Q.FRAME,m.FRAME],[Q.FRAMESET,m.FRAMESET],[Q.H1,m.H1],[Q.H2,m.H2],[Q.H3,m.H3],[Q.H4,m.H4],[Q.H5,m.H5],[Q.H6,m.H6],[Q.HEAD,m.HEAD],[Q.HEADER,m.HEADER],[Q.HGROUP,m.HGROUP],[Q.HR,m.HR],[Q.HTML,m.HTML],[Q.I,m.I],[Q.IMG,m.IMG],[Q.IMAGE,m.IMAGE],[Q.INPUT,m.INPUT],[Q.IFRAME,m.IFRAME],[Q.KEYGEN,m.KEYGEN],[Q.LABEL,m.LABEL],[Q.LI,m.LI],[Q.LINK,m.LINK],[Q.LISTING,m.LISTING],[Q.MAIN,m.MAIN],[Q.MALIGNMARK,m.MALIGNMARK],[Q.MARQUEE,m.MARQUEE],[Q.MATH,m.MATH],[Q.MENU,m.MENU],[Q.META,m.META],[Q.MGLYPH,m.MGLYPH],[Q.MI,m.MI],[Q.MO,m.MO],[Q.MN,m.MN],[Q.MS,m.MS],[Q.MTEXT,m.MTEXT],[Q.NAV,m.NAV],[Q.NOBR,m.NOBR],[Q.NOFRAMES,m.NOFRAMES],[Q.NOEMBED,m.NOEMBED],[Q.NOSCRIPT,m.NOSCRIPT],[Q.OBJECT,m.OBJECT],[Q.OL,m.OL],[Q.OPTGROUP,m.OPTGROUP],[Q.OPTION,m.OPTION],[Q.P,m.P],[Q.PARAM,m.PARAM],[Q.PLAINTEXT,m.PLAINTEXT],[Q.PRE,m.PRE],[Q.RB,m.RB],[Q.RP,m.RP],[Q.RT,m.RT],[Q.RTC,m.RTC],[Q.RUBY,m.RUBY],[Q.S,m.S],[Q.SCRIPT,m.SCRIPT],[Q.SEARCH,m.SEARCH],[Q.SECTION,m.SECTION],[Q.SELECT,m.SELECT],[Q.SOURCE,m.SOURCE],[Q.SMALL,m.SMALL],[Q.SPAN,m.SPAN],[Q.STRIKE,m.STRIKE],[Q.STRONG,m.STRONG],[Q.STYLE,m.STYLE],[Q.SUB,m.SUB],[Q.SUMMARY,m.SUMMARY],[Q.SUP,m.SUP],[Q.TABLE,m.TABLE],[Q.TBODY,m.TBODY],[Q.TEMPLATE,m.TEMPLATE],[Q.TEXTAREA,m.TEXTAREA],[Q.TFOOT,m.TFOOT],[Q.TD,m.TD],[Q.TH,m.TH],[Q.THEAD,m.THEAD],[Q.TITLE,m.TITLE],[Q.TR,m.TR],[Q.TRACK,m.TRACK],[Q.TT,m.TT],[Q.U,m.U],[Q.UL,m.UL],[Q.SVG,m.SVG],[Q.VAR,m.VAR],[Q.WBR,m.WBR],[Q.XMP,m.XMP]]);function ao(e){var t;return(t=X8.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const le=m,J8={[ae.HTML]:new Set([le.ADDRESS,le.APPLET,le.AREA,le.ARTICLE,le.ASIDE,le.BASE,le.BASEFONT,le.BGSOUND,le.BLOCKQUOTE,le.BODY,le.BR,le.BUTTON,le.CAPTION,le.CENTER,le.COL,le.COLGROUP,le.DD,le.DETAILS,le.DIR,le.DIV,le.DL,le.DT,le.EMBED,le.FIELDSET,le.FIGCAPTION,le.FIGURE,le.FOOTER,le.FORM,le.FRAME,le.FRAMESET,le.H1,le.H2,le.H3,le.H4,le.H5,le.H6,le.HEAD,le.HEADER,le.HGROUP,le.HR,le.HTML,le.IFRAME,le.IMG,le.INPUT,le.LI,le.LINK,le.LISTING,le.MAIN,le.MARQUEE,le.MENU,le.META,le.NAV,le.NOEMBED,le.NOFRAMES,le.NOSCRIPT,le.OBJECT,le.OL,le.P,le.PARAM,le.PLAINTEXT,le.PRE,le.SCRIPT,le.SECTION,le.SELECT,le.SOURCE,le.STYLE,le.SUMMARY,le.TABLE,le.TBODY,le.TD,le.TEMPLATE,le.TEXTAREA,le.TFOOT,le.TH,le.THEAD,le.TITLE,le.TR,le.TRACK,le.UL,le.WBR,le.XMP]),[ae.MATHML]:new Set([le.MI,le.MO,le.MN,le.MS,le.MTEXT,le.ANNOTATION_XML]),[ae.SVG]:new Set([le.TITLE,le.FOREIGN_OBJECT,le.DESC]),[ae.XLINK]:new Set,[ae.XML]:new Set,[ae.XMLNS]:new Set},a0=new Set([le.H1,le.H2,le.H3,le.H4,le.H5,le.H6]);Q.STYLE,Q.SCRIPT,Q.XMP,Q.IFRAME,Q.NOEMBED,Q.NOFRAMES,Q.PLAINTEXT;var I;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(I||(I={}));const Ot={DATA:I.DATA,RCDATA:I.RCDATA,RAWTEXT:I.RAWTEXT,SCRIPT_DATA:I.SCRIPT_DATA,PLAINTEXT:I.PLAINTEXT,CDATA_SECTION:I.CDATA_SECTION};function e7(e){return e>=C.DIGIT_0&&e<=C.DIGIT_9}function Oo(e){return e>=C.LATIN_CAPITAL_A&&e<=C.LATIN_CAPITAL_Z}function t7(e){return e>=C.LATIN_SMALL_A&&e<=C.LATIN_SMALL_Z}function Bs(e){return t7(e)||Oo(e)}function T1(e){return Bs(e)||e7(e)}function Jc(e){return e+32}function Ik(e){return e===C.SPACE||e===C.LINE_FEED||e===C.TABULATION||e===C.FORM_FEED}function C1(e){return Ik(e)||e===C.SOLIDUS||e===C.GREATER_THAN_SIGN}function r7(e){return e===C.NULL?ee.nullCharacterReference:e>1114111?ee.characterReferenceOutsideUnicodeRange:kk(e)?ee.surrogateCharacterReference:Sk(e)?ee.noncharacterCharacterReference:_k(e)||e===C.CARRIAGE_RETURN?ee.controlCharacterReference:null}class n7{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=I.DATA,this.returnState=I.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new $8(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new jk(Ck,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(ee.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(ee.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=r7(n);s&&this._err(s,1)}}:void 0)}_err(t,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(t,r))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:$e.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:$e.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:$e.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:$e.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(Tk(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ee.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=ao(t.tagName),t.type===$e.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(ee.endTagWithAttributes),t.selfClosing&&this._err(ee.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case $e.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case $e.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case $e.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:$e.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,r)}_emitCodePoint(t){const r=Ik(t)?$e.WHITESPACE_CHARACTER:t===C.NULL?$e.NULL_CHARACTER:$e.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken($e.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=I.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?ys.Attribute:ys.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===I.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===I.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===I.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case I.DATA:{this._stateData(t);break}case I.RCDATA:{this._stateRcdata(t);break}case I.RAWTEXT:{this._stateRawtext(t);break}case I.SCRIPT_DATA:{this._stateScriptData(t);break}case I.PLAINTEXT:{this._statePlaintext(t);break}case I.TAG_OPEN:{this._stateTagOpen(t);break}case I.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case I.TAG_NAME:{this._stateTagName(t);break}case I.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case I.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case I.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case I.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case I.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case I.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case I.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case I.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case I.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case I.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case I.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case I.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case I.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case I.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case I.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case I.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case I.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case I.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case I.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case I.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case I.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case I.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case I.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case I.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case I.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case I.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case I.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case I.BOGUS_COMMENT:{this._stateBogusComment(t);break}case I.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case I.COMMENT_START:{this._stateCommentStart(t);break}case I.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case I.COMMENT:{this._stateComment(t);break}case I.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case I.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case I.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case I.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case I.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case I.COMMENT_END:{this._stateCommentEnd(t);break}case I.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case I.DOCTYPE:{this._stateDoctype(t);break}case I.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case I.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case I.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case I.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case I.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case I.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case I.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case I.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case I.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case I.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case I.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case I.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case I.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case I.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case I.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case I.CDATA_SECTION:{this._stateCdataSection(t);break}case I.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case I.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case I.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case I.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=I.TAG_OPEN;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitCodePoint(t);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case C.AMPERSAND:{this._startCharacterReference();break}case C.LESS_THAN_SIGN:{this.state=I.RCDATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case C.LESS_THAN_SIGN:{this.state=I.RAWTEXT_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(Bs(t))this._createStartTagToken(),this.state=I.TAG_NAME,this._stateTagName(t);else switch(t){case C.EXCLAMATION_MARK:{this.state=I.MARKUP_DECLARATION_OPEN;break}case C.SOLIDUS:{this.state=I.END_TAG_OPEN;break}case C.QUESTION_MARK:{this._err(ee.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=I.BOGUS_COMMENT,this._stateBogusComment(t);break}case C.EOF:{this._err(ee.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ee.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=I.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(Bs(t))this._createEndTagToken(),this.state=I.TAG_NAME,this._stateTagName(t);else switch(t){case C.GREATER_THAN_SIGN:{this._err(ee.missingEndTagName),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ee.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=I.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this.state=I.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.tagName+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(Oo(t)?Jc(t):t)}}_stateRcdataLessThanSign(t){t===C.SOLIDUS?this.state=I.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=I.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){Bs(t)?(this.state=I.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=I.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=I.BEFORE_ATTRIBUTE_NAME,!1;case C.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=I.SELF_CLOSING_START_TAG,!1;case C.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=I.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=I.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===C.SOLIDUS?this.state=I.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=I.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){Bs(t)?(this.state=I.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=I.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=I.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case C.SOLIDUS:{this.state=I.SCRIPT_DATA_END_TAG_OPEN;break}case C.EXCLAMATION_MARK:{this.state=I.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=I.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){Bs(t)?(this.state=I.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=I.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=I.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===C.HYPHEN_MINUS?(this.state=I.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=I.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===C.HYPHEN_MINUS?(this.state=I.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=I.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=I.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=I.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=I.SCRIPT_DATA_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=I.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.GREATER_THAN_SIGN:{this.state=I.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=I.SCRIPT_DATA_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=I.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===C.SOLIDUS?this.state=I.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Bs(t)?(this._emitChars("<"),this.state=I.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=I.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){Bs(t)?(this.state=I.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=I.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=I.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(Tr.SCRIPT,!1)&&C1(this.preprocessor.peek(Tr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Tr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=I.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.GREATER_THAN_SIGN:{this.state=I.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(vt);break}case C.EOF:{this._err(ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===C.SOLIDUS?(this.state=I.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(Tr.SCRIPT,!1)&&C1(this.preprocessor.peek(Tr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<Tr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=I.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=I.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this.state=I.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._err(ee.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=I.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=I.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this._leaveAttrName(),this.state=I.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._leaveAttrName(),this.state=I.BEFORE_ATTRIBUTE_VALUE;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:{this._err(ee.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.name+=vt;break}default:this.currentAttr.name+=String.fromCodePoint(Oo(t)?Jc(t):t)}}_stateAfterAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:{this.state=I.SELF_CLOSING_START_TAG;break}case C.EQUALS_SIGN:{this.state=I.BEFORE_ATTRIBUTE_VALUE;break}case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=I.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{this.state=I.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this.state=I.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingAttributeValue),this.state=I.DATA,this.emitCurrentTagToken();break}default:this.state=I.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case C.QUOTATION_MARK:{this.state=I.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case C.APOSTROPHE:{this.state=I.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=I.BEFORE_ATTRIBUTE_NAME;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=I.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),this.currentAttr.value+=vt;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:case C.EQUALS_SIGN:case C.GRAVE_ACCENT:{this._err(ee.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=I.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this._leaveAttrValue(),this.state=I.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=I.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._err(ee.missingWhitespaceBetweenAttributes),this.state=I.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case C.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=I.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(ee.eofInTag),this._emitEOFToken();break}default:this._err(ee.unexpectedSolidusInTag),this.state=I.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentComment(r);break}case C.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.data+=vt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(Tr.DASH_DASH,!0)?(this._createCommentToken(Tr.DASH_DASH.length+1),this.state=I.COMMENT_START):this._consumeSequenceIfMatch(Tr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Tr.DOCTYPE.length+1),this.state=I.DOCTYPE):this._consumeSequenceIfMatch(Tr.CDATA_START,!0)?this.inForeignNode?this.state=I.CDATA_SECTION:(this._err(ee.cdataInHtmlContent),this._createCommentToken(Tr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=I.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ee.incorrectlyOpenedComment),this._createCommentToken(2),this.state=I.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case C.HYPHEN_MINUS:{this.state=I.COMMENT_START_DASH;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptClosingOfEmptyComment),this.state=I.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=I.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=I.COMMENT_END;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptClosingOfEmptyComment),this.state=I.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=I.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=I.COMMENT_END_DASH;break}case C.LESS_THAN_SIGN:{r.data+="<",this.state=I.COMMENT_LESS_THAN_SIGN;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.data+=vt;break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case C.EXCLAMATION_MARK:{r.data+="!",this.state=I.COMMENT_LESS_THAN_SIGN_BANG;break}case C.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=I.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===C.HYPHEN_MINUS?this.state=I.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=I.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===C.HYPHEN_MINUS?this.state=I.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=I.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==C.GREATER_THAN_SIGN&&t!==C.EOF&&this._err(ee.nestedComment),this.state=I.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=I.COMMENT_END;break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=I.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentComment(r);break}case C.EXCLAMATION_MARK:{this.state=I.COMMENT_END_BANG;break}case C.HYPHEN_MINUS:{r.data+="-";break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=I.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{r.data+="--!",this.state=I.COMMENT_END_DASH;break}case C.GREATER_THAN_SIGN:{this._err(ee.incorrectlyClosedComment),this.state=I.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=I.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.BEFORE_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=I.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case C.EOF:{this._err(ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingWhitespaceBeforeDoctypeName),this.state=I.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Oo(t))this._createDoctypeToken(String.fromCharCode(Jc(t))),this.state=I.DOCTYPE_NAME;else switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.NULL:{this._err(ee.unexpectedNullCharacter),this._createDoctypeToken(vt),this.state=I.DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=I.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.AFTER_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.name+=vt;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(Oo(t)?Jc(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Tr.PUBLIC,!1)?this.state=I.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Tr.SYSTEM,!1)?this.state=I.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ee.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=I.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=I.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.publicId="",this.state=I.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.publicId="",this.state=I.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=I.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.publicId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=I.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.publicId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case C.GREATER_THAN_SIGN:{this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.QUOTATION_MARK:{r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=I.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=I.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=I.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.systemId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=I.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(ee.unexpectedNullCharacter),r.systemId+=vt;break}case C.GREATER_THAN_SIGN:{this._err(ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.EOF:{this._err(ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(ee.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=I.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=I.DATA;break}case C.NULL:{this._err(ee.unexpectedNullCharacter);break}case C.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case C.RIGHT_SQUARE_BRACKET:{this.state=I.CDATA_SECTION_BRACKET;break}case C.EOF:{this._err(ee.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===C.RIGHT_SQUARE_BRACKET?this.state=I.CDATA_SECTION_END:(this._emitChars("]"),this.state=I.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case C.GREATER_THAN_SIGN:{this.state=I.DATA;break}case C.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=I.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(C.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&T1(this.preprocessor.peek(1))?I.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){T1(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===C.SEMICOLON&&this._err(ee.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const Rk=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),j1=new Set([...Rk,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),th=new Set([m.APPLET,m.CAPTION,m.HTML,m.MARQUEE,m.OBJECT,m.TABLE,m.TD,m.TEMPLATE,m.TH]),s7=new Set([...th,m.OL,m.UL]),a7=new Set([...th,m.BUTTON]),A1=new Set([m.ANNOTATION_XML,m.MI,m.MN,m.MO,m.MS,m.MTEXT]),I1=new Set([m.DESC,m.FOREIGN_OBJECT,m.TITLE]),i7=new Set([m.TR,m.TEMPLATE,m.HTML]),l7=new Set([m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML]),o7=new Set([m.TABLE,m.TEMPLATE,m.HTML]),u7=new Set([m.TD,m.TH]);class c7{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===ae.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const s=this._indexOf(t)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==ae.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(a0,ae.HTML)}popUntilTableCellPopped(){this.popUntilPopped(u7,ae.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(o7,ae.HTML)}clearBackToTableBodyContext(){this.clearBackTo(l7,ae.HTML)}clearBackToTableRowContext(){this.clearBackTo(i7,ae.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInDynamicScope(t,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case ae.HTML:{if(s===t)return!0;if(r.has(s))return!1;break}case ae.SVG:{if(I1.has(s))return!1;break}case ae.MATHML:{if(A1.has(s))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,th)}hasInListItemScope(t){return this.hasInDynamicScope(t,s7)}hasInButtonScope(t){return this.hasInDynamicScope(t,a7)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case ae.HTML:{if(a0.has(r))return!0;if(th.has(r))return!1;break}case ae.SVG:{if(I1.has(r))return!1;break}case ae.MATHML:{if(A1.has(r))return!1;break}}}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ae.HTML)switch(this.tagIDs[r]){case t:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===ae.HTML)switch(this.tagIDs[t]){case m.TBODY:case m.THEAD:case m.TFOOT:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===ae.HTML)switch(this.tagIDs[r]){case t:return!0;case m.OPTION:case m.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Rk.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;j1.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&j1.has(this.currentTagId);)this.pop()}}const bm=3;var Qn;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Qn||(Qn={}));const R1={type:Qn.Marker};class d7{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const u=this.entries[o];if(u.type===Qn.Marker)break;const{element:c}=u;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===l){const d=this.treeAdapter.getAttrList(c);d.length===s&&n.push({idx:o,attrs:d})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<bm)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<bm)return;const s=new Map(r.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<n.length;l++){const o=n[l];o.attrs.every(u=>s.get(u.name)===u.value)&&(i+=1,i>=bm&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(R1)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:Qn.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:Qn.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(R1);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===Qn.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===Qn.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===Qn.Element&&r.element===t)}}const Hs={createDocument(){return{nodeName:"#document",mode:on.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const s=e.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=t,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Hs.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Hs.isTextNode(r)){r.value+=t;return}}Hs.appendChild(e,Hs.createTextNode(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Hs.isTextNode(n)?n.value+=t:Hs.insertBefore(e,Hs.createTextNode(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},Lk="html",h7="about:legacy-compat",f7="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Ok=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],m7=[...Ok,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],p7=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Pk=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],g7=[...Pk,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function L1(e,t){return t.some(r=>e.startsWith(r))}function x7(e){return e.name===Lk&&e.publicId===null&&(e.systemId===null||e.systemId===h7)}function y7(e){if(e.name!==Lk)return on.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===f7)return on.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),p7.has(r))return on.QUIRKS;let n=t===null?m7:Ok;if(L1(r,n))return on.QUIRKS;if(n=t===null?Pk:g7,L1(r,n))return on.LIMITED_QUIRKS}return on.NO_QUIRKS}const O1={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},b7="definitionurl",v7="definitionURL",w7=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),E7=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:ae.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:ae.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:ae.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:ae.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:ae.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:ae.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:ae.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:ae.XML}],["xml:space",{prefix:"xml",name:"space",namespace:ae.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:ae.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:ae.XMLNS}]]),N7=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),k7=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function _7(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===oi.COLOR||n===oi.SIZE||n===oi.FACE)||k7.has(t)}function Dk(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===b7){e.attrs[t].name=v7;break}}function Mk(e){for(let t=0;t<e.attrs.length;t++){const r=w7.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function Yg(e){for(let t=0;t<e.attrs.length;t++){const r=E7.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function S7(e){const t=N7.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=ao(e.tagName))}function T7(e,t){return t===ae.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function C7(e,t,r){if(t===ae.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===oi.ENCODING){const s=r[n].value.toLowerCase();return s===O1.TEXT_HTML||s===O1.APPLICATION_XML}}return t===ae.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function j7(e,t,r,n){return(!n||n===ae.HTML)&&C7(e,t,r)||(!n||n===ae.MATHML)&&T7(e,t)}const A7="hidden",I7=8,R7=3;var D;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(D||(D={}));const L7={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Fk=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),P1={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Hs,onParseError:null};class D1{constructor(t,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=D.INITIAL,this.originalInsertionMode=D.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...P1,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new n7(this.options,this),this.activeFormattingElements=new d7(this.treeAdapter),this.fragmentContextID=n?ao(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new c7(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...P1,...r};t??(t=n.treeAdapter.createElement(Q.TEMPLATE,ae.HTML,[]));const s=n.treeAdapter.createElement("documentmock",ae.HTML,[]),i=new this(n,s,t);return i.fragmentContextID===m.TEMPLATE&&i.tmplInsertionModeStack.unshift(D.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var s;if(!this.onParseError)return;const i=(s=t.location)!==null&&s!==void 0?s:L7,l={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,t,this.openElements.current),r){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===ae.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,ae.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=D.TEXT}switchToPlaintextParsing(){this.insertionMode=D.TEXT,this.originalInsertionMode=D.IN_BODY,this.tokenizer.state=Ot.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===Q.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==ae.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=Ot.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=Ot.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=Ot.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=Ot.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",s=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,ae.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,ae.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(Q.HTML,ae.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,l=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:u,endCol:c,endOffset:d}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(t),i=r.type===$e.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===Q.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===ae.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,ae.HTML)}_processToken(t){switch(t.type){case $e.CHARACTER:{this.onCharacter(t);break}case $e.NULL_CHARACTER:{this.onNullCharacter(t);break}case $e.COMMENT:{this.onComment(t);break}case $e.DOCTYPE:{this.onDoctype(t);break}case $e.START_TAG:{this._processStartTag(t);break}case $e.END_TAG:{this.onEndTag(t);break}case $e.EOF:{this.onEof(t);break}case $e.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return j7(t,s,i,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===Qn.Marker||this.openElements.contains(s.element)),n=r<0?t-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=D.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=D.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=D.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=D.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=D.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=D.IN_TABLE;return}case m.BODY:{this.insertionMode=D.IN_BODY;return}case m.FRAMESET:{this.insertionMode=D.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?D.AFTER_HEAD:D.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=D.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=D.IN_HEAD;return}break}}this.insertionMode=D.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=D.IN_SELECT_IN_TABLE;return}}this.insertionMode=D.IN_SELECT}_isElementCausesFosterParenting(t){return Fk.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===ae.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return J8[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){uF(this,t);return}switch(this.insertionMode){case D.INITIAL:{_o(this,t);break}case D.BEFORE_HTML:{eu(this,t);break}case D.BEFORE_HEAD:{tu(this,t);break}case D.IN_HEAD:{ru(this,t);break}case D.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case D.AFTER_HEAD:{su(this,t);break}case D.IN_BODY:case D.IN_CAPTION:case D.IN_CELL:case D.IN_TEMPLATE:{Bk(this,t);break}case D.TEXT:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{vm(this,t);break}case D.IN_TABLE_TEXT:{Wk(this,t);break}case D.IN_COLUMN_GROUP:{rh(this,t);break}case D.AFTER_BODY:{nh(this,t);break}case D.AFTER_AFTER_BODY:{xd(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){oF(this,t);return}switch(this.insertionMode){case D.INITIAL:{_o(this,t);break}case D.BEFORE_HTML:{eu(this,t);break}case D.BEFORE_HEAD:{tu(this,t);break}case D.IN_HEAD:{ru(this,t);break}case D.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case D.AFTER_HEAD:{su(this,t);break}case D.TEXT:{this._insertCharacters(t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{vm(this,t);break}case D.IN_COLUMN_GROUP:{rh(this,t);break}case D.AFTER_BODY:{nh(this,t);break}case D.AFTER_AFTER_BODY:{xd(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){i0(this,t);return}switch(this.insertionMode){case D.INITIAL:case D.BEFORE_HTML:case D.BEFORE_HEAD:case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:case D.IN_BODY:case D.IN_TABLE:case D.IN_CAPTION:case D.IN_COLUMN_GROUP:case D.IN_TABLE_BODY:case D.IN_ROW:case D.IN_CELL:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:case D.IN_TEMPLATE:case D.IN_FRAMESET:case D.AFTER_FRAMESET:{i0(this,t);break}case D.IN_TABLE_TEXT:{So(this,t);break}case D.AFTER_BODY:{B7(this,t);break}case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{H7(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case D.INITIAL:{$7(this,t);break}case D.BEFORE_HEAD:case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:{this._err(t,ee.misplacedDoctype);break}case D.IN_TABLE_TEXT:{So(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,ee.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?cF(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case D.INITIAL:{_o(this,t);break}case D.BEFORE_HTML:{z7(this,t);break}case D.BEFORE_HEAD:{V7(this,t);break}case D.IN_HEAD:{Fn(this,t);break}case D.IN_HEAD_NO_SCRIPT:{Y7(this,t);break}case D.AFTER_HEAD:{K7(this,t);break}case D.IN_BODY:{mr(this,t);break}case D.IN_TABLE:{$l(this,t);break}case D.IN_TABLE_TEXT:{So(this,t);break}case D.IN_CAPTION:{W9(this,t);break}case D.IN_COLUMN_GROUP:{Zg(this,t);break}case D.IN_TABLE_BODY:{Xh(this,t);break}case D.IN_ROW:{Jh(this,t);break}case D.IN_CELL:{Q9(this,t);break}case D.IN_SELECT:{Qk(this,t);break}case D.IN_SELECT_IN_TABLE:{Z9(this,t);break}case D.IN_TEMPLATE:{J9(this,t);break}case D.AFTER_BODY:{tF(this,t);break}case D.IN_FRAMESET:{rF(this,t);break}case D.AFTER_FRAMESET:{sF(this,t);break}case D.AFTER_AFTER_BODY:{iF(this,t);break}case D.AFTER_AFTER_FRAMESET:{lF(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?dF(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case D.INITIAL:{_o(this,t);break}case D.BEFORE_HTML:{q7(this,t);break}case D.BEFORE_HEAD:{W7(this,t);break}case D.IN_HEAD:{G7(this,t);break}case D.IN_HEAD_NO_SCRIPT:{Q7(this,t);break}case D.AFTER_HEAD:{Z7(this,t);break}case D.IN_BODY:{Zh(this,t);break}case D.TEXT:{D9(this,t);break}case D.IN_TABLE:{Ru(this,t);break}case D.IN_TABLE_TEXT:{So(this,t);break}case D.IN_CAPTION:{G9(this,t);break}case D.IN_COLUMN_GROUP:{Y9(this,t);break}case D.IN_TABLE_BODY:{l0(this,t);break}case D.IN_ROW:{Yk(this,t);break}case D.IN_CELL:{K9(this,t);break}case D.IN_SELECT:{Kk(this,t);break}case D.IN_SELECT_IN_TABLE:{X9(this,t);break}case D.IN_TEMPLATE:{eF(this,t);break}case D.AFTER_BODY:{Xk(this,t);break}case D.IN_FRAMESET:{nF(this,t);break}case D.AFTER_FRAMESET:{aF(this,t);break}case D.AFTER_AFTER_BODY:{xd(this,t);break}}}onEof(t){switch(this.insertionMode){case D.INITIAL:{_o(this,t);break}case D.BEFORE_HTML:{eu(this,t);break}case D.BEFORE_HEAD:{tu(this,t);break}case D.IN_HEAD:{ru(this,t);break}case D.IN_HEAD_NO_SCRIPT:{nu(this,t);break}case D.AFTER_HEAD:{su(this,t);break}case D.IN_BODY:case D.IN_TABLE:case D.IN_CAPTION:case D.IN_COLUMN_GROUP:case D.IN_TABLE_BODY:case D.IN_ROW:case D.IN_CELL:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:{qk(this,t);break}case D.TEXT:{M9(this,t);break}case D.IN_TABLE_TEXT:{So(this,t);break}case D.IN_TEMPLATE:{Zk(this,t);break}case D.AFTER_BODY:case D.IN_FRAMESET:case D.AFTER_FRAMESET:case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{Kg(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===C.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case D.IN_HEAD:case D.IN_HEAD_NO_SCRIPT:case D.AFTER_HEAD:case D.TEXT:case D.IN_COLUMN_GROUP:case D.IN_SELECT:case D.IN_SELECT_IN_TABLE:case D.IN_FRAMESET:case D.AFTER_FRAMESET:{this._insertCharacters(t);break}case D.IN_BODY:case D.IN_CAPTION:case D.IN_CELL:case D.IN_TEMPLATE:case D.AFTER_BODY:case D.AFTER_AFTER_BODY:case D.AFTER_AFTER_FRAMESET:{Uk(this,t);break}case D.IN_TABLE:case D.IN_TABLE_BODY:case D.IN_ROW:{vm(this,t);break}case D.IN_TABLE_TEXT:{Vk(this,t);break}}}}function O7(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):zk(e,t),r}function P7(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const s=e.openElements.items[n];if(s===t.element)break;e._isSpecialElement(s,e.openElements.tagIDs[n])&&(r=s)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function D7(e,t,r){let n=t,s=e.openElements.getCommonAncestor(t);for(let i=0,l=s;l!==r;i++,l=s){s=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),u=o&&i>=R7;!o||u?(u&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=M7(e,o),n===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function M7(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function F7(e,t,r){const n=e.treeAdapter.getTagName(t),s=ao(n);if(e._isElementCausesFosterParenting(s))e._fosterParentElement(r);else{const i=e.treeAdapter.getNamespaceURI(t);s===m.TEMPLATE&&i===ae.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function U7(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=e.treeAdapter.createElement(s.tagName,n,s.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,s),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,i,s.tagID)}function Qg(e,t){for(let r=0;r<I7;r++){const n=O7(e,t);if(!n)break;const s=P7(e,n);if(!s)break;e.activeFormattingElements.bookmark=n;const i=D7(e,s,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),l&&F7(e,l,i),U7(e,s,n)}}function i0(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function B7(e,t){e._appendCommentNode(t,e.openElements.items[0])}function H7(e,t){e._appendCommentNode(t,e.document)}function Kg(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],s=e.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function $7(e,t){e._setDocumentType(t);const r=t.forceQuirks?on.QUIRKS:y7(t);x7(t)||e._err(t,ee.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=D.BEFORE_HTML}function _o(e,t){e._err(t,ee.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,on.QUIRKS),e.insertionMode=D.BEFORE_HTML,e._processToken(t)}function z7(e,t){t.tagID===m.HTML?(e._insertElement(t,ae.HTML),e.insertionMode=D.BEFORE_HEAD):eu(e,t)}function q7(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&eu(e,t)}function eu(e,t){e._insertFakeRootElement(),e.insertionMode=D.BEFORE_HEAD,e._processToken(t)}function V7(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.HEAD:{e._insertElement(t,ae.HTML),e.headElement=e.openElements.current,e.insertionMode=D.IN_HEAD;break}default:tu(e,t)}}function W7(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?tu(e,t):e._err(t,ee.endTagWithoutMatchingOpenElement)}function tu(e,t){e._insertFakeElement(Q.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=D.IN_HEAD,e._processToken(t)}function Fn(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,Ot.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Ot.RAWTEXT):(e._insertElement(t,ae.HTML),e.insertionMode=D.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,Ot.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,Ot.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=D.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(D.IN_TEMPLATE);break}case m.HEAD:{e._err(t,ee.misplacedStartTagForHeadElement);break}default:ru(e,t)}}function G7(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=D.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{ru(e,t);break}case m.TEMPLATE:{Ci(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function Ci(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,ee.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,ee.endTagWithoutMatchingOpenElement)}function ru(e,t){e.openElements.pop(),e.insertionMode=D.AFTER_HEAD,e._processToken(t)}function Y7(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{Fn(e,t);break}case m.NOSCRIPT:{e._err(t,ee.nestedNoscriptInHead);break}default:nu(e,t)}}function Q7(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=D.IN_HEAD;break}case m.BR:{nu(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function nu(e,t){const r=t.type===$e.EOF?ee.openElementsLeftAfterEof:ee.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=D.IN_HEAD,e._processToken(t)}function K7(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.BODY:{e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=D.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,ae.HTML),e.insertionMode=D.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,ee.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),Fn(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,ee.misplacedStartTagForHeadElement);break}default:su(e,t)}}function Z7(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{su(e,t);break}case m.TEMPLATE:{Ci(e,t);break}default:e._err(t,ee.endTagWithoutMatchingOpenElement)}}function su(e,t){e._insertFakeElement(Q.BODY,m.BODY),e.insertionMode=D.IN_BODY,Kh(e,t)}function Kh(e,t){switch(t.type){case $e.CHARACTER:{Bk(e,t);break}case $e.WHITESPACE_CHARACTER:{Uk(e,t);break}case $e.COMMENT:{i0(e,t);break}case $e.START_TAG:{mr(e,t);break}case $e.END_TAG:{Zh(e,t);break}case $e.EOF:{qk(e,t);break}}}function Uk(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Bk(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function X7(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function J7(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function e9(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_FRAMESET)}function t9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML)}function r9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),a0.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,ae.HTML)}function n9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function s9(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),r||(e.formElement=e.openElements.current))}function a9(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const s=e.openElements.tagIDs[n];if(r===m.LI&&s===m.LI||(r===m.DD||r===m.DT)&&(s===m.DD||s===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s);break}if(s!==m.ADDRESS&&s!==m.DIV&&s!==m.P&&e._isSpecialElement(e.openElements.items[n],s))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML)}function i9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.tokenizer.state=Ot.PLAINTEXT}function l9(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.framesetOk=!1}function o9(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(Q.A);r&&(Qg(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function u9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function c9(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(Qg(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,ae.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function d9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function h9(e,t){e.treeAdapter.getDocumentMode(e.document)!==on.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=D.IN_TABLE}function Hk(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ae.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function $k(e){const t=Tk(e,oi.TYPE);return t!=null&&t.toLowerCase()===A7}function f9(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,ae.HTML),$k(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function m9(e,t){e._appendElement(t,ae.HTML),t.ackSelfClosing=!0}function p9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,ae.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function g9(e,t){t.tagName=Q.IMG,t.tagID=m.IMG,Hk(e,t)}function x9(e,t){e._insertElement(t,ae.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Ot.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=D.TEXT}function y9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Ot.RAWTEXT)}function b9(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Ot.RAWTEXT)}function M1(e,t){e._switchToTextParsing(t,Ot.RAWTEXT)}function v9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===D.IN_TABLE||e.insertionMode===D.IN_CAPTION||e.insertionMode===D.IN_TABLE_BODY||e.insertionMode===D.IN_ROW||e.insertionMode===D.IN_CELL?D.IN_SELECT_IN_TABLE:D.IN_SELECT}function w9(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML)}function E9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,ae.HTML)}function N9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,ae.HTML)}function k9(e,t){e._reconstructActiveFormattingElements(),Dk(t),Yg(t),t.selfClosing?e._appendElement(t,ae.MATHML):e._insertElement(t,ae.MATHML),t.ackSelfClosing=!0}function _9(e,t){e._reconstructActiveFormattingElements(),Mk(t),Yg(t),t.selfClosing?e._appendElement(t,ae.SVG):e._insertElement(t,ae.SVG),t.ackSelfClosing=!0}function F1(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,ae.HTML)}function mr(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{u9(e,t);break}case m.A:{o9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{r9(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{t9(e,t);break}case m.LI:case m.DD:case m.DT:{a9(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{Hk(e,t);break}case m.HR:{p9(e,t);break}case m.RB:case m.RTC:{E9(e,t);break}case m.RT:case m.RP:{N9(e,t);break}case m.PRE:case m.LISTING:{n9(e,t);break}case m.XMP:{y9(e,t);break}case m.SVG:{_9(e,t);break}case m.HTML:{X7(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{Fn(e,t);break}case m.BODY:{J7(e,t);break}case m.FORM:{s9(e,t);break}case m.NOBR:{c9(e,t);break}case m.MATH:{k9(e,t);break}case m.TABLE:{h9(e,t);break}case m.INPUT:{f9(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{m9(e,t);break}case m.IMAGE:{g9(e,t);break}case m.BUTTON:{l9(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{d9(e,t);break}case m.IFRAME:{b9(e,t);break}case m.SELECT:{v9(e,t);break}case m.OPTION:case m.OPTGROUP:{w9(e,t);break}case m.NOEMBED:case m.NOFRAMES:{M1(e,t);break}case m.FRAMESET:{e9(e,t);break}case m.TEXTAREA:{x9(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?M1(e,t):F1(e,t);break}case m.PLAINTEXT:{i9(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:F1(e,t)}}function S9(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=D.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function T9(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=D.AFTER_BODY,Xk(e,t))}function C9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function j9(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function A9(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(Q.P,m.P),e._closePElement()}function I9(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function R9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function L9(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function O9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function P9(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(Q.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function zk(e,t){const r=t.tagName,n=t.tagID;for(let s=e.openElements.stackTop;s>0;s--){const i=e.openElements.items[s],l=e.openElements.tagIDs[s];if(n===l&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(i)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=s&&e.openElements.shortenToLength(s);break}if(e._isSpecialElement(i,l))break}}function Zh(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{Qg(e,t);break}case m.P:{A9(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{C9(e,t);break}case m.LI:{I9(e);break}case m.DD:case m.DT:{R9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{L9(e);break}case m.BR:{P9(e);break}case m.BODY:{S9(e,t);break}case m.HTML:{T9(e,t);break}case m.FORM:{j9(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{O9(e,t);break}case m.TEMPLATE:{Ci(e,t);break}default:zk(e,t)}}function qk(e,t){e.tmplInsertionModeStack.length>0?Zk(e,t):Kg(e,t)}function D9(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function M9(e,t){e._err(t,ee.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function vm(e,t){if(Fk.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=D.IN_TABLE_TEXT,t.type){case $e.CHARACTER:{Wk(e,t);break}case $e.WHITESPACE_CHARACTER:{Vk(e,t);break}}else mc(e,t)}function F9(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_CAPTION}function U9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_COLUMN_GROUP}function B9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(Q.COLGROUP,m.COLGROUP),e.insertionMode=D.IN_COLUMN_GROUP,Zg(e,t)}function H9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_TABLE_BODY}function $9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(Q.TBODY,m.TBODY),e.insertionMode=D.IN_TABLE_BODY,Xh(e,t)}function z9(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function q9(e,t){$k(t)?e._appendElement(t,ae.HTML):mc(e,t),t.ackSelfClosing=!0}function V9(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,ae.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function $l(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{$9(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{Fn(e,t);break}case m.COL:{B9(e,t);break}case m.FORM:{V9(e,t);break}case m.TABLE:{z9(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{H9(e,t);break}case m.INPUT:{q9(e,t);break}case m.CAPTION:{F9(e,t);break}case m.COLGROUP:{U9(e,t);break}default:mc(e,t)}}function Ru(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{Ci(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:mc(e,t)}}function mc(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Kh(e,t),e.fosterParentingEnabled=r}function Vk(e,t){e.pendingCharacterTokens.push(t)}function Wk(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function So(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)mc(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Gk=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function W9(e,t){const r=t.tagID;Gk.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_TABLE,$l(e,t)):mr(e,t)}function G9(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_TABLE,r===m.TABLE&&Ru(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Zh(e,t)}}function Zg(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.COL:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{Fn(e,t);break}default:rh(e,t)}}function Y9(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=D.IN_TABLE);break}case m.TEMPLATE:{Ci(e,t);break}case m.COL:break;default:rh(e,t)}}function rh(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=D.IN_TABLE,e._processToken(t))}function Xh(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(Q.TR,m.TR),e.insertionMode=D.IN_ROW,Jh(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE,$l(e,t));break}default:$l(e,t)}}function l0(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE,Ru(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:Ru(e,t)}}function Jh(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,ae.HTML),e.insertionMode=D.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,Xh(e,t));break}default:$l(e,t)}}function Yk(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,l0(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=D.IN_TABLE_BODY,l0(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:Ru(e,t)}}function Q9(e,t){const r=t.tagID;Gk.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),Jh(e,t)):mr(e,t)}function K9(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=D.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),Yk(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:Zh(e,t)}}function Qk(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,ae.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,ae.HTML);break}case m.HR:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{Fn(e,t);break}}}function Kk(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{Ci(e,t);break}}}function Z9(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Qk(e,t)}function X9(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):Kk(e,t)}function J9(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{Fn(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=D.IN_TABLE,e.insertionMode=D.IN_TABLE,$l(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=D.IN_COLUMN_GROUP,e.insertionMode=D.IN_COLUMN_GROUP,Zg(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=D.IN_TABLE_BODY,e.insertionMode=D.IN_TABLE_BODY,Xh(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=D.IN_ROW,e.insertionMode=D.IN_ROW,Jh(e,t);break}default:e.tmplInsertionModeStack[0]=D.IN_BODY,e.insertionMode=D.IN_BODY,mr(e,t)}}function eF(e,t){t.tagID===m.TEMPLATE&&Ci(e,t)}function Zk(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):Kg(e,t)}function tF(e,t){t.tagID===m.HTML?mr(e,t):nh(e,t)}function Xk(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=D.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else nh(e,t)}function nh(e,t){e.insertionMode=D.IN_BODY,Kh(e,t)}function rF(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.FRAMESET:{e._insertElement(t,ae.HTML);break}case m.FRAME:{e._appendElement(t,ae.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{Fn(e,t);break}}}function nF(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=D.AFTER_FRAMESET))}function sF(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.NOFRAMES:{Fn(e,t);break}}}function aF(e,t){t.tagID===m.HTML&&(e.insertionMode=D.AFTER_AFTER_FRAMESET)}function iF(e,t){t.tagID===m.HTML?mr(e,t):xd(e,t)}function xd(e,t){e.insertionMode=D.IN_BODY,Kh(e,t)}function lF(e,t){switch(t.tagID){case m.HTML:{mr(e,t);break}case m.NOFRAMES:{Fn(e,t);break}}}function oF(e,t){t.chars=vt,e._insertCharacters(t)}function uF(e,t){e._insertCharacters(t),e.framesetOk=!1}function Jk(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==ae.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function cF(e,t){if(_7(t))Jk(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===ae.MATHML?Dk(t):n===ae.SVG&&(S7(t),Mk(t)),Yg(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function dF(e,t){if(t.tagID===m.P||t.tagID===m.BR){Jk(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===ae.HTML){e._endTagOutsideForeignContent(t);break}const s=e.treeAdapter.getTagName(n);if(s.toLowerCase()===t.tagName){t.tagName=s,e.openElements.shortenToLength(r);break}}}Q.AREA,Q.BASE,Q.BASEFONT,Q.BGSOUND,Q.BR,Q.COL,Q.EMBED,Q.FRAME,Q.HR,Q.IMG,Q.INPUT,Q.KEYGEN,Q.LINK,Q.META,Q.PARAM,Q.SOURCE,Q.TRACK,Q.WBR;const hF=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,fF=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),U1={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function e_(e,t){const r=NF(e),n=JN("type",{handlers:{root:mF,element:pF,text:gF,comment:r_,doctype:xF,raw:bF},unknown:vF}),s={parser:r?new D1(U1):D1.getFragmentParser(void 0,U1),handle(o){n(o,s)},stitches:!1,options:t||{}};n(e,s),io(s,ns());const i=r?s.parser.document:s.parser.getFragment(),l=k8(i,{file:s.options.file});return s.stitches&&Qh(l,"comment",function(o,u,c){const d=o;if(d.value.stitch&&c&&u!==void 0){const h=c.children;return h[u]=d.value.stitch,u}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function t_(e,t){let r=-1;if(e)for(;++r<e.length;)t.handle(e[r])}function mF(e,t){t_(e.children,t)}function pF(e,t){wF(e,t),t_(e.children,t),EF(e,t)}function gF(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const r={type:$e.CHARACTER,chars:e.value,location:pc(e)};io(t,ns(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function xF(e,t){const r={type:$e.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:pc(e)};io(t,ns(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function yF(e,t){t.stitches=!0;const r=kF(e);if("children"in e&&"children"in r){const n=e_({type:"root",children:e.children},t.options);r.children=n.children}r_({type:"comment",value:{stitch:r}},t)}function r_(e,t){const r=e.value,n={type:$e.COMMENT,data:r,location:pc(e)};io(t,ns(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function bF(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,n_(t,ns(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(hF,"&lt;$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=t.parser.tokenizer._consume();t.parser.tokenizer._callState(r)}}function vF(e,t){const r=e;if(t.options.passThrough&&t.options.passThrough.includes(r.type))yF(r,t);else{let n="";throw fF.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function io(e,t){n_(e,t);const r=e.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=e.parser.tokenizer.preprocessor.line,r.location.endCol=e.parser.tokenizer.preprocessor.col+1,r.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Ot.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function n_(e,t){if(t&&t.offset!==void 0){const r={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=r}}function wF(e,t){const r=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Ot.PLAINTEXT)return;io(t,ns(e));const n=t.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:Za.html;s===Za.html&&r==="svg"&&(s=Za.svg);const i=j8({...e,children:[]},{space:s===Za.svg?"svg":"html"}),l={type:$e.START_TAG,tagName:r,tagID:ao(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:pc(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=r}function EF(e,t){const r=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&M8.includes(r)||t.parser.tokenizer.state===Ot.PLAINTEXT)return;io(t,zh(e));const n={type:$e.END_TAG,tagName:r,tagID:ao(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:pc(e)};t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken),r===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Ot.RCDATA||t.parser.tokenizer.state===Ot.RAWTEXT||t.parser.tokenizer.state===Ot.SCRIPT_DATA)&&(t.parser.tokenizer.state=Ot.DATA)}function NF(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function pc(e){const t=ns(e)||{line:void 0,column:void 0,offset:void 0},r=zh(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function kF(e){return"children"in e?bi({...e,children:[]}):bi(e)}function s_(e){return function(t,r){return e_(t,{...e,file:r})}}const Ha=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],B1={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ha,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ha],h2:[["className","sr-only"]],img:[...Ha,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ha,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ha],table:[...Ha],ul:[...Ha,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Ws={}.hasOwnProperty;function _F(e,t){let r={type:"root",children:[]};const n={schema:t?{...B1,...t}:B1,stack:[]},s=a_(n,e);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function a_(e,t){if(t&&typeof t=="object"){const r=t;switch(typeof r.type=="string"?r.type:""){case"comment":return SF(e,r);case"doctype":return TF(e,r);case"element":return CF(e,r);case"root":return jF(e,r);case"text":return AF(e,r)}}}function SF(e,t){if(e.schema.allowComments){const r=typeof t.value=="string"?t.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return gc(i,t),i}}function TF(e,t){if(e.schema.allowDoctypes){const r={type:"doctype"};return gc(r,t),r}}function CF(e,t){const r=typeof t.tagName=="string"?t.tagName:"";e.stack.push(r);const n=i_(e,t.children),s=IF(e,t.properties);e.stack.pop();let i=!1;if(r&&r!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(r))&&(i=!0,e.schema.ancestors&&Ws.call(e.schema.ancestors,r))){const o=e.schema.ancestors[r];let u=-1;for(i=!1;++u<o.length;)e.stack.includes(o[u])&&(i=!0)}if(!i)return e.schema.strip&&!e.schema.strip.includes(r)?n:void 0;const l={type:"element",tagName:r,properties:s,children:n};return gc(l,t),l}function jF(e,t){const n={type:"root",children:i_(e,t.children)};return gc(n,t),n}function AF(e,t){const n={type:"text",value:typeof t.value=="string"?t.value:""};return gc(n,t),n}function i_(e,t){const r=[];if(Array.isArray(t)){const n=t;let s=-1;for(;++s<n.length;){const i=a_(e,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function IF(e,t){const r=e.stack[e.stack.length-1],n=e.schema.attributes,s=e.schema.required,i=n&&Ws.call(n,r)?n[r]:void 0,l=n&&Ws.call(n,"*")?n["*"]:void 0,o=t&&typeof t=="object"?t:{},u={};let c;for(c in o)if(Ws.call(o,c)){const d=o[c];let h=H1(e,$1(i,c),c,d);h==null&&(h=H1(e,$1(l,c),c,d)),h!=null&&(u[c]=h)}if(s&&Ws.call(s,r)){const d=s[r];for(c in d)Ws.call(d,c)&&!Ws.call(u,c)&&(u[c]=d[c])}return u}function H1(e,t,r,n){return t?Array.isArray(n)?RF(e,t,r,n):l_(e,t,r,n):void 0}function RF(e,t,r,n){let s=-1;const i=[];for(;++s<n.length;){const l=l_(e,t,r,n[s]);(typeof l=="number"||typeof l=="string")&&i.push(l)}return i}function l_(e,t,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&LF(e,r,n)){if(typeof t=="object"&&t.length>1){let s=!1,i=0;for(;++i<t.length;){const l=t[i];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(n))){s=!0;break}}else if(l===n){s=!0;break}}if(!s)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(r)?e.schema.clobberPrefix+n:n}}function LF(e,t,r){const n=e.schema.protocols&&Ws.call(e.schema.protocols,t)?e.schema.protocols[t]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),l=s.indexOf("?"),o=s.indexOf("#"),u=s.indexOf("/");if(i<0||u>-1&&i>u||l>-1&&i>l||o>-1&&i>o)return!0;let c=-1;for(;++c<n.length;){const d=n[c];if(i===d.length&&s.slice(0,d.length)===d)return!0}return!1}function gc(e,t){const r=wN(t);t.data&&(e.data=bi(t.data)),r&&(e.position=r)}function $1(e,t){let r,n=-1;if(e)for(;++n<e.length;){const s=e[n],i=typeof s=="string"?s:s[0];if(i===t)return s;i==="data*"&&(r=s)}if(t.length>4&&t.slice(0,4).toLowerCase()==="data")return r}function o_(e){return function(t){return _F(t,e)}}function yd({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(QN,{remarkPlugins:[bk],rehypePlugins:[s_,o_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function OF({onClose:e,onSelectImage:t}){const[r,n]=E.useState("upload"),[s,i]=E.useState(null),[l,o]=E.useState([]),[u,c]=E.useState(!1),[d,h]=E.useState(null),[f,p]=E.useState(""),[g,y]=E.useState(""),v=async()=>{if(!s)return;c(!0);const b=`${Date.now()}-${s.name}`,{error:w}=await re.storage.from("images").upload(b,s);if(w){alert("Upload error: "+w.message),c(!1);return}const{publicURL:_,error:k}=re.storage.from("images").getPublicUrl(b);if(k){alert("Error getting public URL: "+k.message),c(!1);return}t(_,f,g),c(!1),e()},x=async()=>{c(!0);const{data:b,error:w}=await re.storage.from("images").list("",{limit:100});if(w){alert("Error listing images: "+w.message),c(!1);return}const _=b.map(k=>{const{publicURL:S}=re.storage.from("images").getPublicUrl(k.name);return S});o(_),c(!1)};return Tn.useEffect(()=>{r==="select"&&x()},[r]),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Select an Image"}),a.jsx("button",{onClick:e,children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex gap-4 mb-4",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>n("upload"),children:"Upload"}),a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>n("select"),children:"Select"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Width (e.g., 300px or 100%)"}),a.jsx("input",{type:"text",value:f,onChange:b=>p(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Height (e.g., 200px)"}),a.jsx("input",{type:"text",value:g,onChange:b=>y(b.target.value),className:"w-full px-3 py-2 border rounded"})]}),r==="upload"?a.jsxs("div",{children:[a.jsx("input",{type:"file",accept:"image/*",onChange:b=>{b.target.files&&b.target.files[0]&&i(b.target.files[0])}}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(U,{variant:"primary",onClick:v,loading:u,children:"Upload Image"})})]}):a.jsxs("div",{children:[u?a.jsx("p",{children:"Loading images..."}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((b,w)=>a.jsx("img",{src:b,alt:"Stored",className:`cursor-pointer border ${d===b?"border-blue-500":"border-gray-200"}`,onClick:()=>h(b)},w))}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx(U,{variant:"secondary",onClick:()=>n("upload"),children:"Back to Upload"}),a.jsx(U,{variant:"primary",onClick:()=>{d&&(t(d,f,g),e())},disabled:!d,children:"Select Image"})]})]})]})})}function PF({entry:e,onClose:t,onSave:r,onSaveAsTemplate:n}){const[s,i]=E.useState(e),[l,o]=E.useState(!1),[u,c]=E.useState(!1),[d,h]=E.useState(!1),f=async()=>{c(!0);try{await r(s)}finally{c(!1)}},p=async()=>{if(n){c(!0);try{await n(s)}finally{c(!1)}}},g=(y,v,x)=>{let b=`![Image description](${y})`;if(v||x){const w=[];v&&w.push(`width="${v}"`),x&&w.push(`height="${x}"`),b+=`{${w.join(" ")}}`}i({...s,content:s.content+`
`+b+`
`})};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"border-b p-4 flex items-center justify-between bg-white",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(U,{variant:"secondary",icon:Dh,onClick:t,children:"Back"}),a.jsx("h2",{className:"text-xl font-bold",children:s.title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"secondary",icon:l?NE:kE,onClick:()=>o(!l),children:l?"Edit":"Preview"}),n&&a.jsx(U,{variant:"secondary",onClick:p,loading:u,children:"Save as Template"}),a.jsx(U,{variant:"primary",icon:Qt,onClick:f,loading:u,children:"Save"})]})]}),!l&&a.jsxs("div",{className:"border-b p-2 flex items-center gap-2 bg-white",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:a4,onClick:()=>{const y=document.querySelector("textarea");if(y){const v=y.selectionStart,x=y.selectionEnd,b=y.value,w=b.substring(0,v),_=b.substring(v,x),k=b.substring(x);i({...s,content:`${w}**${_}**${k}`})}},children:"Bold"}),a.jsx(U,{variant:"secondary",size:"sm",icon:w4,onClick:()=>{const y=document.querySelector("textarea");if(y){const v=y.selectionStart,x=y.selectionEnd,b=y.value,w=b.substring(0,v),_=b.substring(v,x),k=b.substring(x);i({...s,content:`${w}_${_}_${k}`})}},children:"Italic"}),a.jsx("div",{className:"w-px h-6 bg-gray-300"}),a.jsx(U,{variant:"secondary",size:"sm",icon:B4,onClick:()=>{i({...s,content:s.content+`
| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
`})},children:"Table"}),a.jsx(U,{variant:"secondary",size:"sm",icon:$p,onClick:()=>h(!0),children:"Image"}),a.jsx(U,{variant:"secondary",size:"sm",icon:N4,onClick:()=>{i({...s,content:s.content+"[Link text](https://example.com)"})},children:"Link"}),a.jsx(U,{variant:"secondary",size:"sm",icon:Ul,onClick:()=>{i({...s,content:s.content+`
> ### Note
> This is a note block for important information.
`})},children:"Note"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs("div",{className:"h-full flex",children:[!l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:s.title,onChange:y=>i({...s,title:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:s.category,onChange:y=>i({...s,category:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx("textarea",{value:s.content,onChange:y=>i({...s,content:y.target.value}),rows:20,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono bg-white"})]})]})}),l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50 homebrew",children:a.jsxs("div",{className:"max-w-4xl mx-auto prose",children:[a.jsx("h1",{children:s.title}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.category})}),a.jsx(yd,{content:s.content})]})})]})}),d&&a.jsx(OF,{onClose:()=>h(!1),onSelectImage:(y,v,x)=>{g(y,v,x)}})]})}function DF(){const{user:e,isAdmin:t}=qt(),r=Zr(),[n,s]=E.useState(""),[i,l]=E.useState(null),[o,u]=E.useState(null),[c,d]=E.useState(null),[h,f]=E.useState([]),[p,g]=E.useState(new Set),{data:y=[],isLoading:v,error:x}=It({queryKey:["compendiumEntries"],queryFn:P5}),{data:b=[],isLoading:w,error:_}=It({queryKey:["compendiumTemplates"],queryFn:D5}),k=v||w,S=(x==null?void 0:x.message)||(_==null?void 0:_.message)||null;E.useEffect(()=>{A()},[]);const A=()=>{const W=localStorage.getItem("compendium_bookmarks");W&&f(JSON.parse(W))},R=W=>{const K=W.content.slice(0,100)+"...";f(P=>{const N=P.some(V=>V.id===W.id)?P.filter(V=>V.id!==W.id):[...P,{...W,preview:K}];return localStorage.setItem("compendium_bookmarks",JSON.stringify(N)),N})},L=W=>{g(K=>{const P=new Set(K);return P.has(W)?P.delete(W):P.add(W),P})},T=E.useMemo(()=>{if(n)return[];const W=y.reduce((K,P)=>{const X=P.category??"Uncategorized";return K[X]||(K[X]=[]),K[X].push(P),K},{});return Object.entries(W).sort(([K],[P])=>K.localeCompare(P))},[y,n]),z=E.useMemo(()=>n?y.filter(W=>W.title.toLowerCase().includes(n.toLowerCase())||W.content.toLowerCase().includes(n.toLowerCase())):[],[y,n]),O=wt({mutationFn:async W=>{if(W.id){const{error:K}=await re.from("compendium").update({title:W.title,content:W.content,category:W.category,updated_at:new Date().toISOString()}).eq("id",W.id);if(K)throw K}else{const{error:K}=await re.from("compendium").insert([{title:W.title,content:W.content,category:W.category,created_by:e==null?void 0:e.id}]);if(K)throw K}},onSuccess:()=>{r.invalidateQueries({queryKey:["compendiumEntries"]}),d(null)},onError:W=>{console.error("Save error:",W)}}),Y=W=>{O.mutate(W)},G=()=>{d({title:"",content:"",category:i||"",created_by:e==null?void 0:e.id})},B=()=>{u(null),s("")};return k?a.jsx(He,{size:"lg",className:"mx-auto mt-12"}):S?a.jsx(Ne,{message:S,className:"m-8"}):a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsx("div",{className:"w-80 bg-white border-r flex flex-col",children:a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Compendium"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",onClick:B,children:"Home"}),t()&&a.jsx(U,{variant:"primary",size:"sm",icon:Xt,onClick:G,children:"New Entry"})]})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search compendium...",value:n,onChange:W=>s(W.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n===""&&a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(([W,K])=>a.jsxs("div",{className:"border-b",children:[a.jsxs("div",{onClick:()=>L(W),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[p.has(W)?a.jsx(Fh,{className:"w-4 h-4 text-gray-500"}):a.jsx(Vs,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:W})]}),a.jsx("span",{className:"text-sm text-gray-500",children:K.length})]}),p.has(W)&&a.jsx("div",{className:"bg-gray-50",children:K.map(P=>a.jsx("div",{onClick:()=>u(P),className:`px-8 py-2 cursor-pointer hover:bg-gray-100 ${(o==null?void 0:o.id)===P.id?"bg-blue-50":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:P.title}),h.some(X=>X.id===P.id)&&a.jsx(Gy,{className:"w-4 h-4 text-blue-500"})]})},P.id))})]},W))})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-95 z-10 p-6 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Search Results"}),a.jsx(U,{variant:"secondary",size:"sm",onClick:()=>s(""),children:"Clear Search"})]}),z.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:z.map(W=>a.jsxs("div",{onClick:()=>{u(W),s("")},className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:W.title}),a.jsx("div",{className:"homebrew",children:a.jsx(yd,{content:W.content.slice(0,200)+"..."})})]},W.id))}):a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-gray-500",children:['No results found for "',n,'".']})})]}),o&&!n?a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:h.some(W=>W.id===o.id)?Gy:l4,onClick:()=>R(o),children:h.some(W=>W.id===o.id)?"Bookmarked":"Bookmark"}),t()&&a.jsx(U,{variant:"secondary",size:"sm",icon:ic,onClick:()=>d(o),children:"Edit"})]})]}),a.jsx("div",{className:"homebrew",children:a.jsx(yd,{content:o.content})})]}):!o&&!n&&a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bookmarked Entries"}),h.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(W=>a.jsxs("div",{onClick:()=>u(W),className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:W.title}),a.jsx("div",{className:"homebrew",children:a.jsx(yd,{content:W.preview})})]},W.id))}):a.jsxs("div",{className:"text-center",children:[a.jsx(nc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Welcome to the Compendium"}),a.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Use the sidebar to search and browse entries, or add new ones if you're an admin."})]})]})]}),c&&a.jsx(PF,{entry:c,onClose:()=>d(null),onSave:Y})]})}async function MF(e,t){if(!e)return[];let r=re.from("parties").select(`
    id,
    name,
    description,
    created_by,
    created_at,
    members:party_members!left (
      characters!inner (
        *
      )
    )
  `);t?r=r.eq("created_by",e):r=r.eq("members.characters.user_id",e);const{data:n,error:s}=await r.order("created_at",{ascending:!1});if(s)throw console.error("Error fetching parties:",s),new Error(s.message||"Failed to fetch parties");return(n||[]).map(l=>({...l,members:(l.members||[]).map(o=>o.characters?to(o.characters):null).filter(o=>!!o)}))}async function u_(e){if(!e)return[];const{data:t,error:r}=await re.from("party_members").select("character_id");if(r)throw console.error("Error fetching party member IDs:",r),new Error(r.message||"Failed to fetch member data");const n=(t||[]).map(o=>o.character_id);let s=re.from("characters").select("*").eq("user_id",e);n.length>0&&(s=s.not("id","in",`(${n.join(",")})`));const{data:i,error:l}=await s;if(l)throw console.error("Error fetching available characters:",l),new Error(l.message||"Failed to fetch available characters");return(i||[]).map(to)}async function FF(e){if(!e)return null;const t=`
    id,
    name,
    description,
    created_by,
    created_at,
    invite_code,
    members:party_members (
      characters (
        id,
        user_id,
        name,
        kin,
        profession,
        attributes,
        max_hp,
        current_hp,
        max_wp,
        current_wp,
        skill_levels,
        spells,
        heroic_ability,
        equipment,
        conditions,
        weak_spot 
      )
    )
  `,{data:r,error:n}=await re.from("parties").select(t).eq("id",e).single();if(n)throw console.error("Error fetching party by ID:",n),n.code==="PGRST116"?new Error("Party not found"):new Error(n.message||"Failed to fetch party");return r?{...r,members:(r.members||[]).map(i=>i.characters?to(i.characters):null).filter(i=>!!i)}:null}async function UF(e,t){const{error:r}=await re.from("party_members").delete().match({party_id:e,character_id:t});if(r)throw console.error("Error removing party member:",r),new Error(r.message||"Failed to remove party member");const{error:n}=await re.from("characters").update({party_id:null}).eq("id",t);n&&console.error("Error clearing character party link:",n)}async function BF(e){const{error:t}=await re.from("parties").delete().eq("id",e);if(t)throw console.error("Error deleting party:",t),new Error(t.message||"Failed to delete party")}function HF(){const{user:e,isDM:t}=qt(),r=fn(),n=Zr(),[s,i]=E.useState(!1),[l,o]=E.useState(""),[u,c]=E.useState([]),{data:d=[],isLoading:h,error:f}=It({queryKey:["parties",e==null?void 0:e.id,t()],queryFn:()=>MF(e==null?void 0:e.id,t()),enabled:!!e}),{data:p=[],isLoading:g,error:y}=It({queryKey:["availableCharacters",e==null?void 0:e.id],queryFn:()=>u_(e==null?void 0:e.id),enabled:!!e&&s}),v=h||s&&g,x=(f==null?void 0:f.message)||(y==null?void 0:y.message)||null,b=wt({mutationFn:async({name:_,characterIds:k})=>{if(!_.trim())throw new Error("Party name is required");if(!e)throw new Error("User not authenticated");const{data:S,error:A}=await re.from("parties").insert([{name:_,created_by:e.id}]).select().single();if(A)throw A;if(!S)throw new Error("Party creation failed");if(k.length>0){const R=k.map(T=>({party_id:S.id,character_id:T})),{error:L}=await re.from("party_members").insert(R);if(L)throw await re.from("parties").delete().eq("id",S.id),L}return S},onSuccess:()=>{n.invalidateQueries({queryKey:["parties",e==null?void 0:e.id,t()]}),n.invalidateQueries({queryKey:["availableCharacters",e==null?void 0:e.id]}),o(""),c([]),i(!1)}}),w=()=>{b.mutate({name:l,characterIds:u})};return v&&!s?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(He,{size:"lg"})}):x&&!s?a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:x})}):a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(An,{className:"w-6 h-6 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Adventure Parties"})]}),t()&&a.jsx(U,{variant:"primary",icon:Xt,onClick:()=>i(!0),disabled:s,children:"Create Party"})]}),x&&!b.error&&!s&&a.jsx("div",{className:"mb-6",children:a.jsx(Ne,{message:x})}),s&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Party"}),b.error&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:b.error.message})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partyName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name"}),a.jsx("input",{type:"text",id:"partyName",value:l,onChange:_=>o(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Initial Characters (Optional)"}),g?a.jsx(He,{}):y?a.jsx(Ne,{message:y.message}):p.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-60 overflow-y-auto p-2 border rounded-md",children:p.map(_=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer ${u.includes(_.id||"")?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>{_.id&&c(k=>k.includes(_.id)?k.filter(S=>S!==_.id):[...k,_.id])},children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xi,{className:"w-4 h-4 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-sm",children:_.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[_.kin," ",_.profession]})]})]})},_.id))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No available characters to add."})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(U,{variant:"secondary",onClick:()=>i(!1),disabled:b.isPending,children:"Cancel"}),a.jsx(U,{variant:"primary",onClick:w,loading:b.isPending,disabled:!l.trim()||b.isPending,children:"Create Party"})]})]})]}),!s&&(d.length>0?a.jsx("div",{className:"grid gap-6",children:d.map(_=>a.jsxs("div",{onClick:()=>r(`/party/${_.id}`),className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg hover:border-blue-400 border border-transparent transition-all cursor-pointer",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:_.name}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[_.members.map(k=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xi,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:k.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[k.kin," ",k.profession]})]})]})},k.id)),_.members.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic col-span-full",children:"No members yet."})]})]},_.id))}):a.jsx(Vp,{icon:An,title:"No Adventure Parties",description:t()?"You haven't created any parties yet.":"You're not currently in any adventure parties.",action:t()?a.jsx(U,{variant:"primary",icon:Xt,onClick:()=>i(!0),children:"Create Your First Party"}):void 0}))]})}function Xg({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(QN,{remarkPlugins:[bk],rehypePlugins:[s_,o_],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function $F(){const{user:e,isDM:t}=qt(),[r,n]=E.useState([]),[s,i]=E.useState([]),[l,o]=E.useState([]),[u,c]=E.useState(null),[d,h]=E.useState(!1),[f,p]=E.useState(null),[g,y]=E.useState(""),[v,x]=E.useState(""),[b,w]=E.useState(""),[_,k]=E.useState(""),[S,A]=E.useState(""),[R,L]=E.useState("all"),[T,z]=E.useState(!0),[O,Y]=E.useState(null),[G,B]=E.useState(null),W=E.useCallback(()=>{y(""),x(""),w(""),k(""),B(null)},[]),K=()=>{W(),h(!0),p(null),c(null)},P=$=>{c($),p($.id),h(!1),y($.title),x($.content),w($.character_id||""),k($.party_id||""),B(null)},X=()=>{h(!1),p(null),W(),f&&c(null)},N=E.useCallback(async()=>{if(e){z(!0),Y(null);try{const $=new Map,{data:Z,error:te}=await re.from("notes").select("*, character:characters(name), party:parties(name)").eq("user_id",e.id);if(te)throw te;if((Z||[]).forEach(we=>$.set(we.id,we)),t()){const{data:we,error:Te}=await re.from("parties").select("id").eq("created_by",e.id);if(Te)throw Te;const ze=(we||[]).map(Ze=>Ze.id);if(ze.length>0){const{data:Ze,error:Ct}=await re.from("notes").select("*, character:characters(name), party:parties(name)").in("party_id",ze);if(Ct)throw Ct;(Ze||[]).forEach(ot=>$.set(ot.id,ot))}}const ge=Array.from($.values()).sort((we,Te)=>new Date(Te.created_at).getTime()-new Date(we.created_at).getTime());n(ge)}catch($){console.error("Error loading notes:",$),Y($ instanceof Error?$.message:"Failed to load notes"),n([])}finally{z(!1)}}},[e,t]),V=E.useCallback(async()=>{if(e)try{const{data:$,error:Z}=await re.from("characters").select("id, name").eq("user_id",e.id);if(Z)throw Z;i($||[])}catch($){console.error("Error loading characters:",$),Y(Z=>Z||($ instanceof Error?$.message:"Failed to load characters"))}},[e]),H=E.useCallback(async()=>{if(!(!e||!t()))try{const{data:$,error:Z}=await re.from("parties").select("id, name").eq("created_by",e.id);if(Z)throw Z;o($||[])}catch($){console.error("Error loading parties:",$),Y(Z=>Z||($ instanceof Error?$.message:"Failed to load parties"))}},[e,t]);E.useEffect(()=>{e?(N(),V(),t()&&H()):(z(!1),n([]),i([]),o([]),c(null),X())},[e,t,N,V,H]);async function j(){if(!e){B("User not authenticated.");return}if(!g.trim()){B("Title is required.");return}B(null);const $=b||null,Z=_||null;if($&&Z){B("A note can be linked to either a character OR a party, not both.");return}const te={title:g.trim(),content:v,user_id:e.id,character_id:$,party_id:Z,updated_at:new Date().toISOString()};try{let ge=null;if(f){const{data:we,error:Te}=await re.from("notes").update(te).eq("id",f).select("*, character:characters(name), party:parties(name)").single();if(Te)throw Te;ge=we}else{const{updated_at:we,...Te}=te,{data:ze,error:Ze}=await re.from("notes").insert([Te]).select("*, character:characters(name), party:parties(name)").single();if(Ze)throw Ze;ge=ze}X(),await N(),ge&&c(ge)}catch(ge){console.error("Error saving note:",ge),B(ge instanceof Error?`Failed to save note: ${ge.message}`:"An unknown error occurred.")}}async function he($){if(window.confirm("Are you sure you want to delete this note?"))try{Y(null);const{error:Z}=await re.from("notes").delete().eq("id",$);if(Z)throw Z;await N(),(u==null?void 0:u.id)===$&&c(null),f===$&&X()}catch(Z){console.error("Error deleting note:",Z),Y(Z instanceof Error?`Failed to delete note: ${Z.message}`:"An unknown error occurred.")}}const J=r.filter($=>{const Z=$.title.toLowerCase().includes(S.toLowerCase())||$.content.toLowerCase().includes(S.toLowerCase()),te=R==="all"||R==="personal"&&!$.character_id&&!$.party_id||R==="character"&&!!$.character_id||R==="party"&&!!$.party_id;return Z&&te});if(T&&r.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[a.jsx(He,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading notes..."})]});const q=d||f;return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(nc,{className:"w-6 h-6 text-blue-600"}),"Notes"]}),a.jsx(U,{variant:"primary",size:"sm",icon:Xt,onClick:K,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:S,onChange:$=>A($.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:R,onChange:$=>L($.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white","aria-label":"Filter notes",children:[a.jsx("option",{value:"all",children:"All Notes"}),a.jsx("option",{value:"personal",children:"My Personal Notes"}),a.jsx("option",{value:"character",children:"Character Notes"}),a.jsx("option",{value:"party",children:"Party Notes"})]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Fh,{className:"w-4 h-4 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[O&&!q&&a.jsx("div",{className:"p-4",children:a.jsx(Ne,{message:O,onClose:()=>Y(null)})}),J.length>0?J.map($=>a.jsxs("div",{onClick:()=>{(!f||f!==$.id)&&(c($),h(!1),p(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(u==null?void 0:u.id)===$.id&&!q?"bg-blue-50 border-l-4 border-blue-500":""} ${f===$.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:$.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:$.content.substring(0,50)+($.content.length>50?"...":"")}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:$.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:["Char: ",$.character.name]}):$.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-xs",children:["Party: ",$.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-xs",children:"Personal"})})]},$.id)):!T&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Ul,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),S||R!=="all"?"No notes match.":"No notes yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:q?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Note":"Create New Note"}),a.jsx("button",{onClick:X,className:"text-gray-500 hover:text-gray-700","aria-label":"Close form",children:a.jsx(Rt,{className:"w-5 h-5"})})]}),G&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:G,onClose:()=>B(null)})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"title",value:g,onChange:$=>y($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter note title",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"character",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Character (Optional)"}),a.jsxs("select",{id:"character",value:b,onChange:$=>{w($.target.value),$.target.value&&k("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!_,children:[a.jsx("option",{value:"",children:"None"}),s.map($=>a.jsx("option",{value:$.id,children:$.name},$.id))]})]}),t()&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Party (Optional, DM Only)"}),a.jsxs("select",{id:"party",value:_,onChange:$=>{k($.target.value),$.target.value&&w("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!b,children:[a.jsx("option",{value:"",children:"None"}),l.map($=>a.jsx("option",{value:$.id,children:$.name},$.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"content",value:v,onChange:$=>x($.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter note content..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use Markdown for formatting."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx(U,{variant:"secondary",onClick:X,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:Qt,onClick:j,disabled:!g.trim(),children:f?"Update Note":"Save Note"})]})]})]}):u?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:u.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:u.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["Character: ",u.character.name]}):u.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Party: ",u.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Personal"})})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:ic,onClick:()=>P(u),children:"Edit"}),a.jsx(U,{variant:"danger_outline",size:"sm",icon:cr,onClick:()=>he(u.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Xg,{content:u.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(u.created_at).toLocaleDateString(),u.updated_at&&new Date(u.updated_at).getTime()!==new Date(u.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(u.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Ul,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),O&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ne,{message:O,onClose:()=>Y(null)})})]})})]})}var Qe;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const i={};for(const l of s)i[l]=l;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),l={};for(const o of i)l[o]=s[o];return e.objectValues(l)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&i.push(l);return i},e.find=(s,i)=>{for(const l of s)if(i(l))return l},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qe||(Qe={}));var o0;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(o0||(o0={}));const ye=Qe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ps=e=>{switch(typeof e){case"undefined":return ye.undefined;case"string":return ye.string;case"number":return isNaN(e)?ye.nan:ye.number;case"boolean":return ye.boolean;case"function":return ye.function;case"bigint":return ye.bigint;case"symbol":return ye.symbol;case"object":return Array.isArray(e)?ye.array:e===null?ye.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ye.promise:typeof Map<"u"&&e instanceof Map?ye.map:typeof Set<"u"&&e instanceof Set?ye.set:typeof Date<"u"&&e instanceof Date?ye.date:ye.object;default:return ye.unknown}},oe=Qe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),zF=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Gr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},s=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let o=n,u=0;for(;u<l.path.length;){const c=l.path[u];u===l.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(l))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),n}static assert(t){if(!(t instanceof Gr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Gr.create=e=>new Gr(e);const zl=(e,t)=>{let r;switch(e.code){case oe.invalid_type:e.received===ye.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case oe.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Qe.jsonStringifyReplacer)}`;break;case oe.unrecognized_keys:r=`Unrecognized key(s) in object: ${Qe.joinValues(e.keys,", ")}`;break;case oe.invalid_union:r="Invalid input";break;case oe.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Qe.joinValues(e.options)}`;break;case oe.invalid_enum_value:r=`Invalid enum value. Expected ${Qe.joinValues(e.options)}, received '${e.received}'`;break;case oe.invalid_arguments:r="Invalid function arguments";break;case oe.invalid_return_type:r="Invalid function return type";break;case oe.invalid_date:r="Invalid date";break;case oe.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Qe.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case oe.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case oe.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case oe.custom:r="Invalid input";break;case oe.invalid_intersection_types:r="Intersection results could not be merged";break;case oe.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case oe.not_finite:r="Number must be finite";break;default:r=t.defaultError,Qe.assertNever(e)}return{message:r}};let c_=zl;function qF(e){c_=e}function sh(){return c_}const ah=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],l={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)o=c(l,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},VF=[];function pe(e,t){const r=sh(),n=ah({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===zl?void 0:zl].filter(s=>!!s)});e.common.issues.push(n)}class hr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return Ae;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const i=await s.key,l=await s.value;n.push({key:i,value:l})}return hr.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:i,value:l}=s;if(i.status==="aborted"||l.status==="aborted")return Ae;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const Ae=Object.freeze({status:"aborted"}),tl=e=>({status:"dirty",value:e}),Er=e=>({status:"valid",value:e}),u0=e=>e.status==="aborted",c0=e=>e.status==="dirty",vi=e=>e.status==="valid",Lu=e=>typeof Promise<"u"&&e instanceof Promise;function ih(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function d_(e,t,r,n,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var ve;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ve||(ve={}));var Po,Do;class ts{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const z1=(e,t)=>{if(vi(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Gr(e.common.issues);return this._error=r,this._error}}};function Pe(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(l,o)=>{var u,c;const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}},description:s}}class Ue{get description(){return this._def.description}_getType(t){return ps(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:ps(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new hr,ctx:{common:t.parent.common,data:t.data,parsedType:ps(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Lu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ps(t)},i=this._parseSync({data:t,path:s.path,parent:s});return z1(s,i)}"~validate"(t){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ps(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return vi(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>vi(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ps(t)},s=this._parse({data:t,path:n.path,parent:n}),i=await(Lu(s)?s:Promise.resolve(s));return z1(n,i)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const l=t(s),o=()=>i.addIssue({code:oe.custom,...n(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new Dn({schema:this,typeName:Ce.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Jn.create(this,this._def)}nullable(){return _a.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ln.create(this)}promise(){return Vl.create(this,this._def)}or(t){return Mu.create([this,t],this._def)}and(t){return Fu.create(this,t,this._def)}transform(t){return new Dn({...Pe(this._def),schema:this,typeName:Ce.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new zu({...Pe(this._def),innerType:this,defaultValue:r,typeName:Ce.ZodDefault})}brand(){return new Jg({typeName:Ce.ZodBranded,type:this,...Pe(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new qu({...Pe(this._def),innerType:this,catchValue:r,typeName:Ce.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return xc.create(this,t)}readonly(){return Vu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const WF=/^c[^\s-]{8,}$/i,GF=/^[0-9a-z]+$/,YF=/^[0-9A-HJKMNP-TV-Z]{26}$/i,QF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,KF=/^[a-z0-9_-]{21}$/i,ZF=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,XF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,JF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,eU="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let wm;const tU=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rU=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,nU=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,sU=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,aU=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,iU=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,h_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",lU=new RegExp(`^${h_}$`);function f_(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function oU(e){return new RegExp(`^${f_(e)}$`)}function m_(e){let t=`${h_}T${f_(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function uU(e,t){return!!((t==="v4"||!t)&&tU.test(e)||(t==="v6"||!t)&&nU.test(e))}function cU(e,t){if(!ZF.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function dU(e,t){return!!((t==="v4"||!t)&&rU.test(e)||(t==="v6"||!t)&&sU.test(e))}class Sn extends Ue{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ye.string){const i=this._getOrReturnCtx(t);return pe(i,{code:oe.invalid_type,expected:ye.string,received:i.parsedType}),Ae}const n=new hr;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(s=this._getOrReturnCtx(t,s),l?pe(s,{code:oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&pe(s,{code:oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")JF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"email",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")wm||(wm=new RegExp(eU,"u")),wm.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"emoji",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")QF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"uuid",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")KF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"nanoid",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")WF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")GF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cuid2",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")YF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ulid",code:oe.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),pe(s,{validation:"url",code:oe.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"regex",code:oe.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?m_(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?lU.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?oU(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?XF.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"duration",code:oe.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?uU(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"ip",code:oe.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?cU(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"jwt",code:oe.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?dU(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"cidr",code:oe.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?aU.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64",code:oe.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?iU.test(t.data)||(s=this._getOrReturnCtx(t,s),pe(s,{validation:"base64url",code:oe.invalid_string,message:i.message}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:oe.invalid_string,...ve.errToObj(n)})}_addCheck(t){return new Sn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ve.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ve.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ve.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ve.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ve.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ve.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ve.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ve.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ve.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ve.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ve.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ve.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ve.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...ve.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ve.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ve.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ve.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ve.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ve.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ve.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ve.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ve.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ve.errToObj(r)})}nonempty(t){return this.min(1,ve.errToObj(t))}trim(){return new Sn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Sn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Sn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Sn.create=e=>{var t;return new Sn({checks:[],typeName:Ce.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pe(e)})};function hU(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(e.toFixed(s).replace(".","")),l=parseInt(t.toFixed(s).replace(".",""));return i%l/Math.pow(10,s)}class Ea extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ye.number){const i=this._getOrReturnCtx(t);return pe(i,{code:oe.invalid_type,expected:ye.number,received:i.parsedType}),Ae}let n;const s=new hr;for(const i of this._def.checks)i.kind==="int"?Qe.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?hU(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.not_finite,message:i.message}),s.dirty()):Qe.assertNever(i);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new Ea({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new Ea({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ve.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ve.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ve.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ve.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qe.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Ea.create=e=>new Ea({checks:[],typeName:Ce.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Pe(e)});class Na extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ye.bigint)return this._getInvalidInput(t);let n;const s=new hr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),pe(n,{code:oe.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qe.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return pe(r,{code:oe.invalid_type,expected:ye.bigint,received:r.parsedType}),Ae}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new Na({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new Na({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Na.create=e=>{var t;return new Na({checks:[],typeName:Ce.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pe(e)})};class Ou extends Ue{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ye.boolean){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.boolean,received:n.parsedType}),Ae}return Er(t.data)}}Ou.create=e=>new Ou({typeName:Ce.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Pe(e)});class wi extends Ue{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ye.date){const i=this._getOrReturnCtx(t);return pe(i,{code:oe.invalid_type,expected:ye.date,received:i.parsedType}),Ae}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pe(i,{code:oe.invalid_date}),Ae}const n=new hr;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),pe(s,{code:oe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new wi({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ve.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ve.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}wi.create=e=>new wi({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Ce.ZodDate,...Pe(e)});class lh extends Ue{_parse(t){if(this._getType(t)!==ye.symbol){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.symbol,received:n.parsedType}),Ae}return Er(t.data)}}lh.create=e=>new lh({typeName:Ce.ZodSymbol,...Pe(e)});class Pu extends Ue{_parse(t){if(this._getType(t)!==ye.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.undefined,received:n.parsedType}),Ae}return Er(t.data)}}Pu.create=e=>new Pu({typeName:Ce.ZodUndefined,...Pe(e)});class Du extends Ue{_parse(t){if(this._getType(t)!==ye.null){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.null,received:n.parsedType}),Ae}return Er(t.data)}}Du.create=e=>new Du({typeName:Ce.ZodNull,...Pe(e)});class ql extends Ue{constructor(){super(...arguments),this._any=!0}_parse(t){return Er(t.data)}}ql.create=e=>new ql({typeName:Ce.ZodAny,...Pe(e)});class ui extends Ue{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Er(t.data)}}ui.create=e=>new ui({typeName:Ce.ZodUnknown,...Pe(e)});class js extends Ue{_parse(t){const r=this._getOrReturnCtx(t);return pe(r,{code:oe.invalid_type,expected:ye.never,received:r.parsedType}),Ae}}js.create=e=>new js({typeName:Ce.ZodNever,...Pe(e)});class oh extends Ue{_parse(t){if(this._getType(t)!==ye.undefined){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.void,received:n.parsedType}),Ae}return Er(t.data)}}oh.create=e=>new oh({typeName:Ce.ZodVoid,...Pe(e)});class Ln extends Ue{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==ye.array)return pe(r,{code:oe.invalid_type,expected:ye.array,received:r.parsedType}),Ae;if(s.exactLength!==null){const l=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(l||o)&&(pe(r,{code:l?oe.too_big:oe.too_small,minimum:o?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(pe(r,{code:oe.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(pe(r,{code:oe.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>s.type._parseAsync(new ts(r,l,r.path,o)))).then(l=>hr.mergeArray(n,l));const i=[...r.data].map((l,o)=>s.type._parseSync(new ts(r,l,r.path,o)));return hr.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new Ln({...this._def,minLength:{value:t,message:ve.toString(r)}})}max(t,r){return new Ln({...this._def,maxLength:{value:t,message:ve.toString(r)}})}length(t,r){return new Ln({...this._def,exactLength:{value:t,message:ve.toString(r)}})}nonempty(t){return this.min(1,t)}}Ln.create=(e,t)=>new Ln({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Ce.ZodArray,...Pe(t)});function Hi(e){if(e instanceof kt){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Jn.create(Hi(n))}return new kt({...e._def,shape:()=>t})}else return e instanceof Ln?new Ln({...e._def,type:Hi(e.element)}):e instanceof Jn?Jn.create(Hi(e.unwrap())):e instanceof _a?_a.create(Hi(e.unwrap())):e instanceof rs?rs.create(e.items.map(t=>Hi(t))):e}class kt extends Ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Qe.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ye.object){const c=this._getOrReturnCtx(t);return pe(c,{code:oe.invalid_type,expected:ye.object,received:c.parsedType}),Ae}const{status:n,ctx:s}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof js&&this._def.unknownKeys==="strip"))for(const c in s.data)l.includes(c)||o.push(c);const u=[];for(const c of l){const d=i[c],h=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new ts(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof js){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")o.length>0&&(pe(s,{code:oe.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new ts(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const h=await d.key,f=await d.value;c.push({key:h,value:f,alwaysSet:d.alwaysSet})}return c}).then(c=>hr.mergeObjectSync(n,c)):hr.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return ve.errToObj,new kt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var s,i,l,o;const u=(l=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&l!==void 0?l:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=ve.errToObj(t).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new kt({...this._def,unknownKeys:"strip"})}passthrough(){return new kt({...this._def,unknownKeys:"passthrough"})}extend(t){return new kt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new kt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Ce.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new kt({...this._def,catchall:t})}pick(t){const r={};return Qe.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new kt({...this._def,shape:()=>r})}omit(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new kt({...this._def,shape:()=>r})}deepPartial(){return Hi(this)}partial(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}),new kt({...this._def,shape:()=>r})}required(t){const r={};return Qe.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Jn;)i=i._def.innerType;r[n]=i}}),new kt({...this._def,shape:()=>r})}keyof(){return p_(Qe.objectKeys(this.shape))}}kt.create=(e,t)=>new kt({shape:()=>e,unknownKeys:"strip",catchall:js.create(),typeName:Ce.ZodObject,...Pe(t)});kt.strictCreate=(e,t)=>new kt({shape:()=>e,unknownKeys:"strict",catchall:js.create(),typeName:Ce.ZodObject,...Pe(t)});kt.lazycreate=(e,t)=>new kt({shape:e,unknownKeys:"strip",catchall:js.create(),typeName:Ce.ZodObject,...Pe(t)});class Mu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Gr(o.ctx.common.issues));return pe(r,{code:oe.invalid_union,unionErrors:l}),Ae}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(s);{let i;const l=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(u=>new Gr(u));return pe(r,{code:oe.invalid_union,unionErrors:o}),Ae}}get options(){return this._def.options}}Mu.create=(e,t)=>new Mu({options:e,typeName:Ce.ZodUnion,...Pe(t)});const ds=e=>e instanceof Bu?ds(e.schema):e instanceof Dn?ds(e.innerType()):e instanceof Hu?[e.value]:e instanceof ka?e.options:e instanceof $u?Qe.objectValues(e.enum):e instanceof zu?ds(e._def.innerType):e instanceof Pu?[void 0]:e instanceof Du?[null]:e instanceof Jn?[void 0,...ds(e.unwrap())]:e instanceof _a?[null,...ds(e.unwrap())]:e instanceof Jg||e instanceof Vu?ds(e.unwrap()):e instanceof qu?ds(e._def.innerType):[];class ef extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.object)return pe(r,{code:oe.invalid_type,expected:ye.object,received:r.parsedType}),Ae;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(pe(r,{code:oe.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ae)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const s=new Map;for(const i of r){const l=ds(i.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of l){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new ef({typeName:Ce.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:s,...Pe(n)})}}function d0(e,t){const r=ps(e),n=ps(t);if(e===t)return{valid:!0,data:e};if(r===ye.object&&n===ye.object){const s=Qe.objectKeys(t),i=Qe.objectKeys(e).filter(o=>s.indexOf(o)!==-1),l={...e,...t};for(const o of i){const u=d0(e[o],t[o]);if(!u.valid)return{valid:!1};l[o]=u.data}return{valid:!0,data:l}}else if(r===ye.array&&n===ye.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const l=e[i],o=t[i],u=d0(l,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===ye.date&&n===ye.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Fu extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(i,l)=>{if(u0(i)||u0(l))return Ae;const o=d0(i.value,l.value);return o.valid?((c0(i)||c0(l))&&r.dirty(),{status:r.value,value:o.data}):(pe(n,{code:oe.invalid_intersection_types}),Ae)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>s(i,l)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Fu.create=(e,t,r)=>new Fu({left:e,right:t,typeName:Ce.ZodIntersection,...Pe(r)});class rs extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.array)return pe(n,{code:oe.invalid_type,expected:ye.array,received:n.parsedType}),Ae;if(n.data.length<this._def.items.length)return pe(n,{code:oe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&n.data.length>this._def.items.length&&(pe(n,{code:oe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new ts(n,l,n.path,o)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>hr.mergeArray(r,l)):hr.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new rs({...this._def,rest:t})}}rs.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new rs({items:e,typeName:Ce.ZodTuple,rest:null,...Pe(t)})};class Uu extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.object)return pe(n,{code:oe.invalid_type,expected:ye.object,received:n.parsedType}),Ae;const s=[],i=this._def.keyType,l=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new ts(n,o,n.path,o)),value:l._parse(new ts(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?hr.mergeObjectAsync(r,s):hr.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Ue?new Uu({keyType:t,valueType:r,typeName:Ce.ZodRecord,...Pe(n)}):new Uu({keyType:Sn.create(),valueType:t,typeName:Ce.ZodRecord,...Pe(r)})}}class uh extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.map)return pe(n,{code:oe.invalid_type,expected:ye.map,received:n.parsedType}),Ae;const s=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([o,u],c)=>({key:s._parse(new ts(n,o,n.path,[c,"key"])),value:i._parse(new ts(n,u,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of l){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return Ae;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of l){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return Ae;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}}}}uh.create=(e,t,r)=>new uh({valueType:t,keyType:e,typeName:Ce.ZodMap,...Pe(r)});class Ei extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==ye.set)return pe(n,{code:oe.invalid_type,expected:ye.set,received:n.parsedType}),Ae;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(pe(n,{code:oe.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(pe(n,{code:oe.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function l(u){const c=new Set;for(const d of u){if(d.status==="aborted")return Ae;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const o=[...n.data.values()].map((u,c)=>i._parse(new ts(n,u,n.path,c)));return n.common.async?Promise.all(o).then(u=>l(u)):l(o)}min(t,r){return new Ei({...this._def,minSize:{value:t,message:ve.toString(r)}})}max(t,r){return new Ei({...this._def,maxSize:{value:t,message:ve.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Ei.create=(e,t)=>new Ei({valueType:e,minSize:null,maxSize:null,typeName:Ce.ZodSet,...Pe(t)});class gl extends Ue{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.function)return pe(r,{code:oe.invalid_type,expected:ye.function,received:r.parsedType}),Ae;function n(o,u){return ah({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,sh(),zl].filter(c=>!!c),issueData:{code:oe.invalid_arguments,argumentsError:u}})}function s(o,u){return ah({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,sh(),zl].filter(c=>!!c),issueData:{code:oe.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},l=r.data;if(this._def.returns instanceof Vl){const o=this;return Er(async function(...u){const c=new Gr([]),d=await o._def.args.parseAsync(u,i).catch(p=>{throw c.addIssue(n(u,p)),c}),h=await Reflect.apply(l,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(p=>{throw c.addIssue(s(h,p)),c})})}else{const o=this;return Er(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Gr([n(u,c.error)]);const d=Reflect.apply(l,this,c.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Gr([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new gl({...this._def,args:rs.create(t).rest(ui.create())})}returns(t){return new gl({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new gl({args:t||rs.create([]).rest(ui.create()),returns:r||ui.create(),typeName:Ce.ZodFunction,...Pe(n)})}}class Bu extends Ue{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Bu.create=(e,t)=>new Bu({getter:e,typeName:Ce.ZodLazy,...Pe(t)});class Hu extends Ue{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return pe(r,{received:r.data,code:oe.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:t.data}}get value(){return this._def.value}}Hu.create=(e,t)=>new Hu({value:e,typeName:Ce.ZodLiteral,...Pe(t)});function p_(e,t){return new ka({values:e,typeName:Ce.ZodEnum,...Pe(t)})}class ka extends Ue{constructor(){super(...arguments),Po.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{expected:Qe.joinValues(n),received:r.parsedType,code:oe.invalid_type}),Ae}if(ih(this,Po)||d_(this,Po,new Set(this._def.values)),!ih(this,Po).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return pe(r,{received:r.data,code:oe.invalid_enum_value,options:n}),Ae}return Er(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return ka.create(t,{...this._def,...r})}exclude(t,r=this._def){return ka.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Po=new WeakMap;ka.create=p_;class $u extends Ue{constructor(){super(...arguments),Do.set(this,void 0)}_parse(t){const r=Qe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==ye.string&&n.parsedType!==ye.number){const s=Qe.objectValues(r);return pe(n,{expected:Qe.joinValues(s),received:n.parsedType,code:oe.invalid_type}),Ae}if(ih(this,Do)||d_(this,Do,new Set(Qe.getValidEnumValues(this._def.values))),!ih(this,Do).has(t.data)){const s=Qe.objectValues(r);return pe(n,{received:n.data,code:oe.invalid_enum_value,options:s}),Ae}return Er(t.data)}get enum(){return this._def.values}}Do=new WeakMap;$u.create=(e,t)=>new $u({values:e,typeName:Ce.ZodNativeEnum,...Pe(t)});class Vl extends Ue{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ye.promise&&r.common.async===!1)return pe(r,{code:oe.invalid_type,expected:ye.promise,received:r.parsedType}),Ae;const n=r.parsedType===ye.promise?r.data:Promise.resolve(r.data);return Er(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Vl.create=(e,t)=>new Vl({type:e,typeName:Ce.ZodPromise,...Pe(t)});class Dn extends Ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ce.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:l=>{pe(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const l=s.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return Ae;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?Ae:u.status==="dirty"||r.value==="dirty"?tl(u.value):u});{if(r.value==="aborted")return Ae;const o=this._def.schema._parseSync({data:l,path:n.path,parent:n});return o.status==="aborted"?Ae:o.status==="dirty"||r.value==="dirty"?tl(o.value):o}}if(s.type==="refinement"){const l=o=>{const u=s.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Ae:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Ae:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!vi(l))return l;const o=s.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>vi(l)?Promise.resolve(s.transform(l.value,i)).then(o=>({status:r.value,value:o})):l);Qe.assertNever(s)}}Dn.create=(e,t,r)=>new Dn({schema:e,typeName:Ce.ZodEffects,effect:t,...Pe(r)});Dn.createWithPreprocess=(e,t,r)=>new Dn({schema:t,effect:{type:"preprocess",transform:e},typeName:Ce.ZodEffects,...Pe(r)});class Jn extends Ue{_parse(t){return this._getType(t)===ye.undefined?Er(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Jn.create=(e,t)=>new Jn({innerType:e,typeName:Ce.ZodOptional,...Pe(t)});class _a extends Ue{_parse(t){return this._getType(t)===ye.null?Er(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_a.create=(e,t)=>new _a({innerType:e,typeName:Ce.ZodNullable,...Pe(t)});class zu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===ye.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}zu.create=(e,t)=>new zu({innerType:e,typeName:Ce.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Pe(t)});class qu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Lu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Gr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Gr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}qu.create=(e,t)=>new qu({innerType:e,typeName:Ce.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Pe(t)});class ch extends Ue{_parse(t){if(this._getType(t)!==ye.nan){const n=this._getOrReturnCtx(t);return pe(n,{code:oe.invalid_type,expected:ye.nan,received:n.parsedType}),Ae}return{status:"valid",value:t.data}}}ch.create=e=>new ch({typeName:Ce.ZodNaN,...Pe(e)});const fU=Symbol("zod_brand");class Jg extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class xc extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ae:i.status==="dirty"?(r.dirty(),tl(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ae:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new xc({in:t,out:r,typeName:Ce.ZodPipeline})}}class Vu extends Ue{_parse(t){const r=this._def.innerType._parse(t),n=s=>(vi(s)&&(s.value=Object.freeze(s.value)),s);return Lu(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Vu.create=(e,t)=>new Vu({innerType:e,typeName:Ce.ZodReadonly,...Pe(t)});function q1(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function g_(e,t={},r){return e?ql.create().superRefine((n,s)=>{var i,l;const o=e(n);if(o instanceof Promise)return o.then(u=>{var c,d;if(!u){const h=q1(t,n),f=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;s.addIssue({code:"custom",...h,fatal:f})}});if(!o){const u=q1(t,n),c=(l=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...u,fatal:c})}}):ql.create()}const mU={object:kt.lazycreate};var Ce;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Ce||(Ce={}));const pU=(e,t={message:`Input not instance of ${e.name}`})=>g_(r=>r instanceof e,t),x_=Sn.create,y_=Ea.create,gU=ch.create,xU=Na.create,b_=Ou.create,yU=wi.create,bU=lh.create,vU=Pu.create,wU=Du.create,EU=ql.create,NU=ui.create,kU=js.create,_U=oh.create,SU=Ln.create,TU=kt.create,CU=kt.strictCreate,jU=Mu.create,AU=ef.create,IU=Fu.create,RU=rs.create,LU=Uu.create,OU=uh.create,PU=Ei.create,DU=gl.create,MU=Bu.create,FU=Hu.create,UU=ka.create,BU=$u.create,HU=Vl.create,V1=Dn.create,$U=Jn.create,zU=_a.create,qU=Dn.createWithPreprocess,VU=xc.create,WU=()=>x_().optional(),GU=()=>y_().optional(),YU=()=>b_().optional(),QU={string:e=>Sn.create({...e,coerce:!0}),number:e=>Ea.create({...e,coerce:!0}),boolean:e=>Ou.create({...e,coerce:!0}),bigint:e=>Na.create({...e,coerce:!0}),date:e=>wi.create({...e,coerce:!0})},KU=Ae;var zr=Object.freeze({__proto__:null,defaultErrorMap:zl,setErrorMap:qF,getErrorMap:sh,makeIssue:ah,EMPTY_PATH:VF,addIssueToContext:pe,ParseStatus:hr,INVALID:Ae,DIRTY:tl,OK:Er,isAborted:u0,isDirty:c0,isValid:vi,isAsync:Lu,get util(){return Qe},get objectUtil(){return o0},ZodParsedType:ye,getParsedType:ps,ZodType:Ue,datetimeRegex:m_,ZodString:Sn,ZodNumber:Ea,ZodBigInt:Na,ZodBoolean:Ou,ZodDate:wi,ZodSymbol:lh,ZodUndefined:Pu,ZodNull:Du,ZodAny:ql,ZodUnknown:ui,ZodNever:js,ZodVoid:oh,ZodArray:Ln,ZodObject:kt,ZodUnion:Mu,ZodDiscriminatedUnion:ef,ZodIntersection:Fu,ZodTuple:rs,ZodRecord:Uu,ZodMap:uh,ZodSet:Ei,ZodFunction:gl,ZodLazy:Bu,ZodLiteral:Hu,ZodEnum:ka,ZodNativeEnum:$u,ZodPromise:Vl,ZodEffects:Dn,ZodTransformer:Dn,ZodOptional:Jn,ZodNullable:_a,ZodDefault:zu,ZodCatch:qu,ZodNaN:ch,BRAND:fU,ZodBranded:Jg,ZodPipeline:xc,ZodReadonly:Vu,custom:g_,Schema:Ue,ZodSchema:Ue,late:mU,get ZodFirstPartyTypeKind(){return Ce},coerce:QU,any:EU,array:SU,bigint:xU,boolean:b_,date:yU,discriminatedUnion:AU,effect:V1,enum:UU,function:DU,instanceof:pU,intersection:IU,lazy:MU,literal:FU,map:OU,nan:gU,nativeEnum:BU,never:kU,null:wU,nullable:zU,number:y_,object:TU,oboolean:YU,onumber:GU,optional:$U,ostring:WU,pipeline:VU,preprocess:qU,promise:HU,record:LU,set:PU,strictObject:CU,string:x_,symbol:bU,transformer:V1,tuple:RU,undefined:vU,union:jU,unknown:NU,void:_U,NEVER:KU,ZodIssueCode:oe,quotelessJson:zF,ZodError:Gr});const ZU=zr.object({email:zr.string().email({message:"Invalid email address"}),password:zr.string().min(1,{message:"Password is required"})}),XU=zr.object({username:zr.string().min(3,{message:"Username must be at least 3 characters long"}).max(50,{message:"Username cannot exceed 50 characters"}),email:zr.string().email({message:"Invalid email address"}),password:zr.string().min(8,{message:"Password must be at least 8 characters long"}),confirmPassword:zr.string(),role:zr.enum(["player","dm"],{required_error:"Please select a role"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),JU=zr.object({currentPassword:zr.string().min(1,"Current password is required"),newPassword:zr.string().min(8,"New password must be at least 8 characters"),confirmNewPassword:zr.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"New passwords don't match",path:["confirmNewPassword"]});function eB(){const[e,t]=E.useState(""),[r,n]=E.useState(""),[s,i]=E.useState(""),[l,o]=E.useState(null),[u,c]=E.useState(null),[d,h]=E.useState(!1),[f,p]=E.useState({}),{updateUserPassword:g}=qt(),y=async v=>{v.preventDefault(),o(null),c(null),p({});const x=JU.safeParse({currentPassword:e,newPassword:r,confirmPassword:s});if(!x.success){const b={};x.error.errors.forEach(w=>{const _=w.path[0];_?b[_]=w.message:o(w.message)}),p(b),!l&&Object.keys(b).length>0&&o("Please fix the errors in the form.");return}h(!0);try{const{currentPassword:b,newPassword:w}=x.data;await g(b,w),c("Password updated successfully!"),t(""),n(""),i("")}catch(b){console.error("Password update error:",b),o(b instanceof Error?b.message:"Failed to update password.")}finally{h(!1)}};return a.jsxs("form",{onSubmit:y,className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Change Password"}),l&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Dt,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),u&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(sc,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:u})})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"current-password",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:v=>t(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.currentPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.currentPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.currentPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"new-password",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:v=>n(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.newPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.newPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.newPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirm-password",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s,onChange:v=>i(v.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.confirmPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.confirmPassword})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",loading:d,disabled:d,children:"Update Password"})})]})}async function v_(e){if(!e)return console.error("getUserProfile: No user ID provided."),null;try{const{data:t,error:r,status:n}=await re.from("users").select("id, username, first_name, last_name, avatar_url, bio").eq("id",e).single();if(r){if(n===406||r.code==="PGRST116")return console.warn(`No profile found for user ID: ${e}. This might be expected.`),null;throw console.error("Error fetching user profile:",r.message),new Error(`Failed to fetch user profile: ${r.message}`)}return t}catch(t){throw console.error("Unexpected error in getUserProfile:",t),t instanceof Error?t:new Error("An unknown error occurred while fetching the user profile.")}}async function tB(e,t){if(!e)throw new Error("updateUserProfile: No user ID provided.");if(!t||Object.keys(t).length===0)throw new Error("updateUserProfile: No updates provided.");const r={username:t.username,first_name:t.first_name,last_name:t.last_name,avatar_url:t.avatar_url,bio:t.bio};if(Object.keys(r).forEach(n=>{const s=n;r[s]===void 0&&delete r[s]}),Object.keys(r).length===0){console.warn("updateUserProfile: No valid fields to update after filtering.");const n=await v_(e);if(!n)throw new Error("Could not retrieve current profile after filtering updates.");return n}try{const{data:n,error:s}=await re.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select("id, username, first_name, last_name, avatar_url, bio").single();if(s)throw console.error("Error updating user profile:",s.message),s.code==="23505"?s.message.includes("users_username_key")?new Error(`Failed to update profile: Username '${r.username}' is already taken.`):new Error(`Failed to update profile: ${s.details||"A unique value constraint was violated."}`):new Error(`Failed to update user profile: ${s.message}`);if(!n)throw new Error("Failed to update user profile: No data returned.");return n}catch(n){throw console.error("Unexpected error in updateUserProfile:",n),n instanceof Error?n:new Error("An unknown error occurred while updating the user profile.")}}async function rB(e){if(!e)throw new Error("updateUserAuthEmail: No new email provided.");if(!/\S+@\S+\.\S+/.test(e))throw new Error("updateUserAuthEmail: Invalid email format provided.");try{const{data:t,error:r}=await re.auth.updateUser({email:e});if(r)throw console.error("Error updating user auth email:",r.message),r.message.includes("User not found")||r.status===404?new Error("Failed to initiate email update: Could not find the current user."):r.message.includes("Email rate limit exceeded")?new Error("Failed to initiate email update: Please wait before trying again."):r.message.includes("same as the existing email")?new Error("The new email address is the same as the current one."):new Error(`Failed to initiate email update: ${r.message}`);console.log("User auth email update initiated. Verification required.",t)}catch(t){throw console.error("Unexpected error in updateUserAuthEmail:",t),t instanceof Error?t:new Error("An unknown error occurred while updating the user's email.")}}function nB(){var A;const{user:e,session:t}=qt(),[r,n]=E.useState(null),[s,i]=E.useState({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),[l,o]=E.useState(""),[u,c]=E.useState(""),[d,h]=E.useState(!0),[f,p]=E.useState(!1),[g,y]=E.useState(null),[v,x]=E.useState(null),b=E.useCallback(async R=>{var L,T,z;h(!0),y(null),x(null);try{const O=await v_(R.id),Y=R.email??"";O?(n(O),i({first_name:O.first_name??"",last_name:O.last_name??"",username:O.username??((L=R.user_metadata)==null?void 0:L.username)??"",avatar_url:O.avatar_url??"",bio:O.bio??""})):(console.warn("User profile not found in 'users' table, initializing form with defaults/metadata."),i({first_name:"",last_name:"",username:((T=R.user_metadata)==null?void 0:T.username)??"",avatar_url:"",bio:""})),o(Y),c(Y)}catch(O){console.error("Failed to load profile:",O),y(O instanceof Error?O.message:"Failed to load profile data.");const Y=(e==null?void 0:e.email)??"";o(Y),c(Y),i({first_name:"",last_name:"",username:((z=e==null?void 0:e.user_metadata)==null?void 0:z.username)??"",avatar_url:"",bio:""})}finally{h(!1)}},[]);E.useEffect(()=>{e?b(e):(h(!1),n(null),i({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),o(""),c(""),y(null),x(null))},[e,b]);const w=R=>{const{name:L,value:T}=R.target;i(z=>({...z,[L]:T})),y(null),x(null)},_=R=>{o(R.target.value),y(null),x(null)},k=async R=>{var Y;if(R.preventDefault(),!e){y("You must be logged in to update your profile.");return}p(!0),y(null),x(null);let L=!1,T=!1,z="",O=!1;try{const G={},B=r??{username:((Y=e.user_metadata)==null?void 0:Y.username)??"",first_name:null,last_name:null,avatar_url:null,bio:null};if(s.first_name!==(B.first_name??"")&&(G.first_name=s.first_name),s.last_name!==(B.last_name??"")&&(G.last_name=s.last_name),s.username!==(B.username??"")&&(G.username=s.username),s.avatar_url!==(B.avatar_url??"")&&(G.avatar_url=s.avatar_url),s.bio!==(B.bio??"")&&(G.bio=s.bio),Object.keys(G).length>0){O=!0;const K=await tB(e.id,G);n(P=>P?{...P,...K}:K),i({first_name:K.first_name??"",last_name:K.last_name??"",username:K.username??"",avatar_url:K.avatar_url??"",bio:K.bio??""}),L=!0}else L=!0;const W=l.trim();if(W!==u){if(!W)throw new Error("Email cannot be empty.");O=!0,await rB(W),T=!0,z=" Email update initiated. Please check both your current and new email addresses for a verification link to complete the change."}if(O){let K="";L&&Object.keys(G).length>0&&(K+="Profile fields updated successfully."),K+=z,x(K.trim())}else x("No changes were detected.")}catch(G){console.error("Failed to update profile:",G);const B=G instanceof Error?G.message:"An unknown error occurred during update.";y(B)}finally{p(!1)}},S=R=>{var z;const L=R.currentTarget;L.style.display="none";const T=(z=L.parentElement)==null?void 0:z.querySelector(".fallback-icon");T&&(T.style.display="flex")};return d?a.jsx("div",{className:"flex justify-center items-center h-40",children:a.jsx(He,{})}):!e||!t?a.jsx("p",{className:"text-center text-red-600",children:"Please log in to view or edit your profile."}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8",children:[a.jsx("div",{className:"relative w-24 h-24",children:a.jsxs("div",{className:"w-full h-full rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border",children:[s.avatar_url&&a.jsx("img",{src:s.avatar_url,alt:"Profile",className:"w-full h-full object-cover",onError:S,style:{display:"block"}},s.avatar_url),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center fallback-icon",style:{display:s.avatar_url?"none":"flex"},children:a.jsx(Si,{className:"w-12 h-12 text-gray-400"})})]})}),a.jsxs("div",{className:"flex-grow w-full sm:w-auto",children:[a.jsx("h3",{className:"font-medium text-lg text-center sm:text-left",children:s.username||((A=e==null?void 0:e.user_metadata)==null?void 0:A.username)||"User"}),a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center sm:justify-start gap-1",children:[a.jsx(_g,{className:"w-4 h-4"}),l||"No email set"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{htmlFor:"avatar_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar URL"}),a.jsx("input",{id:"avatar_url",name:"avatar_url",type:"url",value:s.avatar_url??"",onChange:w,placeholder:"https://example.com/avatar.png",className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("form",{onSubmit:k,className:"space-y-6",children:[v&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(sc,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Success!"})," ",v]})]}),g&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(Dt,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Error!"})," ",g]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),a.jsx("input",{id:"first_name",name:"first_name",type:"text",value:s.first_name??"",onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),a.jsx("input",{id:"last_name",name:"last_name",type:"text",value:s.last_name??"",onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:l,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":"email-description"}),a.jsx("p",{id:"email-description",className:"text-xs text-gray-500 mt-1",children:"Changing your email requires verification via links sent to both addresses."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",value:s.username??"",onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be unique. Used for display and potentially logging in."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),a.jsx("textarea",{id:"bio",name:"bio",value:s.bio??"",onChange:w,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Tell us a little about yourself..."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(U,{type:"submit",variant:"primary",icon:Qt,loading:f,disabled:f||d,children:"Save Changes"})})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-12",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Change Password"}),a.jsx(eB,{})]})]})}function sB(){const[e,t]=E.useState("system"),[r,n]=E.useState("medium"),[s,i]=E.useState(!1),[l,o]=E.useState(!1),u=async c=>{c.preventDefault(),o(!0),await new Promise(d=>setTimeout(d,1e3)),o(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Appearance Settings"}),a.jsxs("form",{onSubmit:u,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("light"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="light"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(LE,{className:"w-6 h-6 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Light"})]}),a.jsxs("button",{type:"button",onClick:()=>t("dark"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="dark"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(TE,{className:"w-6 h-6 text-blue-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Dark"})]}),a.jsxs("button",{type:"button",onClick:()=>t("system"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="system"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(j4,{className:"w-6 h-6 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"System"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),a.jsxs("select",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"small",children:"Small"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"large",children:"Large"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:c=>i(c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reduce motion"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimize animations and transitions"})]}),a.jsxs("div",{className:"p-6 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsx("div",{className:`p-4 rounded-lg ${e==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:a.jsx("p",{className:`${r==="small"?"text-sm":r==="large"?"text-lg":"text-base"}`,children:"This is how your content will look with the selected theme and font size."})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:Qt,loading:l,children:"Save Changes"})})]})]})}function aB(){const[e,t]=E.useState({email:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,systemUpdates:!1},desktop:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,diceRolls:!0},sounds:{enabled:!0,volume:80,diceRolls:!0,notifications:!0}}),[r,n]=E.useState(!1),s=async i=>{i.preventDefault(),n(!0),await new Promise(l=>setTimeout(l,1e3)),n(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Notification Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(_g,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Email Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.email).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,email:{...e.email,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(E4,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Desktop Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.desktop).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,desktop:{...e.desktop,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(s4,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Sound Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.enabled,onChange:i=>t({...e,sounds:{...e.sounds,enabled:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Enable Sounds"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Volume (",e.sounds.volume,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",value:e.sounds.volume,onChange:i=>t({...e,sounds:{...e.sounds,volume:parseInt(i.target.value)}}),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.diceRolls,onChange:i=>t({...e,sounds:{...e.sounds,diceRolls:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Dice Roll Sounds"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.notifications,onChange:i=>t({...e,sounds:{...e.sounds,notifications:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Notification Sounds"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:Qt,loading:r,children:"Save Changes"})})]})]})}const iB=[{value:"en",label:"English"},{value:"et",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"sv",label:"Swedish"}],lB=[{value:"Europe/Tallinn",label:"Europe/Tallinn (UTC+2)"},{value:"Europe/Helsinki",label:"Europe/Helsinki (UTC+2)"},{value:"Europe/Stockholm",label:"Europe/Stockholm (UTC+1)"},{value:"UTC",label:"UTC"}],oB=[{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"YYYY-MM-DD",label:"YYYY-MM-DD"}],uB=[{value:"24h",label:"24-hour (14:30)"},{value:"12h",label:"12-hour (2:30 PM)"}];function cB(){const[e,t]=E.useState({language:"en",timeZone:"Europe/Tallinn",dateFormat:"DD/MM/YYYY",timeFormat:"24h",firstDayOfWeek:1,useMetricSystem:!0}),[r,n]=E.useState(!1),s=async o=>{o.preventDefault(),n(!0),await new Promise(u=>setTimeout(u,1e3)),n(!1)},i=new Date,l=new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"long",timeZone:e.timeZone}).format(i);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Localization Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(x4,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Language & Region"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interface Language"}),a.jsx("select",{value:e.language,onChange:o=>t({...e,language:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:iB.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),a.jsx("select",{value:e.timeZone,onChange:o=>t({...e,timeZone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:lB.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(wg,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Date & Time Format"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),a.jsx("select",{value:e.dateFormat,onChange:o=>t({...e,dateFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:oB.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),a.jsx("select",{value:e.timeFormat,onChange:o=>t({...e,timeFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:uB.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Day of Week"}),a.jsxs("select",{value:e.firstDayOfWeek,onChange:o=>t({...e,firstDayOfWeek:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"Monday"}),a.jsx("option",{value:0,children:"Sunday"})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Uh,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Measurement System"})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.useMetricSystem,onChange:o=>t({...e,useMetricSystem:o.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Use Metric System"})]})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current date and time: ",l]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{type:"submit",variant:"primary",icon:Qt,loading:r,children:"Save Changes"})})]})]})}function dB({onClose:e,onUserCreated:t}){const[r,n]=E.useState(""),[s,i]=E.useState(""),[l,o]=E.useState("player"),[u,c]=E.useState(null),[d,h]=E.useState(!1),[f,p]=E.useState(!1),[g,y]=E.useState(null),[v,x]=E.useState(!1),[b,w]=E.useState([]),[_,k]=E.useState(!1),[S,A]=E.useState(null),R=async()=>{k(!0),A(null);const{data:z,error:O}=await re.from("users").select("*");O?A(O.message):w(z),k(!1)};E.useEffect(()=>{R()},[]);const L=async z=>{z.preventDefault(),c(null),p(!0);try{const O=Math.random().toString(36).slice(-12),{data:Y,error:G}=await re.auth.signUp({email:r,password:O,options:{data:{username:s}}});if(G)throw G;if(!Y.user)throw new Error("Failed to create user");const{error:B}=await re.from("users").update({role:l}).eq("id",Y.user.id);if(B)throw B;const W=new URL(window.location.origin);W.searchParams.set("email",r),W.searchParams.set("password",O),y(W.toString()),h(!0),t(),R()}catch(O){c(O instanceof Error?O.message:"Failed to create user")}finally{p(!1)}},T=async()=>{if(g)try{await navigator.clipboard.writeText(g),x(!0),setTimeout(()=>x(!1),2e3)}catch{c("Failed to copy link to clipboard")}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),u&&a.jsxs("div",{className:"mb-6 flex items-start gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Dt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]}),d&&g?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"User Created Successfully!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Share the following link with the user to let them sign in:"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:g,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50"}),a.jsx(U,{variant:"secondary",icon:v?Ka:Eg,onClick:T,children:v?"Copied!":"Copy"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{variant:"primary",onClick:e,children:"Done"})})]}):a.jsxs("form",{onSubmit:L,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:r,onChange:z=>n(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{type:"text",required:!0,value:s,onChange:z=>i(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{value:l,onChange:z=>o(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"player",children:"Player"}),a.jsx("option",{value:"dm",children:"Dungeon Master"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(U,{variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(U,{type:"submit",variant:"primary",icon:Si,loading:f,children:"Create User"})]})]})]}),a.jsxs("div",{className:"p-6 border-t",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Created Users"}),_?a.jsx("p",{children:"Loading users..."}):S?a.jsxs("p",{className:"text-red-600",children:["Error loading users: ",S]}):b.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(z=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:z.username}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:z.email}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:z.role}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(z.created_at).toLocaleString()}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:z.account_status||"N/A"})]},z.id))})]})}):a.jsx("p",{children:"No users found."})]})]})})}function hB(){const[e,t]=E.useState([]),[r,n]=E.useState(!0),[s,i]=E.useState(null),[l,o]=E.useState(""),[u,c]=E.useState("all"),[d,h]=E.useState(!1),f=E.useCallback(async()=>{n(!0),i(null);try{const{data:x,error:b}=await re.from("users").select("id, email, username, role, created_at, last_login, first_name, last_name, is_active").order("created_at",{ascending:!1});if(b)throw b;t(x||[])}catch(x){console.error("Error fetching users:",x),i(`Failed to load users: ${x.message||"Unknown error"}`),t([])}finally{n(!1)}},[]);E.useEffect(()=>{f()},[f]);const p=()=>{h(!1),f()},g=e.filter(x=>{const b=l.toLowerCase(),w=x.username&&x.username.toLowerCase().includes(b)||x.email&&x.email.toLowerCase().includes(b)||x.first_name&&x.first_name.toLowerCase().includes(b)||x.last_name&&x.last_name.toLowerCase().includes(b),_=u==="all"||x.role&&x.role.toLowerCase()===u.toLowerCase();return w&&_}),y=x=>{const b=x==null?void 0:x.toLowerCase();return b==="admin"?"bg-purple-100 text-purple-800":b==="dm"||b==="dungeon master"?"bg-blue-100 text-blue-800":b==="player"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},v=x=>x.username?x.username:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.first_name?x.first_name:x.email.split("@")[0];return a.jsxs("div",{className:"space-y-6 p-4 md:p-6 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"User Management"}),a.jsx(U,{variant:"primary",icon:Xt,onClick:()=>h(!0),className:"w-full sm:w-auto",children:"Create User"})]}),s&&a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg shadow-sm",children:[a.jsx(Dt,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Error Loading Users"}),a.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(Ts,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, username...",value:l,onChange:x=>o(x.target.value),className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-colors",disabled:r})]}),a.jsxs("div",{className:"relative md:min-w-[200px]",children:[a.jsx(Ra,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:u,onChange:x=>c(x.target.value),className:"w-full pl-11 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white shadow-sm transition-colors",disabled:r,children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"player",children:"Players"}),a.jsx("option",{value:"dm",children:"Dungeon Masters"}),a.jsx("option",{value:"admin",children:"Administrators"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),r&&e.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):!r&&e.length===0&&!s?a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Users,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500",children:"There are currently no users to display. Try creating one!"})]}):a.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold",children:[x.first_name?x.first_name.charAt(0).toUpperCase():x.email.charAt(0).toUpperCase(),x.last_name?x.last_name.charAt(0).toUpperCase():x.username?x.username.charAt(0).toUpperCase():""]}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:v(x)}),a.jsx("div",{className:"text-xs text-gray-500",children:x.email})]})]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${y(x.role||"N/A")}`,children:x.role?x.role.charAt(0).toUpperCase()+x.role.slice(1):"N/A"})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:x.is_active===void 0||x.is_active===null?a.jsx("span",{className:"text-xs text-gray-500",children:"Unknown"}):x.is_active?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:[a.jsx(sc,{className:"w-3.5 h-3.5 mr-1.5"})," Active"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:[a.jsx(dl,{className:"w-3.5 h-3.5 mr-1.5"})," Inactive"]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:x.last_login?new Date(x.last_login).toLocaleString():"Never"}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"icon",size:"sm",title:"Edit User",className:"text-gray-500 hover:text-blue-600",children:a.jsx(Sg,{className:"w-4 h-4"})}),a.jsx(U,{variant:"icon",size:"sm",title:"Delete User",className:"text-gray-500 hover:text-red-600",children:a.jsx(cr,{className:"w-4 h-4"})})]})})]},x.id))})]})}),g.length===0&&!r&&e.length>0&&a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Ts,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Match Your Search"}),a.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term or role filter."})]}),d&&a.jsx(dB,{onClose:()=>h(!1),onUserCreated:p})]})}var w_={exports:{}},fB="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",mB=fB,pB=mB;function E_(){}function N_(){}N_.resetWarningCache=E_;var gB=function(){function e(n,s,i,l,o,u){if(u!==pB){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:N_,resetWarningCache:E_};return r.PropTypes=r,r};w_.exports=gB();var xB=w_.exports;const ed=dh(xB);function h0(){return h0=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h0.apply(this,arguments)}function yB(e,t){if(e==null)return{};var r=bB(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bB(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var ex=E.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,s=e.size,i=s===void 0?24:s,l=yB(e,["color","size"]);return Tn.createElement("svg",h0({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),Tn.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Tn.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});ex.propTypes={color:ed.string,size:ed.oneOfType([ed.string,ed.number])};ex.displayName="X";function vB({entry:e,onChange:t}){const[r,n]=E.useState(e),[s,i]=E.useState({gold:0,silver:0,copper:0}),[l,o]=E.useState([]);E.useEffect(()=>{if(n(e),e.cost){const d=e.cost.split(",").map(f=>f.trim()),h={gold:0,silver:0,copper:0};d.forEach(f=>{f.includes("gold")?h.gold=parseInt(f.replace("gold","").trim())||0:f.includes("silver")?h.silver=parseInt(f.replace("silver","").trim())||0:f.includes("copper")&&(h.copper=parseInt(f.replace("copper","").trim())||0)}),i(h)}e.features&&o(e.features)},[e]);const u=(d,h)=>{const f=parseInt(h)||0,p={...s,[d]:f};i(p),t("cost",`${p.gold} gold, ${p.silver} silver, ${p.copper} copper`)},c=d=>{const h=l.filter((f,p)=>p!==d);o(h),t("features",h)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:d=>t("name",d.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:r.category||"",onChange:d=>t("category",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"ARMOR & HELMETS",children:"Armor & Helmets"}),a.jsx("option",{value:"MELEE WEAPONS",children:"Melee Weapons"}),a.jsx("option",{value:"RANGED WEAPONS",children:"Ranged Weapons"}),a.jsx("option",{value:"CLOTHES",children:"Clothes"}),a.jsx("option",{value:"MUSICAL INSTRUMENTS",children:"Musical Instruments"}),a.jsx("option",{value:"TRADE GOODS",children:"Trade Goods"}),a.jsx("option",{value:"STUDIES & MAGIC",children:"Studies & Magic"}),a.jsx("option",{value:"LIGHT SOURCES",children:"Light Sources"}),a.jsx("option",{value:"TOOLS",children:"Tools"}),a.jsx("option",{value:"CONTAINERS",children:"Containers"}),a.jsx("option",{value:"MEDICINE",children:"Medicine"}),a.jsx("option",{value:"SERVICES",children:"Services"}),a.jsx("option",{value:"HUNTING & FISHING",children:"Hunting & Fishing"}),a.jsx("option",{value:"MEANS OF TRAVEL",children:"Means of Travel"}),a.jsx("option",{value:"ANIMALS",children:"Animals"})]})]}),r.category==="ARMOR & HELMETS"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor Rating"}),a.jsx("input",{type:"number",value:r.armor_rating||"",onChange:d=>t("armor_rating",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),r.category==="MELEE WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),r.category==="RANGED WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.gold,onChange:d=>u("gold",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Gold"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.silver,onChange:d=>u("silver",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Silver"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.copper,onChange:d=>u("copper",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Copper"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supply"}),a.jsxs("select",{value:r.supply||"",onChange:d=>t("supply",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Supply"}),a.jsx("option",{value:"Common",children:"Common"}),a.jsx("option",{value:"Uncommon",children:"Uncommon"}),a.jsx("option",{value:"Rare",children:"Rare"}),a.jsx("option",{value:"Unique",children:"Unique"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:r.weight||"",onChange:d=>t("weight",parseFloat(d.target.value)),className:"w-full px-3 py-2 border rounded-md",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effect/Description"}),a.jsx("textarea",{value:r.effect||"",onChange:d=>t("effect",d.target.value.toUpperCase()),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((d,h)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md px-2 py-1 text-sm",children:[a.jsx("span",{children:d}),a.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-2 text-red-500 hover:text-red-700",children:a.jsx(ex,{className:"w-4 h-4"})})]},h)),a.jsx("input",{type:"text",onKeyDown:d=>{if(d.key==="Enter"&&d.currentTarget.value.trim()){d.preventDefault();const h=d.currentTarget.value.trim(),f=[...l,h];o(f),t("features",f),d.currentTarget.value=""}},className:"px-3 py-2 border rounded-md",placeholder:"Add feature..."})]})]})]})}const wB=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:r=>t("heroic_ability",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abilities"}),(e.abilities||[]).map((r,n)=>a.jsxs("div",{className:"flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",placeholder:"Ability Description",value:r.description||"",onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],description:s.target.value},t("abilities",i)},className:"border rounded-md px-2 py-1 flex-1"}),a.jsx("input",{type:"number",placeholder:"Willpower Points",value:r.willpower_points||0,onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],willpower_points:parseInt(s.target.value)},t("abilities",i)},className:"border rounded-md px-2 py-1 w-20",min:"0"}),a.jsx("button",{onClick:()=>{const s=[...e.abilities||[]];s.splice(n,1),t("abilities",s)},className:"text-red-600",children:"Remove"})]},n)),a.jsx("button",{onClick:()=>{const r=[...e.abilities||[],{description:"",willpower_points:0}];t("abilities",r)},className:"mt-2 text-blue-600",children:"Add Ability"})]})]}),EB=({entry:e,onChange:t})=>{const[r,n]=E.useState("skills"),[s,i]=E.useState([]),[l,o]=E.useState(!0),[u,c]=E.useState(null);E.useEffect(()=>{(async()=>{o(!0),c(null);const{data:v,error:x}=await re.from("game_skills").select("id, name, is_magic").order("name",{ascending:!0});x?(console.error("Error fetching skills:",x),c("Failed to load skills from the database.")):i(v||[]),o(!1)})()},[]);const d=E.useMemo(()=>s.filter(y=>y.is_magic===!0),[s]),h=e.starting_equipment||["","",""],f=e.equipment_description||["","",""],p=(y,v,x)=>{if(v==="equipment"){const b=[...h];b[y]=x,t("starting_equipment",b)}else{const b=[...f];b[y]=x,t("equipment_description",b)}},g=y=>{t("is_magic",y),y||t("associated_skill",null)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:y=>t("name",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:y=>t("description",y.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"space-y-4 p-4 border rounded-md bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"is_magic",type:"checkbox",checked:e.is_magic||!1,onChange:y=>g(y.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_magic",className:"text-sm font-medium text-gray-900",children:"Is this a magic profession?"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"associated_skill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Associated Magic Skill"}),a.jsxs("select",{id:"associated_skill",value:e.associated_skill||"",onChange:y=>t("associated_skill",y.target.value||null),className:"w-full px-3 py-2 border rounded-md disabled:bg-gray-200 disabled:cursor-not-allowed",disabled:!e.is_magic||l||!!u,children:[l&&a.jsx("option",{children:"Loading magic skills..."}),u&&a.jsx("option",{children:"Error loading skills"}),!l&&!u&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"",children:"None"}),d.length>0?d.map(y=>a.jsx("option",{value:y.name,children:y.name},y.id)):a.jsx("option",{disabled:!0,children:"No skills marked as magic were found"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute"}),a.jsx("input",{type:"text",value:e.key_attribute||"",onChange:y=>t("key_attribute",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:y=>t("heroic_ability",y.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Magic School"}),a.jsxs("select",{value:e.magic_school_id||"",onChange:y=>t("magic_school_id",y.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"Animist",children:"Animist"}),a.jsx("option",{value:"Elementalist",children:"Elementalist"}),a.jsx("option",{value:"Mentalist",children:"Mentalist"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex border-b",children:[a.jsx("button",{type:"button",onClick:()=>n("skills"),className:`px-4 py-2 -mb-px font-medium ${r==="skills"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Skills"}),a.jsx("button",{type:"button",onClick:()=>n("startingEquipment"),className:`px-4 py-2 -mb-px font-medium ${r==="startingEquipment"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Starting Equipment"})]}),r==="skills"&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),l&&a.jsx("p",{className:"text-sm text-gray-500",children:"Loading skills..."}),u&&a.jsx("p",{className:"text-sm text-red-600",children:u}),!l&&!u&&a.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map(y=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:e.skills?e.skills.includes(y.name):!1,onChange:v=>{let x=e.skills?[...e.skills]:[];v.target.checked?x.push(y.name):x=x.filter(b=>b!==y.name),t("skills",x)}}),a.jsx("span",{className:"text-sm",children:y.name})]},y.id))})]}),r==="startingEquipment"&&a.jsx("div",{className:"mt-4 space-y-4",children:[0,1,2].map(y=>a.jsxs("div",{className:"border p-2 rounded-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment Option ",y+1]}),a.jsx("input",{type:"text",placeholder:"Enter equipment (e.g., Horn or Flute, knife, torch)",value:h[y]||"",onChange:v=>p(y,"equipment",v.target.value),className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (e.g., D6 food rations, D8 silver)",value:f[y]||"",onChange:v=>p(y,"description",v.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})]},y))})]})]})},NB=({entry:e,onChange:t})=>{const{skills:r,loading:n,error:s}=WE(),[i,l]=E.useState(!1),[o,u]=E.useState(!1),[c,d]=E.useState({}),h=E.useCallback(()=>{if(n||!r||r.length===0)return;u(!0);const g=e.requirement;let y={};if(Ag(g))y=g,console.log("AbilityForm: Initial requirement is already name-based:",g);else if(kb(g)){console.log("AbilityForm: Initial requirement is UUID-based, converting:",g);const v=new Map(r.map(x=>[x.id,x.name]));for(const[x,b]of Object.entries(g)){const w=v.get(x);w?y[w]=b:console.warn(`AbilityForm: Could not find skill name for UUID ${x} during initialization.`)}console.log("AbilityForm: Converted to name-based requirements:",y)}else typeof g=="string"||g===null||g===void 0?(console.log("AbilityForm: Initial requirement is simple string, null, or undefined:",g),y={}):(console.warn("AbilityForm: Unrecognized requirement format during initialization:",g),y={});d(y),u(!1)},[e.requirement,r,n]);E.useEffect(()=>{h()},[h]),E.useEffect(()=>{t("requirement",c)},[c,t]);const f=(g,y)=>{typeof g=="string"&&d(v=>{const x={...v};return y?x.hasOwnProperty(g)||(x[g]=null):delete x[g],x})},p=(g,y)=>{if(typeof g!="string")return;const v=y===""?null:parseInt(y,10);c.hasOwnProperty(g)&&d(x=>({...x,[g]:isNaN(v)?null:v}))};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{id:"ability-name",type:"text",value:e.name||"",onChange:g=>t("name",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{id:"ability-description",value:e.description||"",onChange:g=>t("description",g.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-willpower_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Willpower Cost"}),a.jsx("input",{id:"ability-willpower_cost",type:"number",value:e.willpower_cost===null||e.willpower_cost===void 0?"":e.willpower_cost,onChange:g=>t("willpower_cost",g.target.value===""?null:parseInt(g.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-profession",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profession (Optional)"}),a.jsx("input",{id:"ability-profession",type:"text",value:e.profession||"",onChange:g=>t("profession",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain profession."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-kin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kin (Optional)"}),a.jsx("input",{id:"ability-kin",type:"text",value:e.kin||"",onChange:g=>t("kin",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain kin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Requirements (Optional)"}),a.jsxs("details",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden",open:i,onToggle:g=>l(g.target.open),children:[a.jsx("summary",{className:"px-3 py-2 cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-t-md",children:Object.keys(c).length>0?`${Object.keys(c).length} skill(s) selected`:"Select required skills..."}),a.jsx("div",{className:"p-4 border-t border-gray-200 max-h-60 overflow-y-auto",children:n||o?a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(He,{size:"md"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading skills..."})]}):s?a.jsx(Ne,{message:`Error loading skills: ${s}`}):r.length===0?a.jsx("p",{className:"text-gray-500",children:"No skills available."}):a.jsx("ul",{className:"space-y-2",children:r.map(g=>{const y=g.name,v=c.hasOwnProperty(y),x=c[y];return a.jsxs("li",{className:"flex items-center space-x-3",children:[" ",a.jsx("input",{id:`skill-req-${g.id}`,type:"checkbox",checked:v,onChange:b=>f(y,b.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`skill-req-${g.id}`,className:"flex-1 text-sm text-gray-700",children:[g.name," ",g.attribute?`(${g.attribute})`:""]}),v&&a.jsx("input",{type:"number",min:"1",placeholder:"Level (Opt.)",value:x??"",onChange:b=>p(y,b.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500"})]},g.id)})})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select skills required for this ability and optionally specify a minimum level. Requirements are now stored by skill name."}),typeof e.requirement=="string"&&e.requirement&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:a.jsxs("p",{className:"text-xs text-yellow-700",children:[a.jsx("strong",{children:"Note:"}),' This ability has a non-skill requirement text: "',e.requirement,'". Saving will overwrite this if skills are selected above.']})}),kb(e.requirement)&&o&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded",children:a.jsx("p",{className:"text-xs text-orange-700",children:"Attempting to convert legacy UUID-based requirements..."})})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]})};function k_(e){return typeof e!="object"||e===null||!e.type?!1:e.type==="logical"?(e.operator==="AND"||e.operator==="OR")&&Array.isArray(e.conditions)&&e.conditions.every(k_):["spell","school","skill","attribute"].includes(e.type)?typeof e.name=="string":e.type==="anySchool"}function kB({entry:e,onChange:t,magicSchools:r=[]}){const[n,s]=E.useState(""),[i,l]=E.useState(null);E.useEffect(()=>{if(e.prerequisite)try{typeof e.prerequisite=="object"&&e.prerequisite!==null?s(JSON.stringify(e.prerequisite,null,2)):typeof e.prerequisite=="string"&&(JSON.parse(e.prerequisite),s(JSON.stringify(JSON.parse(e.prerequisite),null,2)))}catch{s(e.prerequisite)}else s("")},[e.prerequisite]);const o=c=>{const d=c.target.value;if(s(d),d.trim()===""){t("prerequisite",null),l(null);return}try{const h=JSON.parse(d);k_(h)?(t("prerequisite",JSON.stringify(h)),l(null)):l("Invalid prerequisite JSON structure. Please check the format.")}catch{l("Invalid JSON. Please ensure correct JSON syntax.")}},u=c=>{const{name:d,value:h,type:f}=c.target;let p=h;f==="number"&&c.target instanceof HTMLInputElement&&(p=h===""?null:parseInt(h,10),isNaN(p)&&(p=null)),d==="school_id"&&h===""&&(p=null),t(d,p)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("input",{type:"text",name:"name",id:"name",value:e.name||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),a.jsx("textarea",{name:"description",id:"description",rows:3,value:e.description||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"school_id",className:"block text-sm font-medium text-gray-700",children:"Magic School"}),a.jsxs("select",{name:"school_id",id:"school_id",value:e.school_id||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white",children:[a.jsx("option",{value:"",children:"General"}),r.map(c=>a.jsx("option",{value:c.id,children:c.name},c.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rank",className:"block text-sm font-medium text-gray-700",children:"Rank (0 for Trick)"}),a.jsx("input",{type:"number",name:"rank",id:"rank",min:"0",max:"5",value:e.rank??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"casting_time",className:"block text-sm font-medium text-gray-700",children:"Casting Time"}),a.jsx("input",{type:"text",name:"casting_time",id:"casting_time",value:e.casting_time||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"range",className:"block text-sm font-medium text-gray-700",children:"Range"}),a.jsx("input",{type:"text",name:"range",id:"range",value:e.range||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),a.jsx("input",{type:"text",name:"duration",id:"duration",value:e.duration||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"willpower_cost",className:"block text-sm font-medium text-gray-700",children:"Willpower Cost"}),a.jsx("input",{type:"number",name:"willpower_cost",id:"willpower_cost",min:"0",value:e.willpower_cost??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"prerequisite",className:"block text-sm font-medium text-gray-700",children:"Learning Prerequisite (JSON or leave empty)"}),a.jsx("textarea",{name:"prerequisite",id:"prerequisite",rows:6,value:n,onChange:o,placeholder:'JSON for learning, e.g., {"type": "spell", "name": "Light"}. Leave empty for no prerequisite.',className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 focus:outline-none sm:text-sm ${i?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),i&&a.jsx("p",{className:"mt-2 text-sm text-red-600",children:i}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Use JSON format for learning prerequisites. Examples: ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "anySchool"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "spell", "name": "Example Spell"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "logical", "operator": "AND", "conditions": [...]}'})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"requirement",className:"block text-sm font-medium text-gray-700",children:"Casting Requirement (Text or leave empty)"}),a.jsx("textarea",{name:"requirement",id:"requirement",rows:3,value:e.requirement||"",onChange:u,placeholder:"e.g., Requires a free hand, or Verbal component only. Leave empty if none.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe any requirements for casting the spell (e.g., components, conditions)."})]})]})}const _B=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Name"}),a.jsx("input",{id:"skill-name",type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx("textarea",{id:"skill-description",value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[a.jsx("input",{id:"is_magic_skill",type:"checkbox",checked:e.is_magic||!1,onChange:r=>t("is_magic",r.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"is_magic_skill",className:"text-sm font-medium text-gray-900",children:"Is this a magic skill?"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Check if this skill is related to magic or spellcasting."})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-attribute",className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute (Optional)"}),a.jsx("input",{id:"skill-attribute",type:"text",value:e.attribute||"",onChange:r=>t("attribute",r.target.value||null),placeholder:"e.g., STR, AGL, WIL...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The primary attribute associated with this skill."})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]}),SB=["Small","Normal","Large","Huge","Swarm"],W1=()=>({FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0}),TB=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:"",effects:[]}),CB=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:""});function jB({entry:e,onChange:t}){const[r,n]=E.useState({...e,stats:e.stats||W1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))});E.useEffect(()=>{n({...e,stats:e.stats||W1(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))})},[e]);const s=E.useCallback((f,p)=>{const g={...r,[f]:p};n(g),t(f,p)},[r,t]),i=E.useCallback((f,p)=>{const g={...r.stats,[f]:p};s("stats",g)},[r.stats,s]),l=E.useCallback(()=>{const f=[...r.attacks,TB()];s("attacks",f)},[r.attacks,s]),o=E.useCallback((f,p,g)=>{const y=[...r.attacks];y[f]={...y[f],[p]:g},s("attacks",y)},[r.attacks,s]),u=E.useCallback(f=>{const p=r.attacks.filter((g,y)=>y!==f);s("attacks",p)},[r.attacks,s]),c=E.useCallback(f=>{const p=[...r.attacks];p[f].effects=[...p[f].effects||[],CB()],s("attacks",p)},[r.attacks,s]),d=E.useCallback((f,p,g,y)=>{const v=[...r.attacks];v[f].effects&&(v[f].effects[p]={...v[f].effects[p],[g]:y},s("attacks",v))},[r.attacks,s]),h=E.useCallback((f,p)=>{const g=[...r.attacks];g[f].effects&&(g[f].effects=g[f].effects.filter((y,v)=>v!==p),s("attacks",g))},[r.attacks,s]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:f=>s("name",f.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:r.category||"",onChange:f=>s("category",f.target.value),placeholder:"e.g., Beast, Undead, Humanoid",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:r.description||"",onChange:f=>s("description",f.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Statistics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferocity"}),a.jsx("input",{type:"number",value:r.stats.FEROCITY,onChange:f=>i("FEROCITY",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),a.jsx("select",{value:r.stats.SIZE,onChange:f=>i("SIZE",f.target.value),className:"w-full px-3 py-2 border rounded-md",children:SB.map(f=>a.jsx("option",{value:f,children:f},f))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movement"}),a.jsx("input",{type:"number",value:r.stats.MOVEMENT,onChange:f=>i("MOVEMENT",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor"}),a.jsx("input",{type:"number",value:r.stats.ARMOR,onChange:f=>i("ARMOR",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HP"}),a.jsx("input",{type:"number",value:r.stats.HP,onChange:f=>i("HP",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effects Summary"}),a.jsx("textarea",{value:r.effectsSummary||"",onChange:f=>s("effectsSummary",f.target.value),rows:3,placeholder:"Describe any special effects or abilities here...",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attacks (D6 Rollable Table)"}),a.jsx(U,{variant:"secondary",size:"sm",icon:Gd,onClick:l,children:"Add Attack"})]}),r.attacks.length===0&&a.jsx("p",{className:"text-gray-500",children:'No attacks defined. Click "Add Attack" to create one.'}),r.attacks.map((f,p)=>a.jsxs("div",{className:"p-3 border rounded-md mb-4 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-2",children:[a.jsx("input",{type:"text",placeholder:"Roll Values (e.g., 1, 2-3)",value:f.roll_values,onChange:g=>o(p,"roll_values",g.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"text",placeholder:"Attack Name",value:f.name,onChange:g=>o(p,"name",g.target.value),className:"md:col-span-2 px-3 py-2 border rounded-md"})]}),a.jsx("textarea",{placeholder:"Attack Description",value:f.description,onChange:g=>o(p,"description",g.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsxs("div",{className:"ml-4 mt-2 p-3 border-l-2 border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Effects (Optional D6 Table)"}),a.jsx(U,{variant:"outline",size:"xs",icon:Gd,onClick:()=>c(p),children:"Add Effect"})]}),f.effects.length===0&&a.jsx("p",{className:"text-gray-500",children:'No effects for this attack. Click "Add Effect" to create one.'}),f.effects.map((g,y)=>a.jsxs("div",{className:"p-2 border rounded-md mb-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-1",children:[a.jsx("input",{type:"text",placeholder:"Roll (e.g., 1-2)",value:g.roll_values,onChange:v=>d(p,y,"roll_values",v.target.value),className:"px-2 py-1 border rounded-md text-sm"}),a.jsx("input",{type:"text",placeholder:"Effect Name",value:g.name,onChange:v=>d(p,y,"name",v.target.value),className:"md:col-span-2 px-2 py-1 border rounded-md text-sm"})]}),a.jsx("textarea",{placeholder:"Effect Description",value:g.description,onChange:v=>d(p,y,"description",v.target.value),rows:1,className:"w-full px-2 py-1 border rounded-md text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(U,{variant:"danger",size:"xs",icon:cr,onClick:()=>h(p,y),children:"Remove Effect"})})]},g.id))]}),a.jsx("div",{className:"text-right",children:a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>u(p),children:"Remove Attack"})})]},f.id))]})]})}const Em=({title:e,items:t,onAdd:r,onRemove:n,onUpdate:s})=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),t.map((i,l)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:i,onChange:o=>s(l,o.target.value),className:"w-full px-3 py-2 border rounded-md flex-grow",placeholder:`Enter ${e.replace(/s$/,"").toLowerCase()}...`}),a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>n(l),"aria-label":`Remove ${e.slice(0,-1)}`})]},l)),a.jsxs(U,{variant:"secondary",size:"sm",icon:Xt,onClick:r,children:["Add ",e.replace(/s$/,"")]})]}),AB=({entry:e,onChange:t})=>{const r=(n,s,i,l)=>{const o=[...e[n]||[]];switch(s){case"add":o.push("");break;case"remove":i!==void 0&&o.splice(i,1);break;case"update":i!==void 0&&l!==void 0&&(o[i]=l);break}t(n,o)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio-name",className:"block text-sm font-medium text-gray-700",children:"Set Name"}),a.jsx("input",{id:"bio-name",type:"text",value:e.name||"",onChange:n=>t("name",n.target.value),className:"mt-1 w-full px-3 py-2 border rounded-md",placeholder:"e.g., General, Human Commoner, Elven Ranger"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"A unique name for this collection of bio options."})]}),a.jsx(Em,{title:"Appearance Options",items:e.appearance||[],onAdd:()=>r("appearance","add"),onRemove:n=>r("appearance","remove",n),onUpdate:(n,s)=>r("appearance","update",n,s)}),a.jsx(Em,{title:"Mementos",items:e.mementos||[],onAdd:()=>r("mementos","add"),onRemove:n=>r("mementos","remove",n),onUpdate:(n,s)=>r("mementos","update",n,s)}),a.jsx(Em,{title:"Flaws / Weak Spots",items:e.flaws||[],onAdd:()=>r("flaws","add"),onRemove:n=>r("flaws","remove",n),onUpdate:(n,s)=>r("flaws","update",n,s)})]})};function IB(e){const[t,r]=E.useState([]),[n,s]=E.useState(!0),[i,l]=E.useState(null),[o,u]=E.useState(e),c=E.useCallback(g=>{switch(g){case"spells":return"game_spells";case"items":return"game_items";case"abilities":return"heroic_abilities";case"kin":return"kin";case"profession":return"professions";case"skills":return"game_skills";case"monsters":return"monsters";case"bio":return"bio_data";default:throw console.error(`Invalid data category passed to getTableName: ${g}`),new Error(`Invalid data category: ${g}`)}},[]),d=E.useCallback(async g=>{s(!0),l(null);let y;try{y=c(g),console.log(`[useGameData] Attempting to load category: ${g}, using table: ${y}`);let v=re.from(y);g==="spells"?v=v.select(`
                *,
                magic_schools ( name )
              `):v=v.select("*"),v=v.order("name"),console.log(`[useGameData] Executing query for table: ${y}`);const{data:x,error:b}=await v;if(b)throw console.error(`[useGameData] Supabase fetch error for ${y}:`,b),b;const w=(x||[]).map(_=>{var S;let k={..._};if(g==="spells"&&(k.magic_schools=(S=_.magic_schools)==null?void 0:S.name),g==="abilities"&&typeof _.requirement=="string")try{k.requirement=JSON.parse(_.requirement)}catch{}return k});console.log(`[useGameData] Loaded ${w.length} entries for ${g} from ${y}`),r(w)}catch(v){const x=y||g;console.error(`[useGameData] Error in loadEntries for ${x}:`,v);const b=(v==null?void 0:v.message)||`Failed to load ${x}`,w=v!=null&&v.details?`: ${v.details}`:"";l(`${b}${w}`),r([])}finally{s(!1)}},[c]),h=E.useCallback(async(g,y,v,x)=>{let b="";try{x(null),s(!0),b=c(g);const{id:w,..._}=y;let k={..._};if(!k.name||String(k.name).trim()==="")throw new Error(`Cannot save ${g} without a name.`);if(g==="abilities"&&(k.willpower_cost=k.willpower_cost===""||k.willpower_cost===void 0?null:Number(k.willpower_cost),typeof k.requirement=="object"&&k.requirement!==null?Object.keys(k.requirement).length>0?k.requirement=JSON.stringify(k.requirement):k.requirement=null:(k.requirement===""||k.requirement===void 0)&&(k.requirement=null),k.kin=k.kin||null,k.profession=k.profession||null),g==="spells"&&(k.rank=Number(k.rank??0),k.willpower_cost=Number(k.willpower_cost??0),k.school_id=k.school_id||null,k.requirement=k.requirement||null),g==="skills"&&(k.attribute=k.attribute||null),g==="monsters"){const R=y;if(k.stats=R.stats||{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0},k.attacks=R.attacks||[],Array.isArray(k.attacks)&&(k.attacks=k.attacks.map(L=>{const{id:T,effects:z,...O}=L;return Array.isArray(z)&&(O.effects=z.map(Y=>{const{id:G,...B}=Y;return B})),O})),!w){const{data:L,error:T}=await re.auth.getSession();if(T||!L.session)throw new Error("User not authenticated. Cannot save monster.");k.created_by=L.session.user.id}}console.log(`[useGameData] Saving entry to ${b} (ID: ${w||"new"}):`,k);let S=null,A=null;if(w){const{data:R,error:L}=await re.from(b).update(k).eq("id",w).select().single();S=L,A=R}else{const{data:R,error:L}=await re.from(b).insert([k]).select().single();S=L,A=R}if(S)throw console.error(`[useGameData] Supabase Save Error (${b}):`,S),S;A?(console.log(`[useGameData] Save operation successful for ${g} (ID: ${A.id})`),v(A)):(console.warn(`[useGameData] Save operation for ${g} (ID: ${w||"new"}) did not return data. Using input data for callback.`),v({...y,id:w||(A==null?void 0:A.id)})),await d(g)}catch(w){const _=b||g,k=(w==null?void 0:w.message)||(typeof w=="string"?w:"An unexpected error occurred during save."),S=w!=null&&w.details?` (Details: ${w.details})`:"",A=w!=null&&w.code?` (Code: ${w.code})`:"",R=`Error saving ${_}: ${k}${S}${A}`;console.error(`[useGameData] Error in handleSave for ${_}:`,w),x(R)}finally{s(!1)}},[c,d]),f=E.useCallback(async(g,y)=>{if(!window.confirm(`Are you sure you want to delete this ${g} entry (ID: ${y})? This action cannot be undone.`))return;let v="";try{l(null),s(!0),v=c(g),console.log(`[useGameData] Deleting entry from ${v}, ID: ${y}`);const{error:x}=await re.from(v).delete().eq("id",y);if(x)throw console.error(`[useGameData] Error deleting from ${v}:`,x),x;console.log(`[useGameData] Delete successful for ID: ${y} in ${g}`),await d(g)}catch(x){const b=v||g,w=(x==null?void 0:x.message)||"An unexpected error occurred during deletion.",_=x!=null&&x.details?` (Details: ${x.details})`:"",k=x!=null&&x.code?` (Code: ${x.code})`:"",S=`Error deleting ${b}: ${w}${_}${k}`;console.error(`[useGameData] Error in handleDelete for ${b}:`,x),l(S)}finally{s(!1)}},[c,d]),p=E.useCallback(g=>{console.log(`[useGameData] Switching category from ${o} to ${g}`),u(g),d(g)},[o,d]);return E.useEffect(()=>{console.log(`[useGameData] Initial load effect for category: ${e}`);try{c(e),d(e)}catch(g){console.error(`[useGameData] Invalid initial category: ${e}`,g),l(`Invalid initial category: ${e}`),s(!1)}},[e,c,d]),{entries:t,loading:n,error:i,activeCategory:o,switchCategory:p,handleSave:h,handleDelete:f}}const RB=[{id:"items",label:"Items",icon:xi},{id:"spells",label:"Spells",icon:Zd},{id:"abilities",label:"Abilities",icon:Cs},{id:"kin",label:"Kin",icon:An},{id:"profession",label:"Professions",icon:o4},{id:"skills",label:"Skills",icon:P4},{id:"monsters",label:"Monsters",icon:Qd},{id:"bio",label:"Bio Options",icon:i4}],G1=e=>{try{if(Ag(e)){const t=Object.entries(e);return t.length===0?"None":t.map(([r,n])=>`${r}${n!==null?` (Lvl ${n})`:""}`).join(", ")||"None"}if(typeof e=="string"&&e)return e;if(typeof e=="object"&&e!==null){const t=Object.keys(e);if(t.length>0)return/^[0-9a-fA-F]{8}-/.test(t[0])?`${t.length} skill(s) (Legacy UUIDs)`:t.length===1&&typeof e[t[0]]=="object"?`Requirement: ${t[0]} (Invalid Format)`:`${t.length} requirement(s) (Unknown format)`}return"None"}catch(t){return console.error("Error formatting requirement:",e,t),"Error: Invalid Format"}};function __(){const[e,t]=E.useState(null),[r,n]=E.useState(""),[s,i]=E.useState(null),[l,o]=E.useState(""),[u,c]=E.useState([]),[d,h]=E.useState([]),[f,p]=E.useState([]),{entries:g,loading:y,error:v,handleSave:x,handleDelete:b,switchCategory:w,activeCategory:_}=IB("items"),k=E.useCallback(async()=>{const{data:P,error:X}=await re.from("game_items").select("category");X?console.error("Error fetching item categories:",X):P&&c([...new Set(P.map(N=>N.category).filter(Boolean))])},[]),S=E.useCallback(async()=>{const{data:P,error:X}=await re.from("magic_schools").select("id, name").order("name");X?console.error("Error fetching magic schools:",X):P&&h(P)},[]),A=E.useCallback(async()=>{const{data:P,error:X}=await re.from("monsters").select("category");X?console.error("Error fetching monster categories:",X):P&&p([...new Set(P.map(N=>N.category).filter(Boolean))])},[]);E.useEffect(()=>{o(""),_==="items"?k():_==="spells"?S():_==="monsters"&&A()},[_,k,S,A]);const R=E.useCallback(P=>{t(null),i(null),_==="items"&&k(),_==="monsters"&&A()},[_,k,A]),L=E.useCallback(async()=>{e&&await x(_,e,R,i)},[e,_,x,R]),T=E.useCallback(async P=>{P&&(await b(_,P),_==="items"&&k(),_==="monsters"&&A())},[_,b,k,A]),z=E.useCallback((P,X)=>{t(N=>N?{...N,[P]:X}:null)},[]),O=E.useCallback(()=>{i(null);let P={name:""};switch(_){case"spells":P={...P,description:"",rank:1,school_id:null,casting_time:"",range:"",duration:"",willpower_cost:0};break;case"items":P={...P,description:"",category:"",cost:0,weight:0};break;case"abilities":P={...P,description:"",willpower_cost:null,requirement:{},profession:null,kin:null};break;case"kin":P={...P,description:"",key_attribute:"",typical_profession:"",kin_abilities:[]};break;case"profession":P={...P,description:"",key_attribute:"",skills:[]};break;case"skills":P={...P,description:"",attribute:null};break;case"monsters":P={name:"",description:"",category:"",stats:{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:10},attacks:[]};break;case"bio":P={name:"",appearance:[],mementos:[],flaws:[]};break}t(P)},[_]),Y=E.useCallback(()=>{if(!e)return null;switch(_){case"spells":return a.jsx(kB,{entry:e,onChange:z,magicSchools:d});case"items":return a.jsx(vB,{entry:e,onChange:z});case"abilities":return a.jsx(NB,{entry:e,onChange:z});case"kin":return a.jsx(wB,{entry:e,onChange:z});case"profession":return a.jsx(EB,{entry:e,onChange:z});case"skills":return a.jsx(_B,{entry:e,onChange:z});case"monsters":return a.jsx(jB,{entry:e,onChange:z});case"bio":return a.jsx(AB,{entry:e,onChange:z});default:return a.jsx("p",{children:"No form available for this category."})}},[e,_,z,d]),G=E.useMemo(()=>g.filter(P=>{var N,V,H,j;if(!((N=P.name)==null?void 0:N.toLowerCase().includes(r.toLowerCase())))return!1;if(l){if(_==="items")return((V=P.category)==null?void 0:V.toLowerCase())===l.toLowerCase();if(_==="spells"){const he=P;if(l==="General")return!he.school_id;const J=d.find(q=>q.id===he.school_id);return((H=J==null?void 0:J.name)==null?void 0:H.toLowerCase())===l.toLowerCase()}if(_==="monsters")return((j=P.category)==null?void 0:j.toLowerCase())===l.toLowerCase()}return!0}),[g,r,l,_,d]),B=E.useCallback(()=>{t(null),i(null)},[]),W=E.useMemo(()=>_==="items"?u.sort():_==="spells"?["General",...d.map(P=>P.name)].sort():_==="monsters"?f.sort():[],[_,u,d,f]),K=E.useMemo(()=>{const P=[{header:"Name",accessor:N=>N.name}],X="text-sm text-gray-600 max-w-xs truncate";switch(_){case"spells":return[...P,{header:"School",accessor:N=>{const V=N;if(!V.school_id)return"General";const H=d.find(j=>j.id===V.school_id);return(H==null?void 0:H.name)||"Unknown School"}},{header:"Rank",accessor:N=>N.rank===0?"Trick":`Rank ${N.rank}`},{header:"WP Cost",accessor:N=>`${N.willpower_cost} WP`}];case"items":return[...P,{header:"Category",accessor:N=>N.category},{header:"Cost",accessor:N=>N.cost},{header:"Weight",accessor:N=>N.weight}];case"abilities":return[...P,{header:"WP Cost",accessor:N=>N.willpower_cost??"N/A"},{header:"Requirement",accessor:N=>G1(N.requirement),className:X,titleAccessor:N=>G1(N.requirement)}];case"kin":return[...P,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Typical Profession",accessor:N=>N.typical_profession}];case"profession":return[...P,{header:"Key Attribute",accessor:N=>N.key_attribute},{header:"Skills",accessor:N=>Array.isArray(N.skills)?N.skills.join(", "):"",className:X}];case"skills":return[...P,{header:"Attribute",accessor:N=>N.attribute||"N/A"},{header:"Description",accessor:N=>N.description,className:X,titleAccessor:N=>N.description||""}];case"monsters":return[...P,{header:"Category",accessor:N=>N.category},{header:"HP",accessor:N=>{var V;return(V=N.stats)==null?void 0:V.HP}},{header:"Armor",accessor:N=>{var V;return(V=N.stats)==null?void 0:V.ARMOR}},{header:"Size",accessor:N=>{var V;return(V=N.stats)==null?void 0:V.SIZE}}];case"bio":return[...P,{header:"Appearance",accessor:N=>`${(N.appearance||[]).length} options`},{header:"Mementos",accessor:N=>`${(N.mementos||[]).length} options`},{header:"Flaws",accessor:N=>`${(N.flaws||[]).length} options`}];default:return P}},[_,d]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Game Data Management"}),a.jsx(U,{variant:"primary",icon:Xt,onClick:O,disabled:y,children:"Add Entry"})]}),v&&a.jsx(Ne,{message:`Error loading data: ${v}`}),a.jsx("div",{className:"flex gap-4 border-b overflow-x-auto pb-2",children:RB.map(({id:P,label:X,icon:N})=>a.jsxs("button",{onClick:()=>w(P),className:`px-4 py-2 font-medium flex items-center gap-2 whitespace-nowrap ${_===P?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:y,children:[a.jsx(N,{className:"w-5 h-5"}),X]},P))}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:`Search ${_}...`,value:r,onChange:P=>n(P.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg",disabled:y})]}),W.length>0&&a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-48",children:[a.jsx(Ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:l,onChange:P=>o(P.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",disabled:y,children:[a.jsxs("option",{value:"",children:["All ",_==="spells"?"Schools":"Categories"]}),W.map(P=>a.jsx("option",{value:P,children:P},P))]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),y&&!g.length?a.jsxs("p",{className:"text-center py-4",children:["Loading ",_,"..."]}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[K.map(P=>a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:P.header},P.header)),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:G.map(P=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[K.map(X=>a.jsx("td",{className:`px-4 py-2 align-top ${X.className||""}`,title:X.titleAccessor?X.titleAccessor(P):void 0,children:X.accessor(P)},X.header)),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:ic,onClick:()=>{i(null),t(P)},disabled:!P.id,children:"Edit"}),a.jsx(U,{variant:"danger",size:"sm",icon:cr,onClick:()=>P.id&&T(P.id),disabled:!P.id||y,children:"Delete"})]})})]},P.id||P.name))})]}),G.length===0&&!y&&!v&&a.jsx("p",{className:"text-center text-gray-500 py-4",children:r||l?`No ${_} found matching filters.`:`No entries for '${_}'.`})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white py-2 z-10 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.id?`Edit ${_}`:`New ${_}`}),a.jsx("button",{onClick:B,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),s&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:s})}),a.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:Y()}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6 sticky bottom-0 bg-white py-3 z-10 border-t",children:[a.jsx(U,{variant:"secondary",onClick:B,disabled:y,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:Qt,onClick:L,disabled:y,children:y?"Saving...":e.id?"Update Entry":"Save Entry"})]})]})})]})}function LB(){const{user:e}=qt(),[t,r]=E.useState(!1),[n,s]=E.useState(null),[i,l]=E.useState(""),[o,u]=E.useState(""),[c,d]=E.useState(""),[h,f]=E.useState(null),[p,g]=E.useState(!1),y=async v=>{v.preventDefault();try{if(!i.trim()||!o.trim()||!c.trim()){f("All fields are required");return}if(!e){f("You must be logged in to create or edit entries");return}if(n){const{error:x}=await re.from("compendium").update({title:i,content:o,category:c}).eq("id",n);if(x)throw x}else{const{error:x}=await re.from("compendium").insert([{title:i,content:o,category:c,created_by:e.id}]);if(x)throw x}l(""),u(""),d(""),r(!1),s(null)}catch(x){f(x instanceof Error?x.message:"Failed to save entry")}};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:i,onChange:v=>l(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:c,onChange:v=>d(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>g(!1),className:`p-2 rounded-lg ${p?"text-gray-600 hover:bg-gray-100":"bg-blue-100 text-blue-700"}`,children:a.jsx(NE,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>g(!0),className:`p-2 rounded-lg ${p?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(kE,{className:"w-5 h-5"})})]})]}),p?a.jsx("div",{className:"min-h-[300px] p-4 border border-gray-300 rounded-md bg-white overflow-auto",children:a.jsx(Xg,{content:o})}):a.jsx("textarea",{value:o,onChange:v=>u(v.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:`# Heading 1
## Heading 2

Regular text with **bold** and *italic* formatting.

> Blockquote for important notes

| Table | Header |
|--------|---------|
| Cell 1 | Cell 2 |`})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null),l(""),u(""),d(""),g(!1)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(Qt,{className:"w-5 h-5"}),n?"Update Entry":"Save Entry"]})]})]})})}function OB(){const[e,t]=E.useState("users"),r=()=>{switch(e){case"users":return a.jsx(hB,{});case"gameData":return a.jsx(__,{});case"compendium":return a.jsx(LB,{});default:return null}},n=[{key:"users",label:"Users",Icon:Cu}];return a.jsxs("div",{className:"",children:[n.length>0&&a.jsx("nav",{className:"border-b",children:a.jsx("ul",{className:"flex -mb-px",children:n.map(({key:s,label:i,Icon:l})=>a.jsx("li",{className:"mr-6",children:a.jsxs("button",{onClick:()=>t(s),className:e===s?"flex items-center py-2 px-4 text-blue-600 border-b-2 border-blue-600 font-semibold":"flex items-center py-2 px-4 text-gray-600 hover:text-gray-800 hover:border-b-2 hover:border-gray-300",children:[a.jsx(l,{className:"w-5 h-5 mr-2"}),i]})},s))})}),a.jsx("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:r()})]})}function Y1({children:e,className:t="",onClick:r}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 ${t} ${r?"cursor-pointer":""}`,onClick:r,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:r?n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),r())}:void 0,children:e})}const Nm=[{id:"profile",label:"Profile Settings",icon:Si,description:"Manage your personal information and account settings"},{id:"game-data",label:"Game Data Editor",icon:xi,description:"Edit game data such as spells and items",adminOnly:!0},{id:"admin",label:"Admin Panel",icon:Cs,description:"System administration and user management",adminOnly:!0}];function PB(){const{isAdmin:e}=qt(),[t,r]=E.useState(()=>"profile"),n=i=>{const l=Nm.find(o=>o.id===i);l&&(!l.adminOnly||e())?r(i):l!=null&&l.adminOnly&&!e()&&(console.warn("Attempted to access admin settings without privileges."),r("profile"))};Tn.useEffect(()=>{const i=Nm.find(l=>l.id===t);i!=null&&i.adminOnly&&!e()&&r("profile")},[t,e]);const s=()=>{switch(t){case"profile":return a.jsx(nB,{});case"appearance":return a.jsx(sB,{});case"notifications":return a.jsx(aB,{});case"localization":return a.jsx(cB,{});case"game-data":return e()?a.jsx(__,{}):a.jsx(Wo,{to:"/settings",replace:!0});case"admin":return e()?a.jsx(OB,{}):a.jsx(Wo,{to:"/settings",replace:!0});default:return a.jsx(Wo,{to:"/settings",replace:!0})}};return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(jE,{className:"w-8 h-8 text-gray-700"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 md:col-span-4 space-y-4",children:Nm.filter(i=>!i.adminOnly||e()).map(i=>a.jsx(Y1,{onClick:()=>n(i.id),className:`cursor-pointer transition-all ${t===i.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${t===i.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:a.jsx(i.icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium",children:i.label}),a.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),a.jsx(Vs,{className:`w-5 h-5 ${t===i.id?"text-blue-500":"text-gray-400"}`})]})},i.id))}),a.jsx("div",{className:"col-span-12 md:col-span-8",children:a.jsx(Y1,{children:s()})})]})]})}function DB(){const[e,t]=E.useState(!0),[r,n]=E.useState(""),[s,i]=E.useState(""),[l,o]=E.useState(""),[u,c]=E.useState(""),[d,h]=E.useState("player"),[f,p]=E.useState(null),[g,y]=E.useState(null),[v,x]=E.useState({}),[b,w]=E.useState(!1),[_,k]=E.useState(navigator.onLine),{signIn:S,signUp:A}=qt(),R=fn(),L=Aa();E.useEffect(()=>{var B;(B=L.state)!=null&&B.message&&(y(L.state.message),R(L.pathname,{replace:!0,state:{}}))},[L,R]),E.useEffect(()=>{const B=()=>k(!0),W=()=>k(!1);return window.addEventListener("online",B),window.addEventListener("offline",W),()=>{window.removeEventListener("online",B),window.removeEventListener("offline",W)}},[]);const T=()=>{n(""),i(""),o(""),c(""),h("player"),p(null),y(null),x({})},z=()=>{t(!e),T()},O=async()=>{const B=ZU.safeParse({email:r.trim(),password:s});if(!B.success){const W={};return B.error.errors.forEach(K=>{K.path[0]&&(W[String(K.path[0])]=K.message)}),x(W),p("Please fix the errors in the form."),!1}try{w(!0);const{email:W,password:K}=B.data;return await S(W,K),!0}catch(W){return p(W instanceof Error?W.message:"Login failed. Please try again."),!1}finally{w(!1)}},Y=async()=>{const B=XU.safeParse({username:l.trim(),email:r.trim(),password:s,confirmPassword:u,role:d});if(!B.success){const W={};return B.error.errors.forEach(K=>{K.path[0]&&(W[String(K.path[0])]=K.message)}),x(W),p("Please fix the errors in the form."),!1}try{w(!0);const{email:W,password:K,username:P,role:X}=B.data;return await A(W,K,P,X),y("Registration successful! Please check your email to verify your account before logging in."),t(!0),T(),n(W),!0}catch(W){return p(W instanceof Error?W.message:"Signup failed. Please try again."),!1}finally{w(!1)}},G=async B=>{if(B.preventDefault(),p(null),y(null),x({}),!_){p("No internet connection");return}e?await O():await Y()};return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(Cs,{className:"mx-auto h-12 w-12 text-blue-600"}),a.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:e?"Log in to DragonBane":"Create your DragonBane Account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e?"Enter your details to access your account":"Fill in the details to register"})]}),!_&&a.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Dt,{className:"h-5 w-5 text-yellow-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No internet connection"}),a.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Please check your internet connection and try again."})]})]})}),f&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Dt,{className:"h-5 w-5 text-red-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:e?"Login Error":"Signup Error"}),a.jsx("p",{className:"mt-2 text-sm text-red-700",children:f})]})]})}),g&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Dt,{className:"h-5 w-5 text-green-400 mr-2"})," ",a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),a.jsx("p",{className:"mt-2 text-sm text-green-700",children:g})]})]})}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:G,noValidate:!0,children:[a.jsxs("div",{className:"space-y-4",children:[!e&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Si,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,autoComplete:"username",value:l,onChange:B=>o(B.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.username?"border-red-500":"border-gray-300"}`,placeholder:"Choose a username",disabled:b})]}),v.username&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.username})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(_g,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:r,onChange:B=>n(B.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address",disabled:b})]}),v.email&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.email})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:e?"current-password":"new-password",value:s,onChange:B=>i(B.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password",disabled:b})]}),v.password&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.password})]}),!e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Ko,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,autoComplete:"new-password",value:u,onChange:B=>c(B.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${v.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password",disabled:b})]}),v.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.confirmPassword})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Register as"}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"player",checked:d==="player",onChange:()=>h("player"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Player"})]}),a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"dm",checked:d==="dm",onChange:()=>h("dm"),disabled:b}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Dungeon Master (DM)"})]})]}),v.role&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.role})]})]})]}),a.jsx(U,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:!_||b,icon:e?ac:Cu,iconPosition:"left",children:e?"Log in":"Sign up"})]}),a.jsx("div",{className:"text-sm text-center",children:a.jsx("button",{type:"button",onClick:z,className:"font-medium text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:b,children:e?"Don't have an account? Sign up":"Already have an account? Log in"})})]})})}const Q1=({type:e})=>a.jsx("span",{className:"font-semibold text-xs uppercase",children:e}),MB={d4:4,d6:6,d8:8,d10:10,d12:12,d20:20};function K1(e){return Math.floor(Math.random()*MB[e])+1}function FB(){const{showDiceRoller:e,toggleDiceRoller:t,currentConfig:r,dicePool:n,addDie:s,removeLastDie:i,clearDicePool:l,isBoonActive:o,isBaneActive:u,setBoon:c,setBane:d,addRollToHistory:h,rollHistory:f,clearHistory:p}=Mn(),{markSkillInSession:g}=rr(),[y,v]=E.useState([]),[x,b]=E.useState([]),[w,_]=E.useState(null),[k,S]=E.useState(!1),[A,R]=E.useState(void 0),[L,T]=E.useState(!1),z=(r==null?void 0:r.rollMode)==="skillCheck",O=(r==null?void 0:r.rollMode)==="deathRoll",Y=(r==null?void 0:r.rollMode)==="rallyRoll",G=(r==null?void 0:r.rollMode)==="recoveryRoll",B=(r==null?void 0:r.rollMode)==="advancementRoll",W=E.useCallback(()=>{if(n.length===0)return;v([]),b([]),_(null),S(!1),R(void 0);const N=n.map(Z=>({type:Z,value:K1(Z)}));let V=[],H=N.reduce((Z,te)=>Z+te.value,0),j=H,he=!1,J,q=r==null?void 0:r.skillName;if((o||u)&&n.length===1&&n[0]==="d20"){V=[{type:"d20",value:K1("d20")}];const Z=N[0].value,te=V[0].value;j=o?Math.min(Z,te):Math.max(Z,te),H=j}else n.length===1&&n[0]==="d20"&&(j=N[0].value,H=j);if(n.length===1&&n[0]==="d20"){const Z=j;Z===1&&(he=!0,H="Dragon!",J=!0),Z===20&&(he=!0,H="Demon!",J=!1),(r==null?void 0:r.targetValue)!==void 0&&!he&&(z||Y||B||O)&&(J=Z<=r.targetValue),z&&q&&(Z===1||Z===20)&&g(q)}else G&&n.length===1&&n[0]==="d6"&&(j=N[0].value,H=j,J=void 0,he=!1);v(N),b(V),_(H),S(he),R(J);const $={description:(r==null?void 0:r.description)||`${n.join(", ")} Roll`,dicePool:[...n],results:N,boonResults:V.length>0?V:void 0,finalOutcome:H,isBoon:o,isBane:u,targetValue:r==null?void 0:r.targetValue,isSuccess:J,isCritical:he,skillName:q};h($),r!=null&&r.onRollComplete&&r.onRollComplete($),r!=null&&r.onRoll&&r.onRoll({total:j})},[n,o,u,r,h,g,G,z,Y,B,O]);if(E.useEffect(()=>{e||(v([]),b([]),_(null),S(!1),R(void 0),T(!1))},[e]),!e)return null;const K=()=>r!=null&&r.description?r.description:O?"Death Save (d20 vs CON)":Y?"Rally Roll (d20 vs WIL, Bane)":G?"Recovery Roll (1d6 HP)":B?"Advancement Roll (d20 vs Skill)":z?"Skill Check (d20 vs Skill)":"Dice Roller",P=()=>O?a.jsx(Qd,{className:"w-5 h-5"}):Y?a.jsx(IE,{className:"w-5 h-5"}):G?a.jsx(kg,{className:"w-5 h-5"}):B?a.jsx(Lo,{className:"w-5 h-5"}):z?a.jsx(ur,{className:"w-5 h-5"}):a.jsx(ur,{className:"w-5 h-5"}),X=O||Y||G||B;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center text-lg font-semibold",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[P()," ",K()]}),a.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-800",children:a.jsx(Rt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:L?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Roll History"}),a.jsxs(U,{onClick:p,variant:"danger",size:"xs",disabled:f.length===0,children:[a.jsx(cr,{className:"w-3 h-3 mr-1"})," Clear"]})]}),f.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No rolls yet."}):a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(N=>a.jsxs("li",{className:"text-xs border-b pb-1",children:[a.jsx("p",{className:"font-medium",children:N.description}),a.jsxs("p",{children:["Pool: ",N.dicePool.join(", ")," ",N.isBoon?"(Boon)":"",N.isBane?"(Bane)":""]}),a.jsxs("p",{children:["Rolls: ",N.results.map(V=>V.value).join(", ")," ",N.boonResults?`| Boon/Bane: ${N.boonResults.map(V=>V.value).join(", ")}`:""]}),a.jsxs("p",{children:["Outcome: ",a.jsx("span",{className:"font-semibold",children:String(N.finalOutcome)}),N.targetValue!==void 0&&` (vs ${N.targetValue})`,N.isSuccess===!0&&a.jsx("span",{className:"text-green-600 ml-1",children:"(Success)"}),N.isSuccess===!1&&a.jsx("span",{className:"text-red-600 ml-1",children:"(Failure)"}),N.isCritical&&a.jsx("span",{className:"text-purple-600 ml-1",children:"(Critical!)"})]}),N.skillName&&a.jsxs("p",{className:"text-gray-500",children:["Skill: ",N.skillName]})]},N.id))})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-3 border rounded bg-gray-50 min-h-[50px] flex flex-wrap gap-2 items-center",children:n.length===0?a.jsx("span",{className:"text-gray-500 italic",children:"Dice pool is empty"}):n.map((N,V)=>a.jsxs("button",{onClick:()=>!X&&i(),className:`px-2 py-1 border rounded shadow-sm flex items-center ${X?"bg-gray-300 cursor-not-allowed":"bg-white hover:bg-red-50 hover:border-red-300"}`,title:X?void 0:"Remove last die",disabled:X,children:[a.jsx(Q1,{type:N}),!X&&a.jsx(Rt,{className:"w-3 h-3 ml-1 text-red-500"})]},V))}),!X&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-4",children:["d4","d6","d8","d10","d12","d20"].map(N=>a.jsx(U,{onClick:()=>s(N),variant:"outline",size:"sm",className:"flex justify-center items-center",children:a.jsx(Q1,{type:N})},N))}),n.length===1&&n[0]==="d20"&&!X&&a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsxs(U,{onClick:()=>c(!o),variant:o?"success":"outline",size:"sm",className:`flex items-center ${o?"ring-2 ring-green-400 ring-offset-1":""}`,children:[a.jsx(lc,{className:`w-4 h-4 mr-1 ${o?"text-white":"text-green-500"}`})," Boon"]}),a.jsxs(U,{onClick:()=>d(!u),variant:u?"danger":"outline",size:"sm",className:`flex items-center ${u?"ring-2 ring-red-400 ring-offset-1":""}`,children:[a.jsx(M4,{className:`w-4 h-4 mr-1 ${u?"text-white":"text-red-500"}`})," Bane"]})]}),y.length>0&&a.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50 border-blue-200 text-center",children:[a.jsxs("p",{className:"text-sm text-blue-700 mb-1",children:["Rolled: ",y.map(N=>N.value).join(", "),x.length>0&&` | Boon/Bane: ${x.map(N=>N.value).join(", ")}`]}),a.jsx("p",{className:`text-2xl font-bold ${k?"text-purple-600":"text-blue-900"}`,children:String(w)}),(r==null?void 0:r.targetValue)!==void 0&&!k&&a.jsxs("p",{className:"text-sm text-gray-600",children:["(Target: ",r.targetValue,")"]}),A===!0&&!k&&a.jsx("p",{className:"text-green-600 font-semibold mt-1",children:"Success!"}),A===!1&&!k&&a.jsx("p",{className:"text-red-600 font-semibold mt-1",children:"Failure!"})]})]})}),a.jsxs("div",{className:"p-4 border-t flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{children:[a.jsxs(U,{onClick:()=>T(!L),variant:"secondary",size:"sm",children:[a.jsx(b4,{className:"w-4 h-4 mr-1"})," ",L?"Roller":"History"]}),!L&&!X&&a.jsxs(U,{onClick:l,variant:"ghost",size:"sm",className:"ml-2 text-red-600 hover:bg-red-100",disabled:n.length===0,children:[a.jsx(cr,{className:"w-4 h-4 mr-1"})," Clear Pool"]})]}),!L&&a.jsxs(U,{onClick:W,disabled:n.length===0,size:"lg",children:[a.jsx(ur,{className:"w-5 h-5 mr-2"})," Roll"]})]})]})})}function UB({children:e}){const{user:t,isLoading:r}=qt(),n=Aa();return console.log("--- PrivateRoute Decision ---",{isLoading:r,user:t?`User ID: ${t.id}`:null}),r?a.jsx("div",{className:"flex h-screen w-full items-center justify-center",children:a.jsx("p",{className:"text-xl text-gray-600",children:"Loading Session..."})}):t?a.jsx(a.Fragment,{children:e}):a.jsx(Wo,{to:"/login",state:{from:n},replace:!0})}function BB({textToCopy:e}){const[t,r]=E.useState(!1),n=async()=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Failed to copy text: ",s)}};return a.jsx(U,{variant:"ghost",size:"icon",onClick:n,"aria-label":t?"Copied":"Copy to clipboard",children:t?a.jsx(Ka,{className:"w-5 h-5 text-green-500"}):a.jsx(Eg,{className:"w-5 h-5 text-gray-500"})})}function HB({partyId:e,isDM:t}){const{user:r}=qt(),[n,s]=E.useState([]),[i,l]=E.useState([]),[o,u]=E.useState(null),[c,d]=E.useState(!1),[h,f]=E.useState(null),[p,g]=E.useState(""),[y,v]=E.useState(""),[x,b]=E.useState(""),[w,_]=E.useState("all"),[k,S]=E.useState(""),[A,R]=E.useState(!0),[L,T]=E.useState(null),[z,O]=E.useState(null),Y=E.useCallback(()=>{g(""),v(""),b(w==="all"?"":w),O(null)},[w]),G=()=>{Y(),d(!0),f(null),u(null)},B=H=>{u(H),f(H.id),d(!1),g(H.title),v(H.content),b(H.category),O(null)},W=()=>{d(!1),f(null),Y(),h&&u(null)},K=E.useCallback(async()=>{if(e){R(!0),T(null);try{const{data:H,error:j}=await re.from("notes").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(j)throw j;s(H||[]);const he=Array.from(new Set((H==null?void 0:H.map(J=>J.category).filter(Boolean))||[]));l(he)}catch(H){console.error("Error loading party notes:",H),T(H instanceof Error?H.message:"Failed to load party notes"),s([])}finally{R(!1)}}},[e]);E.useEffect(()=>{K()},[K]);const P=async()=>{if(!r){O("User not authenticated.");return}if(!p.trim()){O("Note title cannot be empty.");return}if(!x.trim()){O("Note category cannot be empty.");return}O(null);const H={title:p.trim(),content:y||"",category:x.trim(),party_id:e,user_id:r.id,updated_at:new Date().toISOString()};try{let j=null;if(h){const{data:he,error:J}=await re.from("notes").update(H).eq("id",h).select().single();if(J)throw J;j=he}else{const{updated_at:he,...J}=H,{data:q,error:$}=await re.from("notes").insert([J]).select().single();if($)throw $;j=q}W(),await K(),j&&u(j)}catch(j){console.error("Error saving note:",j);let he="Failed to save note.";j instanceof Error&&(j.message.includes("RLS")?he="Permission denied. Could not save the note due to security policies.":"code"in j&&j.code==="23505"?he="A note with this title might already exist in this party.":he=`Failed to save note: ${j.message}`),O(he)}},X=async H=>{if(window.confirm("Are you sure you want to delete this note?"))try{T(null);const{error:j}=await re.from("notes").delete().eq("id",H);if(j)throw j;await K(),(o==null?void 0:o.id)===H&&u(null),h===H&&W()}catch(j){console.error("Error deleting note:",j),T(j instanceof Error?`Failed to delete note: ${j.message}`:"An unknown error occurred while deleting.")}},N=n.filter(H=>{const j=H.title.toLowerCase().includes(k.toLowerCase())||H.content.toLowerCase().includes(k.toLowerCase()),he=w==="all"||H.category===w;return j&&he});if(A&&n.length===0&&!e)return a.jsx("div",{className:"p-4",children:a.jsx(Ne,{message:"Party ID is missing. Cannot load notes."})});if(A&&n.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:[" ",a.jsx(He,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading party notes..."})]});const V=c||h;return a.jsxs("div",{className:"flex h-[calc(100vh-150px)] overflow-hidden bg-gray-50",children:[" ",a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(nc,{className:"w-5 h-5 text-indigo-600"}),"Party Notes"]}),a.jsx(U,{variant:"primary",size:"sm",icon:Xt,onClick:G,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:k,onChange:H=>S(H.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsxs("select",{id:"category-filter",value:w,onChange:H=>_(H.target.value),className:"w-full pl-9 pr-7 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white text-sm","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(H=>a.jsx("option",{value:H,children:H},H))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(Fh,{className:"w-3 h-3 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[L&&!V&&a.jsx("div",{className:"p-3",children:a.jsx(Ne,{message:L,onClose:()=>T(null)})}),N.length>0?N.map(H=>a.jsxs("div",{onClick:()=>{(!h||h!==H.id)&&(u(H),d(!1),f(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(o==null?void 0:o.id)===H.id&&!V?"bg-indigo-50 border-l-4 border-indigo-500":""} ${h===H.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:H.title}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-0.5",children:[a.jsx(Jy,{className:"w-2.5 h-2.5"}),a.jsx("span",{className:"truncate",children:H.category})]})]},H.id)):!A&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Ul,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),k||w!=="all"?"No notes match filters.":"No notes in this party yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:V?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Edit Party Note":"Create New Party Note"}),a.jsx("button",{onClick:W,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100","aria-label":"Close form",children:a.jsx(Rt,{className:"w-5 h-5"})})]}),z&&a.jsx("div",{className:"mb-4",children:a.jsx(Ne,{message:z,onClose:()=>O(null)})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"note-title",type:"text",value:p,onChange:H=>g(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{id:"note-category",type:"text",value:x,onChange:H=>b(H.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Quests, Locations, NPCs",list:"category-suggestions",required:!0}),i.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("datalist",{id:"category-suggestions",children:i.map(H=>a.jsx("option",{value:H},H))}),a.jsxs("select",{value:x,onChange:H=>b(H.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white text-sm","aria-label":"Select existing category",children:[a.jsx("option",{value:"",disabled:!0,children:"Select existing..."}),i.map(H=>a.jsx("option",{value:H,children:H},H))]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"note-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"note-content",value:y,onChange:H=>v(H.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your notes here..."})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-3",children:[a.jsx(U,{variant:"secondary",onClick:W,children:"Cancel"}),a.jsx(U,{variant:"primary",icon:Qt,onClick:P,disabled:A||!p.trim()||!x.trim(),children:A?"Saving...":h?"Update Note":"Save Note"})]})]}):o?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx(Jy,{className:"w-3 h-3"}),a.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-700",children:o.category})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(U,{variant:"secondary",size:"sm",icon:ic,onClick:()=>B(o),children:"Edit"}),a.jsx(U,{variant:"danger_outline",size:"sm",icon:cr,onClick:()=>X(o.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(Xg,{content:o.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(o.created_at).toLocaleDateString(),o.updated_at&&new Date(o.updated_at).getTime()!==new Date(o.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(o.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(Ul,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a party note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),L&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ne,{message:L,onClose:()=>T(null)})})]})})]})}async function $B(e){if(!e)return console.warn("fetchTasks called without partyId"),[];const{data:t,error:r}=await re.from("party_tasks").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching tasks:",r),new Error(r.message||"Failed to fetch tasks");return t||[]}async function zB(e,t){if(!t)throw new Error("User must be authenticated to create a task.");if(!e.party_id)throw new Error("Party ID is required to create a task.");if(!e.title||e.title.trim()==="")throw new Error("Task title cannot be empty.");const{data:r,error:n}=await re.from("party_tasks").insert({party_id:e.party_id,title:e.title,description:e.description,created_by_user_id:t.id,status:"open"}).select().single();if(n)throw console.error("Error creating task:",n),new Error(n.message||"Failed to create task");if(!r)throw new Error("Task creation did not return data.");return r}async function qB(e,t){if(!e)throw new Error("Task ID is required to update a task.");const r={...t};t.status&&(t.status==="completed"?r.completed_at=new Date().toISOString():t.status==="open"&&(r.completed_at=null));const{data:n,error:s}=await re.from("party_tasks").update(r).eq("id",e).select().single();if(s)throw console.error("Error updating task:",s),new Error(s.message||"Failed to update task");if(!n)throw new Error("Task update did not return data.");return n}async function VB(e){if(!e)throw new Error("Task ID is required to delete a task.");const{error:t}=await re.from("party_tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),new Error(t.message||"Failed to delete task")}function WB(){const e=fn(),{setGlobalError:t}=PE(),r=E.useCallback((i,l)=>{const o=i instanceof Error?i.message:String(i);fl.handleError(i,{action:l==null?void 0:l.action,additionalData:{critical:l==null?void 0:l.critical}}),(l==null?void 0:l.showError)!==!1&&t(o),l!=null&&l.redirect&&e(l.redirect),l!=null&&l.critical&&e("/error",{state:{error:o}})},[e,t]),n=E.useCallback((i,l)=>{fl.handleAuthError(i,{action:l==null?void 0:l.action});const o=i instanceof Error?i.message:String(i);t(o),e((l==null?void 0:l.redirect)||"/login")},[e,t]),s=E.useCallback((i,l)=>{fl.handleNetworkError(i,{action:l==null?void 0:l.action}),t("Network error. Please check your connection and try again."),l!=null&&l.retry&&setTimeout(l.retry,1e3)},[t]);return{handleError:r,handleAuthError:n,handleNetworkError:s}}function GB({partyId:e,isDM:t}){const{user:r}=qt(),n=Zr(),{handleError:s}=WB(),[i,l]=E.useState(""),[o,u]=E.useState(""),[c,d]=E.useState(!1),{data:h,isLoading:f,error:p}=It({queryKey:["partyTasks",e],queryFn:()=>$B(e),enabled:!!e}),g=wt({mutationFn:k=>zB(k,r),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]}),l(""),u(""),d(!1)},onError:k=>{s(k,{action:"creating task"})}}),y=wt({mutationFn:({taskId:k,updates:S})=>qB(k,S),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"updating task"})}}),v=wt({mutationFn:k=>VB(k),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:k=>{s(k,{action:"deleting task"})}}),x=k=>{if(k.preventDefault(),!i.trim()){s(new Error("Task title cannot be empty."),{action:"adding task",showError:!0});return}g.mutate({party_id:e,title:i.trim(),description:o.trim()||void 0})},b=k=>{y.mutate({taskId:k.id,updates:{status:k.status==="open"?"completed":"open"}})},w=k=>{window.confirm("Are you sure you want to delete this task?")&&v.mutate(k)},_=k=>t||k.created_by_user_id===(r==null?void 0:r.id);return f?a.jsx(He,{}):p?a.jsx(Ne,{message:`Failed to load tasks: ${p.message}`}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Party Tasks"}),t&&a.jsx(U,{icon:c?void 0:Xt,onClick:()=>d(!c),variant:c?"secondary":"primary",children:c?"Cancel":"Add Task"})]}),t&&c&&a.jsxs("form",{onSubmit:x,className:"p-4 border rounded-lg bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"newTaskTitle",className:"block text-sm font-medium text-gray-700",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"newTaskTitle",value:i,onChange:k=>l(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g., Clear out the goblin cave",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"newTaskDescription",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),a.jsx("textarea",{id:"newTaskDescription",value:o,onChange:k=>u(k.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Any additional details about the task..."})]}),a.jsx(U,{type:"submit",loading:g.isPending,icon:Xt,children:"Add Task"})]}),h&&h.length>0?a.jsx("ul",{className:"space-y-3",children:h.map(k=>{var S;return a.jsxs("li",{className:`p-4 border rounded-lg flex items-start justify-between gap-4 ${k.status==="completed"?"bg-green-50 border-green-200":"bg-white"}`,children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>b(k),loading:y.isPending&&((S=y.variables)==null?void 0:S.taskId)===k.id,className:k.status==="completed"?"text-green-600 hover:text-green-700":"text-gray-400 hover:text-gray-600","aria-label":k.status==="completed"?"Mark as open":"Mark as completed",children:k.status==="completed"?a.jsx(Su,{size:20}):a.jsx(f4,{size:20})}),a.jsx("h3",{className:`text-lg font-medium ${k.status==="completed"?"line-through text-gray-500":""}`,children:k.title})]}),k.description&&a.jsx("p",{className:`mt-1 text-sm ${k.status==="completed"?"text-gray-400":"text-gray-600"}`,children:k.description}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Added on: ",new Date(k.created_at).toLocaleDateString(),k.completed_at&&k.status==="completed"&&a.jsxs("span",{children:[" | Completed on: ",new Date(k.completed_at).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:_(k)&&a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>w(k.id),loading:v.isPending&&v.variables===k.id,className:"text-red-500 hover:text-red-700","aria-label":"Delete task",children:a.jsx(cr,{size:18})})})]},k.id)})}):a.jsxs("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(oc,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tasks yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t?"Get started by adding a new task for your party.":"The DM hasn't added any tasks yet."}),t&&!c&&a.jsx(U,{onClick:()=>d(!0),className:"mt-4",icon:Xt,children:"Add First Task"})]})]})}function YB({partyId:e,members:t,isDM:r}){var X;const n=Zr(),[s,i]=E.useState([]),[l,o]=E.useState(!0),[u,c]=E.useState(null),[d,h]=E.useState(""),[f,p]=E.useState("all"),[g,y]=E.useState(""),[v,x]=E.useState([]),[b,w]=E.useState([]),[_,k]=E.useState(!1),{data:S=[],isLoading:A,error:R}=It({queryKey:["gameItems"],queryFn:uc,staleTime:1e3*60*10}),L=N=>{if(N)return S.find(V=>V.name===N)};E.useEffect(()=>{T(),z()},[e]);async function T(){try{o(!0),c(null);const{data:N,error:V}=await re.from("party_inventory").select("*").eq("party_id",e);if(V)throw V;i(N||[])}catch(N){c(N instanceof Error?N.message:"Failed to load inventory"),i([])}finally{o(!1)}}async function z(){try{const{data:N,error:V}=await re.from("party_inventory_log").select("*").eq("party_id",e).order("timestamp",{ascending:!1}).limit(50);if(V)throw V;w(N||[])}catch(N){console.error("Failed to load transaction log:",N),w([])}}const O=async()=>{if(!(!g||v.length===0))try{c(null);const N=t.find(V=>V.id===g);if(!N)throw new Error("Character not found");await Promise.all(v.map(async V=>{const H=s.find(te=>te.id===V);if(!H||!H.name||H.quantity<1)return;let j;if(H.quantity>1?{error:j}=await re.from("party_inventory").update({quantity:H.quantity-1}).eq("id",H.id):{error:j}=await re.from("party_inventory").delete().eq("id",H.id),j)throw j;const he=N.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},J=he.inventory||[],q=L(H.name);if(q){const te=J.findIndex(ge=>ge.name===q.name);if(te>-1)J[te].quantity+=1;else{const ge={...q,id:void 0,quantity:1,originalName:q.name};J.push(ge)}}else{console.warn(`Details not found for item: ${H.name}. Transferring with basic info.`);const te={name:H.name,quantity:1,originalName:H.name,description:H.description,category:H.category},ge=J.findIndex(we=>we.name===te.name);ge>-1?J[ge].quantity+=1:J.push(te)}const{error:$}=await re.from("characters").update({equipment:{...he,inventory:J}}).eq("id",N.id);if($)throw $;const{error:Z}=await re.from("party_inventory_log").insert([{party_id:e,item_name:H.name,quantity:1,from_type:"party",from_id:e,to_type:"character",to_id:N.id}]);if(Z)throw Z})),await Promise.all([T(),z(),n.invalidateQueries({queryKey:["character",N.id]}),n.invalidateQueries({queryKey:["party",e]})]),x([])}catch(N){c(N instanceof Error?N.message:"Failed to transfer items"),await T()}},Y=async(N,V)=>{try{c(null);const H=t.find(te=>te.id===N);if(!H)throw new Error("Character not found");if(!V.name){console.warn("Attempted to transfer an item without a name.");return}const j=H.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}};let he=j.inventory||[];const J=he.findIndex(te=>te.name===V.name);if(J===-1){console.warn(`Item "${V.name}" not found in character ${N}'s inventory.`);return}he[J].quantity>1?he[J].quantity-=1:he=[...he.slice(0,J),...he.slice(J+1)];const{error:q}=await re.from("characters").update({equipment:{...j,inventory:he}}).eq("id",H.id);if(q)throw q;const $=s.find(te=>te.name===V.name);if($){const{error:te}=await re.from("party_inventory").update({quantity:$.quantity+1}).eq("id",$.id);if(te)throw te}else{const{error:te}=await re.from("party_inventory").insert([{party_id:e,name:V.name,quantity:1,category:V.category||"misc",description:V.description||V.effect}]).select();if(te)throw te}const{error:Z}=await re.from("party_inventory_log").insert([{party_id:e,item_name:V.name,quantity:1,from_type:"character",from_id:H.id,to_type:"party",to_id:e}]);if(Z)throw Z;await Promise.all([T(),z(),n.invalidateQueries({queryKey:["character",H.id]}),n.invalidateQueries({queryKey:["party",e]})])}catch(H){c(H instanceof Error?H.message:"Failed to transfer item to party")}},G=s.map(N=>N.category).filter(N=>typeof N=="string"&&N.trim()!==""),B=["all",...new Set(G)],W=s.filter(N=>{const H=(N.name||"").toLowerCase().includes(d.toLowerCase()),j=f==="all"||N.category===f;return H&&j}),K=t.find(N=>N.id===g),P=((X=K==null?void 0:K.equipment)==null?void 0:X.inventory)??[];return a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 lg:col-span-7",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Party Inventory"}),a.jsx(U,{variant:"secondary",onClick:()=>k(!_),children:_?"Hide History":"Show History"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search items...",value:d,onChange:N=>h(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("select",{value:f,onChange:N=>p(N.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:B.map(N=>a.jsx("option",{value:N,children:N==="all"?"All Categories":N},N))})]})]}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[l?a.jsx(He,{}):u?a.jsx(Ne,{message:u}):W.map(N=>a.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer ${v.includes(N.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-100"}`,onClick:()=>{N.id?x(V=>V.includes(N.id)?V.filter(H=>H!==N.id):[...V,N.id]):console.warn("Attempted to select an item without an ID:",N)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:N.name||"Unnamed Item"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",N.quantity]})]}),N.category&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100",children:N.category})]}),N.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:N.description})]},N.id)),!l&&W.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:d||f!=="all"?"No items found matching filters.":"Party inventory is empty."})})]})]})}),a.jsxs("div",{className:"col-span-12 lg:col-span-5",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Transfer Items"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Character"}),a.jsxs("select",{value:g,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Choose a character..."}),t.map(N=>a.jsxs("option",{value:N.id,children:[N.name," (",N.kin," ",N.profession,")"]},N.id))]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsx(U,{variant:"secondary",icon:Dh,disabled:!g||v.length===0,onClick:O,title:"Transfer selected items from Party to Character",children:"To Character"})}),g&&K&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-4",children:[K.name,"'s Inventory"]}),a.jsxs("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded p-2",children:[P.map((N,V)=>a.jsxs("div",{className:"p-2 border-b flex items-center justify-between text-sm",children:[a.jsxs("span",{children:[N.name||"Unnamed Item"," (Qty: ",N.quantity,")"]}),a.jsx(U,{variant:"secondary",size:"sm",icon:bE,onClick:()=>Y(g,N),disabled:!N.name,title:N.name?`Transfer ${N.name} to Party`:"Cannot transfer unnamed item",children:"Give"})]},N.id||`${N.name||"unknown"}-${V}`)),P.length===0&&a.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Character inventory is empty."})]})]})]}),_&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transaction History"}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[b.map(N=>{var V,H;return a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"font-medium",children:[N.item_name||"Unknown Item"," (Qty: ",N.quantity,")"]}),a.jsx("span",{className:"text-gray-500 text-xs",children:new Date(N.timestamp).toLocaleString()})]}),a.jsxs("p",{className:"text-gray-600 text-xs",children:[N.from_type==="party"?"Party":((V=t.find(j=>j.id===N.from_id))==null?void 0:V.name)||"Unknown Char","  ",N.to_type==="party"?"Party":((H=t.find(j=>j.id===N.to_id))==null?void 0:H.name)||"Unknown Char"]})]},N.id)}),b.length===0&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:"No transactions recorded yet."})]})]})]})]})}async function QB(){const{data:e,error:t}=await re.from("monsters").select("*").order("name");if(t)throw console.error("Error fetching all monsters:",t),t;return e||[]}function KB(e){const t=Zr();E.useEffect(()=>{if(!e)return;const r=[],n=re.channel(`encounter:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"encounters",filter:`id=eq.${e}`},i=>{console.log("Encounter updated:",i),t.invalidateQueries({queryKey:["encounterDetails",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter channel error for ${e}:`,l)});r.push(n);const s=re.channel(`encounter_combatants:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${e}`},i=>{console.log("Encounter combatants changed:",i),t.invalidateQueries({queryKey:["encounterCombatants",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter_combatants:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter combatants channel error for ${e}:`,l)});return r.push(s),()=>{console.log(`Unsubscribing from encounter channels for ${e}`),r.forEach(i=>re.removeChannel(i))}},[e,t])}const Z1=({stats:e})=>a.jsx("table",{className:"w-full text-sm mt-1",children:a.jsx("tbody",{children:Object.entries(e).map(([t,r])=>a.jsxs("tr",{className:"border-b border-gray-200 last:border-b-0",children:[a.jsx("td",{className:"py-1 pr-2 font-semibold text-gray-600 capitalize",children:t.replace(/_/g," ")}),a.jsx("td",{className:"py-1 text-gray-800",children:String(r)})]},t))})});function X1({description:e,attackName:t}){const{toggleDiceRoller:r}=Mn(),n=/(\d*d\d+\s*[+-]?\s*\d*)/gi,s=e.split(n);return a.jsx("p",{className:"text-gray-800 mt-1",children:s.map((i,l)=>i.match(n)&&i.match(/[dD]/)?a.jsx("button",{className:"font-bold text-blue-600 hover:underline bg-blue-100 px-1 py-0.5 rounded-md mx-0.5",onClick:()=>r==null?void 0:r({dice:i.toLowerCase().replace(/\s/g,""),label:`${t} - Damage Roll`}),children:i},l):a.jsx("span",{children:i},l))})}function J1({text:e,contextLabel:t}){const{toggleDiceRoller:r}=Mn();if(!e)return null;const n=/(\d*d\d+\s*[+-]?\s*\d*)/gi,s=e.split(n),i=l=>l.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>");return a.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:s.map((l,o)=>{if(l.match(n)&&l.match(/[dD]/))return a.jsx("button",{className:"font-bold text-blue-600 hover:underline bg-blue-100 px-1 py-0.5 rounded-md mx-0.5",onClick:()=>r==null?void 0:r({dice:l.toLowerCase().replace(/\s/g,""),label:`${t} - Effects Roll`}),children:l},o);const u=i(l);return a.jsx("span",{dangerouslySetInnerHTML:{__html:u}},o)})})}function ZB({entry:e}){var n;const t=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});let r=null;switch(e.type){case"round_advanced":r=a.jsxs("p",{className:"font-bold text-blue-600 text-center py-1",children:["--- Round ",e.round," ---"]});break;case"turn_start":r=a.jsxs(a.Fragment,{children:[a.jsx(Yd,{className:"w-4 h-4 inline mr-2 text-gray-500"}),"Turn started for ",a.jsx("strong",{children:e.name}),"."]});break;case"turn_end":r=a.jsxs(a.Fragment,{children:[a.jsx(ac,{className:"w-4 h-4 inline mr-2 text-gray-500"}),"Turn ended for ",a.jsx("strong",{children:e.name}),"."]});break;case"hp_change":const s=e.delta<0;r=a.jsxs("span",{className:s?"text-red-700":"text-green-700",children:[a.jsx(ba,{className:"w-4 h-4 inline mr-2"}),a.jsx("strong",{children:e.name})," ",s?`took ${Math.abs(e.delta)} damage`:`healed ${e.delta} HP`,". (",e.from,"  ",e.to,")"]});break;case"monster_attack":r=a.jsxs("span",{className:"text-yellow-800",children:[a.jsx(cs,{className:"w-4 h-4 inline mr-2"}),a.jsx("strong",{children:e.name})," used ",a.jsx("strong",{children:((n=e.attack)==null?void 0:n.name)||"an attack"})," (Rolled ",e.roll,")."]});break;default:r=a.jsx("span",{children:JSON.stringify(e)})}return e.type==="round_advanced"?a.jsx("div",{className:"w-full",children:r}):a.jsxs("div",{className:"flex items-start gap-2 text-sm py-1.5",children:[a.jsx("time",{className:"text-xs text-gray-400 mt-0.5 whitespace-nowrap",children:t(e.ts)}),a.jsx("div",{className:"flex-grow",children:r})]})}function XB({log:e}){return!e||e.length===0?a.jsx("p",{className:"text-sm text-gray-500 mt-2 px-1",children:"No events have been logged yet."}):a.jsx("div",{className:"space-y-1 divide-y divide-gray-100",children:e.slice().reverse().map((t,r)=>a.jsx(ZB,{entry:t},r))})}function JB({partyId:e,partyMembers:t,isDM:r}){var en,is,Ai,Ma;const n=Zr(),{toggleDiceRoller:s}=Mn(),[i,l]=E.useState(""),[o,u]=E.useState(""),[c,d]=E.useState(null),[h,f]=E.useState(!1),[p,g]=E.useState("details"),[y,v]=E.useState("idle"),[x,b]=E.useState(!1),[w,_]=E.useState([]),[k,S]=E.useState(""),[A,R]=E.useState(""),[L,T]=E.useState(1),[z,O]=E.useState(""),[Y,G]=E.useState(""),[B,W]=E.useState({}),[K,P]=E.useState(!1),[X,N]=E.useState(""),[V,H]=E.useState(""),[j,he]=E.useState([]),[J,q]=E.useState(!1),[$,Z]=E.useState(null),[te,ge]=E.useState({}),[we,Te]=E.useState({}),[ze,Ze]=E.useState(null),[Ct,ot]=E.useState(""),{data:pt,isLoading:Ye,error:pn}=It({queryKey:["allEncounters",e],queryFn:()=>G5(e),enabled:!!e}),{data:at,isLoading:as,error:pr}=It({queryKey:["allMonsters"],queryFn:QB}),Ie=E.useMemo(()=>c||(pt&&pt.length>0?pt[0].id:null),[c,pt]),{data:tt,isLoading:ji,error:se}=It({queryKey:["encounterDetails",Ie],queryFn:()=>Ie?Y5(Ie):Promise.resolve(null),enabled:!!Ie}),{data:de,isLoading:je,error:Re}=It({queryKey:["encounterCombatants",Ie],queryFn:()=>Ie?nN(Ie):Promise.resolve([]),enabled:!!Ie});KB(Ie);const Je=wt({mutationFn:M=>K5(e,M.name,M.description),onSuccess:M=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(M.id),g("details"),l(""),u("")}}),gr=wt({mutationFn:nI,onSuccess:(M,me)=>{n.invalidateQueries({queryKey:["allEncounters",e]}),c===me&&d(null)}}),gn=wt({mutationFn:({encounterId:M,name:me})=>Z5(M,me),onSuccess:M=>{n.invalidateQueries({queryKey:["allEncounters",e]}),d(M.id)}}),Vt=wt({mutationFn:M=>{if(!Ie)throw new Error("No active encounter");return X5({encounterId:Ie,characterId:M.characterId,initiativeRoll:M.initiativeRoll})},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Ie]}),_([]),O("")}}),xn=wt({mutationFn:M=>{if(!Ie)throw new Error("No active encounter");return J5(M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Ie]}),S(""),R(""),T(1),G(""),b(!1)}}),nr=wt({mutationFn:M=>sN(M.id,M.updates),onSuccess:M=>{n.setQueryData(["encounterCombatants",Ie],me=>(me==null?void 0:me.map(Ee=>Ee.id===M.id?M:Ee))??[])}}),Nt=wt({mutationFn:sI,onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Ie]})}}),Xr=wt({mutationFn:M=>{if(!Ie)throw new Error("No active encounter to update");return jg(Ie,M)},onSuccess:M=>{n.setQueryData(["encounterDetails",Ie],M),n.invalidateQueries({queryKey:["allEncounters",e]}),P(!1)}}),_r=wt({mutationFn:M=>{if(!Ie)throw new Error("No active encounter");return aI(Ie,M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Ie]}),he([])}}),tf=wt({mutationFn:({id1:M,id2:me})=>iI(M,me),onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",Ie]}),q(!1),Z(null)}}),rf=wt({mutationFn:()=>{if(!Ie)throw new Error("No encounter to start");return tI(Ie)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Ie],refetchType:"active"}),n.invalidateQueries({queryKey:["allEncounters",e],refetchType:"active"})}}),nf=wt({mutationFn:()=>{if(!Ie)throw new Error("No encounter to end");return rI(Ie)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Ie],refetchType:"active"}),n.invalidateQueries({queryKey:["allEncounters",e],refetchType:"active"})}}),Jr=wt({mutationFn:M=>{if(!Ie)throw new Error("No encounter to log");return eI(Ie,M)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterDetails",Ie]})}}),yc=wt({mutationFn:()=>{if(!Ie)throw new Error("No encounter for next round");return nextRound(Ie)},onSuccess:async()=>{await Jr.mutateAsync({type:"round_advanced",ts:Date.now(),round:((tt==null?void 0:tt.current_round)??0)+1}),n.setQueryData(["encounterCombatants",Ie],M=>(M==null?void 0:M.map(me=>({...me,initiative_roll:null})))??[]),he([]),Ze(null),n.invalidateQueries({queryKey:["encounterDetails",Ie]})}}),Pa=E.useMemo(()=>new Map((at??[]).map(M=>[M.id,M])),[at]),et=E.useMemo(()=>(de==null?void 0:de.slice().sort((M,me)=>{const Ee=M.initiative_roll??1e3,Be=me.initiative_roll??1e3;return Ee!==Be?Ee-Be:(M.display_name??"").localeCompare(me.display_name??"")}))||[],[de]),gt=E.useMemo(()=>et.find(M=>M.id===ze),[et,ze]),Un=E.useMemo(()=>gt!=null&&gt.monster_id?Pa.get(gt.monster_id):null,[gt,Pa]);E.useEffect(()=>{Ye||g(!pt||pt.length===0?"create":"details")},[pt,Ye]),E.useEffect(()=>{if(!et)return;const M={};et.forEach(me=>{M[me.id]={current_hp:String(me.current_hp??me.max_hp??0),current_wp:me.max_wp!=null?String(me.current_wp??me.max_wp??""):void 0,initiative_roll:me.initiative_roll!=null?String(me.initiative_roll):""}}),W(M)},[et]),E.useEffect(()=>{tt&&(N(tt.name),H(tt.description||""))},[tt]),E.useEffect(()=>{if((tt==null?void 0:tt.status)==="active"&&et.length>0&&!ze){const M=et[0];Ze(M.id),Jr.mutate({type:"turn_start",ts:Date.now(),who:M.id,name:M.display_name})}(tt==null?void 0:tt.status)!=="active"&&Ze(null)},[et,tt==null?void 0:tt.status,tt==null?void 0:tt.current_round,Jr,ze]);const sf=M=>{M.preventDefault(),i.trim()&&Je.mutate({name:i.trim(),description:o.trim()||void 0})},af=(M,me)=>gn.mutate({encounterId:M,name:`${me} (Copy)`}),lf=M=>{d(M),f(!1)},bc=()=>{w.length!==0&&w.forEach(M=>{Vt.mutate({characterId:M,initiativeRoll:z?parseInt(z):null})})},of=M=>{_(me=>me.includes(M)?me.filter(Ee=>Ee!==M):[...me,M])},vc=()=>{var Be;const M=at==null?void 0:at.find(dt=>dt.id===k);if(!M||!Ie)return;const me=((Be=M.stats)==null?void 0:Be.FEROCITY)??1,Ee=A.trim()||M.name;for(let dt=1;dt<=L;dt++){const ie=L>1?`${Ee} ${dt}`:Ee;for(let Bt=1;Bt<=me;Bt++){const Ur=me>1?`${ie} (Action ${Bt})`:ie;xn.mutate({encounterId:Ie,monsterId:k,customName:Ur,initiativeRoll:Y?parseInt(Y):null})}}},Da=M=>{const me=B[M],Ee=et.find(ie=>ie.id===M);if(!me||!Ee)return;const Be={},dt=parseInt(me.current_hp,10);if(!isNaN(dt)&&dt!==Ee.current_hp){Be.current_hp=dt;const ie=dt-(Ee.current_hp??0);Jr.mutate({type:"hp_change",ts:Date.now(),who:M,name:Ee.display_name,delta:ie,from:Ee.current_hp,to:dt})}if(me.initiative_roll!=null){const ie=me.initiative_roll.trim()===""?null:parseInt(me.initiative_roll,10);(ie===null||!isNaN(ie))&&ie!==Ee.initiative_roll&&(Be.initiative_roll=ie)}if(Ee.max_wp!=null&&me.current_wp!=null){const ie=me.current_wp.trim()===""?null:parseInt(me.current_wp,10);if((ie===null||!isNaN(ie))&&ie!==Ee.current_wp){Be.current_wp=ie;const Bt=(ie??0)-(Ee.current_wp??0);Jr.mutate({type:"wp_change",ts:Date.now(),who:M,name:Ee.display_name,delta:Bt,from:Ee.current_wp,to:ie})}}Object.keys(Be).length>0&&nr.mutate({id:M,updates:Be})},fe=()=>{j.length!==0&&_r.mutate(j)},Se=M=>{J&&($?$!==M&&tf.mutate({id1:$,id2:M}):Z(M))},Le=M=>ge(me=>({...me,[M]:!me[M]})),rt=(M,me)=>{if(!me.attacks||me.attacks.length===0)return;const Ee=Math.floor(Math.random()*6)+1,Be=me.attacks.find(dt=>dt.roll_values.split(",").includes(String(Ee)));Te(dt=>({...dt,[M]:Be||null})),Jr.mutate({type:"monster_attack",ts:Date.now(),who:M,name:me.name,roll:Ee,attack:Be?{name:Be.name,desc:Be.description}:null})},ct=M=>{if(ze&&ze!==M){const Ee=et.find(Be=>Be.id===ze);Ee&&Jr.mutate({type:"turn_end",ts:Date.now(),who:ze,name:Ee.display_name})}Ze(M);const me=et.find(Ee=>Ee.id===M);me&&Jr.mutate({type:"turn_start",ts:Date.now(),who:M,name:me.display_name})},lt=()=>{if(!ze||!et||et.length===0)return;const M=et.findIndex(Ee=>Ee.id===ze),me=M+1;if(me<et.length)ct(et[me].id);else{const Ee=et[M];Ee&&Jr.mutate({type:"turn_end",ts:Date.now(),who:ze,name:Ee.display_name}),Ze(null)}},Ut=E.useMemo(()=>{const M=new Set(et.map(me=>me.character_id));return t.filter(me=>!M.has(me.id))},[t,et]),Fr=E.useMemo(()=>at==null?void 0:at.find(M=>M.id===k),[at,k]);if(!r)return a.jsx("div",{className:"p-4 text-center text-gray-600",children:a.jsx("p",{children:"Only the DM can view and manage encounter details."})});if(Ye||as)return a.jsx(He,{});if(pn||pr)return a.jsx(Ne,{message:(pn==null?void 0:pn.message)||(pr==null?void 0:pr.message)||"Error loading data"});const nt=tt;return a.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[a.jsx("div",{className:"sticky top-0 z-30 bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 p-4 shadow-sm rounded-lg",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Encounter"}),nt&&a.jsxs("div",{className:"text-sm text-gray-700 mt-1 flex items-center gap-3",children:[a.jsxs("span",{children:["Status: ",a.jsx("span",{className:`font-semibold ${nt.status==="active"?"text-green-600":nt.status==="planning"?"text-yellow-600":"text-blue-600"}`,children:nt.status})]}),nt.status==="active"&&nt.current_round>0&&a.jsxs("span",{children:["Round: ",a.jsx("span",{className:"font-semibold",children:nt.current_round})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{onClick:()=>f(!0),Icon:k4,variant:"secondary",children:"Encounters"}),a.jsx(U,{onClick:()=>s==null?void 0:s(),Icon:cs,variant:"outline",children:"Dice"}),a.jsx(U,{onClick:()=>g("create"),Icon:Gd,children:"New"}),(nt==null?void 0:nt.status)==="planning"&&a.jsx(U,{onClick:()=>rf.mutate(),Icon:R4,children:"Start"}),(nt==null?void 0:nt.status)==="active"&&a.jsxs(a.Fragment,{children:[a.jsx(U,{onClick:()=>yc.mutate(),Icon:F4,isLoading:yc.isPending,children:"Next Round"}),a.jsx(U,{onClick:()=>b(!0),Icon:Di,variant:"outline",children:"Reinforcements"}),a.jsx(U,{onClick:()=>nf.mutate(),Icon:RE,variant:"secondary",children:"End"})]})]})]})}),p==="create"?a.jsxs("form",{onSubmit:sf,className:"bg-white p-6 rounded-lg shadow space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create New Encounter"}),a.jsx("input",{type:"text",placeholder:"Encounter Name",value:i,onChange:M=>l(M.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md"}),a.jsx("textarea",{placeholder:"Description (optional)",value:o,onChange:M=>u(M.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{type:"submit",Icon:Gd,isLoading:Je.isPending,children:"Create Encounter"}),pt&&pt.length>0&&a.jsx(U,{variant:"secondary",onClick:()=>g("details"),children:"Cancel"})]})]}):ji||!nt?a.jsx(He,{}):se?a.jsx(Ne,{message:se.message}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:K?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:X,onChange:M=>N(M.target.value),className:"w-full px-3 py-2 border rounded-md text-xl font-semibold",placeholder:"Encounter Name"}),a.jsx("textarea",{value:V,onChange:M=>H(M.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md text-gray-600 mt-2",placeholder:"Description"}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(U,{size:"sm",onClick:()=>Xr.mutate({name:X,description:V}),isLoading:Xr.isPending,Icon:Qt,children:"Save"}),a.jsx(U,{size:"sm",variant:"secondary",onClick:()=>P(!1),Icon:dl,children:"Cancel"})]})]}):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:nt.name}),nt.description&&a.jsx("p",{className:"text-gray-600",children:nt.description})]}),a.jsx(U,{size:"sm",variant:"ghost",onClick:()=>P(!0),Icon:Sg,"aria-label":"Edit"})]}),a.jsxs("div",{className:"text-sm mt-2",children:["Status: ",a.jsx("span",{className:`font-medium ${nt.status==="active"?"text-green-600":"text-yellow-600"}`,children:nt.status}),nt.current_round>0&&nt.status==="active"&&a.jsxs("span",{className:"ml-3",children:["Round: ",nt.current_round]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("section",{className:"lg:col-span-3 space-y-4",children:nt.status==="planning"?a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow lg:sticky lg:top-24 self-start",children:[a.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Build the encounter"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h5",{className:"text-base font-medium flex items-center gap-2",children:[a.jsx(An,{className:"w-5 h-5"})," Add Combatants"]}),y!=="idle"&&a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>v("idle"),Icon:Dh,children:"Back"})]}),y==="idle"&&a.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2",children:[a.jsx(U,{onClick:()=>v("characters"),Icon:Cu,size:"lg",variant:"outline",children:"Add Party Members"}),a.jsx(U,{onClick:()=>v("monsters"),Icon:Di,size:"lg",variant:"outline",children:"Add Monsters"})]}),y==="characters"&&a.jsxs("div",{className:"space-y-3 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Party Members"}),a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto border rounded-md p-2 bg-gray-50",children:Ut.length>0?Ut.map(M=>a.jsxs("div",{className:"flex items-center gap-2 p-1 rounded hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",id:`member-${M.id}`,checked:w.includes(M.id),onChange:()=>of(M.id),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:`member-${M.id}`,className:"text-sm font-medium text-gray-800",children:M.name})]},M.id)):a.jsx("p",{className:"text-xs text-gray-500 p-2",children:"All party members have been added."})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:z,onChange:M=>O(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:cs,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Party Initiative",onRoll:M=>O(String(M.total))})})]}),a.jsxs(U,{onClick:bc,Icon:Cu,isLoading:Vt.isPending,disabled:w.length===0,children:["Add Members (",w.length,")"]})]}),y==="monsters"&&a.jsxs("div",{className:"space-y-2 animate-fade-in mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),at==null?void 0:at.map(M=>a.jsxs("option",{value:M.id,children:[M.name," ",M.category&&`(${M.category})`]},M.id))]}),Fr&&a.jsxs("div",{className:"space-y-2 text-xs text-gray-600 p-2 bg-gray-50 rounded border max-h-60 overflow-y-auto",children:[Fr.stats&&a.jsxs(a.Fragment,{children:[a.jsx("h6",{className:"font-bold text-gray-700",children:"Stats:"}),a.jsx(Z1,{stats:Fr.stats})]}),Fr.effectsSummary&&a.jsxs("div",{className:"mt-2 pt-2 border-t",children:[a.jsx("h6",{className:"font-bold text-gray-700",children:"Effects Summary:"}),a.jsx(J1,{text:Fr.effectsSummary,contextLabel:Fr.name})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:A,onChange:M=>R(M.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:L,onChange:M=>T(Math.max(1,parseInt(M.target.value)||1)),min:"1",className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:Y,onChange:M=>G(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:cs,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Monster Initiative",onRoll:M=>G(String(M.total))})})]}),a.jsxs(U,{onClick:vc,Icon:Di,isLoading:xn.isPending,disabled:!k,children:["Add Monster",L>1?`s (${L})`:""]})]})]}):a.jsxs("div",{className:"lg:sticky lg:top-24 self-start space-y-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("h4",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(EE,{className:"w-5 h-5"})," Temporary Notes"]}),a.jsx("textarea",{placeholder:"Use this space for temporary notes, conditions, or reminders...",value:Ct,onChange:M=>ot(M.target.value),rows:6,className:"w-full px-3 py-2 border rounded-md mt-2 text-sm"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Note: These notes are not saved with the encounter."})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Combat Log"}),a.jsx("div",{className:"max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:a.jsx(XB,{log:nt.log||[]})})]})]})}),a.jsxs("section",{className:"lg:col-span-5 space-y-4",children:[nt.status==="active"&&a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-400 p-4 rounded-lg shadow-md",children:[a.jsxs("h4",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(ac,{className:"w-5 h-5"})," Now Acting"]}),gt?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"text-xl font-bold mt-1",children:gt.display_name}),a.jsx(U,{size:"sm",Icon:c4,onClick:lt,children:"Next Turn"})]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[gt.monster_id&&Pa.get(gt.monster_id)&&a.jsx(U,{size:"sm",Icon:cs,variant:"danger_outline",onClick:()=>rt(gt.id,Pa.get(gt.monster_id)),children:"Roll Attack"}),a.jsx(U,{size:"sm",Icon:Yd,variant:"outline",onClick:()=>Ze(null),children:"Clear Actor"})]}),a.jsxs("div",{className:"mt-3 border-t pt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Combatant Stats:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded-md border",children:[a.jsx(ba,{className:"w-5 h-5 text-red-600"}),a.jsx("input",{type:"number",value:((en=B[gt.id])==null?void 0:en.current_hp)??"",onChange:M=>W(me=>({...me,[gt.id]:{...me[gt.id],current_hp:M.target.value}})),className:"w-20 px-2 py-1 border rounded-md text-sm font-semibold"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",gt.max_hp," HP"]}),a.jsx(U,{size:"sm",onClick:()=>Da(gt.id),Icon:Qt,isLoading:nr.isPending&&((is=nr.variables)==null?void 0:is.id)===gt.id,children:"Save"})]}),(Un==null?void 0:Un.stats)&&a.jsx("div",{className:"p-2 bg-gray-50 rounded-md border",children:a.jsx(Z1,{stats:Object.fromEntries(Object.entries(Un.stats).filter(([M])=>M!=="HP"))})})]})]}),(Un==null?void 0:Un.effectsSummary)&&a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700 mb-1",children:"Effects Summary:"}),a.jsx("div",{className:"text-sm p-2 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800",children:a.jsx(J1,{text:Un.effectsSummary,contextLabel:gt.display_name})})]})]}),gt.monster_id&&we[gt.id]&&a.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:we[gt.id].name}),a.jsx(X1,{description:we[gt.id].description,attackName:we[gt.id].name})]})]}):a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:et.length>0?"End of round. Ready for the next round.":"Add combatants to begin."})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-lg font-medium",children:"Turn Order"}),nt.status!=="completed"&&et.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"selectAll",checked:j.length===et.length&&et.length>0,onChange:M=>he(M.target.checked?et.map(me=>me.id):[])}),a.jsx("label",{htmlFor:"selectAll",className:"text-sm font-medium",children:"All"})]}),a.jsxs(U,{size:"sm",onClick:fe,Icon:cs,isLoading:_r.isPending,disabled:j.length===0,children:["Roll (",j.length,")"]}),a.jsx(U,{size:"sm",variant:J?"danger":"secondary",onClick:()=>{q(!J),Z(null)},Icon:n4,children:J?"Cancel Swap":"Swap"})]})]}),et.length===0?a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No combatants in the encounter yet."}):a.jsx("ul",{className:"divide-y divide-gray-200",children:et.map(M=>{var me;return a.jsxs("li",{className:`flex flex-wrap items-center justify-between py-2 px-2 -mx-2 rounded-md transition-all ${J?"cursor-pointer hover:bg-blue-50":"cursor-pointer"} ${$===M.id?"ring-2 ring-blue-500":""} ${ze===M.id?"bg-blue-100":""}`,onClick:()=>J?Se(M.id):ct(M.id),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",className:"ml-1",checked:j.includes(M.id),onChange:Ee=>{Ee.target.checked?he(Be=>[...Be,M.id]):he(Be=>Be.filter(dt=>dt!==M.id))},onClick:Ee=>Ee.stopPropagation()}),a.jsx("span",{className:"w-8 text-center text-lg font-bold text-gray-700",children:M.initiative_roll??"-"}),a.jsx("span",{className:"font-medium",children:M.display_name})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:Ee=>Ee.stopPropagation(),children:[a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((me=B[M.id])==null?void 0:me.initiative_roll)??"",onChange:Ee=>W(Be=>({...Be,[M.id]:{...Be[M.id],initiative_roll:Ee.target.value}})),placeholder:"Init"}),a.jsx(U,{size:"icon_sm",variant:"ghost",onClick:()=>s==null?void 0:s({dice:"1d20",label:`Initiative for ${M.display_name}`,onRoll:Ee=>W(Be=>({...Be,[M.id]:{...Be[M.id],initiative_roll:String(Ee.total)}}))}),children:a.jsx(cs,{className:"w-4 h-4"})}),a.jsx(U,{size:"icon_sm",onClick:()=>Da(M.id),children:a.jsx(Qt,{className:"w-4 h-4"})})]})]},M.id)})})]})]}),a.jsxs("section",{className:"lg:col-span-4 space-y-5",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-red-700",children:[a.jsx(Di,{className:"w-5 h-5"})," Monsters"]}),je?a.jsx(He,{}):Re?a.jsx(Ne,{message:Re.message}):et.filter(M=>M.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No monsters yet."}):et.filter(M=>M.monster_id).map(M=>{var dt,ie,Bt;const me=M.monster_id?Pa.get(M.monster_id.trim()):void 0,Ee=!!te[M.id],Be=we[M.id];return a.jsxs("article",{className:`border-l-4 rounded-r-lg shadow p-3 transition-all ${ze===M.id?"border-red-600 bg-red-50":"border-red-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-bold truncate",children:M.display_name}),a.jsx("p",{className:"text-xs text-red-800",children:(me==null?void 0:me.name)??"Monster"})]}),a.jsx(U,{size:"sm",variant:"danger",onClick:()=>Nt.mutate(M.id),Icon:cr,isLoading:Nt.isPending&&Nt.variables===M.id})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ba,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",value:((dt=B[M.id])==null?void 0:dt.current_hp)??"",onChange:Ur=>W(Fa=>({...Fa,[M.id]:{...Fa[M.id],current_hp:Ur.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_hp]})]}),a.jsx(U,{size:"sm",onClick:()=>Da(M.id),Icon:Qt,isLoading:nr.isPending&&((ie=nr.variables)==null?void 0:ie.id)===M.id})]}),a.jsxs("div",{className:"mt-3 border-t pt-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h5",{className:"font-semibold text-sm text-gray-700",children:"Attacks"}),a.jsxs(U,{size:"sm",variant:"ghost",onClick:()=>Le(M.id),children:[Ee?"Hide":"Show",Ee?a.jsx(u4,{className:"w-4 h-4 ml-1"}):a.jsx(Fh,{className:"w-4 h-4 ml-1"})]})]}),Ee&&a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsx(U,{size:"sm",Icon:cs,onClick:()=>me&&rt(M.id,me),disabled:!((Bt=me==null?void 0:me.attacks)!=null&&Bt.length),children:"Roll Attack"}),Be&&a.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-300 rounded text-sm",children:[a.jsx("p",{className:"font-bold text-yellow-900",children:Be.name}),a.jsx(X1,{description:Be.description,attackName:Be.name})]})]})]})]},M.id)})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2 text-blue-700",children:[a.jsx(An,{className:"w-5 h-5"})," Party"]}),je?a.jsx(He,{}):Re?a.jsx(Ne,{message:Re.message}):et.filter(M=>!M.monster_id).length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No party members yet."}):et.filter(M=>!M.monster_id).map(M=>{var me,Ee,Be;return a.jsxs("div",{className:`p-3 rounded-lg border-l-4 shadow transition-all ${ze===M.id?"border-blue-600 bg-blue-50":"border-blue-400 bg-white"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:M.display_name}),a.jsx("p",{className:"text-xs text-gray-600",children:"Player Character"})]}),a.jsx(U,{size:"sm",variant:"danger",onClick:()=>Nt.mutate(M.id),Icon:cr,isLoading:Nt.isPending&&Nt.variables===M.id})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ba,{className:"w-4 h-4 text-red-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((me=B[M.id])==null?void 0:me.current_hp)??"",onChange:dt=>W(ie=>({...ie,[M.id]:{...ie[M.id],current_hp:dt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_hp]})]}),M.max_wp!=null&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(In,{className:"w-4 h-4 text-yellow-600"}),a.jsx("input",{type:"number",className:"w-16 px-2 py-1 border rounded-md text-sm",value:((Ee=B[M.id])==null?void 0:Ee.current_wp)??"",onChange:dt=>W(ie=>({...ie,[M.id]:{...ie[M.id],current_wp:dt.target.value}}))}),a.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",M.max_wp]})]}),a.jsx(U,{size:"sm",onClick:()=>Da(M.id),Icon:Qt,isLoading:nr.isPending&&((Be=nr.variables)==null?void 0:Be.id)===M.id})]})]},M.id)})]})]})]}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[a.jsx(Di,{className:"w-5 h-5"})," Add Reinforcements"]}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>b(!1),Icon:dl,children:"Cancel"})]}),a.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add Monster"}),a.jsxs("select",{value:k,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),at==null?void 0:at.map(M=>a.jsxs("option",{value:M.id,children:[M.name," ",M.category&&`(${M.category})`]},M.id))]}),Fr&&a.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-gray-50 rounded border",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"HP:"})," ",((Ai=Fr.stats)==null?void 0:Ai.HP)||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Ferocity:"})," ",((Ma=Fr.stats)==null?void 0:Ma.FEROCITY)||"N/A"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:A,onChange:M=>R(M.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Count",value:L,onChange:M=>T(Math.max(1,parseInt(M.target.value)||1)),min:1,className:"px-3 py-2 border rounded-md"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:Y,onChange:M=>G(M.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(U,{type:"button",variant:"outline",Icon:cs,onClick:()=>s==null?void 0:s({dice:"1d20",label:"Reinforcement Initiative",onRoll:M=>G(String(M.total))})})]}),a.jsxs(U,{onClick:vc,Icon:Di,isLoading:xn.isPending,disabled:!k,className:"w-full",children:["Add Monster",L>1?`s (${L})`:""," to Fight"]})]})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl space-y-4 max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"All Encounters"}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>f(!1),Icon:dl,children:"Close"})]}),a.jsx("div",{className:"overflow-y-auto space-y-2 border-t pt-4",children:(pt??[]).map(M=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-md ${Ie===M.id?"bg-blue-100":"bg-gray-50"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:M.name}),a.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Status: ",M.status]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{size:"sm",onClick:()=>lf(M.id),disabled:Ie===M.id,children:"Select"}),a.jsx(U,{size:"sm",variant:"outline",Icon:Eg,onClick:()=>af(M.id,M.name),children:"Duplicate"}),a.jsx(U,{size:"sm",variant:"danger",Icon:cr,onClick:()=>gr.mutate(M.id),children:"Delete"})]})]},M.id))})]})})]})]})}async function eH(){const{data:e,error:t}=await re.from("bio_data").select("flaws").eq("name","WEAKNESS").single();if(t)throw console.error("Error fetching weaknesses:",t),new Error(t.message);return e}const tH=["Did the adventurers explore a new and dangerous location?","Did they overcome a demanding challenge (a monster, trap, or riddle)?","Did they complete an important part of the adventure?","Did they make a discovery that is vital to the story?","Did the player roleplay their character in an exemplary way?","Did the player actively engage with the world and its inhabitants?","Did the player have a good time and contribute to the fun?"],rH=[{title:"Be Generous",description:"Its better to award one too many than one too few. Keep the momentum going!"},{title:"Don't Punish",description:"Never withhold marks for character mistakes or failed rolls. Failure is part of the story."}];function nH({members:e,partyId:t}){const r=Zr(),[n,s]=E.useState(null),[i,l]=E.useState(""),[o,u]=E.useState(""),c=E.useMemo(()=>e.find(v=>v.id===i),[i,e]),{data:d,isLoading:h}=It({queryKey:["weaknesses"],queryFn:eH,enabled:n==="gaveIn"}),f=wt({mutationFn:({characterId:v,flaw:x})=>tN(v,{flaw:x}),onSuccess:()=>{r.invalidateQueries({queryKey:["party",t]}),s(null),l(""),u("")}}),p=()=>{i&&o&&f.mutate({characterId:i,flaw:o})},g=()=>{i&&f.mutate({characterId:i,flaw:null})},y=(d==null?void 0:d.flaws)||[];return a.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(Mh,{className:"w-12 h-12 mx-auto text-yellow-500"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mt-2",children:"Session End Cheatsheet"}),a.jsx("p",{className:"text-gray-600 mt-1",children:'Award one Advancement Mark for each "yes" to the questions below.'})]}),a.jsxs("div",{className:"mb-10",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2",children:[a.jsx(Kd,{className:"w-5 h-5 text-blue-600"}),"Advancement Questions"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:tH.map((v,x)=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mt-2 flex-shrink-0"}),a.jsx("p",{className:"text-gray-800",children:v})]},x))}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[a.jsx("p",{className:"text-gray-800 font-medium mb-3",children:"Did a character interact with their weakness?"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-3 border rounded-md flex-1 bg-white",children:[a.jsx("input",{type:"radio",name:"weaknessInteraction",className:"h-5 w-5 text-blue-600 focus:ring-blue-500",checked:n==="gaveIn",onChange:()=>s("gaveIn")}),a.jsx("span",{children:"Gave In to Weakness (1 Mark)"})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-3 border rounded-md flex-1 bg-white",children:[a.jsx("input",{type:"radio",name:"weaknessInteraction",className:"h-5 w-5 text-green-600 focus:ring-green-500",checked:n==="overcame",onChange:()=>s("overcame")}),a.jsx("span",{children:"Overcame Weakness (2 Marks)"})]})]}),n==="gaveIn"&&a.jsxs("div",{className:"mt-4 p-4 bg-white rounded-md border border-blue-200",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-4",children:"The character gains one advancement mark. You must assign them a new Flaw."}),h&&a.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[a.jsx(Yn,{className:"w-4 h-4 animate-spin"}),"Loading weaknesses..."]}),!h&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("select",{value:i,onChange:v=>l(v.target.value),className:"w-full p-2 border rounded-md bg-white shadow-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select Character..."}),e.map(v=>a.jsx("option",{value:v.id,children:v.name},v.id))]}),a.jsxs("select",{value:o,onChange:v=>u(v.target.value),className:"w-full p-2 border rounded-md bg-white shadow-sm md:col-span-2",children:[a.jsx("option",{value:"",disabled:!0,children:"Select New Flaw..."}),y.map(v=>a.jsx("option",{value:v,children:v},v))]})]}),a.jsx("button",{onClick:p,disabled:!i||!o||f.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-semibold hover:bg-blue-700 disabled:opacity-50",children:f.isPending?"Assigning...":"Assign Flaw"})]})]}),n==="overcame"&&a.jsxs("div",{className:"mt-4 p-4 bg-white rounded-md border border-green-300",children:[a.jsxs("div",{className:"text-sm text-gray-700 space-y-2 mb-4",children:[a.jsx("p",{children:a.jsx("strong",{children:"If you during the session acted in a way that clearly goes against your weakness, you get two advancement marks."})}),a.jsx("p",{children:"You have now also overcome your weakness and must remove it. You must then play a full session without a weakness. After that, you may choose a new weakness, preferably based on something that has occurred in the game."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("select",{value:i,onChange:v=>l(v.target.value),className:"w-full md:w-1/3 p-2 border rounded-md bg-white shadow-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select Character..."}),e.filter(v=>v.flaw).map(v=>a.jsx("option",{value:v.id,children:v.name},v.id))]}),(c==null?void 0:c.flaw)&&a.jsxs("p",{className:"text-sm text-gray-600",children:["Current Flaw to be removed: ",a.jsx("em",{className:"font-medium text-gray-800",children:c.flaw})]}),a.jsx("button",{onClick:g,disabled:!i||f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-md text-sm font-semibold hover:bg-green-700 disabled:opacity-50",children:f.isPending?"Removing...":"Remove Flaw"})]})]}),f.isSuccess&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-green-600",children:[a.jsx(sc,{className:"w-4 h-4"}),"Character updated successfully!"]}),f.error&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-red-600",children:[a.jsx(Dt,{className:"w-4 h-4"}),"Error: ",f.error.message]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2",children:[a.jsx(lc,{className:"w-5 h-5 text-yellow-500"}),"GM Principles"]}),a.jsx("div",{className:"space-y-4",children:rH.map((v,x)=>a.jsx("div",{children:a.jsxs("p",{className:"text-gray-800",children:[a.jsxs("span",{className:"font-bold",children:[v.title,":"]})," ",v.description]})},x))})]})]})}const S_=E.createContext(void 0);function T_(){const e=E.useContext(S_);if(!e)throw new Error("useDropdown must be used within a DropdownMenu");return e}function sH({children:e}){const[t,r]=E.useState(!1),n=E.useRef(null);return E.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&r(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),a.jsx(S_.Provider,{value:{isOpen:t,setIsOpen:r},children:a.jsx("div",{className:"relative inline-block text-left",ref:n,children:e})})}function aH({children:e}){const{isOpen:t,setIsOpen:r}=T_();return a.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),r(s=>!s)},className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-expanded":t,"aria-haspopup":"true",children:e||a.jsx(Ng,{className:"w-5 h-5"})})}function iH({children:e}){const{isOpen:t,setIsOpen:r}=T_();return t?a.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",children:a.jsx("div",{className:"py-1",role:"none",onClick:()=>r(!1),children:e})}):null}function ev({onSelect:e,children:t,className:r}){return a.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),e()},className:`flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 ${r}`,role:"menuitem",children:t})}function lH(){return a.jsx("div",{className:"border-t border-gray-100 my-1"})}function oH(){const{id:e}=pg(),t=fn(),{user:r,isDM:n}=qt(),s=Zr(),[i,l]=E.useState(!1),[o,u]=E.useState(null),[c,d]=E.useState(null),[h,f]=E.useState("members"),{data:p,isLoading:g,error:y}=It({queryKey:["party",e],queryFn:()=>FF(e),enabled:!!e}),v=wt({mutationFn:L=>{if(!e)throw new Error("Party ID is missing");return UF(e,L)},onSuccess:()=>{s.invalidateQueries({queryKey:["party",e]}),s.invalidateQueries({queryKey:["availableCharacters"]}),u(null),d(null)}}),x=wt({mutationFn:()=>{if(!e)throw new Error("Party ID is missing");return BF(e)},onSuccess:()=>{s.invalidateQueries({queryKey:["parties"]}),t("/adventure-party")}}),b=L=>{d(L),u("removeMember")},w=()=>{c&&v.mutate(c)},_=()=>{x.mutate()},k=r&&p&&r.id===p.created_by&&n(),S=p!=null&&p.invite_code?`${window.location.origin}/party/join/${p.invite_code}`:"";if(g)return a.jsx("div",{className:"flex justify-center items-center p-8",children:a.jsx(He,{size:"lg"})});if(y)return a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:y.message})});if(!p)return a.jsx("div",{className:"p-8",children:a.jsx(Ne,{message:"Party not found."})});const R=[{id:"members",label:"Members",icon:An},{id:"notes",label:"Notes",icon:A4},{id:"tasks",label:"Tasks",icon:EE},{id:"inventory",label:"Inventory",icon:vE},{id:"encounter",label:"Encounter",icon:Bh},{id:"sessionEnd",label:"Session End",icon:Mh,dmOnly:!0}].filter(L=>!L.dmOnly||k);return a.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[a.jsxs("div",{className:"bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:p.name}),a.jsx("p",{className:"text-gray-500 mt-1",children:"A band of brave adventurers."})]}),k&&a.jsx("div",{className:"mt-4 md:mt-0",children:a.jsxs(sH,{children:[a.jsx(aH,{children:a.jsx(U,{variant:"outline",size:"icon","aria-label":"Party Actions",children:a.jsx(Ng,{className:"h-5 w-5"})})}),a.jsxs(iH,{children:[a.jsxs(ev,{onSelect:()=>l(L=>!L),children:[a.jsx(Cu,{className:"w-4 h-4"}),"Invite Player"]}),a.jsx(lH,{}),a.jsxs(ev,{onSelect:()=>u("deleteParty"),className:"text-red-500 hover:text-red-700 hover:bg-red-50 focus:bg-red-50",children:[a.jsx(cr,{className:"w-4 h-4"}),"Delete Party"]})]})]})})]}),i&&k&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800",children:"Share this link to invite players:"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-white p-2 rounded-md",children:[a.jsx("input",{type:"text",readOnly:!0,value:S,className:"w-full bg-transparent text-gray-700 focus:outline-none"}),a.jsx(BB,{textToCopy:S})]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-6 px-6 overflow-x-auto","aria-label":"Tabs",children:R.map(L=>a.jsxs("button",{onClick:()=>f(L.id),className:`shrink-0 flex items-center gap-2 px-1 py-4 text-sm font-medium border-b-2 ${h===L.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(L.icon,{className:"w-5 h-5"}),L.label]},L.id))})}),a.jsxs("div",{className:"p-6",children:[h==="members"&&a.jsx("div",{className:"space-y-4",children:p.members.length>0?p.members.map(L=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-2 bg-gray-200 rounded-full",children:a.jsx(xi,{className:"w-6 h-6 text-gray-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:L.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[L.kin," ",L.profession]})]})]}),k&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"outline",size:"sm",onClick:()=>t(`/character/${L.id}`),"aria-label":`View ${L.name}'s sheet`,icon:_E,children:"View Sheet"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>b(L.id),"aria-label":`Remove ${L.name}`,children:a.jsx(eb,{className:"w-5 h-5 text-red-500"})})]})]},L.id)):a.jsx("p",{className:"text-center text-gray-500 py-8",children:"This party has no members yet. Invite someone!"})}),h==="notes"&&a.jsx(HB,{partyId:e,isDM:k}),h==="tasks"&&a.jsx(GB,{partyId:e,isDM:k}),h==="inventory"&&a.jsx(YB,{partyId:e,members:p.members,isDM:k}),h==="encounter"&&a.jsx(JB,{partyId:e,partyMembers:p.members,isDM:k}),h==="sessionEnd"&&a.jsx(nH,{members:p.members,partyId:e})]})]}),a.jsx(Wp,{isOpen:o==="removeMember",onClose:()=>u(null),onConfirm:w,title:"Remove Member",description:"Are you sure you want to remove this character from the party? This action cannot be undone.",confirmText:"Remove",isDestructive:!0,isLoading:v.isPending,icon:a.jsx(eb,{className:"w-6 h-6 text-red-500"})}),a.jsx(Wp,{isOpen:o==="deleteParty",onClose:()=>u(null),onConfirm:_,title:"Delete Party",description:"Are you sure you want to permanently delete this party? All members will be removed. This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:x.isPending,icon:a.jsx(AE,{className:"w-6 h-6 text-red-500"})})]})}function uH(){var p;const{inviteCode:e}=pg();console.log("Invite Code from URL:",e);const t=fn(),{user:r}=qt(),n=Zr(),[s,i]=E.useState(""),{data:l=[],isLoading:o,error:u}=It({queryKey:["availableCharacters",r==null?void 0:r.id],queryFn:()=>u_(r==null?void 0:r.id),enabled:!!r}),c=wt({mutationFn:async g=>{if(!g)throw new Error("Please select a character");if(!e)throw new Error("Invite code is missing");const{data:y,error:v}=await re.rpc("join_party_with_character",{p_invite_code:e,p_character_id:g});if(v)throw v.message.includes("invalid_invite_code")?new Error("This invite link is invalid or has expired."):v.message.includes("character_already_in_a_party")?new Error("This character is already in a party."):v.message.includes("user_already_in_party")?new Error("You are already a member of this party."):v;return y},onSuccess:g=>{const y=g==null?void 0:g.party_id;y?(n.invalidateQueries({queryKey:["parties"]}),n.invalidateQueries({queryKey:["party",y]}),n.invalidateQueries({queryKey:["availableCharacters",r==null?void 0:r.id]}),t(`/party/${y}`)):t("/adventure-party")}}),d=()=>{s&&c.mutate(s)},h=o,f=(u==null?void 0:u.message)||((p=c.error)==null?void 0:p.message);return h?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsx(He,{size:"lg"})}):f?a.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[a.jsx(Ne,{message:f}),a.jsx(U,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(An,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Join an Adventure"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"You've been invited to join a new party!"})]}),l.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-center text-gray-700",children:"Select one of your available characters to join with."}),a.jsx("div",{className:"space-y-3",children:l.map(g=>a.jsxs("div",{onClick:()=>i(g.id),className:`p-4 border rounded-lg cursor-pointer transition-all flex items-center justify-between ${s===g.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-500":"border-gray-200 hover:border-blue-400"}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:g.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[g.kin," ",g.profession]})]}),s===g.id&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx(Ka,{className:"w-4 h-4 text-white"})})]},g.id))}),a.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[a.jsx(U,{variant:"secondary",onClick:()=>t("/adventure-party"),children:"Cancel"}),a.jsx(U,{variant:"primary",loading:c.isPending,disabled:!s||c.isPending,onClick:d,children:"Join with Selected Character"})]})]}):a.jsxs("div",{className:"text-center py-8 border-t mt-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any available characters to join with."}),a.jsx(U,{variant:"primary",onClick:()=>t("/"),children:"Create a Character"})]})]})})}function cH(){return a.jsxs(a.Fragment,{children:[a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-white focus:text-blue-600",children:"Skip to main content"}),a.jsxs(Ty,{children:[a.jsx(tn,{path:"/login",element:a.jsx(DB,{})}),a.jsx(tn,{path:"*",element:a.jsx(UB,{children:a.jsxs(a.Fragment,{children:[a.jsx(l6,{}),a.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:a.jsxs(Ty,{children:[a.jsx(tn,{path:"/",element:a.jsx(W5,{})}),a.jsx(tn,{path:"/character/:id",element:a.jsx(HI,{})}),a.jsx(tn,{path:"/compendium",element:a.jsx(DF,{})}),a.jsx(tn,{path:"/adventure-party",element:a.jsx(HF,{})}),a.jsx(tn,{path:"/party/:id",element:a.jsx(oH,{})}),a.jsx(tn,{path:"/party/join/:inviteCode",element:a.jsx(uH,{})}),a.jsx(tn,{path:"/notes",element:a.jsx($F,{})}),a.jsx(tn,{path:"/settings",element:a.jsx(PB,{})}),a.jsx(tn,{path:"*",element:a.jsx(Wo,{to:"/",replace:!0})})]})}),a.jsx(FB,{}),a.jsx(oN,{})]})})})]})]})}function dH(){const{showWarning:e,extendSession:t}=t6();return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-amber-100 rounded-full",children:a.jsx(Uh,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Session Timeout Warning"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your session will expire in 30 seconds due to inactivity."})]})]}),a.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Dt,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-amber-700",children:'Click "Continue Session" to stay logged in, or your session will end automatically.'})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx(U,{variant:"primary",onClick:t,children:"Continue Session"})})]})}):null}function hH(){return a.jsx(Lj,{children:a.jsx(r6,{children:a.jsxs(P2,{client:FE,children:[a.jsx(Y4,{children:a.jsx(X4,{children:a.jsx(e6,{children:a.jsx(i6,{children:a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(cH,{}),a.jsx(dH,{})]})})})})}),!1]})})})}N2(document.getElementById("root")).render(a.jsx(E.StrictMode,{children:a.jsxs(P2,{client:FE,children:[" ",a.jsx(hH,{})]})}));export{dh as g};
