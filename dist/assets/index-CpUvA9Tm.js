var HN=Object.defineProperty;var pg=e=>{throw TypeError(e)};var $N=(e,t,r)=>t in e?HN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Wu=(e,t,r)=>$N(e,typeof t!="symbol"?t+"":t,r),_h=(e,t,r)=>t.has(e)||pg("Cannot "+r);var U=(e,t,r)=>(_h(e,t,"read from private field"),r?r.call(e):t.get(e)),ke=(e,t,r)=>t.has(e)?pg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),fe=(e,t,r,n)=>(_h(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Fe=(e,t,r)=>(_h(e,t,"access private method"),r);var Gu=(e,t,r,n)=>({set _(s){fe(e,t,s,r)},get _(){return U(e,t,n)}});function zN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var _r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Od(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qN(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var m1={exports:{}},Pd={},p1={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tu=Symbol.for("react.element"),VN=Symbol.for("react.portal"),WN=Symbol.for("react.fragment"),GN=Symbol.for("react.strict_mode"),YN=Symbol.for("react.profiler"),QN=Symbol.for("react.provider"),KN=Symbol.for("react.context"),ZN=Symbol.for("react.forward_ref"),XN=Symbol.for("react.suspense"),JN=Symbol.for("react.memo"),ek=Symbol.for("react.lazy"),gg=Symbol.iterator;function tk(e){return e===null||typeof e!="object"?null:(e=gg&&e[gg]||e["@@iterator"],typeof e=="function"?e:null)}var g1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x1=Object.assign,y1={};function El(e,t,r){this.props=e,this.context=t,this.refs=y1,this.updater=r||g1}El.prototype.isReactComponent={};El.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};El.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b1(){}b1.prototype=El.prototype;function Np(e,t,r){this.props=e,this.context=t,this.refs=y1,this.updater=r||g1}var kp=Np.prototype=new b1;kp.constructor=Np;x1(kp,El.prototype);kp.isPureReactComponent=!0;var xg=Array.isArray,v1=Object.prototype.hasOwnProperty,Sp={current:null},w1={key:!0,ref:!0,__self:!0,__source:!0};function E1(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)v1.call(t,n)&&!w1.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Tu,type:e,key:i,ref:l,props:s,_owner:Sp.current}}function rk(e,t){return{$$typeof:Tu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Tp(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tu}function nk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yg=/\/+/g;function Nh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nk(""+e.key):t.toString(36)}function Sc(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Tu:case VN:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+Nh(l,0):n,xg(s)?(r="",e!=null&&(r=e.replace(yg,"$&/")+"/"),Sc(s,t,r,"",function(c){return c})):s!=null&&(Tp(s)&&(s=rk(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(yg,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",xg(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+Nh(i,o);l+=Sc(i,t,r,u,s)}else if(u=tk(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+Nh(i,o++),l+=Sc(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Yu(e,t,r){if(e==null)return e;var n=[],s=0;return Sc(e,n,"","",function(i){return t.call(r,i,s++)}),n}function sk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var or={current:null},Tc={transition:null},ak={ReactCurrentDispatcher:or,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:Sp};function _1(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Yu,forEach:function(e,t,r){Yu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Yu(e,function(){t++}),t},toArray:function(e){return Yu(e,function(t){return t})||[]},only:function(e){if(!Tp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=El;Ve.Fragment=WN;Ve.Profiler=YN;Ve.PureComponent=Np;Ve.StrictMode=GN;Ve.Suspense=XN;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ak;Ve.act=_1;Ve.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=x1({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Sp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)v1.call(t,u)&&!w1.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Tu,type:e.type,key:s,ref:i,props:n,_owner:l}};Ve.createContext=function(e){return e={$$typeof:KN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:QN,_context:e},e.Consumer=e};Ve.createElement=E1;Ve.createFactory=function(e){var t=E1.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:ZN,render:e}};Ve.isValidElement=Tp;Ve.lazy=function(e){return{$$typeof:ek,_payload:{_status:-1,_result:e},_init:sk}};Ve.memo=function(e,t){return{$$typeof:JN,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=Tc.transition;Tc.transition={};try{e()}finally{Tc.transition=t}};Ve.unstable_act=_1;Ve.useCallback=function(e,t){return or.current.useCallback(e,t)};Ve.useContext=function(e){return or.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return or.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return or.current.useEffect(e,t)};Ve.useId=function(){return or.current.useId()};Ve.useImperativeHandle=function(e,t,r){return or.current.useImperativeHandle(e,t,r)};Ve.useInsertionEffect=function(e,t){return or.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return or.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return or.current.useMemo(e,t)};Ve.useReducer=function(e,t,r){return or.current.useReducer(e,t,r)};Ve.useRef=function(e){return or.current.useRef(e)};Ve.useState=function(e){return or.current.useState(e)};Ve.useSyncExternalStore=function(e,t,r){return or.current.useSyncExternalStore(e,t,r)};Ve.useTransition=function(){return or.current.useTransition()};Ve.version="18.3.1";p1.exports=Ve;var w=p1.exports;const Wr=Od(w),ik=zN({__proto__:null,default:Wr},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lk=w,ok=Symbol.for("react.element"),uk=Symbol.for("react.fragment"),ck=Object.prototype.hasOwnProperty,dk=lk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hk={key:!0,ref:!0,__self:!0,__source:!0};function N1(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)ck.call(t,n)&&!hk.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:ok,type:e,key:i,ref:l,props:s,_owner:dk.current}}Pd.Fragment=uk;Pd.jsx=N1;Pd.jsxs=N1;m1.exports=Pd;var a=m1.exports,k1={exports:{}},Dr={},S1={exports:{}},T1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,G){var k=M.length;M.push(G);e:for(;0<k;){var K=k-1>>>1,z=M[K];if(0<s(z,G))M[K]=G,M[k]=z,k=K;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var G=M[0],k=M.pop();if(k!==G){M[0]=k;e:for(var K=0,z=M.length,I=z>>>1;K<I;){var he=2*(K+1)-1,Ee=M[he],be=he+1,Z=M[be];if(0>s(Ee,k))be<z&&0>s(Z,Ee)?(M[K]=Z,M[be]=k,K=be):(M[K]=Ee,M[he]=k,K=he);else if(be<z&&0>s(Z,k))M[K]=Z,M[be]=k,K=be;else break e}}return G}function s(M,G){var k=M.sortIndex-G.sortIndex;return k!==0?k:M.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],d=1,h=null,f=3,p=!1,g=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=M)n(c),G.sortIndex=G.expirationTime,t(u,G);else break;G=r(c)}}function N(M){if(b=!1,v(M),!g)if(r(u)!==null)g=!0,B(_);else{var G=r(c);G!==null&&A(N,G.startTime-M)}}function _(M,G){g=!1,b&&(b=!1,x(j),j=-1),p=!0;var k=f;try{for(v(G),h=r(u);h!==null&&(!(h.expirationTime>G)||M&&!F());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var z=K(h.expirationTime<=G);G=e.unstable_now(),typeof z=="function"?h.callback=z:h===r(u)&&n(u),v(G)}else n(u);h=r(u)}if(h!==null)var I=!0;else{var he=r(c);he!==null&&A(N,he.startTime-G),I=!1}return I}finally{h=null,f=k,p=!1}}var S=!1,R=null,j=-1,D=5,T=-1;function F(){return!(e.unstable_now()-T<D)}function O(){if(R!==null){var M=e.unstable_now();T=M;var G=!0;try{G=R(!0,M)}finally{G?Q():(S=!1,R=null)}}else S=!1}var Q;if(typeof y=="function")Q=function(){y(O)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,H=Y.port2;Y.port1.onmessage=O,Q=function(){H.postMessage(null)}}else Q=function(){E(O,0)};function B(M){R=M,S||(S=!0,Q())}function A(M,G){j=E(function(){M(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,B(_))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var G=3;break;default:G=f}var k=f;f=G;try{return M()}finally{f=k}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,G){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var k=f;f=M;try{return G()}finally{f=k}},e.unstable_scheduleCallback=function(M,G,k){var K=e.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?K+k:K):k=K,M){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=k+z,M={id:d++,callback:G,priorityLevel:M,startTime:k,expirationTime:z,sortIndex:-1},k>K?(M.sortIndex=k,t(c,M),r(u)===null&&M===r(c)&&(b?(x(j),j=-1):b=!0,A(N,k-K))):(M.sortIndex=z,t(u,M),g||p||(g=!0,B(_))),M},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(M){var G=f;return function(){var k=f;f=G;try{return M.apply(this,arguments)}finally{f=k}}}})(T1);S1.exports=T1;var fk=S1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mk=w,Or=fk;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C1=new Set,Mo={};function si(e,t){al(e,t),al(e+"Capture",t)}function al(e,t){for(Mo[e]=t,e=0;e<t.length;e++)C1.add(t[e])}var ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Df=Object.prototype.hasOwnProperty,pk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bg={},vg={};function gk(e){return Df.call(vg,e)?!0:Df.call(bg,e)?!1:pk.test(e)?vg[e]=!0:(bg[e]=!0,!1)}function xk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yk(e,t,r,n){if(t===null||typeof t>"u"||xk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ur(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qt[e]=new ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qt[t]=new ur(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qt[e]=new ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qt[e]=new ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qt[e]=new ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qt[e]=new ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qt[e]=new ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qt[e]=new ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qt[e]=new ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var Cp=/[\-:]([a-z])/g;function jp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Cp,jp);qt[t]=new ur(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Cp,jp);qt[t]=new ur(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Cp,jp);qt[t]=new ur(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qt[e]=new ur(e,1,!1,e.toLowerCase(),null,!1,!1)});qt.xlinkHref=new ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qt[e]=new ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ap(e,t,r,n){var s=qt.hasOwnProperty(t)?qt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yk(t,r,s,n)&&(r=null),n||s===null?gk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var cs=mk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qu=Symbol.for("react.element"),yi=Symbol.for("react.portal"),bi=Symbol.for("react.fragment"),Ip=Symbol.for("react.strict_mode"),Mf=Symbol.for("react.profiler"),j1=Symbol.for("react.provider"),A1=Symbol.for("react.context"),Rp=Symbol.for("react.forward_ref"),Ff=Symbol.for("react.suspense"),Uf=Symbol.for("react.suspense_list"),Lp=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),I1=Symbol.for("react.offscreen"),wg=Symbol.iterator;function Ul(e){return e===null||typeof e!="object"?null:(e=wg&&e[wg]||e["@@iterator"],typeof e=="function"?e:null)}var bt=Object.assign,kh;function no(e){if(kh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);kh=t&&t[1]||""}return`
`+kh+e}var Sh=!1;function Th(e,t){if(!e||Sh)return"";Sh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{Sh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?no(e):""}function bk(e){switch(e.tag){case 5:return no(e.type);case 16:return no("Lazy");case 13:return no("Suspense");case 19:return no("SuspenseList");case 0:case 2:case 15:return e=Th(e.type,!1),e;case 11:return e=Th(e.type.render,!1),e;case 1:return e=Th(e.type,!0),e;default:return""}}function Bf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bi:return"Fragment";case yi:return"Portal";case Mf:return"Profiler";case Ip:return"StrictMode";case Ff:return"Suspense";case Uf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case A1:return(e.displayName||"Context")+".Consumer";case j1:return(e._context.displayName||"Context")+".Provider";case Rp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Lp:return t=e.displayName||null,t!==null?t:Bf(e.type)||"Memo";case ks:t=e._payload,e=e._init;try{return Bf(e(t))}catch{}}return null}function vk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bf(t);case 8:return t===Ip?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ta(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function R1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wk(e){var t=R1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ku(e){e._valueTracker||(e._valueTracker=wk(e))}function L1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=R1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function qc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Hf(e,t){var r=t.checked;return bt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Eg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ta(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function O1(e,t){t=t.checked,t!=null&&Ap(e,"checked",t,!1)}function $f(e,t){O1(e,t);var r=ta(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zf(e,t.type,r):t.hasOwnProperty("defaultValue")&&zf(e,t.type,ta(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _g(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function zf(e,t,r){(t!=="number"||qc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var so=Array.isArray;function Ri(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ta(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function qf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return bt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ng(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(le(92));if(so(r)){if(1<r.length)throw Error(le(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ta(r)}}function P1(e,t){var r=ta(t.value),n=ta(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function kg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function D1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?D1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zu,M1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zu=Zu||document.createElement("div"),Zu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ek=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){Ek.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function F1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function U1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=F1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var _k=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wf(e,t){if(t){if(_k[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function Gf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yf=null;function Op(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qf=null,Li=null,Oi=null;function Sg(e){if(e=Au(e)){if(typeof Qf!="function")throw Error(le(280));var t=e.stateNode;t&&(t=Bd(t),Qf(e.stateNode,e.type,t))}}function B1(e){Li?Oi?Oi.push(e):Oi=[e]:Li=e}function H1(){if(Li){var e=Li,t=Oi;if(Oi=Li=null,Sg(e),t)for(e=0;e<t.length;e++)Sg(t[e])}}function $1(e,t){return e(t)}function z1(){}var Ch=!1;function q1(e,t,r){if(Ch)return e(t,r);Ch=!0;try{return $1(e,t,r)}finally{Ch=!1,(Li!==null||Oi!==null)&&(z1(),H1())}}function Uo(e,t){var r=e.stateNode;if(r===null)return null;var n=Bd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(le(231,t,typeof r));return r}var Kf=!1;if(ns)try{var Bl={};Object.defineProperty(Bl,"passive",{get:function(){Kf=!0}}),window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{Kf=!1}function Nk(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var go=!1,Vc=null,Wc=!1,Zf=null,kk={onError:function(e){go=!0,Vc=e}};function Sk(e,t,r,n,s,i,l,o,u){go=!1,Vc=null,Nk.apply(kk,arguments)}function Tk(e,t,r,n,s,i,l,o,u){if(Sk.apply(this,arguments),go){if(go){var c=Vc;go=!1,Vc=null}else throw Error(le(198));Wc||(Wc=!0,Zf=c)}}function ai(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function V1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Tg(e){if(ai(e)!==e)throw Error(le(188))}function Ck(e){var t=e.alternate;if(!t){if(t=ai(e),t===null)throw Error(le(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Tg(s),e;if(i===n)return Tg(s),t;i=i.sibling}throw Error(le(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?e:t}function W1(e){return e=Ck(e),e!==null?G1(e):null}function G1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=G1(e);if(t!==null)return t;e=e.sibling}return null}var Y1=Or.unstable_scheduleCallback,Cg=Or.unstable_cancelCallback,jk=Or.unstable_shouldYield,Ak=Or.unstable_requestPaint,_t=Or.unstable_now,Ik=Or.unstable_getCurrentPriorityLevel,Pp=Or.unstable_ImmediatePriority,Q1=Or.unstable_UserBlockingPriority,Gc=Or.unstable_NormalPriority,Rk=Or.unstable_LowPriority,K1=Or.unstable_IdlePriority,Dd=null,In=null;function Lk(e){if(In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Dd,e,void 0,(e.current.flags&128)===128)}catch{}}var hn=Math.clz32?Math.clz32:Dk,Ok=Math.log,Pk=Math.LN2;function Dk(e){return e>>>=0,e===0?32:31-(Ok(e)/Pk|0)|0}var Xu=64,Ju=4194304;function ao(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=ao(o):(i&=l,i!==0&&(n=ao(i)))}else l=r&~s,l!==0?n=ao(l):i!==0&&(n=ao(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hn(t),s=1<<r,n|=e[r],t&=~s;return n}function Mk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-hn(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=Mk(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function Xf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Z1(){var e=Xu;return Xu<<=1,!(Xu&4194240)&&(Xu=64),e}function jh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Cu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hn(t),e[t]=r}function Uk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-hn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Dp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var nt=0;function X1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var J1,Mp,ev,tv,rv,Jf=!1,ec=[],Ws=null,Gs=null,Ys=null,Bo=new Map,Ho=new Map,js=[],Bk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jg(e,t){switch(e){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":Gs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":Bo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ho.delete(t.pointerId)}}function Hl(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Au(t),t!==null&&Mp(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Hk(e,t,r,n,s){switch(t){case"focusin":return Ws=Hl(Ws,e,t,r,n,s),!0;case"dragenter":return Gs=Hl(Gs,e,t,r,n,s),!0;case"mouseover":return Ys=Hl(Ys,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Bo.set(i,Hl(Bo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Ho.set(i,Hl(Ho.get(i)||null,e,t,r,n,s)),!0}return!1}function nv(e){var t=ja(e.target);if(t!==null){var r=ai(t);if(r!==null){if(t=r.tag,t===13){if(t=V1(r),t!==null){e.blockedOn=t,rv(e.priority,function(){ev(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=em(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Yf=n,r.target.dispatchEvent(n),Yf=null}else return t=Au(r),t!==null&&Mp(t),e.blockedOn=r,!1;t.shift()}return!0}function Ag(e,t,r){Cc(e)&&r.delete(t)}function $k(){Jf=!1,Ws!==null&&Cc(Ws)&&(Ws=null),Gs!==null&&Cc(Gs)&&(Gs=null),Ys!==null&&Cc(Ys)&&(Ys=null),Bo.forEach(Ag),Ho.forEach(Ag)}function $l(e,t){e.blockedOn===t&&(e.blockedOn=null,Jf||(Jf=!0,Or.unstable_scheduleCallback(Or.unstable_NormalPriority,$k)))}function $o(e){function t(s){return $l(s,e)}if(0<ec.length){$l(ec[0],e);for(var r=1;r<ec.length;r++){var n=ec[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ws!==null&&$l(Ws,e),Gs!==null&&$l(Gs,e),Ys!==null&&$l(Ys,e),Bo.forEach(t),Ho.forEach(t),r=0;r<js.length;r++)n=js[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<js.length&&(r=js[0],r.blockedOn===null);)nv(r),r.blockedOn===null&&js.shift()}var Pi=cs.ReactCurrentBatchConfig,Qc=!0;function zk(e,t,r,n){var s=nt,i=Pi.transition;Pi.transition=null;try{nt=1,Fp(e,t,r,n)}finally{nt=s,Pi.transition=i}}function qk(e,t,r,n){var s=nt,i=Pi.transition;Pi.transition=null;try{nt=4,Fp(e,t,r,n)}finally{nt=s,Pi.transition=i}}function Fp(e,t,r,n){if(Qc){var s=em(e,t,r,n);if(s===null)Uh(e,t,n,Kc,r),jg(e,n);else if(Hk(s,e,t,r,n))n.stopPropagation();else if(jg(e,n),t&4&&-1<Bk.indexOf(e)){for(;s!==null;){var i=Au(s);if(i!==null&&J1(i),i=em(e,t,r,n),i===null&&Uh(e,t,n,Kc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Uh(e,t,n,null,r)}}var Kc=null;function em(e,t,r,n){if(Kc=null,e=Op(n),e=ja(e),e!==null)if(t=ai(e),t===null)e=null;else if(r=t.tag,r===13){if(e=V1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kc=e,null}function sv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ik()){case Pp:return 1;case Q1:return 4;case Gc:case Rk:return 16;case K1:return 536870912;default:return 16}default:return 16}}var $s=null,Up=null,jc=null;function av(){if(jc)return jc;var e,t=Up,r=t.length,n,s="value"in $s?$s.value:$s.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return jc=s.slice(e,1<n?1-n:void 0)}function Ac(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function tc(){return!0}function Ig(){return!1}function Mr(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?tc:Ig,this.isPropagationStopped=Ig,this}return bt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=tc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=tc)},persist:function(){},isPersistent:tc}),t}var _l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bp=Mr(_l),ju=bt({},_l,{view:0,detail:0}),Vk=Mr(ju),Ah,Ih,zl,Md=bt({},ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zl&&(zl&&e.type==="mousemove"?(Ah=e.screenX-zl.screenX,Ih=e.screenY-zl.screenY):Ih=Ah=0,zl=e),Ah)},movementY:function(e){return"movementY"in e?e.movementY:Ih}}),Rg=Mr(Md),Wk=bt({},Md,{dataTransfer:0}),Gk=Mr(Wk),Yk=bt({},ju,{relatedTarget:0}),Rh=Mr(Yk),Qk=bt({},_l,{animationName:0,elapsedTime:0,pseudoElement:0}),Kk=Mr(Qk),Zk=bt({},_l,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xk=Mr(Zk),Jk=bt({},_l,{data:0}),Lg=Mr(Jk),eS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rS[e])?!!t[e]:!1}function Hp(){return nS}var sS=bt({},ju,{key:function(e){if(e.key){var t=eS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ac(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hp,charCode:function(e){return e.type==="keypress"?Ac(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ac(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),aS=Mr(sS),iS=bt({},Md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Og=Mr(iS),lS=bt({},ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hp}),oS=Mr(lS),uS=bt({},_l,{propertyName:0,elapsedTime:0,pseudoElement:0}),cS=Mr(uS),dS=bt({},Md,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),hS=Mr(dS),fS=[9,13,27,32],$p=ns&&"CompositionEvent"in window,xo=null;ns&&"documentMode"in document&&(xo=document.documentMode);var mS=ns&&"TextEvent"in window&&!xo,iv=ns&&(!$p||xo&&8<xo&&11>=xo),Pg=" ",Dg=!1;function lv(e,t){switch(e){case"keyup":return fS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ov(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vi=!1;function pS(e,t){switch(e){case"compositionend":return ov(t);case"keypress":return t.which!==32?null:(Dg=!0,Pg);case"textInput":return e=t.data,e===Pg&&Dg?null:e;default:return null}}function gS(e,t){if(vi)return e==="compositionend"||!$p&&lv(e,t)?(e=av(),jc=Up=$s=null,vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return iv&&t.locale!=="ko"?null:t.data;default:return null}}var xS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!xS[e.type]:t==="textarea"}function uv(e,t,r,n){B1(n),t=Zc(t,"onChange"),0<t.length&&(r=new Bp("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var yo=null,zo=null;function yS(e){vv(e,0)}function Fd(e){var t=_i(e);if(L1(t))return e}function bS(e,t){if(e==="change")return t}var cv=!1;if(ns){var Lh;if(ns){var Oh="oninput"in document;if(!Oh){var Fg=document.createElement("div");Fg.setAttribute("oninput","return;"),Oh=typeof Fg.oninput=="function"}Lh=Oh}else Lh=!1;cv=Lh&&(!document.documentMode||9<document.documentMode)}function Ug(){yo&&(yo.detachEvent("onpropertychange",dv),zo=yo=null)}function dv(e){if(e.propertyName==="value"&&Fd(zo)){var t=[];uv(t,zo,e,Op(e)),q1(yS,t)}}function vS(e,t,r){e==="focusin"?(Ug(),yo=t,zo=r,yo.attachEvent("onpropertychange",dv)):e==="focusout"&&Ug()}function wS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fd(zo)}function ES(e,t){if(e==="click")return Fd(t)}function _S(e,t){if(e==="input"||e==="change")return Fd(t)}function NS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var gn=typeof Object.is=="function"?Object.is:NS;function qo(e,t){if(gn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Df.call(t,s)||!gn(e[s],t[s]))return!1}return!0}function Bg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hg(e,t){var r=Bg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bg(r)}}function hv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fv(){for(var e=window,t=qc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=qc(e.document)}return t}function zp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function kS(e){var t=fv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hv(r.ownerDocument.documentElement,r)){if(n!==null&&zp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Hg(r,i);var l=Hg(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var SS=ns&&"documentMode"in document&&11>=document.documentMode,wi=null,tm=null,bo=null,rm=!1;function $g(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rm||wi==null||wi!==qc(n)||(n=wi,"selectionStart"in n&&zp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),bo&&qo(bo,n)||(bo=n,n=Zc(tm,"onSelect"),0<n.length&&(t=new Bp("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=wi)))}function rc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ei={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionend:rc("Transition","TransitionEnd")},Ph={},mv={};ns&&(mv=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);function Ud(e){if(Ph[e])return Ph[e];if(!Ei[e])return e;var t=Ei[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in mv)return Ph[e]=t[r];return e}var pv=Ud("animationend"),gv=Ud("animationiteration"),xv=Ud("animationstart"),yv=Ud("transitionend"),bv=new Map,zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oa(e,t){bv.set(e,t),si(t,[e])}for(var Dh=0;Dh<zg.length;Dh++){var Mh=zg[Dh],TS=Mh.toLowerCase(),CS=Mh[0].toUpperCase()+Mh.slice(1);oa(TS,"on"+CS)}oa(pv,"onAnimationEnd");oa(gv,"onAnimationIteration");oa(xv,"onAnimationStart");oa("dblclick","onDoubleClick");oa("focusin","onFocus");oa("focusout","onBlur");oa(yv,"onTransitionEnd");al("onMouseEnter",["mouseout","mouseover"]);al("onMouseLeave",["mouseout","mouseover"]);al("onPointerEnter",["pointerout","pointerover"]);al("onPointerLeave",["pointerout","pointerover"]);si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));si("onBeforeInput",["compositionend","keypress","textInput","paste"]);si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jS=new Set("cancel close invalid load scroll toggle".split(" ").concat(io));function qg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Tk(n,t,void 0,e),e.currentTarget=null}function vv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;qg(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;qg(s,o,c),i=u}}}if(Wc)throw e=Zf,Wc=!1,Zf=null,e}function ht(e,t){var r=t[lm];r===void 0&&(r=t[lm]=new Set);var n=e+"__bubble";r.has(n)||(wv(t,e,2,!1),r.add(n))}function Fh(e,t,r){var n=0;t&&(n|=4),wv(r,e,n,t)}var nc="_reactListening"+Math.random().toString(36).slice(2);function Vo(e){if(!e[nc]){e[nc]=!0,C1.forEach(function(r){r!=="selectionchange"&&(jS.has(r)||Fh(r,!1,e),Fh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nc]||(t[nc]=!0,Fh("selectionchange",!1,t))}}function wv(e,t,r,n){switch(sv(t)){case 1:var s=zk;break;case 4:s=qk;break;default:s=Fp}r=s.bind(null,t,r,e),s=void 0,!Kf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Uh(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=ja(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}q1(function(){var c=i,d=Op(r),h=[];e:{var f=bv.get(e);if(f!==void 0){var p=Bp,g=e;switch(e){case"keypress":if(Ac(r)===0)break e;case"keydown":case"keyup":p=aS;break;case"focusin":g="focus",p=Rh;break;case"focusout":g="blur",p=Rh;break;case"beforeblur":case"afterblur":p=Rh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Gk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=oS;break;case pv:case gv:case xv:p=Kk;break;case yv:p=cS;break;case"scroll":p=Vk;break;case"wheel":p=hS;break;case"copy":case"cut":case"paste":p=Xk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Og}var b=(t&4)!==0,E=!b&&e==="scroll",x=b?f!==null?f+"Capture":null:f;b=[];for(var y=c,v;y!==null;){v=y;var N=v.stateNode;if(v.tag===5&&N!==null&&(v=N,x!==null&&(N=Uo(y,x),N!=null&&b.push(Wo(y,N,v)))),E)break;y=y.return}0<b.length&&(f=new p(f,g,null,r,d),h.push({event:f,listeners:b}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==Yf&&(g=r.relatedTarget||r.fromElement)&&(ja(g)||g[ss]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?ja(g):null,g!==null&&(E=ai(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(b=Rg,N="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(b=Og,N="onPointerLeave",x="onPointerEnter",y="pointer"),E=p==null?f:_i(p),v=g==null?f:_i(g),f=new b(N,y+"leave",p,r,d),f.target=E,f.relatedTarget=v,N=null,ja(d)===c&&(b=new b(x,y+"enter",g,r,d),b.target=v,b.relatedTarget=E,N=b),E=N,p&&g)t:{for(b=p,x=g,y=0,v=b;v;v=ui(v))y++;for(v=0,N=x;N;N=ui(N))v++;for(;0<y-v;)b=ui(b),y--;for(;0<v-y;)x=ui(x),v--;for(;y--;){if(b===x||x!==null&&b===x.alternate)break t;b=ui(b),x=ui(x)}b=null}else b=null;p!==null&&Vg(h,f,p,b,!1),g!==null&&E!==null&&Vg(h,E,g,b,!0)}}e:{if(f=c?_i(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=bS;else if(Mg(f))if(cv)_=_S;else{_=wS;var S=vS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=ES);if(_&&(_=_(e,c))){uv(h,_,r,d);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&zf(f,"number",f.value)}switch(S=c?_i(c):window,e){case"focusin":(Mg(S)||S.contentEditable==="true")&&(wi=S,tm=c,bo=null);break;case"focusout":bo=tm=wi=null;break;case"mousedown":rm=!0;break;case"contextmenu":case"mouseup":case"dragend":rm=!1,$g(h,r,d);break;case"selectionchange":if(SS)break;case"keydown":case"keyup":$g(h,r,d)}var R;if($p)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else vi?lv(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(iv&&r.locale!=="ko"&&(vi||j!=="onCompositionStart"?j==="onCompositionEnd"&&vi&&(R=av()):($s=d,Up="value"in $s?$s.value:$s.textContent,vi=!0)),S=Zc(c,j),0<S.length&&(j=new Lg(j,e,null,r,d),h.push({event:j,listeners:S}),R?j.data=R:(R=ov(r),R!==null&&(j.data=R)))),(R=mS?pS(e,r):gS(e,r))&&(c=Zc(c,"onBeforeInput"),0<c.length&&(d=new Lg("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=R))}vv(h,t)})}function Wo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zc(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Uo(e,r),i!=null&&n.unshift(Wo(e,i,s)),i=Uo(e,t),i!=null&&n.push(Wo(e,i,s))),e=e.return}return n}function ui(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Vg(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=Uo(r,i),u!=null&&l.unshift(Wo(r,u,o))):s||(u=Uo(r,i),u!=null&&l.push(Wo(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var AS=/\r\n?/g,IS=/\u0000|\uFFFD/g;function Wg(e){return(typeof e=="string"?e:""+e).replace(AS,`
`).replace(IS,"")}function sc(e,t,r){if(t=Wg(t),Wg(e)!==t&&r)throw Error(le(425))}function Xc(){}var nm=null,sm=null;function am(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var im=typeof setTimeout=="function"?setTimeout:void 0,RS=typeof clearTimeout=="function"?clearTimeout:void 0,Gg=typeof Promise=="function"?Promise:void 0,LS=typeof queueMicrotask=="function"?queueMicrotask:typeof Gg<"u"?function(e){return Gg.resolve(null).then(e).catch(OS)}:im;function OS(e){setTimeout(function(){throw e})}function Bh(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),$o(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$o(t)}function Qs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Yg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Nl=Math.random().toString(36).slice(2),An="__reactFiber$"+Nl,Go="__reactProps$"+Nl,ss="__reactContainer$"+Nl,lm="__reactEvents$"+Nl,PS="__reactListeners$"+Nl,DS="__reactHandles$"+Nl;function ja(e){var t=e[An];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ss]||r[An]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Yg(e);e!==null;){if(r=e[An])return r;e=Yg(e)}return t}e=r,r=e.parentNode}return null}function Au(e){return e=e[An]||e[ss],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _i(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function Bd(e){return e[Go]||null}var om=[],Ni=-1;function ua(e){return{current:e}}function ft(e){0>Ni||(e.current=om[Ni],om[Ni]=null,Ni--)}function ut(e,t){Ni++,om[Ni]=e.current,e.current=t}var ra={},Kt=ua(ra),vr=ua(!1),Va=ra;function il(e,t){var r=e.type.contextTypes;if(!r)return ra;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function wr(e){return e=e.childContextTypes,e!=null}function Jc(){ft(vr),ft(Kt)}function Qg(e,t,r){if(Kt.current!==ra)throw Error(le(168));ut(Kt,t),ut(vr,r)}function Ev(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(le(108,vk(e)||"Unknown",s));return bt({},r,n)}function ed(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ra,Va=Kt.current,ut(Kt,e),ut(vr,vr.current),!0}function Kg(e,t,r){var n=e.stateNode;if(!n)throw Error(le(169));r?(e=Ev(e,t,Va),n.__reactInternalMemoizedMergedChildContext=e,ft(vr),ft(Kt),ut(Kt,e)):ft(vr),ut(vr,r)}var Gn=null,Hd=!1,Hh=!1;function _v(e){Gn===null?Gn=[e]:Gn.push(e)}function MS(e){Hd=!0,_v(e)}function ca(){if(!Hh&&Gn!==null){Hh=!0;var e=0,t=nt;try{var r=Gn;for(nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Gn=null,Hd=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(e+1)),Y1(Pp,ca),s}finally{nt=t,Hh=!1}}return null}var ki=[],Si=0,td=null,rd=0,Hr=[],$r=0,Wa=null,Xn=1,Jn="";function Ea(e,t){ki[Si++]=rd,ki[Si++]=td,td=e,rd=t}function Nv(e,t,r){Hr[$r++]=Xn,Hr[$r++]=Jn,Hr[$r++]=Wa,Wa=e;var n=Xn;e=Jn;var s=32-hn(n)-1;n&=~(1<<s),r+=1;var i=32-hn(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,Xn=1<<32-hn(t)+s|r<<s|n,Jn=i+e}else Xn=1<<i|r<<s|n,Jn=e}function qp(e){e.return!==null&&(Ea(e,1),Nv(e,1,0))}function Vp(e){for(;e===td;)td=ki[--Si],ki[Si]=null,rd=ki[--Si],ki[Si]=null;for(;e===Wa;)Wa=Hr[--$r],Hr[$r]=null,Jn=Hr[--$r],Hr[$r]=null,Xn=Hr[--$r],Hr[$r]=null}var Ir=null,Ar=null,pt=!1,un=null;function kv(e,t){var r=Vr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Zg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ir=e,Ar=Qs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ir=e,Ar=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Wa!==null?{id:Xn,overflow:Jn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Vr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ir=e,Ar=null,!0):!1;default:return!1}}function um(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cm(e){if(pt){var t=Ar;if(t){var r=t;if(!Zg(e,t)){if(um(e))throw Error(le(418));t=Qs(r.nextSibling);var n=Ir;t&&Zg(e,t)?kv(n,r):(e.flags=e.flags&-4097|2,pt=!1,Ir=e)}}else{if(um(e))throw Error(le(418));e.flags=e.flags&-4097|2,pt=!1,Ir=e}}}function Xg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ir=e}function ac(e){if(e!==Ir)return!1;if(!pt)return Xg(e),pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!am(e.type,e.memoizedProps)),t&&(t=Ar)){if(um(e))throw Sv(),Error(le(418));for(;t;)kv(e,t),t=Qs(t.nextSibling)}if(Xg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ar=Qs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ar=null}}else Ar=Ir?Qs(e.stateNode.nextSibling):null;return!0}function Sv(){for(var e=Ar;e;)e=Qs(e.nextSibling)}function ll(){Ar=Ir=null,pt=!1}function Wp(e){un===null?un=[e]:un.push(e)}var FS=cs.ReactCurrentBatchConfig;function ql(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,e))}return e}function ic(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Jg(e){var t=e._init;return t(e._payload)}function Tv(e){function t(x,y){if(e){var v=x.deletions;v===null?(x.deletions=[y],x.flags|=16):v.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=Js(x,y),x.index=0,x.sibling=null,x}function i(x,y,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<y?(x.flags|=2,y):v):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,v,N){return y===null||y.tag!==6?(y=Yh(v,x.mode,N),y.return=x,y):(y=s(y,v),y.return=x,y)}function u(x,y,v,N){var _=v.type;return _===bi?d(x,y,v.props.children,N,v.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ks&&Jg(_)===y.type)?(N=s(y,v.props),N.ref=ql(x,y,v),N.return=x,N):(N=Mc(v.type,v.key,v.props,null,x.mode,N),N.ref=ql(x,y,v),N.return=x,N)}function c(x,y,v,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=Qh(v,x.mode,N),y.return=x,y):(y=s(y,v.children||[]),y.return=x,y)}function d(x,y,v,N,_){return y===null||y.tag!==7?(y=$a(v,x.mode,N,_),y.return=x,y):(y=s(y,v),y.return=x,y)}function h(x,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Yh(""+y,x.mode,v),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Qu:return v=Mc(y.type,y.key,y.props,null,x.mode,v),v.ref=ql(x,null,y),v.return=x,v;case yi:return y=Qh(y,x.mode,v),y.return=x,y;case ks:var N=y._init;return h(x,N(y._payload),v)}if(so(y)||Ul(y))return y=$a(y,x.mode,v,null),y.return=x,y;ic(x,y)}return null}function f(x,y,v,N){var _=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:o(x,y,""+v,N);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Qu:return v.key===_?u(x,y,v,N):null;case yi:return v.key===_?c(x,y,v,N):null;case ks:return _=v._init,f(x,y,_(v._payload),N)}if(so(v)||Ul(v))return _!==null?null:d(x,y,v,N,null);ic(x,v)}return null}function p(x,y,v,N,_){if(typeof N=="string"&&N!==""||typeof N=="number")return x=x.get(v)||null,o(y,x,""+N,_);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Qu:return x=x.get(N.key===null?v:N.key)||null,u(y,x,N,_);case yi:return x=x.get(N.key===null?v:N.key)||null,c(y,x,N,_);case ks:var S=N._init;return p(x,y,v,S(N._payload),_)}if(so(N)||Ul(N))return x=x.get(v)||null,d(y,x,N,_,null);ic(y,N)}return null}function g(x,y,v,N){for(var _=null,S=null,R=y,j=y=0,D=null;R!==null&&j<v.length;j++){R.index>j?(D=R,R=null):D=R.sibling;var T=f(x,R,v[j],N);if(T===null){R===null&&(R=D);break}e&&R&&T.alternate===null&&t(x,R),y=i(T,y,j),S===null?_=T:S.sibling=T,S=T,R=D}if(j===v.length)return r(x,R),pt&&Ea(x,j),_;if(R===null){for(;j<v.length;j++)R=h(x,v[j],N),R!==null&&(y=i(R,y,j),S===null?_=R:S.sibling=R,S=R);return pt&&Ea(x,j),_}for(R=n(x,R);j<v.length;j++)D=p(R,x,j,v[j],N),D!==null&&(e&&D.alternate!==null&&R.delete(D.key===null?j:D.key),y=i(D,y,j),S===null?_=D:S.sibling=D,S=D);return e&&R.forEach(function(F){return t(x,F)}),pt&&Ea(x,j),_}function b(x,y,v,N){var _=Ul(v);if(typeof _!="function")throw Error(le(150));if(v=_.call(v),v==null)throw Error(le(151));for(var S=_=null,R=y,j=y=0,D=null,T=v.next();R!==null&&!T.done;j++,T=v.next()){R.index>j?(D=R,R=null):D=R.sibling;var F=f(x,R,T.value,N);if(F===null){R===null&&(R=D);break}e&&R&&F.alternate===null&&t(x,R),y=i(F,y,j),S===null?_=F:S.sibling=F,S=F,R=D}if(T.done)return r(x,R),pt&&Ea(x,j),_;if(R===null){for(;!T.done;j++,T=v.next())T=h(x,T.value,N),T!==null&&(y=i(T,y,j),S===null?_=T:S.sibling=T,S=T);return pt&&Ea(x,j),_}for(R=n(x,R);!T.done;j++,T=v.next())T=p(R,x,j,T.value,N),T!==null&&(e&&T.alternate!==null&&R.delete(T.key===null?j:T.key),y=i(T,y,j),S===null?_=T:S.sibling=T,S=T);return e&&R.forEach(function(O){return t(x,O)}),pt&&Ea(x,j),_}function E(x,y,v,N){if(typeof v=="object"&&v!==null&&v.type===bi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Qu:e:{for(var _=v.key,S=y;S!==null;){if(S.key===_){if(_=v.type,_===bi){if(S.tag===7){r(x,S.sibling),y=s(S,v.props.children),y.return=x,x=y;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ks&&Jg(_)===S.type){r(x,S.sibling),y=s(S,v.props),y.ref=ql(x,S,v),y.return=x,x=y;break e}r(x,S);break}else t(x,S);S=S.sibling}v.type===bi?(y=$a(v.props.children,x.mode,N,v.key),y.return=x,x=y):(N=Mc(v.type,v.key,v.props,null,x.mode,N),N.ref=ql(x,y,v),N.return=x,x=N)}return l(x);case yi:e:{for(S=v.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){r(x,y.sibling),y=s(y,v.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=Qh(v,x.mode,N),y.return=x,x=y}return l(x);case ks:return S=v._init,E(x,y,S(v._payload),N)}if(so(v))return g(x,y,v,N);if(Ul(v))return b(x,y,v,N);ic(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(r(x,y.sibling),y=s(y,v),y.return=x,x=y):(r(x,y),y=Yh(v,x.mode,N),y.return=x,x=y),l(x)):r(x,y)}return E}var ol=Tv(!0),Cv=Tv(!1),nd=ua(null),sd=null,Ti=null,Gp=null;function Yp(){Gp=Ti=sd=null}function Qp(e){var t=nd.current;ft(nd),e._currentValue=t}function dm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Di(e,t){sd=e,Gp=Ti=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(br=!0),e.firstContext=null)}function Yr(e){var t=e._currentValue;if(Gp!==e)if(e={context:e,memoizedValue:t,next:null},Ti===null){if(sd===null)throw Error(le(308));Ti=e,sd.dependencies={lanes:0,firstContext:e}}else Ti=Ti.next=e;return t}var Aa=null;function Kp(e){Aa===null?Aa=[e]:Aa.push(e)}function jv(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Kp(t)):(r.next=s.next,s.next=r),t.interleaved=r,as(e,n)}function as(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ss=!1;function Zp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Av(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function es(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ks(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xe&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,as(e,r)}return s=n.interleaved,s===null?(t.next=t,Kp(n)):(t.next=s.next,s.next=t),n.interleaved=t,as(e,r)}function Ic(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Dp(e,r)}}function ex(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ad(e,t,r,n){var s=e.updateQueue;Ss=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;l=0,d=c=u=null,o=i;do{var f=o.lane,p=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,b=o;switch(f=t,p=r,b.tag){case 1:if(g=b.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=bt({},h,f);break e;case 2:Ss=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=p,u=h):d=d.next=p,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ya|=l,e.lanes=l,e.memoizedState=h}}function tx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(le(191,s));s.call(n)}}}var Iu={},Rn=ua(Iu),Yo=ua(Iu),Qo=ua(Iu);function Ia(e){if(e===Iu)throw Error(le(174));return e}function Xp(e,t){switch(ut(Qo,t),ut(Yo,e),ut(Rn,Iu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vf(t,e)}ft(Rn),ut(Rn,t)}function ul(){ft(Rn),ft(Yo),ft(Qo)}function Iv(e){Ia(Qo.current);var t=Ia(Rn.current),r=Vf(t,e.type);t!==r&&(ut(Yo,e),ut(Rn,r))}function Jp(e){Yo.current===e&&(ft(Rn),ft(Yo))}var xt=ua(0);function id(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $h=[];function e0(){for(var e=0;e<$h.length;e++)$h[e]._workInProgressVersionPrimary=null;$h.length=0}var Rc=cs.ReactCurrentDispatcher,zh=cs.ReactCurrentBatchConfig,Ga=0,yt=null,At=null,Ft=null,ld=!1,vo=!1,Ko=0,US=0;function Vt(){throw Error(le(321))}function t0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!gn(e[r],t[r]))return!1;return!0}function r0(e,t,r,n,s,i){if(Ga=i,yt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rc.current=e===null||e.memoizedState===null?zS:qS,e=r(n,s),vo){i=0;do{if(vo=!1,Ko=0,25<=i)throw Error(le(301));i+=1,Ft=At=null,t.updateQueue=null,Rc.current=VS,e=r(n,s)}while(vo)}if(Rc.current=od,t=At!==null&&At.next!==null,Ga=0,Ft=At=yt=null,ld=!1,t)throw Error(le(300));return e}function n0(){var e=Ko!==0;return Ko=0,e}function _n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?yt.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function Qr(){if(At===null){var e=yt.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var t=Ft===null?yt.memoizedState:Ft.next;if(t!==null)Ft=t,At=e;else{if(e===null)throw Error(le(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Ft===null?yt.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function Zo(e,t){return typeof t=="function"?t(e):t}function qh(e){var t=Qr(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=At,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var d=c.lane;if((Ga&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,l=n):u=u.next=h,yt.lanes|=d,Ya|=d}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,gn(n,t.memoizedState)||(br=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,yt.lanes|=i,Ya|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vh(e){var t=Qr(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);gn(i,t.memoizedState)||(br=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Rv(){}function Lv(e,t){var r=yt,n=Qr(),s=t(),i=!gn(n.memoizedState,s);if(i&&(n.memoizedState=s,br=!0),n=n.queue,s0(Dv.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Ft!==null&&Ft.memoizedState.tag&1){if(r.flags|=2048,Xo(9,Pv.bind(null,r,n,s,t),void 0,null),Bt===null)throw Error(le(349));Ga&30||Ov(r,t,s)}return s}function Ov(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=yt.updateQueue,t===null?(t={lastEffect:null,stores:null},yt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Pv(e,t,r,n){t.value=r,t.getSnapshot=n,Mv(t)&&Fv(e)}function Dv(e,t,r){return r(function(){Mv(t)&&Fv(e)})}function Mv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!gn(e,r)}catch{return!0}}function Fv(e){var t=as(e,1);t!==null&&fn(t,e,1,-1)}function rx(e){var t=_n();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zo,lastRenderedState:e},t.queue=e,e=e.dispatch=$S.bind(null,yt,e),[t.memoizedState,e]}function Xo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=yt.updateQueue,t===null?(t={lastEffect:null,stores:null},yt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Uv(){return Qr().memoizedState}function Lc(e,t,r,n){var s=_n();yt.flags|=e,s.memoizedState=Xo(1|t,r,void 0,n===void 0?null:n)}function $d(e,t,r,n){var s=Qr();n=n===void 0?null:n;var i=void 0;if(At!==null){var l=At.memoizedState;if(i=l.destroy,n!==null&&t0(n,l.deps)){s.memoizedState=Xo(t,r,i,n);return}}yt.flags|=e,s.memoizedState=Xo(1|t,r,i,n)}function nx(e,t){return Lc(8390656,8,e,t)}function s0(e,t){return $d(2048,8,e,t)}function Bv(e,t){return $d(4,2,e,t)}function Hv(e,t){return $d(4,4,e,t)}function $v(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function zv(e,t,r){return r=r!=null?r.concat([e]):null,$d(4,4,$v.bind(null,t,e),r)}function a0(){}function qv(e,t){var r=Qr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&t0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Vv(e,t){var r=Qr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&t0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Wv(e,t,r){return Ga&21?(gn(r,t)||(r=Z1(),yt.lanes|=r,Ya|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,br=!0),e.memoizedState=r)}function BS(e,t){var r=nt;nt=r!==0&&4>r?r:4,e(!0);var n=zh.transition;zh.transition={};try{e(!1),t()}finally{nt=r,zh.transition=n}}function Gv(){return Qr().memoizedState}function HS(e,t,r){var n=Xs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Yv(e))Qv(t,r);else if(r=jv(e,t,r,n),r!==null){var s=ar();fn(r,e,n,s),Kv(r,t,n)}}function $S(e,t,r){var n=Xs(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yv(e))Qv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,gn(o,l)){var u=t.interleaved;u===null?(s.next=s,Kp(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=jv(e,t,s,n),r!==null&&(s=ar(),fn(r,e,n,s),Kv(r,t,n))}}function Yv(e){var t=e.alternate;return e===yt||t!==null&&t===yt}function Qv(e,t){vo=ld=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Kv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Dp(e,r)}}var od={readContext:Yr,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},zS={readContext:Yr,useCallback:function(e,t){return _n().memoizedState=[e,t===void 0?null:t],e},useContext:Yr,useEffect:nx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lc(4194308,4,$v.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lc(4,2,e,t)},useMemo:function(e,t){var r=_n();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=_n();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=HS.bind(null,yt,e),[n.memoizedState,e]},useRef:function(e){var t=_n();return e={current:e},t.memoizedState=e},useState:rx,useDebugValue:a0,useDeferredValue:function(e){return _n().memoizedState=e},useTransition:function(){var e=rx(!1),t=e[0];return e=BS.bind(null,e[1]),_n().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=yt,s=_n();if(pt){if(r===void 0)throw Error(le(407));r=r()}else{if(r=t(),Bt===null)throw Error(le(349));Ga&30||Ov(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,nx(Dv.bind(null,n,i,e),[e]),n.flags|=2048,Xo(9,Pv.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=_n(),t=Bt.identifierPrefix;if(pt){var r=Jn,n=Xn;r=(n&~(1<<32-hn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=US++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},qS={readContext:Yr,useCallback:qv,useContext:Yr,useEffect:s0,useImperativeHandle:zv,useInsertionEffect:Bv,useLayoutEffect:Hv,useMemo:Vv,useReducer:qh,useRef:Uv,useState:function(){return qh(Zo)},useDebugValue:a0,useDeferredValue:function(e){var t=Qr();return Wv(t,At.memoizedState,e)},useTransition:function(){var e=qh(Zo)[0],t=Qr().memoizedState;return[e,t]},useMutableSource:Rv,useSyncExternalStore:Lv,useId:Gv,unstable_isNewReconciler:!1},VS={readContext:Yr,useCallback:qv,useContext:Yr,useEffect:s0,useImperativeHandle:zv,useInsertionEffect:Bv,useLayoutEffect:Hv,useMemo:Vv,useReducer:Vh,useRef:Uv,useState:function(){return Vh(Zo)},useDebugValue:a0,useDeferredValue:function(e){var t=Qr();return At===null?t.memoizedState=e:Wv(t,At.memoizedState,e)},useTransition:function(){var e=Vh(Zo)[0],t=Qr().memoizedState;return[e,t]},useMutableSource:Rv,useSyncExternalStore:Lv,useId:Gv,unstable_isNewReconciler:!1};function nn(e,t){if(e&&e.defaultProps){t=bt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function hm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:bt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var zd={isMounted:function(e){return(e=e._reactInternals)?ai(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ar(),s=Xs(e),i=es(n,s);i.payload=t,r!=null&&(i.callback=r),t=Ks(e,i,s),t!==null&&(fn(t,e,s,n),Ic(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ar(),s=Xs(e),i=es(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ks(e,i,s),t!==null&&(fn(t,e,s,n),Ic(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ar(),n=Xs(e),s=es(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ks(e,s,n),t!==null&&(fn(t,e,n,r),Ic(t,e,n))}};function sx(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!qo(r,n)||!qo(s,i):!0}function Zv(e,t,r){var n=!1,s=ra,i=t.contextType;return typeof i=="object"&&i!==null?i=Yr(i):(s=wr(t)?Va:Kt.current,n=t.contextTypes,i=(n=n!=null)?il(e,s):ra),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function ax(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&zd.enqueueReplaceState(t,t.state,null)}function fm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Zp(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Yr(i):(i=wr(t)?Va:Kt.current,s.context=il(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(hm(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&zd.enqueueReplaceState(s,s.state,null),ad(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function cl(e,t){try{var r="",n=t;do r+=bk(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Wh(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function mm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var WS=typeof WeakMap=="function"?WeakMap:Map;function Xv(e,t,r){r=es(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){cd||(cd=!0,Nm=n),mm(e,t)},r}function Jv(e,t,r){r=es(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){mm(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){mm(e,t),typeof n!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function ix(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new WS;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=iT.bind(null,e,t,r),t.then(e,e))}function lx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ox(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=es(-1,1),t.tag=2,Ks(r,t,1))),r.lanes|=1),e)}var GS=cs.ReactCurrentOwner,br=!1;function nr(e,t,r,n){t.child=e===null?Cv(t,null,r,n):ol(t,e.child,r,n)}function ux(e,t,r,n,s){r=r.render;var i=t.ref;return Di(t,s),n=r0(e,t,r,n,i,s),r=n0(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,is(e,t,s)):(pt&&r&&qp(t),t.flags|=1,nr(e,t,n,s),t.child)}function cx(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!f0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,ew(e,t,i,n,s)):(e=Mc(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:qo,r(l,n)&&e.ref===t.ref)return is(e,t,s)}return t.flags|=1,e=Js(i,n),e.ref=t.ref,e.return=t,t.child=e}function ew(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(qo(i,n)&&e.ref===t.ref)if(br=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(br=!0);else return t.lanes=e.lanes,is(e,t,s)}return pm(e,t,r,n,s)}function tw(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(ji,Tr),Tr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ut(ji,Tr),Tr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ut(ji,Tr),Tr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ut(ji,Tr),Tr|=n;return nr(e,t,s,r),t.child}function rw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function pm(e,t,r,n,s){var i=wr(r)?Va:Kt.current;return i=il(t,i),Di(t,s),r=r0(e,t,r,n,i,s),n=n0(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,is(e,t,s)):(pt&&n&&qp(t),t.flags|=1,nr(e,t,r,s),t.child)}function dx(e,t,r,n,s){if(wr(r)){var i=!0;ed(t)}else i=!1;if(Di(t,s),t.stateNode===null)Oc(e,t),Zv(t,r,n),fm(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=Yr(c):(c=wr(r)?Va:Kt.current,c=il(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&ax(t,l,n,c),Ss=!1;var f=t.memoizedState;l.state=f,ad(t,n,l,s),u=t.memoizedState,o!==n||f!==u||vr.current||Ss?(typeof d=="function"&&(hm(t,r,d,n),u=t.memoizedState),(o=Ss||sx(t,r,o,n,f,u,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Av(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:nn(t.type,o),l.props=c,h=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=Yr(u):(u=wr(r)?Va:Kt.current,u=il(t,u));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==u)&&ax(t,l,n,u),Ss=!1,f=t.memoizedState,l.state=f,ad(t,n,l,s);var g=t.memoizedState;o!==h||f!==g||vr.current||Ss?(typeof p=="function"&&(hm(t,r,p,n),g=t.memoizedState),(c=Ss||sx(t,r,c,n,f,g,u)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return gm(e,t,r,n,i,s)}function gm(e,t,r,n,s,i){rw(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&Kg(t,r,!1),is(e,t,i);n=t.stateNode,GS.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=ol(t,e.child,null,i),t.child=ol(t,null,o,i)):nr(e,t,o,i),t.memoizedState=n.state,s&&Kg(t,r,!0),t.child}function nw(e){var t=e.stateNode;t.pendingContext?Qg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qg(e,t.context,!1),Xp(e,t.containerInfo)}function hx(e,t,r,n,s){return ll(),Wp(s),t.flags|=256,nr(e,t,r,n),t.child}var xm={dehydrated:null,treeContext:null,retryLane:0};function ym(e){return{baseLanes:e,cachePool:null,transitions:null}}function sw(e,t,r){var n=t.pendingProps,s=xt.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ut(xt,s&1),e===null)return cm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Wd(l,n,0,null),e=$a(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=ym(r),t.memoizedState=xm,e):i0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return YS(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Js(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Js(o,i):(i=$a(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?ym(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=xm,n}return i=e.child,e=i.sibling,n=Js(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function i0(e,t){return t=Wd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function lc(e,t,r,n){return n!==null&&Wp(n),ol(t,e.child,null,r),e=i0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function YS(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=Wh(Error(le(422))),lc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Wd({mode:"visible",children:n.children},s,0,null),i=$a(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ol(t,e.child,null,l),t.child.memoizedState=ym(l),t.memoizedState=xm,i);if(!(t.mode&1))return lc(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(le(419)),n=Wh(i,n,void 0),lc(e,t,l,n)}if(o=(l&e.childLanes)!==0,br||o){if(n=Bt,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,as(e,s),fn(n,e,s,-1))}return h0(),n=Wh(Error(le(421))),lc(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=lT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Ar=Qs(s.nextSibling),Ir=t,pt=!0,un=null,e!==null&&(Hr[$r++]=Xn,Hr[$r++]=Jn,Hr[$r++]=Wa,Xn=e.id,Jn=e.overflow,Wa=t),t=i0(t,n.children),t.flags|=4096,t)}function fx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),dm(e.return,t,r)}function Gh(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function aw(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(nr(e,t,n.children,r),n=xt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&fx(e,r,t);else if(e.tag===19)fx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ut(xt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&id(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Gh(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&id(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Gh(t,!0,r,null,i);break;case"together":Gh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Oc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function is(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ya|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,r=Js(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Js(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function QS(e,t,r){switch(t.tag){case 3:nw(t),ll();break;case 5:Iv(t);break;case 1:wr(t.type)&&ed(t);break;case 4:Xp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ut(nd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ut(xt,xt.current&1),t.flags|=128,null):r&t.child.childLanes?sw(e,t,r):(ut(xt,xt.current&1),e=is(e,t,r),e!==null?e.sibling:null);ut(xt,xt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return aw(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ut(xt,xt.current),n)break;return null;case 22:case 23:return t.lanes=0,tw(e,t,r)}return is(e,t,r)}var iw,bm,lw,ow;iw=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bm=function(){};lw=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ia(Rn.current);var i=null;switch(r){case"input":s=Hf(e,s),n=Hf(e,n),i=[];break;case"select":s=bt({},s,{value:void 0}),n=bt({},n,{value:void 0}),i=[];break;case"textarea":s=qf(e,s),n=qf(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Xc)}Wf(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Mo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Mo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&ht("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};ow=function(e,t,r,n){r!==n&&(t.flags|=4)};function Vl(e,t){if(!pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function KS(e,t,r){var n=t.pendingProps;switch(Vp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(t),null;case 1:return wr(t.type)&&Jc(),Wt(t),null;case 3:return n=t.stateNode,ul(),ft(vr),ft(Kt),e0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ac(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,un!==null&&(Tm(un),un=null))),bm(e,t),Wt(t),null;case 5:Jp(t);var s=Ia(Qo.current);if(r=t.type,e!==null&&t.stateNode!=null)lw(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(le(166));return Wt(t),null}if(e=Ia(Rn.current),ac(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[An]=t,n[Go]=i,e=(t.mode&1)!==0,r){case"dialog":ht("cancel",n),ht("close",n);break;case"iframe":case"object":case"embed":ht("load",n);break;case"video":case"audio":for(s=0;s<io.length;s++)ht(io[s],n);break;case"source":ht("error",n);break;case"img":case"image":case"link":ht("error",n),ht("load",n);break;case"details":ht("toggle",n);break;case"input":Eg(n,i),ht("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ht("invalid",n);break;case"textarea":Ng(n,i),ht("invalid",n)}Wf(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&sc(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&sc(n.textContent,o,e),s=["children",""+o]):Mo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&ht("scroll",n)}switch(r){case"input":Ku(n),_g(n,i,!0);break;case"textarea":Ku(n),kg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Xc)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=D1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[An]=t,e[Go]=n,iw(e,t,!1,!1),t.stateNode=e;e:{switch(l=Gf(r,n),r){case"dialog":ht("cancel",e),ht("close",e),s=n;break;case"iframe":case"object":case"embed":ht("load",e),s=n;break;case"video":case"audio":for(s=0;s<io.length;s++)ht(io[s],e);s=n;break;case"source":ht("error",e),s=n;break;case"img":case"image":case"link":ht("error",e),ht("load",e),s=n;break;case"details":ht("toggle",e),s=n;break;case"input":Eg(e,n),s=Hf(e,n),ht("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=bt({},n,{value:void 0}),ht("invalid",e);break;case"textarea":Ng(e,n),s=qf(e,n),ht("invalid",e);break;default:s=n}Wf(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?U1(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&M1(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Fo(e,u):typeof u=="number"&&Fo(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Mo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ht("scroll",e):u!=null&&Ap(e,i,u,l))}switch(r){case"input":Ku(e),_g(e,n,!1);break;case"textarea":Ku(e),kg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ta(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ri(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ri(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Xc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Wt(t),null;case 6:if(e&&t.stateNode!=null)ow(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(le(166));if(r=Ia(Qo.current),Ia(Rn.current),ac(t)){if(n=t.stateNode,r=t.memoizedProps,n[An]=t,(i=n.nodeValue!==r)&&(e=Ir,e!==null))switch(e.tag){case 3:sc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&sc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[An]=t,t.stateNode=n}return Wt(t),null;case 13:if(ft(xt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pt&&Ar!==null&&t.mode&1&&!(t.flags&128))Sv(),ll(),t.flags|=98560,i=!1;else if(i=ac(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(le(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[An]=t}else ll(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Wt(t),i=!1}else un!==null&&(Tm(un),un=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||xt.current&1?Rt===0&&(Rt=3):h0())),t.updateQueue!==null&&(t.flags|=4),Wt(t),null);case 4:return ul(),bm(e,t),e===null&&Vo(t.stateNode.containerInfo),Wt(t),null;case 10:return Qp(t.type._context),Wt(t),null;case 17:return wr(t.type)&&Jc(),Wt(t),null;case 19:if(ft(xt),i=t.memoizedState,i===null)return Wt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Vl(i,!1);else{if(Rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=id(e),l!==null){for(t.flags|=128,Vl(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ut(xt,xt.current&1|2),t.child}e=e.sibling}i.tail!==null&&_t()>dl&&(t.flags|=128,n=!0,Vl(i,!1),t.lanes=4194304)}else{if(!n)if(e=id(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Vl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!pt)return Wt(t),null}else 2*_t()-i.renderingStartTime>dl&&r!==1073741824&&(t.flags|=128,n=!0,Vl(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=_t(),t.sibling=null,r=xt.current,ut(xt,n?r&1|2:r&1),t):(Wt(t),null);case 22:case 23:return d0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Tr&1073741824&&(Wt(t),t.subtreeFlags&6&&(t.flags|=8192)):Wt(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function ZS(e,t){switch(Vp(t),t.tag){case 1:return wr(t.type)&&Jc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ul(),ft(vr),ft(Kt),e0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Jp(t),null;case 13:if(ft(xt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));ll()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ft(xt),null;case 4:return ul(),null;case 10:return Qp(t.type._context),null;case 22:case 23:return d0(),null;case 24:return null;default:return null}}var oc=!1,Yt=!1,XS=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Ci(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){wt(e,t,n)}else r.current=null}function vm(e,t,r){try{r()}catch(n){wt(e,t,n)}}var mx=!1;function JS(e,t){if(nm=Qc,e=fv(),zp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=l+s),h!==i||n!==0&&h.nodeType!==3||(u=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++d===n&&(u=l),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(sm={focusedElem:e,selectionRange:r},Qc=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var b=g.memoizedProps,E=g.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?b:nn(t.type,b),E);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(N){wt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return g=mx,mx=!1,g}function wo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&vm(t,r,i)}s=s.next}while(s!==n)}}function qd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function wm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function uw(e){var t=e.alternate;t!==null&&(e.alternate=null,uw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[An],delete t[Go],delete t[lm],delete t[PS],delete t[DS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cw(e){return e.tag===5||e.tag===3||e.tag===4}function px(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Em(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Xc));else if(n!==4&&(e=e.child,e!==null))for(Em(e,t,r),e=e.sibling;e!==null;)Em(e,t,r),e=e.sibling}function _m(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(_m(e,t,r),e=e.sibling;e!==null;)_m(e,t,r),e=e.sibling}var Ht=null,ln=!1;function gs(e,t,r){for(r=r.child;r!==null;)dw(e,t,r),r=r.sibling}function dw(e,t,r){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Dd,r)}catch{}switch(r.tag){case 5:Yt||Ci(r,t);case 6:var n=Ht,s=ln;Ht=null,gs(e,t,r),Ht=n,ln=s,Ht!==null&&(ln?(e=Ht,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ht.removeChild(r.stateNode));break;case 18:Ht!==null&&(ln?(e=Ht,r=r.stateNode,e.nodeType===8?Bh(e.parentNode,r):e.nodeType===1&&Bh(e,r),$o(e)):Bh(Ht,r.stateNode));break;case 4:n=Ht,s=ln,Ht=r.stateNode.containerInfo,ln=!0,gs(e,t,r),Ht=n,ln=s;break;case 0:case 11:case 14:case 15:if(!Yt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&vm(r,t,l),s=s.next}while(s!==n)}gs(e,t,r);break;case 1:if(!Yt&&(Ci(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){wt(r,t,o)}gs(e,t,r);break;case 21:gs(e,t,r);break;case 22:r.mode&1?(Yt=(n=Yt)||r.memoizedState!==null,gs(e,t,r),Yt=n):gs(e,t,r);break;default:gs(e,t,r)}}function gx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new XS),t.forEach(function(n){var s=oT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function rn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Ht=o.stateNode,ln=!1;break e;case 3:Ht=o.stateNode.containerInfo,ln=!0;break e;case 4:Ht=o.stateNode.containerInfo,ln=!0;break e}o=o.return}if(Ht===null)throw Error(le(160));dw(i,l,s),Ht=null,ln=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){wt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)hw(t,e),t=t.sibling}function hw(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),wn(e),n&4){try{wo(3,e,e.return),qd(3,e)}catch(b){wt(e,e.return,b)}try{wo(5,e,e.return)}catch(b){wt(e,e.return,b)}}break;case 1:rn(t,e),wn(e),n&512&&r!==null&&Ci(r,r.return);break;case 5:if(rn(t,e),wn(e),n&512&&r!==null&&Ci(r,r.return),e.flags&32){var s=e.stateNode;try{Fo(s,"")}catch(b){wt(e,e.return,b)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&O1(s,i),Gf(o,l);var c=Gf(o,i);for(l=0;l<u.length;l+=2){var d=u[l],h=u[l+1];d==="style"?U1(s,h):d==="dangerouslySetInnerHTML"?M1(s,h):d==="children"?Fo(s,h):Ap(s,d,h,c)}switch(o){case"input":$f(s,i);break;case"textarea":P1(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ri(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ri(s,!!i.multiple,i.defaultValue,!0):Ri(s,!!i.multiple,i.multiple?[]:"",!1))}s[Go]=i}catch(b){wt(e,e.return,b)}}break;case 6:if(rn(t,e),wn(e),n&4){if(e.stateNode===null)throw Error(le(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){wt(e,e.return,b)}}break;case 3:if(rn(t,e),wn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(b){wt(e,e.return,b)}break;case 4:rn(t,e),wn(e);break;case 13:rn(t,e),wn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(u0=_t())),n&4&&gx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Yt=(c=Yt)||d,rn(t,e),Yt=c):rn(t,e),wn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(xe=e,d=e.child;d!==null;){for(h=xe=d;xe!==null;){switch(f=xe,p=f.child,f.tag){case 0:case 11:case 14:case 15:wo(4,f,f.return);break;case 1:Ci(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(b){wt(n,r,b)}}break;case 5:Ci(f,f.return);break;case 22:if(f.memoizedState!==null){yx(h);continue}}p!==null?(p.return=f,xe=p):yx(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,u=h.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=F1("display",l))}catch(b){wt(e,e.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){wt(e,e.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rn(t,e),wn(e),n&4&&gx(e);break;case 21:break;default:rn(t,e),wn(e)}}function wn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(cw(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Fo(s,""),n.flags&=-33);var i=px(e);_m(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=px(e);Em(e,o,l);break;default:throw Error(le(161))}}catch(u){wt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function eT(e,t,r){xe=e,fw(e)}function fw(e,t,r){for(var n=(e.mode&1)!==0;xe!==null;){var s=xe,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||oc;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||Yt;o=oc;var c=Yt;if(oc=l,(Yt=u)&&!c)for(xe=s;xe!==null;)l=xe,u=l.child,l.tag===22&&l.memoizedState!==null?bx(s):u!==null?(u.return=l,xe=u):bx(s);for(;i!==null;)xe=i,fw(i),i=i.sibling;xe=s,oc=o,Yt=c}xx(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,xe=i):xx(e)}}function xx(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yt||qd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Yt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:nn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&tx(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}tx(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&$o(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Yt||t.flags&512&&wm(t)}catch(f){wt(t,t.return,f)}}if(t===e){xe=null;break}if(r=t.sibling,r!==null){r.return=t.return,xe=r;break}xe=t.return}}function yx(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,xe=r;break}xe=t.return}}function bx(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{qd(4,t)}catch(u){wt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){wt(t,s,u)}}var i=t.return;try{wm(t)}catch(u){wt(t,i,u)}break;case 5:var l=t.return;try{wm(t)}catch(u){wt(t,l,u)}}}catch(u){wt(t,t.return,u)}if(t===e){xe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,xe=o;break}xe=t.return}}var tT=Math.ceil,ud=cs.ReactCurrentDispatcher,l0=cs.ReactCurrentOwner,Gr=cs.ReactCurrentBatchConfig,Xe=0,Bt=null,Ct=null,$t=0,Tr=0,ji=ua(0),Rt=0,Jo=null,Ya=0,Vd=0,o0=0,Eo=null,xr=null,u0=0,dl=1/0,Vn=null,cd=!1,Nm=null,Zs=null,uc=!1,zs=null,dd=0,_o=0,km=null,Pc=-1,Dc=0;function ar(){return Xe&6?_t():Pc!==-1?Pc:Pc=_t()}function Xs(e){return e.mode&1?Xe&2&&$t!==0?$t&-$t:FS.transition!==null?(Dc===0&&(Dc=Z1()),Dc):(e=nt,e!==0||(e=window.event,e=e===void 0?16:sv(e.type)),e):1}function fn(e,t,r,n){if(50<_o)throw _o=0,km=null,Error(le(185));Cu(e,r,n),(!(Xe&2)||e!==Bt)&&(e===Bt&&(!(Xe&2)&&(Vd|=r),Rt===4&&As(e,$t)),Er(e,n),r===1&&Xe===0&&!(t.mode&1)&&(dl=_t()+500,Hd&&ca()))}function Er(e,t){var r=e.callbackNode;Fk(e,t);var n=Yc(e,e===Bt?$t:0);if(n===0)r!==null&&Cg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Cg(r),t===1)e.tag===0?MS(vx.bind(null,e)):_v(vx.bind(null,e)),LS(function(){!(Xe&6)&&ca()}),r=null;else{switch(X1(n)){case 1:r=Pp;break;case 4:r=Q1;break;case 16:r=Gc;break;case 536870912:r=K1;break;default:r=Gc}r=ww(r,mw.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function mw(e,t){if(Pc=-1,Dc=0,Xe&6)throw Error(le(327));var r=e.callbackNode;if(Mi()&&e.callbackNode!==r)return null;var n=Yc(e,e===Bt?$t:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=hd(e,n);else{t=n;var s=Xe;Xe|=2;var i=gw();(Bt!==e||$t!==t)&&(Vn=null,dl=_t()+500,Ha(e,t));do try{sT();break}catch(o){pw(e,o)}while(!0);Yp(),ud.current=i,Xe=s,Ct!==null?t=0:(Bt=null,$t=0,t=Rt)}if(t!==0){if(t===2&&(s=Xf(e),s!==0&&(n=s,t=Sm(e,s))),t===1)throw r=Jo,Ha(e,0),As(e,n),Er(e,_t()),r;if(t===6)As(e,n);else{if(s=e.current.alternate,!(n&30)&&!rT(s)&&(t=hd(e,n),t===2&&(i=Xf(e),i!==0&&(n=i,t=Sm(e,i))),t===1))throw r=Jo,Ha(e,0),As(e,n),Er(e,_t()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(le(345));case 2:_a(e,xr,Vn);break;case 3:if(As(e,n),(n&130023424)===n&&(t=u0+500-_t(),10<t)){if(Yc(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){ar(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=im(_a.bind(null,e,xr,Vn),t);break}_a(e,xr,Vn);break;case 4:if(As(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-hn(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=_t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tT(n/1960))-n,10<n){e.timeoutHandle=im(_a.bind(null,e,xr,Vn),n);break}_a(e,xr,Vn);break;case 5:_a(e,xr,Vn);break;default:throw Error(le(329))}}}return Er(e,_t()),e.callbackNode===r?mw.bind(null,e):null}function Sm(e,t){var r=Eo;return e.current.memoizedState.isDehydrated&&(Ha(e,t).flags|=256),e=hd(e,t),e!==2&&(t=xr,xr=r,t!==null&&Tm(t)),e}function Tm(e){xr===null?xr=e:xr.push.apply(xr,e)}function rT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!gn(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function As(e,t){for(t&=~o0,t&=~Vd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hn(t),n=1<<r;e[r]=-1,t&=~n}}function vx(e){if(Xe&6)throw Error(le(327));Mi();var t=Yc(e,0);if(!(t&1))return Er(e,_t()),null;var r=hd(e,t);if(e.tag!==0&&r===2){var n=Xf(e);n!==0&&(t=n,r=Sm(e,n))}if(r===1)throw r=Jo,Ha(e,0),As(e,t),Er(e,_t()),r;if(r===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_a(e,xr,Vn),Er(e,_t()),null}function c0(e,t){var r=Xe;Xe|=1;try{return e(t)}finally{Xe=r,Xe===0&&(dl=_t()+500,Hd&&ca())}}function Qa(e){zs!==null&&zs.tag===0&&!(Xe&6)&&Mi();var t=Xe;Xe|=1;var r=Gr.transition,n=nt;try{if(Gr.transition=null,nt=1,e)return e()}finally{nt=n,Gr.transition=r,Xe=t,!(Xe&6)&&ca()}}function d0(){Tr=ji.current,ft(ji)}function Ha(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,RS(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Vp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Jc();break;case 3:ul(),ft(vr),ft(Kt),e0();break;case 5:Jp(n);break;case 4:ul();break;case 13:ft(xt);break;case 19:ft(xt);break;case 10:Qp(n.type._context);break;case 22:case 23:d0()}r=r.return}if(Bt=e,Ct=e=Js(e.current,null),$t=Tr=t,Rt=0,Jo=null,o0=Vd=Ya=0,xr=Eo=null,Aa!==null){for(t=0;t<Aa.length;t++)if(r=Aa[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}Aa=null}return e}function pw(e,t){do{var r=Ct;try{if(Yp(),Rc.current=od,ld){for(var n=yt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ld=!1}if(Ga=0,Ft=At=yt=null,vo=!1,Ko=0,l0.current=null,r===null||r.return===null){Rt=1,Jo=t,Ct=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=$t,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=lx(l);if(p!==null){p.flags&=-257,ox(p,l,o,i,t),p.mode&1&&ix(i,c,t),t=p,u=c;var g=t.updateQueue;if(g===null){var b=new Set;b.add(u),t.updateQueue=b}else g.add(u);break e}else{if(!(t&1)){ix(i,c,t),h0();break e}u=Error(le(426))}}else if(pt&&o.mode&1){var E=lx(l);if(E!==null){!(E.flags&65536)&&(E.flags|=256),ox(E,l,o,i,t),Wp(cl(u,o));break e}}i=u=cl(u,o),Rt!==4&&(Rt=2),Eo===null?Eo=[i]:Eo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Xv(i,u,t);ex(i,x);break e;case 1:o=u;var y=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Zs===null||!Zs.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=Jv(i,o,t);ex(i,N);break e}}i=i.return}while(i!==null)}yw(r)}catch(_){t=_,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function gw(){var e=ud.current;return ud.current=od,e===null?od:e}function h0(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),Bt===null||!(Ya&268435455)&&!(Vd&268435455)||As(Bt,$t)}function hd(e,t){var r=Xe;Xe|=2;var n=gw();(Bt!==e||$t!==t)&&(Vn=null,Ha(e,t));do try{nT();break}catch(s){pw(e,s)}while(!0);if(Yp(),Xe=r,ud.current=n,Ct!==null)throw Error(le(261));return Bt=null,$t=0,Rt}function nT(){for(;Ct!==null;)xw(Ct)}function sT(){for(;Ct!==null&&!jk();)xw(Ct)}function xw(e){var t=vw(e.alternate,e,Tr);e.memoizedProps=e.pendingProps,t===null?yw(e):Ct=t,l0.current=null}function yw(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ZS(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rt=6,Ct=null;return}}else if(r=KS(r,t,Tr),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Rt===0&&(Rt=5)}function _a(e,t,r){var n=nt,s=Gr.transition;try{Gr.transition=null,nt=1,aT(e,t,r,n)}finally{Gr.transition=s,nt=n}return null}function aT(e,t,r,n){do Mi();while(zs!==null);if(Xe&6)throw Error(le(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Uk(e,i),e===Bt&&(Ct=Bt=null,$t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uc||(uc=!0,ww(Gc,function(){return Mi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Gr.transition,Gr.transition=null;var l=nt;nt=1;var o=Xe;Xe|=4,l0.current=null,JS(e,r),hw(r,e),kS(sm),Qc=!!nm,sm=nm=null,e.current=r,eT(r),Ak(),Xe=o,nt=l,Gr.transition=i}else e.current=r;if(uc&&(uc=!1,zs=e,dd=s),i=e.pendingLanes,i===0&&(Zs=null),Lk(r.stateNode),Er(e,_t()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(cd)throw cd=!1,e=Nm,Nm=null,e;return dd&1&&e.tag!==0&&Mi(),i=e.pendingLanes,i&1?e===km?_o++:(_o=0,km=e):_o=0,ca(),null}function Mi(){if(zs!==null){var e=X1(dd),t=Gr.transition,r=nt;try{if(Gr.transition=null,nt=16>e?16:e,zs===null)var n=!1;else{if(e=zs,zs=null,dd=0,Xe&6)throw Error(le(331));var s=Xe;for(Xe|=4,xe=e.current;xe!==null;){var i=xe,l=i.child;if(xe.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(xe=c;xe!==null;){var d=xe;switch(d.tag){case 0:case 11:case 15:wo(8,d,i)}var h=d.child;if(h!==null)h.return=d,xe=h;else for(;xe!==null;){d=xe;var f=d.sibling,p=d.return;if(uw(d),d===c){xe=null;break}if(f!==null){f.return=p,xe=f;break}xe=p}}}var g=i.alternate;if(g!==null){var b=g.child;if(b!==null){g.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}xe=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,xe=l;else e:for(;xe!==null;){if(i=xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wo(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,xe=x;break e}xe=i.return}}var y=e.current;for(xe=y;xe!==null;){l=xe;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,xe=v;else e:for(l=y;xe!==null;){if(o=xe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:qd(9,o)}}catch(_){wt(o,o.return,_)}if(o===l){xe=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,xe=N;break e}xe=o.return}}if(Xe=s,ca(),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Dd,e)}catch{}n=!0}return n}finally{nt=r,Gr.transition=t}}return!1}function wx(e,t,r){t=cl(r,t),t=Xv(e,t,1),e=Ks(e,t,1),t=ar(),e!==null&&(Cu(e,1,t),Er(e,t))}function wt(e,t,r){if(e.tag===3)wx(e,e,r);else for(;t!==null;){if(t.tag===3){wx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Zs===null||!Zs.has(n))){e=cl(r,e),e=Jv(t,e,1),t=Ks(t,e,1),e=ar(),t!==null&&(Cu(t,1,e),Er(t,e));break}}t=t.return}}function iT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ar(),e.pingedLanes|=e.suspendedLanes&r,Bt===e&&($t&r)===r&&(Rt===4||Rt===3&&($t&130023424)===$t&&500>_t()-u0?Ha(e,0):o0|=r),Er(e,t)}function bw(e,t){t===0&&(e.mode&1?(t=Ju,Ju<<=1,!(Ju&130023424)&&(Ju=4194304)):t=1);var r=ar();e=as(e,t),e!==null&&(Cu(e,t,r),Er(e,r))}function lT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bw(e,r)}function oT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(t),bw(e,r)}var vw;vw=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||vr.current)br=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return br=!1,QS(e,t,r);br=!!(e.flags&131072)}else br=!1,pt&&t.flags&1048576&&Nv(t,rd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Oc(e,t),e=t.pendingProps;var s=il(t,Kt.current);Di(t,r),s=r0(null,t,n,e,s,r);var i=n0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,wr(n)?(i=!0,ed(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Zp(t),s.updater=zd,t.stateNode=s,s._reactInternals=t,fm(t,n,e,r),t=gm(null,t,n,!0,i,r)):(t.tag=0,pt&&i&&qp(t),nr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Oc(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=cT(n),e=nn(n,e),s){case 0:t=pm(null,t,n,e,r);break e;case 1:t=dx(null,t,n,e,r);break e;case 11:t=ux(null,t,n,e,r);break e;case 14:t=cx(null,t,n,nn(n.type,e),r);break e}throw Error(le(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:nn(n,s),pm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:nn(n,s),dx(e,t,n,s,r);case 3:e:{if(nw(t),e===null)throw Error(le(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Av(e,t),ad(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=cl(Error(le(423)),t),t=hx(e,t,n,r,s);break e}else if(n!==s){s=cl(Error(le(424)),t),t=hx(e,t,n,r,s);break e}else for(Ar=Qs(t.stateNode.containerInfo.firstChild),Ir=t,pt=!0,un=null,r=Cv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ll(),n===s){t=is(e,t,r);break e}nr(e,t,n,r)}t=t.child}return t;case 5:return Iv(t),e===null&&cm(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,am(n,s)?l=null:i!==null&&am(n,i)&&(t.flags|=32),rw(e,t),nr(e,t,l,r),t.child;case 6:return e===null&&cm(t),null;case 13:return sw(e,t,r);case 4:return Xp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ol(t,null,n,r):nr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:nn(n,s),ux(e,t,n,s,r);case 7:return nr(e,t,t.pendingProps,r),t.child;case 8:return nr(e,t,t.pendingProps.children,r),t.child;case 12:return nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,ut(nd,n._currentValue),n._currentValue=l,i!==null)if(gn(i.value,l)){if(i.children===s.children&&!vr.current){t=is(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=es(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),dm(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(le(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),dm(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}nr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Di(t,r),s=Yr(s),n=n(s),t.flags|=1,nr(e,t,n,r),t.child;case 14:return n=t.type,s=nn(n,t.pendingProps),s=nn(n.type,s),cx(e,t,n,s,r);case 15:return ew(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:nn(n,s),Oc(e,t),t.tag=1,wr(n)?(e=!0,ed(t)):e=!1,Di(t,r),Zv(t,n,s),fm(t,n,s,r),gm(null,t,n,!0,e,r);case 19:return aw(e,t,r);case 22:return tw(e,t,r)}throw Error(le(156,t.tag))};function ww(e,t){return Y1(e,t)}function uT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(e,t,r,n){return new uT(e,t,r,n)}function f0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cT(e){if(typeof e=="function")return f0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Rp)return 11;if(e===Lp)return 14}return 2}function Js(e,t){var r=e.alternate;return r===null?(r=Vr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mc(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")f0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case bi:return $a(r.children,s,i,t);case Ip:l=8,s|=8;break;case Mf:return e=Vr(12,r,t,s|2),e.elementType=Mf,e.lanes=i,e;case Ff:return e=Vr(13,r,t,s),e.elementType=Ff,e.lanes=i,e;case Uf:return e=Vr(19,r,t,s),e.elementType=Uf,e.lanes=i,e;case I1:return Wd(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case j1:l=10;break e;case A1:l=9;break e;case Rp:l=11;break e;case Lp:l=14;break e;case ks:l=16,n=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=Vr(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function $a(e,t,r,n){return e=Vr(7,e,n,t),e.lanes=r,e}function Wd(e,t,r,n){return e=Vr(22,e,n,t),e.elementType=I1,e.lanes=r,e.stateNode={isHidden:!1},e}function Yh(e,t,r){return e=Vr(6,e,null,t),e.lanes=r,e}function Qh(e,t,r){return t=Vr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function dT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jh(0),this.expirationTimes=jh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jh(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function m0(e,t,r,n,s,i,l,o,u){return e=new dT(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Vr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zp(i),e}function hT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Ew(e){if(!e)return ra;e=e._reactInternals;e:{if(ai(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(wr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var r=e.type;if(wr(r))return Ev(e,r,t)}return t}function _w(e,t,r,n,s,i,l,o,u){return e=m0(r,n,!0,e,s,i,l,o,u),e.context=Ew(null),r=e.current,n=ar(),s=Xs(r),i=es(n,s),i.callback=t??null,Ks(r,i,s),e.current.lanes=s,Cu(e,s,n),Er(e,n),e}function Gd(e,t,r,n){var s=t.current,i=ar(),l=Xs(s);return r=Ew(r),t.context===null?t.context=r:t.pendingContext=r,t=es(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ks(s,t,l),e!==null&&(fn(e,s,l,i),Ic(e,s,l)),l}function fd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ex(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function p0(e,t){Ex(e,t),(e=e.alternate)&&Ex(e,t)}function fT(){return null}var Nw=typeof reportError=="function"?reportError:function(e){console.error(e)};function g0(e){this._internalRoot=e}Yd.prototype.render=g0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));Gd(e,t,null,null)};Yd.prototype.unmount=g0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qa(function(){Gd(null,e,null,null)}),t[ss]=null}};function Yd(e){this._internalRoot=e}Yd.prototype.unstable_scheduleHydration=function(e){if(e){var t=tv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<js.length&&t!==0&&t<js[r].priority;r++);js.splice(r,0,e),r===0&&nv(e)}};function x0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _x(){}function mT(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=fd(l);i.call(c)}}var l=_w(t,n,e,0,null,!1,!1,"",_x);return e._reactRootContainer=l,e[ss]=l.current,Vo(e.nodeType===8?e.parentNode:e),Qa(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=fd(u);o.call(c)}}var u=m0(e,0,!1,null,null,!1,!1,"",_x);return e._reactRootContainer=u,e[ss]=u.current,Vo(e.nodeType===8?e.parentNode:e),Qa(function(){Gd(t,u,r,n)}),u}function Kd(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=fd(l);o.call(u)}}Gd(t,l,e,s)}else l=mT(r,t,e,s,n);return fd(l)}J1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ao(t.pendingLanes);r!==0&&(Dp(t,r|1),Er(t,_t()),!(Xe&6)&&(dl=_t()+500,ca()))}break;case 13:Qa(function(){var n=as(e,1);if(n!==null){var s=ar();fn(n,e,1,s)}}),p0(e,1)}};Mp=function(e){if(e.tag===13){var t=as(e,134217728);if(t!==null){var r=ar();fn(t,e,134217728,r)}p0(e,134217728)}};ev=function(e){if(e.tag===13){var t=Xs(e),r=as(e,t);if(r!==null){var n=ar();fn(r,e,t,n)}p0(e,t)}};tv=function(){return nt};rv=function(e,t){var r=nt;try{return nt=e,t()}finally{nt=r}};Qf=function(e,t,r){switch(t){case"input":if($f(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Bd(n);if(!s)throw Error(le(90));L1(n),$f(n,s)}}}break;case"textarea":P1(e,r);break;case"select":t=r.value,t!=null&&Ri(e,!!r.multiple,t,!1)}};$1=c0;z1=Qa;var pT={usingClientEntryPoint:!1,Events:[Au,_i,Bd,B1,H1,c0]},Wl={findFiberByHostInstance:ja,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gT={bundleType:Wl.bundleType,version:Wl.version,rendererPackageName:Wl.rendererPackageName,rendererConfig:Wl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=W1(e),e===null?null:e.stateNode},findFiberByHostInstance:Wl.findFiberByHostInstance||fT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{Dd=cc.inject(gT),In=cc}catch{}}Dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pT;Dr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x0(t))throw Error(le(200));return hT(e,t,null,r)};Dr.createRoot=function(e,t){if(!x0(e))throw Error(le(299));var r=!1,n="",s=Nw;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=m0(e,1,!1,null,null,r,!1,n,s),e[ss]=t.current,Vo(e.nodeType===8?e.parentNode:e),new g0(t)};Dr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=W1(t),e=e===null?null:e.stateNode,e};Dr.flushSync=function(e){return Qa(e)};Dr.hydrate=function(e,t,r){if(!Qd(t))throw Error(le(200));return Kd(null,e,t,!0,r)};Dr.hydrateRoot=function(e,t,r){if(!x0(e))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=Nw;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=_w(t,null,e,1,r??null,s,!1,i,l),e[ss]=t.current,Vo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Yd(t)};Dr.render=function(e,t,r){if(!Qd(t))throw Error(le(200));return Kd(null,e,t,!1,r)};Dr.unmountComponentAtNode=function(e){if(!Qd(e))throw Error(le(40));return e._reactRootContainer?(Qa(function(){Kd(null,null,e,!1,function(){e._reactRootContainer=null,e[ss]=null})}),!0):!1};Dr.unstable_batchedUpdates=c0;Dr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qd(r))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return Kd(e,t,r,!1,n)};Dr.version="18.3.1-next-f1338f8080-20240426";function kw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kw)}catch(e){console.error(e)}}kw(),k1.exports=Dr;var xT=k1.exports,Sw,Nx=xT;Sw=Nx.createRoot,Nx.hydrateRoot;var kl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ka=typeof window>"u"||"Deno"in globalThis;function Br(){}function yT(e,t){return typeof e=="function"?e(t):e}function Cm(e){return typeof e=="number"&&e>=0&&e!==1/0}function Tw(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Fi(e,t){return typeof e=="function"?e(t):e}function cn(e,t){return typeof e=="function"?e(t):e}function kx(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==y0(l,t.options))return!1}else if(!eu(t.queryKey,l))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||i&&!i(t))}function Sx(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Za(t.options.mutationKey)!==Za(i))return!1}else if(!eu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function y0(e,t){return((t==null?void 0:t.queryKeyHashFn)||Za)(e)}function Za(e){return JSON.stringify(e,(t,r)=>jm(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function eu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>eu(e[r],t[r])):!1}function Cw(e,t){if(e===t)return e;const r=Tx(e)&&Tx(t);if(r||jm(e)&&jm(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{};let u=0;for(let c=0;c<l;c++){const d=r?c:i[c];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=Cw(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return s===l&&u===s?e:o}return t}function md(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Tx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jm(e){if(!Cx(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Cx(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Cx(e){return Object.prototype.toString.call(e)==="[object Object]"}function bT(e){return new Promise(t=>{setTimeout(t,e)})}function Am(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Cw(e,t):t}function vT(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function wT(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var b0=Symbol();function jw(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===b0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var La,Rs,Wi,s1,ET=(s1=class extends kl{constructor(){super();ke(this,La);ke(this,Rs);ke(this,Wi);fe(this,Wi,t=>{if(!Ka&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){U(this,Rs)||this.setEventListener(U(this,Wi))}onUnsubscribe(){var t;this.hasListeners()||((t=U(this,Rs))==null||t.call(this),fe(this,Rs,void 0))}setEventListener(t){var r;fe(this,Wi,t),(r=U(this,Rs))==null||r.call(this),fe(this,Rs,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){U(this,La)!==t&&(fe(this,La,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof U(this,La)=="boolean"?U(this,La):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},La=new WeakMap,Rs=new WeakMap,Wi=new WeakMap,s1),v0=new ET,Gi,Ls,Yi,a1,_T=(a1=class extends kl{constructor(){super();ke(this,Gi,!0);ke(this,Ls);ke(this,Yi);fe(this,Yi,t=>{if(!Ka&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){U(this,Ls)||this.setEventListener(U(this,Yi))}onUnsubscribe(){var t;this.hasListeners()||((t=U(this,Ls))==null||t.call(this),fe(this,Ls,void 0))}setEventListener(t){var r;fe(this,Yi,t),(r=U(this,Ls))==null||r.call(this),fe(this,Ls,t(this.setOnline.bind(this)))}setOnline(t){U(this,Gi)!==t&&(fe(this,Gi,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return U(this,Gi)}},Gi=new WeakMap,Ls=new WeakMap,Yi=new WeakMap,a1),pd=new _T;function Im(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function NT(e){return Math.min(1e3*2**e,3e4)}function Aw(e){return(e??"online")==="online"?pd.isOnline():!0}var Iw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Kh(e){return e instanceof Iw}function Rw(e){let t=!1,r=0,n=!1,s;const i=Im(),l=b=>{var E;n||(f(new Iw(b)),(E=e.abort)==null||E.call(e))},o=()=>{t=!0},u=()=>{t=!1},c=()=>v0.isFocused()&&(e.networkMode==="always"||pd.isOnline())&&e.canRun(),d=()=>Aw(e.networkMode)&&e.canRun(),h=b=>{var E;n||(n=!0,(E=e.onSuccess)==null||E.call(e,b),s==null||s(),i.resolve(b))},f=b=>{var E;n||(n=!0,(E=e.onError)==null||E.call(e,b),s==null||s(),i.reject(b))},p=()=>new Promise(b=>{var E;s=x=>{(n||c())&&b(x)},(E=e.onPause)==null||E.call(e)}).then(()=>{var b;s=void 0,n||(b=e.onContinue)==null||b.call(e)}),g=()=>{if(n)return;let b;const E=r===0?e.initialPromise:void 0;try{b=E??e.fn()}catch(x){b=Promise.reject(x)}Promise.resolve(b).then(h).catch(x=>{var S;if(n)return;const y=e.retry??(Ka?0:3),v=e.retryDelay??NT,N=typeof v=="function"?v(r,x):v,_=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,x);if(t||!_){f(x);return}r++,(S=e.onFail)==null||S.call(e,r,x),bT(N).then(()=>c()?void 0:p()).then(()=>{t?f(x):g()})})};return{promise:i,cancel:l,continue:()=>(s==null||s(),i),cancelRetry:o,continueRetry:u,canStart:d,start:()=>(d()?g():p().then(g),i)}}var kT=e=>setTimeout(e,0);function ST(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=kT;const i=o=>{t?e.push(o):s(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||l()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var It=ST(),Oa,i1,Lw=(i1=class{constructor(){ke(this,Oa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Cm(this.gcTime)&&fe(this,Oa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ka?1/0:5*60*1e3))}clearGcTimeout(){U(this,Oa)&&(clearTimeout(U(this,Oa)),fe(this,Oa,void 0))}},Oa=new WeakMap,i1),Qi,Ki,Ur,Pa,Gt,_u,Da,sn,zn,l1,TT=(l1=class extends Lw{constructor(t){super();ke(this,sn);ke(this,Qi);ke(this,Ki);ke(this,Ur);ke(this,Pa);ke(this,Gt);ke(this,_u);ke(this,Da);fe(this,Da,!1),fe(this,_u,t.defaultOptions),this.setOptions(t.options),this.observers=[],fe(this,Pa,t.client),fe(this,Ur,U(this,Pa).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,fe(this,Qi,CT(this.options)),this.state=t.state??U(this,Qi),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=U(this,Gt))==null?void 0:t.promise}setOptions(t){this.options={...U(this,_u),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&U(this,Ur).remove(this)}setData(t,r){const n=Am(this.state.data,t,this.options);return Fe(this,sn,zn).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Fe(this,sn,zn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=U(this,Gt))==null?void 0:n.promise;return(s=U(this,Gt))==null||s.cancel(t),r?r.then(Br).catch(Br):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(U(this,Qi))}isActive(){return this.observers.some(t=>cn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===b0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Tw(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=U(this,Gt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=U(this,Gt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),U(this,Ur).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(U(this,Gt)&&(U(this,Da)?U(this,Gt).cancel({revert:!0}):U(this,Gt).cancelRetry()),this.scheduleGc()),U(this,Ur).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,sn,zn).call(this,{type:"invalidate"})}fetch(t,r){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(U(this,Gt))return U(this,Gt).continueRetry(),U(this,Gt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(fe(this,Da,!0),n.signal)})},i=()=>{const h=jw(this.options,r),f={client:U(this,Pa),queryKey:this.queryKey,meta:this.meta};return s(f),fe(this,Da,!1),this.options.persister?this.options.persister(h,f,this):h(f)},l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:U(this,Pa),state:this.state,fetchFn:i};s(l),(u=this.options.behavior)==null||u.onFetch(l,this),fe(this,Ki,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=l.fetchOptions)==null?void 0:c.meta))&&Fe(this,sn,zn).call(this,{type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta});const o=h=>{var f,p,g,b;Kh(h)&&h.silent||Fe(this,sn,zn).call(this,{type:"error",error:h}),Kh(h)||((p=(f=U(this,Ur).config).onError)==null||p.call(f,h,this),(b=(g=U(this,Ur).config).onSettled)==null||b.call(g,this.state.data,h,this)),this.scheduleGc()};return fe(this,Gt,Rw({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,p,g,b;if(h===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(E){o(E);return}(p=(f=U(this,Ur).config).onSuccess)==null||p.call(f,h,this),(b=(g=U(this,Ur).config).onSettled)==null||b.call(g,h,this.state.error,this),this.scheduleGc()},onError:o,onFail:(h,f)=>{Fe(this,sn,zn).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{Fe(this,sn,zn).call(this,{type:"pause"})},onContinue:()=>{Fe(this,sn,zn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),U(this,Gt).start()}},Qi=new WeakMap,Ki=new WeakMap,Ur=new WeakMap,Pa=new WeakMap,Gt=new WeakMap,_u=new WeakMap,Da=new WeakMap,sn=new WeakSet,zn=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Ow(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Kh(s)&&s.revert&&U(this,Ki)?{...U(this,Ki),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),It.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),U(this,Ur).notify({query:this,type:"updated",action:t})})},l1);function Ow(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Aw(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function CT(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Sn,o1,jT=(o1=class extends kl{constructor(t={}){super();ke(this,Sn);this.config=t,fe(this,Sn,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??y0(s,r);let l=this.get(i);return l||(l=new TT({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){U(this,Sn).has(t.queryHash)||(U(this,Sn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=U(this,Sn).get(t.queryHash);r&&(t.destroy(),r===t&&U(this,Sn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){It.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return U(this,Sn).get(t)}getAll(){return[...U(this,Sn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>kx(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>kx(t,n)):r}notify(t){It.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){It.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){It.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Sn=new WeakMap,o1),Tn,tr,Ma,Cn,vs,u1,AT=(u1=class extends Lw{constructor(t){super();ke(this,Cn);ke(this,Tn);ke(this,tr);ke(this,Ma);this.mutationId=t.mutationId,fe(this,tr,t.mutationCache),fe(this,Tn,[]),this.state=t.state||Pw(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){U(this,Tn).includes(t)||(U(this,Tn).push(t),this.clearGcTimeout(),U(this,tr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){fe(this,Tn,U(this,Tn).filter(r=>r!==t)),this.scheduleGc(),U(this,tr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){U(this,Tn).length||(this.state.status==="pending"?this.scheduleGc():U(this,tr).remove(this))}continue(){var t;return((t=U(this,Ma))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,u,c,d,h,f,p,g,b,E,x,y,v,N,_,S,R,j;const r=()=>{Fe(this,Cn,vs).call(this,{type:"continue"})};fe(this,Ma,Rw({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(D,T)=>{Fe(this,Cn,vs).call(this,{type:"failed",failureCount:D,error:T})},onPause:()=>{Fe(this,Cn,vs).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>U(this,tr).canRun(this)}));const n=this.state.status==="pending",s=!U(this,Ma).canStart();try{if(n)r();else{Fe(this,Cn,vs).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(i=U(this,tr).config).onMutate)==null?void 0:l.call(i,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&Fe(this,Cn,vs).call(this,{type:"pending",context:T,variables:t,isPaused:s})}const D=await U(this,Ma).start();return await((d=(c=U(this,tr).config).onSuccess)==null?void 0:d.call(c,D,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,D,t,this.state.context)),await((g=(p=U(this,tr).config).onSettled)==null?void 0:g.call(p,D,null,this.state.variables,this.state.context,this)),await((E=(b=this.options).onSettled)==null?void 0:E.call(b,D,null,t,this.state.context)),Fe(this,Cn,vs).call(this,{type:"success",data:D}),D}catch(D){try{throw await((y=(x=U(this,tr).config).onError)==null?void 0:y.call(x,D,t,this.state.context,this)),await((N=(v=this.options).onError)==null?void 0:N.call(v,D,t,this.state.context)),await((S=(_=U(this,tr).config).onSettled)==null?void 0:S.call(_,void 0,D,this.state.variables,this.state.context,this)),await((j=(R=this.options).onSettled)==null?void 0:j.call(R,void 0,D,t,this.state.context)),D}finally{Fe(this,Cn,vs).call(this,{type:"error",error:D})}}finally{U(this,tr).runNext(this)}}},Tn=new WeakMap,tr=new WeakMap,Ma=new WeakMap,Cn=new WeakSet,vs=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),It.batch(()=>{U(this,Tn).forEach(n=>{n.onMutationUpdate(t)}),U(this,tr).notify({mutation:this,type:"updated",action:t})})},u1);function Pw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Qn,an,Nu,c1,IT=(c1=class extends kl{constructor(t={}){super();ke(this,Qn);ke(this,an);ke(this,Nu);this.config=t,fe(this,Qn,new Set),fe(this,an,new Map),fe(this,Nu,0)}build(t,r,n){const s=new AT({mutationCache:this,mutationId:++Gu(this,Nu)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){U(this,Qn).add(t);const r=dc(t);if(typeof r=="string"){const n=U(this,an).get(r);n?n.push(t):U(this,an).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(U(this,Qn).delete(t)){const r=dc(t);if(typeof r=="string"){const n=U(this,an).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&U(this,an).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=dc(t);if(typeof r=="string"){const n=U(this,an).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=dc(t);if(typeof r=="string"){const s=(n=U(this,an).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){It.batch(()=>{U(this,Qn).forEach(t=>{this.notify({type:"removed",mutation:t})}),U(this,Qn).clear(),U(this,an).clear()})}getAll(){return Array.from(U(this,Qn))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Sx(r,n))}findAll(t={}){return this.getAll().filter(r=>Sx(t,r))}notify(t){It.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return It.batch(()=>Promise.all(t.map(r=>r.continue().catch(Br))))}},Qn=new WeakMap,an=new WeakMap,Nu=new WeakMap,c1);function dc(e){var t;return(t=e.options.scope)==null?void 0:t.id}function jx(e){return{onFetch:(t,r)=>{var d,h,f,p,g;const n=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],l=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let b=!1;const E=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?b=!0:t.signal.addEventListener("abort",()=>{b=!0}),t.signal)})},x=jw(t.options,t.fetchOptions),y=async(v,N,_)=>{if(b)return Promise.reject();if(N==null&&v.pages.length)return Promise.resolve(v);const S={client:t.client,queryKey:t.queryKey,pageParam:N,direction:_?"backward":"forward",meta:t.options.meta};E(S);const R=await x(S),{maxPages:j}=t.options,D=_?wT:vT;return{pages:D(v.pages,R,j),pageParams:D(v.pageParams,N,j)}};if(s&&i.length){const v=s==="backward",N=v?RT:Ax,_={pages:i,pageParams:l},S=N(n,_);o=await y(_,S,v)}else{const v=e??i.length;do{const N=u===0?l[0]??n.initialPageParam:Ax(n,o);if(u>0&&N==null)break;o=await y(o,N),u++}while(u<v)}return o};t.options.persister?t.fetchFn=()=>{var b,E;return(E=(b=t.options).persister)==null?void 0:E.call(b,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function Ax(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function RT(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var vt,Os,Ps,Zi,Xi,Ds,Ji,el,d1,LT=(d1=class{constructor(e={}){ke(this,vt);ke(this,Os);ke(this,Ps);ke(this,Zi);ke(this,Xi);ke(this,Ds);ke(this,Ji);ke(this,el);fe(this,vt,e.queryCache||new jT),fe(this,Os,e.mutationCache||new IT),fe(this,Ps,e.defaultOptions||{}),fe(this,Zi,new Map),fe(this,Xi,new Map),fe(this,Ds,0)}mount(){Gu(this,Ds)._++,U(this,Ds)===1&&(fe(this,Ji,v0.subscribe(async e=>{e&&(await this.resumePausedMutations(),U(this,vt).onFocus())})),fe(this,el,pd.subscribe(async e=>{e&&(await this.resumePausedMutations(),U(this,vt).onOnline())})))}unmount(){var e,t;Gu(this,Ds)._--,U(this,Ds)===0&&((e=U(this,Ji))==null||e.call(this),fe(this,Ji,void 0),(t=U(this,el))==null||t.call(this),fe(this,el,void 0))}isFetching(e){return U(this,vt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return U(this,Os).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=U(this,vt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=U(this,vt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Fi(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return U(this,vt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=U(this,vt).get(n.queryHash),i=s==null?void 0:s.state.data,l=yT(t,i);if(l!==void 0)return U(this,vt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return It.batch(()=>U(this,vt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=U(this,vt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=U(this,vt);It.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=U(this,vt);return It.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=It.batch(()=>U(this,vt).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(Br).catch(Br)}invalidateQueries(e,t={}){return It.batch(()=>(U(this,vt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=It.batch(()=>U(this,vt).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(Br)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Br)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=U(this,vt).build(this,t);return r.isStaleByTime(Fi(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Br).catch(Br)}fetchInfiniteQuery(e){return e.behavior=jx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Br).catch(Br)}ensureInfiniteQueryData(e){return e.behavior=jx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return pd.isOnline()?U(this,Os).resumePausedMutations():Promise.resolve()}getQueryCache(){return U(this,vt)}getMutationCache(){return U(this,Os)}getDefaultOptions(){return U(this,Ps)}setDefaultOptions(e){fe(this,Ps,e)}setQueryDefaults(e,t){U(this,Zi).set(Za(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...U(this,Zi).values()],r={};return t.forEach(n=>{eu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){U(this,Xi).set(Za(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...U(this,Xi).values()],r={};return t.forEach(n=>{eu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...U(this,Ps).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=y0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===b0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...U(this,Ps).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){U(this,vt).clear(),U(this,Os).clear()}},vt=new WeakMap,Os=new WeakMap,Ps=new WeakMap,Zi=new WeakMap,Xi=new WeakMap,Ds=new WeakMap,Ji=new WeakMap,el=new WeakMap,d1),pr,Qe,ku,rr,Fa,tl,Ms,Fs,Su,rl,nl,Ua,Ba,Us,sl,tt,lo,Rm,Lm,Om,Pm,Dm,Mm,Fm,Dw,h1,OT=(h1=class extends kl{constructor(t,r){super();ke(this,tt);ke(this,pr);ke(this,Qe);ke(this,ku);ke(this,rr);ke(this,Fa);ke(this,tl);ke(this,Ms);ke(this,Fs);ke(this,Su);ke(this,rl);ke(this,nl);ke(this,Ua);ke(this,Ba);ke(this,Us);ke(this,sl,new Set);this.options=r,fe(this,pr,t),fe(this,Fs,null),fe(this,Ms,Im()),this.options.experimental_prefetchInRender||U(this,Ms).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(U(this,Qe).addObserver(this),Ix(U(this,Qe),this.options)?Fe(this,tt,lo).call(this):this.updateResult(),Fe(this,tt,Pm).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Um(U(this,Qe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Um(U(this,Qe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,tt,Dm).call(this),Fe(this,tt,Mm).call(this),U(this,Qe).removeObserver(this)}setOptions(t){const r=this.options,n=U(this,Qe);if(this.options=U(this,pr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof cn(this.options.enabled,U(this,Qe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,tt,Fm).call(this),U(this,Qe).setOptions(this.options),r._defaulted&&!md(this.options,r)&&U(this,pr).getQueryCache().notify({type:"observerOptionsUpdated",query:U(this,Qe),observer:this});const s=this.hasListeners();s&&Rx(U(this,Qe),n,this.options,r)&&Fe(this,tt,lo).call(this),this.updateResult(),s&&(U(this,Qe)!==n||cn(this.options.enabled,U(this,Qe))!==cn(r.enabled,U(this,Qe))||Fi(this.options.staleTime,U(this,Qe))!==Fi(r.staleTime,U(this,Qe)))&&Fe(this,tt,Rm).call(this);const i=Fe(this,tt,Lm).call(this);s&&(U(this,Qe)!==n||cn(this.options.enabled,U(this,Qe))!==cn(r.enabled,U(this,Qe))||i!==U(this,Us))&&Fe(this,tt,Om).call(this,i)}getOptimisticResult(t){const r=U(this,pr).getQueryCache().build(U(this,pr),t),n=this.createResult(r,t);return DT(this,n)&&(fe(this,rr,n),fe(this,tl,this.options),fe(this,Fa,U(this,Qe).state)),n}getCurrentResult(){return U(this,rr)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){U(this,sl).add(t)}getCurrentQuery(){return U(this,Qe)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=U(this,pr).defaultQueryOptions(t),n=U(this,pr).getQueryCache().build(U(this,pr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Fe(this,tt,lo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),U(this,rr)))}createResult(t,r){var D;const n=U(this,Qe),s=this.options,i=U(this,rr),l=U(this,Fa),o=U(this,tl),c=t!==n?t.state:U(this,ku),{state:d}=t;let h={...d},f=!1,p;if(r._optimisticResults){const T=this.hasListeners(),F=!T&&Ix(t,r),O=T&&Rx(t,n,r,s);(F||O)&&(h={...h,...Ow(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:b,status:E}=h;p=h.data;let x=!1;if(r.placeholderData!==void 0&&p===void 0&&E==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,x=!0):T=typeof r.placeholderData=="function"?r.placeholderData((D=U(this,nl))==null?void 0:D.state.data,U(this,nl)):r.placeholderData,T!==void 0&&(E="success",p=Am(i==null?void 0:i.data,T,r),f=!0)}if(r.select&&p!==void 0&&!x)if(i&&p===(l==null?void 0:l.data)&&r.select===U(this,Su))p=U(this,rl);else try{fe(this,Su,r.select),p=r.select(p),p=Am(i==null?void 0:i.data,p,r),fe(this,rl,p),fe(this,Fs,null)}catch(T){fe(this,Fs,T)}U(this,Fs)&&(g=U(this,Fs),p=U(this,rl),b=Date.now(),E="error");const y=h.fetchStatus==="fetching",v=E==="pending",N=E==="error",_=v&&y,S=p!==void 0,j={status:E,fetchStatus:h.fetchStatus,isPending:v,isSuccess:E==="success",isError:N,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:b,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:y,isRefetching:y&&!v,isLoadingError:N&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:N&&S,isStale:w0(t,r),refetch:this.refetch,promise:U(this,Ms)};if(this.options.experimental_prefetchInRender){const T=Q=>{j.status==="error"?Q.reject(j.error):j.data!==void 0&&Q.resolve(j.data)},F=()=>{const Q=fe(this,Ms,j.promise=Im());T(Q)},O=U(this,Ms);switch(O.status){case"pending":t.queryHash===n.queryHash&&T(O);break;case"fulfilled":(j.status==="error"||j.data!==O.value)&&F();break;case"rejected":(j.status!=="error"||j.error!==O.reason)&&F();break}}return j}updateResult(){const t=U(this,rr),r=this.createResult(U(this,Qe),this.options);if(fe(this,Fa,U(this,Qe).state),fe(this,tl,this.options),U(this,Fa).data!==void 0&&fe(this,nl,U(this,Qe)),md(r,t))return;fe(this,rr,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!U(this,sl).size)return!0;const l=new Set(i??U(this,sl));return this.options.throwOnError&&l.add("error"),Object.keys(U(this,rr)).some(o=>{const u=o;return U(this,rr)[u]!==t[u]&&l.has(u)})};Fe(this,tt,Dw).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,tt,Pm).call(this)}},pr=new WeakMap,Qe=new WeakMap,ku=new WeakMap,rr=new WeakMap,Fa=new WeakMap,tl=new WeakMap,Ms=new WeakMap,Fs=new WeakMap,Su=new WeakMap,rl=new WeakMap,nl=new WeakMap,Ua=new WeakMap,Ba=new WeakMap,Us=new WeakMap,sl=new WeakMap,tt=new WeakSet,lo=function(t){Fe(this,tt,Fm).call(this);let r=U(this,Qe).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Br)),r},Rm=function(){Fe(this,tt,Dm).call(this);const t=Fi(this.options.staleTime,U(this,Qe));if(Ka||U(this,rr).isStale||!Cm(t))return;const n=Tw(U(this,rr).dataUpdatedAt,t)+1;fe(this,Ua,setTimeout(()=>{U(this,rr).isStale||this.updateResult()},n))},Lm=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(U(this,Qe)):this.options.refetchInterval)??!1},Om=function(t){Fe(this,tt,Mm).call(this),fe(this,Us,t),!(Ka||cn(this.options.enabled,U(this,Qe))===!1||!Cm(U(this,Us))||U(this,Us)===0)&&fe(this,Ba,setInterval(()=>{(this.options.refetchIntervalInBackground||v0.isFocused())&&Fe(this,tt,lo).call(this)},U(this,Us)))},Pm=function(){Fe(this,tt,Rm).call(this),Fe(this,tt,Om).call(this,Fe(this,tt,Lm).call(this))},Dm=function(){U(this,Ua)&&(clearTimeout(U(this,Ua)),fe(this,Ua,void 0))},Mm=function(){U(this,Ba)&&(clearInterval(U(this,Ba)),fe(this,Ba,void 0))},Fm=function(){const t=U(this,pr).getQueryCache().build(U(this,pr),this.options);if(t===U(this,Qe))return;const r=U(this,Qe);fe(this,Qe,t),fe(this,ku,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},Dw=function(t){It.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(U(this,rr))}),U(this,pr).getQueryCache().notify({query:U(this,Qe),type:"observerResultsUpdated"})})},h1);function PT(e,t){return cn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Ix(e,t){return PT(e,t)||e.state.data!==void 0&&Um(e,t,t.refetchOnMount)}function Um(e,t,r){if(cn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&w0(e,t)}return!1}function Rx(e,t,r,n){return(e!==t||cn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&w0(e,r)}function w0(e,t){return cn(t.enabled,e)!==!1&&e.isStaleByTime(Fi(t.staleTime,e))}function DT(e,t){return!md(e.getCurrentResult(),t)}var Bs,Hs,gr,Kn,rs,Fc,Bm,f1,MT=(f1=class extends kl{constructor(r,n){super();ke(this,rs);ke(this,Bs);ke(this,Hs);ke(this,gr);ke(this,Kn);fe(this,Bs,r),this.setOptions(n),this.bindMethods(),Fe(this,rs,Fc).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=U(this,Bs).defaultMutationOptions(r),md(this.options,n)||U(this,Bs).getMutationCache().notify({type:"observerOptionsUpdated",mutation:U(this,gr),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Za(n.mutationKey)!==Za(this.options.mutationKey)?this.reset():((s=U(this,gr))==null?void 0:s.state.status)==="pending"&&U(this,gr).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=U(this,gr))==null||r.removeObserver(this)}onMutationUpdate(r){Fe(this,rs,Fc).call(this),Fe(this,rs,Bm).call(this,r)}getCurrentResult(){return U(this,Hs)}reset(){var r;(r=U(this,gr))==null||r.removeObserver(this),fe(this,gr,void 0),Fe(this,rs,Fc).call(this),Fe(this,rs,Bm).call(this)}mutate(r,n){var s;return fe(this,Kn,n),(s=U(this,gr))==null||s.removeObserver(this),fe(this,gr,U(this,Bs).getMutationCache().build(U(this,Bs),this.options)),U(this,gr).addObserver(this),U(this,gr).execute(r)}},Bs=new WeakMap,Hs=new WeakMap,gr=new WeakMap,Kn=new WeakMap,rs=new WeakSet,Fc=function(){var n;const r=((n=U(this,gr))==null?void 0:n.state)??Pw();fe(this,Hs,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Bm=function(r){It.batch(()=>{var n,s,i,l,o,u,c,d;if(U(this,Kn)&&this.hasListeners()){const h=U(this,Hs).variables,f=U(this,Hs).context;(r==null?void 0:r.type)==="success"?((s=(n=U(this,Kn)).onSuccess)==null||s.call(n,r.data,h,f),(l=(i=U(this,Kn)).onSettled)==null||l.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((u=(o=U(this,Kn)).onError)==null||u.call(o,r.error,h,f),(d=(c=U(this,Kn)).onSettled)==null||d.call(c,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(U(this,Hs))})})},f1),Mw=w.createContext(void 0),Zr=e=>{const t=w.useContext(Mw);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Fw=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(Mw.Provider,{value:e,children:t})),Uw=w.createContext(!1),FT=()=>w.useContext(Uw);Uw.Provider;function UT(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var BT=w.createContext(UT()),HT=()=>w.useContext(BT);function Bw(e,t){return typeof e=="function"?e(...t):!!e}function Hm(){}var $T=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},zT=e=>{w.useEffect(()=>{e.clearReset()},[e])},qT=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||Bw(r,[e.error,n])),VT=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},WT=(e,t)=>e.isLoading&&e.isFetching&&!t,GT=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Lx=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function YT(e,t,r){var h,f,p,g,b;const n=Zr(),s=FT(),i=HT(),l=n.defaultQueryOptions(e);(f=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",VT(l),$T(l,i),zT(i);const o=!n.getQueryCache().get(l.queryHash),[u]=w.useState(()=>new t(n,l)),c=u.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(E=>{const x=d?u.subscribe(It.batchCalls(E)):Hm;return u.updateResult(),x},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(l)},[l,u]),GT(l,c))throw Lx(l,u,i);if(qT({result:c,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((g=(p=n.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||g.call(p,l,c),l.experimental_prefetchInRender&&!Ka&&WT(c,s)){const E=o?Lx(l,u,i):(b=n.getQueryCache().get(l.queryHash))==null?void 0:b.promise;E==null||E.catch(Hm).finally(()=>{u.updateResult()})}return l.notifyOnChangeProps?c:u.trackResult(c)}function jt(e,t){return YT(e,OT)}function jr(e,t){const r=Zr(),[n]=w.useState(()=>new MT(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const s=w.useSyncExternalStore(w.useCallback(l=>n.subscribe(It.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((l,o)=>{n.mutate(l,o).catch(Hm)},[n]);if(s.error&&Bw(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tu(){return tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tu.apply(this,arguments)}var qs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qs||(qs={}));const Ox="popstate";function QT(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return $m("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:gd(s)}return ZT(t,r,null,e)}function kt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Hw(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function KT(){return Math.random().toString(36).substr(2,8)}function Px(e,t){return{usr:e.state,key:e.key,idx:t}}function $m(e,t,r,n){return r===void 0&&(r=null),tu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Sl(t):t,{state:r,key:t&&t.key||n||KT()})}function gd(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Sl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function ZT(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=qs.Pop,u=null,c=d();c==null&&(c=0,l.replaceState(tu({},l.state,{idx:c}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=qs.Pop;let E=d(),x=E==null?null:E-c;c=E,u&&u({action:o,location:b.location,delta:x})}function f(E,x){o=qs.Push;let y=$m(b.location,E,x);c=d()+1;let v=Px(y,c),N=b.createHref(y);try{l.pushState(v,"",N)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(N)}i&&u&&u({action:o,location:b.location,delta:1})}function p(E,x){o=qs.Replace;let y=$m(b.location,E,x);c=d();let v=Px(y,c),N=b.createHref(y);l.replaceState(v,"",N),i&&u&&u({action:o,location:b.location,delta:0})}function g(E){let x=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof E=="string"?E:gd(E);return y=y.replace(/ $/,"%20"),kt(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let b={get action(){return o},get location(){return e(s,l)},listen(E){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Ox,h),u=E,()=>{s.removeEventListener(Ox,h),u=null}},createHref(E){return t(s,E)},createURL:g,encodeLocation(E){let x=g(E);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(E){return l.go(E)}};return b}var Dx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Dx||(Dx={}));function XT(e,t,r){return r===void 0&&(r="/"),JT(e,t,r)}function JT(e,t,r,n){let s=typeof t=="string"?Sl(t):t,i=E0(s.pathname||"/",r);if(i==null)return null;let l=$w(e);eC(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=hC(i);o=uC(l[u],c)}return o}function $w(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(kt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=ea([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(kt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),$w(i.children,t,d,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:lC(c,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of zw(i.path))s(i,l,u)}),t}function zw(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=zw(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function eC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:oC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const tC=/^:[\w-]+$/,rC=3,nC=2,sC=1,aC=10,iC=-2,Mx=e=>e==="*";function lC(e,t){let r=e.split("/"),n=r.length;return r.some(Mx)&&(n+=iC),t&&(n+=nC),r.filter(s=>!Mx(s)).reduce((s,i)=>s+(tC.test(i)?rC:i===""?sC:aC),n)}function oC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function uC(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=cC({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),l.push({params:s,pathname:ea([i,h.pathname]),pathnameBase:gC(ea([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ea([i,h.pathnameBase]))}return l}function cC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=dC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let b=o[h]||"";l=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=o[h];return p&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function dC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Hw(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function hC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Hw(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function E0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function fC(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Sl(e):e;return{pathname:r?r.startsWith("/")?r:mC(r,t):t,search:xC(n),hash:yC(s)}}function mC(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Zh(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function pC(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _0(e,t){let r=pC(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function N0(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Sl(e):(s=tu({},e),kt(!s.pathname||!s.pathname.includes("?"),Zh("?","pathname","search",s)),kt(!s.pathname||!s.pathname.includes("#"),Zh("#","pathname","hash",s)),kt(!s.search||!s.search.includes("#"),Zh("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let u=fC(s,o),c=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const ea=e=>e.join("/").replace(/\/\/+/g,"/"),gC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),xC=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,yC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bC(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const qw=["post","put","patch","delete"];new Set(qw);const vC=["get",...qw];new Set(vC);/**
 * React Router v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ru(){return ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ru.apply(this,arguments)}const k0=w.createContext(null),wC=w.createContext(null),da=w.createContext(null),Zd=w.createContext(null),ds=w.createContext({outlet:null,matches:[],isDataRoute:!1}),Vw=w.createContext(null);function EC(e,t){let{relative:r}=t===void 0?{}:t;Tl()||kt(!1);let{basename:n,navigator:s}=w.useContext(da),{hash:i,pathname:l,search:o}=Gw(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:ea([n,l])),s.createHref({pathname:u,search:o,hash:i})}function Tl(){return w.useContext(Zd)!=null}function ha(){return Tl()||kt(!1),w.useContext(Zd).location}function Ww(e){w.useContext(da).static||w.useLayoutEffect(e)}function Xr(){let{isDataRoute:e}=w.useContext(ds);return e?PC():_C()}function _C(){Tl()||kt(!1);let e=w.useContext(k0),{basename:t,future:r,navigator:n}=w.useContext(da),{matches:s}=w.useContext(ds),{pathname:i}=ha(),l=JSON.stringify(_0(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return Ww(()=>{o.current=!0}),w.useCallback(function(c,d){if(d===void 0&&(d={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=N0(c,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ea([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,l,i,e])}function S0(){let{matches:e}=w.useContext(ds),t=e[e.length-1];return t?t.params:{}}function Gw(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(da),{matches:s}=w.useContext(ds),{pathname:i}=ha(),l=JSON.stringify(_0(s,n.v7_relativeSplatPath));return w.useMemo(()=>N0(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function NC(e,t){return kC(e,t)}function kC(e,t,r,n){Tl()||kt(!1);let{navigator:s}=w.useContext(da),{matches:i}=w.useContext(ds),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=ha(),d;if(t){var h;let E=typeof t=="string"?Sl(t):t;u==="/"||(h=E.pathname)!=null&&h.startsWith(u)||kt(!1),d=E}else d=c;let f=d.pathname||"/",p=f;if(u!=="/"){let E=u.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let g=XT(e,{pathname:p}),b=AC(g&&g.map(E=>Object.assign({},E,{params:Object.assign({},o,E.params),pathname:ea([u,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?u:ea([u,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,r,n);return t&&b?w.createElement(Zd.Provider,{value:{location:ru({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:qs.Pop}},b):b}function SC(){let e=OC(),t=bC(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const TC=w.createElement(SC,null);class CC extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(ds.Provider,{value:this.props.routeContext},w.createElement(Vw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jC(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(k0);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(ds.Provider,{value:t},n)}function AC(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||kt(!1),l=l.slice(0,Math.min(l.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:p}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||g){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let p,g=!1,b=null,E=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,b=h.route.errorElement||TC,u&&(c<0&&f===0?(DC("route-fallback"),g=!0,E=null):c===f&&(g=!0,E=h.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),y=()=>{let v;return p?v=b:g?v=E:h.route.Component?v=w.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=d,w.createElement(jC,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(CC,{location:r.location,revalidation:r.revalidation,component:b,error:p,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var Yw=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Yw||{}),Qw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Qw||{});function IC(e){let t=w.useContext(k0);return t||kt(!1),t}function RC(e){let t=w.useContext(wC);return t||kt(!1),t}function LC(e){let t=w.useContext(ds);return t||kt(!1),t}function Kw(e){let t=LC(),r=t.matches[t.matches.length-1];return r.route.id||kt(!1),r.route.id}function OC(){var e;let t=w.useContext(Vw),r=RC(),n=Kw();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function PC(){let{router:e}=IC(Yw.UseNavigateStable),t=Kw(Qw.UseNavigateStable),r=w.useRef(!1);return Ww(()=>{r.current=!0}),w.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ru({fromRouteId:t},i)))},[e,t])}const Fx={};function DC(e,t,r){Fx[e]||(Fx[e]=!0)}const Ux={};function MC(e,t){Ux[t]||(Ux[t]=!0,console.warn(t))}const Bx=(e,t,r)=>MC(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function FC(e,t){(e==null?void 0:e.v7_startTransition)===void 0&&Bx("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&Bx("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function No(e){let{to:t,replace:r,state:n,relative:s}=e;Tl()||kt(!1);let{future:i,static:l}=w.useContext(da),{matches:o}=w.useContext(ds),{pathname:u}=ha(),c=Xr(),d=N0(t,_0(o,i.v7_relativeSplatPath),u,s==="path"),h=JSON.stringify(d);return w.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function Fr(e){kt(!1)}function UC(e){let{basename:t="/",children:r=null,location:n,navigationType:s=qs.Pop,navigator:i,static:l=!1,future:o}=e;Tl()&&kt(!1);let u=t.replace(/^\/*/,"/"),c=w.useMemo(()=>({basename:u,navigator:i,static:l,future:ru({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Sl(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:g="default"}=n,b=w.useMemo(()=>{let E=E0(d,u);return E==null?null:{location:{pathname:E,search:h,hash:f,state:p,key:g},navigationType:s}},[u,d,h,f,p,g,s]);return b==null?null:w.createElement(da.Provider,{value:c},w.createElement(Zd.Provider,{children:r,value:b}))}function Hx(e){let{children:t,location:r}=e;return NC(zm(t),r)}new Promise(()=>{});function zm(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let i=[...t,s];if(n.type===w.Fragment){r.push.apply(r,zm(n.props.children,i));return}n.type!==Fr&&kt(!1),!n.props.index||!n.props.children||kt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=zm(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.28.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qm.apply(this,arguments)}function BC(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function HC(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $C(e,t){return e.button===0&&(!t||t==="_self")&&!HC(e)}const zC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qC="6";try{window.__reactRouterVersion=qC}catch{}const VC="startTransition",$x=ik[VC];function WC(e){let{basename:t,children:r,future:n,window:s}=e,i=w.useRef();i.current==null&&(i.current=QT({window:s,v5Compat:!0}));let l=i.current,[o,u]=w.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},d=w.useCallback(h=>{c&&$x?$x(()=>u(h)):u(h)},[u,c]);return w.useLayoutEffect(()=>l.listen(d),[l,d]),w.useEffect(()=>FC(n),[n]),w.createElement(UC,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const GC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",YC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vm=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:d,viewTransition:h}=t,f=BC(t,zC),{basename:p}=w.useContext(da),g,b=!1;if(typeof c=="string"&&YC.test(c)&&(g=c,GC))try{let v=new URL(window.location.href),N=c.startsWith("//")?new URL(v.protocol+c):new URL(c),_=E0(N.pathname,p);N.origin===v.origin&&_!=null?c=_+N.search+N.hash:b=!0}catch{}let E=EC(c,{relative:s}),x=QC(c,{replace:l,state:o,target:u,preventScrollReset:d,relative:s,viewTransition:h});function y(v){n&&n(v),v.defaultPrevented||x(v)}return w.createElement("a",qm({},f,{href:g||E,onClick:b||i?n:y,ref:r,target:u}))});var zx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(zx||(zx={}));var qx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(qx||(qx={}));function QC(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=Xr(),c=ha(),d=Gw(e,{relative:l});return w.useCallback(h=>{if($C(h,r)){h.preventDefault();let f=n!==void 0?n:gd(c)===gd(d);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,d,n,s,r,e,i,l,o])}const KC="modulepreload",ZC=function(e){return"/"+e},Vx={},hl=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=ZC(u),u in Vx)return;Vx[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":KC,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},XC=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hl(async()=>{const{default:n}=await Promise.resolve().then(()=>Cl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class T0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class JC extends T0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ej extends T0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tj extends T0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Wm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Wm||(Wm={}));var rj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class nj{constructor(t,{headers:r={},customFetch:n,region:s=Wm.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=XC(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return rj(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:l}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let c;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=l):typeof l=="string"?(o["Content-Type"]="text/plain",c=l):typeof FormData<"u"&&l instanceof FormData?c=l:(o["Content-Type"]="application/json",c=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(g=>{throw new JC(g)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new ej(d);if(!d.ok)throw new tj(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var yr={},C0={},Xd={},Ru={},Jd={},eh={},sj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fl=sj();const aj=fl.fetch,Zw=fl.fetch.bind(fl),Xw=fl.Headers,ij=fl.Request,lj=fl.Response,Cl=Object.freeze(Object.defineProperty({__proto__:null,Headers:Xw,Request:ij,Response:lj,default:Zw,fetch:aj},Symbol.toStringTag,{value:"Module"})),oj=qN(Cl);var th={};Object.defineProperty(th,"__esModule",{value:!0});let uj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};th.default=uj;var Jw=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(eh,"__esModule",{value:!0});const cj=Jw(oj),dj=Jw(th);let hj=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=cj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,u;let c=null,d=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const b=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),E=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");b&&E&&E.length>1&&(h=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,p="OK")}catch{i.status===404&&b===""?(f=204,p="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new dj.default(c)}return{error:c,data:d,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var l,o,u;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};eh.default=hj;var fj=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jd,"__esModule",{value:!0});const mj=fj(eh);let pj=class extends mj.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:l="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${c}"; options=${u};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Jd.default=pj;var gj=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ru,"__esModule",{value:!0});const xj=gj(Jd);let yj=class extends xj.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Ru.default=yj;var bj=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xd,"__esModule",{value:!0});const Gl=bj(Ru);let vj=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&(this.headers.Prefer=`count=${n}`),new Gl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const l=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new Gl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const l="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Gl.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new Gl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Gl.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Xd.default=vj;var rh={},nh={};Object.defineProperty(nh,"__esModule",{value:!0});nh.version=void 0;nh.version="0.0.0-automated";Object.defineProperty(rh,"__esModule",{value:!0});rh.DEFAULT_HEADERS=void 0;const wj=nh;rh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${wj.version}`};var e2=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(C0,"__esModule",{value:!0});const Ej=e2(Xd),_j=e2(Ru),Nj=rh;let kj=class t2{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},Nj.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new Ej.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new t2(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let l;const o=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new _j.default({method:l,url:o,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};C0.default=kj;var jl=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yr,"__esModule",{value:!0});yr.PostgrestError=yr.PostgrestBuilder=yr.PostgrestTransformBuilder=yr.PostgrestFilterBuilder=yr.PostgrestQueryBuilder=yr.PostgrestClient=void 0;const r2=jl(C0);yr.PostgrestClient=r2.default;const n2=jl(Xd);yr.PostgrestQueryBuilder=n2.default;const s2=jl(Ru);yr.PostgrestFilterBuilder=s2.default;const a2=jl(Jd);yr.PostgrestTransformBuilder=a2.default;const i2=jl(eh);yr.PostgrestBuilder=i2.default;const l2=jl(th);yr.PostgrestError=l2.default;var Sj=yr.default={PostgrestClient:r2.default,PostgrestQueryBuilder:n2.default,PostgrestFilterBuilder:s2.default,PostgrestTransformBuilder:a2.default,PostgrestBuilder:i2.default,PostgrestError:l2.default};const{PostgrestClient:Tj,PostgrestQueryBuilder:ZU,PostgrestFilterBuilder:XU,PostgrestTransformBuilder:JU,PostgrestBuilder:eB,PostgrestError:tB}=Sj,Cj="2.11.2",jj={"X-Client-Info":`realtime-js/${Cj}`},Aj="1.0.0",o2=1e4,Ij=1e3;var Ui;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ui||(Ui={}));var Sr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Sr||(Sr={}));var on;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(on||(on={}));var Gm;(function(e){e.websocket="websocket"})(Gm||(Gm={}));var ka;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ka||(ka={}));class Rj{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const c=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class u2{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(lt||(lt={}));const Wx=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,l)=>(i[l]=Lj(l,e,t,s),i),{})},Lj=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?c2(i,l):Ym(l)},c2=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Mj(t,r)}switch(e){case lt.bool:return Oj(t);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return Pj(t);case lt.json:case lt.jsonb:return Dj(t);case lt.timestamp:return Fj(t);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return Ym(t);default:return Ym(t)}},Ym=e=>e,Oj=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Pj=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Dj=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Mj=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>c2(t,o))}return e},Fj=e=>typeof e=="string"?e.replace(" ","T"):e,d2=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Xh{constructor(t,r,n={},s=o2){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gx;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gx||(Gx={}));class ko{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ko.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=ko.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ko.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,d)=>{l[c]||(u[c]=d)}),this.map(l,(c,d)=>{const h=i[c];if(h){const f=d.map(E=>E.presence_ref),p=h.map(E=>E.presence_ref),g=d.filter(E=>p.indexOf(E.presence_ref)<0),b=h.filter(E=>f.indexOf(E.presence_ref)<0);g.length>0&&(o[c]=g),b.length>0&&(u[c]=b)}else o[c]=d}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),d.length>0){const h=t[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);t[o].unshift(...f)}n(o,d,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yx;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Yx||(Yx={}));var Qx;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Qx||(Qx={}));var Wn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wn||(Wn={}));class j0{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Sr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xh(this,on.join,this.params,this.timeout),this.rejoinTimer=new u2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Sr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Sr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Sr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Sr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(on.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new ko(this),this.broadcastEndpointURL=d2(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:l,private:o}}=this.params;this._onError(d=>t==null?void 0:t(Wn.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(Wn.CLOSED));const u={},c={broadcast:i,presence:l,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(Wn.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,g=[];for(let b=0;b<p;b++){const E=f[b],{filter:{event:x,schema:y,table:v,filter:N}}=E,_=d&&d[b];if(_&&_.event===x&&_.schema===y&&_.table===v&&_.filter===N)g.push(Object.assign(Object.assign({},E),{id:_.id}));else{this.unsubscribe(),t==null||t(Wn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Wn.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(Wn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Sr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(on.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new Xh(this,on.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Xh(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:d}=on;if(n&&[o,u,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,b,E;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((E=(b=p.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(p=>p.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(p=>{var g,b,E,x,y,v;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in p){const N=p.id,_=(g=p.filter)===null||g===void 0?void 0:g.event;return N&&((b=r.ids)===null||b===void 0?void 0:b.includes(N))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const N=(y=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return N==="*"||N===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===l}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:b,table:E,commit_timestamp:x,type:y,errors:v}=g;f=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:x,eventType:y,new:{},old:{},errors:v}),this._getPayloadRecords(g))}p.callback(f,n)})}_isClosed(){return this.state===Sr.closed}_isJoined(){return this.state===Sr.joined}_isJoining(){return this.state===Sr.joining}_isLeaving(){return this.state===Sr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&j0.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(on.close,{},t)}_onError(t){this._on(on.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Sr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Wx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Wx(t.columns,t.old_record)),r}}const Uj=()=>{},Bj=typeof WebSocket<"u",Hj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $j{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=jj,this.params={},this.timeout=o2,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Uj,this.conn=null,this.sendBuffer=[],this.serializer=new Rj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...o)=>hl(async()=>{const{default:u}=await Promise.resolve().then(()=>Cl);return{default:u}},void 0).then(({default:u})=>u(...o)):l=fetch,(...o)=>l(...o)},this.endPoint=`${t}/${Gm.websocket}`,this.httpEndpoint=d2(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,l)=>l(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new u2(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Bj){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new zj(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),hl(async()=>{const{default:t}=await import("./browser-pbxjT0oa.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Aj}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ui.connecting:return ka.Connecting;case Ui.open:return ka.Open;case Ui.closing:return ka.Closing;default:return ka.Closed}}isConnected(){return this.connectionState()===ka.Open}channel(t,r={config:{}}){const n=new j0(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(on.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Ij,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:l}=r;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${l&&"("+l+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,l)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(on.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Hj],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class zj{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ui.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class A0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Mt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class qj extends A0{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Qm extends A0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Vj=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const h2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hl(async()=>{const{default:n}=await Promise.resolve().then(()=>Cl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Wj=()=>Vj(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield hl(()=>Promise.resolve().then(()=>Cl),void 0)).Response:Response}),Km=e=>{if(Array.isArray(e))return e.map(r=>Km(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Km(n)}),t};var ii=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Jh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Gj=(e,t,r)=>ii(void 0,void 0,void 0,function*(){const n=yield Wj();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new qj(Jh(s),e.status||500))}).catch(s=>{t(new Qm(Jh(s),s))}):t(new Qm(Jh(e),e))}),Yj=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Lu(e,t,r,n,s,i){return ii(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,Yj(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>Gj(u,o,n))})})}function xd(e,t,r,n){return ii(this,void 0,void 0,function*(){return Lu(e,"GET",t,r,n)})}function Ts(e,t,r,n,s){return ii(this,void 0,void 0,function*(){return Lu(e,"POST",t,n,s,r)})}function Qj(e,t,r,n,s){return ii(this,void 0,void 0,function*(){return Lu(e,"PUT",t,n,s,r)})}function Kj(e,t,r,n){return ii(this,void 0,void 0,function*(){return Lu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function f2(e,t,r,n,s){return ii(this,void 0,void 0,function*(){return Lu(e,"DELETE",t,n,s,r)})}var hr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const Zj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xj{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=h2(s)}uploadOrUpdate(t,r,n,s){return hr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Kx),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Mt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return hr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return hr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:Kx.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(Mt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return hr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Ts(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new A0("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(n){if(Mt(n))return{data:null,error:n};throw n}})}update(t,r,n){return hr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return hr(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return hr(this,void 0,void 0,function*(){try{return{data:{path:(yield Ts(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return hr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Ts(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return hr(this,void 0,void 0,function*(){try{const s=yield Ts(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}})}download(t,r){return hr(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield xd(this.fetch,`${this.url}/${s}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Mt(o))return{data:null,error:o};throw o}})}info(t){return hr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield xd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Km(n),error:null}}catch(n){if(Mt(n))return{data:null,error:n};throw n}})}exists(t){return hr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Kj(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Mt(n)&&n instanceof Qm){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return hr(this,void 0,void 0,function*(){try{return{data:yield f2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}})}list(t,r,n){return hr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Zj),r),{prefix:t||""});return{data:yield Ts(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Jj="2.7.1",e3={"X-Client-Info":`storage-js/${Jj}`};var ci=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class t3{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},e3),r),this.fetch=h2(n)}listBuckets(){return ci(this,void 0,void 0,function*(){try{return{data:yield xd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Mt(t))return{data:null,error:t};throw t}})}getBucket(t){return ci(this,void 0,void 0,function*(){try{return{data:yield xd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ci(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Mt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ci(this,void 0,void 0,function*(){try{return{data:yield Qj(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Mt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ci(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ci(this,void 0,void 0,function*(){try{return{data:yield f2(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}})}}class r3 extends t3{constructor(t,r={},n){super(t,r,n)}from(t){return new Xj(this.url,this.headers,t,this.fetch)}}const n3="2.49.4";let oo="";typeof Deno<"u"?oo="deno":typeof document<"u"?oo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?oo="react-native":oo="node";const s3={"X-Client-Info":`supabase-js-${oo}/${n3}`},a3={headers:s3},i3={schema:"public"},l3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},o3={};var u3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};const c3=e=>{let t;return e?t=e:typeof fetch>"u"?t=Zw:t=fetch,(...r)=>t(...r)},d3=()=>typeof Headers>"u"?Xw:Headers,h3=(e,t,r)=>{const n=c3(r),s=d3();return(i,l)=>u3(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},l),{headers:c}))})};var f3=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};function m3(e){return e.replace(/\/$/,"")}function p3(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:l,auth:o,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>f3(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const m2="2.69.1",pi=30*1e3,Zm=3,ef=Zm*pi,g3="http://localhost:9999",x3="supabase.auth.token",y3={"X-Client-Info":`gotrue-js/${m2}`},Xm="X-Supabase-Api-Version",p2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},b3=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,v3=6e5;class I0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Me(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class w3 extends I0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function E3(e){return Me(e)&&e.name==="AuthApiError"}class g2 extends I0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fa extends I0{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ws extends fa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _3(e){return Me(e)&&e.name==="AuthSessionMissingError"}class tf extends fa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class hc extends fa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fc extends fa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function N3(e){return Me(e)&&e.name==="AuthImplicitGrantRedirectError"}class Zx extends fa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jm extends fa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function rf(e){return Me(e)&&e.name==="AuthRetryableFetchError"}class Xx extends fa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class So extends fa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ey=` 	
\r=`.split(""),k3=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ey.length;t+=1)e[ey[t].charCodeAt(0)]=-2;for(let t=0;t<Jx.length;t+=1)e[Jx[t].charCodeAt(0)]=t;return e})();function x2(e,t,r){const n=k3[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ty(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{C3(l,n,r)};for(let l=0;l<e.length;l+=1)x2(e.charCodeAt(l),s,i);return t.join("")}function S3(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function T3(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}S3(n,t)}}function C3(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function j3(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)x2(e.charCodeAt(s),r,n);return new Uint8Array(t)}function A3(e){const t=[];return T3(e,r=>t.push(r)),new Uint8Array(t)}function I3(e){return Math.round(Date.now()/1e3)+e}function R3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const En=()=>typeof window<"u"&&typeof document<"u",ba={tested:!1,writable:!1},To=()=>{if(!En())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ba.tested)return ba.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ba.tested=!0,ba.writable=!0}catch{ba.tested=!0,ba.writable=!1}return ba.writable};function L3(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const y2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hl(async()=>{const{default:n}=await Promise.resolve().then(()=>Cl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},O3=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",b2=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},mc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pc=async(e,t)=>{await e.removeItem(t)};class sh{constructor(){this.promise=new sh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}sh.promiseConstructor=Promise;function nf(e){const t=e.split(".");if(t.length!==3)throw new So("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!b3.test(t[n]))throw new So("JWT not in base64url format");return{header:JSON.parse(ty(t[0])),payload:JSON.parse(ty(t[1])),signature:j3(t[2]),raw:{header:t[0],payload:t[1]}}}async function P3(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function D3(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function M3(e){return("0"+e.toString(16)).substr(-2)}function F3(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,M3).join("")}async function U3(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function B3(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await U3(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function di(e,t,r=!1){const n=F3();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await b2(e,`${t}-code-verifier`,s);const i=await B3(n);return[i,n===i?"plain":"s256"]}const H3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $3(e){const t=e.headers.get(Xm);if(!t||!t.match(H3))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function z3(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function q3(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var V3=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Na=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),W3=[502,503,504];async function ry(e){var t;if(!O3(e))throw new Jm(Na(e),0);if(W3.includes(e.status))throw new Jm(Na(e),e.status);let r;try{r=await e.json()}catch(i){throw new g2(Na(i),i)}let n;const s=$3(e);if(s&&s.getTime()>=p2["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Xx(Na(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ws}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Xx(Na(r),e.status,r.weak_password.reasons);throw new w3(Na(r),e.status||500,n)}const G3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ge(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Xm]||(i[Xm]=p2["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await Y3(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Y3(e,t,r,n,s,i){const l=G3(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new Jm(Na(u),0)}if(o.ok||await ry(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await ry(u)}}function Es(e){var t;let r=null;X3(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=I3(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function ny(e){const t=Es(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Is(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Q3(e){return{data:e,error:null}}function K3(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=V3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function Z3(e){return e}function X3(e){return e.access_token&&e.refresh_token&&e.expires_in}var J3=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class eA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=y2(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ge(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ge(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Is})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=J3(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Ge(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:K3,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Me(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Is})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},d=await Ge(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Z3});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,p=(u=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(g.split(";")[1].split("=")[1]);c[`${E}Page`]=b}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Me(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ge(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Is})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ge(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Is})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Is})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ge(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}}const tA={getItem:e=>To()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{To()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{To()&&globalThis.localStorage.removeItem(e)}};function sy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function rA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const hi={debug:!!(globalThis&&To()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class v2 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class nA extends v2{}async function sA(e,t,r){hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),hi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new nA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(hi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}rA();const aA={url:g3,storageKey:x3,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:y3,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ay(e,t,r){return await r()}class nu{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=nu.nextInstanceID,nu.nextInstanceID+=1,this.instanceID>0&&En()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},aA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new eA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=y2(s.fetch),this.lock=s.lock||ay,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:En()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=sA:this.lock=ay,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:To()?this.storage=tA:(this.memoryStorage={},this.storage=sy(this.memoryStorage)):(this.memoryStorage={},this.storage=sy(this.memoryStorage)),En()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${m2}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=L3(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),En()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),N3(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Me(r)?{error:r}:{error:new g2("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Es}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Me(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await di(this.storage,this.storageKey)),i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:Es})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Es})}else throw new hc("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(Me(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ny})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ny})}else throw new hc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new tf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await mc(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:l}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Es});if(await pc(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new tf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(Me(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Es}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new tf}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await di(this.storage,this.storageKey));const{error:h}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:d}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new hc("You must provide either an email or phone number.")}catch(o){if(Me(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Ge(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Es});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Me(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await di(this.storage,this.storageKey)),await Ge(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:Q3})}catch(i){if(Me(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ws;const{error:s}=await Ge(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Me(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new hc("You must provide either an email or phone number and a type")}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await mc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ef:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!l&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Is}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ws}:await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Is})})}catch(r){if(Me(r))return _3(r)&&(await this._removeSession(),await pc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new ws;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await di(this.storage,this.storageKey));const{data:c,error:d}=await Ge(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:Is});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ws;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=nf(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Me(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ws;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Me(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!En())throw new fc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Zx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Zx("No code detected.");const{data:y,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new fc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;u&&(f=parseInt(u));const p=f-d;p*1e3<=pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=f-h;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:b,error:E}=await this._getUser(i);if(E)throw E;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Me(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await mc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(E3(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await pc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=R3(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await di(this.storage,this.storageKey,!0));try{return await Ge(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Me(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Ge(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return En()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Me(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await Ge(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await D3(async s=>(s>0&&await P3(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ge(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Es})),(s,i)=>{const l=200*Math.pow(2,s);return i&&rf(i)&&Date.now()+l-n<pi})}catch(n){if(this._debug(r,"error",n),Me(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),En()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await mc(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ef;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${ef}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),rf(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ws;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new sh;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new ws;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Me(i)){const l={session:null,error:i};return rf(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await b2(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await pc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&En()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),pi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${pi}ms, refresh threshold is ${Zm} ticks`),s<=Zm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof v2)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!En()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await di(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ge(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await Ge(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(Me(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Me(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=nf(s.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n||(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+v3>Date.now()))return n;const{data:s,error:i}=await Ge(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new So("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(l=>l.kid===t),!n)throw new So("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=nf(n);if(z3(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:l},error:null}}const c=q3(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,l,A3(`${o}.${u}`)))throw new So("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}}nu.nextInstanceID=0;const iA=nu;class lA extends iA{constructor(t){super(t)}}var oA=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function u(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?i(d.value):s(d.value).then(o,u)}c((n=n.apply(e,t||[])).next())})};class uA{constructor(t,r,n){var s,i,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=m3(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:i3,realtime:o3,auth:Object.assign(Object.assign({},l3),{storageKey:u}),global:a3},d=p3(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=h3(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Tj(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new nj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new r3(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return oA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:l,lock:o,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:l,lock:o,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new $j(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cA=(e,t,r)=>new uA(e,t,r),dA="https://tkenxulvmzhhkuhfvcpt.supabase.co",hA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrZW54dWx2bXpoaGt1aGZ2Y3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgwOTEwNzgsImV4cCI6MjA1MzY2NzA3OH0.UJPzvtHD6k6rJ09BlFYkdYEyHC3sx3h1rpAG8DULSHI",sf={maxRetries:3,retryDelay:1e3,retryCondition:e=>{var t,r,n,s,i;return(e==null?void 0:e.status)===500||(e==null?void 0:e.status)===503||(e==null?void 0:e.status)===504||(e==null?void 0:e.status)===429||((t=e==null?void 0:e.message)==null?void 0:t.includes("Database error"))||((r=e==null?void 0:e.message)==null?void 0:r.includes("unexpected_failure"))||((n=e==null?void 0:e.message)==null?void 0:n.includes("schema"))||((s=e==null?void 0:e.message)==null?void 0:s.includes("network"))||((i=e==null?void 0:e.message)==null?void 0:i.includes("timeout"))}},re=cA(dA,hA,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"dragonbane_auth",flowType:"implicit"},global:{headers:{"X-Client-Info":"dragonbane-character-manager"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}},maxRetries:sf.maxRetries,retryDelay:sf.retryDelay,retryCondition:sf.retryCondition});re.auth.onAuthStateChange((e,t)=>{(e==="USER_DELETED"||e==="SIGNED_OUT")&&console.log("Auth event:",e),e==="TOKEN_REFRESHED"&&console.log("Token refreshed successfully"),e==="SIGNED_OUT"&&!t&&console.error("Auth error: Session ended unexpectedly")});window.addEventListener("online",()=>{re.auth.startAutoRefresh()});window.addEventListener("offline",()=>{re.auth.stopAutoRefresh()});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),w2=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},u)=>w.createElement("svg",{ref:u,...mA,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:w2("lucide",s),...o},[...l.map(([c,d])=>w.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=(e,t)=>{const r=w.forwardRef(({className:n,...s},i)=>w.createElement(pA,{ref:i,iconNode:t,className:w2(`lucide-${fA(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=ne("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=ne("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z",key:"wvr1b5"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}],["path",{d:"M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5",key:"xk3gvk"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=ne("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=ne("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=ne("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=ne("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=ne("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=ne("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=ne("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=ne("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=ne("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=ne("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=ne("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=ne("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=ne("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=ne("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=ne("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=ne("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=ne("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vA=ne("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=ne("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=ne("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=ne("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=ne("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=ne("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=ne("Dice4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=ne("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _A=ne("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=ne("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=ne("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=ne("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=ne("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=ne("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=ne("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=ne("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=ne("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=ne("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=ne("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=ne("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=ne("LampDesk",[["path",{d:"m14 5-3 3 2 7 8-8-7-2Z",key:"1b0msb"}],["path",{d:"m14 5-3 3-3-3 3-3 3 3Z",key:"1uemms"}],["path",{d:"M9.5 6.5 4 12l3 6",key:"1bx08v"}],["path",{d:"M3 22v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2H3Z",key:"wap775"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=ne("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=ne("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=ne("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=ne("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=ne("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=ne("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=ne("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=ne("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=ne("Notebook",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=ne("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=ne("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=ne("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=ne("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=ne("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=ne("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=ne("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=ne("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=ne("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=ne("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=ne("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=ne("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=ne("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=ne("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=ne("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=ne("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=ne("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=ne("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=ne("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=ne("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=ne("SquareMinus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=ne("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=ne("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=ne("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=ne("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=ne("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=ne("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=ne("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=ne("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=ne("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=ne("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=ne("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=ne("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=ne("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=ne("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=ne("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),q2=w.createContext(void 0);function VA({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(!1),[i,l]=w.useState(null);return a.jsxs(q2.Provider,{value:{setGlobalError:r,setGlobalLoading:s,setGlobalWarning:l},children:[n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})})}),i&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(B0,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-yellow-700",children:i})}),a.jsx("button",{onClick:()=>l(null),className:"text-yellow-500 hover:text-yellow-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]})})}),t&&a.jsx("div",{className:"fixed top-4 right-4 max-w-sm z-50",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg shadow-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Et,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-700",children:t})}),a.jsx("button",{onClick:()=>r(null),className:"text-red-500 hover:text-red-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]})})}),e]})}function V2(){const e=w.useContext(q2);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}async function WA(e,t,r,n){const{data:s,error:i}=await re.auth.signUp({email:e,password:t,options:{data:{username:r.trim(),role:n}}});if(i)throw i.message.includes("User already registered")?new Error("An account with this email already exists."):(console.error("Sign up error (auth):",i.message),new Error(`Authentication error: ${i.message}`));if(!s.user)throw console.error("Sign up error: User object not returned after sign up."),new Error("Sign up failed: Could not retrieve user information.");const{error:l}=await re.from("users").insert({id:s.user.id,username:r.trim(),role:n,email:e});if(l)throw console.error("Sign up error (profile creation):",l.message),new Error(`Account created, but failed to set up user profile: ${l.message}. Please contact support.`);return s.user}async function GA(e,t){const{data:r,error:n}=await re.auth.signInWithPassword({email:e,password:t});if(n)throw n;if(r.user){const{error:s}=await re.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.user.id);s&&console.error("Failed to update user timestamps on login:",s.message)}if(!r.session){const{data:s,error:i}=await re.auth.getSession();if(i)throw i;return{user:r.user,session:s.session}}return{user:r.user,session:r.session}}async function YA(){const{error:e}=await re.auth.signOut();if(e)throw console.error("Sign out error:",e.message),e}const gy=["player","dm","admin"],W2=w.createContext(void 0);function Ot(){const e=w.useContext(W2);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function QA({children:e}){const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState(!0),[c,d]=w.useState(!1),h=Xr(),{setGlobalError:f}=V2(),p=w.useCallback(async _=>{var S,R,j;try{const{data:D,error:T}=await re.auth.getSession();if(T)console.error("[fetchUserRole] Error getting session for metadata check:",T.message);else{const H=(j=(R=(S=D==null?void 0:D.session)==null?void 0:S.user)==null?void 0:R.user_metadata)==null?void 0:j.role;if(H&&gy.includes(H))return H}const{data:F,error:O,status:Q}=await re.from("users").select("role").eq("id",_).single();if(O)return O.code==="PGRST116"||Q===404?"player":Q===401||Q===403?(f("Permission issue accessing user data. Please contact support if this persists."),"player"):(console.error("[fetchUserRole] Database error fetching role from table:",O),f("Failed to retrieve user role data due to a database error."),"player");const Y=F==null?void 0:F.role;return Y&&gy.includes(Y)?Y:"player"}catch(D){return console.error("[fetchUserRole] Unexpected error during role fetch process:",D),f("Failed to determine user role due to an unexpected error."),"player"}},[f]);w.useEffect(()=>{u(!0),re.auth.getSession().then(({data:{session:_}})=>{s(_),r((_==null?void 0:_.user)??null),_!=null&&_.user||u(!1)}).catch(_=>{console.error("Error getting initial session:",_),f("Failed to initialize user session."),s(null),r(null),l(null),u(!1)})},[]),w.useEffect(()=>{const{data:_}=re.auth.onAuthStateChange(async(S,R)=>{const j=(R==null?void 0:R.user)??null;s(R),r(j),S==="SIGNED_OUT"?(l(null),u(!1),f(null),h("/login")):S==="SIGNED_IN"&&window.location.pathname==="/login"&&j&&h("/")});return()=>{var S;(S=_==null?void 0:_.subscription)==null||S.unsubscribe()}},[h,f]),w.useEffect(()=>{t?(o||u(!0),p(t.id).then(_=>{l(_)}).catch(_=>{l("player")}).finally(()=>{u(!1)})):(l(null),o&&u(!1))},[t,p]);const g=async(_,S,R,j)=>{try{d(!0),f(null),await WA(_,S,R,j)}catch(D){throw f(D instanceof Error?D.message:"Signup failed"),D}finally{d(!1)}},b=async(_,S)=>{try{d(!0),f(null),await GA(_,S)}catch(R){let j="Authentication failed. Please check your credentials.";throw R instanceof Error&&(R.message.includes("Invalid login credentials")?j="Incorrect email or password.":R.message.includes("Email not confirmed")?j="Please verify your email address before logging in.":R.message.includes("network error")||R.message.includes("Failed to fetch")?j="Network error. Please check your connection and try again.":j=R.message.length>100?"An unexpected authentication error occurred.":R.message),f(j),new Error(j)}finally{d(!1)}},E=w.useCallback(async()=>{if(!c)try{d(!0),await YA()}catch(_){console.error("Sign out error:",_),f("Failed to sign out")}finally{d(!1)}},[f,c]),x=()=>i==="admin",y=()=>i==="dm"||i==="admin",v=()=>i==="player",N=o||c;return a.jsx(W2.Provider,{value:{user:t,session:n,role:i,isLoading:N,signIn:b,signUp:g,signOut:E,isAdmin:x,isDM:y,isPlayer:v},children:e})}const G2=w.createContext(void 0),gc=30*60*1e3,xy=30*1e3,KA=10*1e3;function ZA({children:e}){const{signOut:t}=Ot(),r=Xr(),n=w.useRef(Date.now()),s=w.useRef(null),i=w.useRef(null),[l,o]=w.useState(!1),u=w.useCallback(()=>{s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{o(!0)},gc-xy),s.current=setTimeout(async()=>{await t(),r("/login",{state:{message:"Your session has expired due to inactivity."}})},gc),n.current=Date.now(),o(!1)},[t,r]),c=w.useCallback(()=>{u()},[u]);return w.useEffect(()=>{const d=["mousedown","keydown","scroll","mousemove","click","touchstart"];let h;function f(g,b){let E;return function(...y){const v=()=>{clearTimeout(E),g(...y)};clearTimeout(E),E=setTimeout(v,b)}}const p=f(()=>{Date.now()-n.current>1e3&&u()},1e3);return d.forEach(g=>{document.addEventListener(g,p)}),h=window.setInterval(()=>{const g=Date.now()-n.current;g>=gc-xy&&o(!0),g>=gc&&(t(),r("/login",{state:{message:"Your session has expired due to inactivity."}}))},KA),u(),()=>{d.forEach(g=>{document.removeEventListener(g,p)}),s.current&&clearTimeout(s.current),i.current&&clearTimeout(i.current),window.clearInterval(h)}},[u,t,r]),a.jsx(G2.Provider,{value:{showWarning:l,extendSession:c},children:e})}function XA(){const e=w.useContext(G2);if(e===void 0)throw new Error("useSessionTimeout must be used within a SessionTimeoutProvider");return e}const kn=class kn{constructor(){Wu(this,"environment");this.environment="production"}static getInstance(){return kn.instance||(kn.instance=new kn),kn.instance}logError(t,r={},n="medium"){const s={error:t,context:{...r,timestamp:new Date().toISOString(),path:window.location.pathname},severity:n};this.environment==="development"&&console.error("Error Report:",{message:t.message,stack:t.stack,...s.context,severity:n}),this.environment==="production"&&this.sendToErrorTrackingService(s)}async sendToErrorTrackingService(t){try{console.error("Production Error:",t)}catch(r){console.error("Failed to send error report:",r)}}static handleError(t,r){const n=kn.getInstance();t instanceof Error?n.logError(t,r):n.logError(new Error(String(t)),r)}static handleNetworkError(t,r){const n=kn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("network")||t.message.toLowerCase().includes("connection")||t.message.toLowerCase().includes("offline");n.logError(t,{...r,additionalData:{isNetworkError:s}},s?"high":"medium")}}static handleAuthError(t,r){const n=kn.getInstance();if(t instanceof Error){const s=t.message.toLowerCase().includes("auth")||t.message.toLowerCase().includes("unauthorized")||t.message.toLowerCase().includes("forbidden");n.logError(t,{...r,additionalData:{isAuthError:s}},s?"high":"medium")}}};Wu(kn,"instance");let $i=kn;class JA extends w.Component{constructor(r){super(r);Wu(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){$i.handleError(r,{action:"render",additionalData:{componentStack:n.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(B0,{className:"w-8 h-8 text-red-500"}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Something went wrong"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. The application has encountered an unexpected error."}),this.state.error&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-red-700 font-mono break-all",children:this.state.error.message||"No error message available"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(M2,{className:"w-5 h-5"}),"Refresh Page"]}),a.jsxs(Vm,{to:"/",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(TA,{className:"w-5 h-5"}),"Go Home"]})]})]})}):this.props.children}}const Y2=new LT({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1,retry:1}}}),Q2=w.createContext(void 0),e4=20;function t4({children:e}){const[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState(!1),[h,f]=w.useState(!1),p=w.useCallback(_=>{r(S=>{const R=!S;if(R){s(_||null);let j=(_==null?void 0:_.initialDice)||[];(_==null?void 0:_.rollMode)==="deathRoll"?j=["d20"]:(_==null?void 0:_.rollMode)==="recoveryRoll"?j=["d6"]:(_==null?void 0:_.rollMode)==="rallyRoll"?j=["d20"]:(_==null?void 0:_.rollMode)==="skillCheck"&&!_.initialDice?j=["d20"]:(_==null?void 0:_.rollMode)==="advancementRoll"&&(j=["d20"]),l(j),d(!1),f((_==null?void 0:_.requiresBane)||(_==null?void 0:_.rollMode)==="rallyRoll"||!1)}else s(null),l([]),d(!1),f(!1);return R})},[]),g=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l(S=>[...S,_]),(c||h)&&(d(!1),f(!1)))},[c,h,n]),b=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||l(S=>{if(S.length===0)return[];if(_){const R=S.lastIndexOf(_);if(R!==-1){const j=[...S];return j.splice(R,1),j}}return S.slice(0,-1)})},[n]),E=w.useCallback(()=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(l([]),d(!1),f(!1))},[n]),x=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(_?(d(!0),f(!1),l(["d20"])):d(!1))},[n]),y=w.useCallback(_=>{n!=null&&n.rollMode&&["deathRoll","recoveryRoll","rallyRoll","advancementRoll"].includes(n.rollMode)||(_?(f(!0),d(!1),l(["d20"])):(n==null?void 0:n.rollMode)!=="rallyRoll"&&f(!1))},[n]),v=w.useCallback(_=>{u(S=>{const j=[{..._,id:crypto.randomUUID(),timestamp:Date.now()},...S];return j.length>e4&&j.pop(),j})},[]),N=w.useCallback(()=>{u([])},[]);return a.jsx(Q2.Provider,{value:{showDiceRoller:t,currentConfig:n,dicePool:i,rollHistory:o,isBoonActive:c,isBaneActive:h,toggleDiceRoller:p,addDie:g,removeLastDie:b,clearDicePool:E,setBoon:x,setBane:y,addRollToHistory:v,clearHistory:N},children:e})}function ma(){const e=w.useContext(Q2);if(e===void 0)throw new Error("useDice must be used within a DiceProvider");return e}function r4(){const e=ha(),{signOut:t,isAdmin:r,isDM:n,role:s}=Ot(),{toggleDiceRoller:i}=ma(),[l,o]=w.useState(!1),u=w.useRef(null),c=f=>e.pathname===f,d=[{path:"/",label:"Characters",icon:ts,roles:["player","dm","admin"]},{path:"/compendium",label:"Compendium",icon:Ou,roles:["player","dm","admin"]},{path:"/adventure-party",label:"Adventure Party",icon:Xa,roles:["player","dm","admin"]},{path:"/notes",label:"Notes",icon:ml,roles:["player","dm","admin"]},{path:"/settings",label:"Settings",icon:F2,roles:["player","dm","admin"]}],h=()=>{l&&o(!1)};return w.useEffect(()=>{const f=p=>{u.current&&!u.current.contains(p.target)&&o(!1)};return l?document.addEventListener("mousedown",f):document.removeEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[l]),a.jsxs("nav",{className:"bg-gray-800 text-white",ref:u,children:[a.jsx("div",{className:"container mx-auto px-4",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0"}),a.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-4",children:d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(Vm,{to:f,onClick:h,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-5 h-5"}),a.jsx("span",{children:p})]},f))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Open Dice Roller",children:[a.jsx(On,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Dice"})]}),a.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700",title:`Current role: ${s}`,children:[r()?a.jsx(oy,{className:"w-5 h-5 text-yellow-400"}):n()?a.jsx(os,{className:"w-5 h-5 text-blue-400"}):a.jsx(ts,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:r()?"Admin":n()?"DM":"Player"})]}),a.jsxs("button",{onClick:()=>{t(),h()},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",title:"Log Out",children:[a.jsx(dy,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden lg:inline",children:"Log Out"})]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center",children:[a.jsx("button",{onClick:i,className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white mr-2",title:"Open Dice Roller",children:a.jsx(On,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>o(!l),className:"p-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white","aria-expanded":l,"aria-controls":"mobile-menu",children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),l?a.jsx(Lt,{className:"block h-6 w-6"}):a.jsx(RA,{className:"block h-6 w-6"})]})]})]})}),l&&a.jsx("div",{className:"md:hidden absolute top-16 inset-x-0 bg-gray-800 z-50 shadow-lg",id:"mobile-menu",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[d.filter(f=>f.roles.includes(s||"player")).map(({path:f,label:p,icon:g})=>a.jsxs(Vm,{to:f,onClick:h,className:`flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium ${c(f)?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[a.jsx(g,{className:"w-6 h-6"}),a.jsx("span",{children:p})]},f)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-md bg-gray-700 w-full",children:r()?a.jsxs(a.Fragment,{children:[a.jsx(oy,{className:"w-5 h-5 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}):n()?a.jsxs(a.Fragment,{children:[a.jsx(os,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-sm font-medium",children:"DM"})]}):a.jsxs(a.Fragment,{children:[a.jsx(ts,{className:"w-5 h-5 text-green-400"}),a.jsx("span",{className:"text-sm font-medium",children:"Player"})]})})}),a.jsxs("button",{onClick:()=>{t(),h()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:[a.jsx(dy,{className:"w-6 h-6"}),a.jsx("span",{children:"Log Out"})]})]})})]})}function n4({character:e}){const t=r=>r>=16?"text-purple-600":r>=14?"text-blue-600":r>=12?"text-green-600":r>=10?"text-yellow-600":"text-gray-600";return a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.kin," ",e.profession]})]}),a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:e.age})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(os,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:t(e.attributes.STR),children:e.attributes.STR})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D0,{className:"w-4 h-4 text-pink-600"}),a.jsx("span",{className:t(e.attributes.CON),children:e.attributes.CON})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U0,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{className:t(e.attributes.AGL),children:e.attributes.AGL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T2,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:t(e.attributes.INT),children:e.attributes.INT})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pn,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:t(e.attributes.WIL),children:e.attributes.WIL})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ts,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:t(e.attributes.CHA),children:e.attributes.CHA})]})]}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsx("p",{className:"line-clamp-2",children:e.appearance||"No appearance set"})})]})})}const s4={},yy=e=>{let t;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const p=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(g=>g(t,p))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(s4?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,s,u);return u},a4=e=>e?yy(e):yy;var K2={exports:{}},Z2={},X2={exports:{}},J2={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pl=w;function i4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var l4=typeof Object.is=="function"?Object.is:i4,o4=pl.useState,u4=pl.useEffect,c4=pl.useLayoutEffect,d4=pl.useDebugValue;function h4(e,t){var r=t(),n=o4({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return c4(function(){s.value=r,s.getSnapshot=t,lf(s)&&i({inst:s})},[e,r,t]),u4(function(){return lf(s)&&i({inst:s}),e(function(){lf(s)&&i({inst:s})})},[e]),d4(r),r}function lf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!l4(e,r)}catch{return!0}}function f4(e,t){return t()}var m4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f4:h4;J2.useSyncExternalStore=pl.useSyncExternalStore!==void 0?pl.useSyncExternalStore:m4;X2.exports=J2;var p4=X2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oh=w,g4=p4;function x4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var y4=typeof Object.is=="function"?Object.is:x4,b4=g4.useSyncExternalStore,v4=oh.useRef,w4=oh.useEffect,E4=oh.useMemo,_4=oh.useDebugValue;Z2.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=v4(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=E4(function(){function u(p){if(!c){if(c=!0,d=p,p=n(p),s!==void 0&&l.hasValue){var g=l.value;if(s(g,p))return h=g}return h=p}if(g=h,y4(d,p))return g;var b=n(p);return s!==void 0&&s(g,b)?(d=p,g):(d=p,h=b)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,r,n,s]);var o=b4(e,i[0],i[1]);return w4(function(){l.hasValue=!0,l.value=o},[o]),_4(o),o};K2.exports=Z2;var N4=K2.exports;const k4=Od(N4),eE={},{useDebugValue:S4}=Wr,{useSyncExternalStoreWithSelector:T4}=k4;let by=!1;const C4=e=>e;function j4(e,t=C4,r){(eE?"production":void 0)!=="production"&&r&&!by&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),by=!0);const n=T4(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return S4(n),n}const vy=e=>{(eE?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?a4(e):e,r=(n,s)=>j4(t,n,s);return Object.assign(r,t),r},tE=e=>e?vy(e):vy,fs=tE(e=>({step:0,character:{},setStep:t=>e({step:t}),updateCharacter:t=>e(r=>({character:{...r.character,...t}})),resetCharacter:()=>e({character:{},step:0})}));async function A4(){const{data:e,error:t}=await re.from("kin").select("id, name, description, heroic_ability");if(t)throw console.error("Error fetching kin list:",t),new Error(t.message||"Failed to fetch kin list");return e||[]}async function I4(e){if(!e||e.length===0)return[];const t=e.map(s=>s.trim()).filter(s=>s);if(t.length===0)return[];const{data:r,error:n}=await re.from("heroic_abilities").select("id, name, description, willpower_cost, requirement").in("name",t);if(n)throw console.error("Error fetching ability details by names:",n),new Error(n.message||"Failed to fetch ability details");return(r||[]).map(s=>({id:s.id,name:s.name,description:s.description,willpower_cost:s.willpower_cost,requirement:s.requirement}))}function ze({size:e="md",className:t=""}){const r={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-4",lg:"w-12 h-12 border-4"};return a.jsx("div",{className:`flex items-center justify-center ${t}`,role:"status",children:a.jsx("div",{className:`${r[e]} animate-spin rounded-full border-gray-200 border-t-blue-600`,"aria-label":"Loading..."})})}function Ce({message:e,onClose:t}){return e?a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 flex items-start justify-between",role:"alert",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ih,{className:"w-5 h-5 mr-2 flex-shrink-0"}),a.jsx("span",{className:"block sm:inline",children:e})]}),t&&a.jsx("button",{onClick:t,className:"ml-4 p-1 text-red-500 hover:text-red-700 hover:bg-red-200 rounded-full transition-colors","aria-label":"Close error message",children:a.jsx(Lt,{className:"w-4 h-4"})})]}):null}const wy=e=>e?e.split(",").map(t=>t.trim()).filter(t=>t):[];function R4(){const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState(null),{data:s=[],isLoading:i,error:l}=jt({queryKey:["kinListWithHeroicAbility"],queryFn:A4,retry:!1});w.useEffect(()=>{if(e.kin&&s.length>0&&!r){const g=s.find(b=>b.name===e.kin);if(g){n(g.id);const b=wy(g.heroic_ability);JSON.stringify(e.kinAbilityNames)!==JSON.stringify(b)&&t({kinAbilityNames:b})}}},[e.kin,s,r,e.kinAbilityNames,t]);const o=g=>{n(g.id);const b=wy(g.heroic_ability);t({kin:g.name,kinAbilityNames:b})},u=w.useMemo(()=>s.find(g=>g.id===r),[s,r]),c=w.useMemo(()=>e.kinAbilityNames||[],[e.kinAbilityNames]),{data:d=[],isLoading:h,error:f}=jt({queryKey:["abilityDetails",c.sort().join(",")],queryFn:()=>I4(c),enabled:c.length>0,staleTime:10*60*1e3,retry:!1}),p=g=>a.jsxs("div",{className:"mb-4 p-3 border rounded bg-gray-50 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-md text-gray-800",children:g.name}),g.willpower_cost!=null&&a.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:["Willpower Cost: ",g.willpower_cost]}),g.requirement&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requirement: ",g.requirement]}),a.jsx("p",{className:"text-sm text-gray-700 mt-2",children:g.description})]},g.id);if(i)return a.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:a.jsx(ze,{size:"lg"})});if(l){const g=l instanceof Error?l.message:"Failed to load Kin options.";return console.error("Error loading Kin:",l),a.jsx(Ce,{title:"Error Loading Kin",message:g})}return a.jsxs("div",{className:"flex space-x-6 h-[60vh]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Kin List"}),a.jsx("ul",{className:"space-y-1",children:s.map(g=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md text-sm ${r===g.id?"bg-blue-100 font-semibold text-blue-800":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>o(g),children:g.name},g.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:u?a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-1",children:u.name}),a.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:u.description}),a.jsx("hr",{className:"my-4 border-gray-300"}),a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Kin Abilities"}),h?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(ze,{})}):f?a.jsx(Ce,{title:"Error Loading Abilities",message:f.message||"Failed to load ability details."}):d.length>0?d.map(p):c.length>0&&!h?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-orange-600 italic mb-2",children:"Could not fetch full details for the following abilities (check names in database):"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:c.map(g=>a.jsx("li",{children:g},g))})]}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific heroic abilities listed for this Kin."})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"Select a kin from the list to view details and abilities."})})})]})}async function L4(){const{data:e,error:t}=await re.from("professions").select("*").order("name");if(t)throw console.error("Error fetching profession list:",t),new Error(t.message||"Failed to fetch profession list");return e||[]}async function O4(e){const{data:t,error:r}=await re.from("heroic_abilities").select("*").eq("profession",e);if(r)throw console.error("Error fetching heroic abilities:",r),new Error(r.message||"Failed to fetch heroic abilities");return t||[]}async function P4(){const{data:e,error:t}=await re.from("game_spells").select(`
      *,
      magic_schools ( name )
    `).order("name",{ascending:!0});if(t)throw console.error("Error fetching spells:",t),new Error(t.message||"Failed to fetch spells");return e||[]}async function rE(){const{data:e,error:t}=await re.from("magic_schools").select("id, name, description").order("name",{ascending:!0});if(t)throw console.error("Error fetching magic schools:",t),new Error(t.message||"Failed to fetch magic schools");return e||[]}function D4(){const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(null),[u,c]=w.useState(!1),[d,h]=w.useState(null),{data:f=[],isLoading:p,error:g}=jt({queryKey:["professions"],queryFn:L4}),{data:b=[],isLoading:E,error:x}=jt({queryKey:["magicSchools"],queryFn:rE});w.useEffect(()=>{if(e.profession&&f.length>0){const R=f.find(j=>j.name===e.profession);if(R&&(n(R),R.magic_school_id===null&&e.professionHeroicAbilityName&&y(R.name,e.professionHeroicAbilityName),e.professionHeroicAbilityName&&s.length>0)){const j=s.find(D=>D.name===e.professionHeroicAbilityName);j&&o(j)}}},[e.profession,f,e.professionHeroicAbilityName]);const y=async(R,j)=>{c(!0),h(null);try{const T=await O4(R);i(T);const F=j??e.professionHeroicAbilityName;if(F){const O=T.find(Q=>Q.name===F);o(O||null)}else o(null)}catch(D){h(D instanceof Error?D.message:"Failed to load heroic abilities"),i([]),o(null)}finally{c(!1)}};w.useEffect(()=>{r&&r.magic_school_id===null?y(r.name):(i([]),o(null),e.professionHeroicAbilityName&&t({professionHeroicAbilityName:null}))},[r]);const v=R=>{var D;n(R),R.magic_school_id!==null&&((D=b.find(T=>T.id===R.magic_school_id))==null||D.name);const j={profession:R.name,key_attribute:R.key_attribute,magicSchool:R.magic_school_id??null,professionHeroicAbilityName:null};R.magic_school_id!==null&&o(null),t(j)},N=R=>{o(R),t({professionHeroicAbilityName:R.name})},_=R=>{var j;return R===null||b.length===0?null:((j=b.find(D=>D.id===R))==null?void 0:j.name)??`ID: ${R}`},S=(R,j)=>{if(!Array.isArray(R)||R.length===0)return a.jsxs("p",{className:"text-sm text-gray-500",children:["No ",j.toLowerCase()," listed."]});const D=R.filter(T=>typeof T=="string");return D.length===0?a.jsxs("p",{className:"text-sm text-gray-500",children:["No valid ",j.toLowerCase()," listed."]}):a.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:D.map((T,F)=>a.jsx("li",{children:T},F))})};return p||E?a.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:a.jsx(ze,{size:"lg"})}):g||x?a.jsx(Ce,{message:(g==null?void 0:g.message)||(x==null?void 0:x.message)||"Failed to load required data."}):(r&&console.log("Selected Profession Data:",r),a.jsxs("div",{className:"flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6 h-[80vh]",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 overflow-y-auto max-h-[30vh] md:max-h-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4 sticky top-0 bg-white pb-2 z-10",children:"Profession List"}),a.jsx("ul",{className:"space-y-2",children:f.map(R=>a.jsx("li",{className:`cursor-pointer p-2 rounded-md border ${(r==null?void 0:r.id)===R.id?"bg-blue-100 border-blue-300 font-semibold":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>v(R),children:R.name},R.id))})]}),a.jsx("div",{className:"w-full md:w-2/3 md:pl-4 overflow-y-auto max-h-[calc(80vh-30vh-2rem)] md:max-h-full",children:r?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:r.description})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Key Attribute"}),a.jsx("p",{className:"text-gray-700",children:r.key_attribute})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Skills"}),S(r.skills,"Skills")]}),r.starting_equipment&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Starting Equipment"}),S(r.starting_equipment,"Starting Equipment")]}),r.equipment_description&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Equipment Notes"}),S(r.equipment_description,"Equipment Notes")]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Heroic Ability / Magic"}),r.magic_school_id!==null?a.jsxs("p",{className:"text-gray-600",children:["As a mage of the ",a.jsx("strong",{children:_(r.magic_school_id)??"Unknown School"})," school, you don't get a starting heroic ability. Instead, you get your magic."]}):a.jsxs(a.Fragment,{children:[u&&a.jsx(ze,{size:"sm"}),d&&a.jsx(Ce,{message:d}),!u&&!d&&s.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(R=>a.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${(l==null?void 0:l.id)===R.id?"border-green-500 bg-green-50 ring-2 ring-green-300":"border-gray-200 hover:border-green-300 hover:bg-green-50"}`,onClick:()=>N(R),children:[a.jsx("h5",{className:"font-semibold text-lg mb-2",children:R.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:R.description}),a.jsxs("p",{className:"text-sm text-blue-600",children:["Willpower Cost: ",R.willpower_cost??"N/A"," WP"]}),R.requirement&&typeof R.requirement=="string"&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requirement: ",R.requirement]})]},R.id))}):!u&&!d&&a.jsx("p",{className:"text-gray-600",children:"No specific heroic abilities listed for this profession, or none available."})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg sticky bottom-0",children:[a.jsxs("p",{className:"text-blue-800 font-medium",children:["Selected: ",a.jsx("strong",{children:r.name}),r.magic_school_id!==null&&a.jsxs(a.Fragment,{children:[" (Magic School: ",a.jsx("strong",{children:_(r.magic_school_id)??"N/A"}),")"]}),r.magic_school_id===null&&e.professionHeroicAbilityName&&a.jsxs(a.Fragment,{children:[" with Heroic Ability: ",a.jsx("strong",{children:e.professionHeroicAbilityName})]})]}),r.magic_school_id===null&&!e.professionHeroicAbilityName&&s.length>0&&!u&&a.jsx("p",{className:"text-amber-700 mt-2 text-sm",children:"Please select a heroic ability above to continue."}),r.magic_school_id===null&&s.length===0&&!u&&!d&&a.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"No heroic ability selection required for this profession."})]})]}):a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500 text-lg",children:"Select a profession from the list to view details."})})})]}))}const xc={Young:{attributes:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},skillPoints:8},Adult:{attributes:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},skillPoints:10},Old:{attributes:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0},skillPoints:12}};function M4(){const{character:e,updateCharacter:t}=fs(),r=n=>n===0?"No change":n>0?`+${n}`:n;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Details"}),a.jsx("p",{className:"text-gray-600",children:"Choose a name that fits your character's background and select their age category. Age affects your starting attributes and the number of skill points available during character creation."})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Character Name"}),a.jsxs("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Al,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:e.name||"",onChange:n=>t({name:n.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter character name"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Age Category"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Young","Adult","Old"].map(n=>a.jsxs("div",{className:`relative rounded-lg border p-6 cursor-pointer transition-all ${e.age===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>t({age:n}),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(L0,{className:`h-5 w-5 ${e.age===n?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium",children:n})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Attribute Modifiers"}),a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:Object.entries(xc[n].attributes).map(([s,i])=>i!==0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-gray-600",children:[s,":"]}),a.jsx("span",{className:i>0?"text-green-600":"text-red-600",children:r(i)})]},s))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Skill Points"}),a.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[xc[n].skillPoints," points"]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[n==="Young"&&"Quick to learn, physically developing",n==="Adult"&&"Balanced attributes and experience",n==="Old"&&"Wise and knowledgeable, physically declining"]})]})]},n))})]})]}),(e.name||e.age)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[e.name&&a.jsxs("p",{className:"text-green-800",children:["Name: ",a.jsx("strong",{children:e.name})]}),e.age&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-green-800",children:["Age Category: ",a.jsx("strong",{children:e.age})]}),a.jsxs("p",{className:"text-sm text-green-700",children:["Starting Skill Points: ",a.jsx("strong",{children:xc[e.age].skillPoints})]}),Object.entries(xc[e.age].attributes).filter(([n,s])=>s!==0).map(([n,s])=>a.jsxs("p",{className:"text-sm text-green-700",children:[n," Modifier: ",a.jsx("strong",{children:r(s)})]},n))]})]})})]})}const of=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,uf=e=>e<=12?"None":e<=15?"+D4":"+D6",fi=()=>{const e=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);return e.sort((t,r)=>r-t),e.slice(0,3).reduce((t,r)=>t+r,0)},F4=()=>({STR:fi(),CON:fi(),AGL:fi(),INT:fi(),WIL:fi(),CHA:fi()}),U4={Young:{STR:0,CON:1,AGL:1,INT:0,WIL:0,CHA:0},Adult:{STR:0,CON:0,AGL:0,INT:0,WIL:0,CHA:0},Old:{STR:-2,CON:-2,AGL:-2,INT:1,WIL:1,CHA:0}};function B4(){var f,p,g,b,E,x;const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState({STR:{value:((f=e.attributes)==null?void 0:f.STR)||0,baseChance:0},CON:{value:((p=e.attributes)==null?void 0:p.CON)||0,baseChance:0},AGL:{value:((g=e.attributes)==null?void 0:g.AGL)||0,baseChance:0},INT:{value:((b=e.attributes)==null?void 0:b.INT)||0,baseChance:0},WIL:{value:((E=e.attributes)==null?void 0:E.WIL)||0,baseChance:0},CHA:{value:((x=e.attributes)==null?void 0:x.CHA)||0,baseChance:0}}),[s,i]=w.useState(!1),l=y=>e.age?U4[e.age][y]:0,o=(y,v)=>{const N=l(y);return v+N},u=()=>{i(!0);const y=F4(),v=Object.entries(y).reduce((_,[S,R])=>({..._,[S]:o(S,R)}),{}),N=Object.entries(y).reduce((_,[S,R])=>({..._,[S]:{value:R,baseChance:of(o(S,R))}}),{});n(N),t({attributes:v,current_hp:v.CON,current_wp:v.WIL,magic_school:e.magicSchool??null}),i(!1)},c=(y,v)=>{const N=Math.max(3,Math.min(18,parseInt(v)||0)),_=o(y,N),S={...r,[y]:{value:N,baseChance:of(_)}};n(S);const R=Object.entries(S).reduce((j,[D,{value:T}])=>({...j,[D]:o(D,T)}),{});t({attributes:R,current_hp:R.CON,current_wp:R.WIL,magic_school:e.magicSchool??null})},d=()=>{if(!e.kin||!r.AGL.value)return 0;const y={Human:10,Halfling:8,Dwarf:8,Elf:10,Mallard:8,Wolfkin:12}[e.kin],v=o("AGL",r.AGL.value);let N=0;return v<=6?N=-4:v<=9?N=-2:v<=12?N=0:v<=15?N=2:N=4,y+N},h=e.key_attribute;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Assign Attributes"}),a.jsxs("p",{className:"text-gray-600",children:["Roll or manually enter your character's attributes. Each attribute is determined by rolling 4D6 and removing the lowest die, giving you a score between 3 and 18. ",e.age&&"Age modifiers will be automatically applied."]}),e.profession&&a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-blue-800",children:["Selected Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&a.jsxs(a.Fragment,{children:[" (Key Attribute: ",a.jsx("strong",{children:e.key_attribute}),")"]})]})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?a.jsx(M2,{className:"w-5 h-5 animate-spin"}):a.jsx(On,{className:"w-5 h-5"}),"Roll All Attributes"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([y,{value:v,baseChance:N}])=>{const _=l(y),S=o(y,v),R=h===y;return a.jsxs("div",{className:`p-4 border rounded-lg shadow-sm bg-white ${R?"bg-yellow-100 border-yellow-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-lg font-medium",children:y}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Base Chance: ",of(S)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"number",min:"3",max:"18",value:v||"",onChange:j=>c(y,j.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_!==0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Age Modifier:"}),a.jsx("span",{className:_>0?"text-green-600":"text-red-600",children:_>0?`+${_}`:_})]}),v>0&&a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Final Value:"}),a.jsx("span",{className:"font-medium text-blue-600",children:S})]})]}),(y==="STR"||y==="AGL")&&S>12&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Damage Bonus: ",uf(S)]})]},y)})}),e.kin&&Object.values(r).every(y=>y.value>0)&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"Movement"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d()})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"STR Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:uf(o("STR",r.STR.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700",children:"AGL Damage Bonus"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:uf(o("AGL",r.AGL.value))})]})]})}),e.age&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Age Modifiers Applied"}),a.jsxs("p",{className:"text-sm text-amber-700",children:[e.age==="Young"&&"Young: +1 CON, +1 AGL",e.age==="Adult"&&"Adult: No attribute modifiers",e.age==="Old"&&"Old: -2 STR, -2 CON, -2 AGL, +1 INT, +1 WIL"]})]})]})]})}function H4(e){const[t,r]=w.useState([]),[n,s]=w.useState([]),[i,l]=w.useState(!0),[o,u]=w.useState(null);return w.useEffect(()=>{async function c(){try{l(!0),u(null);const{data:d,error:h}=await re.from("game_spells").select("*").eq("rank",0).order("name");if(h)throw h;r(d||[]);let f=re.from("game_spells").select(`
            *,
            magic_schools ( name )
          `).eq("rank",1).order("name");e?f=f.or(`school_id.is.null,school_id.eq.${e}`):f=f.is("school_id",null);const{data:p,error:g}=await f;if(g)throw g;s(p||[])}catch(d){console.error("Error loading spells:",d),u(d instanceof Error?d.message:"Failed to load spells")}finally{l(!1)}}c()},[e]),{tricks:t,spells:n,loading:i,error:o}}const cf={"6d2d7686-da89-4c42-a763-6b143c1dac60":"Elementalist","b500058b-543f-4c44-a097-911102245236":"Mentalist","e7836c1c-517a-41f8-bd71-92ba20d9c9e1":"Animist"};function $4(){var y;const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState("all"),[u,c]=w.useState(1),d=(y=e.profession)==null?void 0:y.includes("Mage"),h=d&&e.magicSchool?e.magicSchool:null;if(!d)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Only mages can learn and cast spells. Continue to the next step."})});if(h===null)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please go back to the Profession step and select a magic school before choosing spells."})]})]})});const{tricks:f,spells:p,loading:g}=H4(h),b=(v,N)=>{N==="trick"?r.includes(v)?n(r.filter(_=>_!==v)):r.length<3&&n([...r,v]):s.includes(v)?i(s.filter(_=>_!==v)):s.length<3&&i([...s,v])},E=p.filter(v=>l==="general"?v.school_id===null:l==="school"?v.school_id===h:v.rank===u);if(g)return a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx(IA,{className:"w-8 h-8 animate-spin text-blue-600"})});const x=()=>{t({spells:{general:[...r,...s.filter(v=>{var N;return((N=p.find(_=>_.name===v))==null?void 0:N.school_id)===null})],school:{name:cf[h]||"Unknown",spells:s.filter(v=>{var N;return((N=p.find(_=>_.name===v))==null?void 0:N.school_id)===h})}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Magic"}),a.jsxs("p",{className:"text-gray-600",children:["As a newly created mage, you may choose three rank 1 spells and three magic tricks. You can select spells from both General Magic and your chosen school of magic (",cf[h]||"General",")."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Your Magic School"}),a.jsx("p",{className:"text-sm text-blue-700",children:cf[h]||"General Magic"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Magic Tricks"}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",r.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(v=>{var N;return a.jsxs("div",{onClick:()=>b(v.name,"trick"),className:`p-4 border rounded-lg cursor-pointer transition-all ${r.includes(v.name)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Hi,{className:`w-5 h-5 ${r.includes(v.name)?"text-purple-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((N=v.magic_schools)==null?void 0:N.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.casting_time]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Rank 1 Spells"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("select",{value:u,onChange:v=>c(parseInt(v.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[...Array(10)].map((v,N)=>a.jsxs("option",{value:N+1,children:["Rank ",N+1]},N+1))}),a.jsx(hs,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:l,onChange:v=>o(v.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Spells"}),a.jsx("option",{value:"general",children:"General Magic"}),a.jsx("option",{value:"school",children:"School Spells"})]})]})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",s.length,"/3"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(v=>{var N;return a.jsxs("div",{onClick:()=>b(v.name,"spell"),className:`p-4 border rounded-lg cursor-pointer transition-all ${s.includes(v.name)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Hi,{className:`w-5 h-5 ${s.includes(v.name)?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium",children:v.name}),a.jsx("span",{className:"text-xs text-gray-500",children:((N=v.magic_schools)==null?void 0:N.name)||"General Magic"})]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:v.description}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[a.jsxs("p",{children:["Range: ",v.range]}),a.jsxs("p",{children:["Duration: ",v.duration]}),v.requirement!=="None"&&a.jsxs("p",{children:["Requirement: ",v.requirement]})]})]},v.name)})})]}),(r.length<3||s.length<3)&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select 3 magic tricks and 3 rank 1 spells to continue."})]})]}),a.jsxs("button",{onClick:x,disabled:r.length<3||s.length<3,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Hi,{className:"w-5 h-5"}),"Save Spell Selections"]})]})}function nE(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null);return w.useEffect(()=>{async function l(){n(!0),i(null),console.log("useSkills: Fetching skills...");try{const{data:o,error:u}=await re.from("game_skills").select("*").order("name");if(u)throw console.error("useSkills: Supabase error fetching skills:",u),new Error(u.message||"Failed to fetch skills from database");if(console.log("useSkills: Raw data received from Supabase:",o),Array.isArray(o)){let d=!1;o.forEach((h,f)=>{if(h&&typeof h=="object"){const p=Object.keys(h);p.length>0&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(p[0])&&(!("id"in h)||!("name"in h))&&(console.warn(`useSkills: Potential problematic object structure found at index ${f}:`,h),d=!0),(typeof h.id!="string"||typeof h.name!="string")&&console.warn(`useSkills: Item at index ${f} missing 'id' or 'name', or they have wrong types:`,h)}else console.warn(`useSkills: Invalid non-object item found in fetched data at index ${f}:`,h),d=!0}),d||console.log("useSkills: Initial check of fetched data structure passed.")}else console.warn("useSkills: Fetched data is not an array:",o);const c=Array.isArray(o)?o:[];t(c),console.log(`useSkills: Successfully processed and set ${c.length} skills.`)}catch(o){console.error("useSkills: Error during fetch or processing:",o);const u=o instanceof Error?o.message:"An unknown error occurred while fetching skills";i(u),t([])}finally{n(!1),console.log("useSkills: Fetch finished.")}}l()},[]),{skills:e,loading:r,error:s}}const yc=e=>{switch(e){case"Young":return 2;case"Adult":return 4;case"Old":return 6;default:return 0}},df=["Animism","Elementalism","Mentalism"],Ey=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"];function z4(){const{character:e,updateCharacter:t}=fs(),{skills:r,loading:n,error:s}=nE(),[i,l]=w.useState([]),[o,u]=w.useState([]),[c,d]=w.useState("profession"),[h,f]=w.useState("all"),[p,g]=w.useState([]),[b,E]=w.useState(!1),[x,y]=w.useState(null),v=w.useMemo(()=>{var A;return(A=e.profession)==null?void 0:A.toLowerCase().includes("mage")},[e.profession]),_=(A=>{if(typeof A=="string")return A;if(typeof A=="object"&&A!==null){if("name"in A&&typeof A.name=="string")return A.name;if("id"in A&&typeof A.id=="string")return A.id}return null})(e.magicSchool);w.useEffect(()=>{async function A(){if(!e.profession){g([]);return}E(!0),y(null);try{const{data:M,error:G}=await re.from("professions").select("skills").eq("name",e.profession).single();if(G)throw new Error(`Failed to load skills for profession: ${e.profession}. ${G.message}`);const k=Array.isArray(M==null?void 0:M.skills)?M.skills.filter(K=>typeof K=="string"):[];g(k)}catch(M){const G=M instanceof Error?M.message:"An unknown error occurred loading profession skills.";y(G),g([])}finally{E(!1)}}A()},[e.profession]);const S=w.useMemo(()=>n||b||!Array.isArray(r)||!Array.isArray(p)?[]:r.filter(A=>A&&typeof A.name=="string"&&p.includes(A.name)),[r,n,b,p]),R=w.useMemo(()=>{if(n||!Array.isArray(r))return[];let A=r.filter(M=>!(!M||typeof M.name!="string"||i.includes(M.name)));switch(v||(A=A.filter(M=>!df.includes(M.name))),h){case"combat":return A.filter(M=>Ey.includes(M.name));case"general":return A.filter(M=>!Ey.includes(M.name)&&!df.includes(M.name));case"magic":return v?A.filter(M=>df.includes(M.name)):[];case"all":default:return A}},[r,n,i,h,v]);w.useEffect(()=>{if(e.trainedSkills&&!Array.isArray(e.trainedSkills))console.error("CRITICAL: character.trainedSkills in store is not an array!",e.trainedSkills);else if(e.trainedSkills){const A=e.trainedSkills.filter(M=>typeof M!="string");A.length>0&&console.error("CRITICAL: character.trainedSkills in store contains non-string items!",A)}},[e.trainedSkills]);const j=(A,M)=>{if(typeof A!="string"||!A){console.error("Invalid skillName passed to handleSkillSelection:",A);return}if(M==="profession")i.includes(A)?l(k=>k.filter(K=>K!==A)):i.length<6&&l(k=>[...k,A]);else{const G=yc(e.age||"");o.includes(A)?u(k=>k.filter(K=>K!==A)):o.length<G&&u(k=>[...k,A])}},D=()=>{if(c==="profession"&&i.length===6)d("additional");else if(c==="additional"&&o.length===yc(e.age||"")){const A=[...new Set([...i,...o])];A.every(M=>typeof M=="string")?(t({trainedSkills:A}),console.log("Skills saved to character state (names):",A)):console.error("CRITICAL: Attempted to save non-string skills to character state!",A)}},T=(A,M)=>{if(!A||typeof A!="object"||typeof A.id!="string"||typeof A.name!="string")return console.error("Invalid skill object passed to renderSkillCard:",A),a.jsx("div",{className:"p-4 border border-red-500 rounded-lg bg-red-50 text-red-700",children:"Invalid Skill Data"});const G=A.name,k=typeof A.description=="string"?A.description:null,K=typeof A.attribute=="string"?A.attribute:null,z=M==="profession"?i.includes(G):o.includes(G),I=i.length>=6,he=o.length>=yc(e.age||""),Ee=M==="profession"&&I&&!z||M==="additional"&&he&&!z;return a.jsxs("div",{onClick:()=>!Ee&&j(G,M),className:`p-4 border rounded-lg transition-all ${Ee?"bg-gray-100 opacity-60 cursor-not-allowed":"cursor-pointer"} ${z?"border-blue-500 bg-blue-50 ring-1 ring-blue-500":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(su,{className:`w-5 h-5 flex-shrink-0 ${z?"text-blue-500":"text-gray-400"}`}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h5",{className:"font-medium",children:G}),K&&a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:K})]})]}),k&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k})]},A.id)};if(n)return a.jsx(ze,{size:"lg",className:"my-8"});if(s)return a.jsx(Ce,{message:`Skills Error: ${s}`,onClose:()=>{}});if(!e.profession||!e.age)return a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession and age first."})});if(v&&!e.magicSchool)return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Magic School Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"As a Mage, please select a magic school first."})]})]})});const F=i.length,O=o.length,Q=6,Y=yc(e.age),H=F===Q,B=O===Y;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Select Skills"}),e.profession&&a.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-sm",children:[a.jsxs("p",{className:"text-indigo-800",children:["Profession: ",a.jsx("strong",{children:e.profession}),e.key_attribute&&` (Key Attribute: ${e.key_attribute})`,v&&_&&` (School: ${_})`]}),a.jsxs("p",{className:"text-indigo-700 mt-1",children:["Age: ",a.jsx("strong",{children:e.age})," (Grants ",Y," additional skill points)"]})]}),a.jsxs("p",{className:"text-gray-600 text-sm",children:[c==="profession"?`Choose ${Q} skills from your profession's list below.`:`Choose ${Y} additional skills based on your age (${e.age}).`,v&&c==="additional"&&" Magic skills are now available.",!v&&c==="additional"&&" Magic skills are not available for your profession."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Selection Progress"}),a.jsx("p",{className:"text-sm text-blue-700",children:c==="profession"?`Professional Skills: ${F}/${Q}`:`Additional Skills: ${O}/${Y}`})]})]}),c==="additional"&&a.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[a.jsx(hs,{className:"w-4 h-4 text-gray-500"}),a.jsx("label",{htmlFor:"skillFilter",className:"text-sm font-medium text-gray-700",children:"Filter:"}),a.jsxs("select",{id:"skillFilter",value:h,onChange:A=>f(A.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Available"}),a.jsx("option",{value:"combat",children:"Combat"}),a.jsx("option",{value:"general",children:"General"}),v&&a.jsx("option",{value:"magic",children:"Magic"})]})]}),c==="profession"&&b&&a.jsx(ze,{size:"md",className:"my-4"}),c==="profession"&&x&&a.jsx(Ce,{message:`Profession Skills Error: ${x}`,onClose:()=>y(null)}),!b&&!x&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c==="profession"&&(Array.isArray(S)?S.map(A=>T(A,"profession")):(console.error("Error: availableProfessionSkillsData is not an array!",S),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Profession skills data is not an array."}))),c==="additional"&&(Array.isArray(R)?R.map(A=>T(A,"additional")):(console.error("Error: remainingSkillsData is not an array!",R),a.jsx("p",{className:"text-red-600 md:col-span-2 lg:col-span-3",children:"Error: Remaining skills data is not an array."}))),c==="profession"&&S.length===0&&!b&&!x&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No specific skills found for the selected profession, or skills failed to load."}),c==="additional"&&R.length===0&&a.jsx("p",{className:"text-gray-500 md:col-span-2 lg:col-span-3",children:"No skills match the current filter or selection."})]}),(c==="profession"&&!H&&F>0||c==="additional"&&!B&&O>0)&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Incomplete Selection"}),a.jsx("p",{className:"text-sm text-amber-700",children:c==="profession"?`Please select ${Q-F} more professional skill(s).`:`Please select ${Y-O} more additional skill(s).`})]})]}),a.jsxs("button",{onClick:D,disabled:c==="profession"&&!H||c==="additional"&&!B||b,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[b?a.jsx(Ta,{className:"w-5 h-5 animate-spin"}):a.jsx(su,{className:"w-5 h-5"}),c==="profession"?"Continue to Additional Skills":"Confirm Skill Selections"]})]})}function sE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=sE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function aE(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=sE(e))&&(n&&(n+=" "),n+=t);return n}const _y=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Ny=aE,q4=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Ny(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(c=>{const d=r==null?void 0:r[c],h=i==null?void 0:i[c];if(d===null)return null;const f=_y(d)||_y(h);return s[c][f]}),o=r&&Object.entries(r).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(g=>{let[b,E]=g;return Array.isArray(E)?E.includes({...i,...o}[b]):{...i,...o}[b]===E})?[...c,h,f]:c},[]);return Ny(e,l,u,r==null?void 0:r.class,r==null?void 0:r.className)},$0="-",V4=e=>{const t=G4(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split($0);return o[0]===""&&o.length!==1&&o.shift(),iE(o,t)||W4(l)},getConflictingClassGroupIds:(l,o)=>{const u=r[l]||[];return o&&n[l]?[...u,...n[l]]:u}}},iE=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?iE(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join($0);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},ky=/^\[(.+)\]$/,W4=e=>{if(ky.test(e)){const t=ky.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},G4=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Q4(Object.entries(e.classGroups),r).forEach(([i,l])=>{rp(l,n,i,t)}),n},rp=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:Sy(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(Y4(s)){rp(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{rp(l,Sy(t,i),r,n)})})},Sy=(e,t)=>{let r=e;return t.split($0).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Y4=e=>e.isThemeGetter,Q4=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,K4=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},lE="!",Z4=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const u=[];let c=0,d=0,h;for(let E=0;E<o.length;E++){let x=o[E];if(c===0){if(x===s&&(n||o.slice(E,E+i)===t)){u.push(o.slice(d,E)),d=E+i;continue}if(x==="/"){h=E;continue}}x==="["?c++:x==="]"&&c--}const f=u.length===0?o:o.substring(d),p=f.startsWith(lE),g=p?f.substring(1):f,b=h&&h>d?h-d:void 0;return{modifiers:u,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:l}):l},X4=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},J4=e=>({cache:K4(e.cacheSize),parseClassName:Z4(e),...V4(e)}),e6=/\s+/,t6=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(e6);let o="";for(let u=l.length-1;u>=0;u-=1){const c=l[u],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(c);let g=!!p,b=n(g?f.substring(0,p):f);if(!b){if(!g){o=c+(o.length>0?" "+o:o);continue}if(b=n(f),!b){o=c+(o.length>0?" "+o:o);continue}g=!1}const E=X4(d).join(":"),x=h?E+lE:E,y=x+b;if(i.includes(y))continue;i.push(y);const v=s(b,g);for(let N=0;N<v.length;++N){const _=v[N];i.push(x+_)}o=c+(o.length>0?" "+o:o)}return o};function r6(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=oE(t))&&(n&&(n+=" "),n+=r);return n}const oE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=oE(e[n]))&&(r&&(r+=" "),r+=t);return r};function n6(e,...t){let r,n,s,i=l;function l(u){const c=t.reduce((d,h)=>h(d),e());return r=J4(c),n=r.cache.get,s=r.cache.set,i=o,o(u)}function o(u){const c=n(u);if(c)return c;const d=t6(u,r);return s(u,d),d}return function(){return i(r6.apply(null,arguments))}}const dt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},uE=/^\[(?:([a-z-]+):)?(.+)\]$/i,s6=/^\d+\/\d+$/,a6=new Set(["px","full","screen"]),i6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,l6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,o6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,u6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,c6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Hn=e=>zi(e)||a6.has(e)||s6.test(e),xs=e=>Il(e,"length",y6),zi=e=>!!e&&!Number.isNaN(Number(e)),hf=e=>Il(e,"number",zi),Ql=e=>!!e&&Number.isInteger(Number(e)),d6=e=>e.endsWith("%")&&zi(e.slice(0,-1)),De=e=>uE.test(e),ys=e=>i6.test(e),h6=new Set(["length","size","percentage"]),f6=e=>Il(e,h6,cE),m6=e=>Il(e,"position",cE),p6=new Set(["image","url"]),g6=e=>Il(e,p6,v6),x6=e=>Il(e,"",b6),Kl=()=>!0,Il=(e,t,r)=>{const n=uE.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},y6=e=>l6.test(e)&&!o6.test(e),cE=()=>!1,b6=e=>u6.test(e),v6=e=>c6.test(e),w6=()=>{const e=dt("colors"),t=dt("spacing"),r=dt("blur"),n=dt("brightness"),s=dt("borderColor"),i=dt("borderRadius"),l=dt("borderSpacing"),o=dt("borderWidth"),u=dt("contrast"),c=dt("grayscale"),d=dt("hueRotate"),h=dt("invert"),f=dt("gap"),p=dt("gradientColorStops"),g=dt("gradientColorStopPositions"),b=dt("inset"),E=dt("margin"),x=dt("opacity"),y=dt("padding"),v=dt("saturate"),N=dt("scale"),_=dt("sepia"),S=dt("skew"),R=dt("space"),j=dt("translate"),D=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",De,t],O=()=>[De,t],Q=()=>["",Hn,xs],Y=()=>["auto",zi,De],H=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],B=()=>["solid","dashed","dotted","double","none"],A=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",De],k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[zi,De];return{cacheSize:500,separator:":",theme:{colors:[Kl],spacing:[Hn,xs],blur:["none","",ys,De],brightness:K(),borderColor:[e],borderRadius:["none","","full",ys,De],borderSpacing:O(),borderWidth:Q(),contrast:K(),grayscale:G(),hueRotate:K(),invert:G(),gap:O(),gradientColorStops:[e],gradientColorStopPositions:[d6,xs],inset:F(),margin:F(),opacity:K(),padding:O(),saturate:K(),scale:K(),sepia:G(),skew:K(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",De]}],container:["container"],columns:[{columns:[ys]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...H(),De]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ql,De]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",De]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",Ql,De]}],"grid-cols":[{"grid-cols":[Kl]}],"col-start-end":[{col:["auto",{span:["full",Ql,De]},De]}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":[Kl]}],"row-start-end":[{row:["auto",{span:[Ql,De]},De]}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",De]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",De]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",De,t]}],"min-w":[{"min-w":[De,t,"min","max","fit"]}],"max-w":[{"max-w":[De,t,"none","full","min","max","fit","prose",{screen:[ys]},ys]}],h:[{h:[De,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[De,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[De,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[De,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ys,xs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",hf]}],"font-family":[{font:[Kl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",De]}],"line-clamp":[{"line-clamp":["none",zi,hf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Hn,De]}],"list-image":[{"list-image":["none",De]}],"list-style-type":[{list:["none","disc","decimal",De]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Hn,xs]}],"underline-offset":[{"underline-offset":["auto",Hn,De]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",De]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",De]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...H(),m6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",f6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},g6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...B(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:B()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...B()]}],"outline-offset":[{"outline-offset":[Hn,De]}],"outline-w":[{outline:[Hn,xs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Hn,xs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ys,x6]}],"shadow-color":[{shadow:[Kl]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...A(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":A()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",ys,De]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[v]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",De]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",De]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",De]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Ql,De]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",De]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",De]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",De]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Hn,xs,hf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},E6=n6(w6);function _6(...e){return E6(aE(e))}const gl=e=>{if(typeof e=="string")try{const t=JSON.parse(e);if(typeof t=="object"&&t!==null){const r={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=Number(t[n]);isNaN(s)||(r[n]=s)}return r}return{}}catch(t){return console.error("[parseSkillLevels] Error parsing skill_levels JSON string:",t),{}}else if(typeof e=="object"&&e!==null){const t={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=Number(e[r]);isNaN(n)||(t[r]=n)}return t}return{}},N6=q4("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",danger:"bg-red-600 text-white hover:bg-red-700",danger_outline:"border border-red-500 text-red-600 hover:bg-red-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"primary",size:"default"}}),V=Wr.forwardRef(({className:e,variant:t,size:r,icon:n,iconPosition:s="left",fullWidth:i,loading:l,children:o,...u},c)=>{const d=l||u.disabled;return a.jsxs("button",{className:_6(N6({variant:t,size:r,className:e}),i&&"w-full",l&&"relative"),ref:c,disabled:d,...u,children:[l&&a.jsx(Ta,{className:`animate-spin h-4 w-4 ${o?s==="left"?"mr-2":"ml-2":""}`}),!l&&n&&s==="left"&&a.jsx(n,{className:`h-4 w-4 ${o?"mr-2":""}`}),!l&&o,!l&&n&&s==="right"&&a.jsx(n,{className:`h-4 w-4 ${o?"ml-2":""}`})]})});V.displayName="Button";async function uh(e){let t=re.from("game_items").select("*");e&&e!=="all"&&typeof e=="string"&&(t=t.eq("category",e.toUpperCase()));const{data:r,error:n}=await t.order("category").order("name");if(n)throw console.error("Error fetching game items:",n),new Error(n.message||"Failed to fetch game items");return r||[]}function Ty(e){const t={gold:0,silver:0,copper:0};if(!e||typeof e!="string")return t;const r=e.toLowerCase().split(/,\s*|\s+/);for(let n=0;n<r.length;n++){const s=parseInt(r[n]);if(!isNaN(s)&&n+1<r.length){const i=r[n+1];i.startsWith("gold")||i.startsWith("g")?(t.gold=s,n++):i.startsWith("silver")||i.startsWith("s")?(t.silver=s,n++):(i.startsWith("copper")||i.startsWith("c"))&&(t.copper=s,n++)}}return dE(t)}function k6(e){if(!e)return"0 copper";const t=[];return e.gold>0&&t.push(`${e.gold} gold`),e.silver>0&&t.push(`${e.silver} silver`),e.copper>0&&t.push(`${e.copper} copper`),t.length>0?t.join(", "):"0 copper"}function dE(e){let{gold:t,silver:r,copper:n}=e;return r+=Math.floor(n/100),n%=100,t+=Math.floor(r/100),r%=100,{gold:t,silver:r,copper:n}}function S6(e,t){const r=e.gold*1e4+e.silver*100+e.copper,n=t.gold*1e4+t.silver*100+t.copper;if(r<n)return{success:!1,newMoney:e};let s=r-n;const i=Math.floor(s/1e4);s%=1e4;const l=Math.floor(s/100);return s%=100,{success:!0,newMoney:{gold:i,silver:l,copper:s}}}function T6(){var T,F;const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState(null),[s,i]=w.useState([]),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState({}),[f,p]=w.useState(!0),[g,b]=w.useState(""),{data:E=[],isLoading:x,error:y}=jt({queryKey:["gameItems"],queryFn:uh,staleTime:1e3*60*10});w.useEffect(()=>{async function O(){if(!e.profession){b("Profession not selected."),p(!1);return}try{p(!0),b("");const{data:Q,error:Y}=await re.from("professions").select("starting_equipment, equipment_description").eq("name",e.profession).single();if(Y)throw Y;if(Q){const H=Q,B=(H.starting_equipment||[]).map((A,M)=>({option:M+1,items:A.split(",").map(G=>G.trim()).filter(Boolean),description:(H.equipment_description||[])[M]||""}));i(B)}else i([])}catch(Q){console.error("Error fetching equipment options:",Q),b("Failed to load equipment options.")}finally{p(!1)}}O()},[e.profession]);const v=O=>{const Y=O.split(" or ")[0].trim().replace(/^\d+\s+/,"");return E.find(H=>H.name===Y)},N=O=>{const Q=O.match(/^(\d*D\d+)/i);if(!Q)return null;const Y=Q[1],H=Y.toUpperCase().split("D"),B=H[0]===""?1:parseInt(H[0]),A=parseInt(H[1]),M=O.slice(Y.length).trim();return{count:B,sides:A,rest:M}},_=(O,Q)=>{let Y=0;for(let H=0;H<O;H++)Y+=Math.floor(Math.random()*Q)+1;return Y},S=O=>{n(O),o(!1)},R=()=>{var Y,H;if(r===null)return;const O=s.find(B=>B.option===r);if(!O)return;if(O.items.some(B=>N(B)||B.toLowerCase().includes(" or "))){const B=O.items.reduce((A,M,G)=>{if(M.toLowerCase().includes(" or ")){const k=M.split(/\s+or\s+/i).map(K=>K.trim());A[G]=k[0]}else A[G]="";return A},{});h(B),c(!0)}else{const B=((Y=e.equipment)==null?void 0:Y.money)||{gold:0,silver:0,copper:0};t({startingEquipment:{option:r,items:O.items},equipment:{money:B,equipped:((H=e.equipment)==null?void 0:H.equipped)||{weapons:[]},inventory:[...O.items]}}),o(!0)}},j=()=>{var B,A;if(r===null)return;const O=s.find(M=>M.option===r);if(!O)return;const Y={...((B=e.equipment)==null?void 0:B.money)||{gold:0,silver:0,copper:0}},H=[];O.items.forEach((M,G)=>{if(M.toLowerCase().includes(" or ")){const k=d[G]||M.split(/\s+or\s+/i)[0].trim();H.push(k)}else{const k=N(M);if(k){const K=d[G]?parseInt(d[G]):_(k.count,k.sides),z=k.rest.toLowerCase();z.includes("gold")?Y.gold+=K:z.includes("silver")?Y.silver+=K:z.includes("copper")?Y.copper+=K:H.push(`${K} ${k.rest}`)}else H.push(M)}}),t({startingEquipment:{option:r,items:H},equipment:{money:dE(Y),equipped:((A=e.equipment)==null?void 0:A.equipped)||{weapons:[]},inventory:[...H]}}),c(!1),o(!0)},D=r!==null&&((T=s.find(O=>O.option===r))==null?void 0:T.items.every((O,Q)=>O.toLowerCase().includes(" or ")||N(O)?!!d[Q]:!0));return f||x?a.jsx(ze,{}):g||y?a.jsx(Ce,{message:g||(y==null?void 0:y.message)||"Failed to load data."}):e.profession?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Starting Equipment"}),a.jsxs("p",{className:"text-gray-600",children:["Select one of the available equipment packages for your ",e.profession,"."]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Equipment Selection"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Choose carefully  this will be your starting gear. Items with ",a.jsx(uy,{className:"inline w-4 h-4 text-amber-600"})," require a dice roll, items with ",a.jsx(fy,{className:"inline w-4 h-4 text-purple-600"})," offer a choice."]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(O=>a.jsxs("div",{onClick:()=>S(O.option),className:`p-6 border rounded-lg cursor-pointer transition-all ${r===O.option?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(au,{className:"w-6 h-6 text-gray-500"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold",children:["Option ",O.option]}),a.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Equipment List:"}),a.jsx("ul",{className:"space-y-1",children:O.items.map((Q,Y)=>{const H=!!N(Q),B=Q.toLowerCase().includes(" or "),A=v(Q);return a.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-600 group relative",children:[H?a.jsx(uy,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):B?a.jsx(fy,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):a.jsx(su,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a.jsx("span",{children:Q}),(A==null?void 0:A.effect)&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 max-w-xs",children:[A.effect," (W: ",A.weight,", Cost: ",A.cost,")"]})]},Y)})})]}),r===O.option&&a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[a.jsx(su,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Selected"})]})]},O.option))}),!r&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Equipment Required"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please select a starting equipment package."})]})]}),a.jsxs("button",{onClick:R,disabled:!r||l,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${l?"bg-green-600 text-white cursor-default":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[a.jsx(N2,{className:"w-5 h-5"}),l?"Equipment Confirmed":"Confirm Equipment Selection"]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Resolve Dice Rolls & Selections"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),(((F=s.find(O=>O.option===r))==null?void 0:F.items)||[]).map((O,Q)=>{if(O.toLowerCase().includes(" or ")){const H=O.split(/\s+or\s+/i).map(B=>B.trim());return a.jsxs("div",{className:"mb-4 p-3 border rounded bg-purple-50 border-purple-200",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:O}),a.jsxs("select",{value:d[Q]||"",onChange:B=>h(A=>({...A,[Q]:B.target.value})),className:"mt-1 w-full border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",disabled:!0,children:"Select one..."}),H.map((B,A)=>a.jsx("option",{value:B,children:B},A))]})]},Q)}const Y=N(O);return Y?a.jsxs("div",{className:"mb-4 p-3 border rounded bg-amber-50 border-amber-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium",children:O}),a.jsxs(V,{size:"sm",variant:"secondary",onClick:()=>{const H=_(Y.count,Y.sides);h(B=>({...B,[Q]:H.toString()}))},children:["Roll ",Y.count,"D",Y.sides]})]}),a.jsx("input",{type:"number",min:Y.count,max:Y.count*Y.sides,value:d[Q]||"",onChange:H=>{const B=H.target.value;if(B==="")h(A=>({...A,[Q]:""}));else{const A=parseInt(B);if(!isNaN(A)){const M=Math.max(Y.count,Math.min(Y.count*Y.sides,A));h(G=>({...G,[Q]:M.toString()}))}}},className:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:`Enter result (${Y.count}-${Y.count*Y.sides})`})]},Q):null}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(V,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),a.jsx(V,{variant:"primary",onClick:j,disabled:!D,children:"Confirm Rolls/Choices"})]})]})})]}):a.jsx("div",{className:"p-6 text-center",children:a.jsx("p",{className:"text-gray-600",children:"Please select a profession before choosing equipment."})})}const C6=["Short","Below Average","Average","Above Average","Tall"],j6=["Slight","Lean","Average","Athletic","Muscular","Heavy"],A6=["Black","Brown","Blonde","Red","Gray","White","Other"],I6=["Short","Medium","Long","Braided","Curly","Straight","Bald"],R6=["Brown","Blue","Green","Gray","Hazel","Other"],L6=["Fair","Light","Medium","Tan","Dark","Other"];function O6(){const{character:e,updateCharacter:t}=fs(),[r,n]=w.useState({height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",distinctiveFeatures:"",clothing:""}),s=()=>{const o=[];return r.height&&r.build&&o.push(`A ${r.height.toLowerCase()}, ${r.build.toLowerCase()} individual`),r.hairStyle&&r.hairColor&&(r.hairStyle.toLowerCase()==="bald"?o.push("Bald"):o.push(`${r.hairStyle.toLowerCase()} ${r.hairColor.toLowerCase()} hair`)),r.eyeColor&&o.push(`${r.eyeColor.toLowerCase()} eyes`),r.skinTone&&o.push(`${r.skinTone.toLowerCase()} skin`),r.distinctiveFeatures&&o.push(r.distinctiveFeatures),r.clothing&&o.push(`Typically wearing ${r.clothing}`),o.join(". ")+"."},i=()=>{const o=s();t({appearance:o})},l=()=>r.height&&r.build&&r.hairColor&&r.hairStyle&&r.eyeColor&&r.skinTone&&r.distinctiveFeatures&&r.clothing;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"prose",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Character Appearance"}),a.jsx("p",{className:"text-gray-600",children:"Describe your character's physical appearance. This will help bring your character to life during gameplay."})]}),a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Character Details"}),a.jsxs("p",{className:"text-sm text-blue-700",children:[e.kin,"  ",e.age,"  ",e.profession]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(DA,{className:"w-5 h-5 text-gray-500"}),"Physical Characteristics"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),a.jsxs("select",{value:r.height,onChange:o=>n({...r,height:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select height..."}),C6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build"}),a.jsxs("select",{value:r.build,onChange:o=>n({...r,build:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select build..."}),j6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(Al,{className:"w-5 h-5 text-gray-500"}),"Hair and Face"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Color"}),a.jsxs("select",{value:r.hairColor,onChange:o=>n({...r,hairColor:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select color..."}),A6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hair Style"}),a.jsxs("select",{value:r.hairStyle,onChange:o=>n({...r,hairStyle:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select style..."}),I6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eye Color"}),a.jsxs("select",{value:r.eyeColor,onChange:o=>n({...r,eyeColor:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select color..."}),R6.map(o=>a.jsx("option",{value:o,children:o},o))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skin Tone"}),a.jsxs("select",{value:r.skinTone,onChange:o=>n({...r,skinTone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select tone..."}),L6.map(o=>a.jsx("option",{value:o,children:o},o))]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(Hi,{className:"w-5 h-5 text-gray-500"}),"Distinctive Features"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notable Features"}),a.jsx("textarea",{value:r.distinctiveFeatures,onChange:o=>n({...r,distinctiveFeatures:o.target.value}),placeholder:"Scars, tattoos, birthmarks, or other distinctive features...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[a.jsx(P2,{className:"w-5 h-5 text-gray-500"}),"Clothing Style"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Typical Attire"}),a.jsx("textarea",{value:r.clothing,onChange:o=>n({...r,clothing:o.target.value}),placeholder:"Describe your character's typical clothing and style...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]})]})]}),l()&&a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Appearance Preview"}),a.jsx("p",{className:"text-green-700",children:s()})]}),!l()&&a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-amber-800",children:"Incomplete Description"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Please fill in all appearance details to continue."})]})]}),a.jsxs("button",{onClick:i,disabled:!l(),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Pr,{className:"w-5 h-5"}),"Save Appearance"]})]})}const Zl=[{title:"Kin",component:R4},{title:"Profession",component:D4},{title:"Name & Age",component:M4},{title:"Attributes",component:B4},{title:"Magic",component:$4},{title:"Trained Skills",component:z4},{title:"Gear",component:T6},{title:"Appearance",component:O6}],P6=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,hE={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR"},D6=Object.keys(hE);function M6(){const{user:e}=Ot(),{step:t,setStep:r,character:n,resetCharacter:s}=fs(),[i,l]=Wr.useState(null),[o,u]=Wr.useState(!1),c=Xr(),d=Zr(),h=Zl[t].component,f=()=>{var g;switch(t){case 0:return!!n.kin&&n.kinAbilityNames!==void 0&&n.kinAbilityNames.length>0;case 1:const b=n.magicSchool!==null&&n.magicSchool!==void 0;return!!n.profession&&(b||n.professionHeroicAbilityName!==void 0);case 2:return!!n.name&&n.name.trim().length>0&&!!n.age;case 3:return n.attributes&&Object.values(n.attributes).every(E=>E>0);case 4:return n.magicSchool?((g=n.spells)==null?void 0:g.general)&&n.spells.general.length>=3:!0;case 5:return n.trainedSkills&&n.trainedSkills.length>=6&&!!n.attributes;case 6:return n.startingEquipment&&n.startingEquipment.items.length>=0;case 7:return!!n.appearance&&n.appearance.trim().length>0;default:return!1}},p=async()=>{var g,b,E,x;if(!e){l("You must be logged in to create a character");return}if(!f()){l("Please complete all required fields for the final step before saving.");return}if(!n.attributes){l("Attributes must be set before saving.");return}try{u(!0),l(null),console.log("[CharacterSave] Starting character save process...");const y={},v=new Set(n.trainedSkills||[]);D6.forEach(D=>{var Y;const T=hE[D];if(!T){console.warn(`[CharacterSave] Missing attribute mapping for skill: ${D}`);return}const F=((Y=n.attributes)==null?void 0:Y[T])??0,O=P6(F),Q=v.has(D);y[D]=Q?O*2:O}),console.log("[CharacterSave] Calculated initial skill levels:",y);const N=[...n.kinAbilityNames||[],...n.professionHeroicAbilityName?[n.professionHeroicAbilityName]:[]].filter(Boolean);console.log("[CharacterSave] Combined heroic abilities:",N);const _={user_id:e.id,name:(g=n.name)==null?void 0:g.trim(),kin:n.kin,profession:n.profession,magic_school:n.magicSchool,age:n.age,attributes:n.attributes,trained_skills:n.trainedSkills||[],other_skills:n.otherSkills||[],skill_levels:y,equipment:n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},appearance:(b=n.appearance)==null?void 0:b.trim(),conditions:n.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},spells:n.spells||null,starting_equipment:n.startingEquipment||{items:[],money:{gold:0,silver:0,copper:0}},experience:{marked_skills:[]},current_hp:((E=n.attributes)==null?void 0:E.CON)??10,current_wp:((x=n.attributes)==null?void 0:x.WIL)??10,heroic_ability:N};console.log("[CharacterSave] Prepared character data for insert:",_),Object.keys(_).forEach(D=>{_[D]===void 0&&(console.warn(`[CharacterSave] Removing undefined key: ${D}`),delete _[D])}),console.log("[CharacterSave] Inserting character into Supabase...");const{data:S,error:R}=await re.from("characters").insert(_).select().single();if(R)throw console.error("[CharacterSave] Supabase insert error:",R),R;if(!S)throw console.error("[CharacterSave] Character insert succeeded but no data returned."),new Error("Character not created or data not returned.");console.log("[CharacterSave] Character saved successfully:",S),console.log("[CharacterSave] Invalidating characters query cache..."),await d.invalidateQueries({queryKey:["characters",e.id]}),await d.invalidateQueries({queryKey:["characters"]}),console.log("[CharacterSave] Resetting character creation store..."),s();const j=S.id;console.log(`[CharacterSave] Navigating to /characters/${j}`),c(`/characters/${j}`)}catch(y){console.error("[CharacterSave] Save process failed:",y);const v=y instanceof Error?y.message:"Failed to save character";if(v.includes("violates check constraint")&&v.includes("attributes_check"))l("Failed to save character: Invalid attribute values. Please ensure all attributes are set correctly.");else if(v.includes("violates not-null constraint")){const N=v.match(/null value in column "(\w+)"/),_=N?N[1]:"a required field";l(`Failed to save character: ${_} is missing. Please review your selections. Details: ${v}`)}else v.includes("unique constraint")?l("Failed to save character: A character with this name might already exist or another unique field conflicts."):l(`Failed to save character: ${v}`)}finally{console.log("[CharacterSave] Save process finished (finally block)."),u(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-8 my-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Create New Character"}),a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Step ",t+1," of ",Zl.length]})]}),a.jsx("div",{className:"flex space-x-1",children:Zl.map((g,b)=>a.jsx("div",{className:"flex-1 h-2 rounded-full overflow-hidden bg-gray-200",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${b<t?"bg-blue-500":b===t?"bg-blue-300":"bg-gray-200"}`,style:{width:b===t?"50%":"100%"}})},g.title))}),a.jsx("p",{className:"text-center text-lg font-semibold mt-3 text-gray-700",children:Zl[t].title})]}),i&&a.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-red-50 border border-red-300 rounded-lg shadow-sm",children:[a.jsx(Et,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Creation Error"}),a.jsx("p",{className:"text-sm text-red-700",children:i})]})]}),a.jsxs("div",{className:"min-h-[400px] mb-8",children:[" ",a.jsx(h,{})]}),a.jsxs("div",{className:"flex justify-between items-center mt-8 border-t pt-6",children:[a.jsx("button",{onClick:()=>r(t-1),disabled:t===0||o,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t===Zl.length-1?a.jsxs("button",{onClick:p,disabled:!f()||o,className:`inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":f()?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"}`,children:[a.jsx(Pr,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Saving Character...":"Create Character"]}):a.jsx("button",{onClick:()=>r(t+1),disabled:!f()||o,className:`inline-flex items-center px-5 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ${o?"bg-gray-400 cursor-not-allowed":f()?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Next Step"})]})]})}function np({icon:e,title:t,description:r,action:n}){return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 mb-6",children:r}),n]})}const Rl=e=>{const t={STR:10,AGL:10,INT:10,CON:10,WIL:10,CHA:10},r=e.attributes||{},n={STR:r.strength??r.STR??t.STR,AGL:r.agility??r.AGL??t.AGL,INT:r.intelligence??r.INT??t.INT,CHA:r.charisma??r.CHA??t.CHA,CON:r.constitution??r.CON??t.CON,WIL:r.willpower??r.WIL??t.WIL},s=n.CON,i=n.WIL,l=e.equipment||{},o=l.inventory||[],u=l.equipped||{weapons:[]},c=l.money||{gold:0,silver:0,copper:0};let d=e.teacher;return typeof d!="object"||d===null?d=null:d.skillUnderStudy===void 0&&(d={...d,skillUnderStudy:null}),{id:e.id,user_id:e.user_id,name:e.name,kin:e.kin,profession:e.profession,magicSchool:e.magic_school,age:e.age,attributes:n,max_hp:s,current_hp:e.current_hp??s,max_wp:i,current_wp:e.current_wp??i,movement:e.movement??10,damage_bonus:e.damage_bonus??0,conditions:e.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},equipment:{inventory:o,equipped:u,money:c},trainedSkills:e.trained_skills||[],untrainedSkills:e.other_skills||[],heroic_ability:e.heroic_ability||[],spells:e.spells||{school:null,general:[]},prepared_spells:e.prepared_spells||[],experience:e.experience??0,reputation:e.reputation??0,corruption:e.corruption??0,notes:e.notes??"",created_at:e.created_at,updated_at:e.updated_at,party_id:e.party_id,is_npc:e.is_npc??!1,key_attribute:e.key_attribute,death_rolls_failed:e.death_rolls_failed??0,death_rolls_passed:e.death_rolls_passed??0,appearance:e.appearance??"",skill_levels:e.skill_levels||{},teacher:d}};async function F6(e){if(!e)return[];const{data:t,error:r}=await re.from("characters").select(`
      *
    `).eq("user_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching characters:",r),new Error(r.message||"Failed to fetch characters");return(t||[]).map(Rl)}async function U6(e,t){if(!e)return null;const r=re.from("characters").select(`
      *
    `).eq("id",e),{data:n,error:s}=await r.maybeSingle();if(s&&(console.error("Error fetching character by ID:",s),s.code!=="PGRST116"))throw new Error(s.message||"Failed to fetch character");return n?Rl(n):null}async function B6(e,t){const r={},n={untrainedSkills:"other_skills",trainedSkills:"trained_skills"};for(const l in t)if(Object.prototype.hasOwnProperty.call(t,l)){const o=t[l],u=n[l]||l;r[u]=o}r.updated_at=new Date().toISOString();const{data:s,error:i}=await re.from("characters").update(r).eq("id",e).select(`
      *
    `).single();if(i)throw console.error("Error updating character:",i),i.code==="PGRST116"?(console.error(`Update failed: Character ${e} not found or RLS prevented access.`),new Error(`Character ${e} not found or update permission denied.`)):new Error(i.message||"Failed to update character");return s?Rl(s):(console.error(`Update seemed successful but no data returned for character ${e}.`),null)}const fE=Wr.forwardRef(({className:e,...t},r)=>a.jsx("input",{ref:r,className:`block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed ${e}`,...t}));fE.displayName="Input";function H6({isOpen:e,onClose:t,onJoin:r}){const[n,s]=w.useState(""),[i,l]=w.useState(""),o=()=>{l("");const c=n.match(/party\/join\/([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})/);c&&c[1]?(r(c[1]),s("")):l("Invalid party invite link. Please paste the full link.")},u=()=>{s(""),l(""),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity","aria-labelledby":"join-party-title",role:"dialog","aria-modal":"true",onClick:u,children:a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md m-4 transform transition-all",onClick:c=>c.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{id:"join-party-title",className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(M0,{className:"w-6 h-6 text-blue-600"}),"Join an Adventure Party"]}),a.jsx("button",{onClick:u,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600","aria-label":"Close dialog",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Paste the invite link you received from your Dungeon Master to join their party."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party-link",className:"sr-only",children:"Party Invite Link"}),a.jsx(fE,{id:"party-link",type:"text",value:n,onChange:c=>s(c.target.value),placeholder:"https://.../party/join/...",className:"w-full","aria-describedby":"link-error"}),i&&a.jsx("p",{id:"link-error",className:"text-red-500 text-sm mt-2",children:i})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx(V,{variant:"secondary",onClick:u,children:"Cancel"}),a.jsx(V,{variant:"primary",onClick:o,disabled:!n,children:"Join Party"})]})]})}):null}function $6(){const{user:e}=Ot(),t=Xr(),r=Zr(),[n,s]=w.useState(!1),[i,l]=w.useState(!1),{data:o=[],isLoading:u,error:c}=jt({queryKey:["characters",e==null?void 0:e.id],queryFn:()=>F6(e==null?void 0:e.id),enabled:!!e}),d=h=>{h&&t(`/character/${h}`)};return u?a.jsx("div",{className:"p-8 flex justify-center items-center h-full",children:a.jsx(ze,{size:"lg"})}):c?a.jsx("div",{className:"p-8",children:a.jsx(Ce,{message:c.message||"Failed to load characters"})}):e?a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("div",{children:a.jsx("h1",{className:"text-3xl font-bold",children:"Characters"})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{variant:"secondary",icon:M0,onClick:()=>l(!0),children:"Join Party"}),a.jsx(V,{variant:"primary",icon:zt,onClick:()=>s(!0),children:"Create Character"})]})]}),n?a.jsx(M6,{onComplete:()=>{s(!1),r.invalidateQueries({queryKey:["characters",e==null?void 0:e.id]})}}):o.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(h=>a.jsxs("div",{className:"relative group",onClick:()=>d(h.id),children:[a.jsx("div",{className:"absolute inset-0 rounded-lg border-2 transition-all duration-200 pointer-events-none border-transparent group-hover:border-blue-300"}),a.jsx(n4,{character:h})]},h.id))}):a.jsx(np,{icon:zt,title:"No Characters Yet",description:"Create your first character to begin your adventure.",action:a.jsx(V,{variant:"primary",icon:zt,onClick:()=>s(!0),children:"Create Your First Character"})}),a.jsx(H6,{isOpen:i,onClose:()=>l(!1),onJoin:h=>{l(!1),t(`/party/join/${h}`)}})]}):a.jsx("div",{className:"p-8",children:a.jsx(np,{icon:Et,title:"Authentication Required",description:"Please sign in to view your characters."})})}function co(e,t){var c;const r=e.trim();let n=r,s=1,i;const l=r.match(/^(\d+)\s+(.*)/),o=r.match(/^(.*?)\s+(\d+)\s*(\w+)?$/);l?(s=parseInt(l[1],10),n=l[2].trim(),n.match(/^(.*?)\s+(\d+)\s*(\w+)?$/)&&console.warn(`Ambiguous item string: "${r}". Using quantity ${s} for name "${n}".`)):o&&(n=o[1].trim(),s=parseInt(o[2],10),i=(c=o[3])==null?void 0:c.trim());const u=t==null?void 0:t.find(d=>{var h;return((h=d.name)==null?void 0:h.toLowerCase())===n.toLowerCase()});return{name:n,quantity:s,unit:i,originalName:r,description:u==null?void 0:u.description,weight:u==null?void 0:u.weight,cost:u==null?void 0:u.cost,category:u==null?void 0:u.category,damage:u==null?void 0:u.damage,armor_rating:u==null?void 0:u.armor_rating,grip:u==null?void 0:u.grip,range:u==null?void 0:u.range,durability:u==null?void 0:u.durability,features:u==null?void 0:u.features,effect:u==null?void 0:u.effect,id:`${n}-${Date.now()}-${Math.random()}`}}function bc(e){let t="";return e.quantity>1?t=` (x${e.quantity}${e.unit?" "+e.unit:""})`:e.unit&&(t=` (${e.quantity} ${e.unit})`),`${e.name}${t}`}function Xl(e,t){const r=e.findIndex(n=>n.name.toLowerCase()===t.name.toLowerCase()&&n.unit===t.unit);if(r>-1){const n=[...e],s=n[r];return n[r]={...s,quantity:s.quantity+t.quantity,originalName:`${t.quantity>1?t.quantity+" ":""}${s.name}${t.unit?" "+t.unit:""}`.trim()},n}else return[...e,t]}async function mE(e){const{data:t,error:r}=await re.from("encounters").select("*").eq("party_id",e).order("created_at",{ascending:!1}).limit(1);if(r)throw console.error("Error fetching latest encounter:",r),r;return(t==null?void 0:t[0])||null}async function z6(e){const{data:t,error:r}=await re.from("encounters").select("*").eq("id",e).single();if(r)throw console.error("Error fetching encounter details:",r),r;return t}async function pE(e){const{data:t,error:r}=await re.from("encounter_combatants").select("*, characters(name, level), monsters(name)").eq("encounter_id",e).order("initiative_roll",{ascending:!1,nullsLast:!0}).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching encounter combatants:",r),r;return(t||[]).map(n=>({...n,display_name:n.display_name||(n.character_id&&n.characters?`${n.characters.name} (Lvl ${n.characters.level||"N/A"})`:n.monster_id&&n.monsters?n.monsters.name:"Unknown Combatant")}))}async function q6(e,t,r){const{data:n,error:s}=await re.from("encounters").insert({party_id:e,name:t,description:r,status:"planning"}).select().single();if(s)throw console.error("Error creating encounter:",s),s;if(!n)throw new Error("Encounter creation returned no data");return n}async function V6(e,t){var i;let r={encounter_id:e,initiative_roll:t.initiativeRoll};if(t.type==="character"){const{data:l,error:o}=await re.from("characters").select("id, name, max_health, current_health, max_willpower, current_willpower, level").eq("id",t.characterId).single();if(o||!l)throw console.error("Error fetching character for combatant:",o==null?void 0:o.message),new Error(`Character (ID: ${t.characterId}) not found or error fetching details.`);const u=`${l.name||"Unnamed Character"}${l.level?` (Lvl ${l.level})`:""}`;r={...r,character_id:l.id,display_name:u,max_hp:l.max_health??10,current_hp:l.current_health??l.max_health??10,max_wp:l.max_willpower,current_wp:l.current_willpower,is_player_character:!0}}else if(t.type==="monster"){const{data:l,error:o}=await re.from("monsters").select("id, name, stats").eq("id",t.monsterId).single();if(o||!l)throw console.error("Error fetching monster for combatant:",o==null?void 0:o.message),new Error(`Monster (ID: ${t.monsterId}) not found or error fetching details.`);const u=((i=l.stats)==null?void 0:i.HP)??10;r={...r,monster_id:l.id,display_name:t.customName||l.name||"Unnamed Monster",max_hp:u,current_hp:u,max_wp:null,current_wp:null,is_player_character:!1}}else throw console.error("Invalid combatant type specified in payload:",t),new Error("Invalid combatant type specified.");const{data:n,error:s}=await re.from("encounter_combatants").insert(r).select().single();if(s)throw console.error("Error inserting combatant into encounter:",s.message,"Payload:",r),s;if(!n)throw new Error("Combatant creation returned no data from insert operation.");return n}async function W6(e,t){const{data:r,error:n}=await re.from("encounters").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating encounter:",n),n;if(!r)throw new Error("Encounter update returned no data");return r}async function gE(e,t){const{data:r,error:n}=await re.from("encounter_combatants").update(t).eq("id",e).select().single();if(n)throw console.error("Error updating combatant:",n),n;if(!r)throw new Error("Combatant update returned no data");return r}async function G6(e){const{error:t}=await re.from("encounter_combatants").delete().eq("id",e);if(t)throw console.error("Error removing combatant:",t),t}const ir=tE((e,t)=>({character:null,isLoading:!1,isSaving:!1,error:null,saveError:null,markedSkillsThisSession:new Set,allGameItems:[],isLoadingGameItems:!1,activeStatusMessage:null,statusMessageTimeoutId:null,activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null,fetchCharacter:async(r,n)=>{e({character:null,isLoading:!0,error:null,saveError:null});try{t().allGameItems.length===0&&!t().isLoadingGameItems&&await t()._loadGameItems();const s=t().allGameItems,i=await U6(r,n);if(!i)throw new Error(`Character with ID ${r} not found.`);i.equipment?(i.equipment.inventory||(i.equipment.inventory=[]),i.equipment.equipped||(i.equipment.equipped={weapons:[]}),i.equipment.money||(i.equipment.money={gold:0,silver:0,copper:0})):i.equipment={inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},Array.isArray(i.equipment.inventory)&&i.equipment.inventory.length>0&&typeof i.equipment.inventory[0]=="string"&&(i.equipment.inventory=i.equipment.inventory.map(l=>co(l,s))),e({character:i,isLoading:!1}),i!=null&&i.party_id?t().fetchActiveEncounter(i.party_id,i.id):t().clearActiveEncounter()}catch(s){const i=s instanceof Error?s.message:"Failed to fetch character";e({error:i,isLoading:!1})}},setCharacter:r=>{e({character:r}),!r||!r.party_id?t().clearActiveEncounter():t().fetchActiveEncounter(r.party_id,r.id)},_saveCharacter:async r=>{var s,i;const n=t().character;if(!(n!=null&&n.id)){const l="Cannot save: Character ID is missing.";throw e({saveError:l}),new Error(l)}e({isSaving:!0,saveError:null});try{const l={...n};r.equipment&&(l.equipment={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},...r.equipment,...r.equipment.money&&{money:{...((s=n.equipment)==null?void 0:s.money)||{gold:0,silver:0,copper:0},...r.equipment.money}},...r.equipment.inventory&&{inventory:r.equipment.inventory},...r.equipment.equipped&&{equipped:{...((i=n.equipment)==null?void 0:i.equipped)||{weapons:[]},...r.equipment.equipped,...r.equipment.equipped.weapons&&{weapons:r.equipment.equipped.weapons}}}}),r.attributes&&(l.attributes={...n.attributes||{STR:10,AGL:10,INT:10,CHA:10,CON:10,WIL:10},...r.attributes}),r.conditions&&(l.conditions={...n.conditions||{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},...r.conditions}),"teacher"in r&&(l.teacher=r.teacher),r.skill_levels&&(l.skill_levels=r.skill_levels),r.spells&&(l.spells=r.spells),r.heroic_ability&&(l.heroic_ability=r.heroic_ability),"max_hp"in r&&(l.max_hp=r.max_hp),"current_hp"in r&&(l.current_hp=r.current_hp),"temporary_hp"in r&&(l.temporary_hp=r.temporary_hp),"max_wp"in r&&(l.max_wp=r.max_wp),"current_wp"in r&&(l.current_wp=r.current_wp),"death_rolls_passed"in r&&(l.death_rolls_passed=r.death_rolls_passed),"death_rolls_failed"in r&&(l.death_rolls_failed=r.death_rolls_failed),"is_rallied"in r&&(l.is_rallied=r.is_rallied),"notes"in r&&(l.notes=r.notes),"experience"in r&&(l.experience=r.experience),"reputation"in r&&(l.reputation=r.reputation),"corruption"in r&&(l.corruption=r.corruption),"appearance"in r&&(l.appearance=r.appearance),"name"in r&&(l.name=r.name),"class"in r&&(l.class=r.class),"race"in r&&(l.race=r.race),"level"in r&&(l.level=r.level),"background"in r&&(l.background=r.background),"alignment"in r&&(l.alignment=r.alignment),"experience_points"in r&&(l.experience_points=r.experience_points),"armor_class"in r&&(l.armor_class=r.armor_class),"speed"in r&&(l.speed=r.speed),"proficiency_bonus"in r&&(l.proficiency_bonus=r.proficiency_bonus),"age"in r&&(l.age=r.age),"kin"in r&&(l.kin=r.kin),"profession"in r&&(l.profession=r.profession),"mementos"in r&&(l.mementos=r.mementos),"weak_spot"in r&&(l.weak_spot=r.weak_spot),"prepared_spells"in r&&(l.prepared_spells=r.prepared_spells);const o=await B6(n.id,l);e({character:o,isSaving:!1})}catch(l){const o=l instanceof Error?l.message:"Failed to save character";throw e({saveError:o,isSaving:!1}),l}},_loadGameItems:async()=>{if(!(t().isLoadingGameItems||t().allGameItems.length>0)){e({isLoadingGameItems:!0});try{const r=await uh();e({allGameItems:r,isLoadingGameItems:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to load game items";e({isLoadingGameItems:!1,error:n,allGameItems:[]})}}},updateCharacterData:async r=>t()._saveCharacter(r),adjustStat:async(r,n)=>{const s=t().character;if(!s)return;let i;if(r==="current_hp"){const l=s.current_hp,o=s.max_hp;if(i=Math.max(0,Math.min(o,l+n)),i!==l){const u={current_hp:i};s.current_hp<=0&&i>0&&(u.death_rolls_passed=0,u.death_rolls_failed=0,u.is_rallied=!1),await t()._saveCharacter(u)}}else if(r==="current_wp"){const l=s.current_wp,o=s.max_wp;i=Math.max(0,Math.min(o,l+n)),i!==l&&await t()._saveCharacter({current_wp:i})}},toggleCondition:async r=>{const n=t().character;if(!n)return;const s=n.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},i={...s,[r]:!s[r]};await t()._saveCharacter({conditions:i})},performRest:async(r,n)=>{const s=t().character;if(!s)return;const i={},l=s.current_hp,o=s.max_hp,u=s.current_wp,c=s.max_wp,d=()=>Math.floor(Math.random()*6)+1;if(r==="round")i.current_wp=Math.min(c,u+d());else if(r==="stretch"){if(l<=0){e({saveError:"Cannot take Stretch Rest while dying."}),setTimeout(()=>e(E=>({...E,saveError:E.saveError==="Cannot take Stretch Rest while dying."?null:E.saveError})),3e3);return}const h=n?d()+d():d();i.current_hp=Math.min(o,l+h),i.current_wp=Math.min(c,u+d());const f=s.conditions??{exhausted:!1,sickly:!1,dazed:!1,angry:!1,scared:!1,disheartened:!1},p=Object.keys(f);let g={...f},b=!1;for(const E of p)if(g[E]===!0){g[E]=!1,b=!0;break}b&&(i.conditions=g)}else if(r==="shift"){i.current_hp=o,i.current_wp=c;const h={...s.conditions??{}};for(const f in h)h[f]=!1;i.conditions=h,i.death_rolls_failed=0,i.death_rolls_passed=0,i.is_rallied=!1}Object.keys(i).length>0&&await t()._saveCharacter(i)},setDeathRollState:async(r,n,s)=>{const i={death_rolls_passed:r,death_rolls_failed:n};s!==void 0&&(i.is_rallied=s),await t()._saveCharacter(i)},updateAttribute:async(r,n)=>{const s=t().character;if(!s)return;const l={attributes:{...s.attributes||{STR:10,AGL:10,INT:10,CHA:10,CON:10,WIL:10},[r]:n}};r==="CON"&&(l.max_hp=n,l.current_hp=Math.min(s.current_hp,n)),r==="WIL"&&(l.max_wp=n,l.current_wp=Math.min(s.current_wp,n)),await t()._saveCharacter(l)},updateCurrentHP:async r=>{await t()._saveCharacter({current_hp:r})},updateWillpowerPoints:async r=>{await t()._saveCharacter({current_wp:r})},updateConditions:async r=>{await t()._saveCharacter({conditions:r})},updateInventory:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},inventory:r};await t()._saveCharacter({equipment:s})},updateEquipped:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},equipped:r};await t()._saveCharacter({equipment:s})},updateMoney:async r=>{const n=t().character;if(!n)return;const s={...n.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},money:r};await t()._saveCharacter({equipment:s})},updateNotes:async r=>{await t()._saveCharacter({notes:r})},updateExperience:async r=>{await t()._saveCharacter({experience:r})},updateReputation:async r=>{await t()._saveCharacter({reputation:r})},updateCorruption:async r=>{await t()._saveCharacter({corruption:r})},updateDeathRolls:async(r,n)=>{const s=t().character;s&&(r==="failed"?await t().setDeathRollState(s.death_rolls_passed??0,n,s.is_rallied):await t().setDeathRollState(n,s.death_rolls_failed??0,s.is_rallied))},updateAppearance:async r=>{await t()._saveCharacter({appearance:r})},updateSkillLevel:async(r,n)=>{const s=t().character;if(!s)return;const l={...gl(s.skill_levels),[r]:n};await t()._saveCharacter({skill_levels:l})},increaseSkillLevel:async r=>{var u;const n=t().character;if(!n)return;const s=gl(n.skill_levels),i=s[r]??0;if(i>=18)return;const l=Math.min(i+1,18),o={skill_levels:{...s,[r]:l}};((u=n.teacher)==null?void 0:u.skillUnderStudy)===r&&(o.teacher=null),await t()._saveCharacter(o)},addHeroicAbility:async r=>{const n=t().character;if(!n)return;const s=n.heroic_ability||[];if(!s.includes(r)){const i=[...s,r];await t()._saveCharacter({heroic_ability:i})}},learnSpell:async r=>{var o,u;const n=t().character;if(!n)return;const s=n.spells?{...n.spells}:{school:null,general:[]};s.general||(s.general=[]),s.school&&!s.school.spells&&(s.school.spells=[]);const i=s.general.includes(r),l=((u=(o=s.school)==null?void 0:o.spells)==null?void 0:u.includes(r))??!1;if(!i&&!l){const c=[...s.general,r],d={...s,general:c};await t()._saveCharacter({spells:d})}},setSkillUnderStudy:async r=>{if(!t().character)return;const s=r?{skillUnderStudy:r}:null;await t()._saveCharacter({teacher:s})},markSkillThisSession:r=>{e(n=>({markedSkillsThisSession:new Set(n.markedSkillsThisSession).add(r)}))},clearMarkedSkillsThisSession:()=>{e({markedSkillsThisSession:new Set})},setActiveStatusMessage:(r,n=3e4)=>{const s=t().statusMessageTimeoutId;s&&clearTimeout(s),e({activeStatusMessage:r});const i=setTimeout(()=>{e({activeStatusMessage:null,statusMessageTimeoutId:null})},n);e({statusMessageTimeoutId:i})},clearActiveStatusMessage:()=>{const r=t().statusMessageTimeoutId;r&&clearTimeout(r),e({activeStatusMessage:null,statusMessageTimeoutId:null})},fetchActiveEncounter:async(r,n)=>{e({isLoadingEncounter:!0,encounterError:null,activeEncounter:null,currentCombatant:null});try{const s=await mE(r);if(s){e({activeEncounter:s});const l=(await pE(s.id)).find(o=>o.character_id===n);e({currentCombatant:l??null})}else e({activeEncounter:null,currentCombatant:null});e({isLoadingEncounter:!1})}catch(s){const i=s instanceof Error?s.message:"Failed to fetch active encounter";e({encounterError:i,isLoadingEncounter:!1})}},drawInitiative:async()=>{const{currentCombatant:r,activeEncounter:n}=t();if(!r||!n||n.status!=="active"){t().setActiveStatusMessage("Cannot draw initiative: Not in an active encounter or not added as a combatant.",5e3);return}e({isSaving:!0,saveError:null});try{const s=Math.floor(Math.random()*10)+1,i=await gE(r.id,{initiative_roll:s});e(l=>({currentCombatant:i,isSaving:!1,saveError:null})),t().setActiveStatusMessage(`Initiative drawn: ${s}`,5e3)}catch(s){const i=s instanceof Error?s.message:"Failed to draw initiative";e({saveError:i,isSaving:!1}),t().setActiveStatusMessage(`Failed to draw initiative: ${i}`,5e3)}},clearActiveEncounter:()=>{e({activeEncounter:null,currentCombatant:null,isLoadingEncounter:!1,encounterError:null})}})),Y6=[{kin:"Human",movement:10},{kin:"Halfling",movement:8},{kin:"Dwarf",movement:8},{kin:"Elf",movement:10},{kin:"Mallard",movement:8},{kin:"Wolfkin",movement:12}];function Q6(e,t){var s;const r=((s=Y6.find(i=>i.kin===e))==null?void 0:s.movement)||10;let n=0;return t<=6?n=-4:t<=9?n=-2:t<=12?n=0:t<=15?n=2:n=4,r+n}const ff={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},K6=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming"],Z6=["Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],X6=["Mentalism","Animism","Elementalism"],J6=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,eI=(e,t,r)=>{var l,o;console.warn(`[SkillsModal] Calculating fallback level for ${t}.`);const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=J6(s);return n?i*2:i};function tI({onClose:e}){const{toggleDiceRoller:t}=ma(),{character:r}=ir(),[n,s]=w.useState([]),[i,l]=w.useState(!1),[o,u]=w.useState(null);if(w.useEffect(()=>{(async()=>{l(!0),u(null);try{const{data:N,error:_}=await re.from("magic_schools").select("id, name");if(_)throw _;s(N||[]),console.log("[SkillsModal] Fetched magic schools:",N)}catch(N){console.error("[SkillsModal] Error fetching magic schools:",N),u("Failed to load magic schools data.")}finally{l(!1)}})()},[]),!r)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-6",children:a.jsx(ze,{})})});let c=r.skill_levels;if(typeof c=="string")try{c=JSON.parse(c)}catch(v){console.error("[SkillsModal] Error parsing skill_levels JSON string:",v),c={}}else(c===null||typeof c!="object")&&(c={});const d=r.magicSchool,h=!!d;console.log(`[SkillsModal] Character School ID: ${d}, Is Mage: ${h}`);let f=null;if(h&&!i&&n.length>0){const v=n.find(N=>N.id===d);v?(f=v.name,console.log(`[SkillsModal] Found Magic School Name: ${f}`)):console.warn(`[SkillsModal] Could not find magic school name for ID: ${d}`)}const p=v=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[v],g=(v,N,_)=>{console.log(`[SkillsModal] Rolling for ${v}, Target: ${N}, Bane: ${_}`),t({initialDice:["d20"],rollMode:"skillCheck",targetValue:N,description:`${v} Check`,requiresBane:_,skillName:v}),e()},b=K6.map(v=>({name:v,attr:ff[v]})).sort((v,N)=>v.name.localeCompare(N.name)),E=Z6.map(v=>({name:v,attr:ff[v]})).sort((v,N)=>v.name.localeCompare(N.name)),x=f?X6.filter(v=>v===f).map(v=>({name:v,attr:ff[v]})).sort((v,N)=>v.name.localeCompare(N.name)):[];console.log("[SkillsModal] Filtered Mage Skills for display:",x);const y=v=>{var j,D;const N=((j=r.trainedSkills)==null?void 0:j.includes(v.name))??!1,_=(c==null?void 0:c[v.name])??eI(r,v.name,v.attr),S=p(v.attr),R=((D=r.conditions)==null?void 0:D[S])??!1;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${R?"bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"hover:bg-gray-100"}`,onClick:()=>g(v.name,_,R),title:`Click to roll ${v.name} (Target  ${_}${R?", Bane":""})`,children:[a.jsxs("div",{children:[a.jsx("span",{className:`${N?"font-bold":""} ${R?"text-red-700":"text-gray-800"}`,children:v.name}),a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",v.attr,")"]}),R&&a.jsx("span",{className:"text-xs text-red-600 font-semibold ml-2",children:"(Bane)"})]}),a.jsxs("span",{className:`font-medium text-sm ${R?"text-red-700":"text-gray-600"}`,children:["Target: ",_]})]},v.name)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Skills (d20 Check)"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click a skill to roll a d20 check. Roll  Skill Level for success. 1 is Dragon (Crit Success), 20 is Demon (Crit Fail). Conditions apply Bane (roll 2d20, take highest/worst). Trained skills are bolded."})]}),a.jsxs("div",{className:`grid grid-cols-1 ${h?"md:grid-cols-3":"md:grid-cols-2"} gap-6 p-6 overflow-y-auto flex-grow`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"General Skills"}),a.jsx("div",{className:"space-y-1",children:b.map(y)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Weapon Skills"}),a.jsx("div",{className:"space-y-1",children:E.map(y)})]}),h&&a.jsxs("div",{children:[i&&a.jsxs("div",{className:"text-center text-gray-500 p-4",children:[a.jsx(ze,{size:"sm"})," Loading magic info..."]}),o&&!i&&a.jsx("div",{className:"text-center text-red-600 p-4 border border-red-200 bg-red-50 rounded",children:o}),!i&&!o&&f&&a.jsxs(a.Fragment,{children:[a.jsxs("h3",{className:"font-bold mb-4 text-gray-700",children:["Magic Skill (",f,")"]}),a.jsx("div",{className:"space-y-1",children:x.length>0?x.map(y):a.jsxs("p",{className:"text-sm text-gray-500 italic px-2 py-1",children:["No matching magic skill component found for ",f,"."]})})]}),!i&&!o&&!f&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-4 text-gray-700",children:"Magic Skill"}),a.jsxs("p",{className:"text-sm text-orange-600 italic px-2 py-1 bg-orange-50 border border-orange-200 rounded",children:["Could not determine magic school name from ID (",d,")."]})]})]})]}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(V,{variant:"outline",onClick:e,children:"Close"})})]})})}function rI(e){var h,f;const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),o=ir(p=>p.character),u=w.useMemo(()=>{if(!(o!=null&&o.spells))return[];let p=[];if(o.spells.general&&(Array.isArray(o.spells.general)?p=p.concat(o.spells.general):console.warn("[useSpells] character.spells.general is not an array:",o.spells.general)),o.spells.school&&o.spells.school.spells){const g=o.spells.school.spells;Array.isArray(g)?p=p.concat(g):console.warn("[useSpells] character.spells.school.spells is not an array:",g)}return Array.from(new Set(p))},[o==null?void 0:o.spells]);w.useEffect(()=>{if(!e||u.length===0){s(!1),r([]);return}async function p(){s(!0),l(null);try{const{data:g,error:b}=await re.from("game_spells").select(`
            *,
            power_level,
            magic_schools ( name )
          `).in("name",u).order("rank",{ascending:!0}).order("name",{ascending:!0});if(b)throw b;r(g||[])}catch(g){console.error("Error loading learned spell details:",g),l(g instanceof Error?g.message:"Failed to load spell details"),r([])}finally{s(!1)}}p()},[e,u]);const c=w.useMemo(()=>t.map(p=>({id:p.id,name:p.name,schoolId:p.school_id,rank:p.rank,requirement:p.requirement,castingTime:p.casting_time,range:p.range,duration:p.duration,description:p.description,willpowerCost:p.willpower_cost,createdAt:p.created_at,powerLevel:p.power_level})),[t]),d=w.useMemo(()=>{var p,g;return((g=(p=o==null?void 0:o.spells)==null?void 0:p.school)==null?void 0:g.name)??null},[(f=(h=o==null?void 0:o.spells)==null?void 0:h.school)==null?void 0:f.name]);return{learnedSpells:c,characterSchoolName:d,loading:n,error:i}}const xE=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,nI=(e,t)=>{var l,o;const r="WIL",n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=xE(s);return console.log(`[SpellcastingView - Fallback] Skill: ${t}, Trained: ${n}, Base Attr (${r}): ${s}, Base Chance: ${i}, Final Fallback: ${n?i*2:i}`),n?i*2:i},sI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch(t){return console.error("Error parsing skill_levels JSON:",t),{}}else if(typeof e=="object"&&e!==null)return e;return{}};function aI({onClose:e}){var be,Z,ye;const[t,r]=w.useState(null),[n,s]=w.useState(null),[i,l]=w.useState(null),[o,u]=w.useState("prepared"),[c,d]=w.useState({}),[h,f]=w.useState("all"),{toggleDiceRoller:p}=ma(),{character:g,updateCharacterData:b,isSaving:E,setActiveStatusMessage:x}=ir(),{learnedSpells:y,characterSchoolName:v,loading:N,error:_}=rI(g==null?void 0:g.id),S=((be=g==null?void 0:g.attributes)==null?void 0:be.INT)??10,R=xE(S),j=w.useMemo(()=>new Set((g==null?void 0:g.prepared_spells)??[]),[g==null?void 0:g.prepared_spells]),D=w.useMemo(()=>y.filter(te=>te.rank>0&&j.has(te.id)).length,[y,j]),T=D<R,F=async(te,ce)=>{if(s(null),!g)return;const _e=g.prepared_spells??[];let Ie;if(ce)Ie=_e.filter(Le=>Le!==te);else{if(!T){s(`Preparation limit reached (${R} spells based on INT ${S}).`);return}Ie=[..._e,te]}try{await b({prepared_spells:Ie})}catch(Le){console.error("Error updating prepared spells:",Le),s(Le instanceof Error?Le.message:"Failed to update preparation")}},{preparedSpellsList:O,grimoireSpellsList:Q}=w.useMemo(()=>{const te=y.filter(Le=>Le.rank===0),ce=y.filter(Le=>Le.rank>0&&j.has(Le.id)),_e=[...te,...ce].sort((Le,Be)=>Le.rank-Be.rank||Le.name.localeCompare(Be.name)),Ie=[...y].sort((Le,Be)=>Le.rank-Be.rank||Le.name.localeCompare(Be.name));return{preparedSpellsList:_e,grimoireSpellsList:Ie}},[y,j]),Y=w.useMemo(()=>{const te=new Set;return y.forEach(ce=>te.add(ce.rank)),Array.from(te).sort((ce,_e)=>ce-_e)},[y]),H=w.useMemo(()=>{const te=[{label:"All",value:"all"}];return Y.forEach(ce=>{ce===0?te.push({label:"Trick",value:0}):ce>=1&&ce<=9&&te.push({label:`Rank ${ce}`,value:ce})}),te},[Y]),B=w.useMemo(()=>{const te=o==="prepared"?O:Q;if(h==="all")return te;const ce=typeof h=="number"?h:-1;return te.filter(_e=>_e.rank===ce)},[o,O,Q,h]),A=v;let M=null,G=null,k=!1;const K=["Animism","Elementalism","Symbolism","General Magic"];if(g&&A){const te=new Set([...g.trainedSkills??[],...Object.keys(g.skill_levels??{})]);if(A==="Animist"&&te.has("Animism")?M="Animism":A==="Elementalist"&&te.has("Elementalism")?M="Elementalism":(M=K.find(ce=>te.has(ce))??null,!M&&te.has(A)&&(M=A)),console.log(`[SpellcastingView - Calc] Character ID: ${g.id}`),console.log(`[SpellcastingView - Calc] Derived School Name (Display Hint): ${A}`),console.log(`[SpellcastingView - Calc] Determined Actual Magic Skill Name: ${M}`),console.log("[SpellcastingView - Calc] Character Skills Set:",te),M){const ce=sI(g.skill_levels),_e=ce==null?void 0:ce[M],Ie=((Z=g.trainedSkills)==null?void 0:Z.includes(M))??!1;console.log("[SpellcastingView - Calc] Trained Skills Array:",g.trainedSkills),console.log(`[SpellcastingView - Calc] Is ${M} Trained?: ${Ie}`),console.log("[SpellcastingView - Calc] Parsed Skill Levels:",ce),console.log(`[SpellcastingView - Calc] Stored Level for ${M}: ${_e}`),_e!==void 0?(G=_e,console.log(`[SpellcastingView - Calc] Using stored level: ${G}`)):(console.log(`[SpellcastingView - Calc] No stored level found for ${M}, calculating fallback...`),G=nI(g,M)),k=((ye=g.conditions)==null?void 0:ye.scared)??!1,console.log(`[SpellcastingView - Calc] Final Magic Skill Value: ${G}, Affected by Bane: ${k}`)}else console.warn(`[SpellcastingView - Calc] Could not determine actual magic skill name for character based on school '${A}'.`)}else console.log(`[SpellcastingView - Calc] Skipping calculation: Character or Derived School Name missing. Name: ${A}`);if(w.useEffect(()=>{const te={};y.forEach(ce=>{ce.powerLevel==="yes"&&(te[ce.id]=c[ce.id]||1)}),d(te)},[y]),!g)return null;const z=async te=>{l(te.id),r(null);try{const ce=g.current_wp??g.attributes.WIL,_e=Number(te.willpowerCost??0),Ie=c[te.id]||1,Le=te.powerLevel==="yes",Be=Le?_e+(Ie-1)*2:_e;if(ce<Be){r(`Insufficient Willpower Points (Need ${Be}, Have ${ce})`),l(null);return}const $=ce-Be;await b({current_wp:$}),x(`Casted ${te.name}${Le?` (Lvl ${Ie})`:""} for ${Be} WP.`)}catch(ce){console.error("Error casting spell:",ce),r(ce instanceof Error?ce.message:"Failed to cast spell")}finally{l(null)}},I=(te,ce)=>{d(_e=>{const Ie=_e[te]||1,Le=Math.max(1,Math.min(3,Ie+ce));return{..._e,[te]:Le}})},he=()=>{!M||G===null||p({initialDice:["d20"],rollMode:"skillCheck",targetValue:G,description:`${M} Check`,requiresBane:k,skillName:M})},Ee=({spell:te,isPreparedView:ce})=>{const _e=j.has(te.id),Ie=te.rank===0,Le=!Ie&&(_e||T),Be=te.powerLevel==="yes",$=c[te.id]||1,W=Number(te.willpowerCost??0),ee=Be?W+($-1)*2:W,pe=(g.current_wp??g.attributes.WIL)<ee;let Ne=`Rank ${te.rank}`,Re="bg-amber-100",We="text-amber-800",et="border-amber-200";return te.rank===0?(Ne="Trick",Re="bg-gray-100",We="text-gray-800",et="border-gray-300"):te.rank<=1?(Re="bg-blue-100",We="text-blue-800",et="border-blue-200"):te.rank<=3&&(Re="bg-purple-100",We="text-purple-800",et="border-purple-200"),a.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm flex flex-col justify-between ${!ce&&!Ie?"opacity-70":""}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-base text-gray-900 flex items-center gap-1.5",children:te.name}),!ce&&a.jsx("div",{className:"ml-2 flex-shrink-0",children:Ie?a.jsx(tp,{className:"w-5 h-5 text-green-500",title:"Tricks are always prepared"}):a.jsx("button",{onClick:()=>F(te.id,_e),disabled:!Le||E,className:`disabled:opacity-50 disabled:cursor-not-allowed ${E?"animate-pulse":""}`,title:_e?"Click to unprepare":T?"Click to prepare":`Preparation limit reached (${R})`,children:_e?a.jsx(tp,{className:"w-5 h-5 text-blue-600 hover:text-blue-800"}):a.jsx($2,{className:`w-5 h-5 ${T?"text-gray-400 hover:text-gray-600":"text-gray-300"}`})})})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Re} ${We} border ${et}`,children:Ne}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pn,{size:14,className:"text-gray-400"}),a.jsxs("span",{children:[ee," WP",Be&&$>1&&a.jsxs("span",{className:"text-xs text-blue-600",children:[" (Lvl ",$,")"]})]})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-2 mb-4",children:[te.requirement&&a.jsxs("p",{className:"text-amber-700 bg-amber-50 px-2 py-1 rounded border border-amber-200",children:[a.jsx("span",{className:"font-medium",children:"Requirement:"})," ",te.requirement]}),a.jsxs("p",{className:"whitespace-normal break-words",children:[a.jsx("span",{className:"font-medium",children:"Description:"})," ",te.description||"No description available."]}),a.jsx("hr",{className:"border-gray-200 my-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1 text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(lh,{size:12})," ",te.castingTime]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx($A,{size:12})," ",te.range]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(L0,{size:12})," ",te.duration]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pn,{size:12})," ",W," WP ",Be?"(Base)":""]})]})]})]}),ce&&a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center justify-center gap-1",children:Be?a.jsxs(a.Fragment,{children:[a.jsxs(V,{variant:"primary",size:"sm",onClick:()=>I(te.id,-1),disabled:$<=1||i!==null||E,className:"px-2","aria-label":"Decrease power level",title:"Decrease power level",children:[" ",a.jsx(L2,{size:14})," "]}),a.jsxs(V,{variant:"primary",size:"sm",onClick:()=>z(te),loading:i===te.id||E,disabled:i!==null||E||pe,className:"flex-grow min-w-[80px]",title:pe?`Insufficient WP (Need ${ee})`:`Cast ${te.name} at Level ${$}`,children:[" ",i===te.id?"":`Cast Lvl ${$}`," "]}),a.jsxs(V,{variant:"primary",size:"sm",onClick:()=>I(te.id,1),disabled:$>=3||i!==null||E,className:"px-2","aria-label":"Increase power level",title:"Increase power level",children:[" ",a.jsx(zt,{size:14})," "]})]}):a.jsxs(V,{variant:"primary",size:"sm",onClick:()=>z(te),loading:i===te.id||E,disabled:i!==null||E||pe,className:"w-full",title:pe?`Insufficient WP (Need ${ee})`:`Cast ${te.name}`,children:[" ",i===te.id?"":"Cast"," "]})})}),!ce&&!Ie&&a.jsx("div",{className:"mt-auto pt-3 text-center text-xs text-gray-400 italic",children:_e?"Prepared":"Prepare in Grimoire"})]})};return N?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:[a.jsx(ze,{}),a.jsx("p",{className:"text-center mt-2 text-gray-600",children:"Loading spell details..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-7xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 text-gray-800 mb-1",children:[a.jsx(Hi,{className:"w-6 h-6 text-purple-600"}),"Spellcasting"]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Current WP: ",a.jsx("strong",{className:"font-semibold",children:g.current_wp??g.attributes.WIL})," / ",g.attributes.WIL]}),M&&G!==null&&a.jsxs("div",{className:`flex items-center gap-1 cursor-pointer px-2 py-0.5 rounded transition-colors ${k?"text-red-700 bg-red-50 hover:bg-red-100 ring-1 ring-red-200":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 ring-1 ring-indigo-200"}`,onClick:he,title:`Click to roll ${M} (Target  ${G}${k?", Bane":""})`,children:[a.jsx(On,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"font-medium",children:[M,":"]})," ",a.jsx("span",{children:G}),k&&a.jsx("span",{className:"text-xs font-semibold",children:"(Bane)"})]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none focus:outline-none mt-[-4px]","aria-label":"Close",children:""})]}),t&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Casting Error"}),a.jsx("p",{className:"text-xs text-red-700",children:t})]})]}),n&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Preparation Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:n})]})]}),_&&a.jsxs("div",{className:"mb-2 flex items-start gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Spell Data Error"}),a.jsx("p",{className:"text-xs text-yellow-700",children:_})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>{u("prepared"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="prepared"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(vd,{size:16})," Prepared (",O.length,")"]}),a.jsxs("button",{onClick:()=>{u("grimoire"),f("all")},className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm flex items-center gap-1.5 ${o==="grimoire"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(S2,{size:16})," Grimoire (",y.length,")"]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"py-3 px-1 text-sm text-gray-500",children:["Preparation Slots: ",a.jsxs("span",{className:"font-medium",children:[D," / ",R]})," (INT ",S,")"]})]})}),y.length>0&&H.length>1&&a.jsxs("div",{className:"pt-4 flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-600 flex items-center gap-1 mr-1 shrink-0",children:[a.jsx(hs,{size:14})," Filter:"]}),H.map(te=>a.jsx(V,{variant:h===te.value?"primary":"outline",size:"xs",onClick:()=>f(te.value),className:`px-2.5 py-1 ${h===te.value?"":"text-gray-600 bg-white hover:bg-gray-50"}`,children:te.label},te.value))]})]}),a.jsx("div",{className:"overflow-y-auto flex-grow p-6 bg-gray-50",children:B.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:B.map(te=>a.jsx(Ee,{spell:te,isPreparedView:o==="prepared"},te.id))}):a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[N&&a.jsx("p",{children:"Loading spells..."}),!N&&_&&a.jsx("p",{children:"Could not load spell details."}),!N&&!_&&a.jsxs(a.Fragment,{children:[o==="prepared"&&O.length===0&&a.jsx("p",{children:"No spells prepared. Go to the Grimoire tab to prepare spells. Tricks are always prepared."}),o==="grimoire"&&Q.length===0&&a.jsx("p",{children:"Character has not learned any spells."}),o==="prepared"&&O.length>0&&B.length===0&&a.jsx("p",{children:"No prepared spells match the selected rank filter."}),o==="grimoire"&&Q.length>0&&B.length===0&&a.jsx("p",{children:"No learned spells match the selected rank filter."})]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:a.jsx(V,{variant:"outline",onClick:e,disabled:i!==null||E,children:"Close"})})]})})}const Cy=["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS","CLOTHES","MUSICAL INSTRUMENTS","TRADE GOODS","STUDIES & MAGIC","LIGHT SOURCES","TOOLS","CONTAINERS","MEDICINE","SERVICES","HUNTING & FISHING","MEANS OF TRAVEL","ANIMALS"],iI=[{name:"Armor & Weapons",categories:["ARMOR & HELMETS","MELEE WEAPONS","RANGED WEAPONS"],Icon:os},{name:"Clothing & Accessories",categories:["CLOTHES"],Icon:au},{name:"Musical & Trade Goods",categories:["MUSICAL INSTRUMENTS","TRADE GOODS"],Icon:hy},{name:"Magic & Studies",categories:["STUDIES & MAGIC"],Icon:MA},{name:"Light & Tools",categories:["LIGHT SOURCES","TOOLS"],Icon:qA},{name:"Containers & Medicine",categories:["CONTAINERS","MEDICINE"],Icon:au},{name:"Services",categories:["SERVICES"],Icon:hy},{name:"Hunting & Travel",categories:["HUNTING & FISHING","MEANS OF TRAVEL"],Icon:E2},{name:"Animals",categories:["ANIMALS"],Icon:Pu}];function lI({onClose:e}){var M,G,k,K,z,I,he,Ee,be,Z,ye,te,ce,_e,Ie,Le,Be;const{isAdmin:t,isDM:r}=Ot(),[n,s]=w.useState(null),[i,l]=w.useState("inventory"),[o,u]=w.useState({search:"",category:"all"}),[c,d]=w.useState({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""}),[h,f]=w.useState(!1),[p,g]=w.useState(null),{character:b,updateCharacterData:E,updateInventory:x,isSaving:y,saveError:v,allGameItems:N,isLoadingGameItems:_,_loadGameItems:S}=ir($=>({character:$.character,updateCharacterData:$.updateCharacterData,updateInventory:$.updateInventory,isSaving:$.isSaving,saveError:$.saveError,allGameItems:$.allGameItems,isLoadingGameItems:$.isLoadingGameItems,_loadGameItems:$._loadGameItems}));if(w.useEffect(()=>{N.length===0&&!_&&S()},[S,N,_]),w.useEffect(()=>{if(v){s(`Save failed: ${v}`);const $=setTimeout(()=>s(null),5e3);return()=>clearTimeout($)}else s(null)},[v]),!b)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 text-center",children:[a.jsx(ze,{}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Loading character data..."})]})});const R=$=>{if(!(!$||typeof $!="string"))return N.find(W=>{var ee;return((ee=W.name)==null?void 0:ee.toLowerCase())===$.toLowerCase()})},j=($,W)=>{var Ne;s(null);const ee=((Ne=b.equipment)==null?void 0:Ne.money)||{gold:0,silver:0,copper:0},pe=Math.max(0,(ee[$]||0)+W);E({equipment:{...b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},money:{...ee,[$]:pe}}})},D=()=>{var Ne,Re,We;if(s(null),!c.name||!c.cost){s("Name and cost are required for custom items");return}if(!Ty(c.cost)){s('Invalid cost format. Use e.g., "10 silver", "1 gold 5 copper".');return}const W={id:`custom-${Date.now()}-${Math.random().toString(36).substring(7)}`,name:c.name.trim(),quantity:c.quantity>0?c.quantity:1,unit:((Ne=c.unit)==null?void 0:Ne.trim())||void 0,originalName:bc({name:c.name.trim(),quantity:c.quantity,unit:(Re=c.unit)==null?void 0:Re.trim()}),cost:c.cost,weight:c.weight,category:c.category,effect:c.effect||void 0},ee=((We=b.equipment)==null?void 0:We.inventory)||[],pe=Xl(ee,W);x(pe),f(!1),d({name:"",category:"TRADE GOODS",cost:"1 silver",weight:1,effect:"",quantity:1,unit:""})},T=($,W)=>{s(null);const ee=R($.name);if(!ee){s(`Details not found for item: ${$.name}`);return}const pe=structuredClone(b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}}),Ne=pe.inventory,Re=pe.equipped,We=Ne[W];if(!We||We.id!==$.id){s(`Item "${$.name}" not found at expected index ${W}. Inventory might be out of sync.`);return}We.quantity>1?Ne[W]={...We,quantity:We.quantity-1}:Ne.splice(W,1);const et=typeof ee.category=="string"?ee.category.toUpperCase():"";let St=null;try{if(et==="ARMOR & HELMETS"){const dr=ee.name.toLowerCase().includes("helmet")?"helmet":"armor",X=Re[dr];if(X){const ue=R(X);St=co(X,N),St.quantity=1}Re[dr]=$.name}else if(et==="MELEE WEAPONS"||et==="RANGED WEAPONS"){Re.weapons||(Re.weapons=[]),ee.grip==="2H"&&Re.weapons.length>0&&(Re.weapons.forEach(ue=>{const Te=co(ue.name,N);Te.quantity=1,St=Xl(St?[St]:[],Te)[0]}),Re.weapons=[]);const cr=Re.weapons.reduce((ue,Te)=>ue+(Te.grip==="2H"?2:1),0),dr=ee.grip==="2H"?2:1;if(cr+dr>2)throw new Error(`Cannot equip ${$.name}. Not enough free hands.`);const X={name:$.name,grip:ee.grip||"1H",range:ee.range||"Melee",damage:ee.damage||"1d6",durability:ee.durability,features:ee.features||[]};Re.weapons.push(X)}else throw new Error(`Item "${$.name}" category "${ee.category}" is not directly equippable.`);St?pe.inventory=Xl(Ne,St):pe.inventory=Ne,E({equipment:pe})}catch(cr){s(cr.message||"Failed to equip item.")}},F=($,W)=>{var We;s(null);const ee=structuredClone(b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}});if(!ee.equipped)return;let pe=null,Ne=ee.equipped,Re=ee.inventory;if($==="armor"&&Ne.armor)pe=Ne.armor,Ne.armor=void 0;else if($==="helmet"&&Ne.helmet)pe=Ne.helmet,Ne.helmet=void 0;else if($==="weapon"&&typeof W=="number"&&((We=Ne.weapons)!=null&&We[W]))pe=Ne.weapons[W].name,Ne.weapons.splice(W,1);else{s(`Could not find item to unequip (${$}, ${W})`);return}if(pe){R(pe);let et;et=co(pe,N),et.quantity=1,Re=Xl(Re,et),E({equipment:{...ee,inventory:Re,equipped:Ne}})}else E({equipment:ee})},O=$=>{var St,cr;s(null);const W=Ty($.cost);if(!W){s(`Invalid cost format for item: ${$.name} (${$.cost})`);return}const ee=((St=b.equipment)==null?void 0:St.money)||{gold:0,silver:0,copper:0},{success:pe,newMoney:Ne}=S6(ee,W);if(!pe){s("Not enough money to buy this item."),setTimeout(()=>s(null),3e3);return}const Re=co($.name||"Unknown Item",N);Re.quantity<=0&&(Re.quantity=1);const We=((cr=b.equipment)==null?void 0:cr.inventory)||[],et=Xl(We,Re);E({equipment:{...b.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},inventory:et,money:Ne}})},Q=$=>{var ee;s(null);const W=[...((ee=b.equipment)==null?void 0:ee.inventory)||[]];if($<0||$>=W.length){s("Invalid item index for dropping.");return}W.splice($,1),x(W)},Y=$=>{var pe;s(null);const W=[...((pe=b.equipment)==null?void 0:pe.inventory)||[]];if($<0||$>=W.length){s("Invalid item index for using.");return}const ee={...W[$]};ee.quantity>1?(ee.quantity-=1,W[$]=ee):W.splice($,1),x(W)},H=(((M=b.equipment)==null?void 0:M.inventory)||[]).filter($=>{if(!$||typeof $.name!="string")return!1;const W=$.name.toLowerCase(),ee=o.search.toLowerCase(),pe=R($.name),Ne=typeof(pe==null?void 0:pe.category)=="string"?pe.category.toUpperCase():"",Re=typeof $.originalName=="string"?$.originalName.toLowerCase():"",We=W.includes(ee)||Re.includes(ee),et=o.category==="all"||Ne===o.category.toUpperCase();return We&&et}),B=N.filter($=>{if(!$||typeof $.name!="string")return!1;const W=$.name.toLowerCase(),ee=o.search.toLowerCase(),pe=typeof $.category=="string"?$.category.toUpperCase():"",Ne=W.includes(ee),Re=p?p.categories.includes(pe||""):o.category==="all"||pe===o.category.toUpperCase();return Ne&&Re}),A=()=>{var W,ee;const $=(W=b.equipment)==null?void 0:W.equipped;return!$||!$.armor&&!$.helmet&&(!$.weapons||$.weapons.length===0)?null:a.jsxs("div",{className:"mt-6 pt-4 border-t",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-600 mb-3",children:"Equipped Items"}),a.jsxs("div",{className:"space-y-2",children:[$.armor&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[$.armor," (Armor)"]}),a.jsx(V,{variant:"secondary",size:"xs",icon:af,onClick:()=>F("armor",$.armor),disabled:y,title:`Unequip ${$.armor}`,children:"Unequip"})]}),$.helmet&&a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[$.helmet," (Helmet)"]}),a.jsx(V,{variant:"secondary",size:"xs",icon:af,onClick:()=>F("helmet",$.helmet),disabled:y,title:`Unequip ${$.helmet}`,children:"Unequip"})]}),(ee=$.weapons)==null?void 0:ee.map((pe,Ne)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 rounded",children:[a.jsxs("span",{className:"text-sm font-medium",children:[pe.name," (",pe.grip," Weapon)"]}),a.jsx(V,{variant:"secondary",size:"xs",icon:af,onClick:()=>F("weapon",Ne),disabled:y,title:`Unequip ${pe.name}`,children:"Unequip"})]},`${pe.name}-${Ne}`))]})]})};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col shadow-xl",children:[a.jsxs("div",{className:"p-4 md:p-6 border-b flex-shrink-0 bg-gray-50 rounded-t-lg",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800",children:i==="inventory"?"Inventory & Equipped":i==="shop"?"Shop":"Money"}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs md:text-sm font-medium",children:[a.jsx(EA,{className:"w-3 h-3 md:w-4 md:h-4"}),k6(((G=b.equipment)==null?void 0:G.money)||{gold:0,silver:0,copper:0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{size:"sm",variant:i==="inventory"?"primary":"secondary",onClick:()=>{l("inventory"),g(null)},children:"Inventory"}),a.jsx(V,{size:"sm",variant:i==="shop"?"primary":"secondary",onClick:()=>{l("shop"),g(null)},children:"Shop"}),a.jsx(V,{size:"sm",variant:i==="money"?"primary":"secondary",onClick:()=>{l("money"),g(null)},children:"Money"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-800 rounded-full hover:bg-gray-200 transition-colors",children:a.jsx(Lt,{className:"w-5 h-5"})})]})]}),(i==="inventory"||i==="shop"&&!p)&&a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mt-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:`Search ${i==="inventory"?"inventory by name":"shop"}...`,value:o.search,onChange:$=>u({...o,search:$.target.value}),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsxs("select",{value:o.category,onChange:$=>u({...o,category:$.target.value}),className:"w-full md:w-auto pl-9 pr-8 py-2 border rounded-lg appearance-none bg-white text-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),Cy.map($=>a.jsx("option",{value:$,children:$},$))]})]}),i==="inventory"&&(t()||r())&&a.jsx(V,{variant:"secondary",size:"sm",icon:zt,onClick:()=>f(!0),children:"Custom Item"})]}),i==="shop"&&p&&a.jsx(V,{variant:"secondary",size:"sm",icon:R0,onClick:()=>g(null),className:"mt-3",children:"Back to Categories"})]}),a.jsxs("div",{className:"p-4 md:p-6 overflow-y-auto flex-1 bg-white",children:[n&&a.jsx("div",{className:"mb-4",children:a.jsx(Ce,{message:n})}),(_||y)&&a.jsxs("div",{className:"flex justify-center items-center py-10",children:[a.jsx(ze,{}),a.jsx("span",{className:"ml-2 text-gray-600",children:y?"Saving...":"Loading items..."})]}),i==="money"&&!y&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-yellow-800 text-center",children:"Gold"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("gold",-1),disabled:y||(((K=(k=b.equipment)==null?void 0:k.money)==null?void 0:K.gold)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-yellow-900 min-w-[3ch] text-center",children:((I=(z=b.equipment)==null?void 0:z.money)==null?void 0:I.gold)||0}),a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("gold",1),disabled:y,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border border-gray-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-gray-800 text-center",children:"Silver"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("silver",-1),disabled:y||(((Ee=(he=b.equipment)==null?void 0:he.money)==null?void 0:Ee.silver)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-gray-900 min-w-[3ch] text-center",children:((Z=(be=b.equipment)==null?void 0:be.money)==null?void 0:Z.silver)||0}),a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("silver",1),disabled:y,children:"+1"})]})]}),a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsx("h3",{className:"font-medium mb-3 text-orange-800 text-center",children:"Copper"}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("copper",-1),disabled:y||(((te=(ye=b.equipment)==null?void 0:ye.money)==null?void 0:te.copper)||0)<=0,children:"-1"}),a.jsx("span",{className:"text-lg md:text-xl font-bold text-orange-900 min-w-[3ch] text-center",children:((_e=(ce=b.equipment)==null?void 0:ce.money)==null?void 0:_e.copper)||0}),a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>j("copper",1),disabled:y,children:"+1"})]})]})]}),(t()||r())&&a.jsxs("div",{className:"mt-6 pt-6 border-t",children:[a.jsx("h3",{className:"font-medium mb-3 text-sm text-gray-600",children:"Quick Add (Admin/DM)"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsx(V,{variant:"outline",size:"sm",onClick:()=>j("gold",10),disabled:y,children:"+10 Gold"}),a.jsx(V,{variant:"outline",size:"sm",onClick:()=>j("silver",50),disabled:y,children:"+50 Silver"}),a.jsx(V,{variant:"outline",size:"sm",onClick:()=>j("copper",100),disabled:y,children:"+100 Copper"})]})]})]}),i==="shop"&&!_&&!y&&(p===null?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 md:gap-4",children:iI.map($=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-3 md:p-4 border rounded-lg hover:shadow-lg cursor-pointer transition-shadow bg-white hover:bg-gray-50",onClick:()=>g($),children:[a.jsx($.Icon,{className:"w-8 h-8 md:w-10 md:h-10 text-blue-600 mb-2"}),a.jsx("span",{className:"font-medium text-center text-xs md:text-sm",children:$.name})]},$.name))}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[B.map($=>a.jsxs("div",{className:"group relative flex flex-col p-3 border rounded-lg hover:shadow-md transition-shadow bg-white",children:[a.jsxs("div",{className:"flex-1 mb-2",children:[a.jsx("h4",{className:"font-medium text-sm",children:$.name}),a.jsx("p",{className:"text-xs text-gray-500",children:$.category}),a.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:$.effect||$.description||"No description."})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-100",children:[a.jsx("span",{className:"text-xs font-semibold text-green-700",children:$.cost||"N/A"}),a.jsx(V,{variant:"primary",size:"xs",onClick:()=>O($),disabled:y||!$.cost,children:"Buy"})]}),($.effect||$.description)&&a.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:$.effect||$.description})]},$.id)),B.length===0&&a.jsx("p",{className:"text-gray-500 italic col-span-full text-center py-6",children:"No items found matching filters in this category."})]})),i==="inventory"&&!y&&a.jsxs(a.Fragment,{children:[A(),a.jsx("h3",{className:"font-medium text-sm text-gray-600 mt-6 mb-3 pt-4 border-t",children:"Inventory Items"}),a.jsxs("div",{className:"space-y-3",children:[(((Ie=b.equipment)==null?void 0:Ie.inventory)||[]).map(($,W)=>{var We,et,St;if(!H.includes($)||!$||typeof $.name!="string")return null;const ee=R($.name),pe=typeof(ee==null?void 0:ee.category)=="string"?ee.category.toUpperCase():"",Ne=ee&&(pe==="ARMOR & HELMETS"||pe==="MELEE WEAPONS"||pe==="RANGED WEAPONS"),Re=$.quantity>0&&(((We=ee==null?void 0:ee.category)==null?void 0:We.toUpperCase())==="MEDICINE"||((et=ee==null?void 0:ee.category)==null?void 0:et.toUpperCase())==="STUDIES & MAGIC"||((St=ee==null?void 0:ee.category)==null?void 0:St.toUpperCase())==="LIGHT SOURCES"||$.name.toLowerCase().includes("ration"));return a.jsxs("div",{className:"group relative p-3 border rounded-lg hover:shadow-sm transition-shadow flex items-center justify-between gap-2 bg-white",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-sm truncate",title:bc($),children:bc($)}),ee&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-1",children:ee.effect||ee.description||"No description."})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ee==null?void 0:ee.category)&&a.jsx("span",{className:"hidden sm:inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 text-gray-700 whitespace-nowrap",children:ee.category}),Re&&a.jsx(V,{variant:"outline",size:"xs",icon:bA,onClick:()=>Y(W),disabled:y,title:`Use one ${$.name}`,children:"Use"}),Ne&&a.jsx(V,{variant:"secondary",size:"xs",icon:tp,onClick:()=>T($,W),disabled:y,title:`Equip ${$.name}`,children:"Equip"}),a.jsx(V,{variant:"dangerOutline",size:"xs",icon:Kr,onClick:()=>Q(W),disabled:y,title:`Drop ${bc($)}`,children:"Drop"}),((ee==null?void 0:ee.effect)||(ee==null?void 0:ee.description))&&a.jsxs("span",{className:"relative inline-block ml-1",children:[a.jsx(ls,{className:"w-4 h-4 text-gray-400 cursor-help"}),a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 bg-gray-800 text-white text-xs p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-normal z-10 pointer-events-none",children:[a.jsx("h5",{className:"font-semibold mb-1 border-b border-gray-600 pb-1",children:ee.name}),ee.effect||ee.description,ee.weight&&a.jsxs("p",{className:"mt-1 text-gray-300",children:["Weight: ",ee.weight]}),ee.cost&&a.jsxs("p",{className:"text-gray-300",children:["Cost: ",ee.cost]})]})]})]})]},$.id||`${$.name}-${W}`)}),H.length===0&&(((Le=b.equipment)==null?void 0:Le.inventory)||[]).length>0&&a.jsx("div",{className:"text-center py-8 text-gray-500 italic",children:"No items match current filters."}),(((Be=b.equipment)==null?void 0:Be.inventory)||[]).length===0&&!A()&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(au,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{className:"text-gray-500",children:"Inventory is empty."}),a.jsx(V,{variant:"link",size:"sm",onClick:()=>l("shop"),className:"mt-2",children:"Go to Shop"})]})]}),h&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Create Custom Item"}),a.jsx("button",{onClick:()=>f(!1),className:"p-1 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-200",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Name"}),a.jsx("input",{type:"text",value:c.name,onChange:$=>d({...c,name:$.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Category"}),a.jsx("select",{value:c.category,onChange:$=>d({...c,category:$.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm bg-white",children:Cy.map($=>a.jsx("option",{value:$,children:$},$))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Cost (per item)"}),a.jsx("input",{type:"text",value:c.cost,onChange:$=>d({...c,cost:$.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., 1 gold 5 silver"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Weight (per item)"}),a.jsx("input",{type:"number",value:c.weight,onChange:$=>d({...c,weight:Number($.target.value)}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Quantity"}),a.jsx("input",{type:"number",value:c.quantity,onChange:$=>d({...c,quantity:Math.max(1,Number($.target.value))}),className:"w-full px-3 py-1.5 border rounded-md text-sm",min:"1"})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Unit (Optional)"}),a.jsx("input",{type:"text",value:c.unit,onChange:$=>d({...c,unit:$.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",placeholder:"e.g., meters, doses"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1 font-medium text-gray-600",children:"Effect/Description"}),a.jsx("textarea",{value:c.effect,onChange:$=>d({...c,effect:$.target.value}),className:"w-full px-3 py-1.5 border rounded-md text-sm",rows:2})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[a.jsx(V,{variant:"secondary",size:"sm",onClick:()=>f(!1),children:"Cancel"}),a.jsx(V,{variant:"primary",size:"sm",icon:zt,onClick:D,disabled:y||!c.name||!c.cost,children:"Add Item"})]})]})]})]})]})})}const mf={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},oI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,uI=(e,t,r)=>{var l,o;const n=((l=e.trainedSkills)==null?void 0:l.includes(t))??!1,s=((o=e.attributes)==null?void 0:o[r])??10,i=oI(s);return n?i*2:i},cI=e=>({STR:"exhausted",CON:"sickly",AGL:"dazed",INT:"angry",WIL:"scared",CHA:"disheartened"})[e],dI=e=>{if(typeof e=="string")try{const t=JSON.parse(e);return typeof t=="object"&&t!==null?t:{}}catch{return{}}else if(typeof e=="object"&&e!==null)return e;return{}},jy=e=>e?e.split("(")[0].trim():null,hI=e=>["d4","d6","d8","d10","d12","d20"].includes(e),pf=e=>e?Array.isArray(e)?e.join(", "):e:"-";function fI({character:e}){var y,v,N,_,S,R;const{toggleDiceRoller:t}=ma(),{data:r=[],isLoading:n,error:s}=jt({queryKey:["gameItems"],queryFn:uh,staleTime:1e3*60*10}),i=j=>{if(j)return r.find(D=>{var T;return((T=D.name)==null?void 0:T.toLowerCase())===j.toLowerCase()})},l=()=>{var F,O,Q,Y;let j=0;const D=(O=(F=e.equipment)==null?void 0:F.equipped)==null?void 0:O.armor,T=(Y=(Q=e.equipment)==null?void 0:Q.equipped)==null?void 0:Y.helmet;if(D){const H=i(D);j+=Number(H==null?void 0:H.armor_rating)||0}if(T){const H=i(T);j+=Number(H==null?void 0:H.armor_rating)||0}return j},o=(j,D)=>{const T=D==null?void 0:D.match(/(\d+)?d(\d+)/i);let F=["d6"],O="1d6";if(T){const K=T[1]?parseInt(T[1],10):1,z=`d${T[2]}`;hI(z)&&(F=Array(K).fill(z),O=`${K}d${T[2]}`)}let Q="",Y=null;const H=i(j),B=H==null?void 0:H.skill,A=jy(B),M=A?mf[A]:null;M==="STR"?e.attributes.STR>15?(Q="d6",Y="d6"):e.attributes.STR>12&&(Q="d4",Y="d4"):M==="AGL"&&(e.attributes.AGL>15?(Q="d6",Y="d6"):e.attributes.AGL>12&&(Q="d4",Y="d4"));let G=O;Q&&(G+=` + ${Q}`);const k=[...F];Y&&k.push(Y),t({rollMode:"attackDamage",initialDice:k,description:`Damage roll for ${j} (${G})`})},u=(j,D,T)=>{t({initialDice:["d20"],rollMode:"skillCheck",targetValue:D,description:`${j} Check`,requiresBane:T,skillName:j})},c=l(),d=((v=(y=e.equipment)==null?void 0:y.equipped)==null?void 0:v.weapons)||[],h=dI(e.skill_levels),f=(_=(N=e.equipment)==null?void 0:N.equipped)==null?void 0:_.armor,p=(R=(S=e.equipment)==null?void 0:S.equipped)==null?void 0:R.helmet,g=f?i(f):void 0,b=p?i(p):void 0,E=g?pf(g.features):"-",x=b?pf(b.features):"-";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[" ",a.jsx(os,{className:"w-5 h-5 text-blue-600"})," Armor"]}),n?a.jsx(ze,{size:"sm"}):s?a.jsx(Ce,{message:"Could not load item details for armor."}):a.jsxs("div",{className:"space-y-3",children:[" ",a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Body:"})," ",(g==null?void 0:g.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(g==null?void 0:g.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",g.armor_rating,")"]})]}),g&&g.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(cy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:E})]})]}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Helmet:"})," ",(b==null?void 0:b.name)||a.jsx("span",{className:"italic text-gray-500",children:"None"}),(b==null?void 0:b.armor_rating)!==void 0&&a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(AR: ",b.armor_rating,")"]})]}),b&&b.features&&a.jsxs("p",{className:"text-xs text-gray-600 pl-4 flex items-center gap-1 mt-0.5",children:[a.jsx(cy,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),a.jsx("span",{children:x})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium mt-2",children:[a.jsx(os,{className:"w-4 h-4"}),a.jsxs("span",{children:["Total Armor Rating: ",c]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-gray-700",children:[a.jsx(Xa,{className:"w-5 h-5 text-red-600"})," Weapons"]}),n?a.jsx(ze,{size:"sm"}):s?a.jsx(Ce,{message:"Could not load item details for weapons."}):d.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No weapons equipped."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Weapon / Shield"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Grip"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Range"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Damage"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Features"}),a.jsx("th",{scope:"col",className:"px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:d.map((j,D)=>{var A;const T=i(j.name),F=T==null?void 0:T.skill,O=jy(F);let Q=null,Y=!1,H=null;if(O&&mf[O]){H=mf[O],Q=(h==null?void 0:h[O])??uI(e,O,H);const M=cI(H);Y=((A=e.conditions)==null?void 0:A[M])??!1}const B=pf(j.features);return a.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:j.name}),a.jsx("td",{className:"px-4 py-2",children:j.grip||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.range||"-"}),a.jsx("td",{className:"px-4 py-2",children:j.damage||"-"}),a.jsx("td",{className:"px-4 py-2",children:B}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[j.damage?a.jsxs(V,{variant:"link",size:"xs",onClick:()=>o(j.name,j.damage),className:"text-red-600 hover:text-red-800 font-medium p-0 flex items-center gap-1",title:`Roll damage for ${j.name} (${j.damage})`,children:[a.jsx(On,{className:"w-3 h-3"}),"Damage"]}):null,O&&Q!==null?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(V,{variant:"link",size:"xs",onClick:()=>u(O,Q,Y),className:`${Y?"text-red-600 hover:text-red-800":"text-indigo-600 hover:text-indigo-800"} font-medium p-0 flex items-center gap-1`,title:`Roll ${O} check (Target  ${Q}${Y?", Bane":""})`,children:[a.jsx(On,{className:"w-3 h-3"}),O,": ",Q]}),Y&&a.jsx("span",{className:"text-xs text-red-500 font-semibold",children:"(Bane)"})]}):F?a.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Skill '${F}' not found or level unavailable.`,children:["(",O||F," N/A)"]}):null]})})]},`${j.name}-${D}`)})})]})})]})]})}var yE=(e=>(e.Acrobatics="Acrobatics",e.Arcana="Arcana",e.Athletics="Athletics",e.Deception="Deception",e.History="History",e.Insight="Insight",e.Intimidation="Intimidation",e.Investigation="Investigation",e.Medicine="Medicine",e.Nature="Nature",e.Perception="Perception",e.Performance="Performance",e.Persuasion="Persuasion",e.Religion="Religion",e.SleightOfHand="SleightOfHand",e.Stealth="Stealth",e.Survival="Survival",e))(yE||{});function z0(e){return typeof e!="object"||e===null?!1:typeof e.skill=="string"&&Object.values(yE).includes(e.skill)&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}function Ay(e){return typeof e!="object"||e===null?!1:typeof e.skill_id=="string"&&(e.minimumValue===void 0||typeof e.minimumValue=="number")}async function bE(){const{data:e,error:t}=await re.from("heroic_abilities").select(`
      id,
      name,
      description,
      willpower_cost,
      requirement,
      kin,        
      profession  
    `);if(t)throw console.error("Error fetching heroic abilities:",t),new Error(t.message||"Failed to fetch heroic abilities");return(e||[]).map(n=>({id:n.id,name:n.name,description:n.description,willpower_cost:n.willpower_cost,requirement:n.requirement,kin:n.kin,profession:n.profession}))}function mI(e){return jt({queryKey:["heroicAbilities",e],queryFn:async()=>await bE(),staleTime:15*60*1e3})}const pI=e=>Object.entries(e).map(([t,r])=>r!==null?`${t} (Level ${r})`:t).join(", "),gI=e=>e?typeof e=="string"?e:z0(e)?pI(e):typeof e=="object"?(console.warn("Unexpected requirement object format:",e),`Requires: ${Object.keys(e).join(", ")}`):(console.warn("Unexpected requirement type:",typeof e,e),"Unknown requirement format"):null;function xI({onClose:e}){const{character:t,updateCharacterData:r,isSaving:n,setActiveStatusMessage:s}=ir(),{data:i,isLoading:l,error:o}=mI(),[u,c]=w.useState(null);if(Wr.useEffect(()=>{console.log("HeroicAbilitiesView - Character Data:",t)},[t]),!t)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6",children:[a.jsx(ze,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading character data..."})]})});const d=w.useMemo(()=>{if(!i||!t||!t.heroic_ability)return console.log("Filtering abilities: Missing data",{allAbilities:!!i,character:!!t,heroic_ability:t==null?void 0:t.heroic_ability}),[];const g=new Set(Array.isArray(t.heroic_ability)?t.heroic_ability:[]);console.log("Filtering abilities: Character abilities names:",g);const b=i.filter(E=>g.has(E.name));return console.log("Filtering abilities: Filtered result:",b),b},[i,t]),h=async g=>{c(null),console.log(`Attempting to activate ability: ${g.name}`);const b=g.willpower_cost,E=t.current_wp;if(console.log(`Ability cost: ${b}, Current WP: ${E}`),b==null||b<=0){console.log(`Activated free ability: ${g.name}`),s(`Used Heroic Ability: ${g.name}`);return}if(typeof E!="number"){const x=`Cannot activate ${g.name}: Current Willpower (current_wp) is not a valid number. Value: ${E}`;c(x),console.error(x);return}if(E>=b){const x=E-b;console.log(`Sufficient WP. New WP will be: ${x}`);try{console.log(`Calling updateCharacterData with: { current_wp: ${x} }`),await r({current_wp:x}),console.log(`Successfully activated ability: ${g.name}. WP updated to: ${x}`),s(`Used Heroic Ability: ${g.name} for ${b} WP.`)}catch(y){const v=`Failed to update Willpower for ${g.name}: ${y.message}`;c(v),console.error("Error updating WP via store:",y)}}else{const x=`Not enough Willpower Points to activate ${g.name}. Required: ${b}, Available: ${E}`;c(x),console.warn(x)}},f=()=>l?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx(ze,{}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading heroic abilities..."})]}):o?a.jsx("div",{className:"p-6",children:a.jsx(Ce,{message:`Failed to load abilities: ${o.message}`})}):t.profession==="Mage"?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800",children:"Magic Instead of Heroic Abilities"}),a.jsx("p",{className:"text-sm text-blue-700",children:"As a mage, you use magic instead of heroic abilities. Check the Spells tab to manage your magical capabilities."})]})]})}):!d||d.length===0?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start gap-2 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx(ls,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"No Heroic Abilities Assigned"}),a.jsx("p",{className:"text-sm text-gray-700",children:"This character does not currently have any heroic abilities assigned in their profile (check `characters.heroic_ability`), or the abilities could not be loaded from the `heroic_abilities` table."})]})]})}):a.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[u&&a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(U2,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800",children:"Activation Failed"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(g=>{const b=g.willpower_cost,E=t.current_wp,x=b==null||b<=0||typeof E=="number"&&E>=b,y=gI(g.requirement);return a.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:g.name}),a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded",children:b!=null&&b>0?a.jsxs(a.Fragment,{children:[a.jsx(bd,{className:"w-4 h-4 text-amber-500"}),a.jsxs("span",{children:[b," WP"]})]}):a.jsx("span",{className:"text-green-600",children:"Free"})})]}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:g.description}),y&&a.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Requirement: ",y]})]}),a.jsxs(V,{onClick:()=>h(g),disabled:!x||n,loading:n,variant:x?"default":"secondary",size:"sm",className:"w-full mt-4",children:[a.jsx(Pn,{className:"w-4 h-4 mr-2"}),"Activate ",b!=null&&b>0?`(${b} WP)`:""]})]},g.id)})})]}),p=typeof t.current_wp=="number"?t.current_wp:"N/A";return console.log("Displaying WP:",p,"(raw value:",t.current_wp,")"),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(U0,{className:"w-6 h-6 text-blue-600"}),"Heroic Abilities"]}),a.jsxs("p",{className:"text-gray-600",children:["Available Willpower: ",p," WP"]})]}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-3xl leading-none","aria-label":"Close",children:""})]})}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:f()}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(V,{variant:"outline",onClick:e,children:"Close"})})]})})}const Iy={Mentalism:"WIL",Animism:"WIL",Elementalism:"WIL"},yI=e=>e<=5?3:e<=8?4:e<=12?5:e<=15?6:7,$n=e=>{const t=ir.getState().character,r=gl(t==null?void 0:t.skill_levels);return(r==null?void 0:r[e])??0};function bI(e){const t=["Acrobatics","Awareness","Bartering","Beast Lore","Bluffing","Bushcraft","Crafting","Evade","Healing","Hunting & Fishing","Languages","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Spot Hidden","Swimming","Axes","Bows","Brawling","Crossbows","Hammers","Knives","Slings","Spears","Staves","Swords"],r=new Set([...e.trainedSkills||[],...e.untrainedSkills||[],...t]);!!e.magicSchool&&Object.keys(Iy).forEach(o=>r.add(o));const s={Acrobatics:"AGL",Awareness:"INT",Bartering:"CHA","Beast Lore":"INT",Bluffing:"CHA",Bushcraft:"INT",Crafting:"STR",Evade:"AGL",Healing:"INT","Hunting & Fishing":"AGL",Languages:"INT","Myths & Legends":"INT",Performance:"CHA",Persuasion:"CHA",Riding:"AGL",Seamanship:"INT","Sleight of Hand":"AGL",Sneaking:"AGL","Spot Hidden":"INT",Swimming:"AGL",Axes:"STR",Bows:"AGL",Brawling:"STR",Crossbows:"AGL",Hammers:"STR",Knives:"AGL",Slings:"AGL",Spears:"STR",Staves:"AGL",Swords:"STR",...Iy},i=[],l=gl(e.skill_levels);return r.forEach(o=>{var f;const u=s[o];if(!u)return;const c=((f=e.trainedSkills)==null?void 0:f.includes(o))??!1,h=(l==null?void 0:l[o])??(()=>{const p=e.attributes[u],g=yI(p);return c?g*2:g})();i.push({name:o,attribute:u,level:h,isTrained:c})}),i.sort((o,u)=>o.name.localeCompare(u.name)),i}const vI=(e,t)=>{var l,o;if(!t)return!1;if(!e.requirement)return!0;const r=e.requirement,n=t.attributes,s=gl(t.skill_levels),i=Object.fromEntries(Object.entries(n).map(([u,c])=>[u.toUpperCase(),c]));if(typeof r=="string"){const u=r.split(" ");if(u.length===2){const c=u[0].toUpperCase(),d=parseInt(u[1],10);if(!isNaN(d)){if(c in i)return i[c]>=d;const h=(l=Object.entries(s).find(([f])=>f.toUpperCase()===c))==null?void 0:l[1];if(h!==void 0)return h>=d}}return!1}else if(typeof r=="object"&&r!==null){for(const[u,c]of Object.entries(r)){if(c==null)continue;const d=u.toUpperCase();if(d in i){if(i[d]<c)return!1}else{const h=(o=Object.entries(s).find(([f])=>f.toUpperCase()===d))==null?void 0:o[1];if(h===void 0||h<c)return!1}}return!0}else return!1},vE=e=>{var r;if(!e)return[];const t=[];return e.general&&t.push(...e.general.map(n=>n.toUpperCase())),(r=e.school)!=null&&r.spells&&t.push(...e.school.spells.map(n=>n.toUpperCase())),Array.from(new Set(t))},wI=(e,t,r,n)=>{var E;if(!e)return!0;const s=vE(t.spells),i=gl(t.skill_levels),l=t.attributes,o=x=>{let y=!1;switch(x.type){case"spell":y=s.includes(x.name.toUpperCase());break;case"school":y=(r==null?void 0:r.toUpperCase())===x.name.toUpperCase();break;case"anySchool":y=!!t.magicSchool;break;case"skill":const v=i[x.name];y=v!==void 0&&v>=x.value;break;case"attribute":const N=l[x.name.toLowerCase()];y=N!==void 0&&N>=x.value;break}return x.negate?!y:y};let u;const c=x=>{if(x.operator==="AND"){const y=x.conditions.every(v=>u(v));return x.negate?!y:y}else if(x.operator==="OR"){const y=x.conditions.some(v=>u(v));return x.negate?!y:y}return console.warn("Unknown logical operator in spell prerequisite:",x.operator),!1};u=x=>x.type==="logical"?c(x):o(x);let d=null;try{e.trim().startsWith("{")&&(d=JSON.parse(e))}catch{}if(d&&d.type)return u(d);const h=n.map(x=>x.name.toUpperCase()),f=(E=t.magicSchool)==null?void 0:E.name,p=x=>{const y=x.trim().toUpperCase();if(y==="ANY SCHOOL OF MAGIC")return!!t.magicSchool;if(s.includes(y))return!0;if(h.includes(y))return(f==null?void 0:f.toUpperCase())===y;const v=y.split(" ");if(v.length===2){const[N,_]=v,S=parseInt(_,10);if(!isNaN(S)){const R=Object.keys(l).find(D=>D.toUpperCase()===N);if(R)return l[R]>=S;const j=Object.keys(i).find(D=>D.toUpperCase()===N);if(j)return i[j]>=S}}return!1},g=x=>x.trim().split(/ AND /i).every(p);return e.trim().split(/ OR /i).some(g)};function EI({character:e,onClose:t}){var mg;const{character:r,markedSkillsThisSession:n,clearMarkedSkillsThisSession:s,increaseSkillLevel:i,addHeroicAbility:l,setSkillUnderStudy:o,learnSpell:u,isSaving:c,saveError:d}=ir(),{toggleDiceRoller:h}=ma(),[f,p]=w.useState("initial"),[g,b]=w.useState(null),[E,x]=w.useState(0),[y,v]=w.useState(new Set),[N,_]=w.useState([]),[S,R]=w.useState(0),[j,D]=w.useState(null),[T,F]=w.useState(null),[O,Q]=w.useState([]),[Y,H]=w.useState(!1),[B,A]=w.useState(null),[M,G]=w.useState(null),[k,K]=w.useState(null),[z,I]=w.useState(null),[he,Ee]=w.useState([]),[be,Z]=w.useState([]),[ye,te]=w.useState([]),[ce,_e]=w.useState(null),[Ie,Le]=w.useState(!1),Be=r||e,$=w.useMemo(()=>Be?bI(Be):[],[Be]),W=(mg=r==null?void 0:r.teacher)==null?void 0:mg.skillUnderStudy,ee=()=>{b(null),D(null),K(null),x(0),v(new Set),_([]),R(0),F(null),A(null),G(null),te([]),_e(null),Le(!1),H(!1)},pe=()=>{ee(),p("enterMarks")},Ne=()=>{ee(),p("selectStudyType")},Re=async()=>{if(!r||!r.magicSchool){b("Character has no magic school assigned."),p("selectStudyType");return}Le(!0),b(null);try{let ge=be;ge.length===0&&(ge=await rE(),Z(ge));let Je=he;Je.length===0&&(Je=await P4(),Ee(Je));const Ye=ge.find(Pt=>Pt.id===r.magicSchool),at=Ye?Ye.name:null;I(at);const ct=vE(r.spells),it=Je.filter(Pt=>ct.includes(Pt.name.toUpperCase())?!1:wI(Pt.prerequisite,r,at,ge));te(it),p("studyMagicSelectSpell")}catch(ge){console.error("Error loading magic data:",ge),b(ge instanceof Error?ge.message:"Failed to load magic study data."),p("selectStudyType")}finally{Le(!1)}},We=ge=>{ge==="teacher"?p("studyTeacherSelectSkill"):ge==="magic"?Re():b("Invalid study type selected.")},et=ge=>{if(ge.preventDefault(),E>0){const Je=new Set;let Ye=0;const at=$.map(ct=>ct.name);for(const ct of n)Ye<E&&at.includes(ct)&&(Je.add(ct),Ye++);v(Je),b(null),p("selectSkills")}else b("Please enter at least one Advancement Mark.")},St=ge=>{v(Je=>{const Ye=new Set(Je);return Ye.has(ge)?Ye.delete(ge):Ye.size<E&&Ye.add(ge),Ye})},cr=()=>{if(y.size!==E){b(`Please select exactly ${E} skill(s).`);return}b(null),_(Array.from(y)),R(0),D(null),p("rollSkills")},dr=w.useCallback(async ge=>{if(!r){D("Error: Character data not available."),h();return}if(!ge.results||ge.results.length===0){D("Error: Roll results are missing or empty."),h();return}const Je=ge.results[0].value,Ye=ge.skillName,at=ge.targetValue;if(!Ye||at===void 0){D("Error: Roll context missing skill information."),h();return}const ct=Je>at;let it=`Rolled ${Je} vs ${Ye} (Target > ${at}). `;if(ct){it+="Success! Skill increased.",await i(Ye);const Pt=$n(Ye);it+=` New Level: ${Pt}.`,Pt===18&&at<18&&(F(Ye),it+=" Reached level 18!")}else it+="Failed to increase skill.";D(it),h()},[r,i,h,D,F]),X=(ge,Je)=>{const Ye=$n(ge);if(Ye>=18){(Je==="study"?K:D)(`Skill ${ge} is already at max level (18). Cannot advance further.`);return}D(null),K(null);const at=Je==="study"?ya:dr;h({rollMode:"advancementRoll",targetValue:Ye,skillName:ge,description:`Advancement Roll: ${ge} (d20 vs > ${Ye})`,onRollComplete:at})},ue=async(ge,Je)=>{if(!r){(Je==="study"?K:D)("Error: Character data not available.");return}const Ye=$n(ge),at=Je==="study"?K:D;if(Ye>=18){at(`Skill ${ge} is already at max level (18). Cannot advance further.`);return}D(null),K(null);let ct=`Manually advanced ${ge}. Skill increased.`;await i(ge);const it=$n(ge);ct+=` New Level: ${it}.`,it===18&&Ye<18&&(Je==="endSession"&&F(ge),ct+=" Reached level 18!"),at(ct)},Te=()=>{D(null),T?(He(),p("selectAbility")):S<N.length-1?R(ge=>ge+1):bn()},He=async()=>{H(!0),b(null);try{const ge=await bE(),Je=ir.getState().character;if(!Je)throw new Error("Character data not available in store for ability filtering.");const Ye=Je.heroic_ability||[],at=ge.filter(ct=>{var it,Pt;return!(Ye.some(Fl=>Fl.toUpperCase()===ct.name.toUpperCase())||ct.kin&&ct.kin.toLowerCase()!==((it=Je.kin)==null?void 0:it.toLowerCase())||ct.profession&&ct.profession.toLowerCase()!==((Pt=Je.profession)==null?void 0:Pt.toLowerCase())||!vI(ct,Je))});Q(at)}catch(ge){console.error("Error fetching abilities:",ge),b(ge instanceof Error?ge.message:"Failed to load heroic abilities.")}finally{H(!1)}},rt=ge=>{A(ge)},Nr=async()=>{if(!B){b("Please select a heroic ability.");return}b(null),await l(B.name),F(null),A(null),S<N.length-1?(R(ge=>ge+1),p("rollSkills")):bn()},bn=()=>{s(),p("finished")},en=ge=>{G(ge)},xa=async()=>{if(!M){b("Please select a skill to study.");return}b(null),K(null),await o(M),p("studyTeacherRollSkill")},ya=w.useCallback(async ge=>{if(!r){K("Error: Character data not available."),h();return}if(!ge.results||ge.results.length===0){K("Error: Roll results are missing or empty."),h();return}const Je=ge.results[0].value,Ye=ge.skillName,at=ge.targetValue;if(!Ye||at===void 0){K("Error: Roll context missing skill information."),h();return}const ct=Je>at;let it=`Studied ${Ye}. Rolled ${Je} vs Target > ${at}. `;if(ct){it+="Success! Skill increased.",await i(Ye);const Pt=$n(Ye);it+=` New Level: ${Pt}.`,Pt===18&&at<18&&(it+=" Reached level 18!")}else it+="Failed to increase skill this time.";K(it),h()},[r,i,h,K]),er=ge=>{_e(ge)},ps=async()=>{if(!ce){b("Please select a spell to learn.");return}if(!u){b("Error: learnSpell function is not available.");return}b(null);try{await u(ce.name),t()}catch(ge){console.error("Error learning spell:",ge),b(ge instanceof Error?ge.message:"Failed to learn the spell.")}},tn=()=>{G(null),K(null),_e(null),te([]),t()},UN=()=>{if(!Be&&f!=="initial")return a.jsx(ze,{text:"Loading character data..."});switch(f){case"initial":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Choose an action to proceed."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(V,{onClick:pe,className:"flex-1",children:[a.jsx(uo,{className:"w-5 h-5 mr-2"})," End Session & Advance"]}),a.jsxs(V,{onClick:Ne,variant:"outline",className:"flex-1",children:[a.jsx(S2,{className:"w-5 h-5 mr-2"})," Study"]})]})]});case"enterMarks":return a.jsxs("form",{onSubmit:et,className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"End Session Advancement"}),a.jsx("label",{htmlFor:"advancementMarks",className:"block font-medium text-gray-700",children:"How many Advancement Marks did you gain this session?"}),a.jsx("input",{type:"number",id:"advancementMarks",name:"advancementMarks",min:"1",value:E===0?"":E,onChange:we=>x(parseInt(we.target.value,10)||0),className:"w-full p-2 border rounded focus:ring-blue-500 focus:border-blue-500",required:!0}),g&&a.jsx(Ce,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(Yl,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(V,{type:"submit",disabled:E<=0,children:["Next ",a.jsx(Sa,{className:"w-4 h-4 ml-1"})]})]})]});case"selectSkills":return Be?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Select ",E," skill(s) to attempt advancement:"]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:$.length===0?a.jsx("p",{className:"text-gray-500 italic",children:"No skills found for this character."}):$.map(we=>{const vn=$n(we.name),Bn=vn>=18,Vu=we.name===W;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Bn?"opacity-60 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",checked:y.has(we.name),onChange:()=>St(we.name),disabled:Bn||!y.has(we.name)&&y.size>=E,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${we.isTrained?"font-semibold":""}`,children:we.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",we.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",vn]}),Bn&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"}),n.has(we.name)&&!Bn&&a.jsx(bd,{className:"w-4 h-4 text-yellow-500 flex-shrink-0",title:"Marked this session (rolled 1 or 20)"}),Vu&&a.jsx(uo,{className:"w-4 h-4 text-purple-600 flex-shrink-0 ml-1",title:"Currently studying with teacher"})]},we.name)})}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",y.size," / ",E]}),g&&a.jsx(Ce,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{type:"button",variant:"secondary",onClick:()=>p("enterMarks"),children:[a.jsx(Yl,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(V,{onClick:cr,disabled:y.size!==E,children:["Confirm Selection ",a.jsx(Sa,{className:"w-4 h-4 ml-1"})]})]})]}):a.jsx(ze,{});case"rollSkills":if(N.length===0||!Be)return a.jsx(ze,{text:"Preparing skill roll..."});const ge=N[S],Je=$n(ge),Ye=Je>=18,at=!!j;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Attempting Advancement (",S+1," / ",N.length,")"]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:ge}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Je]}),Ye&&!at&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Skipped."})]}),j&&a.jsx("div",{className:`p-3 rounded border text-center ${j.includes("Success")||j.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":j.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:j}),d&&a.jsx(Ce,{message:d}),g&&a.jsx(Ce,{message:g}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!at&&!Ye&&a.jsxs(a.Fragment,{children:[a.jsxs(V,{onClick:()=>X(ge,"endSession"),disabled:c,loading:c,children:[a.jsx(On,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Je,")"]}),a.jsxs(V,{variant:"outline",onClick:()=>ue(ge,"endSession"),disabled:c,loading:c,children:[a.jsx(Pn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(at||Ye&&!at)&&a.jsxs(V,{onClick:Te,disabled:c,loading:c,children:[T?"Select Heroic Ability":S<N.length-1?"Next Skill":"Finish Session"," ",a.jsx(Sa,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Ta,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectAbility":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 flex items-center gap-2",children:[a.jsx(_2,{className:"w-5 h-5"})," Skill ",a.jsx("span",{className:"font-bold",children:T})," reached level 18!"]}),a.jsx("p",{className:"text-gray-700",children:"Select a new Heroic Ability:"}),Y&&a.jsx(ze,{text:"Loading available abilities..."}),g&&a.jsx(Ce,{message:g}),!Y&&O.length===0&&!g&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No eligible heroic abilities found for this character."}),!Y&&O.length>0&&a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:O.map(we=>a.jsxs("div",{onClick:()=>rt(we),className:`p-3 rounded border cursor-pointer ${(B==null?void 0:B.id)===we.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("p",{className:"font-semibold",children:we.name}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:we.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[we.willpower_cost&&a.jsxs("span",{children:["WP: ",we.willpower_cost]}),we.requirement&&typeof we.requirement=="object"&&Object.keys(we.requirement).length>0&&a.jsxs("span",{children:["Req: ",Object.entries(we.requirement).filter(([,vn])=>vn!=null).map(([vn,Bn])=>`${vn} ${Bn}`).join(", ")]}),we.requirement&&typeof we.requirement=="string"&&a.jsxs("span",{children:["Req: ",we.requirement]})]})]},we.id))}),d&&a.jsx(Ce,{message:d}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsxs(V,{onClick:Nr,disabled:!B||Y||c||O.length===0&&!g&&!Y,loading:c,children:["Confirm Ability & Continue ",a.jsx(Sa,{className:"w-4 h-4 ml-1"})]})}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Ta,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"selectStudyType":const ct=!!(r!=null&&r.magicSchool);return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Choose Study Method"}),a.jsx("p",{className:"text-gray-600",children:"How would you like to study to improve a skill or learn magic?"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs(V,{onClick:()=>We("teacher"),className:"flex-1",children:[a.jsx(uo,{className:"w-5 h-5 mr-2"})," Find a Teacher (Skills)"]}),a.jsxs(V,{onClick:()=>We("magic"),variant:"outline",className:"flex-1",disabled:!ct||Ie,loading:Ie,children:[a.jsx(vd,{className:"w-5 h-5 mr-2"})," Study Magic (Spells)"]})]}),!ct&&a.jsxs("p",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-200 flex items-center gap-1",children:[a.jsx(Et,{className:"w-4 h-4 flex-shrink-0"})," Character must belong to a Magic School to study magic."]}),g&&a.jsx(Ce,{message:g}),a.jsx("div",{className:"flex justify-start",children:a.jsxs(V,{type:"button",variant:"secondary",onClick:()=>p("initial"),children:[a.jsx(Yl,{className:"w-4 h-4 mr-1"})," Back"]})})]});case"studyTeacherSelectSkill":return Be?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:"Study with a Teacher"}),a.jsx("p",{className:"text-gray-600",children:"Select one skill to focus on improving. You cannot study a skill currently being studied until it has been advanced or study is completed."}),W&&a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded text-purple-800 text-sm flex items-center gap-2",children:[a.jsx(ls,{className:"w-4 h-4 flex-shrink-0"}),"Currently studying: ",a.jsx("span",{className:"font-semibold",children:W}),". Complete or advance this study first to pick another skill."]}),a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-1 border rounded p-3 bg-gray-50",children:$.map(we=>{const vn=$n(we.name),Bn=vn>=18,Vu=Bn||!!W&&W!==we.name;return a.jsxs("label",{className:`flex items-center space-x-3 p-2 rounded ${Vu?"opacity-60 cursor-not-allowed":M===we.name?"bg-blue-100 border border-blue-300":"hover:bg-gray-100 cursor-pointer"}`,children:[a.jsx("input",{type:"radio",name:"studySkill",checked:M===we.name,onChange:()=>en(we.name),disabled:Vu,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:`flex-grow ${we.isTrained?"font-semibold":""}`,children:we.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",we.attribute,")"]}),a.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:["Lvl ",vn]}),Bn&&a.jsx("span",{className:"text-xs text-yellow-600 font-semibold ml-1",children:"(Max)"})]},we.name)})}),g&&a.jsx(Ce,{message:g}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{type:"button",variant:"secondary",onClick:()=>p("selectStudyType"),children:[a.jsx(Yl,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(V,{onClick:xa,disabled:!M||!!W||c,loading:c,children:["Confirm Study Skill ",a.jsx(Sa,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Ta,{className:"w-4 h-4 animate-spin"})," Saving..."]})]}):a.jsx(ze,{});case"studyTeacherRollSkill":const it=W||M;if(!it||!Be)return a.jsx(Ce,{message:"Error: No skill selected or found for study, or character data missing."});const Pt=$n(it),Fl=Pt>=18,qu=!!k;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["Study Session: ",it]}),a.jsxs("div",{className:"p-4 border rounded bg-gray-50 text-center",children:[a.jsx("p",{className:"text-lg font-semibold",children:it}),a.jsxs("p",{className:"text-gray-600",children:["Current Level: ",Pt]}),Fl&&!qu&&a.jsx("p",{className:"text-yellow-600 font-medium mt-1",children:"Max Level Reached. Study complete."})]}),k&&a.jsx("div",{className:`p-3 rounded border text-center ${k.includes("Success")||k.includes("Manually advanced")?"bg-green-50 border-green-200 text-green-800":k.includes("Failed")?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:k}),d&&a.jsx(Ce,{message:d}),g&&a.jsx(Ce,{message:g}),a.jsxs("div",{className:"flex justify-center gap-4 pt-2",children:[!qu&&!Fl&&a.jsxs(a.Fragment,{children:[a.jsxs(V,{onClick:()=>X(it,"study"),disabled:c,loading:c,children:[a.jsx(On,{className:"w-4 h-4 mr-1"})," Roll (d20 vs ",">"," ",Pt,")"]}),a.jsxs(V,{variant:"outline",onClick:()=>ue(it,"study"),disabled:c,loading:c,children:[a.jsx(Pn,{className:"w-4 h-4 mr-1"})," Advance Manually"]})]}),(qu||Fl&&!qu)&&a.jsxs(V,{onClick:tn,disabled:c,loading:c,children:["Finish Study ",a.jsx(Bi,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Ta,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"studyMagicSelectSpell":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center gap-2",children:[a.jsx(vd,{className:"w-5 h-5 text-purple-600"})," Study Magic"]}),z&&a.jsxs("p",{className:"text-gray-600",children:["School: ",a.jsx("span",{className:"font-semibold",children:z})]}),a.jsx("p",{className:"text-gray-600",children:"Select a spell to learn:"}),Ie&&a.jsx(ze,{text:"Loading spells..."}),g&&a.jsx(Ce,{message:g}),!Ie&&ye.length===0&&!g&&a.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No new spells available to learn at this time, or prerequisites not met."}),!Ie&&ye.length>0&&a.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 border rounded p-3 bg-gray-50",children:ye.map(we=>a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded border cursor-pointer ${(ce==null?void 0:ce.id)===we.id?"bg-blue-100 border-blue-300 ring-2 ring-blue-400":"bg-white hover:bg-blue-50 border-gray-200"}`,children:[a.jsx("input",{type:"radio",name:"learnSpell",checked:(ce==null?void 0:ce.id)===we.id,onChange:()=>er(we),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-semibold",children:[we.name," ",a.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(Rank ",we.rank??"N/A",")"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:we.description}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex flex-wrap gap-x-2 gap-y-1",children:[we.casting_time&&a.jsxs("span",{children:["Cast: ",we.casting_time]}),we.range&&a.jsxs("span",{children:["Range: ",we.range]}),we.duration&&a.jsxs("span",{children:["Duration: ",we.duration]}),we.willpower_cost&&a.jsxs("span",{children:["WP: ",we.willpower_cost]}),we.prerequisite&&a.jsxs("span",{className:"italic",children:["(Learn Req: ",we.prerequisite,")"]}),we.casting_requirement&&a.jsxs("span",{className:"italic",children:["(Cast Req: ",we.casting_requirement,")"]})]})]})]},we.id))}),d&&a.jsx(Ce,{message:d}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs(V,{type:"button",variant:"secondary",onClick:()=>{p("selectStudyType"),b(null)},children:[a.jsx(Yl,{className:"w-4 h-4 mr-1"})," Back"]}),a.jsxs(V,{onClick:ps,disabled:!ce||Ie||c||ye.length===0&&!g&&!Ie,loading:c,children:["Learn Selected Spell ",a.jsx(Bi,{className:"w-4 h-4 ml-1"})]})]}),c&&a.jsxs("div",{className:"text-center text-sm text-blue-600 flex items-center justify-center gap-1",children:[a.jsx(Ta,{className:"w-4 h-4 animate-spin"})," Saving..."]})]});case"finished":return a.jsxs("div",{className:"text-center space-y-4 p-6 bg-green-50 rounded border border-green-200",children:[a.jsx(Bi,{className:"w-12 h-12 text-green-500 mx-auto"}),a.jsx("h4",{className:"text-xl font-semibold text-green-800",children:"Session Ended & Advancement Complete!"}),a.jsx("p",{className:"text-gray-700",children:"Character data has been updated. Marked skills for this session have been cleared."}),a.jsx(V,{onClick:t,children:"Done"})]});default:const BN=f;return a.jsxs("p",{children:["Unknown step: ",BN]})}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4 sticky top-0 bg-white z-10",children:[a.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx(uo,{className:"w-6 h-6 text-blue-600"}),"Character Advancement"]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600","aria-label":"Close advancement modal",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-6",children:UN()})]})})}function _I({character:e}){const{toggleDiceRoller:t}=ma(),{setDeathRollState:r,adjustStat:n,isSaving:s}=ir(),[i,l]=w.useState(!1),[o,u]=w.useState(null),c=e.death_rolls_passed??0,d=e.death_rolls_failed??0,h=e.is_rallied??!1,f=e.attributes.CON,p=e.attributes.WIL,g=c>=3,b=d>=3,E=D=>{l(!1);const T=D.results[0].value,F=D.isCritical&&D.isSuccess,O=D.isCritical&&!D.isSuccess,Q=D.isSuccess;let Y=c,H=d;F?(Y+=2,u(`Rolled ${T} (Dragon! +2 Successes)`)):O?(H+=2,u(`Rolled ${T} (Demon! +2 Failures)`)):Q?(Y+=1,u(`Rolled ${T} (Success vs CON ${f})`)):(H+=1,u(`Rolled ${T} (Failure vs CON ${f})`)),r(Y,H,h),t()},x=D=>{l(!1);const T=D.results[0].value;D.isSuccess?(r(c,d,!0),u(`Rallied! (Rolled ${T} vs WIL ${p} w/ Bane)`)):(r(c,d,!1),u(`Rally Failed (Rolled ${T} vs WIL ${p} w/ Bane)`)),t()},y=D=>{l(!1);const T=D.results[0].value;u(`Recovered ${T} HP!`),n("current_hp",T),t()},v=()=>{i||g||b||(l(!0),u(null),t({rollMode:"deathRoll",targetValue:f,description:`Death Save (d20 vs CON ${f})`,onRollComplete:E}))},N=()=>{i||h||g||b||(l(!0),u(null),t({rollMode:"rallyRoll",targetValue:p,requiresBane:!0,description:`Rally Self (d20 vs WIL ${p}, Bane)`,onRollComplete:x}))},_=()=>{i||!g||b||(l(!0),u(null),t({rollMode:"recoveryRoll",description:"Recovery Roll (1d6 HP)",onRollComplete:y}))},S=D=>{if(g||b||s)return;const T=Math.max(0,Math.min(3,c+D));r(T,d,h)},R=D=>{if(g||b||s)return;const T=Math.max(0,Math.min(3,d+D));r(c,T,h)},j=(D,T,F,O,Q,Y)=>a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(O,{className:`w-4 h-4 sm:w-5 sm:h-5 ${Q}`}),a.jsxs("span",{className:"font-medium text-xs sm:text-sm w-16 sm:w-20",children:[D,":"]}),a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{onClick:()=>Y(-1),disabled:T===0||g||b||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Decrease ${D}`,children:a.jsx(L2,{className:"w-3 h-3"})}),[...Array(F)].map((H,B)=>a.jsx("div",{className:`w-3 h-3 sm:w-4 sm:h-4 rounded-full border ${B<T?D==="Successes"?"bg-green-500 border-green-600":"bg-red-500 border-red-600":"bg-gray-200 border-gray-300"}`},B)),a.jsx("button",{onClick:()=>Y(1),disabled:T===F||g||b||s,className:"p-0.5 text-xs bg-gray-200 rounded disabled:opacity-50 hover:bg-gray-300",title:`Increase ${D}`,children:a.jsx(zt,{className:"w-3 h-3"})})]})]});return a.jsxs("div",{className:"p-3 rounded-lg shadow bg-red-50 border border-red-300 space-y-2",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm text-red-700",children:[a.jsx(yd,{className:"w-4 h-4 text-red-600 animate-pulse"}),"DYING (",e.current_hp," HP)"]}),a.jsxs("div",{className:"space-y-1",children:[j("Successes",c,3,ah,"text-green-500",S),j("Failures",d,3,ih,"text-red-500",R)]}),o&&a.jsx("p",{className:"text-xs text-center text-gray-700 italic",children:o}),h&&!g&&!b&&a.jsxs("p",{className:"text-xs text-center text-yellow-800 bg-yellow-100 p-1 rounded border border-yellow-200 flex items-center justify-center gap-1",children:[a.jsx(ls,{className:"w-3 h-3"})," Rallied! Can act, but still dying."]}),a.jsx("div",{className:"pt-1 space-y-2",children:b?a.jsx("div",{className:"text-center font-bold text-lg text-red-800 p-2 bg-red-200 rounded",children:"CHARACTER DIED"}):g?a.jsxs(V,{onClick:_,disabled:i||s,loading:i||s,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[a.jsx(P0,{className:"w-4 h-4 mr-1"})," Roll Recovery (1d6 HP)"]}):a.jsxs(a.Fragment,{children:[a.jsxs(V,{onClick:v,disabled:i||s,loading:i||s,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"sm",children:[a.jsx(yd,{className:"w-4 h-4 mr-1"})," Roll Death Save (d20)"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(V,{onClick:N,disabled:i||s||h,loading:i||s,className:`w-full text-black ${h?"bg-gray-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,size:"sm",children:[a.jsx(H2,{className:"w-4 h-4 mr-1"})," ",h?"Rallied!":"Attempt Rally (Self)"]}),!h&&a.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 p-2 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none",children:["Roll d20 vs WIL (",p,") with Bane. Success lets you act while dying.",a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-black rotate-45"})]})]})]})}),s&&a.jsx("div",{className:"text-xs text-center text-blue-600 italic mt-1",children:"Saving..."})]})}function NI(){const e=ir(r=>r.activeStatusMessage),t=ir(r=>r.clearActiveStatusMessage);return e?a.jsxs("div",{className:"my-3 p-3 bg-blue-100 border border-blue-300 rounded-lg shadow-sm flex items-center justify-between animate-fadeIn",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Pn,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsxs("p",{className:"text-sm text-blue-800",children:["Activated: ",a.jsx("span",{className:"font-semibold",children:e})]})]}),a.jsx("button",{onClick:t,className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full transition-colors","aria-label":"Dismiss status message",children:a.jsx(Lt,{className:"w-4 h-4"})})]}):null}function kI({}){var M,G,k,K,z,I,he,Ee,be;Xr();const{toggleDiceRoller:e}=ma(),{character:t,adjustStat:r,toggleCondition:n,performRest:s,updateCharacterData:i,isLoading:l,error:o,isSaving:u,saveError:c,setActiveStatusMessage:d}=ir(),[h,f]=w.useState(!1),[p,g]=w.useState(!1),[b,E]=w.useState(!1),[x,y]=w.useState(!1),[v,N]=w.useState(!1),[_,S]=w.useState(!1),[R,j]=w.useState(!1);if(l)return a.jsx("div",{className:"p-4 text-center",children:"Loading character..."});if(o)return a.jsxs("div",{className:"p-4 text-center text-red-500",children:["Error loading character: ",o]});if(!t)return a.jsx("div",{className:"p-4 text-center",children:"Character data is not available. Please select a character."});const D=Z=>{n(Z)},T=async Z=>{g(!1),await s(Z,Z==="stretch"?R:void 0),j(!1)},F=(Z,ye,te,ce)=>{var Le;const _e=ye??10,Ie=((Le=t.conditions)==null?void 0:Le[ce])??!1;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:Z}),a.jsx("span",{className:"text-xl",children:_e})]}),a.jsx("div",{className:"text-sm h-5",children:(Z==="STR"||Z==="AGL")&&_e>12&&a.jsxs("div",{className:"text-blue-400",children:["Damage Bonus: ",_e<=15?"+D4":"+D6"]})})]}),a.jsx("button",{onClick:()=>D(ce),className:`absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${Ie?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${u?"opacity-50 cursor-not-allowed":""}`,disabled:u,title:`Toggle ${ce.charAt(0).toUpperCase()+ce.slice(1)}`,children:ce.toUpperCase().substring(0,3)})]})},O=()=>p?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(iy,{className:"w-6 h-6"})," Choose Rest Type"]}),a.jsx("button",{onClick:()=>{g(!1),j(!1)},className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("shift"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(lh,{className:"w-5 h-5"}),u?"Resting...":"Take Shift Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Shift Rest (~6 hours):"})," Requires a safe location. Recovers all HP & WP, heals all standard conditions. Resets death roll state. Interruption negates effects."]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("stretch"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition-colors",disabled:u||((t==null?void 0:t.current_hp)??0)<=0,children:[a.jsx(z2,{className:"w-5 h-5"}),u?"Resting...":"Take Stretch Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Stretch Rest (~15 mins):"})," Heal ",R?"2d6":"1d6"," HP, recover 1d6 WP, heal one standard condition. Can only be done once per Shift. Cannot be taken while dying. Interruption negates effects."]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:Z=>j(Z.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:"Healer present for Stretch Rest (requires successful HEALING roll)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Check this if another character is tending to you and succeeds on a HEALING roll during a Stretch Rest."})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>T("round"),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",disabled:u,children:[a.jsx(O2,{className:"w-5 h-5"}),u?"Resting...":"Take Round Rest"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a.jsx("strong",{children:"Round Rest (~10 secs):"})," Recover 1d6 WP. No HP recovery. Can only be done once per Shift."]})]})]}),u&&a.jsx("div",{className:"mt-4 text-sm text-center text-gray-500",children:"Saving..."}),c&&a.jsxs("div",{className:"mt-4 text-sm text-center text-red-500",children:["Error: ",c]})]})}):null,Q=()=>{const Z=Array.isArray(t==null?void 0:t.trainedSkills)?t.trainedSkills:[];return(t==null?void 0:t.profession)==="Mage"||Z.some(ye=>typeof ye=="string"&&["ELEMENTALISM","ANIMISM","MENTALISM"].includes(ye.toUpperCase()))},Y=(t==null?void 0:t.current_hp)??0,H=(t==null?void 0:t.current_wp)??0,B=(t==null?void 0:t.max_hp)??((M=t==null?void 0:t.attributes)==null?void 0:M.CON)??10,A=(t==null?void 0:t.max_wp)??((G=t==null?void 0:t.attributes)==null?void 0:G.WIL)??10;return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:t.name}),a.jsxs("p",{className:"text-gray-600 text-lg",children:[t.kin||"Unknown Kin"," ",t.profession||"Unknown Profession"," - Age: ",t.age||"Unknown"]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(au,{className:"w-4 h-4"}),"Inventory"]}),a.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm transition-colors",children:[a.jsx(iy,{className:"w-4 h-4"}),"Rest"]}),a.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-black rounded-lg hover:bg-yellow-600 text-sm transition-colors",children:[a.jsx(_2,{className:"w-4 h-4"}),"Session"]})]})]}),a.jsx(NI,{}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-x-4 gap-y-6",children:[F("STR",(k=t.attributes)==null?void 0:k.STR,a.jsx(_A,{}),"exhausted"),F("CON",(K=t.attributes)==null?void 0:K.CON,a.jsx(D0,{}),"sickly"),F("AGL",(z=t.attributes)==null?void 0:z.AGL,a.jsx(NA,{}),"dazed"),F("INT",(I=t.attributes)==null?void 0:I.INT,a.jsx(T2,{}),"angry"),F("WIL",(he=t.attributes)==null?void 0:he.WIL,a.jsx(Pn,{}),"scared"),F("CHA",(Ee=t.attributes)==null?void 0:Ee.CHA,a.jsx(zA,{}),"disheartened")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start",children:[a.jsxs("div",{className:"md:col-span-6 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors",children:[a.jsx(Ou,{className:"w-4 h-4"}),"Skills"]}),Q()&&a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm transition-colors",children:[a.jsx(Hi,{className:"w-4 h-4"}),"Spells"]}),a.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm transition-colors",children:[a.jsx(B2,{className:"w-4 h-4"}),"Abilities"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 text-white rounded-lg text-sm self-start",children:[a.jsx("span",{className:"font-medium",children:"Movement:"}),a.jsxs("span",{className:"font-bold text-lg",children:[Q6(t.kin,(be=t.attributes)==null?void 0:be.AGL),"m"]})]})]}),a.jsxs("div",{className:"md:col-span-6 grid grid-cols-2 gap-4",children:[Y>0?a.jsxs("div",{className:"p-3 rounded-lg shadow bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(P0,{className:"w-4 h-4 text-red-600"}),"HP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[Y," / ",B]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_hp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:u||Y<=0,title:"Decrease HP",children:"-"}),a.jsx("button",{onClick:()=>r("current_hp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:Y>=B||u,title:"Increase HP",children:"+"})]})]}):a.jsx(_I,{character:t}),a.jsxs("div",{className:"p-3 bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-1 text-sm",children:[a.jsx(Pn,{className:"w-4 h-4 text-blue-600"}),"WP"]}),a.jsxs("span",{className:"text-sm font-medium",children:[H," / ",A]})]}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("button",{onClick:()=>r("current_wp",-1),className:"flex-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50 transition-colors",disabled:H===0||u,title:"Decrease WP",children:"-"}),a.jsx("button",{onClick:()=>r("current_wp",1),className:"flex-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 disabled:opacity-50 transition-colors",disabled:H>=A||u,title:"Increase WP",children:"+"})]})]})]})]}),a.jsx(fI,{character:t}),b&&a.jsx(tI,{onClose:()=>E(!1)}),h&&a.jsx(aI,{onClose:()=>f(!1)}),x&&a.jsx(lI,{onClose:()=>y(!1)}),v&&a.jsx(EI,{character:t,onClose:()=>N(!1)}),_&&a.jsx(xI,{onClose:()=>S(!1)}),O(),u&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50 animate-pulse",children:"Saving..."}),c&&a.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md text-sm z-50",children:["Save Error: ",c]})]})}function SI(){const{id:e}=S0(),{user:t}=Ot(),{character:r,isLoading:n,error:s,fetchCharacter:i,setCharacter:l}=ir();return w.useEffect(()=>{let o=!0;return(async()=>{if(e&&(t!=null&&t.id))try{await i(e,t.id)}catch(c){console.error("Error loading character in CharacterPage:",c)}else e?t!=null&&t.id||(console.warn("CharacterPage: User ID is missing, cannot load character."),o&&l(null)):(console.warn("CharacterPage: ID is missing, cannot load character."),o&&l(null))})(),()=>{o=!1,l(null)}},[e,t==null?void 0:t.id,i,l]),n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(ze,{size:"lg"})}):s?a.jsxs("div",{className:"p-8",children:[a.jsx(Ce,{message:s})," "]}):r?a.jsx(kI,{}):a.jsx("div",{className:"p-8",children:a.jsx(Ce,{message:"Character not found, does not exist, or you may not have permission to view it."})})}function Ry(e){const t=[],r=String(e||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const l=r.slice(s,n).trim();(l||!i)&&t.push(l),s=n+1,n=r.indexOf(",",s)}return t}function wE(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const TI=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,CI=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,jI={};function Ly(e,t){return(jI.jsx?CI:TI).test(e)}const AI=/[ \t\n\f\r]/g;function II(e){return typeof e=="object"?e.type==="text"?Oy(e.value):!1:Oy(e)}function Oy(e){return e.replace(AI,"")===""}class Du{constructor(t,r,n){this.property=t,this.normal=r,n&&(this.space=n)}}Du.prototype.property={};Du.prototype.normal={};Du.prototype.space=null;function EE(e,t){const r={},n={};let s=-1;for(;++s<e.length;)Object.assign(r,e[s].property),Object.assign(n,e[s].normal);return new Du(r,n,t)}function iu(e){return e.toLowerCase()}class Jr{constructor(t,r){this.property=t,this.attribute=r}}Jr.prototype.space=null;Jr.prototype.boolean=!1;Jr.prototype.booleanish=!1;Jr.prototype.overloadedBoolean=!1;Jr.prototype.number=!1;Jr.prototype.commaSeparated=!1;Jr.prototype.spaceSeparated=!1;Jr.prototype.commaOrSpaceSeparated=!1;Jr.prototype.mustUseProperty=!1;Jr.prototype.defined=!1;let RI=0;const Oe=li(),Tt=li(),_E=li(),oe=li(),ot=li(),qi=li(),kr=li();function li(){return 2**++RI}const sp=Object.freeze(Object.defineProperty({__proto__:null,boolean:Oe,booleanish:Tt,commaOrSpaceSeparated:kr,commaSeparated:qi,number:oe,overloadedBoolean:_E,spaceSeparated:ot},Symbol.toStringTag,{value:"Module"})),gf=Object.keys(sp);class q0 extends Jr{constructor(t,r,n,s){let i=-1;if(super(t,r),Py(this,"space",s),typeof n=="number")for(;++i<gf.length;){const l=gf[i];Py(this,gf[i],(n&sp[l])===sp[l])}}}q0.prototype.defined=!0;function Py(e,t,r){r&&(e[t]=r)}const LI={}.hasOwnProperty;function Ll(e){const t={},r={};let n;for(n in e.properties)if(LI.call(e.properties,n)){const s=e.properties[n],i=new q0(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[iu(n)]=n,r[iu(i.attribute)]=n}return new Du(t,r,e.space)}const NE=Ll({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),kE=Ll({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function SE(e,t){return t in e?e[t]:t}function TE(e,t){return SE(e,t.toLowerCase())}const CE=Ll({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:TE,properties:{xmlns:null,xmlnsXLink:null}}),jE=Ll({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Tt,ariaAutoComplete:null,ariaBusy:Tt,ariaChecked:Tt,ariaColCount:oe,ariaColIndex:oe,ariaColSpan:oe,ariaControls:ot,ariaCurrent:null,ariaDescribedBy:ot,ariaDetails:null,ariaDisabled:Tt,ariaDropEffect:ot,ariaErrorMessage:null,ariaExpanded:Tt,ariaFlowTo:ot,ariaGrabbed:Tt,ariaHasPopup:null,ariaHidden:Tt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ot,ariaLevel:oe,ariaLive:null,ariaModal:Tt,ariaMultiLine:Tt,ariaMultiSelectable:Tt,ariaOrientation:null,ariaOwns:ot,ariaPlaceholder:null,ariaPosInSet:oe,ariaPressed:Tt,ariaReadOnly:Tt,ariaRelevant:null,ariaRequired:Tt,ariaRoleDescription:ot,ariaRowCount:oe,ariaRowIndex:oe,ariaRowSpan:oe,ariaSelected:Tt,ariaSetSize:oe,ariaSort:null,ariaValueMax:oe,ariaValueMin:oe,ariaValueNow:oe,ariaValueText:null,role:null}}),OI=Ll({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:TE,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:qi,acceptCharset:ot,accessKey:ot,action:null,allow:null,allowFullScreen:Oe,allowPaymentRequest:Oe,allowUserMedia:Oe,alt:null,as:null,async:Oe,autoCapitalize:null,autoComplete:ot,autoFocus:Oe,autoPlay:Oe,blocking:ot,capture:null,charSet:null,checked:Oe,cite:null,className:ot,cols:oe,colSpan:null,content:null,contentEditable:Tt,controls:Oe,controlsList:ot,coords:oe|qi,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Oe,defer:Oe,dir:null,dirName:null,disabled:Oe,download:_E,draggable:Tt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Oe,formTarget:null,headers:ot,height:oe,hidden:Oe,high:oe,href:null,hrefLang:null,htmlFor:ot,httpEquiv:ot,id:null,imageSizes:null,imageSrcSet:null,inert:Oe,inputMode:null,integrity:null,is:null,isMap:Oe,itemId:null,itemProp:ot,itemRef:ot,itemScope:Oe,itemType:ot,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Oe,low:oe,manifest:null,max:null,maxLength:oe,media:null,method:null,min:null,minLength:oe,multiple:Oe,muted:Oe,name:null,nonce:null,noModule:Oe,noValidate:Oe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Oe,optimum:oe,pattern:null,ping:ot,placeholder:null,playsInline:Oe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Oe,referrerPolicy:null,rel:ot,required:Oe,reversed:Oe,rows:oe,rowSpan:oe,sandbox:ot,scope:null,scoped:Oe,seamless:Oe,selected:Oe,shadowRootClonable:Oe,shadowRootDelegatesFocus:Oe,shadowRootMode:null,shape:null,size:oe,sizes:null,slot:null,span:oe,spellCheck:Tt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:oe,step:null,style:null,tabIndex:oe,target:null,title:null,translate:null,type:null,typeMustMatch:Oe,useMap:null,value:Tt,width:oe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ot,axis:null,background:null,bgColor:null,border:oe,borderColor:null,bottomMargin:oe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Oe,declare:Oe,event:null,face:null,frame:null,frameBorder:null,hSpace:oe,leftMargin:oe,link:null,longDesc:null,lowSrc:null,marginHeight:oe,marginWidth:oe,noResize:Oe,noHref:Oe,noShade:Oe,noWrap:Oe,object:null,profile:null,prompt:null,rev:null,rightMargin:oe,rules:null,scheme:null,scrolling:Tt,standby:null,summary:null,text:null,topMargin:oe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:oe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Oe,disableRemotePlayback:Oe,prefix:null,property:null,results:oe,security:null,unselectable:null}}),PI=Ll({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:SE,properties:{about:kr,accentHeight:oe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:oe,amplitude:oe,arabicForm:null,ascent:oe,attributeName:null,attributeType:null,azimuth:oe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:oe,by:null,calcMode:null,capHeight:oe,className:ot,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:oe,diffuseConstant:oe,direction:null,display:null,dur:null,divisor:oe,dominantBaseline:null,download:Oe,dx:null,dy:null,edgeMode:null,editable:null,elevation:oe,enableBackground:null,end:null,event:null,exponent:oe,externalResourcesRequired:null,fill:null,fillOpacity:oe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:qi,g2:qi,glyphName:qi,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:oe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:oe,horizOriginX:oe,horizOriginY:oe,id:null,ideographic:oe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:oe,k:oe,k1:oe,k2:oe,k3:oe,k4:oe,kernelMatrix:kr,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:oe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:oe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:oe,overlineThickness:oe,paintOrder:null,panose1:null,path:null,pathLength:oe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ot,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:oe,pointsAtY:oe,pointsAtZ:oe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:kr,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:kr,rev:kr,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:kr,requiredFeatures:kr,requiredFonts:kr,requiredFormats:kr,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:oe,specularExponent:oe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:oe,strikethroughThickness:oe,string:null,stroke:null,strokeDashArray:kr,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:oe,strokeOpacity:oe,strokeWidth:null,style:null,surfaceScale:oe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:kr,tabIndex:oe,tableValues:null,target:null,targetX:oe,targetY:oe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:kr,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:oe,underlineThickness:oe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:oe,values:null,vAlphabetic:oe,vMathematical:oe,vectorEffect:null,vHanging:oe,vIdeographic:oe,version:null,vertAdvY:oe,vertOriginX:oe,vertOriginY:oe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:oe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),DI=/^data[-\w.:]+$/i,Dy=/-[a-z]/g,MI=/[A-Z]/g;function ch(e,t){const r=iu(t);let n=t,s=Jr;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&DI.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(Dy,UI);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!Dy.test(i)){let l=i.replace(MI,FI);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}s=q0}return new s(n,t)}function FI(e){return"-"+e.toLowerCase()}function UI(e){return e.charAt(1).toUpperCase()}const BI={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Mu=EE([kE,NE,CE,jE,OI],"html"),pa=EE([kE,NE,CE,jE,PI],"svg");function My(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function AE(e){return e.join(" ").trim()}var IE={},Fy=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,HI=/\n/g,$I=/^\s*/,zI=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,qI=/^:\s*/,VI=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,WI=/^[;\s]*/,GI=/^\s+|\s+$/g,YI=`
`,Uy="/",By="*",Ca="",QI="comment",KI="declaration",ZI=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(g){var b=g.match(HI);b&&(r+=b.length);var E=g.lastIndexOf(YI);n=~E?g.length-E:n+g.length}function i(){var g={line:r,column:n};return function(b){return b.position=new l(g),c(),b}}function l(g){this.start=g,this.end={line:r,column:n},this.source=t.source}l.prototype.content=e;function o(g){var b=new Error(t.source+":"+r+":"+n+": "+g);if(b.reason=g,b.filename=t.source,b.line=r,b.column=n,b.source=e,!t.silent)throw b}function u(g){var b=g.exec(e);if(b){var E=b[0];return s(E),e=e.slice(E.length),b}}function c(){u($I)}function d(g){var b;for(g=g||[];b=h();)b!==!1&&g.push(b);return g}function h(){var g=i();if(!(Uy!=e.charAt(0)||By!=e.charAt(1))){for(var b=2;Ca!=e.charAt(b)&&(By!=e.charAt(b)||Uy!=e.charAt(b+1));)++b;if(b+=2,Ca===e.charAt(b-1))return o("End of comment missing");var E=e.slice(2,b-2);return n+=2,s(E),e=e.slice(b),n+=2,g({type:QI,comment:E})}}function f(){var g=i(),b=u(zI);if(b){if(h(),!u(qI))return o("property missing ':'");var E=u(VI),x=g({type:KI,property:Hy(b[0].replace(Fy,Ca)),value:E?Hy(E[0].replace(Fy,Ca)):Ca});return u(WI),x}}function p(){var g=[];d(g);for(var b;b=f();)b!==!1&&(g.push(b),d(g));return g}return c(),p()};function Hy(e){return e?e.replace(GI,Ca):Ca}var XI=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(IE,"__esModule",{value:!0});var $y=IE.default=e5,JI=XI(ZI);function e5(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,JI.default)(e),s=typeof t=="function";return n.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;s?t(l,o,i):o&&(r=r||{},r[l]=o)}}),r}const t5=$y.default||$y,dh=RE("end"),Fn=RE("start");function RE(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function LE(e){const t=Fn(e),r=dh(e);if(t&&r)return{start:t,end:r}}function jo(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?zy(e.position):"start"in e||"end"in e?zy(e):"line"in e||"column"in e?ap(e):""}function ap(e){return qy(e&&e.line)+":"+qy(e&&e.column)}function zy(e){return ap(e&&e.start)+"-"+ap(e&&e.end)}function qy(e){return e&&typeof e=="number"?e:1}class Xt extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},l=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof t=="string"?s=t:!i.cause&&t&&(l=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=o?o.line:void 0,this.name=jo(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}Xt.prototype.file="";Xt.prototype.name="";Xt.prototype.reason="";Xt.prototype.message="";Xt.prototype.stack="";Xt.prototype.column=void 0;Xt.prototype.line=void 0;Xt.prototype.ancestors=void 0;Xt.prototype.cause=void 0;Xt.prototype.fatal=void 0;Xt.prototype.place=void 0;Xt.prototype.ruleId=void 0;Xt.prototype.source=void 0;const V0={}.hasOwnProperty,r5=new Map,n5=/[A-Z]/g,s5=/-([a-z])/g,a5=new Set(["table","tbody","thead","tfoot","tr"]),i5=new Set(["td","th"]),OE="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function l5(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=p5(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=m5(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?pa:Mu,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=PE(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function PE(e,t,r){if(t.type==="element")return o5(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return u5(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return d5(e,t,r);if(t.type==="mdxjsEsm")return c5(e,t);if(t.type==="root")return h5(e,t,r);if(t.type==="text")return f5(e,t)}function o5(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=pa,e.schema=s),e.ancestors.push(t);const i=ME(e,t.tagName,!1),l=g5(e,t);let o=G0(e,t);return a5.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!II(u):!0})),DE(e,l,i,t),W0(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function u5(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}lu(e,t.position)}function c5(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);lu(e,t.position)}function d5(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=pa,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:ME(e,t.name,!0),l=x5(e,t),o=G0(e,t);return DE(e,l,i,t),W0(l,o),e.ancestors.pop(),e.schema=n,e.create(t,i,l,r)}function h5(e,t,r){const n={};return W0(n,G0(e,t)),e.create(t,e.Fragment,n,r)}function f5(e,t){return t.value}function DE(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function W0(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function m5(e,t,r){return n;function n(s,i,l,o){const c=Array.isArray(l.children)?r:t;return o?c(i,l,o):c(i,l)}}function p5(e,t){return r;function r(n,s,i,l){const o=Array.isArray(i.children),u=Fn(n);return t(s,i,l,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function g5(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&V0.call(t.properties,s)){const i=y5(e,s,t.properties[s]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&i5.has(t.tagName)?n=o:r[l]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function x5(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else lu(e,t.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else lu(e,t.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function G0(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:r5;for(;++n<t.children.length;){const i=t.children[n];let l;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const c=s.get(u)||0;l=u+"-"+c,s.set(u,c+1)}}const o=PE(e,i,l);o!==void 0&&r.push(o)}return r}function y5(e,t,r){const n=ch(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?wE(r):AE(r)),n.property==="style"){let s=typeof r=="object"?r:b5(e,String(r));return e.stylePropertyNameCase==="css"&&(s=v5(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?BI[n.property]||n.property:n.attribute,r]}}function b5(e,t){const r={};try{t5(t,n)}catch(s){if(!e.ignoreInvalidStyle){const i=s,l=new Xt("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=OE+"#cannot-parse-style-attribute",l}}return r;function n(s,i){let l=s;l.slice(0,2)!=="--"&&(l.slice(0,4)==="-ms-"&&(l="ms-"+l.slice(4)),l=l.replace(s5,E5)),r[l]=i}}function ME(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,l;for(;++i<s.length;){const o=Ly(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}n=l}else n=Ly(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return V0.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);lu(e)}function lu(e,t){const r=new Xt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=OE+"#cannot-handle-mdx-estrees-without-createevaluater",r}function v5(e){const t={};let r;for(r in e)V0.call(e,r)&&(t[w5(r)]=e[r]);return t}function w5(e){let t=e.replace(n5,_5);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function E5(e,t){return t.toUpperCase()}function _5(e){return"-"+e.toLowerCase()}const xf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},N5={};function Y0(e,t){const r=N5,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return FE(e,n,s)}function FE(e,t,r){if(k5(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Vy(e.children,t,r)}return Array.isArray(e)?Vy(e,t,r):""}function Vy(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=FE(e[s],t,r);return n.join("")}function k5(e){return!!(e&&typeof e=="object")}const Wy=document.createElement("i");function Q0(e){const t="&"+e+";";Wy.innerHTML=t;const r=Wy.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Rr(e,t,r,n){const s=e.length;let i=0,l;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)l=Array.from(n),l.unshift(t,r),e.splice(...l);else for(r&&e.splice(t,r);i<n.length;)l=n.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function zr(e,t){return e.length>0?(Rr(e,e.length,0,t),e):t}const Gy={}.hasOwnProperty;function UE(e){const t={};let r=-1;for(;++r<e.length;)S5(t,e[r]);return t}function S5(e,t){let r;for(r in t){const s=(Gy.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let l;if(i)for(l in i){Gy.call(s,l)||(s[l]=[]);const o=i[l];T5(s[l],Array.isArray(o)?o:o?[o]:[])}}}function T5(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Rr(e,0,0,n)}function BE(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function mn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const sr=ga(/[A-Za-z]/),Qt=ga(/[\dA-Za-z]/),C5=ga(/[#-'*+\--9=?A-Z^-~]/);function wd(e){return e!==null&&(e<32||e===127)}const ip=ga(/\d/),j5=ga(/[\dA-Fa-f]/),A5=ga(/[!-/:-@[-`{-~]/);function Se(e){return e!==null&&e<-2}function st(e){return e!==null&&(e<0||e===32)}function qe(e){return e===-2||e===-1||e===32}const hh=ga(new RegExp("\\p{P}|\\p{S}","u")),Ja=ga(/\s/);function ga(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Ol(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const i=e.charCodeAt(r);let l="";if(i===37&&Qt(e.charCodeAt(r+1))&&Qt(e.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),s=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(n,r),encodeURIComponent(l)),n=r+s+1,l=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function Ze(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(u){return qe(u)?(e.enter(r),o(u)):t(u)}function o(u){return qe(u)&&i++<s?(e.consume(u),o):(e.exit(r),t(u))}}const I5={tokenize:R5};function R5(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Ze(e,t,"linePrefix")}function s(o){return e.enter("paragraph"),i(o)}function i(o){const u=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=u),r=u,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Se(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const L5={tokenize:O5},Yy={tokenize:P5};function O5(e){const t=this,r=[];let n=0,s,i,l;return o;function o(v){if(n<r.length){const N=r[n];return t.containerState=N[1],e.attempt(N[0].continuation,u,c)(v)}return c(v)}function u(v){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&y();const N=t.events.length;let _=N,S;for(;_--;)if(t.events[_][0]==="exit"&&t.events[_][1].type==="chunkFlow"){S=t.events[_][1].end;break}x(n);let R=N;for(;R<t.events.length;)t.events[R][1].end={...S},R++;return Rr(t.events,_+1,0,t.events.slice(N)),t.events.length=R,c(v)}return o(v)}function c(v){if(n===r.length){if(!s)return f(v);if(s.currentConstruct&&s.currentConstruct.concrete)return g(v);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Yy,d,h)(v)}function d(v){return s&&y(),x(n),f(v)}function h(v){return t.parser.lazy[t.now().line]=n!==r.length,l=t.now().offset,g(v)}function f(v){return t.containerState={},e.attempt(Yy,p,g)(v)}function p(v){return n++,r.push([t.currentConstruct,t.containerState]),f(v)}function g(v){if(v===null){s&&y(),x(0),e.consume(v);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),b(v)}function b(v){if(v===null){E(e.exit("chunkFlow"),!0),x(0),e.consume(v);return}return Se(v)?(e.consume(v),E(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(v),b)}function E(v,N){const _=t.sliceStream(v);if(N&&_.push(null),v.previous=i,i&&(i.next=v),i=v,s.defineSkip(v.start),s.write(_),t.parser.lazy[v.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<l&&(!s.events[S][1].end||s.events[S][1].end.offset>l))return;const R=t.events.length;let j=R,D,T;for(;j--;)if(t.events[j][0]==="exit"&&t.events[j][1].type==="chunkFlow"){if(D){T=t.events[j][1].end;break}D=!0}for(x(n),S=R;S<t.events.length;)t.events[S][1].end={...T},S++;Rr(t.events,j+1,0,t.events.slice(R)),t.events.length=S}}function x(v){let N=r.length;for(;N-- >v;){const _=r[N];t.containerState=_[1],_[0].exit.call(t,e)}r.length=v}function y(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function P5(e,t,r){return Ze(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function xl(e){if(e===null||st(e)||Ja(e))return 1;if(hh(e))return 2}function fh(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const lp={name:"attention",resolveAll:D5,tokenize:M5};function D5(e,t){let r=-1,n,s,i,l,o,u,c,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h={...e[n][1].end},f={...e[r][1].start};Qy(h,-u),Qy(f,u),l={type:u>1?"strongSequence":"emphasisSequence",start:h,end:{...e[n][1].end}},o={type:u>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},i={type:u>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:u>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[n][1].end={...l.start},e[r][1].start={...o.end},c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=zr(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=zr(c,[["enter",s,t],["enter",l,t],["exit",l,t],["enter",i,t]]),c=zr(c,fh(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=zr(c,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,c=zr(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,Rr(e,n-1,r-n+3,c),r=n+c.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function M5(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=xl(n);let i;return l;function l(u){return i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const c=e.exit("attentionSequence"),d=xl(u),h=!d||d===2&&s||r.includes(u),f=!s||s===2&&d||r.includes(n);return c._open=!!(i===42?h:h&&(s||!f)),c._close=!!(i===42?f:f&&(d||!h)),t(u)}}function Qy(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const F5={name:"autolink",tokenize:U5};function U5(e,t,r){let n=0;return s;function s(p){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(p){return sr(p)?(e.consume(p),l):p===64?r(p):c(p)}function l(p){return p===43||p===45||p===46||Qt(p)?(n=1,o(p)):c(p)}function o(p){return p===58?(e.consume(p),n=0,u):(p===43||p===45||p===46||Qt(p))&&n++<32?(e.consume(p),o):(n=0,c(p))}function u(p){return p===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):p===null||p===32||p===60||wd(p)?r(p):(e.consume(p),u)}function c(p){return p===64?(e.consume(p),d):C5(p)?(e.consume(p),c):r(p)}function d(p){return Qt(p)?h(p):r(p)}function h(p){return p===46?(e.consume(p),n=0,d):p===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):f(p)}function f(p){if((p===45||Qt(p))&&n++<63){const g=p===45?f:h;return e.consume(p),g}return r(p)}}const Fu={partial:!0,tokenize:B5};function B5(e,t,r){return n;function n(i){return qe(i)?Ze(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||Se(i)?t(i):r(i)}}const HE={continuation:{tokenize:$5},exit:z5,name:"blockQuote",tokenize:H5};function H5(e,t,r){const n=this;return s;function s(l){if(l===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return r(l)}function i(l){return qe(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function $5(e,t,r){const n=this;return s;function s(l){return qe(l)?Ze(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(HE,t,r)(l)}}function z5(e){e.exit("blockQuote")}const $E={name:"characterEscape",tokenize:q5};function q5(e,t,r){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return A5(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(i)}}const zE={name:"characterReference",tokenize:V5};function V5(e,t,r){const n=this;let s=0,i,l;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),u}function u(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,l=Qt,d(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=j5,d):(e.enter("characterReferenceValue"),i=7,l=ip,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return l===Qt&&!Q0(n.sliceSerialize(f))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(h)&&s++<i?(e.consume(h),d):r(h)}}const Ky={partial:!0,tokenize:G5},Zy={concrete:!0,name:"codeFenced",tokenize:W5};function W5(e,t,r){const n=this,s={partial:!0,tokenize:_};let i=0,l=0,o;return u;function u(S){return c(S)}function c(S){const R=n.events[n.events.length-1];return i=R&&R[1].type==="linePrefix"?R[2].sliceSerialize(R[1],!0).length:0,o=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===o?(l++,e.consume(S),d):l<3?r(S):(e.exit("codeFencedFenceSequence"),qe(S)?Ze(e,h,"whitespace")(S):h(S))}function h(S){return S===null||Se(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(Ky,b,N)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||Se(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(S)):qe(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Ze(e,p,"whitespace")(S)):S===96&&S===o?r(S):(e.consume(S),f)}function p(S){return S===null||Se(S)?h(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(S))}function g(S){return S===null||Se(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(S)):S===96&&S===o?r(S):(e.consume(S),g)}function b(S){return e.attempt(s,N,E)(S)}function E(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&qe(S)?Ze(e,y,"linePrefix",i+1)(S):y(S)}function y(S){return S===null||Se(S)?e.check(Ky,b,N)(S):(e.enter("codeFlowValue"),v(S))}function v(S){return S===null||Se(S)?(e.exit("codeFlowValue"),y(S)):(e.consume(S),v)}function N(S){return e.exit("codeFenced"),t(S)}function _(S,R,j){let D=0;return T;function T(H){return S.enter("lineEnding"),S.consume(H),S.exit("lineEnding"),F}function F(H){return S.enter("codeFencedFence"),qe(H)?Ze(S,O,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(H):O(H)}function O(H){return H===o?(S.enter("codeFencedFenceSequence"),Q(H)):j(H)}function Q(H){return H===o?(D++,S.consume(H),Q):D>=l?(S.exit("codeFencedFenceSequence"),qe(H)?Ze(S,Y,"whitespace")(H):Y(H)):j(H)}function Y(H){return H===null||Se(H)?(S.exit("codeFencedFence"),R(H)):j(H)}}}function G5(e,t,r){const n=this;return s;function s(l){return l===null?r(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}const yf={name:"codeIndented",tokenize:Q5},Y5={partial:!0,tokenize:K5};function Q5(e,t,r){const n=this;return s;function s(c){return e.enter("codeIndented"),Ze(e,i,"linePrefix",5)(c)}function i(c){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?l(c):r(c)}function l(c){return c===null?u(c):Se(c)?e.attempt(Y5,l,u)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||Se(c)?(e.exit("codeFlowValue"),l(c)):(e.consume(c),o)}function u(c){return e.exit("codeIndented"),t(c)}}function K5(e,t,r){const n=this;return s;function s(l){return n.parser.lazy[n.now().line]?r(l):Se(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):Ze(e,i,"linePrefix",5)(l)}function i(l){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):Se(l)?s(l):r(l)}}const Z5={name:"codeText",previous:J5,resolve:X5,tokenize:eR};function X5(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function J5(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function eR(e,t,r){let n=0,s,i;return l;function l(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),u(h))}function u(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),u):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):Se(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Se(h)?(e.exit("codeTextData"),u(h)):(e.consume(h),c)}function d(h){return h===96?(e.consume(h),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",c(h))}}class tR{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&Jl(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Jl(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Jl(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);Jl(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Jl(this.left,r.reverse())}}}function Jl(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function qE(e){const t={};let r=-1,n,s,i,l,o,u,c;const d=new tR(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,rR(d,r)),r=t[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--;)if(l=d.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),l[1].type="lineEnding",s=i);else if(l[1].type!=="linePrefix")break;s&&(n[1].end={...d.get(s)[1].start},o=d.slice(s,r),o.unshift(n),d.splice(s,r-s+1,o))}}return Rr(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function rR(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const i=[],l=r._tokenizer||n.parser[r.contentType](r.start),o=l.events,u=[],c={};let d,h,f=-1,p=r,g=0,b=0;const E=[b];for(;p;){for(;e.get(++s)[1]!==p;);i.push(s),p._tokenizer||(d=n.sliceStream(p),p.next||d.push(null),h&&l.defineSkip(p.start),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(d),p._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),h=p,p=p.next}for(p=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(b=f+1,E.push(b),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(l.events=[],p?(p._tokenizer=void 0,p.previous=void 0):E.pop(),f=E.length;f--;){const x=o.slice(E[f],E[f+1]),y=i.pop();u.push([y,y+x.length-1]),e.splice(y,2,x)}for(u.reverse(),f=-1;++f<u.length;)c[g+u[f][0]]=g+u[f][1],g+=u[f][1]-u[f][0]-1;return c}const nR={resolve:aR,tokenize:iR},sR={partial:!0,tokenize:lR};function aR(e){return qE(e),e}function iR(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(o)}function s(o){return o===null?i(o):Se(o)?e.check(sR,l,i)(o):(e.consume(o),s)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function lR(e,t,r){const n=this;return s;function s(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Ze(e,i,"linePrefix")}function i(l){if(l===null||Se(l))return r(l);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(n.parser.constructs.flow,r,t)(l)}}function VE(e,t,r,n,s,i,l,o,u){const c=u||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(n),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||wd(x)?r(x):(e.enter(n),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),b(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),p(x))}function p(x){return x===62?(e.exit("chunkString"),e.exit(o),f(x)):x===null||x===60||Se(x)?r(x):(e.consume(x),x===92?g:p)}function g(x){return x===60||x===62||x===92?(e.consume(x),p):p(x)}function b(x){return!d&&(x===null||x===41||st(x))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(n),t(x)):d<c&&x===40?(e.consume(x),d++,b):x===41?(e.consume(x),d--,b):x===null||x===32||x===40||wd(x)?r(x):(e.consume(x),x===92?E:b)}function E(x){return x===40||x===41||x===92?(e.consume(x),b):b(x)}}function WE(e,t,r,n,s,i){const l=this;let o=0,u;return c;function c(p){return e.enter(n),e.enter(s),e.consume(p),e.exit(s),e.enter(i),d}function d(p){return o>999||p===null||p===91||p===93&&!u||p===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?r(p):p===93?(e.exit(i),e.enter(s),e.consume(p),e.exit(s),e.exit(n),t):Se(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(p))}function h(p){return p===null||p===91||p===93||Se(p)||o++>999?(e.exit("chunkString"),d(p)):(e.consume(p),u||(u=!qe(p)),p===92?f:h)}function f(p){return p===91||p===92||p===93?(e.consume(p),o++,h):h(p)}}function GE(e,t,r,n,s,i){let l;return o;function o(f){return f===34||f===39||f===40?(e.enter(n),e.enter(s),e.consume(f),e.exit(s),l=f===40?41:f,u):r(f)}function u(f){return f===l?(e.enter(s),e.consume(f),e.exit(s),e.exit(n),t):(e.enter(i),c(f))}function c(f){return f===l?(e.exit(i),u(l)):f===null?r(f):Se(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Ze(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===l||f===null||Se(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?h:d)}function h(f){return f===l||f===92?(e.consume(f),d):d(f)}}function Ao(e,t){let r;return n;function n(s){return Se(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):qe(s)?Ze(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const oR={name:"definition",tokenize:cR},uR={partial:!0,tokenize:dR};function cR(e,t,r){const n=this;let s;return i;function i(p){return e.enter("definition"),l(p)}function l(p){return WE.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function o(p){return s=mn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),u):r(p)}function u(p){return st(p)?Ao(e,c)(p):c(p)}function c(p){return VE(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function d(p){return e.attempt(uR,h,h)(p)}function h(p){return qe(p)?Ze(e,f,"whitespace")(p):f(p)}function f(p){return p===null||Se(p)?(e.exit("definition"),n.parser.defined.push(s),t(p)):r(p)}}function dR(e,t,r){return n;function n(o){return st(o)?Ao(e,s)(o):r(o)}function s(o){return GE(e,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return qe(o)?Ze(e,l,"whitespace")(o):l(o)}function l(o){return o===null||Se(o)?t(o):r(o)}}const hR={name:"hardBreakEscape",tokenize:fR};function fR(e,t,r){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return Se(i)?(e.exit("hardBreakEscape"),t(i)):r(i)}}const mR={name:"headingAtx",resolve:pR,tokenize:gR};function pR(e,t){let r=e.length-2,n=3,s,i;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},i={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Rr(e,n,r-n+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function gR(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),l(d)}function l(d){return d===35&&n++<6?(e.consume(d),l):d===null||st(d)?(e.exit("atxHeadingSequence"),o(d)):r(d)}function o(d){return d===35?(e.enter("atxHeadingSequence"),u(d)):d===null||Se(d)?(e.exit("atxHeading"),t(d)):qe(d)?Ze(e,o,"whitespace")(d):(e.enter("atxHeadingText"),c(d))}function u(d){return d===35?(e.consume(d),u):(e.exit("atxHeadingSequence"),o(d))}function c(d){return d===null||d===35||st(d)?(e.exit("atxHeadingText"),o(d)):(e.consume(d),c)}}const xR=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Xy=["pre","script","style","textarea"],yR={concrete:!0,name:"htmlFlow",resolveTo:wR,tokenize:ER},bR={partial:!0,tokenize:NR},vR={partial:!0,tokenize:_R};function wR(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function ER(e,t,r){const n=this;let s,i,l,o,u;return c;function c(I){return d(I)}function d(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),h}function h(I){return I===33?(e.consume(I),f):I===47?(e.consume(I),i=!0,b):I===63?(e.consume(I),s=3,n.interrupt?t:k):sr(I)?(e.consume(I),l=String.fromCharCode(I),E):r(I)}function f(I){return I===45?(e.consume(I),s=2,p):I===91?(e.consume(I),s=5,o=0,g):sr(I)?(e.consume(I),s=4,n.interrupt?t:k):r(I)}function p(I){return I===45?(e.consume(I),n.interrupt?t:k):r(I)}function g(I){const he="CDATA[";return I===he.charCodeAt(o++)?(e.consume(I),o===he.length?n.interrupt?t:O:g):r(I)}function b(I){return sr(I)?(e.consume(I),l=String.fromCharCode(I),E):r(I)}function E(I){if(I===null||I===47||I===62||st(I)){const he=I===47,Ee=l.toLowerCase();return!he&&!i&&Xy.includes(Ee)?(s=1,n.interrupt?t(I):O(I)):xR.includes(l.toLowerCase())?(s=6,he?(e.consume(I),x):n.interrupt?t(I):O(I)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(I):i?y(I):v(I))}return I===45||Qt(I)?(e.consume(I),l+=String.fromCharCode(I),E):r(I)}function x(I){return I===62?(e.consume(I),n.interrupt?t:O):r(I)}function y(I){return qe(I)?(e.consume(I),y):T(I)}function v(I){return I===47?(e.consume(I),T):I===58||I===95||sr(I)?(e.consume(I),N):qe(I)?(e.consume(I),v):T(I)}function N(I){return I===45||I===46||I===58||I===95||Qt(I)?(e.consume(I),N):_(I)}function _(I){return I===61?(e.consume(I),S):qe(I)?(e.consume(I),_):v(I)}function S(I){return I===null||I===60||I===61||I===62||I===96?r(I):I===34||I===39?(e.consume(I),u=I,R):qe(I)?(e.consume(I),S):j(I)}function R(I){return I===u?(e.consume(I),u=null,D):I===null||Se(I)?r(I):(e.consume(I),R)}function j(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||st(I)?_(I):(e.consume(I),j)}function D(I){return I===47||I===62||qe(I)?v(I):r(I)}function T(I){return I===62?(e.consume(I),F):r(I)}function F(I){return I===null||Se(I)?O(I):qe(I)?(e.consume(I),F):r(I)}function O(I){return I===45&&s===2?(e.consume(I),B):I===60&&s===1?(e.consume(I),A):I===62&&s===4?(e.consume(I),K):I===63&&s===3?(e.consume(I),k):I===93&&s===5?(e.consume(I),G):Se(I)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(bR,z,Q)(I)):I===null||Se(I)?(e.exit("htmlFlowData"),Q(I)):(e.consume(I),O)}function Q(I){return e.check(vR,Y,z)(I)}function Y(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),H}function H(I){return I===null||Se(I)?Q(I):(e.enter("htmlFlowData"),O(I))}function B(I){return I===45?(e.consume(I),k):O(I)}function A(I){return I===47?(e.consume(I),l="",M):O(I)}function M(I){if(I===62){const he=l.toLowerCase();return Xy.includes(he)?(e.consume(I),K):O(I)}return sr(I)&&l.length<8?(e.consume(I),l+=String.fromCharCode(I),M):O(I)}function G(I){return I===93?(e.consume(I),k):O(I)}function k(I){return I===62?(e.consume(I),K):I===45&&s===2?(e.consume(I),k):O(I)}function K(I){return I===null||Se(I)?(e.exit("htmlFlowData"),z(I)):(e.consume(I),K)}function z(I){return e.exit("htmlFlow"),t(I)}}function _R(e,t,r){const n=this;return s;function s(l){return Se(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):r(l)}function i(l){return n.parser.lazy[n.now().line]?r(l):t(l)}}function NR(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(Fu,t,r)}}const kR={name:"htmlText",tokenize:SR};function SR(e,t,r){const n=this;let s,i,l;return o;function o(k){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(k),u}function u(k){return k===33?(e.consume(k),c):k===47?(e.consume(k),_):k===63?(e.consume(k),v):sr(k)?(e.consume(k),j):r(k)}function c(k){return k===45?(e.consume(k),d):k===91?(e.consume(k),i=0,g):sr(k)?(e.consume(k),y):r(k)}function d(k){return k===45?(e.consume(k),p):r(k)}function h(k){return k===null?r(k):k===45?(e.consume(k),f):Se(k)?(l=h,A(k)):(e.consume(k),h)}function f(k){return k===45?(e.consume(k),p):h(k)}function p(k){return k===62?B(k):k===45?f(k):h(k)}function g(k){const K="CDATA[";return k===K.charCodeAt(i++)?(e.consume(k),i===K.length?b:g):r(k)}function b(k){return k===null?r(k):k===93?(e.consume(k),E):Se(k)?(l=b,A(k)):(e.consume(k),b)}function E(k){return k===93?(e.consume(k),x):b(k)}function x(k){return k===62?B(k):k===93?(e.consume(k),x):b(k)}function y(k){return k===null||k===62?B(k):Se(k)?(l=y,A(k)):(e.consume(k),y)}function v(k){return k===null?r(k):k===63?(e.consume(k),N):Se(k)?(l=v,A(k)):(e.consume(k),v)}function N(k){return k===62?B(k):v(k)}function _(k){return sr(k)?(e.consume(k),S):r(k)}function S(k){return k===45||Qt(k)?(e.consume(k),S):R(k)}function R(k){return Se(k)?(l=R,A(k)):qe(k)?(e.consume(k),R):B(k)}function j(k){return k===45||Qt(k)?(e.consume(k),j):k===47||k===62||st(k)?D(k):r(k)}function D(k){return k===47?(e.consume(k),B):k===58||k===95||sr(k)?(e.consume(k),T):Se(k)?(l=D,A(k)):qe(k)?(e.consume(k),D):B(k)}function T(k){return k===45||k===46||k===58||k===95||Qt(k)?(e.consume(k),T):F(k)}function F(k){return k===61?(e.consume(k),O):Se(k)?(l=F,A(k)):qe(k)?(e.consume(k),F):D(k)}function O(k){return k===null||k===60||k===61||k===62||k===96?r(k):k===34||k===39?(e.consume(k),s=k,Q):Se(k)?(l=O,A(k)):qe(k)?(e.consume(k),O):(e.consume(k),Y)}function Q(k){return k===s?(e.consume(k),s=void 0,H):k===null?r(k):Se(k)?(l=Q,A(k)):(e.consume(k),Q)}function Y(k){return k===null||k===34||k===39||k===60||k===61||k===96?r(k):k===47||k===62||st(k)?D(k):(e.consume(k),Y)}function H(k){return k===47||k===62||st(k)?D(k):r(k)}function B(k){return k===62?(e.consume(k),e.exit("htmlTextData"),e.exit("htmlText"),t):r(k)}function A(k){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),M}function M(k){return qe(k)?Ze(e,G,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(k):G(k)}function G(k){return e.enter("htmlTextData"),l(k)}}const K0={name:"labelEnd",resolveAll:AR,resolveTo:IR,tokenize:RR},TR={tokenize:LR},CR={tokenize:OR},jR={tokenize:PR};function AR(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&Rr(e,0,e.length,r),e}function IR(e,t){let r=e.length,n=0,s,i,l,o;for(;r--;)if(s=e[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(l){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(l=r);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},d={type:"labelText",start:{...e[i+n+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",u,t],["enter",c,t]],o=zr(o,e.slice(i+1,i+n+3)),o=zr(o,[["enter",d,t]]),o=zr(o,fh(t.parser.constructs.insideSpan.null,e.slice(i+n+4,l-3),t)),o=zr(o,[["exit",d,t],e[l-2],e[l-1],["exit",c,t]]),o=zr(o,e.slice(l+1)),o=zr(o,[["exit",u,t]]),Rr(e,i,e.length,o),e}function RR(e,t,r){const n=this;let s=n.events.length,i,l;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return o;function o(f){return i?i._inactive?h(f):(l=n.parser.defined.includes(mn(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),u):r(f)}function u(f){return f===40?e.attempt(TR,d,l?d:h)(f):f===91?e.attempt(CR,d,l?c:h)(f):l?d(f):h(f)}function c(f){return e.attempt(jR,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,r(f)}}function LR(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return st(h)?Ao(e,i)(h):i(h)}function i(h){return h===41?d(h):VE(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function l(h){return st(h)?Ao(e,u)(h):d(h)}function o(h){return r(h)}function u(h){return h===34||h===39||h===40?GE(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function c(h){return st(h)?Ao(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function OR(e,t,r){const n=this;return s;function s(o){return WE.call(n,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return n.parser.defined.includes(mn(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function l(o){return r(o)}}function PR(e,t,r){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):r(i)}}const DR={name:"labelStartImage",resolveAll:K0.resolveAll,tokenize:MR};function MR(e,t,r){const n=this;return s;function s(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):r(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const FR={name:"labelStartLink",resolveAll:K0.resolveAll,tokenize:UR};function UR(e,t,r){const n=this;return s;function s(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const bf={name:"lineEnding",tokenize:BR};function BR(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Ze(e,t,"linePrefix")}}const Uc={name:"thematicBreak",tokenize:HR};function HR(e,t,r){let n=0,s;return i;function i(c){return e.enter("thematicBreak"),l(c)}function l(c){return s=c,o(c)}function o(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):n>=3&&(c===null||Se(c))?(e.exit("thematicBreak"),t(c)):r(c)}function u(c){return c===s?(e.consume(c),n++,u):(e.exit("thematicBreakSequence"),qe(c)?Ze(e,o,"whitespace")(c):o(c))}}const mr={continuation:{tokenize:VR},exit:GR,name:"list",tokenize:qR},$R={partial:!0,tokenize:YR},zR={partial:!0,tokenize:WR};function qR(e,t,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,l=0;return o;function o(p){const g=n.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!n.containerState.marker||p===n.containerState.marker:ip(p)){if(n.containerState.type||(n.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),p===42||p===45?e.check(Uc,r,c)(p):c(p);if(!n.interrupt||p===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(p)}return r(p)}function u(p){return ip(p)&&++l<10?(e.consume(p),u):(!n.interrupt||l<2)&&(n.containerState.marker?p===n.containerState.marker:p===41||p===46)?(e.exit("listItemValue"),c(p)):r(p)}function c(p){return e.enter("listItemMarker"),e.consume(p),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||p,e.check(Fu,n.interrupt?r:d,e.attempt($R,f,h))}function d(p){return n.containerState.initialBlankLine=!0,i++,f(p)}function h(p){return qe(p)?(e.enter("listItemPrefixWhitespace"),e.consume(p),e.exit("listItemPrefixWhitespace"),f):r(p)}function f(p){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(p)}}function VR(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(Fu,s,i);function s(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Ze(e,t,"listItemIndent",n.containerState.size+1)(o)}function i(o){return n.containerState.furtherBlankLines||!qe(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,l(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(zR,t,l)(o))}function l(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,Ze(e,e.attempt(mr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function WR(e,t,r){const n=this;return Ze(e,s,"listItemIndent",n.containerState.size+1);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===n.containerState.size?t(i):r(i)}}function GR(e){e.exit(this.containerState.type)}function YR(e,t,r){const n=this;return Ze(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const l=n.events[n.events.length-1];return!qe(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):r(i)}}const Jy={name:"setextUnderline",resolveTo:QR,tokenize:KR};function QR(e,t){let r=e.length,n,s,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!i&&e[r][1].type==="definition"&&(i=r);const l={type:"setextHeading",start:{...e[s][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",l,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end={...e[i][1].end}):e[n][1]=l,e.push(["exit",l,t]),e}function KR(e,t,r){const n=this;let s;return i;function i(c){let d=n.events.length,h;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){h=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),s=c,l(c)):r(c)}function l(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===s?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),qe(c)?Ze(e,u,"lineSuffix")(c):u(c))}function u(c){return c===null||Se(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const ZR={tokenize:XR};function XR(e){const t=this,r=e.attempt(Fu,n,e.attempt(this.parser.constructs.flowInitial,s,Ze(e,e.attempt(this.parser.constructs.flow,s,e.attempt(nR,s)),"linePrefix")));return r;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const JR={resolveAll:QE()},eL=YE("string"),tL=YE("text");function YE(e){return{resolveAll:QE(e==="text"?rL:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],i=r.attempt(s,l,o);return l;function l(d){return c(d)?i(d):o(d)}function o(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),u}function u(d){return c(d)?(r.exit("data"),i(d)):(r.consume(d),u)}function c(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const p=h[f];if(!p.previous||p.previous.call(n,n.previous))return!0}return!1}}}function QE(e){return t;function t(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(r,n):r}}function rL(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let i=s.length,l=-1,o=0,u;for(;i--;){const c=s[i];if(typeof c=="string"){for(l=c.length;c.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(c===-2)u=!0,o++;else if(c!==-1){i++;break}}if(o){const c={type:r===e.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:n.start._bufferIndex+l,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const nL={42:mr,43:mr,45:mr,48:mr,49:mr,50:mr,51:mr,52:mr,53:mr,54:mr,55:mr,56:mr,57:mr,62:HE},sL={91:oR},aL={[-2]:yf,[-1]:yf,32:yf},iL={35:mR,42:Uc,45:[Jy,Uc],60:yR,61:Jy,95:Uc,96:Zy,126:Zy},lL={38:zE,92:$E},oL={[-5]:bf,[-4]:bf,[-3]:bf,33:DR,38:zE,42:lp,60:[F5,kR],91:FR,92:[hR,$E],93:K0,95:lp,96:Z5},uL={null:[lp,JR]},cL={null:[42,95]},dL={null:[]},hL=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:cL,contentInitial:sL,disable:dL,document:nL,flow:iL,flowInitial:aL,insideSpan:uL,string:lL,text:oL},Symbol.toStringTag,{value:"Module"}));function fL(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let l=[],o=[];const u={attempt:R(_),check:R(S),consume:y,enter:v,exit:N,interrupt:R(S,{interrupt:!0})},c={code:null,containerState:{},defineSkip:b,events:[],now:g,parser:e,previous:null,sliceSerialize:f,sliceStream:p,write:h};let d=t.tokenize.call(c,u);return t.resolveAll&&i.push(t),c;function h(F){return l=zr(l,F),E(),l[l.length-1]!==null?[]:(j(t,0),c.events=fh(i,c.events,c),c.events)}function f(F,O){return pL(p(F),O)}function p(F){return mL(l,F)}function g(){const{_bufferIndex:F,_index:O,line:Q,column:Y,offset:H}=n;return{_bufferIndex:F,_index:O,line:Q,column:Y,offset:H}}function b(F){s[F.line]=F.column,T()}function E(){let F;for(;n._index<l.length;){const O=l[n._index];if(typeof O=="string")for(F=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===F&&n._bufferIndex<O.length;)x(O.charCodeAt(n._bufferIndex));else x(O)}}function x(F){d=d(F)}function y(F){Se(F)?(n.line++,n.column=1,n.offset+=F===-3?2:1,T()):F!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=F}function v(F,O){const Q=O||{};return Q.type=F,Q.start=g(),c.events.push(["enter",Q,c]),o.push(Q),Q}function N(F){const O=o.pop();return O.end=g(),c.events.push(["exit",O,c]),O}function _(F,O){j(F,O.from)}function S(F,O){O.restore()}function R(F,O){return Q;function Q(Y,H,B){let A,M,G,k;return Array.isArray(Y)?z(Y):"tokenize"in Y?z([Y]):K(Y);function K(be){return Z;function Z(ye){const te=ye!==null&&be[ye],ce=ye!==null&&be.null,_e=[...Array.isArray(te)?te:te?[te]:[],...Array.isArray(ce)?ce:ce?[ce]:[]];return z(_e)(ye)}}function z(be){return A=be,M=0,be.length===0?B:I(be[M])}function I(be){return Z;function Z(ye){return k=D(),G=be,be.partial||(c.currentConstruct=be),be.name&&c.parser.constructs.disable.null.includes(be.name)?Ee():be.tokenize.call(O?Object.assign(Object.create(c),O):c,u,he,Ee)(ye)}}function he(be){return F(G,k),H}function Ee(be){return k.restore(),++M<A.length?I(A[M]):B}}}function j(F,O){F.resolveAll&&!i.includes(F)&&i.push(F),F.resolve&&Rr(c.events,O,c.events.length-O,F.resolve(c.events.slice(O),c)),F.resolveTo&&(c.events=F.resolveTo(c.events,c))}function D(){const F=g(),O=c.previous,Q=c.currentConstruct,Y=c.events.length,H=Array.from(o);return{from:Y,restore:B};function B(){n=F,c.previous=O,c.currentConstruct=Q,c.events.length=Y,o=H,T()}}function T(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function mL(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let l;if(r===s)l=[e[r].slice(n,i)];else{if(l=e.slice(r,s),n>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(n):l.shift()}i>0&&l.push(e[s].slice(0,i))}return l}function pL(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const i=e[r];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&s)continue;l=" ";break}default:l=String.fromCharCode(i)}s=i===-2,n.push(l)}return n.join("")}function gL(e){const n={constructs:UE([hL,...(e||{}).extensions||[]]),content:s(I5),defined:[],document:s(L5),flow:s(ZR),lazy:{},string:s(eL),text:s(tL)};return n;function s(i){return l;function l(o){return fL(n,i,o)}}}function xL(e){for(;!qE(e););return e}const eb=/[\0\t\n\r]/g;function yL(){let e=1,t="",r=!0,n;return s;function s(i,l,o){const u=[];let c,d,h,f,p;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),h=0,t="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if(eb.lastIndex=h,c=eb.exec(i),f=c&&c.index!==void 0?c.index:i.length,p=i.charCodeAt(f),!c){t=i.slice(h);break}if(p===10&&h===f&&n)u.push(-3),n=void 0;else switch(n&&(u.push(-5),n=void 0),h<f&&(u.push(i.slice(h,f)),e+=f-h),p){case 0:{u.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,u.push(-2);e++<d;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:n=!0,e=1}h=f+1}return o&&(n&&u.push(-5),t&&u.push(t),u.push(null)),u}}const bL=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function vL(e){return e.replace(bL,wL)}function wL(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return BE(r.slice(i?2:1),i?16:10)}return Q0(r)||e}const KE={}.hasOwnProperty;function EL(e,t,r){return typeof t!="string"&&(r=t,t=void 0),_L(r)(xL(gL(r).document().write(yL()(e,t,!0))))}function _L(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Ne),autolinkProtocol:D,autolinkEmail:D,atxHeading:i($),blockQuote:i(ce),characterEscape:D,characterReference:D,codeFenced:i(_e),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(_e,l),codeText:i(Ie,l),codeTextData:D,data:D,codeFlowValue:D,definition:i(Le),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Be),hardBreakEscape:i(W),hardBreakTrailing:i(W),htmlFlow:i(ee,l),htmlFlowData:D,htmlText:i(ee,l),htmlTextData:D,image:i(pe),label:l,link:i(Ne),listItem:i(We),listItemValue:f,listOrdered:i(Re,h),listUnordered:i(Re),paragraph:i(et),reference:I,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i($),strong:i(St),thematicBreak:i(dr)},exit:{atxHeading:u(),atxHeadingSequence:_,autolink:u(),autolinkEmail:te,autolinkProtocol:ye,blockQuote:u(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:Ee,characterReferenceMarkerNumeric:Ee,characterReferenceValue:be,characterReference:Z,codeFenced:u(E),codeFencedFence:b,codeFencedFenceInfo:p,codeFencedFenceMeta:g,codeFlowValue:T,codeIndented:u(x),codeText:u(H),codeTextData:T,data:T,definition:u(),definitionDestinationString:N,definitionLabelString:y,definitionTitleString:v,emphasis:u(),hardBreakEscape:u(O),hardBreakTrailing:u(O),htmlFlow:u(Q),htmlFlowData:T,htmlText:u(Y),htmlTextData:T,image:u(A),label:G,labelText:M,lineEnding:F,link:u(B),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:he,resourceDestinationString:k,resourceTitleString:K,resource:z,setextHeading:u(j),setextHeadingLineSequence:R,setextHeadingText:S,strong:u(),thematicBreak:u()}};ZE(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(X){let ue={type:"root",children:[]};const Te={stack:[ue],tokenStack:[],config:t,enter:o,exit:c,buffer:l,resume:d,data:r},He=[];let rt=-1;for(;++rt<X.length;)if(X[rt][1].type==="listOrdered"||X[rt][1].type==="listUnordered")if(X[rt][0]==="enter")He.push(rt);else{const Nr=He.pop();rt=s(X,Nr,rt)}for(rt=-1;++rt<X.length;){const Nr=t[X[rt][0]];KE.call(Nr,X[rt][1].type)&&Nr[X[rt][1].type].call(Object.assign({sliceSerialize:X[rt][2].sliceSerialize},Te),X[rt][1])}if(Te.tokenStack.length>0){const Nr=Te.tokenStack[Te.tokenStack.length-1];(Nr[1]||tb).call(Te,void 0,Nr[0])}for(ue.position={start:bs(X.length>0?X[0][1].start:{line:1,column:1,offset:0}),end:bs(X.length>0?X[X.length-2][1].end:{line:1,column:1,offset:0})},rt=-1;++rt<t.transforms.length;)ue=t.transforms[rt](ue)||ue;return ue}function s(X,ue,Te){let He=ue-1,rt=-1,Nr=!1,bn,en,xa,ya;for(;++He<=Te;){const er=X[He];switch(er[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{er[0]==="enter"?rt++:rt--,ya=void 0;break}case"lineEndingBlank":{er[0]==="enter"&&(bn&&!ya&&!rt&&!xa&&(xa=He),ya=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ya=void 0}if(!rt&&er[0]==="enter"&&er[1].type==="listItemPrefix"||rt===-1&&er[0]==="exit"&&(er[1].type==="listUnordered"||er[1].type==="listOrdered")){if(bn){let ps=He;for(en=void 0;ps--;){const tn=X[ps];if(tn[1].type==="lineEnding"||tn[1].type==="lineEndingBlank"){if(tn[0]==="exit")continue;en&&(X[en][1].type="lineEndingBlank",Nr=!0),tn[1].type="lineEnding",en=ps}else if(!(tn[1].type==="linePrefix"||tn[1].type==="blockQuotePrefix"||tn[1].type==="blockQuotePrefixWhitespace"||tn[1].type==="blockQuoteMarker"||tn[1].type==="listItemIndent"))break}xa&&(!en||xa<en)&&(bn._spread=!0),bn.end=Object.assign({},en?X[en][1].start:er[1].end),X.splice(en||He,0,["exit",bn,er[2]]),He++,Te++}if(er[1].type==="listItemPrefix"){const ps={type:"listItem",_spread:!1,start:Object.assign({},er[1].start),end:void 0};bn=ps,X.splice(He,0,["enter",ps,er[2]]),He++,Te++,xa=void 0,ya=!0}}}return X[ue][1]._spread=Nr,Te}function i(X,ue){return Te;function Te(He){o.call(this,X(He),He),ue&&ue.call(this,He)}}function l(){this.stack.push({type:"fragment",children:[]})}function o(X,ue,Te){this.stack[this.stack.length-1].children.push(X),this.stack.push(X),this.tokenStack.push([ue,Te||void 0]),X.position={start:bs(ue.start),end:void 0}}function u(X){return ue;function ue(Te){X&&X.call(this,Te),c.call(this,Te)}}function c(X,ue){const Te=this.stack.pop(),He=this.tokenStack.pop();if(He)He[0].type!==X.type&&(ue?ue.call(this,X,He[0]):(He[1]||tb).call(this,X,He[0]));else throw new Error("Cannot close `"+X.type+"` ("+jo({start:X.start,end:X.end})+"): its not open");Te.position.end=bs(X.end)}function d(){return Y0(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(X){if(this.data.expectingFirstListItemValue){const ue=this.stack[this.stack.length-2];ue.start=Number.parseInt(this.sliceSerialize(X),10),this.data.expectingFirstListItemValue=void 0}}function p(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.lang=X}function g(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.meta=X}function b(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.value=X.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.value=X.replace(/(\r?\n|\r)$/g,"")}function y(X){const ue=this.resume(),Te=this.stack[this.stack.length-1];Te.label=ue,Te.identifier=mn(this.sliceSerialize(X)).toLowerCase()}function v(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.title=X}function N(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.url=X}function _(X){const ue=this.stack[this.stack.length-1];if(!ue.depth){const Te=this.sliceSerialize(X).length;ue.depth=Te}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function R(X){const ue=this.stack[this.stack.length-1];ue.depth=this.sliceSerialize(X).codePointAt(0)===61?1:2}function j(){this.data.setextHeadingSlurpLineEnding=void 0}function D(X){const Te=this.stack[this.stack.length-1].children;let He=Te[Te.length-1];(!He||He.type!=="text")&&(He=cr(),He.position={start:bs(X.start),end:void 0},Te.push(He)),this.stack.push(He)}function T(X){const ue=this.stack.pop();ue.value+=this.sliceSerialize(X),ue.position.end=bs(X.end)}function F(X){const ue=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Te=ue.children[ue.children.length-1];Te.position.end=bs(X.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(ue.type)&&(D.call(this,X),T.call(this,X))}function O(){this.data.atHardBreak=!0}function Q(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.value=X}function Y(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.value=X}function H(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.value=X}function B(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const ue=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=ue,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function A(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const ue=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=ue,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function M(X){const ue=this.sliceSerialize(X),Te=this.stack[this.stack.length-2];Te.label=vL(ue),Te.identifier=mn(ue).toLowerCase()}function G(){const X=this.stack[this.stack.length-1],ue=this.resume(),Te=this.stack[this.stack.length-1];if(this.data.inReference=!0,Te.type==="link"){const He=X.children;Te.children=He}else Te.alt=ue}function k(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.url=X}function K(){const X=this.resume(),ue=this.stack[this.stack.length-1];ue.title=X}function z(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function he(X){const ue=this.resume(),Te=this.stack[this.stack.length-1];Te.label=ue,Te.identifier=mn(this.sliceSerialize(X)).toLowerCase(),this.data.referenceType="full"}function Ee(X){this.data.characterReferenceType=X.type}function be(X){const ue=this.sliceSerialize(X),Te=this.data.characterReferenceType;let He;Te?(He=BE(ue,Te==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):He=Q0(ue);const rt=this.stack[this.stack.length-1];rt.value+=He}function Z(X){const ue=this.stack.pop();ue.position.end=bs(X.end)}function ye(X){T.call(this,X);const ue=this.stack[this.stack.length-1];ue.url=this.sliceSerialize(X)}function te(X){T.call(this,X);const ue=this.stack[this.stack.length-1];ue.url="mailto:"+this.sliceSerialize(X)}function ce(){return{type:"blockquote",children:[]}}function _e(){return{type:"code",lang:null,meta:null,value:""}}function Ie(){return{type:"inlineCode",value:""}}function Le(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Be(){return{type:"emphasis",children:[]}}function $(){return{type:"heading",depth:0,children:[]}}function W(){return{type:"break"}}function ee(){return{type:"html",value:""}}function pe(){return{type:"image",title:null,url:"",alt:null}}function Ne(){return{type:"link",title:null,url:"",children:[]}}function Re(X){return{type:"list",ordered:X.type==="listOrdered",start:null,spread:X._spread,children:[]}}function We(X){return{type:"listItem",spread:X._spread,checked:null,children:[]}}function et(){return{type:"paragraph",children:[]}}function St(){return{type:"strong",children:[]}}function cr(){return{type:"text",value:""}}function dr(){return{type:"thematicBreak"}}}function bs(e){return{line:e.line,column:e.column,offset:e.offset}}function ZE(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?ZE(e,n):NL(e,n)}}function NL(e,t){let r;for(r in t)if(KE.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function tb(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+jo({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+jo({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+jo({start:t.start,end:t.end})+") is still open")}function kL(e){const t=this;t.parser=r;function r(n){return EL(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function SL(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function TL(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function CL(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function jL(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function AL(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function IL(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=Ol(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let l,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,u);const c={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,c),e.applyData(t,c)}function RL(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function LL(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function XE(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const l=s[s.length-1];return l&&l.type==="text"?l.value+=n:s.push({type:"text",value:n}),s}function OL(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return XE(e,t);const s={src:Ol(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function PL(e,t){const r={src:Ol(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function DL(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function ML(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return XE(e,t);const s={href:Ol(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function FL(e,t){const r={href:Ol(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function UL(e,t,r){const n=e.all(t),s=r?BL(r):JE(t),i={},l=[];if(typeof t.checked=="boolean"){const d=n[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const d=n[o];(s||o!==0||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?l.push(...d.children):l.push(d)}const u=n[n.length-1];u&&(s||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,c),e.applyData(t,c)}function BL(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=JE(r[n])}return t}function JE(e){const t=e.spread;return t??e.children.length>1}function HL(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const l=n[s];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function $L(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function zL(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function qL(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function VL(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],l),s.push(l)}if(r.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=Fn(t.children[1]),u=dh(t.children[t.children.length-1]);o&&u&&(l.position={start:o,end:u}),s.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function WL(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",l=r&&r.type==="table"?r.align:void 0,o=l?l.length:t.children.length;let u=-1;const c=[];for(;++u<o;){const h=t.children[u],f={},p=l?l[u]:void 0;p&&(f.align=p);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=e.all(h),e.patch(h,g),g=e.applyData(h,g)),c.push(g)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,d),e.applyData(t,d)}function GL(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const rb=9,nb=32;function YL(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const i=[];for(;n;)i.push(sb(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return i.push(sb(t.slice(s),s>0,!1)),i.join("")}function sb(e,t,r){let n=0,s=e.length;if(t){let i=e.codePointAt(n);for(;i===rb||i===nb;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(s-1);for(;i===rb||i===nb;)s--,i=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function QL(e,t){const r={type:"text",value:YL(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function KL(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const ZL={blockquote:SL,break:TL,code:CL,delete:jL,emphasis:AL,footnoteReference:IL,heading:RL,html:LL,imageReference:OL,image:PL,inlineCode:DL,linkReference:ML,link:FL,listItem:UL,list:HL,paragraph:$L,root:zL,strong:qL,table:VL,tableCell:GL,tableRow:WL,text:QL,thematicBreak:KL,toml:vc,yaml:vc,definition:vc,footnoteDefinition:vc};function vc(){}const e_=-1,mh=0,Io=1,Ed=2,Z0=3,X0=4,J0=5,eg=6,t_=7,r_=8,ab=typeof self=="object"?self:globalThis,XL=(e,t)=>{const r=(s,i)=>(e.set(i,s),s),n=s=>{if(e.has(s))return e.get(s);const[i,l]=t[s];switch(i){case mh:case e_:return r(l,s);case Io:{const o=r([],s);for(const u of l)o.push(n(u));return o}case Ed:{const o=r({},s);for(const[u,c]of l)o[n(u)]=n(c);return o}case Z0:return r(new Date(l),s);case X0:{const{source:o,flags:u}=l;return r(new RegExp(o,u),s)}case J0:{const o=r(new Map,s);for(const[u,c]of l)o.set(n(u),n(c));return o}case eg:{const o=r(new Set,s);for(const u of l)o.add(n(u));return o}case t_:{const{name:o,message:u}=l;return r(new ab[o](u),s)}case r_:return r(BigInt(l),s);case"BigInt":return r(Object(BigInt(l)),s);case"ArrayBuffer":return r(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return r(new DataView(o),l)}}return r(new ab[i](l),s)};return n},ib=e=>XL(new Map,e)(0),mi="",{toString:JL}={},{keys:eO}=Object,eo=e=>{const t=typeof e;if(t!=="object"||!e)return[mh,t];const r=JL.call(e).slice(8,-1);switch(r){case"Array":return[Io,mi];case"Object":return[Ed,mi];case"Date":return[Z0,mi];case"RegExp":return[X0,mi];case"Map":return[J0,mi];case"Set":return[eg,mi];case"DataView":return[Io,r]}return r.includes("Array")?[Io,r]:r.includes("Error")?[t_,r]:[Ed,r]},wc=([e,t])=>e===mh&&(t==="function"||t==="symbol"),tO=(e,t,r,n)=>{const s=(l,o)=>{const u=n.push(l)-1;return r.set(o,u),u},i=l=>{if(r.has(l))return r.get(l);let[o,u]=eo(l);switch(o){case mh:{let d=l;switch(u){case"bigint":o=r_,d=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);d=null;break;case"undefined":return s([e_],l)}return s([o,d],l)}case Io:{if(u){let f=l;return u==="DataView"?f=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(f=new Uint8Array(l)),s([u,[...f]],l)}const d=[],h=s([o,d],l);for(const f of l)d.push(i(f));return h}case Ed:{if(u)switch(u){case"BigInt":return s([u,l.toString()],l);case"Boolean":case"Number":case"String":return s([u,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const d=[],h=s([o,d],l);for(const f of eO(l))(e||!wc(eo(l[f])))&&d.push([i(f),i(l[f])]);return h}case Z0:return s([o,l.toISOString()],l);case X0:{const{source:d,flags:h}=l;return s([o,{source:d,flags:h}],l)}case J0:{const d=[],h=s([o,d],l);for(const[f,p]of l)(e||!(wc(eo(f))||wc(eo(p))))&&d.push([i(f),i(p)]);return h}case eg:{const d=[],h=s([o,d],l);for(const f of l)(e||!wc(eo(f)))&&d.push(i(f));return h}}const{message:c}=l;return s([o,{name:u,message:c}],l)};return i},lb=(e,{json:t,lossy:r}={})=>{const n=[];return tO(!(t||r),!!t,new Map,n)(e),n},ei=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?ib(lb(e,t)):structuredClone(e):(e,t)=>ib(lb(e,t));function rO(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function nO(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function sO(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||rO,n=e.options.footnoteBackLabel||nO,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[u]);if(!c)continue;const d=e.all(c),h=String(c.identifier).toUpperCase(),f=Ol(h.toLowerCase());let p=0;const g=[],b=e.footnoteCounts.get(h);for(;b!==void 0&&++p<=b;){g.length>0&&g.push({type:"text",value:" "});let y=typeof r=="string"?r:r(u,p);typeof y=="string"&&(y={type:"text",value:y}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,p),className:["data-footnote-backref"]},children:Array.isArray(y)?y:[y]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const y=E.children[E.children.length-1];y&&y.type==="text"?y.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...g)}else d.push(...g);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(c,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...ei(l),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const ph=function(e){if(e==null)return oO;if(typeof e=="function")return gh(e);if(typeof e=="object")return Array.isArray(e)?aO(e):iO(e);if(typeof e=="string")return lO(e);throw new Error("Expected function, string, or object as test")};function aO(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=ph(e[r]);return gh(n);function n(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function iO(e){const t=e;return gh(r);function r(n){const s=n;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function lO(e){return gh(t);function t(r){return r&&r.type===e}}function gh(e){return t;function t(r,n,s){return!!(uO(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function oO(){return!0}function uO(e){return e!==null&&typeof e=="object"&&"type"in e}const n_=[],cO=!0,op=!1,dO="skip";function s_(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const i=ph(s),l=n?-1:1;o(e,void 0,[])();function o(u,c,d){const h=u&&typeof u=="object"?u:{};if(typeof h.type=="string"){const p=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(u.type+(p?"<"+p+">":""))+")"})}return f;function f(){let p=n_,g,b,E;if((!t||i(u,c,d[d.length-1]||void 0))&&(p=hO(r(u,d)),p[0]===op))return p;if("children"in u&&u.children){const x=u;if(x.children&&p[0]!==dO)for(b=(n?x.children.length:-1)+l,E=d.concat(x);b>-1&&b<x.children.length;){const y=x.children[b];if(g=o(y,b,E)(),g[0]===op)return g;b=typeof g[1]=="number"?g[1]:b+l}}return p}}}function hO(e){return Array.isArray(e)?e:typeof e=="number"?[cO,e]:e==null?n_:[e]}function xh(e,t,r,n){let s,i,l;typeof t=="function"&&typeof r!="function"?(i=void 0,l=t,s=r):(i=t,l=r,s=n),s_(e,i,o,s);function o(u,c){const d=c[c.length-1],h=d?d.children.indexOf(u):void 0;return l(u,h,d)}}const up={}.hasOwnProperty,fO={};function mO(e,t){const r=t||fO,n=new Map,s=new Map,i=new Map,l={...ZL,...r.handlers},o={all:c,applyData:gO,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:u,options:r,patch:pO,wrap:yO};return xh(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?n:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),o;function u(d,h){const f=d.type,p=o.handlers[f];if(up.call(o.handlers,f)&&p)return p(o,d,h);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in d){const{children:b,...E}=d,x=ei(E);return x.children=o.all(d),x}return ei(d)}return(o.options.unknownHandler||xO)(o,d,h)}function c(d){const h=[];if("children"in d){const f=d.children;let p=-1;for(;++p<f.length;){const g=o.one(f[p],d);if(g){if(p&&f[p-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=ob(g.value)),!Array.isArray(g)&&g.type==="element")){const b=g.children[0];b&&b.type==="text"&&(b.value=ob(b.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function pO(e,t){e.position&&(t.position=LE(e))}function gO(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const l="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:l}}r.type==="element"&&i&&Object.assign(r.properties,ei(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function xO(e,t){const r=t.data||{},n="value"in t&&!(up.call(r,"hProperties")||up.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function yO(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function ob(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function ub(e,t){const r=mO(e,t),n=r.one(e,void 0),s=sO(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function bO(e,t){return e&&"run"in e?async function(r,n){const s=ub(r,{file:n,...t});await e.run(s,n)}:function(r,n){return ub(r,{file:n,...e||t})}}function cb(e){if(e)throw e}var Bc=Object.prototype.hasOwnProperty,a_=Object.prototype.toString,db=Object.defineProperty,hb=Object.getOwnPropertyDescriptor,fb=function(t){return typeof Array.isArray=="function"?Array.isArray(t):a_.call(t)==="[object Array]"},mb=function(t){if(!t||a_.call(t)!=="[object Object]")return!1;var r=Bc.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Bc.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||Bc.call(t,s)},pb=function(t,r){db&&r.name==="__proto__"?db(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},gb=function(t,r){if(r==="__proto__")if(Bc.call(t,r)){if(hb)return hb(t,r).value}else return;return t[r]},vO=function e(){var t,r,n,s,i,l,o=arguments[0],u=1,c=arguments.length,d=!1;for(typeof o=="boolean"&&(d=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=gb(o,r),s=gb(t,r),o!==s&&(d&&s&&(mb(s)||(i=fb(s)))?(i?(i=!1,l=n&&fb(n)?n:[]):l=n&&mb(n)?n:{},pb(o,{name:r,newValue:e(d,l,s)})):typeof s<"u"&&pb(o,{name:r,newValue:s}));return o};const vf=Od(vO);function cp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function wO(){const e=[],t={run:r,use:n};return t;function r(...s){let i=-1;const l=s.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...s);function o(u,...c){const d=e[++i];let h=-1;if(u){l(u);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,d?EO(d,o)(...c):l(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function EO(e,t){let r;return n;function n(...l){const o=e.length>l.length;let u;o&&l.push(s);try{u=e.apply(this,l)}catch(c){const d=c;if(o&&r)throw d;return s(d)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,s):u instanceof Error?s(u):i(u))}function s(l,...o){r||(r=!0,t(l,...o))}function i(l){s(null,l)}}const Nn={basename:_O,dirname:NO,extname:kO,join:SO,sep:"/"};function _O(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Uu(e);let r=0,n=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let l=-1,o=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){r=s+1;break}}else l<0&&(i=!0,l=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(n=s):(o=-1,n=l));return r===n?n=l:n<0&&(n=e.length),e.slice(r,n)}function NO(e){if(Uu(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function kO(e){Uu(e);let t=e.length,r=-1,n=0,s=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){n=t+1;break}continue}r<0&&(l=!0,r=t+1),o===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function SO(...e){let t=-1,r;for(;++t<e.length;)Uu(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":TO(r)}function TO(e){Uu(e);const t=e.codePointAt(0)===47;let r=CO(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function CO(e,t){let r="",n=0,s=-1,i=0,l=-1,o,u;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(u=r.lastIndexOf("/"),u!==r.length-1){u<0?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf("/")),s=l,i=0;continue}}else if(r.length>0){r="",n=0,s=l,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),n=l-s-1;s=l,i=0}else o===46&&i>-1?i++:i=-1}return r}function Uu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const jO={cwd:AO};function AO(){return"/"}function dp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function IO(e){if(typeof e=="string")e=new URL(e);else if(!dp(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return RO(e)}function RO(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const wf=["history","path","basename","stem","extname","dirname"];class i_{constructor(t){let r;t?dp(t)?r={path:t}:typeof t=="string"||LO(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":jO.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<wf.length;){const i=wf[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)wf.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?Nn.basename(this.path):void 0}set basename(t){_f(t,"basename"),Ef(t,"basename"),this.path=Nn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Nn.dirname(this.path):void 0}set dirname(t){xb(this.basename,"dirname"),this.path=Nn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Nn.extname(this.path):void 0}set extname(t){if(Ef(t,"extname"),xb(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Nn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){dp(t)&&(t=IO(t)),_f(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Nn.basename(this.path,this.extname):void 0}set stem(t){_f(t,"stem"),Ef(t,"stem"),this.path=Nn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new Xt(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Ef(e,t){if(e&&e.includes(Nn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Nn.sep+"`")}function _f(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function xb(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function LO(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const OO=function(e){const n=this.constructor.prototype,s=n[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},PO={}.hasOwnProperty;class tg extends OO{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=wO()}copy(){const t=new tg;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(vf(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(Sf("data",this.frozen),this.namespace[t]=r,this):PO.call(this.namespace,t)&&this.namespace[t]||void 0:t?(Sf("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=Ec(t),n=this.parser||this.Parser;return Nf("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),Nf("process",this.parser||this.Parser),kf("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,l){const o=Ec(t),u=n.parse(o);n.run(u,o,function(d,h,f){if(d||!h||!f)return c(d);const p=h,g=n.stringify(p,f);FO(g)?f.value=g:f.result=g,c(d,f)});function c(d,h){d||!h?l(d):i?i(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),Nf("processSync",this.parser||this.Parser),kf("processSync",this.compiler||this.Compiler),this.process(t,s),bb("processSync","process",r),n;function s(i,l){r=!0,cb(i),n=l}}run(t,r,n){yb(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(l,o){const u=Ec(r);s.run(t,u,c);function c(d,h,f){const p=h||t;d?o(d):l?l(p):n(void 0,p,f)}}}runSync(t,r){let n=!1,s;return this.run(t,r,i),bb("runSync","run",n),s;function i(l,o){cb(l),s=o,n=!0}}stringify(t,r){this.freeze();const n=Ec(r),s=this.compiler||this.Compiler;return kf("stringify",s),yb(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(Sf("use",this.frozen),t!=null)if(typeof t=="function")u(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")u(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...h]=c;u(d,h)}else l(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function l(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(s.settings=vf(!0,s.settings,c.settings))}function o(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const h=c[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function u(c,d){let h=-1,f=-1;for(;++h<n.length;)if(n[h][0]===c){f=h;break}if(f===-1)n.push([c,...d]);else if(d.length>0){let[p,...g]=d;const b=n[f][1];cp(b)&&cp(p)&&(p=vf(!0,b,p)),n[f]=[c,p,...g]}}}}const DO=new tg().freeze();function Nf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function kf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Sf(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function yb(e){if(!cp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function bb(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Ec(e){return MO(e)?e:new i_(e)}function MO(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function FO(e){return typeof e=="string"||UO(e)}function UO(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const BO="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",vb=[],wb={allowDangerousHtml:!0},HO=/^(https?|ircs?|mailto|xmpp)$/i,$O=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function l_(e){const t=e.allowedElements,r=e.allowElement,n=e.children||"",s=e.className,i=e.components,l=e.disallowedElements,o=e.rehypePlugins||vb,u=e.remarkPlugins||vb,c=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...wb}:wb,d=e.skipHtml,h=e.unwrapDisallowed,f=e.urlTransform||zO,p=DO().use(kL).use(u).use(bO,c).use(o),g=new i_;typeof n=="string"&&(g.value=n);for(const y of $O)Object.hasOwn(e,y.from)&&(""+y.from+(y.to?"use `"+y.to+"` instead":"remove it")+BO+y.id,void 0);const b=p.parse(g);let E=p.runSync(b,g);return s&&(E={type:"element",tagName:"div",properties:{className:s},children:E.type==="root"?E.children:[E]}),xh(E,x),l5(E,{Fragment:a.Fragment,components:i,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function x(y,v,N){if(y.type==="raw"&&N&&typeof v=="number")return d?N.children.splice(v,1):N.children[v]={type:"text",value:y.value},v;if(y.type==="element"){let _;for(_ in xf)if(Object.hasOwn(xf,_)&&Object.hasOwn(y.properties,_)){const S=y.properties[_],R=xf[_];(R===null||R.includes(y.tagName))&&(y.properties[_]=f(String(S||""),_,y))}}if(y.type==="element"){let _=t?!t.includes(y.tagName):l?l.includes(y.tagName):!1;if(!_&&r&&typeof v=="number"&&(_=!r(y,v,N)),_&&N&&typeof v=="number")return h&&y.children?N.children.splice(v,1,...y.children):N.children.splice(v,1),v}}}function zO(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||HO.test(e.slice(0,t))?e:""}function Eb(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(t);for(;s!==-1;)n++,s=r.indexOf(t,s+t.length);return n}function qO(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function VO(e,t,r){const s=ph((r||{}).ignore||[]),i=WO(t);let l=-1;for(;++l<i.length;)s_(e,"text",o);function o(c,d){let h=-1,f;for(;++h<d.length;){const p=d[h],g=f?f.children:void 0;if(s(p,g?g.indexOf(p):void 0,f))return;f=p}if(f)return u(c,d)}function u(c,d){const h=d[d.length-1],f=i[l][0],p=i[l][1];let g=0;const E=h.children.indexOf(c);let x=!1,y=[];f.lastIndex=0;let v=f.exec(c.value);for(;v;){const N=v.index,_={index:v.index,input:v.input,stack:[...d,c]};let S=p(...v,_);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?f.lastIndex=N+1:(g!==N&&y.push({type:"text",value:c.value.slice(g,N)}),Array.isArray(S)?y.push(...S):S&&y.push(S),g=N+v[0].length,x=!0),!f.global)break;v=f.exec(c.value)}return x?(g<c.value.length&&y.push({type:"text",value:c.value.slice(g)}),h.children.splice(E,1,...y)):y=[c],E+y.length}}function WO(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let n=-1;for(;++n<r.length;){const s=r[n];t.push([GO(s[0]),YO(s[1])])}return t}function GO(e){return typeof e=="string"?new RegExp(qO(e),"g"):e}function YO(e){return typeof e=="function"?e:function(){return e}}const Tf="phrasing",Cf=["autolink","link","image","label"];function QO(){return{transforms:[rP],enter:{literalAutolink:ZO,literalAutolinkEmail:jf,literalAutolinkHttp:jf,literalAutolinkWww:jf},exit:{literalAutolink:tP,literalAutolinkEmail:eP,literalAutolinkHttp:XO,literalAutolinkWww:JO}}}function KO(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Tf,notInConstruct:Cf},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Tf,notInConstruct:Cf},{character:":",before:"[ps]",after:"\\/",inConstruct:Tf,notInConstruct:Cf}]}}function ZO(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function jf(e){this.config.enter.autolinkProtocol.call(this,e)}function XO(e){this.config.exit.autolinkProtocol.call(this,e)}function JO(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function eP(e){this.config.exit.autolinkEmail.call(this,e)}function tP(e){this.exit(e)}function rP(e){VO(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,nP],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),sP]],{ignore:["link","linkReference"]})}function nP(e,t,r,n,s){let i="";if(!o_(s)||(/^w/i.test(t)&&(r=t+r,t="",i="http://"),!aP(r)))return!1;const l=iP(r+n);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function sP(e,t,r,n){return!o_(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function aP(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function iP(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],n=r.indexOf(")");const s=Eb(e,"(");let i=Eb(e,")");for(;n!==-1&&s>i;)e+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[e,r]}function o_(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||Ja(r)||hh(r))&&(!t||r!==47)}u_.peek=xP;function lP(){return{enter:{gfmFootnoteDefinition:uP,gfmFootnoteDefinitionLabelString:cP,gfmFootnoteCall:fP,gfmFootnoteCallString:mP},exit:{gfmFootnoteDefinition:hP,gfmFootnoteDefinitionLabelString:dP,gfmFootnoteCall:gP,gfmFootnoteCallString:pP}}}function oP(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:yP,footnoteReference:u_}}}function uP(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function cP(){this.buffer()}function dP(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=mn(this.sliceSerialize(e)).toLowerCase()}function hP(e){this.exit(e)}function fP(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function mP(){this.buffer()}function pP(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=t,r.identifier=mn(this.sliceSerialize(e)).toLowerCase()}function gP(e){this.exit(e)}function u_(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteReference"),o=r.enter("reference");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),l(),i+=s.move("]"),i}function xP(){return"["}function yP(e,t,r,n){const s=r.createTracker(n);let i=s.move("[^");const l=r.enter("footnoteDefinition"),o=r.enter("label");return i+=s.move(r.safe(r.associationId(e),{...s.current(),before:i,after:"]"})),o(),i+=s.move("]:"+(e.children&&e.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(e,s.current()),bP)),l(),i}function bP(e,t,r){return t===0?e:(r?"":"    ")+e}const vP=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];c_.peek=kP;function wP(){return{canContainEols:["delete"],enter:{strikethrough:_P},exit:{strikethrough:NP}}}function EP(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:vP}],handlers:{delete:c_}}}function _P(e){this.enter({type:"delete",children:[]},e)}function NP(e){this.exit(e)}function c_(e,t,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let l=s.move("~~");return l+=r.containerPhrasing(e,{...s.current(),before:l,after:"~"}),l+=s.move("~~"),i(),l}function kP(){return"~"}function SP(e){return e.length}function TP(e,t){const r=t||{},n=(r.align||[]).concat(),s=r.stringLength||SP,i=[],l=[],o=[],u=[];let c=0,d=-1;for(;++d<e.length;){const b=[],E=[];let x=-1;for(e[d].length>c&&(c=e[d].length);++x<e[d].length;){const y=CP(e[d][x]);if(r.alignDelimiters!==!1){const v=s(y);E[x]=v,(u[x]===void 0||v>u[x])&&(u[x]=v)}b.push(y)}l[d]=b,o[d]=E}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=_b(n[h]);else{const b=_b(n);for(;++h<c;)i[h]=b}h=-1;const f=[],p=[];for(;++h<c;){const b=i[h];let E="",x="";b===99?(E=":",x=":"):b===108?E=":":b===114&&(x=":");let y=r.alignDelimiters===!1?1:Math.max(1,u[h]-E.length-x.length);const v=E+"-".repeat(y)+x;r.alignDelimiters!==!1&&(y=E.length+y+x.length,y>u[h]&&(u[h]=y),p[h]=y),f[h]=v}l.splice(1,0,f),o.splice(1,0,p),d=-1;const g=[];for(;++d<l.length;){const b=l[d],E=o[d];h=-1;const x=[];for(;++h<c;){const y=b[h]||"";let v="",N="";if(r.alignDelimiters!==!1){const _=u[h]-(E[h]||0),S=i[h];S===114?v=" ".repeat(_):S===99?_%2?(v=" ".repeat(_/2+.5),N=" ".repeat(_/2-.5)):(v=" ".repeat(_/2),N=v):N=" ".repeat(_)}r.delimiterStart!==!1&&!h&&x.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&y==="")&&(r.delimiterStart!==!1||h)&&x.push(" "),r.alignDelimiters!==!1&&x.push(v),x.push(y),r.alignDelimiters!==!1&&x.push(N),r.padding!==!1&&x.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&x.push("|")}g.push(r.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return g.join(`
`)}function CP(e){return e==null?"":String(e)}function _b(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const Nb={}.hasOwnProperty;function d_(e,t){const r=t||{};function n(s,...i){let l=n.invalid;const o=n.handlers;if(s&&Nb.call(s,e)){const u=String(s[e]);l=Nb.call(o,u)?o[u]:n.unknown}if(l)return l.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function jP(e,t,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const l=r.indentLines(r.containerFlow(e,i.current()),AP);return s(),l}function AP(e,t,r){return">"+(r?"":" ")+e}function IP(e,t){return kb(e,t.inConstruct,!0)&&!kb(e,t.notInConstruct,!1)}function kb(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function Sb(e,t,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&IP(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function RP(e,t){const r=String(e);let n=r.indexOf(t),s=n,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>l&&(l=i):i=1,s=n+t.length,n=r.indexOf(t,s);return l}function LP(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function OP(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function PP(e,t,r,n){const s=OP(r),i=e.value||"",l=s==="`"?"GraveAccent":"Tilde";if(LP(e,r)){const h=r.enter("codeIndented"),f=r.indentLines(i,DP);return h(),f}const o=r.createTracker(n),u=s.repeat(Math.max(RP(i,s)+1,3)),c=r.enter("codeFenced");let d=o.move(u);if(e.lang){const h=r.enter(`codeFencedLang${l}`);d+=o.move(r.safe(e.lang,{before:d,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=r.enter(`codeFencedMeta${l}`);d+=o.move(" "),d+=o.move(r.safe(e.meta,{before:d,after:`
`,encode:["`"],...o.current()})),h()}return d+=o.move(`
`),i&&(d+=o.move(i+`
`)),d+=o.move(u),c(),d}function DP(e,t,r){return(r?"":"    ")+e}function rg(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function MP(e,t,r,n){const s=rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("definition");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("[");return c+=u.move(r.safe(r.associationId(e),{before:c,after:"]",...u.current()})),c+=u.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),l(),c}function FP(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function ou(e){return"&#x"+e.toString(16).toUpperCase()+";"}function _d(e,t,r){const n=xl(e),s=xl(t);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}h_.peek=UP;function h_(e,t,r,n){const s=FP(r),i=r.enter("emphasis"),l=r.createTracker(n),o=l.move(s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=_d(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=ou(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=_d(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+ou(h));const p=l.move(s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function UP(e,t,r){return r.options.emphasis||"*"}function BP(e,t){let r=!1;return xh(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,op}),!!((!e.depth||e.depth<3)&&Y0(e)&&(t.options.setext||r))}function HP(e,t,r,n){const s=Math.max(Math.min(6,e.depth||1),1),i=r.createTracker(n);if(BP(e,r)){const d=r.enter("headingSetext"),h=r.enter("phrasing"),f=r.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const l="#".repeat(s),o=r.enter("headingAtx"),u=r.enter("phrasing");i.move(l+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=ou(c.charCodeAt(0))+c.slice(1)),c=c?l+" "+c:l,r.options.closeAtx&&(c+=" "+l),u(),o(),c}f_.peek=$P;function f_(e){return e.value||""}function $P(){return"<"}m_.peek=zP;function m_(e,t,r,n){const s=rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.enter("image");let o=r.enter("label");const u=r.createTracker(n);let c=u.move("![");return c+=u.move(r.safe(e.alt,{before:c,after:"]",...u.current()})),c+=u.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=u.move("<"),c+=u.move(r.safe(e.url,{before:c,after:">",...u.current()})),c+=u.move(">")):(o=r.enter("destinationRaw"),c+=u.move(r.safe(e.url,{before:c,after:e.title?" ":")",...u.current()}))),o(),e.title&&(o=r.enter(`title${i}`),c+=u.move(" "+s),c+=u.move(r.safe(e.title,{before:c,after:s,...u.current()})),c+=u.move(s),o()),c+=u.move(")"),l(),c}function zP(){return"!"}p_.peek=qP;function p_(e,t,r,n){const s=e.referenceType,i=r.enter("imageReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("![");const c=r.safe(e.alt,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function qP(){return"!"}g_.peek=VP;function g_(e,t,r){let n=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const l=r.unsafe[i],o=r.compilePattern(l);let u;if(l.atBreak)for(;u=o.exec(n);){let c=u.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(u.index+1)}}return s+n+s}function VP(){return"`"}function x_(e,t){const r=Y0(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}y_.peek=WP;function y_(e,t,r,n){const s=rg(r),i=s==='"'?"Quote":"Apostrophe",l=r.createTracker(n);let o,u;if(x_(e,r)){const d=r.stack;r.stack=[],o=r.enter("autolink");let h=l.move("<");return h+=l.move(r.containerPhrasing(e,{before:h,after:">",...l.current()})),h+=l.move(">"),o(),r.stack=d,h}o=r.enter("link"),u=r.enter("label");let c=l.move("[");return c+=l.move(r.containerPhrasing(e,{before:c,after:"](",...l.current()})),c+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(u=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(e.title,{before:c,after:s,...l.current()})),c+=l.move(s),u()),c+=l.move(")"),o(),c}function WP(e,t,r){return x_(e,r)?"<":"["}b_.peek=GP;function b_(e,t,r,n){const s=e.referenceType,i=r.enter("linkReference");let l=r.enter("label");const o=r.createTracker(n);let u=o.move("[");const c=r.containerPhrasing(e,{before:u,after:"]",...o.current()});u+=o.move(c+"]["),l();const d=r.stack;r.stack=[],l=r.enter("reference");const h=r.safe(r.associationId(e),{before:u,after:"]",...o.current()});return l(),r.stack=d,i(),s==="full"||!c||c!==h?u+=o.move(h+"]"):s==="shortcut"?u=u.slice(0,-1):u+=o.move("]"),u}function GP(){return"["}function ng(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function YP(e){const t=ng(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function QP(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function v_(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function KP(e,t,r,n){const s=r.enter("list"),i=r.bulletCurrent;let l=e.ordered?QP(r):ng(r);const o=e.ordered?l==="."?")":".":YP(r);let u=t&&r.bulletLastUsed?l===r.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&d&&(!d.children||!d.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(u=!0),v_(r)===l&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=o),r.bulletCurrent=l;const c=r.containerFlow(e,n);return r.bulletLastUsed=l,r.bulletCurrent=i,s(),c}function ZP(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function XP(e,t,r,n){const s=ZP(r);let i=r.bulletCurrent||ng(r);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=r.createTracker(n);o.move(i+" ".repeat(l-i.length)),o.shift(l);const u=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),d);return u(),c;function d(h,f,p){return f?(p?"":" ".repeat(l))+h:(p?i:i+" ".repeat(l-i.length))+h}}function JP(e,t,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),l=r.containerPhrasing(e,n);return i(),s(),l}const eD=ph(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function tD(e,t,r,n){return(e.children.some(function(l){return eD(l)})?r.containerPhrasing:r.containerFlow).call(r,e,n)}function rD(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}w_.peek=nD;function w_(e,t,r,n){const s=rD(r),i=r.enter("strong"),l=r.createTracker(n),o=l.move(s+s);let u=l.move(r.containerPhrasing(e,{after:s,before:o,...l.current()}));const c=u.charCodeAt(0),d=_d(n.before.charCodeAt(n.before.length-1),c,s);d.inside&&(u=ou(c)+u.slice(1));const h=u.charCodeAt(u.length-1),f=_d(n.after.charCodeAt(0),h,s);f.inside&&(u=u.slice(0,-1)+ou(h));const p=l.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},o+u+p}function nD(e,t,r){return r.options.strong||"*"}function sD(e,t,r,n){return r.safe(e.value,n)}function aD(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function iD(e,t,r){const n=(v_(r)+(r.options.ruleSpaces?" ":"")).repeat(aD(r));return r.options.ruleSpaces?n.slice(0,-1):n}const E_={blockquote:jP,break:Sb,code:PP,definition:MP,emphasis:h_,hardBreak:Sb,heading:HP,html:f_,image:m_,imageReference:p_,inlineCode:g_,link:y_,linkReference:b_,list:KP,listItem:XP,paragraph:JP,root:tD,strong:w_,text:sD,thematicBreak:iD};function lD(){return{enter:{table:oD,tableData:Tb,tableHeader:Tb,tableRow:cD},exit:{codeText:dD,table:uD,tableData:Af,tableHeader:Af,tableRow:Af}}}function oD(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function uD(e){this.exit(e),this.data.inTable=void 0}function cD(e){this.enter({type:"tableRow",children:[]},e)}function Af(e){this.exit(e)}function Tb(e){this.enter({type:"tableCell",children:[]},e)}function dD(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,hD));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function hD(e,t){return t==="|"?t:e}function fD(e){const t=e||{},r=t.tableCellPadding,n=t.tablePipeAlign,s=t.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:l,tableCell:u,tableRow:o}};function l(p,g,b,E){return c(d(p,b,E),p.align)}function o(p,g,b,E){const x=h(p,b,E),y=c([x]);return y.slice(0,y.indexOf(`
`))}function u(p,g,b,E){const x=b.enter("tableCell"),y=b.enter("phrasing"),v=b.containerPhrasing(p,{...E,before:i,after:i});return y(),x(),v}function c(p,g){return TP(p,{align:g,alignDelimiters:n,padding:r,stringLength:s})}function d(p,g,b){const E=p.children;let x=-1;const y=[],v=g.enter("table");for(;++x<E.length;)y[x]=h(E[x],g,b);return v(),y}function h(p,g,b){const E=p.children;let x=-1;const y=[],v=g.enter("tableRow");for(;++x<E.length;)y[x]=u(E[x],p,g,b);return v(),y}function f(p,g,b){let E=E_.inlineCode(p,g,b);return b.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function mD(){return{exit:{taskListCheckValueChecked:Cb,taskListCheckValueUnchecked:Cb,paragraph:gD}}}function pD(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:xD}}}function Cb(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function gD(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=t.children;let i=-1,l;for(;++i<s.length;){const o=s[i];if(o.type==="paragraph"){l=o;break}}l===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function xD(e,t,r,n){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=r.createTracker(n);i&&o.move(l);let u=E_.listItem(e,t,r,{...n,...o.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),u;function c(d){return d+l}}function yD(){return[QO(),lP(),wP(),lD(),mD()]}function bD(e){return{extensions:[KO(),oP(),EP(),fD(e),pD()]}}const vD={tokenize:SD,partial:!0},__={tokenize:TD,partial:!0},N_={tokenize:CD,partial:!0},k_={tokenize:jD,partial:!0},wD={tokenize:AD,partial:!0},S_={name:"wwwAutolink",tokenize:ND,previous:C_},T_={name:"protocolAutolink",tokenize:kD,previous:j_},ms={name:"emailAutolink",tokenize:_D,previous:A_},Un={};function ED(){return{text:Un}}let va=48;for(;va<123;)Un[va]=ms,va++,va===58?va=65:va===91&&(va=97);Un[43]=ms;Un[45]=ms;Un[46]=ms;Un[95]=ms;Un[72]=[ms,T_];Un[104]=[ms,T_];Un[87]=[ms,S_];Un[119]=[ms,S_];function _D(e,t,r){const n=this;let s,i;return l;function l(h){return!hp(h)||!A_.call(n,n.previous)||sg(n.events)?r(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return hp(h)?(e.consume(h),o):h===64?(e.consume(h),u):r(h)}function u(h){return h===46?e.check(wD,d,c)(h):h===45||h===95||Qt(h)?(i=!0,e.consume(h),u):d(h)}function c(h){return e.consume(h),s=!0,u}function d(h){return i&&s&&sr(n.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):r(h)}}function ND(e,t,r){const n=this;return s;function s(l){return l!==87&&l!==119||!C_.call(n,n.previous)||sg(n.events)?r(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(vD,e.attempt(__,e.attempt(N_,i),r),r)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function kD(e,t,r){const n=this;let s="",i=!1;return l;function l(h){return(h===72||h===104)&&j_.call(n,n.previous)&&!sg(n.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),o):r(h)}function o(h){if(sr(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),u}return r(h)}function u(h){return h===47?(e.consume(h),i?c:(i=!0,u)):r(h)}function c(h){return h===null||wd(h)||st(h)||Ja(h)||hh(h)?r(h):e.attempt(__,e.attempt(N_,d),r)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function SD(e,t,r){let n=0;return s;function s(l){return(l===87||l===119)&&n<3?(n++,e.consume(l),s):l===46&&n===3?(e.consume(l),i):r(l)}function i(l){return l===null?r(l):t(l)}}function TD(e,t,r){let n,s,i;return l;function l(c){return c===46||c===95?e.check(k_,u,o)(c):c===null||st(c)||Ja(c)||c!==45&&hh(c)?u(c):(i=!0,e.consume(c),l)}function o(c){return c===95?n=!0:(s=n,n=void 0),e.consume(c),l}function u(c){return s||n||!i?r(c):t(c)}}function CD(e,t){let r=0,n=0;return s;function s(l){return l===40?(r++,e.consume(l),s):l===41&&n<r?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(k_,t,i)(l):l===null||st(l)||Ja(l)?t(l):(e.consume(l),s)}function i(l){return l===41&&n++,e.consume(l),s}}function jD(e,t,r){return n;function n(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),n):o===38?(e.consume(o),i):o===93?(e.consume(o),s):o===60||o===null||st(o)||Ja(o)?t(o):r(o)}function s(o){return o===null||o===40||o===91||st(o)||Ja(o)?t(o):n(o)}function i(o){return sr(o)?l(o):r(o)}function l(o){return o===59?(e.consume(o),n):sr(o)?(e.consume(o),l):r(o)}}function AD(e,t,r){return n;function n(i){return e.consume(i),s}function s(i){return Qt(i)?r(i):t(i)}}function C_(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||st(e)}function j_(e){return!sr(e)}function A_(e){return!(e===47||hp(e))}function hp(e){return e===43||e===45||e===46||e===95||Qt(e)}function sg(e){let t=e.length,r=!1;for(;t--;){const n=e[t][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const ID={tokenize:UD,partial:!0};function RD(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:DD,continuation:{tokenize:MD},exit:FD}},text:{91:{name:"gfmFootnoteCall",tokenize:PD},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:LD,resolveTo:OD}}}}function LD(e,t,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let l;for(;s--;){const u=n.events[s][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return o;function o(u){if(!l||!l._balanced)return r(u);const c=mn(n.sliceSerialize({start:l.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function OD(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[r+1],e[r+2],["enter",n,t],e[r+3],e[r+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",n,t]];return e.splice(r,e.length-r+1,...o),e}function PD(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,l;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),u}function u(h){return h!==94?r(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!l||h===null||h===91||st(h))return r(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(mn(n.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(h)}return st(h)||(l=!0),i++,e.consume(h),h===92?d:c}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,c):c(h)}}function DD(e,t,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,l=0,o;return u;function u(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):r(g)}function d(g){if(l>999||g===93&&!o||g===null||g===91||st(g))return r(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteDefinitionLabelString");return i=mn(n.sliceSerialize(b)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return st(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}function f(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),s.includes(i)||s.push(i),Ze(e,p,"gfmFootnoteDefinitionWhitespace")):r(g)}function p(g){return t(g)}}function MD(e,t,r){return e.check(Fu,t,e.attempt(ID,t,r))}function FD(e){e.exit("gfmFootnoteDefinition")}function UD(e,t,r){const n=this;return Ze(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):r(i)}}function BD(e){let r=(e||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(l,o){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let c=u;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[u][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[u][1].end)},h={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[u][1].start)},f=[["enter",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["enter",h,o]],p=o.parser.constructs.insideSpan.null;p&&Rr(f,f.length,0,fh(p,l.slice(c+1,u),o)),Rr(f,f.length,0,[["exit",h,o],["enter",l[u][1],o],["exit",l[u][1],o],["exit",d,o]]),Rr(l,c-1,u-c+3,f),u=c+f.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function i(l,o,u){const c=this.previous,d=this.events;let h=0;return f;function f(g){return c===126&&d[d.length-1][1].type!=="characterEscape"?u(g):(l.enter("strikethroughSequenceTemporary"),p(g))}function p(g){const b=xl(c);if(g===126)return h>1?u(g):(l.consume(g),h++,p);if(h<2&&!r)return u(g);const E=l.exit("strikethroughSequenceTemporary"),x=xl(g);return E._open=!x||x===2&&!!b,E._close=!b||b===2&&!!x,o(g)}}}class HD{constructor(){this.map=[]}add(t,r,n){$D(this,t,r,n)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];n.push(t.slice()),t.length=0;let s=n.pop();for(;s;){for(const i of s)t.push(i);s=n.pop()}this.map.length=0}}function $D(e,t,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=r,e.map[s][2].push(...n);return}s+=1}e.map.push([t,r,n])}}function zD(e,t){let r=!1;const n=[];for(;t<e.length;){const s=e[t];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return n}function qD(){return{flow:{null:{name:"table",tokenize:VD,resolveAll:WD}}}}function VD(e,t,r){const n=this;let s=0,i=0,l;return o;function o(T){let F=n.events.length-1;for(;F>-1;){const Y=n.events[F][1].type;if(Y==="lineEnding"||Y==="linePrefix")F--;else break}const O=F>-1?n.events[F][1].type:null,Q=O==="tableHead"||O==="tableRow"?S:u;return Q===S&&n.parser.lazy[n.now().line]?r(T):Q(T)}function u(T){return e.enter("tableHead"),e.enter("tableRow"),c(T)}function c(T){return T===124||(l=!0,i+=1),d(T)}function d(T){return T===null?r(T):Se(T)?i>1?(i=0,n.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),p):r(T):qe(T)?Ze(e,d,"whitespace")(T):(i+=1,l&&(l=!1,s+=1),T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),l=!0,d):(e.enter("data"),h(T)))}function h(T){return T===null||T===124||st(T)?(e.exit("data"),d(T)):(e.consume(T),T===92?f:h)}function f(T){return T===92||T===124?(e.consume(T),h):h(T)}function p(T){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(T):(e.enter("tableDelimiterRow"),l=!1,qe(T)?Ze(e,g,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):g(T))}function g(T){return T===45||T===58?E(T):T===124?(l=!0,e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),b):_(T)}function b(T){return qe(T)?Ze(e,E,"whitespace")(T):E(T)}function E(T){return T===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),x):T===45?(i+=1,x(T)):T===null||Se(T)?N(T):_(T)}function x(T){return T===45?(e.enter("tableDelimiterFiller"),y(T)):_(T)}function y(T){return T===45?(e.consume(T),y):T===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(T),e.exit("tableDelimiterMarker"),v):(e.exit("tableDelimiterFiller"),v(T))}function v(T){return qe(T)?Ze(e,N,"whitespace")(T):N(T)}function N(T){return T===124?g(T):T===null||Se(T)?!l||s!==i?_(T):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(T)):_(T)}function _(T){return r(T)}function S(T){return e.enter("tableRow"),R(T)}function R(T){return T===124?(e.enter("tableCellDivider"),e.consume(T),e.exit("tableCellDivider"),R):T===null||Se(T)?(e.exit("tableRow"),t(T)):qe(T)?Ze(e,R,"whitespace")(T):(e.enter("data"),j(T))}function j(T){return T===null||T===124||st(T)?(e.exit("data"),R(T)):(e.consume(T),T===92?D:j)}function D(T){return T===92||T===124?(e.consume(T),j):j(T)}}function WD(e,t){let r=-1,n=!0,s=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,u=0,c,d,h;const f=new HD;for(;++r<e.length;){const p=e[r],g=p[1];p[0]==="enter"?g.type==="tableHead"?(o=!1,u!==0&&(jb(f,t,u,c,d),d=void 0,u=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",c,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],l=[0,r+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(r,0,[["enter",d,t]])),s=g.type==="tableDelimiterRow"?2:d?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(n=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],h=_c(f,t,i,s,void 0,h),i=[0,0,0,0]),l[2]=r)):g.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(l[0]=l[1],h=_c(f,t,i,s,void 0,h)),i=l,l=[i[1],r,0,0])):g.type==="tableHead"?(o=!0,u=r):g.type==="tableRow"||g.type==="tableDelimiterRow"?(u=r,i[1]!==0?(l[0]=l[1],h=_c(f,t,i,s,r,h)):l[1]!==0&&(h=_c(f,t,l,s,r,h)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(l[3]=r)}for(u!==0&&jb(f,t,u,c,d),f.consume(t.events),r=-1;++r<t.events.length;){const p=t.events[r];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=zD(t.events,r))}return e}function _c(e,t,r,n,s,i){const l=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(i.end=Object.assign({},gi(t.events,r[0])),e.add(r[0],0,[["exit",i,t]]));const u=gi(t.events,r[1]);if(i={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(r[1],0,[["enter",i,t]]),r[2]!==0){const c=gi(t.events,r[2]),d=gi(t.events,r[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},d)};if(e.add(r[2],0,[["enter",h,t]]),n!==2){const f=t.events[r[2]],p=t.events[r[3]];if(f[1].end=Object.assign({},p[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const g=r[2]+1,b=r[3]-r[2]-1;e.add(g,b,[])}}e.add(r[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},gi(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function jb(e,t,r,n,s){const i=[],l=gi(t.events,r);s&&(s.end=Object.assign({},l),i.push(["exit",s,t])),n.end=Object.assign({},l),i.push(["exit",n,t]),e.add(r+1,0,i)}function gi(e,t){const r=e[t],n=r[0]==="enter"?"start":"end";return r[1][n]}const GD={name:"tasklistCheck",tokenize:QD};function YD(){return{text:{91:GD}}}function QD(e,t,r){const n=this;return s;function s(u){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return st(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):r(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(u)}function o(u){return Se(u)?t(u):qe(u)?e.check({tokenize:KD},t,r)(u):r(u)}}function KD(e,t,r){return Ze(e,n,"whitespace");function n(s){return s===null?r(s):t(s)}}function ZD(e){return UE([ED(),RD(),BD(e),qD(),YD()])}const XD={};function I_(e){const t=this,r=e||XD,n=t.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),l=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(ZD(r)),i.push(yD()),l.push(bD(r))}const Ab=/[#.]/g;function JD(e,t){const r=e||"",n={};let s=0,i,l;for(;s<r.length;){Ab.lastIndex=s;const o=Ab.exec(r),u=r.slice(s,o?o.index:r.length);u&&(i?i==="#"?n.id=u:Array.isArray(n.className)?n.className.push(u):n.className=[u]:l=u,s+=u.length),o&&(i=o[0],s++)}return{type:"element",tagName:l||t||"div",properties:n,children:[]}}const fp={}.hasOwnProperty;function R_(e,t,r){const n=r&&nM(r);function s(i,l,...o){let u=-1,c;if(i==null){c={type:"root",children:[]};const d=l;o.unshift(d)}else if(c=JD(i,t),c.tagName=c.tagName.toLowerCase(),n&&fp.call(n,c.tagName)&&(c.tagName=n[c.tagName]),eM(l))o.unshift(l);else{let d;for(d in l)fp.call(l,d)&&tM(e,c.properties,d,l[d])}for(;++u<o.length;)mp(c.children,o[u]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function eM(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,r=Object.keys(e);for(const n of r){const s=t[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function tM(e,t,r,n){const s=ch(e,r);let i=-1,l;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;l=n}else typeof n=="boolean"?l=n:typeof n=="string"?s.spaceSeparated?l=My(n):s.commaSeparated?l=Ry(n):s.commaOrSpaceSeparated?l=My(Ry(n).join(" ")):l=Ib(s,s.property,n):Array.isArray(n)?l=n.concat():l=s.property==="style"?rM(n):String(n);if(Array.isArray(l)){const o=[];for(;++i<l.length;){const u=Ib(s,s.property,l[i]);o[i]=u}l=o}if(s.property==="className"&&Array.isArray(t.className)){const o=l;l=t.className.concat(o)}t[s.property]=l}}function mp(e,t){let r=-1;if(t!=null)if(typeof t=="string"||typeof t=="number")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)mp(e,t[r]);else if(typeof t=="object"&&"type"in t)t.type==="root"?mp(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function Ib(e,t,r){if(typeof r=="string"){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(r===""||iu(r)===iu(t)))return!0}return r}function rM(e){const t=[];let r;for(r in e)fp.call(e,r)&&t.push([r,e[r]].join(": "));return t.join("; ")}function nM(e){const t={};let r=-1;for(;++r<e.length;)t[e[r].toLowerCase()]=e[r];return t}const sM=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],aM=R_(Mu,"div"),iM=R_(pa,"g",sM);function lM(e){const t=String(e),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=r[l];if(o===void 0){const u=Rb(t,r[l-1]);o=u===-1?t.length+1:u+1,r[l]=o}if(o>i)return{line:l+1,column:i-(l>0?r[l-1]:0)+1,offset:i};l++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const o=r[r.length-1],u=Rb(t,o),c=u===-1?t.length+1:u+1;if(o===c)break;r.push(c)}const l=(i.line>1?r[i.line-2]:0)+i.column-1;if(l<r[i.line-1])return l}}}function Rb(e,t){const r=e.indexOf("\r",t),n=e.indexOf(`
`,t);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const Ra={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},L_={}.hasOwnProperty,oM=Object.prototype;function uM(e,t){const r=t||{};return ag({file:r.file||void 0,location:!1,schema:r.space==="svg"?pa:Mu,verbose:r.verbose||!1},e)}function ag(e,t){let r;switch(t.nodeName){case"#comment":{const n=t;return r={type:"comment",value:n.data},Hc(e,n,r),r}case"#document":case"#document-fragment":{const n=t,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:O_(e,t.childNodes),data:{quirksMode:s}},e.file&&e.location){const i=String(e.file),l=lM(i),o=l.toPoint(0),u=l.toPoint(i.length);r.position={start:o,end:u}}return r}case"#documentType":{const n=t;return r={type:"doctype"},Hc(e,n,r),r}case"#text":{const n=t;return r={type:"text",value:n.value},Hc(e,n,r),r}default:return r=cM(e,t),r}}function O_(e,t){let r=-1;const n=[];for(;++r<t.length;){const s=ag(e,t[r]);n.push(s)}return n}function cM(e,t){const r=e.schema;e.schema=t.namespaceURI===Ra.svg?pa:Mu;let n=-1;const s={};for(;++n<t.attrs.length;){const o=t.attrs[n],u=(o.prefix?o.prefix+":":"")+o.name;L_.call(oM,u)||(s[u]=o.value)}const l=(e.schema.space==="svg"?iM:aM)(t.tagName,s,O_(e,t.childNodes));if(Hc(e,t,l),l.tagName==="template"){const o=t,u=o.sourceCodeLocation,c=u&&u.startTag&&Ai(u.startTag),d=u&&u.endTag&&Ai(u.endTag),h=ag(e,o.content);c&&d&&e.file&&(h.position={start:c.end,end:d.start}),l.content=h}return e.schema=r,l}function Hc(e,t,r){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const n=dM(e,r,t.sourceCodeLocation);n&&(e.location=!0,r.position=n)}}function dM(e,t,r){const n=Ai(r);if(t.type==="element"){const s=t.children[t.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),e.verbose){const i={};let l;if(r.attrs)for(l in r.attrs)L_.call(r.attrs,l)&&(i[ch(e.schema,l).property]=Ai(r.attrs[l]));r.startTag;const o=Ai(r.startTag),u=r.endTag?Ai(r.endTag):void 0,c={opening:o};u&&(c.closing=u),c.properties=i,t.data={position:c}}}return n}function Ai(e){const t=Lb({line:e.startLine,column:e.startCol,offset:e.startOffset}),r=Lb({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||r?{start:t,end:r}:void 0}function Lb(e){return e.line&&e.column?e:void 0}const hM={},fM={}.hasOwnProperty,P_=d_("type",{handlers:{root:pM,element:vM,text:yM,comment:bM,doctype:xM}});function mM(e,t){const n=(t||hM).space;return P_(e,n==="svg"?pa:Mu)}function pM(e,t){const r={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=ig(e.children,r,t),Pl(e,r),r}function gM(e,t){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=ig(e.children,r,t),Pl(e,r),r}function xM(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return Pl(e,t),t}function yM(e){const t={nodeName:"#text",value:e.value,parentNode:null};return Pl(e,t),t}function bM(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return Pl(e,t),t}function vM(e,t){const r=t;let n=r;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=pa);const s=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&fM.call(e.properties,i)){const u=wM(n,i,e.properties[i]);u&&s.push(u)}}const l=n.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:s,namespaceURI:Ra[l],childNodes:[],parentNode:null};return o.childNodes=ig(e.children,o,n),Pl(e,o),e.tagName==="template"&&e.content&&(o.content=gM(e.content,n)),o}function wM(e,t,r){const n=ch(e,t);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?wE(r):AE(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=Ra[n.space]}return s}function ig(e,t,r){let n=-1;const s=[];if(e)for(;++n<e.length;){const i=P_(e[n],r);i.parentNode=t,s.push(i)}return s}function Pl(e,t){const r=e.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,t.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const EM=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],_M=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),mt="";var C;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(C||(C={}));const fr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function D_(e){return e>=55296&&e<=57343}function NM(e){return e>=56320&&e<=57343}function kM(e,t){return(e-55296)*1024+9216+t}function M_(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function F_(e){return e>=64976&&e<=65007||_M.has(e)}var J;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(J||(J={}));const SM=65536;class TM{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=SM,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,r){const{line:n,col:s,offset:i}=this,l=s+r,o=i+r;return{code:t,startLine:n,endLine:n,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(NM(r))return this.pos++,this._addGap(),kM(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,C.EOF;return this._err(J.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;const n=this.html.charCodeAt(r);return n===C.CARRIAGE_RETURN?C.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,C.EOF;let t=this.html.charCodeAt(this.pos);return t===C.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,C.LINE_FEED):t===C.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,D_(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===C.LINE_FEED||t===C.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){M_(t)?this._err(J.controlCharacterInInputStream):F_(t)&&this._err(J.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var $e;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})($e||($e={}));function U_(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}const B_=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),CM=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var If;const jM=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),AM=(If=String.fromCodePoint)!==null&&If!==void 0?If:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function IM(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=jM.get(e))!==null&&t!==void 0?t:e}var Ut;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Ut||(Ut={}));const RM=32;var Vs;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Vs||(Vs={}));function pp(e){return e>=Ut.ZERO&&e<=Ut.NINE}function LM(e){return e>=Ut.UPPER_A&&e<=Ut.UPPER_F||e>=Ut.LOWER_A&&e<=Ut.LOWER_F}function OM(e){return e>=Ut.UPPER_A&&e<=Ut.UPPER_Z||e>=Ut.LOWER_A&&e<=Ut.LOWER_Z||pp(e)}function PM(e){return e===Ut.EQUALS||OM(e)}var Dt;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Dt||(Dt={}));var Zn;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Zn||(Zn={}));class H_{constructor(t,r,n){this.decodeTree=t,this.emitCodePoint=r,this.errors=n,this.state=Dt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Zn.Strict}startEntity(t){this.decodeMode=t,this.state=Dt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,r){switch(this.state){case Dt.EntityStart:return t.charCodeAt(r)===Ut.NUM?(this.state=Dt.NumericStart,this.consumed+=1,this.stateNumericStart(t,r+1)):(this.state=Dt.NamedEntity,this.stateNamedEntity(t,r));case Dt.NumericStart:return this.stateNumericStart(t,r);case Dt.NumericDecimal:return this.stateNumericDecimal(t,r);case Dt.NumericHex:return this.stateNumericHex(t,r);case Dt.NamedEntity:return this.stateNamedEntity(t,r)}}stateNumericStart(t,r){return r>=t.length?-1:(t.charCodeAt(r)|RM)===Ut.LOWER_X?(this.state=Dt.NumericHex,this.consumed+=1,this.stateNumericHex(t,r+1)):(this.state=Dt.NumericDecimal,this.stateNumericDecimal(t,r))}addToNumericResult(t,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(r,i),s),this.consumed+=i}}stateNumericHex(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(pp(s)||LM(s))r+=1;else return this.addToNumericResult(t,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,n,r,16),-1}stateNumericDecimal(t,r){const n=r;for(;r<t.length;){const s=t.charCodeAt(r);if(pp(s))r+=1;else return this.addToNumericResult(t,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,n,r,10),-1}emitNumericEntity(t,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Ut.SEMI)this.consumed+=1;else if(this.decodeMode===Zn.Strict)return 0;return this.emitCodePoint(IM(this.result),this.consumed),this.errors&&(t!==Ut.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&Vs.VALUE_LENGTH)>>14;for(;r<t.length;r++,this.excess++){const l=t.charCodeAt(r);if(this.treeIndex=DM(n,s,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===Zn.Attribute&&(i===0||PM(l))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&Vs.VALUE_LENGTH)>>14,i!==0){if(l===Ut.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Zn.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:r,decodeTree:n}=this,s=(n[r]&Vs.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[t]&~Vs.VALUE_LENGTH:s[t+1],n),r===3&&this.emitCodePoint(s[t+2],n),n}end(){var t;switch(this.state){case Dt.NamedEntity:return this.result!==0&&(this.decodeMode!==Zn.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Dt.NumericDecimal:return this.emitNumericEntity(0,2);case Dt.NumericHex:return this.emitNumericEntity(0,3);case Dt.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Dt.EntityStart:return 0}}}function $_(e){let t="";const r=new H_(e,n=>t+=AM(n));return function(s,i){let l=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(l,o),r.startEntity(i);const c=r.write(s,o+1);if(c<0){l=o+r.end();break}l=o+c,o=c===0?l+1:l}const u=t+s.slice(l);return t="",u}}function DM(e,t,r,n){const s=(t&Vs.BRANCH_LENGTH)>>7,i=t&Vs.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const u=n-i;return u<0||u>=s?-1:e[r+u]-1}let l=r,o=l+s-1;for(;l<=o;){const u=l+o>>>1,c=e[u];if(c<n)l=u+1;else if(c>n)o=u-1;else return e[u+s]}return-1}$_(B_);$_(CM);var se;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(se||(se={}));var za;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(za||(za={}));var qr;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(qr||(qr={}));var q;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(q||(q={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(m||(m={}));const MM=new Map([[q.A,m.A],[q.ADDRESS,m.ADDRESS],[q.ANNOTATION_XML,m.ANNOTATION_XML],[q.APPLET,m.APPLET],[q.AREA,m.AREA],[q.ARTICLE,m.ARTICLE],[q.ASIDE,m.ASIDE],[q.B,m.B],[q.BASE,m.BASE],[q.BASEFONT,m.BASEFONT],[q.BGSOUND,m.BGSOUND],[q.BIG,m.BIG],[q.BLOCKQUOTE,m.BLOCKQUOTE],[q.BODY,m.BODY],[q.BR,m.BR],[q.BUTTON,m.BUTTON],[q.CAPTION,m.CAPTION],[q.CENTER,m.CENTER],[q.CODE,m.CODE],[q.COL,m.COL],[q.COLGROUP,m.COLGROUP],[q.DD,m.DD],[q.DESC,m.DESC],[q.DETAILS,m.DETAILS],[q.DIALOG,m.DIALOG],[q.DIR,m.DIR],[q.DIV,m.DIV],[q.DL,m.DL],[q.DT,m.DT],[q.EM,m.EM],[q.EMBED,m.EMBED],[q.FIELDSET,m.FIELDSET],[q.FIGCAPTION,m.FIGCAPTION],[q.FIGURE,m.FIGURE],[q.FONT,m.FONT],[q.FOOTER,m.FOOTER],[q.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[q.FORM,m.FORM],[q.FRAME,m.FRAME],[q.FRAMESET,m.FRAMESET],[q.H1,m.H1],[q.H2,m.H2],[q.H3,m.H3],[q.H4,m.H4],[q.H5,m.H5],[q.H6,m.H6],[q.HEAD,m.HEAD],[q.HEADER,m.HEADER],[q.HGROUP,m.HGROUP],[q.HR,m.HR],[q.HTML,m.HTML],[q.I,m.I],[q.IMG,m.IMG],[q.IMAGE,m.IMAGE],[q.INPUT,m.INPUT],[q.IFRAME,m.IFRAME],[q.KEYGEN,m.KEYGEN],[q.LABEL,m.LABEL],[q.LI,m.LI],[q.LINK,m.LINK],[q.LISTING,m.LISTING],[q.MAIN,m.MAIN],[q.MALIGNMARK,m.MALIGNMARK],[q.MARQUEE,m.MARQUEE],[q.MATH,m.MATH],[q.MENU,m.MENU],[q.META,m.META],[q.MGLYPH,m.MGLYPH],[q.MI,m.MI],[q.MO,m.MO],[q.MN,m.MN],[q.MS,m.MS],[q.MTEXT,m.MTEXT],[q.NAV,m.NAV],[q.NOBR,m.NOBR],[q.NOFRAMES,m.NOFRAMES],[q.NOEMBED,m.NOEMBED],[q.NOSCRIPT,m.NOSCRIPT],[q.OBJECT,m.OBJECT],[q.OL,m.OL],[q.OPTGROUP,m.OPTGROUP],[q.OPTION,m.OPTION],[q.P,m.P],[q.PARAM,m.PARAM],[q.PLAINTEXT,m.PLAINTEXT],[q.PRE,m.PRE],[q.RB,m.RB],[q.RP,m.RP],[q.RT,m.RT],[q.RTC,m.RTC],[q.RUBY,m.RUBY],[q.S,m.S],[q.SCRIPT,m.SCRIPT],[q.SEARCH,m.SEARCH],[q.SECTION,m.SECTION],[q.SELECT,m.SELECT],[q.SOURCE,m.SOURCE],[q.SMALL,m.SMALL],[q.SPAN,m.SPAN],[q.STRIKE,m.STRIKE],[q.STRONG,m.STRONG],[q.STYLE,m.STYLE],[q.SUB,m.SUB],[q.SUMMARY,m.SUMMARY],[q.SUP,m.SUP],[q.TABLE,m.TABLE],[q.TBODY,m.TBODY],[q.TEMPLATE,m.TEMPLATE],[q.TEXTAREA,m.TEXTAREA],[q.TFOOT,m.TFOOT],[q.TD,m.TD],[q.TH,m.TH],[q.THEAD,m.THEAD],[q.TITLE,m.TITLE],[q.TR,m.TR],[q.TRACK,m.TRACK],[q.TT,m.TT],[q.U,m.U],[q.UL,m.UL],[q.SVG,m.SVG],[q.VAR,m.VAR],[q.WBR,m.WBR],[q.XMP,m.XMP]]);function Dl(e){var t;return(t=MM.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const ae=m,FM={[se.HTML]:new Set([ae.ADDRESS,ae.APPLET,ae.AREA,ae.ARTICLE,ae.ASIDE,ae.BASE,ae.BASEFONT,ae.BGSOUND,ae.BLOCKQUOTE,ae.BODY,ae.BR,ae.BUTTON,ae.CAPTION,ae.CENTER,ae.COL,ae.COLGROUP,ae.DD,ae.DETAILS,ae.DIR,ae.DIV,ae.DL,ae.DT,ae.EMBED,ae.FIELDSET,ae.FIGCAPTION,ae.FIGURE,ae.FOOTER,ae.FORM,ae.FRAME,ae.FRAMESET,ae.H1,ae.H2,ae.H3,ae.H4,ae.H5,ae.H6,ae.HEAD,ae.HEADER,ae.HGROUP,ae.HR,ae.HTML,ae.IFRAME,ae.IMG,ae.INPUT,ae.LI,ae.LINK,ae.LISTING,ae.MAIN,ae.MARQUEE,ae.MENU,ae.META,ae.NAV,ae.NOEMBED,ae.NOFRAMES,ae.NOSCRIPT,ae.OBJECT,ae.OL,ae.P,ae.PARAM,ae.PLAINTEXT,ae.PRE,ae.SCRIPT,ae.SECTION,ae.SELECT,ae.SOURCE,ae.STYLE,ae.SUMMARY,ae.TABLE,ae.TBODY,ae.TD,ae.TEMPLATE,ae.TEXTAREA,ae.TFOOT,ae.TH,ae.THEAD,ae.TITLE,ae.TR,ae.TRACK,ae.UL,ae.WBR,ae.XMP]),[se.MATHML]:new Set([ae.MI,ae.MO,ae.MN,ae.MS,ae.MTEXT,ae.ANNOTATION_XML]),[se.SVG]:new Set([ae.TITLE,ae.FOREIGN_OBJECT,ae.DESC]),[se.XLINK]:new Set,[se.XML]:new Set,[se.XMLNS]:new Set},gp=new Set([ae.H1,ae.H2,ae.H3,ae.H4,ae.H5,ae.H6]);q.STYLE,q.SCRIPT,q.XMP,q.IFRAME,q.NOEMBED,q.NOFRAMES,q.PLAINTEXT;var L;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(L||(L={}));const Nt={DATA:L.DATA,RCDATA:L.RCDATA,RAWTEXT:L.RAWTEXT,SCRIPT_DATA:L.SCRIPT_DATA,PLAINTEXT:L.PLAINTEXT,CDATA_SECTION:L.CDATA_SECTION};function UM(e){return e>=C.DIGIT_0&&e<=C.DIGIT_9}function ho(e){return e>=C.LATIN_CAPITAL_A&&e<=C.LATIN_CAPITAL_Z}function BM(e){return e>=C.LATIN_SMALL_A&&e<=C.LATIN_SMALL_Z}function _s(e){return BM(e)||ho(e)}function Ob(e){return _s(e)||UM(e)}function Nc(e){return e+32}function z_(e){return e===C.SPACE||e===C.LINE_FEED||e===C.TABULATION||e===C.FORM_FEED}function Pb(e){return z_(e)||e===C.SOLIDUS||e===C.GREATER_THAN_SIGN}function HM(e){return e===C.NULL?J.nullCharacterReference:e>1114111?J.characterReferenceOutsideUnicodeRange:D_(e)?J.surrogateCharacterReference:F_(e)?J.noncharacterCharacterReference:M_(e)||e===C.CARRIAGE_RETURN?J.controlCharacterReference:null}class $M{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=L.DATA,this.returnState=L.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new TM(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new H_(B_,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(J.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(J.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=HM(n);s&&this._err(s,1)}}:void 0)}_err(t,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(t,r))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:$e.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:$e.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:$e.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:$e.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(U_(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(J.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=Dl(t.tagName),t.type===$e.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(J.endTagWithAttributes),t.selfClosing&&this._err(J.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case $e.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case $e.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case $e.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:$e.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,r)}_emitCodePoint(t){const r=z_(t)?$e.WHITESPACE_CHARACTER:t===C.NULL?$e.NULL_CHARACTER:$e.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken($e.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=L.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?Zn.Attribute:Zn.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===L.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===L.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===L.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case L.DATA:{this._stateData(t);break}case L.RCDATA:{this._stateRcdata(t);break}case L.RAWTEXT:{this._stateRawtext(t);break}case L.SCRIPT_DATA:{this._stateScriptData(t);break}case L.PLAINTEXT:{this._statePlaintext(t);break}case L.TAG_OPEN:{this._stateTagOpen(t);break}case L.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case L.TAG_NAME:{this._stateTagName(t);break}case L.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case L.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case L.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case L.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case L.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case L.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case L.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case L.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case L.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case L.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case L.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case L.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case L.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case L.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case L.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case L.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case L.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case L.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case L.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case L.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case L.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case L.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case L.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case L.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case L.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case L.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case L.BOGUS_COMMENT:{this._stateBogusComment(t);break}case L.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case L.COMMENT_START:{this._stateCommentStart(t);break}case L.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case L.COMMENT:{this._stateComment(t);break}case L.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case L.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case L.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case L.COMMENT_END:{this._stateCommentEnd(t);break}case L.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case L.DOCTYPE:{this._stateDoctype(t);break}case L.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case L.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case L.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case L.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case L.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case L.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case L.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case L.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case L.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case L.CDATA_SECTION:{this._stateCdataSection(t);break}case L.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case L.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case L.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case L.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.TAG_OPEN;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitCodePoint(t);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case C.AMPERSAND:{this._startCharacterReference();break}case C.LESS_THAN_SIGN:{this.state=L.RCDATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.RAWTEXT_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(_s(t))this._createStartTagToken(),this.state=L.TAG_NAME,this._stateTagName(t);else switch(t){case C.EXCLAMATION_MARK:{this.state=L.MARKUP_DECLARATION_OPEN;break}case C.SOLIDUS:{this.state=L.END_TAG_OPEN;break}case C.QUESTION_MARK:{this._err(J.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t);break}case C.EOF:{this._err(J.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(J.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=L.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(_s(t))this._createEndTagToken(),this.state=L.TAG_NAME,this._stateTagName(t);else switch(t){case C.GREATER_THAN_SIGN:{this._err(J.missingEndTagName),this.state=L.DATA;break}case C.EOF:{this._err(J.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(J.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this.state=L.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.tagName+=mt;break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(ho(t)?Nc(t):t)}}_stateRcdataLessThanSign(t){t===C.SOLIDUS?this.state=L.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=L.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){_s(t)?(this.state=L.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=L.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=L.BEFORE_ATTRIBUTE_NAME,!1;case C.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=L.SELF_CLOSING_START_TAG,!1;case C.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=L.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===C.SOLIDUS?this.state=L.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){_s(t)?(this.state=L.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case C.SOLIDUS:{this.state=L.SCRIPT_DATA_END_TAG_OPEN;break}case C.EXCLAMATION_MARK:{this.state=L.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=L.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){_s(t)?(this.state=L.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===C.HYPHEN_MINUS?(this.state=L.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===C.HYPHEN_MINUS?(this.state=L.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=L.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_ESCAPED,this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case C.GREATER_THAN_SIGN:{this.state=L.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_ESCAPED,this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===C.SOLIDUS?this.state=L.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:_s(t)?(this._emitChars("<"),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){_s(t)?(this.state=L.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(fr.SCRIPT,!1)&&Pb(this.preprocessor.peek(fr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<fr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=L.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(J.unexpectedNullCharacter),this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case C.HYPHEN_MINUS:{this._emitChars("-");break}case C.LESS_THAN_SIGN:{this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case C.GREATER_THAN_SIGN:{this.state=L.SCRIPT_DATA,this._emitChars(">");break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(mt);break}case C.EOF:{this._err(J.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===C.SOLIDUS?(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(fr.SCRIPT,!1)&&Pb(this.preprocessor.peek(fr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<fr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=L.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=L.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this.state=L.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._err(J.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=L.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=L.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:case C.SOLIDUS:case C.GREATER_THAN_SIGN:case C.EOF:{this._leaveAttrName(),this.state=L.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case C.EQUALS_SIGN:{this._leaveAttrName(),this.state=L.BEFORE_ATTRIBUTE_VALUE;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:{this._err(J.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.currentAttr.name+=mt;break}default:this.currentAttr.name+=String.fromCodePoint(ho(t)?Nc(t):t)}}_stateAfterAttributeName(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.SOLIDUS:{this.state=L.SELF_CLOSING_START_TAG;break}case C.EQUALS_SIGN:{this.state=L.BEFORE_ATTRIBUTE_VALUE;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=L.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{this.state=L.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this.state=L.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(J.missingAttributeValue),this.state=L.DATA,this.emitCurrentTagToken();break}default:this.state=L.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.currentAttr.value+=mt;break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case C.APOSTROPHE:{this.state=L.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.currentAttr.value+=mt;break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.AMPERSAND:{this._startCharacterReference();break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=L.DATA,this.emitCurrentTagToken();break}case C.NULL:{this._err(J.unexpectedNullCharacter),this.currentAttr.value+=mt;break}case C.QUOTATION_MARK:case C.APOSTROPHE:case C.LESS_THAN_SIGN:case C.EQUALS_SIGN:case C.GRAVE_ACCENT:{this._err(J.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this._leaveAttrValue(),this.state=L.BEFORE_ATTRIBUTE_NAME;break}case C.SOLIDUS:{this._leaveAttrValue(),this.state=L.SELF_CLOSING_START_TAG;break}case C.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this._err(J.missingWhitespaceBetweenAttributes),this.state=L.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case C.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=L.DATA,this.emitCurrentTagToken();break}case C.EOF:{this._err(J.eofInTag),this._emitEOFToken();break}default:this._err(J.unexpectedSolidusInTag),this.state=L.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.data+=mt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(fr.DASH_DASH,!0)?(this._createCommentToken(fr.DASH_DASH.length+1),this.state=L.COMMENT_START):this._consumeSequenceIfMatch(fr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(fr.DOCTYPE.length+1),this.state=L.DOCTYPE):this._consumeSequenceIfMatch(fr.CDATA_START,!0)?this.inForeignNode?this.state=L.CDATA_SECTION:(this._err(J.cdataInHtmlContent),this._createCommentToken(fr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=L.BOGUS_COMMENT):this._ensureHibernation()||(this._err(J.incorrectlyOpenedComment),this._createCommentToken(2),this.state=L.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_START_DASH;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptClosingOfEmptyComment),this.state=L.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=L.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptClosingOfEmptyComment),this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(J.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=L.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END_DASH;break}case C.LESS_THAN_SIGN:{r.data+="<",this.state=L.COMMENT_LESS_THAN_SIGN;break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.data+=mt;break}case C.EOF:{this._err(J.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case C.EXCLAMATION_MARK:{r.data+="!",this.state=L.COMMENT_LESS_THAN_SIGN_BANG;break}case C.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=L.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===C.HYPHEN_MINUS?this.state=L.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=L.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===C.HYPHEN_MINUS?this.state=L.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=L.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==C.GREATER_THAN_SIGN&&t!==C.EOF&&this._err(J.nestedComment),this.state=L.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{this.state=L.COMMENT_END;break}case C.EOF:{this._err(J.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=L.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentComment(r);break}case C.EXCLAMATION_MARK:{this.state=L.COMMENT_END_BANG;break}case C.HYPHEN_MINUS:{r.data+="-";break}case C.EOF:{this._err(J.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=L.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case C.HYPHEN_MINUS:{r.data+="--!",this.state=L.COMMENT_END_DASH;break}case C.GREATER_THAN_SIGN:{this._err(J.incorrectlyClosedComment),this.state=L.DATA,this.emitCurrentComment(r);break}case C.EOF:{this._err(J.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=L.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=L.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case C.EOF:{this._err(J.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingWhitespaceBeforeDoctypeName),this.state=L.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(ho(t))this._createDoctypeToken(String.fromCharCode(Nc(t))),this.state=L.DOCTYPE_NAME;else switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.NULL:{this._err(J.unexpectedNullCharacter),this._createDoctypeToken(mt),this.state=L.DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this._err(J.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=L.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.AFTER_DOCTYPE_NAME;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.name+=mt;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(ho(t)?Nc(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(fr.PUBLIC,!1)?this.state=L.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(fr.SYSTEM,!1)?this.state=L.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(J.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(J.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(J.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(J.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.publicId="",this.state=L.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(J.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.publicId+=mt;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=L.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.publicId+=mt;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case C.GREATER_THAN_SIGN:{this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.QUOTATION_MARK:{this._err(J.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(J.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.QUOTATION_MARK:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:{this.state=L.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.QUOTATION_MARK:{this._err(J.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{this._err(J.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(J.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.QUOTATION_MARK:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case C.APOSTROPHE:{r.systemId="",this.state=L.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case C.GREATER_THAN_SIGN:{this._err(J.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.DATA,this.emitCurrentDoctype(r);break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case C.QUOTATION_MARK:{this.state=L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.systemId+=mt;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case C.APOSTROPHE:{this.state=L.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case C.NULL:{this._err(J.unexpectedNullCharacter),r.systemId+=mt;break}case C.GREATER_THAN_SIGN:{this._err(J.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case C.SPACE:case C.LINE_FEED:case C.TABULATION:case C.FORM_FEED:break;case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.EOF:{this._err(J.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(J.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=L.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case C.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=L.DATA;break}case C.NULL:{this._err(J.unexpectedNullCharacter);break}case C.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case C.RIGHT_SQUARE_BRACKET:{this.state=L.CDATA_SECTION_BRACKET;break}case C.EOF:{this._err(J.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===C.RIGHT_SQUARE_BRACKET?this.state=L.CDATA_SECTION_END:(this._emitChars("]"),this.state=L.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case C.GREATER_THAN_SIGN:{this.state=L.DATA;break}case C.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=L.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(C.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&Ob(this.preprocessor.peek(1))?L.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){Ob(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===C.SEMICOLON&&this._err(J.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const q_=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),Db=new Set([...q_,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),Nd=new Set([m.APPLET,m.CAPTION,m.HTML,m.MARQUEE,m.OBJECT,m.TABLE,m.TD,m.TEMPLATE,m.TH]),zM=new Set([...Nd,m.OL,m.UL]),qM=new Set([...Nd,m.BUTTON]),Mb=new Set([m.ANNOTATION_XML,m.MI,m.MN,m.MO,m.MS,m.MTEXT]),Fb=new Set([m.DESC,m.FOREIGN_OBJECT,m.TITLE]),VM=new Set([m.TR,m.TEMPLATE,m.HTML]),WM=new Set([m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML]),GM=new Set([m.TABLE,m.TEMPLATE,m.HTML]),YM=new Set([m.TD,m.TH]);class QM{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===se.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const s=this._indexOf(t)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==se.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(gp,se.HTML)}popUntilTableCellPopped(){this.popUntilPopped(YM,se.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(GM,se.HTML)}clearBackToTableBodyContext(){this.clearBackTo(WM,se.HTML)}clearBackToTableRowContext(){this.clearBackTo(VM,se.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInDynamicScope(t,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case se.HTML:{if(s===t)return!0;if(r.has(s))return!1;break}case se.SVG:{if(Fb.has(s))return!1;break}case se.MATHML:{if(Mb.has(s))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,Nd)}hasInListItemScope(t){return this.hasInDynamicScope(t,zM)}hasInButtonScope(t){return this.hasInDynamicScope(t,qM)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case se.HTML:{if(gp.has(r))return!0;if(Nd.has(r))return!1;break}case se.SVG:{if(Fb.has(r))return!1;break}case se.MATHML:{if(Mb.has(r))return!1;break}}}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===se.HTML)switch(this.tagIDs[r]){case t:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===se.HTML)switch(this.tagIDs[t]){case m.TBODY:case m.THEAD:case m.TFOOT:return!0;case m.TABLE:case m.HTML:return!1}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===se.HTML)switch(this.tagIDs[r]){case t:return!0;case m.OPTION:case m.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;q_.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Db.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&Db.has(this.currentTagId);)this.pop()}}const Rf=3;var jn;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(jn||(jn={}));const Ub={type:jn.Marker};class KM{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const u=this.entries[o];if(u.type===jn.Marker)break;const{element:c}=u;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===l){const d=this.treeAdapter.getAttrList(c);d.length===s&&n.push({idx:o,attrs:d})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<Rf)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<Rf)return;const s=new Map(r.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<n.length;l++){const o=n[l];o.attrs.every(u=>s.get(u.name)===u.value)&&(i+=1,i>=Rf&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(Ub)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:jn.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:jn.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(Ub);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===jn.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===jn.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===jn.Element&&r.element===t)}}const Ns={createDocument(){return{nodeName:"#document",mode:qr.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const s=e.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=t,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Ns.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Ns.isTextNode(r)){r.value+=t;return}}Ns.appendChild(e,Ns.createTextNode(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Ns.isTextNode(n)?n.value+=t:Ns.insertBefore(e,Ns.createTextNode(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},V_="html",ZM="about:legacy-compat",XM="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",W_=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],JM=[...W_,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],e8=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),G_=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],t8=[...G_,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Bb(e,t){return t.some(r=>e.startsWith(r))}function r8(e){return e.name===V_&&e.publicId===null&&(e.systemId===null||e.systemId===ZM)}function n8(e){if(e.name!==V_)return qr.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===XM)return qr.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),e8.has(r))return qr.QUIRKS;let n=t===null?JM:W_;if(Bb(r,n))return qr.QUIRKS;if(n=t===null?G_:t8,Bb(r,n))return qr.LIMITED_QUIRKS}return qr.NO_QUIRKS}const Hb={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},s8="definitionurl",a8="definitionURL",i8=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),l8=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:se.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:se.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:se.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:se.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:se.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:se.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:se.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:se.XML}],["xml:space",{prefix:"xml",name:"space",namespace:se.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:se.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:se.XMLNS}]]),o8=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),u8=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function c8(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===za.COLOR||n===za.SIZE||n===za.FACE)||u8.has(t)}function Y_(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===s8){e.attrs[t].name=a8;break}}function Q_(e){for(let t=0;t<e.attrs.length;t++){const r=i8.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function lg(e){for(let t=0;t<e.attrs.length;t++){const r=l8.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function d8(e){const t=o8.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=Dl(e.tagName))}function h8(e,t){return t===se.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function f8(e,t,r){if(t===se.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===za.ENCODING){const s=r[n].value.toLowerCase();return s===Hb.TEXT_HTML||s===Hb.APPLICATION_XML}}return t===se.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function m8(e,t,r,n){return(!n||n===se.HTML)&&f8(e,t,r)||(!n||n===se.MATHML)&&h8(e,t)}const p8="hidden",g8=8,x8=3;var P;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(P||(P={}));const y8={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},K_=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),$b={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Ns,onParseError:null};class zb{constructor(t,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=P.INITIAL,this.originalInsertionMode=P.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...$b,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new $M(this.options,this),this.activeFormattingElements=new KM(this.treeAdapter),this.fragmentContextID=n?Dl(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new QM(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...$b,...r};t??(t=n.treeAdapter.createElement(q.TEMPLATE,se.HTML,[]));const s=n.treeAdapter.createElement("documentmock",se.HTML,[]),i=new this(n,s,t);return i.fragmentContextID===m.TEMPLATE&&i.tmplInsertionModeStack.unshift(P.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var s;if(!this.onParseError)return;const i=(s=t.location)!==null&&s!==void 0?s:y8,l={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,t,this.openElements.current),r){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===se.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,se.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=P.TEXT}switchToPlaintextParsing(){this.insertionMode=P.TEXT,this.originalInsertionMode=P.IN_BODY,this.tokenizer.state=Nt.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===q.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==se.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=Nt.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=Nt.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=Nt.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=Nt.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",s=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,se.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,se.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(q.HTML,se.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,l=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:u,endCol:c,endOffset:d}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(t),i=r.type===$e.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===q.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===se.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,se.HTML)}_processToken(t){switch(t.type){case $e.CHARACTER:{this.onCharacter(t);break}case $e.NULL_CHARACTER:{this.onNullCharacter(t);break}case $e.COMMENT:{this.onComment(t);break}case $e.DOCTYPE:{this.onDoctype(t);break}case $e.START_TAG:{this._processStartTag(t);break}case $e.END_TAG:{this.onEndTag(t);break}case $e.EOF:{this.onEof(t);break}case $e.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return m8(t,s,i,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===jn.Marker||this.openElements.contains(s.element)),n=r<0?t-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=P.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=P.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=P.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=P.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=P.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=P.IN_TABLE;return}case m.BODY:{this.insertionMode=P.IN_BODY;return}case m.FRAMESET:{this.insertionMode=P.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?P.AFTER_HEAD:P.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=P.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=P.IN_HEAD;return}break}}this.insertionMode=P.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=P.IN_SELECT_IN_TABLE;return}}this.insertionMode=P.IN_SELECT}_isElementCausesFosterParenting(t){return K_.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===se.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return FM[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Y9(this,t);return}switch(this.insertionMode){case P.INITIAL:{to(this,t);break}case P.BEFORE_HTML:{Ro(this,t);break}case P.BEFORE_HEAD:{Lo(this,t);break}case P.IN_HEAD:{Oo(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Po(this,t);break}case P.AFTER_HEAD:{Do(this,t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:{X_(this,t);break}case P.TEXT:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{Lf(this,t);break}case P.IN_TABLE_TEXT:{sN(this,t);break}case P.IN_COLUMN_GROUP:{kd(this,t);break}case P.AFTER_BODY:{Sd(this,t);break}case P.AFTER_AFTER_BODY:{$c(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){G9(this,t);return}switch(this.insertionMode){case P.INITIAL:{to(this,t);break}case P.BEFORE_HTML:{Ro(this,t);break}case P.BEFORE_HEAD:{Lo(this,t);break}case P.IN_HEAD:{Oo(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Po(this,t);break}case P.AFTER_HEAD:{Do(this,t);break}case P.TEXT:{this._insertCharacters(t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{Lf(this,t);break}case P.IN_COLUMN_GROUP:{kd(this,t);break}case P.AFTER_BODY:{Sd(this,t);break}case P.AFTER_AFTER_BODY:{$c(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){xp(this,t);return}switch(this.insertionMode){case P.INITIAL:case P.BEFORE_HTML:case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_TEMPLATE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{xp(this,t);break}case P.IN_TABLE_TEXT:{ro(this,t);break}case P.AFTER_BODY:{k8(this,t);break}case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{S8(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case P.INITIAL:{T8(this,t);break}case P.BEFORE_HEAD:case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:{this._err(t,J.misplacedDoctype);break}case P.IN_TABLE_TEXT:{ro(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,J.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?Q9(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{to(this,t);break}case P.BEFORE_HTML:{C8(this,t);break}case P.BEFORE_HEAD:{A8(this,t);break}case P.IN_HEAD:{yn(this,t);break}case P.IN_HEAD_NO_SCRIPT:{L8(this,t);break}case P.AFTER_HEAD:{P8(this,t);break}case P.IN_BODY:{Jt(this,t);break}case P.IN_TABLE:{yl(this,t);break}case P.IN_TABLE_TEXT:{ro(this,t);break}case P.IN_CAPTION:{I9(this,t);break}case P.IN_COLUMN_GROUP:{cg(this,t);break}case P.IN_TABLE_BODY:{vh(this,t);break}case P.IN_ROW:{wh(this,t);break}case P.IN_CELL:{O9(this,t);break}case P.IN_SELECT:{lN(this,t);break}case P.IN_SELECT_IN_TABLE:{D9(this,t);break}case P.IN_TEMPLATE:{F9(this,t);break}case P.AFTER_BODY:{B9(this,t);break}case P.IN_FRAMESET:{H9(this,t);break}case P.AFTER_FRAMESET:{z9(this,t);break}case P.AFTER_AFTER_BODY:{V9(this,t);break}case P.AFTER_AFTER_FRAMESET:{W9(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?K9(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case P.INITIAL:{to(this,t);break}case P.BEFORE_HTML:{j8(this,t);break}case P.BEFORE_HEAD:{I8(this,t);break}case P.IN_HEAD:{R8(this,t);break}case P.IN_HEAD_NO_SCRIPT:{O8(this,t);break}case P.AFTER_HEAD:{D8(this,t);break}case P.IN_BODY:{bh(this,t);break}case P.TEXT:{w9(this,t);break}case P.IN_TABLE:{uu(this,t);break}case P.IN_TABLE_TEXT:{ro(this,t);break}case P.IN_CAPTION:{R9(this,t);break}case P.IN_COLUMN_GROUP:{L9(this,t);break}case P.IN_TABLE_BODY:{yp(this,t);break}case P.IN_ROW:{iN(this,t);break}case P.IN_CELL:{P9(this,t);break}case P.IN_SELECT:{oN(this,t);break}case P.IN_SELECT_IN_TABLE:{M9(this,t);break}case P.IN_TEMPLATE:{U9(this,t);break}case P.AFTER_BODY:{cN(this,t);break}case P.IN_FRAMESET:{$9(this,t);break}case P.AFTER_FRAMESET:{q9(this,t);break}case P.AFTER_AFTER_BODY:{$c(this,t);break}}}onEof(t){switch(this.insertionMode){case P.INITIAL:{to(this,t);break}case P.BEFORE_HTML:{Ro(this,t);break}case P.BEFORE_HEAD:{Lo(this,t);break}case P.IN_HEAD:{Oo(this,t);break}case P.IN_HEAD_NO_SCRIPT:{Po(this,t);break}case P.AFTER_HEAD:{Do(this,t);break}case P.IN_BODY:case P.IN_TABLE:case P.IN_CAPTION:case P.IN_COLUMN_GROUP:case P.IN_TABLE_BODY:case P.IN_ROW:case P.IN_CELL:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:{rN(this,t);break}case P.TEXT:{E9(this,t);break}case P.IN_TABLE_TEXT:{ro(this,t);break}case P.IN_TEMPLATE:{uN(this,t);break}case P.AFTER_BODY:case P.IN_FRAMESET:case P.AFTER_FRAMESET:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{ug(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===C.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case P.IN_HEAD:case P.IN_HEAD_NO_SCRIPT:case P.AFTER_HEAD:case P.TEXT:case P.IN_COLUMN_GROUP:case P.IN_SELECT:case P.IN_SELECT_IN_TABLE:case P.IN_FRAMESET:case P.AFTER_FRAMESET:{this._insertCharacters(t);break}case P.IN_BODY:case P.IN_CAPTION:case P.IN_CELL:case P.IN_TEMPLATE:case P.AFTER_BODY:case P.AFTER_AFTER_BODY:case P.AFTER_AFTER_FRAMESET:{Z_(this,t);break}case P.IN_TABLE:case P.IN_TABLE_BODY:case P.IN_ROW:{Lf(this,t);break}case P.IN_TABLE_TEXT:{nN(this,t);break}}}}function b8(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):tN(e,t),r}function v8(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const s=e.openElements.items[n];if(s===t.element)break;e._isSpecialElement(s,e.openElements.tagIDs[n])&&(r=s)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function w8(e,t,r){let n=t,s=e.openElements.getCommonAncestor(t);for(let i=0,l=s;l!==r;i++,l=s){s=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),u=o&&i>=x8;!o||u?(u&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=E8(e,o),n===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function E8(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function _8(e,t,r){const n=e.treeAdapter.getTagName(t),s=Dl(n);if(e._isElementCausesFosterParenting(s))e._fosterParentElement(r);else{const i=e.treeAdapter.getNamespaceURI(t);s===m.TEMPLATE&&i===se.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function N8(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=e.treeAdapter.createElement(s.tagName,n,s.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,s),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,i,s.tagID)}function og(e,t){for(let r=0;r<g8;r++){const n=b8(e,t);if(!n)break;const s=v8(e,n);if(!s)break;e.activeFormattingElements.bookmark=n;const i=w8(e,s,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),l&&_8(e,l,i),N8(e,s,n)}}function xp(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function k8(e,t){e._appendCommentNode(t,e.openElements.items[0])}function S8(e,t){e._appendCommentNode(t,e.document)}function ug(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],s=e.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function T8(e,t){e._setDocumentType(t);const r=t.forceQuirks?qr.QUIRKS:n8(t);r8(t)||e._err(t,J.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=P.BEFORE_HTML}function to(e,t){e._err(t,J.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,qr.QUIRKS),e.insertionMode=P.BEFORE_HTML,e._processToken(t)}function C8(e,t){t.tagID===m.HTML?(e._insertElement(t,se.HTML),e.insertionMode=P.BEFORE_HEAD):Ro(e,t)}function j8(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&Ro(e,t)}function Ro(e,t){e._insertFakeRootElement(),e.insertionMode=P.BEFORE_HEAD,e._processToken(t)}function A8(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.HEAD:{e._insertElement(t,se.HTML),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD;break}default:Lo(e,t)}}function I8(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?Lo(e,t):e._err(t,J.endTagWithoutMatchingOpenElement)}function Lo(e,t){e._insertFakeElement(q.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=P.IN_HEAD,e._processToken(t)}function yn(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,se.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,Nt.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Nt.RAWTEXT):(e._insertElement(t,se.HTML),e.insertionMode=P.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,Nt.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,Nt.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=P.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(P.IN_TEMPLATE);break}case m.HEAD:{e._err(t,J.misplacedStartTagForHeadElement);break}default:Oo(e,t)}}function R8(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=P.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{Oo(e,t);break}case m.TEMPLATE:{oi(e,t);break}default:e._err(t,J.endTagWithoutMatchingOpenElement)}}function oi(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,J.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,J.endTagWithoutMatchingOpenElement)}function Oo(e,t){e.openElements.pop(),e.insertionMode=P.AFTER_HEAD,e._processToken(t)}function L8(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{yn(e,t);break}case m.NOSCRIPT:{e._err(t,J.nestedNoscriptInHead);break}default:Po(e,t)}}function O8(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=P.IN_HEAD;break}case m.BR:{Po(e,t);break}default:e._err(t,J.endTagWithoutMatchingOpenElement)}}function Po(e,t){const r=t.type===$e.EOF?J.openElementsLeftAfterEof:J.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=P.IN_HEAD,e._processToken(t)}function P8(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.BODY:{e._insertElement(t,se.HTML),e.framesetOk=!1,e.insertionMode=P.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,se.HTML),e.insertionMode=P.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,J.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),yn(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,J.misplacedStartTagForHeadElement);break}default:Do(e,t)}}function D8(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{Do(e,t);break}case m.TEMPLATE:{oi(e,t);break}default:e._err(t,J.endTagWithoutMatchingOpenElement)}}function Do(e,t){e._insertFakeElement(q.BODY,m.BODY),e.insertionMode=P.IN_BODY,yh(e,t)}function yh(e,t){switch(t.type){case $e.CHARACTER:{X_(e,t);break}case $e.WHITESPACE_CHARACTER:{Z_(e,t);break}case $e.COMMENT:{xp(e,t);break}case $e.START_TAG:{Jt(e,t);break}case $e.END_TAG:{bh(e,t);break}case $e.EOF:{rN(e,t);break}}}function Z_(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function X_(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function M8(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function F8(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function U8(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_FRAMESET)}function B8(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML)}function H8(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),gp.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,se.HTML)}function $8(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function z8(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML),r||(e.formElement=e.openElements.current))}function q8(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const s=e.openElements.tagIDs[n];if(r===m.LI&&s===m.LI||(r===m.DD||r===m.DT)&&(s===m.DD||s===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s);break}if(s!==m.ADDRESS&&s!==m.DIV&&s!==m.P&&e._isSpecialElement(e.openElements.items[n],s))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML)}function V8(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML),e.tokenizer.state=Nt.PLAINTEXT}function W8(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML),e.framesetOk=!1}function G8(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(q.A);r&&(og(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Y8(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Q8(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(og(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,se.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function K8(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function Z8(e,t){e.treeAdapter.getDocumentMode(e.document)!==qr.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,se.HTML),e.framesetOk=!1,e.insertionMode=P.IN_TABLE}function J_(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,se.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function eN(e){const t=U_(e,za.TYPE);return t!=null&&t.toLowerCase()===p8}function X8(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,se.HTML),eN(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function J8(e,t){e._appendElement(t,se.HTML),t.ackSelfClosing=!0}function e9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,se.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function t9(e,t){t.tagName=q.IMG,t.tagID=m.IMG,J_(e,t)}function r9(e,t){e._insertElement(t,se.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Nt.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=P.TEXT}function n9(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Nt.RAWTEXT)}function s9(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Nt.RAWTEXT)}function qb(e,t){e._switchToTextParsing(t,Nt.RAWTEXT)}function a9(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===P.IN_TABLE||e.insertionMode===P.IN_CAPTION||e.insertionMode===P.IN_TABLE_BODY||e.insertionMode===P.IN_ROW||e.insertionMode===P.IN_CELL?P.IN_SELECT_IN_TABLE:P.IN_SELECT}function i9(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML)}function l9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,se.HTML)}function o9(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,se.HTML)}function u9(e,t){e._reconstructActiveFormattingElements(),Y_(t),lg(t),t.selfClosing?e._appendElement(t,se.MATHML):e._insertElement(t,se.MATHML),t.ackSelfClosing=!0}function c9(e,t){e._reconstructActiveFormattingElements(),Q_(t),lg(t),t.selfClosing?e._appendElement(t,se.SVG):e._insertElement(t,se.SVG),t.ackSelfClosing=!0}function Vb(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,se.HTML)}function Jt(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{Y8(e,t);break}case m.A:{G8(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{H8(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{B8(e,t);break}case m.LI:case m.DD:case m.DT:{q8(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{J_(e,t);break}case m.HR:{e9(e,t);break}case m.RB:case m.RTC:{l9(e,t);break}case m.RT:case m.RP:{o9(e,t);break}case m.PRE:case m.LISTING:{$8(e,t);break}case m.XMP:{n9(e,t);break}case m.SVG:{c9(e,t);break}case m.HTML:{M8(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{yn(e,t);break}case m.BODY:{F8(e,t);break}case m.FORM:{z8(e,t);break}case m.NOBR:{Q8(e,t);break}case m.MATH:{u9(e,t);break}case m.TABLE:{Z8(e,t);break}case m.INPUT:{X8(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{J8(e,t);break}case m.IMAGE:{t9(e,t);break}case m.BUTTON:{W8(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{K8(e,t);break}case m.IFRAME:{s9(e,t);break}case m.SELECT:{a9(e,t);break}case m.OPTION:case m.OPTGROUP:{i9(e,t);break}case m.NOEMBED:case m.NOFRAMES:{qb(e,t);break}case m.FRAMESET:{U8(e,t);break}case m.TEXTAREA:{r9(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?qb(e,t):Vb(e,t);break}case m.PLAINTEXT:{V8(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:Vb(e,t)}}function d9(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function h9(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=P.AFTER_BODY,cN(e,t))}function f9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function m9(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function p9(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(q.P,m.P),e._closePElement()}function g9(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function x9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function y9(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function b9(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function v9(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(q.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function tN(e,t){const r=t.tagName,n=t.tagID;for(let s=e.openElements.stackTop;s>0;s--){const i=e.openElements.items[s],l=e.openElements.tagIDs[s];if(n===l&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(i)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=s&&e.openElements.shortenToLength(s);break}if(e._isSpecialElement(i,l))break}}function bh(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{og(e,t);break}case m.P:{p9(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SEARCH:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{f9(e,t);break}case m.LI:{g9(e);break}case m.DD:case m.DT:{x9(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{y9(e);break}case m.BR:{v9(e);break}case m.BODY:{d9(e,t);break}case m.HTML:{h9(e,t);break}case m.FORM:{m9(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{b9(e,t);break}case m.TEMPLATE:{oi(e,t);break}default:tN(e,t)}}function rN(e,t){e.tmplInsertionModeStack.length>0?uN(e,t):ug(e,t)}function w9(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function E9(e,t){e._err(t,J.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function Lf(e,t){if(K_.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=P.IN_TABLE_TEXT,t.type){case $e.CHARACTER:{sN(e,t);break}case $e.WHITESPACE_CHARACTER:{nN(e,t);break}}else Bu(e,t)}function _9(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_CAPTION}function N9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_COLUMN_GROUP}function k9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(q.COLGROUP,m.COLGROUP),e.insertionMode=P.IN_COLUMN_GROUP,cg(e,t)}function S9(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_TABLE_BODY}function T9(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(q.TBODY,m.TBODY),e.insertionMode=P.IN_TABLE_BODY,vh(e,t)}function C9(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function j9(e,t){eN(t)?e._appendElement(t,se.HTML):Bu(e,t),t.ackSelfClosing=!0}function A9(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,se.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function yl(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{T9(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{yn(e,t);break}case m.COL:{k9(e,t);break}case m.FORM:{A9(e,t);break}case m.TABLE:{C9(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{S9(e,t);break}case m.INPUT:{j9(e,t);break}case m.CAPTION:{_9(e,t);break}case m.COLGROUP:{N9(e,t);break}default:Bu(e,t)}}function uu(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{oi(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Bu(e,t)}}function Bu(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,yh(e,t),e.fosterParentingEnabled=r}function nN(e,t){e.pendingCharacterTokens.push(t)}function sN(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function ro(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)Bu(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const aN=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function I9(e,t){const r=t.tagID;aN.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,yl(e,t)):Jt(e,t)}function R9(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_TABLE,r===m.TABLE&&uu(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:bh(e,t)}}function cg(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.COL:{e._appendElement(t,se.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{yn(e,t);break}default:kd(e,t)}}function L9(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TEMPLATE:{oi(e,t);break}case m.COL:break;default:kd(e,t)}}function kd(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=P.IN_TABLE,e._processToken(t))}function vh(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(q.TR,m.TR),e.insertionMode=P.IN_ROW,wh(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,yl(e,t));break}default:yl(e,t)}}function yp(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE,uu(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:uu(e,t)}}function wh(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,se.HTML),e.insertionMode=P.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,vh(e,t));break}default:yl(e,t)}}function iN(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,yp(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=P.IN_TABLE_BODY,yp(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:uu(e,t)}}function O9(e,t){const r=t.tagID;aN.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),wh(e,t)):Jt(e,t)}function P9(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=P.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),iN(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:bh(e,t)}}function lN(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,se.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,se.HTML);break}case m.HR:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._appendElement(t,se.HTML),t.ackSelfClosing=!0;break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{yn(e,t);break}}}function oN(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{oi(e,t);break}}}function D9(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):lN(e,t)}function M9(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):oN(e,t)}function F9(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{yn(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=P.IN_TABLE,e.insertionMode=P.IN_TABLE,yl(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=P.IN_COLUMN_GROUP,e.insertionMode=P.IN_COLUMN_GROUP,cg(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=P.IN_TABLE_BODY,e.insertionMode=P.IN_TABLE_BODY,vh(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=P.IN_ROW,e.insertionMode=P.IN_ROW,wh(e,t);break}default:e.tmplInsertionModeStack[0]=P.IN_BODY,e.insertionMode=P.IN_BODY,Jt(e,t)}}function U9(e,t){t.tagID===m.TEMPLATE&&oi(e,t)}function uN(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):ug(e,t)}function B9(e,t){t.tagID===m.HTML?Jt(e,t):Sd(e,t)}function cN(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=P.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else Sd(e,t)}function Sd(e,t){e.insertionMode=P.IN_BODY,yh(e,t)}function H9(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.FRAMESET:{e._insertElement(t,se.HTML);break}case m.FRAME:{e._appendElement(t,se.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{yn(e,t);break}}}function $9(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=P.AFTER_FRAMESET))}function z9(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.NOFRAMES:{yn(e,t);break}}}function q9(e,t){t.tagID===m.HTML&&(e.insertionMode=P.AFTER_AFTER_FRAMESET)}function V9(e,t){t.tagID===m.HTML?Jt(e,t):$c(e,t)}function $c(e,t){e.insertionMode=P.IN_BODY,yh(e,t)}function W9(e,t){switch(t.tagID){case m.HTML:{Jt(e,t);break}case m.NOFRAMES:{yn(e,t);break}}}function G9(e,t){t.chars=mt,e._insertCharacters(t)}function Y9(e,t){e._insertCharacters(t),e.framesetOk=!1}function dN(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==se.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function Q9(e,t){if(c8(t))dN(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===se.MATHML?Y_(t):n===se.SVG&&(d8(t),Q_(t)),lg(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function K9(e,t){if(t.tagID===m.P||t.tagID===m.BR){dN(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===se.HTML){e._endTagOutsideForeignContent(t);break}const s=e.treeAdapter.getTagName(n);if(s.toLowerCase()===t.tagName){t.tagName=s,e.openElements.shortenToLength(r);break}}}q.AREA,q.BASE,q.BASEFONT,q.BGSOUND,q.BR,q.COL,q.EMBED,q.FRAME,q.HR,q.IMG,q.INPUT,q.KEYGEN,q.LINK,q.META,q.PARAM,q.SOURCE,q.TRACK,q.WBR;const Z9=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,X9=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),Wb={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function hN(e,t){const r=o7(e),n=d_("type",{handlers:{root:J9,element:e7,text:t7,comment:mN,doctype:r7,raw:s7},unknown:a7}),s={parser:r?new zb(Wb):zb.getFragmentParser(void 0,Wb),handle(o){n(o,s)},stitches:!1,options:t||{}};n(e,s),Ml(s,Fn());const i=r?s.parser.document:s.parser.getFragment(),l=uM(i,{file:s.options.file});return s.stitches&&xh(l,"comment",function(o,u,c){const d=o;if(d.value.stitch&&c&&u!==void 0){const h=c.children;return h[u]=d.value.stitch,u}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function fN(e,t){let r=-1;if(e)for(;++r<e.length;)t.handle(e[r])}function J9(e,t){fN(e.children,t)}function e7(e,t){i7(e,t),fN(e.children,t),l7(e,t)}function t7(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const r={type:$e.CHARACTER,chars:e.value,location:Hu(e)};Ml(t,Fn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function r7(e,t){const r={type:$e.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:Hu(e)};Ml(t,Fn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function n7(e,t){t.stitches=!0;const r=u7(e);if("children"in e&&"children"in r){const n=hN({type:"root",children:e.children},t.options);r.children=n.children}mN({type:"comment",value:{stitch:r}},t)}function mN(e,t){const r=e.value,n={type:$e.COMMENT,data:r,location:Hu(e)};Ml(t,Fn(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function s7(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,pN(t,Fn(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(Z9,"<$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=t.parser.tokenizer._consume();t.parser.tokenizer._callState(r)}}function a7(e,t){const r=e;if(t.options.passThrough&&t.options.passThrough.includes(r.type))n7(r,t);else{let n="";throw X9.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function Ml(e,t){pN(e,t);const r=e.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=e.parser.tokenizer.preprocessor.line,r.location.endCol=e.parser.tokenizer.preprocessor.col+1,r.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Nt.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function pN(e,t){if(t&&t.offset!==void 0){const r={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=r}}function i7(e,t){const r=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Nt.PLAINTEXT)return;Ml(t,Fn(e));const n=t.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:Ra.html;s===Ra.html&&r==="svg"&&(s=Ra.svg);const i=mM({...e,children:[]},{space:s===Ra.svg?"svg":"html"}),l={type:$e.START_TAG,tagName:r,tagID:Dl(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:Hu(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=r}function l7(e,t){const r=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&EM.includes(r)||t.parser.tokenizer.state===Nt.PLAINTEXT)return;Ml(t,dh(e));const n={type:$e.END_TAG,tagName:r,tagID:Dl(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:Hu(e)};t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken),r===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Nt.RCDATA||t.parser.tokenizer.state===Nt.RAWTEXT||t.parser.tokenizer.state===Nt.SCRIPT_DATA)&&(t.parser.tokenizer.state=Nt.DATA)}function o7(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function Hu(e){const t=Fn(e)||{line:void 0,column:void 0,offset:void 0},r=dh(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function u7(e){return"children"in e?ei({...e,children:[]}):ei(e)}function gN(e){return function(t,r){return hN(t,{...e,file:r})}}const wa=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],Gb={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...wa,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...wa],h2:[["className","sr-only"]],img:[...wa,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...wa,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...wa],table:[...wa],ul:[...wa,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Cs={}.hasOwnProperty;function c7(e,t){let r={type:"root",children:[]};const n={schema:t?{...Gb,...t}:Gb,stack:[]},s=xN(n,e);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function xN(e,t){if(t&&typeof t=="object"){const r=t;switch(typeof r.type=="string"?r.type:""){case"comment":return d7(e,r);case"doctype":return h7(e,r);case"element":return f7(e,r);case"root":return m7(e,r);case"text":return p7(e,r)}}}function d7(e,t){if(e.schema.allowComments){const r=typeof t.value=="string"?t.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return $u(i,t),i}}function h7(e,t){if(e.schema.allowDoctypes){const r={type:"doctype"};return $u(r,t),r}}function f7(e,t){const r=typeof t.tagName=="string"?t.tagName:"";e.stack.push(r);const n=yN(e,t.children),s=g7(e,t.properties);e.stack.pop();let i=!1;if(r&&r!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(r))&&(i=!0,e.schema.ancestors&&Cs.call(e.schema.ancestors,r))){const o=e.schema.ancestors[r];let u=-1;for(i=!1;++u<o.length;)e.stack.includes(o[u])&&(i=!0)}if(!i)return e.schema.strip&&!e.schema.strip.includes(r)?n:void 0;const l={type:"element",tagName:r,properties:s,children:n};return $u(l,t),l}function m7(e,t){const n={type:"root",children:yN(e,t.children)};return $u(n,t),n}function p7(e,t){const n={type:"text",value:typeof t.value=="string"?t.value:""};return $u(n,t),n}function yN(e,t){const r=[];if(Array.isArray(t)){const n=t;let s=-1;for(;++s<n.length;){const i=xN(e,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function g7(e,t){const r=e.stack[e.stack.length-1],n=e.schema.attributes,s=e.schema.required,i=n&&Cs.call(n,r)?n[r]:void 0,l=n&&Cs.call(n,"*")?n["*"]:void 0,o=t&&typeof t=="object"?t:{},u={};let c;for(c in o)if(Cs.call(o,c)){const d=o[c];let h=Yb(e,Qb(i,c),c,d);h==null&&(h=Yb(e,Qb(l,c),c,d)),h!=null&&(u[c]=h)}if(s&&Cs.call(s,r)){const d=s[r];for(c in d)Cs.call(d,c)&&!Cs.call(u,c)&&(u[c]=d[c])}return u}function Yb(e,t,r,n){return t?Array.isArray(n)?x7(e,t,r,n):bN(e,t,r,n):void 0}function x7(e,t,r,n){let s=-1;const i=[];for(;++s<n.length;){const l=bN(e,t,r,n[s]);(typeof l=="number"||typeof l=="string")&&i.push(l)}return i}function bN(e,t,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&y7(e,r,n)){if(typeof t=="object"&&t.length>1){let s=!1,i=0;for(;++i<t.length;){const l=t[i];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(n))){s=!0;break}}else if(l===n){s=!0;break}}if(!s)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(r)?e.schema.clobberPrefix+n:n}}function y7(e,t,r){const n=e.schema.protocols&&Cs.call(e.schema.protocols,t)?e.schema.protocols[t]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),l=s.indexOf("?"),o=s.indexOf("#"),u=s.indexOf("/");if(i<0||u>-1&&i>u||l>-1&&i>l||o>-1&&i>o)return!0;let c=-1;for(;++c<n.length;){const d=n[c];if(i===d.length&&s.slice(0,d.length)===d)return!0}return!1}function $u(e,t){const r=LE(t);t.data&&(e.data=ei(t.data)),r&&(e.position=r)}function Qb(e,t){let r,n=-1;if(e)for(;++n<e.length;){const s=e[n],i=typeof s=="string"?s:s[0];if(i===t)return s;i==="data*"&&(r=s)}if(t.length>4&&t.slice(0,4).toLowerCase()==="data")return r}function vN(e){return function(t){return c7(t,e)}}function zc({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(l_,{remarkPlugins:[I_],rehypePlugins:[gN,vN],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function b7({onClose:e,onSelectImage:t}){const[r,n]=w.useState("upload"),[s,i]=w.useState(null),[l,o]=w.useState([]),[u,c]=w.useState(!1),[d,h]=w.useState(null),[f,p]=w.useState(""),[g,b]=w.useState(""),E=async()=>{if(!s)return;c(!0);const y=`${Date.now()}-${s.name}`,{error:v}=await re.storage.from("images").upload(y,s);if(v){alert("Upload error: "+v.message),c(!1);return}const{publicURL:N,error:_}=re.storage.from("images").getPublicUrl(y);if(_){alert("Error getting public URL: "+_.message),c(!1);return}t(N,f,g),c(!1),e()},x=async()=>{c(!0);const{data:y,error:v}=await re.storage.from("images").list("",{limit:100});if(v){alert("Error listing images: "+v.message),c(!1);return}const N=y.map(_=>{const{publicURL:S}=re.storage.from("images").getPublicUrl(_.name);return S});o(N),c(!1)};return Wr.useEffect(()=>{r==="select"&&x()},[r]),a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Select an Image"}),a.jsx("button",{onClick:e,children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex gap-4 mb-4",children:[a.jsx(V,{variant:"secondary",size:"sm",onClick:()=>n("upload"),children:"Upload"}),a.jsx(V,{variant:"secondary",size:"sm",onClick:()=>n("select"),children:"Select"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Width (e.g., 300px or 100%)"}),a.jsx("input",{type:"text",value:f,onChange:y=>p(y.target.value),className:"w-full px-3 py-2 border rounded"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Height (e.g., 200px)"}),a.jsx("input",{type:"text",value:g,onChange:y=>b(y.target.value),className:"w-full px-3 py-2 border rounded"})]}),r==="upload"?a.jsxs("div",{children:[a.jsx("input",{type:"file",accept:"image/*",onChange:y=>{y.target.files&&y.target.files[0]&&i(y.target.files[0])}}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(V,{variant:"primary",onClick:E,loading:u,children:"Upload Image"})})]}):a.jsxs("div",{children:[u?a.jsx("p",{children:"Loading images..."}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((y,v)=>a.jsx("img",{src:y,alt:"Stored",className:`cursor-pointer border ${d===y?"border-blue-500":"border-gray-200"}`,onClick:()=>h(y)},v))}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx(V,{variant:"secondary",onClick:()=>n("upload"),children:"Back to Upload"}),a.jsx(V,{variant:"primary",onClick:()=>{d&&(t(d,f,g),e())},disabled:!d,children:"Select Image"})]})]})]})})}function v7({entry:e,onClose:t,onSave:r,onSaveAsTemplate:n}){const[s,i]=w.useState(e),[l,o]=w.useState(!1),[u,c]=w.useState(!1),[d,h]=w.useState(!1),f=async()=>{c(!0);try{await r(s)}finally{c(!1)}},p=async()=>{if(n){c(!0);try{await n(s)}finally{c(!1)}}},g=(b,E,x)=>{let y=`![Image description](${b})`;if(E||x){const v=[];E&&v.push(`width="${E}"`),x&&v.push(`height="${x}"`),y+=`{${v.join(" ")}}`}i({...s,content:s.content+`
`+y+`
`})};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"border-b p-4 flex items-center justify-between bg-white",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(V,{variant:"secondary",icon:R0,onClick:t,children:"Back"}),a.jsx("h2",{className:"text-xl font-bold",children:s.title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"secondary",icon:l?C2:A2,onClick:()=>o(!l),children:l?"Edit":"Preview"}),n&&a.jsx(V,{variant:"secondary",onClick:p,loading:u,children:"Save as Template"}),a.jsx(V,{variant:"primary",icon:Pr,onClick:f,loading:u,children:"Save"})]})]}),!l&&a.jsxs("div",{className:"border-b p-2 flex items-center gap-2 bg-white",children:[a.jsx(V,{variant:"secondary",size:"sm",icon:gA,onClick:()=>{const b=document.querySelector("textarea");if(b){const E=b.selectionStart,x=b.selectionEnd,y=b.value,v=y.substring(0,E),N=y.substring(E,x),_=y.substring(x);i({...s,content:`${v}**${N}**${_}`})}},children:"Bold"}),a.jsx(V,{variant:"secondary",size:"sm",icon:jA,onClick:()=>{const b=document.querySelector("textarea");if(b){const E=b.selectionStart,x=b.selectionEnd,y=b.value,v=y.substring(0,E),N=y.substring(E,x),_=y.substring(x);i({...s,content:`${v}_${N}_${_}`})}},children:"Italic"}),a.jsx("div",{className:"w-px h-6 bg-gray-300"}),a.jsx(V,{variant:"secondary",size:"sm",icon:HA,onClick:()=>{i({...s,content:s.content+`
| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
`})},children:"Table"}),a.jsx(V,{variant:"secondary",size:"sm",icon:CA,onClick:()=>h(!0),children:"Image"}),a.jsx(V,{variant:"secondary",size:"sm",icon:R2,onClick:()=>{i({...s,content:s.content+"[Link text](https://example.com)"})},children:"Link"}),a.jsx(V,{variant:"secondary",size:"sm",icon:ml,onClick:()=>{i({...s,content:s.content+`
> ### Note
> This is a note block for important information.
`})},children:"Note"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs("div",{className:"h-full flex",children:[!l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:s.title,onChange:b=>i({...s,title:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:s.category,onChange:b=>i({...s,category:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx("textarea",{value:s.content,onChange:b=>i({...s,content:b.target.value}),rows:20,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono bg-white"})]})]})}),l&&a.jsx("div",{className:"flex-1 p-6 overflow-auto bg-gray-50 homebrew",children:a.jsxs("div",{className:"max-w-4xl mx-auto prose",children:[a.jsx("h1",{children:s.title}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.category})}),a.jsx(zc,{content:s.content})]})})]})}),d&&a.jsx(b7,{onClose:()=>h(!1),onSelectImage:(b,E,x)=>{g(b,E,x)}})]})}async function w7(){const{data:e,error:t}=await re.from("compendium").select("*").order("category").order("title");if(t)throw console.error("Error fetching compendium entries:",t),new Error(t.message||"Failed to load compendium entries");return e||[]}async function E7(){const{data:e,error:t}=await re.from("compendium_templates").select("*").order("category").order("name");if(t)throw console.error("Error fetching compendium templates:",t),new Error(t.message||"Failed to load compendium templates");return e||[]}function _7(){const{user:e,isAdmin:t}=Ot(),r=Zr(),[n,s]=w.useState(""),[i,l]=w.useState(null),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState([]),[p,g]=w.useState(new Set),{data:b=[],isLoading:E,error:x}=jt({queryKey:["compendiumEntries"],queryFn:w7}),{data:y=[],isLoading:v,error:N}=jt({queryKey:["compendiumTemplates"],queryFn:E7}),_=E||v,S=(x==null?void 0:x.message)||(N==null?void 0:N.message)||null;w.useEffect(()=>{R()},[]);const R=()=>{const B=localStorage.getItem("compendium_bookmarks");B&&f(JSON.parse(B))},j=B=>{const A=B.content.slice(0,100)+"...";f(M=>{const k=M.some(K=>K.id===B.id)?M.filter(K=>K.id!==B.id):[...M,{...B,preview:A}];return localStorage.setItem("compendium_bookmarks",JSON.stringify(k)),k})},D=B=>{g(A=>{const M=new Set(A);return M.has(B)?M.delete(B):M.add(B),M})},T=w.useMemo(()=>{if(n)return[];const B=b.reduce((A,M)=>{const G=M.category??"Uncategorized";return A[G]||(A[G]=[]),A[G].push(M),A},{});return Object.entries(B).sort(([A],[M])=>A.localeCompare(M))},[b,n]),F=w.useMemo(()=>n?b.filter(B=>B.title.toLowerCase().includes(n.toLowerCase())||B.content.toLowerCase().includes(n.toLowerCase())):[],[b,n]),O=jr({mutationFn:async B=>{if(B.id){const{error:A}=await re.from("compendium").update({title:B.title,content:B.content,category:B.category,updated_at:new Date().toISOString()}).eq("id",B.id);if(A)throw A}else{const{error:A}=await re.from("compendium").insert([{title:B.title,content:B.content,category:B.category,created_by:e==null?void 0:e.id}]);if(A)throw A}},onSuccess:()=>{r.invalidateQueries({queryKey:["compendiumEntries"]}),d(null)},onError:B=>{console.error("Save error:",B)}}),Q=B=>{O.mutate(B)},Y=()=>{d({title:"",content:"",category:i||"",created_by:e==null?void 0:e.id})},H=()=>{u(null),s("")};return _?a.jsx(ze,{size:"lg",className:"mx-auto mt-12"}):S?a.jsx(Ce,{message:S,className:"m-8"}):a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsx("div",{className:"w-80 bg-white border-r flex flex-col",children:a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Compendium"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{variant:"secondary",size:"sm",onClick:H,children:"Home"}),t()&&a.jsx(V,{variant:"primary",size:"sm",icon:zt,onClick:Y,children:"New Entry"})]})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search compendium...",value:n,onChange:B=>s(B.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n===""&&a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(([B,A])=>a.jsxs("div",{className:"border-b",children:[a.jsxs("div",{onClick:()=>D(B),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[p.has(B)?a.jsx(O0,{className:"w-4 h-4 text-gray-500"}):a.jsx(Sa,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:B})]}),a.jsx("span",{className:"text-sm text-gray-500",children:A.length})]}),p.has(B)&&a.jsx("div",{className:"bg-gray-50",children:A.map(M=>a.jsx("div",{onClick:()=>u(M),className:`px-8 py-2 cursor-pointer hover:bg-gray-100 ${(o==null?void 0:o.id)===M.id?"bg-blue-50":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:M.title}),h.some(G=>G.id===M.id)&&a.jsx(ly,{className:"w-4 h-4 text-blue-500"})]})},M.id))})]},B))})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-95 z-10 p-6 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Search Results"}),a.jsx(V,{variant:"secondary",size:"sm",onClick:()=>s(""),children:"Clear Search"})]}),F.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:F.map(B=>a.jsxs("div",{onClick:()=>{u(B),s("")},className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:B.title}),a.jsx("div",{className:"homebrew",children:a.jsx(zc,{content:B.content.slice(0,200)+"..."})})]},B.id))}):a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-gray-500",children:['No results found for "',n,'".']})})]}),o&&!n?a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"secondary",size:"sm",icon:h.some(B=>B.id===o.id)?ly:xA,onClick:()=>j(o),children:h.some(B=>B.id===o.id)?"Bookmarked":"Bookmark"}),t()&&a.jsx(V,{variant:"secondary",size:"sm",icon:Pu,onClick:()=>d(o),children:"Edit"})]})]}),a.jsx("div",{className:"homebrew",children:a.jsx(zc,{content:o.content})})]}):!o&&!n&&a.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bookmarked Entries"}),h.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(B=>a.jsxs("div",{onClick:()=>u(B),className:"cursor-pointer hover:bg-gray-100 p-4 border rounded",children:[a.jsx("h2",{className:"text-xl font-bold",children:B.title}),a.jsx("div",{className:"homebrew",children:a.jsx(zc,{content:B.preview})})]},B.id))}):a.jsxs("div",{className:"text-center",children:[a.jsx(Ou,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Welcome to the Compendium"}),a.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Use the sidebar to search and browse entries, or add new ones if you're an admin."})]})]})]}),c&&a.jsx(v7,{entry:c,onClose:()=>d(null),onSave:Q})]})}async function N7(e,t){if(!e)return[];let r=re.from("parties").select(`
    id,
    name,
    description,
    created_by,
    created_at,
    members:party_members!inner (
      characters!inner (
        *
      )
    )
  `);t?r=r.eq("created_by",e):r=r.eq("members.characters.user_id",e);const{data:n,error:s}=await r.order("created_at",{ascending:!1});if(s)throw console.error("Error fetching parties:",s),new Error(s.message||"Failed to fetch parties");return(n||[]).map(l=>({...l,members:(l.members||[]).map(o=>o.characters?Rl(o.characters):null).filter(o=>!!o)}))}async function wN(e){if(!e)return[];const{data:t,error:r}=await re.from("party_members").select("character_id");if(r)throw console.error("Error fetching party member IDs:",r),new Error(r.message||"Failed to fetch member data");const n=(t||[]).map(o=>o.character_id);let s=re.from("characters").select("*").eq("user_id",e);n.length>0&&(s=s.not("id","in",`(${n.join(",")})`));const{data:i,error:l}=await s;if(l)throw console.error("Error fetching available characters:",l),new Error(l.message||"Failed to fetch available characters");return(i||[]).map(Rl)}async function EN(e){if(!e)return null;const{data:t,error:r}=await re.from("parties").select(`
      id,
      name,
      description,
      created_by,
      created_at,
      members:party_members (
        characters (
          *
        )
      )
    `).eq("id",e).single();if(r)throw console.error("Error fetching party by ID:",r),r.code==="PGRST116"?new Error("Party not found"):new Error(r.message||"Failed to fetch party");return t?{...t,members:(t.members||[]).map(s=>s.characters?Rl(s.characters):null).filter(s=>!!s)}:null}async function k7(e,t){const{error:r}=await re.from("party_members").delete().match({party_id:e,character_id:t});if(r)throw console.error("Error removing party member:",r),new Error(r.message||"Failed to remove party member")}async function S7(e){const{error:t}=await re.from("parties").delete().eq("id",e);if(t)throw console.error("Error deleting party:",t),new Error(t.message||"Failed to delete party")}function T7(){const{user:e,isDM:t}=Ot(),r=Xr(),n=Zr(),[s,i]=w.useState(!1),[l,o]=w.useState(""),[u,c]=w.useState([]),{data:d=[],isLoading:h,error:f}=jt({queryKey:["parties",e==null?void 0:e.id,t()],queryFn:()=>N7(e==null?void 0:e.id,t()),enabled:!!e}),{data:p=[],isLoading:g,error:b}=jt({queryKey:["availableCharacters",e==null?void 0:e.id],queryFn:()=>wN(e==null?void 0:e.id),enabled:!!e&&s}),E=h||s&&g,x=(f==null?void 0:f.message)||(b==null?void 0:b.message)||null,y=jr({mutationFn:async({name:N,characterIds:_})=>{if(!N.trim())throw new Error("Party name is required");if(!e)throw new Error("User not authenticated");const{data:S,error:R}=await re.from("parties").insert([{name:N,created_by:e.id}]).select().single();if(R)throw R;if(!S)throw new Error("Party creation failed");if(_.length>0){const j=_.map(T=>({party_id:S.id,character_id:T})),{error:D}=await re.from("party_members").insert(j);if(D)throw await re.from("parties").delete().eq("id",S.id),D}return S},onSuccess:()=>{n.invalidateQueries({queryKey:["parties",e==null?void 0:e.id,t()]}),n.invalidateQueries({queryKey:["availableCharacters",e==null?void 0:e.id]}),o(""),c([]),i(!1)},onError:N=>{console.error("Failed to create party:",N)}}),v=()=>{y.mutate({name:l,characterIds:u})};return E&&!s?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(ze,{size:"lg"})}):x&&!s?a.jsx("div",{className:"p-8",children:a.jsx(Ce,{message:x})}):a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ts,{className:"w-6 h-6 text-blue-600"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Adventure Parties"})]}),t()&&a.jsx(V,{variant:"primary",icon:zt,onClick:()=>i(!0),disabled:s,children:"Create Party"})]}),x&&!y.error&&!s&&a.jsxs("div",{className:"mb-6",children:[" ",a.jsx(Ce,{message:x})," "]}),s&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-md p-6 border border-blue-200",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Party"}),y.error&&a.jsxs("div",{className:"mb-4",children:[" ",a.jsx(Ce,{message:y.error.message})," "]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partyName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name"}),a.jsx("input",{type:"text",id:"partyName",value:l,onChange:N=>o(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Initial Characters (Optional)"}),g?a.jsx(ze,{}):b?a.jsx(Ce,{message:b.message}):p.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-60 overflow-y-auto p-2 border rounded-md",children:p.map(N=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer ${u.includes(N.id||"")?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>{N.id&&c(_=>_.includes(N.id)?_.filter(S=>S!==N.id):[..._,N.id])},children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xa,{className:"w-4 h-4 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-sm",children:N.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[N.kin," ",N.profession]})]})]})},N.id))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No available characters to add."})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(V,{variant:"secondary",onClick:()=>i(!1),disabled:y.isPending,children:"Cancel"}),a.jsx(V,{variant:"primary",onClick:v,loading:y.isPending,disabled:!l.trim()||y.isPending,children:"Create Party"})]})]})]}),!s&&(d.length>0?a.jsx("div",{className:"grid gap-6",children:d.map(N=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:N.name}),a.jsx(V,{variant:"secondary",onClick:()=>r(`/party/${N.id}`),children:"View Party"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[N.members.map(_=>a.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xa,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:_.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[_.kin," ",_.profession]})]})]})},_.id)),N.members.length===0&&a.jsx("p",{className:"text-sm text-gray-500 italic col-span-full",children:"No members yet."})]})]},N.id))}):a.jsx(np,{icon:ts,title:"No Adventure Parties",description:t()?"You haven't created any parties yet.":"You're not currently in any adventure parties.",action:t()?a.jsx(V,{variant:"primary",icon:zt,onClick:()=>i(!0),children:"Create Your First Party"}):void 0}))]})}function dg({content:e,className:t=""}){return a.jsx("div",{className:"bg-amber-100 p-6 rounded-lg shadow-lg",children:a.jsx(l_,{remarkPlugins:[I_],rehypePlugins:[gN,vN],className:`prose prose-xl max-w-none font-cinzel ${t}`,components:{h1:({node:r,...n})=>a.jsx("h1",{className:"text-4xl font-bold text-brown-800 border-b-2 border-brown-500 pb-2 mb-4",...n}),h2:({node:r,...n})=>a.jsx("h2",{className:"text-3xl font-bold text-brown-700 border-b pb-2 mb-3",...n}),h3:({node:r,...n})=>a.jsx("h3",{className:"text-2xl font-bold text-brown-600 mb-2",...n}),table:({node:r,...n})=>a.jsx("table",{className:"border-collapse border border-brown-300 my-4",...n}),th:({node:r,...n})=>a.jsx("th",{className:"border border-brown-300 px-4 py-2 bg-amber-200",...n}),td:({node:r,...n})=>a.jsx("td",{className:"border border-brown-300 px-4 py-2",...n}),blockquote:({node:r,...n})=>a.jsx("blockquote",{className:"border-l-4 border-amber-600 pl-4 my-4 italic bg-amber-50 py-2 pr-4",...n}),code:({node:r,inline:n,...s})=>n?a.jsx("code",{className:"bg-amber-200 px-1 rounded",...s}):a.jsx("code",{className:"block bg-amber-200 p-4 rounded my-4 overflow-x-auto",...s})},children:e})})}function C7(){const{user:e,isDM:t}=Ot(),[r,n]=w.useState([]),[s,i]=w.useState([]),[l,o]=w.useState([]),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(null),[g,b]=w.useState(""),[E,x]=w.useState(""),[y,v]=w.useState(""),[N,_]=w.useState(""),[S,R]=w.useState(""),[j,D]=w.useState("all"),[T,F]=w.useState(!0),[O,Q]=w.useState(null),[Y,H]=w.useState(null),B=w.useCallback(()=>{b(""),x(""),v(""),_(""),H(null)},[]),A=()=>{B(),h(!0),p(null),c(null)},M=Z=>{c(Z),p(Z.id),h(!1),b(Z.title),x(Z.content),v(Z.character_id||""),_(Z.party_id||""),H(null)},G=()=>{h(!1),p(null),B(),f&&c(null)},k=w.useCallback(async()=>{if(e){F(!0),Q(null);try{const Z=new Map,{data:ye,error:te}=await re.from("notes").select("*, character:characters(name), party:parties(name)").eq("user_id",e.id);if(te)throw te;if((ye||[]).forEach(_e=>Z.set(_e.id,_e)),t()){const{data:_e,error:Ie}=await re.from("parties").select("id").eq("created_by",e.id);if(Ie)throw Ie;const Le=(_e||[]).map(Be=>Be.id);if(Le.length>0){const{data:Be,error:$}=await re.from("notes").select("*, character:characters(name), party:parties(name)").in("party_id",Le);if($)throw $;(Be||[]).forEach(W=>Z.set(W.id,W))}}const ce=Array.from(Z.values()).sort((_e,Ie)=>new Date(Ie.created_at).getTime()-new Date(_e.created_at).getTime());n(ce)}catch(Z){console.error("Error loading notes:",Z),Q(Z instanceof Error?Z.message:"Failed to load notes"),n([])}finally{F(!1)}}},[e,t]),K=w.useCallback(async()=>{if(e)try{const{data:Z,error:ye}=await re.from("characters").select("id, name").eq("user_id",e.id);if(ye)throw ye;i(Z||[])}catch(Z){console.error("Error loading characters:",Z),Q(ye=>ye||(Z instanceof Error?Z.message:"Failed to load characters"))}},[e]),z=w.useCallback(async()=>{if(!(!e||!t()))try{const{data:Z,error:ye}=await re.from("parties").select("id, name").eq("created_by",e.id);if(ye)throw ye;o(Z||[])}catch(Z){console.error("Error loading parties:",Z),Q(ye=>ye||(Z instanceof Error?Z.message:"Failed to load parties"))}},[e,t]);w.useEffect(()=>{e?(k(),K(),t()&&z()):(F(!1),n([]),i([]),o([]),c(null),G())},[e,t,k,K,z]);async function I(){if(!e){H("User not authenticated.");return}if(!g.trim()){H("Title is required.");return}H(null);const Z=y||null,ye=N||null;if(Z&&ye){H("A note can be linked to either a character OR a party, not both.");return}const te={title:g.trim(),content:E,user_id:e.id,character_id:Z,party_id:ye,updated_at:new Date().toISOString()};try{let ce=null;if(f){const{data:_e,error:Ie}=await re.from("notes").update(te).eq("id",f).select("*, character:characters(name), party:parties(name)").single();if(Ie)throw Ie;ce=_e}else{const{updated_at:_e,...Ie}=te,{data:Le,error:Be}=await re.from("notes").insert([Ie]).select("*, character:characters(name), party:parties(name)").single();if(Be)throw Be;ce=Le}G(),await k(),ce&&c(ce)}catch(ce){console.error("Error saving note:",ce),H(ce instanceof Error?`Failed to save note: ${ce.message}`:"An unknown error occurred.")}}async function he(Z){if(window.confirm("Are you sure you want to delete this note?"))try{Q(null);const{error:ye}=await re.from("notes").delete().eq("id",Z);if(ye)throw ye;await k(),(u==null?void 0:u.id)===Z&&c(null),f===Z&&G()}catch(ye){console.error("Error deleting note:",ye),Q(ye instanceof Error?`Failed to delete note: ${ye.message}`:"An unknown error occurred.")}}const Ee=r.filter(Z=>{const ye=Z.title.toLowerCase().includes(S.toLowerCase())||Z.content.toLowerCase().includes(S.toLowerCase()),te=j==="all"||j==="personal"&&!Z.character_id&&!Z.party_id||j==="character"&&!!Z.character_id||j==="party"&&!!Z.party_id;return ye&&te});if(T&&r.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[a.jsx(ze,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading notes..."})]});const be=d||f;return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(Ou,{className:"w-6 h-6 text-blue-600"}),"Notes"]}),a.jsx(V,{variant:"primary",size:"sm",icon:zt,onClick:A,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:S,onChange:Z=>R(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:j,onChange:Z=>D(Z.target.value),className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white","aria-label":"Filter notes",children:[a.jsx("option",{value:"all",children:"All Notes"}),a.jsx("option",{value:"personal",children:"My Personal Notes"}),a.jsx("option",{value:"character",children:"Character Notes"}),a.jsx("option",{value:"party",children:"Party Notes"})]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(O0,{className:"w-4 h-4 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[O&&!be&&a.jsx("div",{className:"p-4",children:a.jsx(Ce,{message:O,onClose:()=>Q(null)})}),Ee.length>0?Ee.map(Z=>a.jsxs("div",{onClick:()=>{(!f||f!==Z.id)&&(c(Z),h(!1),p(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(u==null?void 0:u.id)===Z.id&&!be?"bg-blue-50 border-l-4 border-blue-500":""} ${f===Z.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:Z.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:Z.content.substring(0,50)+(Z.content.length>50?"...":"")}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Z.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-xs",children:["Char: ",Z.character.name]}):Z.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-xs",children:["Party: ",Z.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-xs",children:"Personal"})})]},Z.id)):!T&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(ml,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),S||j!=="all"?"No notes match.":"No notes yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:be?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Note":"Create New Note"}),a.jsx("button",{onClick:G,className:"text-gray-500 hover:text-gray-700","aria-label":"Close form",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),Y&&a.jsx("div",{className:"mb-4",children:a.jsx(Ce,{message:Y,onClose:()=>H(null)})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"title",value:g,onChange:Z=>b(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter note title",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"character",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Character (Optional)"}),a.jsxs("select",{id:"character",value:y,onChange:Z=>{v(Z.target.value),Z.target.value&&_("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!N,children:[a.jsx("option",{value:"",children:"None"}),s.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),t()&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"party",className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Party (Optional, DM Only)"}),a.jsxs("select",{id:"party",value:N,onChange:Z=>{_(Z.target.value),Z.target.value&&v("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",disabled:!!y,children:[a.jsx("option",{value:"",children:"None"}),l.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"content",value:E,onChange:Z=>x(Z.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter note content..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use Markdown for formatting."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx(V,{variant:"secondary",onClick:G,children:"Cancel"}),a.jsx(V,{variant:"primary",icon:Pr,onClick:I,disabled:!g.trim(),children:f?"Update Note":"Save Note"})]})]})]}):u?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:u.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:u.character?a.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["Character: ",u.character.name]}):u.party?a.jsxs("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Party: ",u.party.name]}):a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Personal"})})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(V,{variant:"secondary",size:"sm",icon:Pu,onClick:()=>M(u),children:"Edit"}),a.jsx(V,{variant:"danger_outline",size:"sm",icon:Kr,onClick:()=>he(u.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(dg,{content:u.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(u.created_at).toLocaleDateString(),u.updated_at&&new Date(u.updated_at).getTime()!==new Date(u.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(u.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(ml,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),O&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ce,{message:O,onClose:()=>Q(null)})})]})})]})}var Ke;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const i={};for(const l of s)i[l]=l;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),l={};for(const o of i)l[o]=s[o];return e.objectValues(l)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&i.push(l);return i},e.find=(s,i)=>{for(const l of s)if(i(l))return l},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}e.joinValues=n,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Ke||(Ke={}));var bp;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(bp||(bp={}));const me=Ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yn=e=>{switch(typeof e){case"undefined":return me.undefined;case"string":return me.string;case"number":return isNaN(e)?me.nan:me.number;case"boolean":return me.boolean;case"function":return me.function;case"bigint":return me.bigint;case"symbol":return me.symbol;case"object":return Array.isArray(e)?me.array:e===null?me.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?me.promise:typeof Map<"u"&&e instanceof Map?me.map:typeof Set<"u"&&e instanceof Set?me.set:typeof Date<"u"&&e instanceof Date?me.date:me.object;default:return me.unknown}},ie=Ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),j7=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Lr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},s=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let o=n,u=0;for(;u<l.path.length;){const c=l.path[u];u===l.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(l))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),n}static assert(t){if(!(t instanceof Lr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Lr.create=e=>new Lr(e);const bl=(e,t)=>{let r;switch(e.code){case ie.invalid_type:e.received===me.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case ie.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Ke.jsonStringifyReplacer)}`;break;case ie.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ke.joinValues(e.keys,", ")}`;break;case ie.invalid_union:r="Invalid input";break;case ie.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ke.joinValues(e.options)}`;break;case ie.invalid_enum_value:r=`Invalid enum value. Expected ${Ke.joinValues(e.options)}, received '${e.received}'`;break;case ie.invalid_arguments:r="Invalid function arguments";break;case ie.invalid_return_type:r="Invalid function return type";break;case ie.invalid_date:r="Invalid date";break;case ie.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Ke.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case ie.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case ie.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case ie.custom:r="Invalid input";break;case ie.invalid_intersection_types:r="Intersection results could not be merged";break;case ie.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ie.not_finite:r="Number must be finite";break;default:r=t.defaultError,Ke.assertNever(e)}return{message:r}};let _N=bl;function A7(e){_N=e}function Td(){return _N}const Cd=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],l={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)o=c(l,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},I7=[];function de(e,t){const r=Td(),n=Cd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===bl?void 0:bl].filter(s=>!!s)});e.common.issues.push(n)}class Zt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return Ae;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const i=await s.key,l=await s.value;n.push({key:i,value:l})}return Zt.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:i,value:l}=s;if(i.status==="aborted"||l.status==="aborted")return Ae;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const Ae=Object.freeze({status:"aborted"}),Ii=e=>({status:"dirty",value:e}),lr=e=>({status:"valid",value:e}),vp=e=>e.status==="aborted",wp=e=>e.status==="dirty",ti=e=>e.status==="valid",cu=e=>typeof Promise<"u"&&e instanceof Promise;function jd(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function NN(e,t,r,n,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var ve;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ve||(ve={}));var fo,mo;class Dn{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Kb=(e,t)=>{if(ti(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Lr(e.common.issues);return this._error=r,this._error}}};function Pe(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(l,o)=>{var u,c;const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:o.defaultError}},description:s}}class Ue{get description(){return this._def.description}_getType(t){return Yn(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Yn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Zt,ctx:{common:t.parent.common,data:t.data,parsedType:Yn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(cu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)},i=this._parseSync({data:t,path:s.path,parent:s});return Kb(s,i)}"~validate"(t){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return ti(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>ti(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)},s=this._parse({data:t,path:n.path,parent:n}),i=await(cu(s)?s:Promise.resolve(s));return Kb(n,i)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const l=t(s),o=()=>i.addIssue({code:ie.custom,...n(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new xn({schema:this,typeName:je.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ln.create(this,this._def)}nullable(){return la.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return pn.create(this)}promise(){return wl.create(this,this._def)}or(t){return mu.create([this,t],this._def)}and(t){return pu.create(this,t,this._def)}transform(t){return new xn({...Pe(this._def),schema:this,typeName:je.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new vu({...Pe(this._def),innerType:this,defaultValue:r,typeName:je.ZodDefault})}brand(){return new hg({typeName:je.ZodBranded,type:this,...Pe(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new wu({...Pe(this._def),innerType:this,catchValue:r,typeName:je.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return zu.create(this,t)}readonly(){return Eu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const R7=/^c[^\s-]{8,}$/i,L7=/^[0-9a-z]+$/,O7=/^[0-9A-HJKMNP-TV-Z]{26}$/i,P7=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,D7=/^[a-z0-9_-]{21}$/i,M7=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,F7=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U7=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,B7="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Of;const H7=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$7=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,z7=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,q7=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V7=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W7=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,kN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",G7=new RegExp(`^${kN}$`);function SN(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function Y7(e){return new RegExp(`^${SN(e)}$`)}function TN(e){let t=`${kN}T${SN(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Q7(e,t){return!!((t==="v4"||!t)&&H7.test(e)||(t==="v6"||!t)&&z7.test(e))}function K7(e,t){if(!M7.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function Z7(e,t){return!!((t==="v4"||!t)&&$7.test(e)||(t==="v6"||!t)&&q7.test(e))}class dn extends Ue{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==me.string){const i=this._getOrReturnCtx(t);return de(i,{code:ie.invalid_type,expected:me.string,received:i.parsedType}),Ae}const n=new Zt;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(s=this._getOrReturnCtx(t,s),l?de(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&de(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"email",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Of||(Of=new RegExp(B7,"u")),Of.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"emoji",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")P7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"uuid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")D7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"nanoid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")R7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cuid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")L7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cuid2",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")O7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"ulid",code:ie.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),de(s,{validation:"url",code:ie.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"regex",code:ie.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?TN(i).test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?G7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?Y7(i).test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ie.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?F7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"duration",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?Q7(t.data,i.version)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"ip",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?K7(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"jwt",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?Z7(t.data,i.version)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cidr",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"base64",code:ie.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W7.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"base64url",code:ie.invalid_string,message:i.message}),n.dirty()):Ke.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:ie.invalid_string,...ve.errToObj(n)})}_addCheck(t){return new dn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ve.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ve.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ve.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ve.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ve.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ve.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ve.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ve.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ve.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ve.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ve.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ve.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ve.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...ve.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ve.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ve.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ve.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ve.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ve.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ve.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ve.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ve.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ve.errToObj(r)})}nonempty(t){return this.min(1,ve.errToObj(t))}trim(){return new dn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new dn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}dn.create=e=>{var t;return new dn({checks:[],typeName:je.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pe(e)})};function X7(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(e.toFixed(s).replace(".","")),l=parseInt(t.toFixed(s).replace(".",""));return i%l/Math.pow(10,s)}class sa extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==me.number){const i=this._getOrReturnCtx(t);return de(i,{code:ie.invalid_type,expected:me.number,received:i.parsedType}),Ae}let n;const s=new Zt;for(const i of this._def.checks)i.kind==="int"?Ke.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),de(n,{code:ie.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?X7(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),de(n,{code:ie.not_finite,message:i.message}),s.dirty()):Ke.assertNever(i);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new sa({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new sa({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ve.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ve.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ve.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ve.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ke.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}sa.create=e=>new sa({checks:[],typeName:je.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Pe(e)});class aa extends Ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==me.bigint)return this._getInvalidInput(t);let n;const s=new Zt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),de(n,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Ke.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return de(r,{code:ie.invalid_type,expected:me.bigint,received:r.parsedType}),Ae}gte(t,r){return this.setLimit("min",t,!0,ve.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ve.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ve.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ve.toString(r))}setLimit(t,r,n,s){return new aa({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ve.toString(s)}]})}_addCheck(t){return new aa({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ve.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ve.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}aa.create=e=>{var t;return new aa({checks:[],typeName:je.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Pe(e)})};class du extends Ue{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==me.boolean){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.boolean,received:n.parsedType}),Ae}return lr(t.data)}}du.create=e=>new du({typeName:je.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Pe(e)});class ri extends Ue{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==me.date){const i=this._getOrReturnCtx(t);return de(i,{code:ie.invalid_type,expected:me.date,received:i.parsedType}),Ae}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return de(i,{code:ie.invalid_date}),Ae}const n=new Zt;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ie.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ie.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Ke.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ri({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ve.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ve.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}ri.create=e=>new ri({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:je.ZodDate,...Pe(e)});class Ad extends Ue{_parse(t){if(this._getType(t)!==me.symbol){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.symbol,received:n.parsedType}),Ae}return lr(t.data)}}Ad.create=e=>new Ad({typeName:je.ZodSymbol,...Pe(e)});class hu extends Ue{_parse(t){if(this._getType(t)!==me.undefined){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.undefined,received:n.parsedType}),Ae}return lr(t.data)}}hu.create=e=>new hu({typeName:je.ZodUndefined,...Pe(e)});class fu extends Ue{_parse(t){if(this._getType(t)!==me.null){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.null,received:n.parsedType}),Ae}return lr(t.data)}}fu.create=e=>new fu({typeName:je.ZodNull,...Pe(e)});class vl extends Ue{constructor(){super(...arguments),this._any=!0}_parse(t){return lr(t.data)}}vl.create=e=>new vl({typeName:je.ZodAny,...Pe(e)});class qa extends Ue{constructor(){super(...arguments),this._unknown=!0}_parse(t){return lr(t.data)}}qa.create=e=>new qa({typeName:je.ZodUnknown,...Pe(e)});class us extends Ue{_parse(t){const r=this._getOrReturnCtx(t);return de(r,{code:ie.invalid_type,expected:me.never,received:r.parsedType}),Ae}}us.create=e=>new us({typeName:je.ZodNever,...Pe(e)});class Id extends Ue{_parse(t){if(this._getType(t)!==me.undefined){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.void,received:n.parsedType}),Ae}return lr(t.data)}}Id.create=e=>new Id({typeName:je.ZodVoid,...Pe(e)});class pn extends Ue{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==me.array)return de(r,{code:ie.invalid_type,expected:me.array,received:r.parsedType}),Ae;if(s.exactLength!==null){const l=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(l||o)&&(de(r,{code:l?ie.too_big:ie.too_small,minimum:o?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(de(r,{code:ie.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(de(r,{code:ie.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>s.type._parseAsync(new Dn(r,l,r.path,o)))).then(l=>Zt.mergeArray(n,l));const i=[...r.data].map((l,o)=>s.type._parseSync(new Dn(r,l,r.path,o)));return Zt.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new pn({...this._def,minLength:{value:t,message:ve.toString(r)}})}max(t,r){return new pn({...this._def,maxLength:{value:t,message:ve.toString(r)}})}length(t,r){return new pn({...this._def,exactLength:{value:t,message:ve.toString(r)}})}nonempty(t){return this.min(1,t)}}pn.create=(e,t)=>new pn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:je.ZodArray,...Pe(t)});function xi(e){if(e instanceof gt){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ln.create(xi(n))}return new gt({...e._def,shape:()=>t})}else return e instanceof pn?new pn({...e._def,type:xi(e.element)}):e instanceof Ln?Ln.create(xi(e.unwrap())):e instanceof la?la.create(xi(e.unwrap())):e instanceof Mn?Mn.create(e.items.map(t=>xi(t))):e}class gt extends Ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Ke.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==me.object){const c=this._getOrReturnCtx(t);return de(c,{code:ie.invalid_type,expected:me.object,received:c.parsedType}),Ae}const{status:n,ctx:s}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof us&&this._def.unknownKeys==="strip"))for(const c in s.data)l.includes(c)||o.push(c);const u=[];for(const c of l){const d=i[c],h=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new Dn(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof us){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")o.length>0&&(de(s,{code:ie.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new Dn(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const h=await d.key,f=await d.value;c.push({key:h,value:f,alwaysSet:d.alwaysSet})}return c}).then(c=>Zt.mergeObjectSync(n,c)):Zt.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return ve.errToObj,new gt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var s,i,l,o;const u=(l=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&l!==void 0?l:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=ve.errToObj(t).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new gt({...this._def,unknownKeys:"strip"})}passthrough(){return new gt({...this._def,unknownKeys:"passthrough"})}extend(t){return new gt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new gt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:je.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new gt({...this._def,catchall:t})}pick(t){const r={};return Ke.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new gt({...this._def,shape:()=>r})}omit(t){const r={};return Ke.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new gt({...this._def,shape:()=>r})}deepPartial(){return xi(this)}partial(t){const r={};return Ke.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}),new gt({...this._def,shape:()=>r})}required(t){const r={};return Ke.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Ln;)i=i._def.innerType;r[n]=i}}),new gt({...this._def,shape:()=>r})}keyof(){return CN(Ke.objectKeys(this.shape))}}gt.create=(e,t)=>new gt({shape:()=>e,unknownKeys:"strip",catchall:us.create(),typeName:je.ZodObject,...Pe(t)});gt.strictCreate=(e,t)=>new gt({shape:()=>e,unknownKeys:"strict",catchall:us.create(),typeName:je.ZodObject,...Pe(t)});gt.lazycreate=(e,t)=>new gt({shape:e,unknownKeys:"strip",catchall:us.create(),typeName:je.ZodObject,...Pe(t)});class mu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Lr(o.ctx.common.issues));return de(r,{code:ie.invalid_union,unionErrors:l}),Ae}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(s);{let i;const l=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(u=>new Lr(u));return de(r,{code:ie.invalid_union,unionErrors:o}),Ae}}get options(){return this._def.options}}mu.create=(e,t)=>new mu({options:e,typeName:je.ZodUnion,...Pe(t)});const qn=e=>e instanceof xu?qn(e.schema):e instanceof xn?qn(e.innerType()):e instanceof yu?[e.value]:e instanceof ia?e.options:e instanceof bu?Ke.objectValues(e.enum):e instanceof vu?qn(e._def.innerType):e instanceof hu?[void 0]:e instanceof fu?[null]:e instanceof Ln?[void 0,...qn(e.unwrap())]:e instanceof la?[null,...qn(e.unwrap())]:e instanceof hg||e instanceof Eu?qn(e.unwrap()):e instanceof wu?qn(e._def.innerType):[];class Eh extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==me.object)return de(r,{code:ie.invalid_type,expected:me.object,received:r.parsedType}),Ae;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(de(r,{code:ie.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ae)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const s=new Map;for(const i of r){const l=qn(i.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of l){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new Eh({typeName:je.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:s,...Pe(n)})}}function Ep(e,t){const r=Yn(e),n=Yn(t);if(e===t)return{valid:!0,data:e};if(r===me.object&&n===me.object){const s=Ke.objectKeys(t),i=Ke.objectKeys(e).filter(o=>s.indexOf(o)!==-1),l={...e,...t};for(const o of i){const u=Ep(e[o],t[o]);if(!u.valid)return{valid:!1};l[o]=u.data}return{valid:!0,data:l}}else if(r===me.array&&n===me.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const l=e[i],o=t[i],u=Ep(l,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===me.date&&n===me.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class pu extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(i,l)=>{if(vp(i)||vp(l))return Ae;const o=Ep(i.value,l.value);return o.valid?((wp(i)||wp(l))&&r.dirty(),{status:r.value,value:o.data}):(de(n,{code:ie.invalid_intersection_types}),Ae)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>s(i,l)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}pu.create=(e,t,r)=>new pu({left:e,right:t,typeName:je.ZodIntersection,...Pe(r)});class Mn extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==me.array)return de(n,{code:ie.invalid_type,expected:me.array,received:n.parsedType}),Ae;if(n.data.length<this._def.items.length)return de(n,{code:ie.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&n.data.length>this._def.items.length&&(de(n,{code:ie.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Dn(n,l,n.path,o)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>Zt.mergeArray(r,l)):Zt.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Mn({...this._def,rest:t})}}Mn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Mn({items:e,typeName:je.ZodTuple,rest:null,...Pe(t)})};class gu extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==me.object)return de(n,{code:ie.invalid_type,expected:me.object,received:n.parsedType}),Ae;const s=[],i=this._def.keyType,l=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new Dn(n,o,n.path,o)),value:l._parse(new Dn(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?Zt.mergeObjectAsync(r,s):Zt.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Ue?new gu({keyType:t,valueType:r,typeName:je.ZodRecord,...Pe(n)}):new gu({keyType:dn.create(),valueType:t,typeName:je.ZodRecord,...Pe(r)})}}class Rd extends Ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==me.map)return de(n,{code:ie.invalid_type,expected:me.map,received:n.parsedType}),Ae;const s=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([o,u],c)=>({key:s._parse(new Dn(n,o,n.path,[c,"key"])),value:i._parse(new Dn(n,u,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of l){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return Ae;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of l){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return Ae;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(c.value,d.value)}return{status:r.value,value:o}}}}Rd.create=(e,t,r)=>new Rd({valueType:t,keyType:e,typeName:je.ZodMap,...Pe(r)});class ni extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==me.set)return de(n,{code:ie.invalid_type,expected:me.set,received:n.parsedType}),Ae;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(de(n,{code:ie.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(de(n,{code:ie.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function l(u){const c=new Set;for(const d of u){if(d.status==="aborted")return Ae;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const o=[...n.data.values()].map((u,c)=>i._parse(new Dn(n,u,n.path,c)));return n.common.async?Promise.all(o).then(u=>l(u)):l(o)}min(t,r){return new ni({...this._def,minSize:{value:t,message:ve.toString(r)}})}max(t,r){return new ni({...this._def,maxSize:{value:t,message:ve.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}ni.create=(e,t)=>new ni({valueType:e,minSize:null,maxSize:null,typeName:je.ZodSet,...Pe(t)});class Vi extends Ue{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==me.function)return de(r,{code:ie.invalid_type,expected:me.function,received:r.parsedType}),Ae;function n(o,u){return Cd({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Td(),bl].filter(c=>!!c),issueData:{code:ie.invalid_arguments,argumentsError:u}})}function s(o,u){return Cd({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Td(),bl].filter(c=>!!c),issueData:{code:ie.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},l=r.data;if(this._def.returns instanceof wl){const o=this;return lr(async function(...u){const c=new Lr([]),d=await o._def.args.parseAsync(u,i).catch(p=>{throw c.addIssue(n(u,p)),c}),h=await Reflect.apply(l,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(p=>{throw c.addIssue(s(h,p)),c})})}else{const o=this;return lr(function(...u){const c=o._def.args.safeParse(u,i);if(!c.success)throw new Lr([n(u,c.error)]);const d=Reflect.apply(l,this,c.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new Lr([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Vi({...this._def,args:Mn.create(t).rest(qa.create())})}returns(t){return new Vi({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new Vi({args:t||Mn.create([]).rest(qa.create()),returns:r||qa.create(),typeName:je.ZodFunction,...Pe(n)})}}class xu extends Ue{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}xu.create=(e,t)=>new xu({getter:e,typeName:je.ZodLazy,...Pe(t)});class yu extends Ue{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return de(r,{received:r.data,code:ie.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:t.data}}get value(){return this._def.value}}yu.create=(e,t)=>new yu({value:e,typeName:je.ZodLiteral,...Pe(t)});function CN(e,t){return new ia({values:e,typeName:je.ZodEnum,...Pe(t)})}class ia extends Ue{constructor(){super(...arguments),fo.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return de(r,{expected:Ke.joinValues(n),received:r.parsedType,code:ie.invalid_type}),Ae}if(jd(this,fo)||NN(this,fo,new Set(this._def.values)),!jd(this,fo).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return de(r,{received:r.data,code:ie.invalid_enum_value,options:n}),Ae}return lr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return ia.create(t,{...this._def,...r})}exclude(t,r=this._def){return ia.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}fo=new WeakMap;ia.create=CN;class bu extends Ue{constructor(){super(...arguments),mo.set(this,void 0)}_parse(t){const r=Ke.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==me.string&&n.parsedType!==me.number){const s=Ke.objectValues(r);return de(n,{expected:Ke.joinValues(s),received:n.parsedType,code:ie.invalid_type}),Ae}if(jd(this,mo)||NN(this,mo,new Set(Ke.getValidEnumValues(this._def.values))),!jd(this,mo).has(t.data)){const s=Ke.objectValues(r);return de(n,{received:n.data,code:ie.invalid_enum_value,options:s}),Ae}return lr(t.data)}get enum(){return this._def.values}}mo=new WeakMap;bu.create=(e,t)=>new bu({values:e,typeName:je.ZodNativeEnum,...Pe(t)});class wl extends Ue{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==me.promise&&r.common.async===!1)return de(r,{code:ie.invalid_type,expected:me.promise,received:r.parsedType}),Ae;const n=r.parsedType===me.promise?r.data:Promise.resolve(r.data);return lr(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}wl.create=(e,t)=>new wl({type:e,typeName:je.ZodPromise,...Pe(t)});class xn extends Ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===je.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:l=>{de(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const l=s.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return Ae;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?Ae:u.status==="dirty"||r.value==="dirty"?Ii(u.value):u});{if(r.value==="aborted")return Ae;const o=this._def.schema._parseSync({data:l,path:n.path,parent:n});return o.status==="aborted"?Ae:o.status==="dirty"||r.value==="dirty"?Ii(o.value):o}}if(s.type==="refinement"){const l=o=>{const u=s.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Ae:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Ae:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ti(l))return l;const o=s.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>ti(l)?Promise.resolve(s.transform(l.value,i)).then(o=>({status:r.value,value:o})):l);Ke.assertNever(s)}}xn.create=(e,t,r)=>new xn({schema:e,typeName:je.ZodEffects,effect:t,...Pe(r)});xn.createWithPreprocess=(e,t,r)=>new xn({schema:t,effect:{type:"preprocess",transform:e},typeName:je.ZodEffects,...Pe(r)});class Ln extends Ue{_parse(t){return this._getType(t)===me.undefined?lr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ln.create=(e,t)=>new Ln({innerType:e,typeName:je.ZodOptional,...Pe(t)});class la extends Ue{_parse(t){return this._getType(t)===me.null?lr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}la.create=(e,t)=>new la({innerType:e,typeName:je.ZodNullable,...Pe(t)});class vu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===me.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}vu.create=(e,t)=>new vu({innerType:e,typeName:je.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Pe(t)});class wu extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return cu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Lr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Lr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}wu.create=(e,t)=>new wu({innerType:e,typeName:je.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Pe(t)});class Ld extends Ue{_parse(t){if(this._getType(t)!==me.nan){const n=this._getOrReturnCtx(t);return de(n,{code:ie.invalid_type,expected:me.nan,received:n.parsedType}),Ae}return{status:"valid",value:t.data}}}Ld.create=e=>new Ld({typeName:je.ZodNaN,...Pe(e)});const J7=Symbol("zod_brand");class hg extends Ue{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class zu extends Ue{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ae:i.status==="dirty"?(r.dirty(),Ii(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ae:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new zu({in:t,out:r,typeName:je.ZodPipeline})}}class Eu extends Ue{_parse(t){const r=this._def.innerType._parse(t),n=s=>(ti(s)&&(s.value=Object.freeze(s.value)),s);return cu(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}Eu.create=(e,t)=>new Eu({innerType:e,typeName:je.ZodReadonly,...Pe(t)});function Zb(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function jN(e,t={},r){return e?vl.create().superRefine((n,s)=>{var i,l;const o=e(n);if(o instanceof Promise)return o.then(u=>{var c,d;if(!u){const h=Zb(t,n),f=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;s.addIssue({code:"custom",...h,fatal:f})}});if(!o){const u=Zb(t,n),c=(l=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...u,fatal:c})}}):vl.create()}const eF={object:gt.lazycreate};var je;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(je||(je={}));const tF=(e,t={message:`Input not instance of ${e.name}`})=>jN(r=>r instanceof e,t),AN=dn.create,IN=sa.create,rF=Ld.create,nF=aa.create,RN=du.create,sF=ri.create,aF=Ad.create,iF=hu.create,lF=fu.create,oF=vl.create,uF=qa.create,cF=us.create,dF=Id.create,hF=pn.create,fF=gt.create,mF=gt.strictCreate,pF=mu.create,gF=Eh.create,xF=pu.create,yF=Mn.create,bF=gu.create,vF=Rd.create,wF=ni.create,EF=Vi.create,_F=xu.create,NF=yu.create,kF=ia.create,SF=bu.create,TF=wl.create,Xb=xn.create,CF=Ln.create,jF=la.create,AF=xn.createWithPreprocess,IF=zu.create,RF=()=>AN().optional(),LF=()=>IN().optional(),OF=()=>RN().optional(),PF={string:e=>dn.create({...e,coerce:!0}),number:e=>sa.create({...e,coerce:!0}),boolean:e=>du.create({...e,coerce:!0}),bigint:e=>aa.create({...e,coerce:!0}),date:e=>ri.create({...e,coerce:!0})},DF=Ae;var Cr=Object.freeze({__proto__:null,defaultErrorMap:bl,setErrorMap:A7,getErrorMap:Td,makeIssue:Cd,EMPTY_PATH:I7,addIssueToContext:de,ParseStatus:Zt,INVALID:Ae,DIRTY:Ii,OK:lr,isAborted:vp,isDirty:wp,isValid:ti,isAsync:cu,get util(){return Ke},get objectUtil(){return bp},ZodParsedType:me,getParsedType:Yn,ZodType:Ue,datetimeRegex:TN,ZodString:dn,ZodNumber:sa,ZodBigInt:aa,ZodBoolean:du,ZodDate:ri,ZodSymbol:Ad,ZodUndefined:hu,ZodNull:fu,ZodAny:vl,ZodUnknown:qa,ZodNever:us,ZodVoid:Id,ZodArray:pn,ZodObject:gt,ZodUnion:mu,ZodDiscriminatedUnion:Eh,ZodIntersection:pu,ZodTuple:Mn,ZodRecord:gu,ZodMap:Rd,ZodSet:ni,ZodFunction:Vi,ZodLazy:xu,ZodLiteral:yu,ZodEnum:ia,ZodNativeEnum:bu,ZodPromise:wl,ZodEffects:xn,ZodTransformer:xn,ZodOptional:Ln,ZodNullable:la,ZodDefault:vu,ZodCatch:wu,ZodNaN:Ld,BRAND:J7,ZodBranded:hg,ZodPipeline:zu,ZodReadonly:Eu,custom:jN,Schema:Ue,ZodSchema:Ue,late:eF,get ZodFirstPartyTypeKind(){return je},coerce:PF,any:oF,array:hF,bigint:nF,boolean:RN,date:sF,discriminatedUnion:gF,effect:Xb,enum:kF,function:EF,instanceof:tF,intersection:xF,lazy:_F,literal:NF,map:vF,nan:rF,nativeEnum:SF,never:cF,null:lF,nullable:jF,number:IN,object:fF,oboolean:OF,onumber:LF,optional:CF,ostring:RF,pipeline:IF,preprocess:AF,promise:TF,record:bF,set:wF,strictObject:mF,string:AN,symbol:aF,transformer:Xb,tuple:yF,undefined:iF,union:pF,unknown:uF,void:dF,NEVER:DF,ZodIssueCode:ie,quotelessJson:j7,ZodError:Lr});const MF=Cr.object({email:Cr.string().email({message:"Invalid email address"}),password:Cr.string().min(1,{message:"Password is required"})}),FF=Cr.object({username:Cr.string().min(3,{message:"Username must be at least 3 characters long"}).max(50,{message:"Username cannot exceed 50 characters"}),email:Cr.string().email({message:"Invalid email address"}),password:Cr.string().min(8,{message:"Password must be at least 8 characters long"}),confirmPassword:Cr.string(),role:Cr.enum(["player","dm"],{required_error:"Please select a role"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),UF=Cr.object({currentPassword:Cr.string().min(1,"Current password is required"),newPassword:Cr.string().min(8,"New password must be at least 8 characters"),confirmNewPassword:Cr.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"New passwords don't match",path:["confirmNewPassword"]});function BF(){const[e,t]=w.useState(""),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(null),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState({}),{updateUserPassword:g}=Ot(),b=async E=>{E.preventDefault(),o(null),c(null),p({});const x=UF.safeParse({currentPassword:e,newPassword:r,confirmPassword:s});if(!x.success){const y={};x.error.errors.forEach(v=>{const N=v.path[0];N?y[N]=v.message:o(v.message)}),p(y),!l&&Object.keys(y).length>0&&o("Please fix the errors in the form.");return}h(!0);try{const{currentPassword:y,newPassword:v}=x.data;await g(y,v),c("Password updated successfully!"),t(""),n(""),i("")}catch(y){console.error("Password update error:",y),o(y instanceof Error?y.message:"Failed to update password.")}finally{h(!1)}};return a.jsxs("form",{onSubmit:b,className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Change Password"}),l&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Et,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),u&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(ah,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:u})})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"current-password",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:E=>t(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.currentPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.currentPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.currentPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"new-password",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:E=>n(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.newPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.newPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.newPassword})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirm-password",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s,onChange:E=>i(E.target.value),className:`pl-10 block w-full shadow-sm sm:text-sm border rounded-md px-3 py-2 ${f.confirmPassword?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),f.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.confirmPassword})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{type:"submit",variant:"primary",loading:d,disabled:d,children:"Update Password"})})]})}async function LN(e){if(!e)return console.error("getUserProfile: No user ID provided."),null;try{const{data:t,error:r,status:n}=await re.from("users").select("id, username, first_name, last_name, avatar_url, bio").eq("id",e).single();if(r){if(n===406||r.code==="PGRST116")return console.warn(`No profile found for user ID: ${e}. This might be expected.`),null;throw console.error("Error fetching user profile:",r.message),new Error(`Failed to fetch user profile: ${r.message}`)}return t}catch(t){throw console.error("Unexpected error in getUserProfile:",t),t instanceof Error?t:new Error("An unknown error occurred while fetching the user profile.")}}async function HF(e,t){if(!e)throw new Error("updateUserProfile: No user ID provided.");if(!t||Object.keys(t).length===0)throw new Error("updateUserProfile: No updates provided.");const r={username:t.username,first_name:t.first_name,last_name:t.last_name,avatar_url:t.avatar_url,bio:t.bio};if(Object.keys(r).forEach(n=>{const s=n;r[s]===void 0&&delete r[s]}),Object.keys(r).length===0){console.warn("updateUserProfile: No valid fields to update after filtering.");const n=await LN(e);if(!n)throw new Error("Could not retrieve current profile after filtering updates.");return n}try{const{data:n,error:s}=await re.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select("id, username, first_name, last_name, avatar_url, bio").single();if(s)throw console.error("Error updating user profile:",s.message),s.code==="23505"?s.message.includes("users_username_key")?new Error(`Failed to update profile: Username '${r.username}' is already taken.`):new Error(`Failed to update profile: ${s.details||"A unique value constraint was violated."}`):new Error(`Failed to update user profile: ${s.message}`);if(!n)throw new Error("Failed to update user profile: No data returned.");return n}catch(n){throw console.error("Unexpected error in updateUserProfile:",n),n instanceof Error?n:new Error("An unknown error occurred while updating the user profile.")}}async function $F(e){if(!e)throw new Error("updateUserAuthEmail: No new email provided.");if(!/\S+@\S+\.\S+/.test(e))throw new Error("updateUserAuthEmail: Invalid email format provided.");try{const{data:t,error:r}=await re.auth.updateUser({email:e});if(r)throw console.error("Error updating user auth email:",r.message),r.message.includes("User not found")||r.status===404?new Error("Failed to initiate email update: Could not find the current user."):r.message.includes("Email rate limit exceeded")?new Error("Failed to initiate email update: Please wait before trying again."):r.message.includes("same as the existing email")?new Error("The new email address is the same as the current one."):new Error(`Failed to initiate email update: ${r.message}`);console.log("User auth email update initiated. Verification required.",t)}catch(t){throw console.error("Unexpected error in updateUserAuthEmail:",t),t instanceof Error?t:new Error("An unknown error occurred while updating the user's email.")}}function zF(){var R;const{user:e,session:t}=Ot(),[r,n]=w.useState(null),[s,i]=w.useState({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState(!0),[f,p]=w.useState(!1),[g,b]=w.useState(null),[E,x]=w.useState(null),y=w.useCallback(async j=>{var D,T,F;h(!0),b(null),x(null);try{const O=await LN(j.id),Q=j.email??"";O?(n(O),i({first_name:O.first_name??"",last_name:O.last_name??"",username:O.username??((D=j.user_metadata)==null?void 0:D.username)??"",avatar_url:O.avatar_url??"",bio:O.bio??""})):(console.warn("User profile not found in 'users' table, initializing form with defaults/metadata."),i({first_name:"",last_name:"",username:((T=j.user_metadata)==null?void 0:T.username)??"",avatar_url:"",bio:""})),o(Q),c(Q)}catch(O){console.error("Failed to load profile:",O),b(O instanceof Error?O.message:"Failed to load profile data.");const Q=(e==null?void 0:e.email)??"";o(Q),c(Q),i({first_name:"",last_name:"",username:((F=e==null?void 0:e.user_metadata)==null?void 0:F.username)??"",avatar_url:"",bio:""})}finally{h(!1)}},[]);w.useEffect(()=>{e?y(e):(h(!1),n(null),i({first_name:"",last_name:"",username:"",avatar_url:"",bio:""}),o(""),c(""),b(null),x(null))},[e,y]);const v=j=>{const{name:D,value:T}=j.target;i(F=>({...F,[D]:T})),b(null),x(null)},N=j=>{o(j.target.value),b(null),x(null)},_=async j=>{var Q;if(j.preventDefault(),!e){b("You must be logged in to update your profile.");return}p(!0),b(null),x(null);let D=!1,T=!1,F="",O=!1;try{const Y={},H=r??{username:((Q=e.user_metadata)==null?void 0:Q.username)??"",first_name:null,last_name:null,avatar_url:null,bio:null};if(s.first_name!==(H.first_name??"")&&(Y.first_name=s.first_name),s.last_name!==(H.last_name??"")&&(Y.last_name=s.last_name),s.username!==(H.username??"")&&(Y.username=s.username),s.avatar_url!==(H.avatar_url??"")&&(Y.avatar_url=s.avatar_url),s.bio!==(H.bio??"")&&(Y.bio=s.bio),Object.keys(Y).length>0){O=!0;const A=await HF(e.id,Y);n(M=>M?{...M,...A}:A),i({first_name:A.first_name??"",last_name:A.last_name??"",username:A.username??"",avatar_url:A.avatar_url??"",bio:A.bio??""}),D=!0}else D=!0;const B=l.trim();if(B!==u){if(!B)throw new Error("Email cannot be empty.");O=!0,await $F(B),T=!0,F=" Email update initiated. Please check both your current and new email addresses for a verification link to complete the change."}if(O){let A="";D&&Object.keys(Y).length>0&&(A+="Profile fields updated successfully."),A+=F,x(A.trim())}else x("No changes were detected.")}catch(Y){console.error("Failed to update profile:",Y);const H=Y instanceof Error?Y.message:"An unknown error occurred during update.";b(H)}finally{p(!1)}},S=j=>{var F;const D=j.currentTarget;D.style.display="none";const T=(F=D.parentElement)==null?void 0:F.querySelector(".fallback-icon");T&&(T.style.display="flex")};return d?a.jsx("div",{className:"flex justify-center items-center h-40",children:a.jsx(ze,{})}):!e||!t?a.jsx("p",{className:"text-center text-red-600",children:"Please log in to view or edit your profile."}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8",children:[a.jsx("div",{className:"relative w-24 h-24",children:a.jsxs("div",{className:"w-full h-full rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border",children:[s.avatar_url&&a.jsx("img",{src:s.avatar_url,alt:"Profile",className:"w-full h-full object-cover",onError:S,style:{display:"block"}},s.avatar_url),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center fallback-icon",style:{display:s.avatar_url?"none":"flex"},children:a.jsx(Al,{className:"w-12 h-12 text-gray-400"})})]})}),a.jsxs("div",{className:"flex-grow w-full sm:w-auto",children:[a.jsx("h3",{className:"font-medium text-lg text-center sm:text-left",children:s.username||((R=e==null?void 0:e.user_metadata)==null?void 0:R.username)||"User"}),a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center sm:justify-start gap-1",children:[a.jsx(F0,{className:"w-4 h-4"}),l||"No email set"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{htmlFor:"avatar_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar URL"}),a.jsx("input",{id:"avatar_url",name:"avatar_url",type:"url",value:s.avatar_url??"",onChange:v,placeholder:"https://example.com/avatar.png",className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("form",{onSubmit:_,className:"space-y-6",children:[E&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(ah,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Success!"})," ",E]})]}),g&&a.jsxs("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg flex items-start gap-2",role:"alert",children:[a.jsx(Et,{className:"w-5 h-5 mt-px flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Error!"})," ",g]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),a.jsx("input",{id:"first_name",name:"first_name",type:"text",value:s.first_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),a.jsx("input",{id:"last_name",name:"last_name",type:"text",value:s.last_name??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:l,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":"email-description"}),a.jsx("p",{id:"email-description",className:"text-xs text-gray-500 mt-1",children:"Changing your email requires verification via links sent to both addresses."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",value:s.username??"",onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be unique. Used for display and potentially logging in."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),a.jsx("textarea",{id:"bio",name:"bio",value:s.bio??"",onChange:v,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Tell us a little about yourself..."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(V,{type:"submit",variant:"primary",icon:Pr,loading:f,disabled:f||d,children:"Save Changes"})})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-12",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Change Password"}),a.jsx(BF,{})]})]})}function qF(){const[e,t]=w.useState("system"),[r,n]=w.useState("medium"),[s,i]=w.useState(!1),[l,o]=w.useState(!1),u=async c=>{c.preventDefault(),o(!0),await new Promise(d=>setTimeout(d,1e3)),o(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Appearance Settings"}),a.jsxs("form",{onSubmit:u,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("light"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="light"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(z2,{className:"w-6 h-6 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Light"})]}),a.jsxs("button",{type:"button",onClick:()=>t("dark"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="dark"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(O2,{className:"w-6 h-6 text-blue-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Dark"})]}),a.jsxs("button",{type:"button",onClick:()=>t("system"),className:`p-4 border rounded-lg flex flex-col items-center gap-2 ${e==="system"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[a.jsx(LA,{className:"w-6 h-6 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"System"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),a.jsxs("select",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"small",children:"Small"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"large",children:"Large"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:c=>i(c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reduce motion"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimize animations and transitions"})]}),a.jsxs("div",{className:"p-6 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsx("div",{className:`p-4 rounded-lg ${e==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:a.jsx("p",{className:`${r==="small"?"text-sm":r==="large"?"text-lg":"text-base"}`,children:"This is how your content will look with the selected theme and font size."})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{type:"submit",variant:"primary",icon:Pr,loading:l,children:"Save Changes"})})]})]})}function VF(){const[e,t]=w.useState({email:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,systemUpdates:!1},desktop:{newMessage:!0,partyInvite:!0,sessionScheduled:!0,diceRolls:!0},sounds:{enabled:!0,volume:80,diceRolls:!0,notifications:!0}}),[r,n]=w.useState(!1),s=async i=>{i.preventDefault(),n(!0),await new Promise(l=>setTimeout(l,1e3)),n(!1)};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Notification Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(F0,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Email Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.email).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,email:{...e.email,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(AA,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Desktop Notifications"})]}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.desktop).map(([i,l])=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:o=>t({...e,desktop:{...e.desktop,[i]:o.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:i.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase())})]},i))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(k2,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Sound Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.enabled,onChange:i=>t({...e,sounds:{...e.sounds,enabled:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Enable Sounds"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Volume (",e.sounds.volume,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",value:e.sounds.volume,onChange:i=>t({...e,sounds:{...e.sounds,volume:parseInt(i.target.value)}}),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.diceRolls,onChange:i=>t({...e,sounds:{...e.sounds,diceRolls:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Dice Roll Sounds"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.sounds.notifications,onChange:i=>t({...e,sounds:{...e.sounds,notifications:i.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Notification Sounds"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{type:"submit",variant:"primary",icon:Pr,loading:r,children:"Save Changes"})})]})]})}const WF=[{value:"en",label:"English"},{value:"et",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"sv",label:"Swedish"}],GF=[{value:"Europe/Tallinn",label:"Europe/Tallinn (UTC+2)"},{value:"Europe/Helsinki",label:"Europe/Helsinki (UTC+2)"},{value:"Europe/Stockholm",label:"Europe/Stockholm (UTC+1)"},{value:"UTC",label:"UTC"}],YF=[{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"YYYY-MM-DD",label:"YYYY-MM-DD"}],QF=[{value:"24h",label:"24-hour (14:30)"},{value:"12h",label:"12-hour (2:30 PM)"}];function KF(){const[e,t]=w.useState({language:"en",timeZone:"Europe/Tallinn",dateFormat:"DD/MM/YYYY",timeFormat:"24h",firstDayOfWeek:1,useMetricSystem:!0}),[r,n]=w.useState(!1),s=async o=>{o.preventDefault(),n(!0),await new Promise(u=>setTimeout(u,1e3)),n(!1)},i=new Date,l=new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"long",timeZone:e.timeZone}).format(i);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Localization Settings"}),a.jsxs("form",{onSubmit:s,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(I2,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Language & Region"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interface Language"}),a.jsx("select",{value:e.language,onChange:o=>t({...e,language:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:WF.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),a.jsx("select",{value:e.timeZone,onChange:o=>t({...e,timeZone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:GF.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(L0,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Date & Time Format"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),a.jsx("select",{value:e.dateFormat,onChange:o=>t({...e,dateFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:YF.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),a.jsx("select",{value:e.timeFormat,onChange:o=>t({...e,timeFormat:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:QF.map(o=>a.jsx("option",{value:o.value,children:o.label},o.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Day of Week"}),a.jsxs("select",{value:e.firstDayOfWeek,onChange:o=>t({...e,firstDayOfWeek:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"Monday"}),a.jsx("option",{value:0,children:"Sunday"})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(lh,{className:"w-5 h-5 text-gray-500"}),a.jsx("h3",{className:"font-medium",children:"Measurement System"})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.useMetricSystem,onChange:o=>t({...e,useMetricSystem:o.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Use Metric System"})]})})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current date and time: ",l]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{type:"submit",variant:"primary",icon:Pr,loading:r,children:"Save Changes"})})]})]})}function ZF({onClose:e,onUserCreated:t}){const[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState("player"),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(!1),[g,b]=w.useState(null),[E,x]=w.useState(!1),[y,v]=w.useState([]),[N,_]=w.useState(!1),[S,R]=w.useState(null),j=async()=>{_(!0),R(null);const{data:F,error:O}=await re.from("users").select("*");O?R(O.message):v(F),_(!1)};w.useEffect(()=>{j()},[]);const D=async F=>{F.preventDefault(),c(null),p(!0);try{const O=Math.random().toString(36).slice(-12),{data:Q,error:Y}=await re.auth.signUp({email:r,password:O,options:{data:{username:s}}});if(Y)throw Y;if(!Q.user)throw new Error("Failed to create user");const{error:H}=await re.from("users").update({role:l}).eq("id",Q.user.id);if(H)throw H;const B=new URL(window.location.origin);B.searchParams.set("email",r),B.searchParams.set("password",O),b(B.toString()),h(!0),t(),j()}catch(O){c(O instanceof Error?O.message:"Failed to create user")}finally{p(!1)}},T=async()=>{if(g)try{await navigator.clipboard.writeText(g),x(!0),setTimeout(()=>x(!1),2e3)}catch{c("Failed to copy link to clipboard")}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Create New User"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),u&&a.jsxs("div",{className:"mb-6 flex items-start gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(Et,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-700",children:u})]}),d&&g?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"User Created Successfully!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Share the following link with the user to let them sign in:"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:g,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50"}),a.jsx(V,{variant:"secondary",icon:E?Bi:j2,onClick:T,children:E?"Copied!":"Copy"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{variant:"primary",onClick:e,children:"Done"})})]}):a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:r,onChange:F=>n(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),a.jsx("input",{type:"text",required:!0,value:s,onChange:F=>i(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{value:l,onChange:F=>o(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"player",children:"Player"}),a.jsx("option",{value:"dm",children:"Dungeon Master"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(V,{variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(V,{type:"submit",variant:"primary",icon:Al,loading:f,children:"Create User"})]})]})]}),a.jsxs("div",{className:"p-6 border-t",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Created Users"}),N?a.jsx("p",{children:"Loading users..."}):S?a.jsxs("p",{className:"text-red-600",children:["Error loading users: ",S]}):y.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(F=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:F.username}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:F.email}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:F.role}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(F.created_at).toLocaleString()}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:F.account_status||"N/A"})]},F.id))})]})}):a.jsx("p",{children:"No users found."})]})]})})}function XF(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState("all"),[d,h]=w.useState(!1),f=w.useCallback(async()=>{n(!0),i(null);try{const{data:x,error:y}=await re.from("users").select("id, email, username, role, created_at, last_login, first_name, last_name, is_active").order("created_at",{ascending:!1});if(y)throw y;t(x||[])}catch(x){console.error("Error fetching users:",x),i(`Failed to load users: ${x.message||"Unknown error"}`),t([])}finally{n(!1)}},[]);w.useEffect(()=>{f()},[f]);const p=()=>{h(!1),f()},g=e.filter(x=>{const y=l.toLowerCase(),v=x.username&&x.username.toLowerCase().includes(y)||x.email&&x.email.toLowerCase().includes(y)||x.first_name&&x.first_name.toLowerCase().includes(y)||x.last_name&&x.last_name.toLowerCase().includes(y),N=u==="all"||x.role&&x.role.toLowerCase()===u.toLowerCase();return v&&N}),b=x=>{const y=x==null?void 0:x.toLowerCase();return y==="admin"?"bg-purple-100 text-purple-800":y==="dm"||y==="dungeon master"?"bg-blue-100 text-blue-800":y==="player"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},E=x=>x.username?x.username:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.first_name?x.first_name:x.email.split("@")[0];return a.jsxs("div",{className:"space-y-6 p-4 md:p-6 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"User Management"}),a.jsx(V,{variant:"primary",icon:zt,onClick:()=>h(!0),className:"w-full sm:w-auto",children:"Create User"})]}),s&&a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg shadow-sm",children:[a.jsx(Et,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-800",children:"Error Loading Users"}),a.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(na,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, username...",value:l,onChange:x=>o(x.target.value),className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-colors",disabled:r})]}),a.jsxs("div",{className:"relative md:min-w-[200px]",children:[a.jsx(hs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),a.jsxs("select",{value:u,onChange:x=>c(x.target.value),className:"w-full pl-11 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white shadow-sm transition-colors",disabled:r,children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"player",children:"Players"}),a.jsx("option",{value:"dm",children:"Dungeon Masters"}),a.jsx("option",{value:"admin",children:"Administrators"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),r&&e.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):!r&&e.length===0&&!s?a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(Users,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500",children:"There are currently no users to display. Try creating one!"})]}):a.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold",children:[x.first_name?x.first_name.charAt(0).toUpperCase():x.email.charAt(0).toUpperCase(),x.last_name?x.last_name.charAt(0).toUpperCase():x.username?x.username.charAt(0).toUpperCase():""]}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:E(x)}),a.jsx("div",{className:"text-xs text-gray-500",children:x.email})]})]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${b(x.role||"N/A")}`,children:x.role?x.role.charAt(0).toUpperCase()+x.role.slice(1):"N/A"})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap",children:x.is_active===void 0||x.is_active===null?a.jsx("span",{className:"text-xs text-gray-500",children:"Unknown"}):x.is_active?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:[a.jsx(ah,{className:"w-3.5 h-3.5 mr-1.5"})," Active"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:[a.jsx(ih,{className:"w-3.5 h-3.5 mr-1.5"})," Inactive"]})}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm text-gray-500",children:x.last_login?new Date(x.last_login).toLocaleString():"Never"}),a.jsx("td",{className:"px-5 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"icon",size:"sm",title:"Edit User",className:"text-gray-500 hover:text-blue-600",children:a.jsx(D2,{className:"w-4 h-4"})}),a.jsx(V,{variant:"icon",size:"sm",title:"Delete User",className:"text-gray-500 hover:text-red-600",children:a.jsx(Kr,{className:"w-4 h-4"})})]})})]},x.id))})]})}),g.length===0&&!r&&e.length>0&&a.jsxs("div",{className:"text-center py-10 px-4",children:[a.jsx(na,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-xl font-semibold text-gray-700 mb-1",children:"No Users Match Your Search"}),a.jsx("p",{className:"text-gray-500",children:"Try adjusting your search term or role filter."})]}),d&&a.jsx(ZF,{onClose:()=>h(!1),onUserCreated:p})]})}var ON={exports:{}},JF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eU=JF,tU=eU;function PN(){}function DN(){}DN.resetWarningCache=PN;var rU=function(){function e(n,s,i,l,o,u){if(u!==tU){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:DN,resetWarningCache:PN};return r.PropTypes=r,r};ON.exports=rU();var nU=ON.exports;const kc=Od(nU);function _p(){return _p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_p.apply(this,arguments)}function sU(e,t){if(e==null)return{};var r=aU(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aU(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var fg=w.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,s=e.size,i=s===void 0?24:s,l=sU(e,["color","size"]);return Wr.createElement("svg",_p({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),Wr.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Wr.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});fg.propTypes={color:kc.string,size:kc.oneOfType([kc.string,kc.number])};fg.displayName="X";function iU({entry:e,onChange:t}){const[r,n]=w.useState(e),[s,i]=w.useState({gold:0,silver:0,copper:0}),[l,o]=w.useState([]);w.useEffect(()=>{if(n(e),e.cost){const d=e.cost.split(",").map(f=>f.trim()),h={gold:0,silver:0,copper:0};d.forEach(f=>{f.includes("gold")?h.gold=parseInt(f.replace("gold","").trim())||0:f.includes("silver")?h.silver=parseInt(f.replace("silver","").trim())||0:f.includes("copper")&&(h.copper=parseInt(f.replace("copper","").trim())||0)}),i(h)}e.features&&o(e.features)},[e]);const u=(d,h)=>{const f=parseInt(h)||0,p={...s,[d]:f};i(p),t("cost",`${p.gold} gold, ${p.silver} silver, ${p.copper} copper`)},c=d=>{const h=l.filter((f,p)=>p!==d);o(h),t("features",h)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:d=>t("name",d.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:r.category||"",onChange:d=>t("category",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"ARMOR & HELMETS",children:"Armor & Helmets"}),a.jsx("option",{value:"MELEE WEAPONS",children:"Melee Weapons"}),a.jsx("option",{value:"RANGED WEAPONS",children:"Ranged Weapons"}),a.jsx("option",{value:"CLOTHES",children:"Clothes"}),a.jsx("option",{value:"MUSICAL INSTRUMENTS",children:"Musical Instruments"}),a.jsx("option",{value:"TRADE GOODS",children:"Trade Goods"}),a.jsx("option",{value:"STUDIES & MAGIC",children:"Studies & Magic"}),a.jsx("option",{value:"LIGHT SOURCES",children:"Light Sources"}),a.jsx("option",{value:"TOOLS",children:"Tools"}),a.jsx("option",{value:"CONTAINERS",children:"Containers"}),a.jsx("option",{value:"MEDICINE",children:"Medicine"}),a.jsx("option",{value:"SERVICES",children:"Services"}),a.jsx("option",{value:"HUNTING & FISHING",children:"Hunting & Fishing"}),a.jsx("option",{value:"MEANS OF TRAVEL",children:"Means of Travel"}),a.jsx("option",{value:"ANIMALS",children:"Animals"})]})]}),r.category==="ARMOR & HELMETS"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor Rating"}),a.jsx("input",{type:"number",value:r.armor_rating||"",onChange:d=>t("armor_rating",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),r.category==="MELEE WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),r.category==="RANGED WEAPONS"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grip"}),a.jsxs("select",{value:r.grip||"1H",onChange:d=>t("grip",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"1H",children:"1H"}),a.jsx("option",{value:"2H",children:"2H"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"STR Requirement"}),a.jsx("input",{type:"number",value:r.strength_requirement||"",onChange:d=>t("strength_requirement",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Range"}),a.jsx("input",{type:"text",value:r.range||"",onChange:d=>t("range",d.target.value),placeholder:"Enter range value or STR",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Damage"}),a.jsx("input",{type:"text",value:r.damage||"",onChange:d=>t("damage",d.target.value),placeholder:"e.g. D6, D8, 2D8",className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durability"}),a.jsx("input",{type:"number",value:r.durability||"",onChange:d=>t("durability",parseInt(d.target.value)),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.gold,onChange:d=>u("gold",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Gold"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.silver,onChange:d=>u("silver",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Silver"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"number",value:s.copper,onChange:d=>u("copper",d.target.value),className:"w-full px-3 py-2 border rounded-l-md",placeholder:"0"}),a.jsx("span",{className:"inline-flex items-center px-3 border border-l-0 rounded-r-md text-gray-700",children:"Copper"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supply"}),a.jsxs("select",{value:r.supply||"",onChange:d=>t("supply",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Supply"}),a.jsx("option",{value:"Common",children:"Common"}),a.jsx("option",{value:"Uncommon",children:"Uncommon"}),a.jsx("option",{value:"Rare",children:"Rare"}),a.jsx("option",{value:"Unique",children:"Unique"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:r.weight||"",onChange:d=>t("weight",parseFloat(d.target.value)),className:"w-full px-3 py-2 border rounded-md",min:"0",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effect/Description"}),a.jsx("textarea",{value:r.effect||"",onChange:d=>t("effect",d.target.value.toUpperCase()),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((d,h)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md px-2 py-1 text-sm",children:[a.jsx("span",{children:d}),a.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-2 text-red-500 hover:text-red-700",children:a.jsx(fg,{className:"w-4 h-4"})})]},h)),a.jsx("input",{type:"text",onKeyDown:d=>{if(d.key==="Enter"&&d.currentTarget.value.trim()){d.preventDefault();const h=d.currentTarget.value.trim(),f=[...l,h];o(f),t("features",f),d.currentTarget.value=""}},className:"px-3 py-2 border rounded-md",placeholder:"Add feature..."})]})]})]})}const lU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:r=>t("heroic_ability",r.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abilities"}),(e.abilities||[]).map((r,n)=>a.jsxs("div",{className:"flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",placeholder:"Ability Description",value:r.description||"",onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],description:s.target.value},t("abilities",i)},className:"border rounded-md px-2 py-1 flex-1"}),a.jsx("input",{type:"number",placeholder:"Willpower Points",value:r.willpower_points||0,onChange:s=>{const i=[...e.abilities||[]];i[n]={...i[n],willpower_points:parseInt(s.target.value)},t("abilities",i)},className:"border rounded-md px-2 py-1 w-20",min:"0"}),a.jsx("button",{onClick:()=>{const s=[...e.abilities||[]];s.splice(n,1),t("abilities",s)},className:"text-red-600",children:"Remove"})]},n)),a.jsx("button",{onClick:()=>{const r=[...e.abilities||[],{description:"",willpower_points:0}];t("abilities",r)},className:"mt-2 text-blue-600",children:"Add Ability"})]})]}),oU=["Acrobatics","Animism","Awareness","Axes","Bartering","Beast Lore","Bluffing","Bows","Brawling","Bushcraft","Crossbows","Crafting","Evade","Elementalism","Healing","Hammers","Hunting & Fishing","Knives","Languages","Mentalism","Myths & Legends","Performance","Persuasion","Riding","Seamanship","Sleight of Hand","Sneaking","Slings","Spears","Spot Hidden","Staves","Swords","Swimming"].sort(),uU=({entry:e,onChange:t})=>{const[r,n]=w.useState("skills"),s=e.starting_equipment||["","",""],i=e.equipment_description||["","",""],l=(o,u,c)=>{if(u==="equipment"){const d=[...s];d[o]=c,t("starting_equipment",d)}else{const d=[...i];d[o]=c,t("equipment_description",d)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:e.name||"",onChange:o=>t("name",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:e.description||"",onChange:o=>t("description",o.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute"}),a.jsx("input",{type:"text",value:e.key_attribute||"",onChange:o=>t("key_attribute",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heroic Ability"}),a.jsx("input",{type:"text",value:e.heroic_ability||"",onChange:o=>t("heroic_ability",o.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Magic School"}),a.jsxs("select",{value:e.magic_school_id||"",onChange:o=>t("magic_school_id",o.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"Animist",children:"Animist"}),a.jsx("option",{value:"Elementalist",children:"Elementalist"}),a.jsx("option",{value:"Mentalist",children:"Mentalist"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex border-b",children:[a.jsx("button",{type:"button",onClick:()=>n("skills"),className:`px-4 py-2 -mb-px font-medium ${r==="skills"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Skills"}),a.jsx("button",{type:"button",onClick:()=>n("startingEquipment"),className:`px-4 py-2 -mb-px font-medium ${r==="startingEquipment"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:"Starting Equipment"})]}),r==="skills"&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:oU.map(o=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:e.skills?e.skills.includes(o):!1,onChange:u=>{let c=e.skills?[...e.skills]:[];u.target.checked?c.push(o):c=c.filter(d=>d!==o),t("skills",c)}}),a.jsx("span",{className:"text-sm",children:o})]},o))})]}),r==="startingEquipment"&&a.jsx("div",{className:"mt-4 space-y-4",children:[0,1,2].map(o=>a.jsxs("div",{className:"border p-2 rounded-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment Option ",o+1]}),a.jsx("input",{type:"text",placeholder:"Enter equipment (e.g., Horn or Flute, knife, torch)",value:s[o]||"",onChange:u=>l(o,"equipment",u.target.value),className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (e.g., D6 food rations, D8 silver)",value:i[o]||"",onChange:u=>l(o,"description",u.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})]},o))})]})]})},cU=({entry:e,onChange:t})=>{const{skills:r,loading:n,error:s}=nE(),[i,l]=w.useState(!1),[o,u]=w.useState(!1),[c,d]=w.useState({}),h=w.useCallback(()=>{if(n||!r||r.length===0)return;u(!0);const g=e.requirement;let b={};if(z0(g))b=g,console.log("AbilityForm: Initial requirement is already name-based:",g);else if(Ay(g)){console.log("AbilityForm: Initial requirement is UUID-based, converting:",g);const E=new Map(r.map(x=>[x.id,x.name]));for(const[x,y]of Object.entries(g)){const v=E.get(x);v?b[v]=y:console.warn(`AbilityForm: Could not find skill name for UUID ${x} during initialization.`)}console.log("AbilityForm: Converted to name-based requirements:",b)}else typeof g=="string"||g===null||g===void 0?(console.log("AbilityForm: Initial requirement is simple string, null, or undefined:",g),b={}):(console.warn("AbilityForm: Unrecognized requirement format during initialization:",g),b={});d(b),u(!1)},[e.requirement,r,n]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{t("requirement",c)},[c,t]);const f=(g,b)=>{typeof g=="string"&&d(E=>{const x={...E};return b?x.hasOwnProperty(g)||(x[g]=null):delete x[g],x})},p=(g,b)=>{if(typeof g!="string")return;const E=b===""?null:parseInt(b,10);c.hasOwnProperty(g)&&d(x=>({...x,[g]:isNaN(E)?null:E}))};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{id:"ability-name",type:"text",value:e.name||"",onChange:g=>t("name",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{id:"ability-description",value:e.description||"",onChange:g=>t("description",g.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-willpower_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Willpower Cost"}),a.jsx("input",{id:"ability-willpower_cost",type:"number",value:e.willpower_cost===null||e.willpower_cost===void 0?"":e.willpower_cost,onChange:g=>t("willpower_cost",g.target.value===""?null:parseInt(g.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-profession",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profession (Optional)"}),a.jsx("input",{id:"ability-profession",type:"text",value:e.profession||"",onChange:g=>t("profession",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain profession."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"ability-kin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kin (Optional)"}),a.jsx("input",{id:"ability-kin",type:"text",value:e.kin||"",onChange:g=>t("kin",g.target.value||null),placeholder:"Leave blank if applicable to all",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify if this ability is restricted to a certain kin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Requirements (Optional)"}),a.jsxs("details",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden",open:i,onToggle:g=>l(g.target.open),children:[a.jsx("summary",{className:"px-3 py-2 cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-t-md",children:Object.keys(c).length>0?`${Object.keys(c).length} skill(s) selected`:"Select required skills..."}),a.jsx("div",{className:"p-4 border-t border-gray-200 max-h-60 overflow-y-auto",children:n||o?a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(ze,{size:"md"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading skills..."})]}):s?a.jsx(Ce,{message:`Error loading skills: ${s}`}):r.length===0?a.jsx("p",{className:"text-gray-500",children:"No skills available."}):a.jsx("ul",{className:"space-y-2",children:r.map(g=>{const b=g.name,E=c.hasOwnProperty(b),x=c[b];return a.jsxs("li",{className:"flex items-center space-x-3",children:[" ",a.jsx("input",{id:`skill-req-${g.id}`,type:"checkbox",checked:E,onChange:y=>f(b,y.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`skill-req-${g.id}`,className:"flex-1 text-sm text-gray-700",children:[g.name," ",g.attribute?`(${g.attribute})`:""]}),E&&a.jsx("input",{type:"number",min:"1",placeholder:"Level (Opt.)",value:x??"",onChange:y=>p(b,y.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500"})]},g.id)})})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select skills required for this ability and optionally specify a minimum level. Requirements are now stored by skill name."}),typeof e.requirement=="string"&&e.requirement&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:a.jsxs("p",{className:"text-xs text-yellow-700",children:[a.jsx("strong",{children:"Note:"}),' This ability has a non-skill requirement text: "',e.requirement,'". Saving will overwrite this if skills are selected above.']})}),Ay(e.requirement)&&o&&a.jsx("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded",children:a.jsx("p",{className:"text-xs text-orange-700",children:"Attempting to convert legacy UUID-based requirements..."})})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]})};function MN(e){return typeof e!="object"||e===null||!e.type?!1:e.type==="logical"?(e.operator==="AND"||e.operator==="OR")&&Array.isArray(e.conditions)&&e.conditions.every(MN):["spell","school","skill","attribute"].includes(e.type)?typeof e.name=="string":e.type==="anySchool"}function dU({entry:e,onChange:t,magicSchools:r=[]}){const[n,s]=w.useState(""),[i,l]=w.useState(null);w.useEffect(()=>{if(e.prerequisite)try{typeof e.prerequisite=="object"&&e.prerequisite!==null?s(JSON.stringify(e.prerequisite,null,2)):typeof e.prerequisite=="string"&&(JSON.parse(e.prerequisite),s(JSON.stringify(JSON.parse(e.prerequisite),null,2)))}catch{s(e.prerequisite)}else s("")},[e.prerequisite]);const o=c=>{const d=c.target.value;if(s(d),d.trim()===""){t("prerequisite",null),l(null);return}try{const h=JSON.parse(d);MN(h)?(t("prerequisite",JSON.stringify(h)),l(null)):l("Invalid prerequisite JSON structure. Please check the format.")}catch{l("Invalid JSON. Please ensure correct JSON syntax.")}},u=c=>{const{name:d,value:h,type:f}=c.target;let p=h;f==="number"&&c.target instanceof HTMLInputElement&&(p=h===""?null:parseInt(h,10),isNaN(p)&&(p=null)),d==="school_id"&&h===""&&(p=null),t(d,p)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("input",{type:"text",name:"name",id:"name",value:e.name||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),a.jsx("textarea",{name:"description",id:"description",rows:3,value:e.description||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"school_id",className:"block text-sm font-medium text-gray-700",children:"Magic School"}),a.jsxs("select",{name:"school_id",id:"school_id",value:e.school_id||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white",children:[a.jsx("option",{value:"",children:"General"}),r.map(c=>a.jsx("option",{value:c.id,children:c.name},c.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rank",className:"block text-sm font-medium text-gray-700",children:"Rank (0 for Trick)"}),a.jsx("input",{type:"number",name:"rank",id:"rank",min:"0",max:"5",value:e.rank??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"casting_time",className:"block text-sm font-medium text-gray-700",children:"Casting Time"}),a.jsx("input",{type:"text",name:"casting_time",id:"casting_time",value:e.casting_time||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"range",className:"block text-sm font-medium text-gray-700",children:"Range"}),a.jsx("input",{type:"text",name:"range",id:"range",value:e.range||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),a.jsx("input",{type:"text",name:"duration",id:"duration",value:e.duration||"",onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"willpower_cost",className:"block text-sm font-medium text-gray-700",children:"Willpower Cost"}),a.jsx("input",{type:"number",name:"willpower_cost",id:"willpower_cost",min:"0",value:e.willpower_cost??0,onChange:u,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"prerequisite",className:"block text-sm font-medium text-gray-700",children:"Learning Prerequisite (JSON or leave empty)"}),a.jsx("textarea",{name:"prerequisite",id:"prerequisite",rows:6,value:n,onChange:o,placeholder:'JSON for learning, e.g., {"type": "spell", "name": "Light"}. Leave empty for no prerequisite.',className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 focus:outline-none sm:text-sm ${i?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),i&&a.jsx("p",{className:"mt-2 text-sm text-red-600",children:i}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Use JSON format for learning prerequisites. Examples: ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "anySchool"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "spell", "name": "Example Spell"}'})," ",a.jsx("br",{}),a.jsx("code",{children:'{"type": "logical", "operator": "AND", "conditions": [...]}'})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"requirement",className:"block text-sm font-medium text-gray-700",children:"Casting Requirement (Text or leave empty)"}),a.jsx("textarea",{name:"requirement",id:"requirement",rows:3,value:e.requirement||"",onChange:u,placeholder:"e.g., Requires a free hand, or Verbal component only. Leave empty if none.",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe any requirements for casting the spell (e.g., components, conditions)."})]})]})}const hU=({entry:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Name"}),a.jsx("input",{id:"skill-name",type:"text",value:e.name||"",onChange:r=>t("name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx("textarea",{id:"skill-description",value:e.description||"",onChange:r=>t("description",r.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"skill-attribute",className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Attribute (Optional)"}),a.jsx("input",{id:"skill-attribute",type:"text",value:e.attribute||"",onChange:r=>t("attribute",r.target.value||null),placeholder:"e.g., STR, AGL, INT...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The primary attribute associated with this skill."})]}),e.created_at&&a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleString()]})})]}),fU=["Small","Normal","Large","Huge","Swarm"],Jb=()=>({FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0}),mU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:"",effects:[]}),pU=()=>({id:crypto.randomUUID(),roll_values:"",name:"",description:""});function gU({entry:e,onChange:t}){const[r,n]=w.useState({...e,stats:e.stats||Jb(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))});w.useEffect(()=>{n({...e,stats:e.stats||Jb(),attacks:(e.attacks||[]).map(f=>({...f,id:f.id||crypto.randomUUID(),effects:(f.effects||[]).map(p=>({...p,id:p.id||crypto.randomUUID()}))}))})},[e]);const s=w.useCallback((f,p)=>{const g={...r,[f]:p};n(g),t(f,p)},[r,t]),i=w.useCallback((f,p)=>{const g={...r.stats,[f]:p};s("stats",g)},[r.stats,s]),l=w.useCallback(()=>{const f=[...r.attacks,mU()];s("attacks",f)},[r.attacks,s]),o=w.useCallback((f,p,g)=>{const b=[...r.attacks];b[f]={...b[f],[p]:g},s("attacks",b)},[r.attacks,s]),u=w.useCallback(f=>{const p=r.attacks.filter((g,b)=>b!==f);s("attacks",p)},[r.attacks,s]),c=w.useCallback(f=>{const p=[...r.attacks];p[f].effects=[...p[f].effects||[],pU()],s("attacks",p)},[r.attacks,s]),d=w.useCallback((f,p,g,b)=>{const E=[...r.attacks];E[f].effects&&(E[f].effects[p]={...E[f].effects[p],[g]:b},s("attacks",E))},[r.attacks,s]),h=w.useCallback((f,p)=>{const g=[...r.attacks];g[f].effects&&(g[f].effects=g[f].effects.filter((b,E)=>E!==p),s("attacks",g))},[r.attacks,s]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",value:r.name||"",onChange:f=>s("name",f.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:r.category||"",onChange:f=>s("category",f.target.value),placeholder:"e.g., Beast, Undead, Humanoid",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:r.description||"",onChange:f=>s("description",f.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Statistics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferocity"}),a.jsx("input",{type:"number",value:r.stats.FEROCITY,onChange:f=>i("FEROCITY",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),a.jsx("select",{value:r.stats.SIZE,onChange:f=>i("SIZE",f.target.value),className:"w-full px-3 py-2 border rounded-md",children:fU.map(f=>a.jsx("option",{value:f,children:f},f))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movement"}),a.jsx("input",{type:"number",value:r.stats.MOVEMENT,onChange:f=>i("MOVEMENT",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Armor"}),a.jsx("input",{type:"number",value:r.stats.ARMOR,onChange:f=>i("ARMOR",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HP"}),a.jsx("input",{type:"number",value:r.stats.HP,onChange:f=>i("HP",parseInt(f.target.value,10)||0),className:"w-full px-3 py-2 border rounded-md"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effects Summary"}),a.jsx("textarea",{value:r.effectsSummary||"",onChange:f=>s("effectsSummary",f.target.value),rows:3,placeholder:"Describe any special effects or abilities here...",className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"p-4 border rounded-md shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attacks (D6 Rollable Table)"}),a.jsx(V,{variant:"secondary",size:"sm",icon:ep,onClick:l,children:"Add Attack"})]}),r.attacks.length===0&&a.jsx("p",{className:"text-gray-500",children:'No attacks defined. Click "Add Attack" to create one.'}),r.attacks.map((f,p)=>a.jsxs("div",{className:"p-3 border rounded-md mb-4 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-2",children:[a.jsx("input",{type:"text",placeholder:"Roll Values (e.g., 1, 2-3)",value:f.roll_values,onChange:g=>o(p,"roll_values",g.target.value),className:"px-3 py-2 border rounded-md"}),a.jsx("input",{type:"text",placeholder:"Attack Name",value:f.name,onChange:g=>o(p,"name",g.target.value),className:"md:col-span-2 px-3 py-2 border rounded-md"})]}),a.jsx("textarea",{placeholder:"Attack Description",value:f.description,onChange:g=>o(p,"description",g.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md mb-2"}),a.jsxs("div",{className:"ml-4 mt-2 p-3 border-l-2 border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Effects (Optional D6 Table)"}),a.jsx(V,{variant:"outline",size:"xs",icon:ep,onClick:()=>c(p),children:"Add Effect"})]}),f.effects.length===0&&a.jsx("p",{className:"text-gray-500",children:'No effects for this attack. Click "Add Effect" to create one.'}),f.effects.map((g,b)=>a.jsxs("div",{className:"p-2 border rounded-md mb-2 bg-white",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-1",children:[a.jsx("input",{type:"text",placeholder:"Roll (e.g., 1-2)",value:g.roll_values,onChange:E=>d(p,b,"roll_values",E.target.value),className:"px-2 py-1 border rounded-md text-sm"}),a.jsx("input",{type:"text",placeholder:"Effect Name",value:g.name,onChange:E=>d(p,b,"name",E.target.value),className:"md:col-span-2 px-2 py-1 border rounded-md text-sm"})]}),a.jsx("textarea",{placeholder:"Effect Description",value:g.description,onChange:E=>d(p,b,"description",E.target.value),rows:1,className:"w-full px-2 py-1 border rounded-md text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(V,{variant:"danger",size:"xs",icon:Kr,onClick:()=>h(p,b),children:"Remove Effect"})})]},g.id))]}),a.jsx("div",{className:"text-right",children:a.jsx(V,{variant:"danger",size:"sm",icon:Kr,onClick:()=>u(p),children:"Remove Attack"})})]},f.id))]})]})}function xU(e){const[t,r]=w.useState([]),[n,s]=w.useState(!0),[i,l]=w.useState(null),[o,u]=w.useState(e),c=w.useCallback(g=>{switch(g){case"spells":return"game_spells";case"items":return"game_items";case"abilities":return"heroic_abilities";case"kin":return"kin";case"profession":return"professions";case"skills":return"game_skills";case"monsters":return"monsters";default:throw console.error(`Invalid data category passed to getTableName: ${g}`),new Error(`Invalid data category: ${g}`)}},[]),d=w.useCallback(async g=>{s(!0),l(null);let b;try{b=c(g),console.log(`[useGameData] Attempting to load category: ${g}, using table: ${b}`);let E=re.from(b);g==="spells"?E=E.select(`
                *,
                magic_schools ( name )
              `):E=E.select("*"),E=E.order("name"),console.log(`[useGameData] Executing query for table: ${b}`);const{data:x,error:y}=await E;if(y)throw console.error(`[useGameData] Supabase fetch error for ${b}:`,y),y;const v=(x||[]).map(N=>{var S;let _={...N};if(g==="spells"&&(_.magic_schools=(S=N.magic_schools)==null?void 0:S.name),g==="abilities"&&typeof N.requirement=="string")try{_.requirement=JSON.parse(N.requirement)}catch{}return _});console.log(`[useGameData] Loaded ${v.length} entries for ${g} from ${b}`),r(v)}catch(E){const x=b||g;console.error(`[useGameData] Error in loadEntries for ${x}:`,E);const y=(E==null?void 0:E.message)||`Failed to load ${x}`,v=E!=null&&E.details?`: ${E.details}`:"";l(`${y}${v}`),r([])}finally{s(!1)}},[c]),h=w.useCallback(async(g,b,E,x)=>{let y="";try{x(null),s(!0),y=c(g);const{id:v,...N}=b;let _={...N};if(!_.name||String(_.name).trim()==="")throw new Error(`Cannot save ${g} without a name.`);if(g==="abilities"&&(_.willpower_cost=_.willpower_cost===""||_.willpower_cost===void 0?null:Number(_.willpower_cost),typeof _.requirement=="object"&&_.requirement!==null?Object.keys(_.requirement).length>0?_.requirement=JSON.stringify(_.requirement):_.requirement=null:(_.requirement===""||_.requirement===void 0)&&(_.requirement=null),_.kin=_.kin||null,_.profession=_.profession||null),g==="spells"&&(_.rank=Number(_.rank??0),_.willpower_cost=Number(_.willpower_cost??0),_.school_id=_.school_id||null,_.requirement=_.requirement||null),g==="skills"&&(_.attribute=_.attribute||null),g==="monsters"){const j=b;if(_.stats=j.stats||{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:0},_.attacks=j.attacks||[],Array.isArray(_.attacks)&&(_.attacks=_.attacks.map(D=>{const{id:T,effects:F,...O}=D;return Array.isArray(F)&&(O.effects=F.map(Q=>{const{id:Y,...H}=Q;return H})),O})),!v){const{data:D,error:T}=await re.auth.getSession();if(T||!D.session)throw new Error("User not authenticated. Cannot save monster.");_.created_by=D.session.user.id}}console.log(`[useGameData] Saving entry to ${y} (ID: ${v||"new"}):`,_);let S=null,R=null;if(v){const{data:j,error:D}=await re.from(y).update(_).eq("id",v).select().single();S=D,R=j}else{const{data:j,error:D}=await re.from(y).insert([_]).select().single();S=D,R=j}if(S)throw console.error(`[useGameData] Supabase Save Error (${y}):`,S),S;R?(console.log(`[useGameData] Save operation successful for ${g} (ID: ${R.id})`),E(R)):(console.warn(`[useGameData] Save operation for ${g} (ID: ${v||"new"}) did not return data. Using input data for callback.`),E({...b,id:v||(R==null?void 0:R.id)})),await d(g)}catch(v){const N=y||g,_=(v==null?void 0:v.message)||(typeof v=="string"?v:"An unexpected error occurred during save."),S=v!=null&&v.details?` (Details: ${v.details})`:"",R=v!=null&&v.code?` (Code: ${v.code})`:"",j=`Error saving ${N}: ${_}${S}${R}`;console.error(`[useGameData] Error in handleSave for ${N}:`,v),x(j)}finally{s(!1)}},[c,d]),f=w.useCallback(async(g,b)=>{if(!window.confirm(`Are you sure you want to delete this ${g} entry (ID: ${b})? This action cannot be undone.`))return;let E="";try{l(null),s(!0),E=c(g),console.log(`[useGameData] Deleting entry from ${E}, ID: ${b}`);const{error:x}=await re.from(E).delete().eq("id",b);if(x)throw console.error(`[useGameData] Error deleting from ${E}:`,x),x;console.log(`[useGameData] Delete successful for ID: ${b} in ${g}`),await d(g)}catch(x){const y=E||g,v=(x==null?void 0:x.message)||"An unexpected error occurred during deletion.",N=x!=null&&x.details?` (Details: ${x.details})`:"",_=x!=null&&x.code?` (Code: ${x.code})`:"",S=`Error deleting ${y}: ${v}${N}${_}`;console.error(`[useGameData] Error in handleDelete for ${y}:`,x),l(S)}finally{s(!1)}},[c,d]),p=w.useCallback(g=>{console.log(`[useGameData] Switching category from ${o} to ${g}`),u(g),d(g)},[o,d]);return w.useEffect(()=>{console.log(`[useGameData] Initial load effect for category: ${e}`);try{c(e),d(e)}catch(g){console.error(`[useGameData] Invalid initial category: ${e}`,g),l(`Invalid initial category: ${e}`),s(!1)}},[e,c,d]),{entries:t,loading:n,error:i,activeCategory:o,switchCategory:p,handleSave:h,handleDelete:f}}const yU=[{id:"items",label:"Items",icon:Xa},{id:"spells",label:"Spells",icon:vd},{id:"abilities",label:"Abilities",icon:os},{id:"kin",label:"Kin",icon:ts},{id:"profession",label:"Professions",icon:yA},{id:"skills",label:"Skills",icon:FA},{id:"monsters",label:"Monsters",icon:yd}],bU=e=>{try{if(z0(e)){const t=Object.entries(e);return t.length===0?"None":t.map(([r,n])=>`${r}${n!==null?` (Lvl ${n})`:""}`).join(", ")||"None"}if(typeof e=="string"&&e)return e;if(typeof e=="object"&&e!==null){const t=Object.keys(e);if(t.length>0)return/^[0-9a-fA-F]{8}-/.test(t[0])?`${t.length} skill(s) (Legacy UUIDs)`:t.length===1&&typeof e[t[0]]=="object"?`Requirement: ${t[0]} (Invalid Format)`:`${t.length} requirement(s) (Unknown format)`}return"None"}catch(t){return console.error("Error formatting requirement:",e,t),"Error: Invalid Format"}};function FN(){const[e,t]=w.useState(null),[r,n]=w.useState(""),[s,i]=w.useState(null),[l,o]=w.useState(""),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,p]=w.useState([]),{entries:g,loading:b,error:E,handleSave:x,handleDelete:y,switchCategory:v,activeCategory:N}=xU("items"),_=w.useCallback(async()=>{const{data:A,error:M}=await re.from("game_items").select("category",{count:"exact",head:!1});M?console.error("Error fetching item categories:",M):A&&c([...new Set(A.map(G=>G.category).filter(Boolean))])},[]),S=w.useCallback(async()=>{const{data:A,error:M}=await re.from("magic_schools").select("id, name").order("name");M?console.error("Error fetching magic schools:",M):A&&h(A)},[]),R=w.useCallback(async()=>{const{data:A,error:M}=await re.from("monsters").select("category",{count:"exact",head:!1});M?console.error("Error fetching monster categories:",M):A&&p([...new Set(A.map(G=>G.category).filter(Boolean))])},[]);w.useEffect(()=>{o(""),N==="items"?(_(),h([]),p([])):N==="spells"?(S(),c([]),p([])):N==="monsters"?(R(),c([]),h([])):(c([]),h([]),p([]))},[N,_,S,R]);const j=w.useCallback(A=>{console.log("Save successful, closing modal for:",A),t(null),i(null),N==="items"&&_(),N==="monsters"&&R()},[N,_,R]),D=w.useCallback(async()=>{e&&(console.log(`Calling hook's handleSave for category: ${N}`),await x(N,e,j,i))},[e,N,x,j]),T=w.useCallback(async A=>{A&&(console.log(`Calling hook's handleDelete for category: ${N}, ID: ${A}`),await y(N,A),N==="items"&&_(),N==="monsters"&&R())},[N,y,_,R]),F=w.useCallback((A,M)=>{t(G=>G?{...G,[A]:M}:null)},[]),O=w.useCallback(()=>{i(null);let A={name:""};switch(console.log(`Creating new entry for category: ${N}`),N){case"spells":A={...A,description:"",rank:1,school_id:null,casting_time:"",range:"",duration:"",willpower_cost:0};break;case"items":A={...A,description:"",category:"",cost:0,weight:0};break;case"abilities":A={...A,description:"",willpower_cost:null,requirement:{},profession:null,kin:null};break;case"kin":A={...A,description:"",key_attribute:"",typical_profession:"",kin_abilities:[]};break;case"profession":A={...A,description:"",key_attribute:"",skills:[]};break;case"skills":A={...A,description:"",attribute:null};break;case"monsters":A={name:"",description:"",category:"",stats:{FEROCITY:0,SIZE:"Normal",MOVEMENT:0,ARMOR:0,HP:10},attacks:[]};break}t(A)},[N]),Q=w.useCallback(()=>{if(!e)return null;switch(N){case"spells":return a.jsx(dU,{entry:e,onChange:F,magicSchools:d});case"items":return a.jsx(iU,{entry:e,onChange:F});case"abilities":return a.jsx(cU,{entry:e,onChange:F});case"kin":return a.jsx(lU,{entry:e,onChange:F});case"profession":return a.jsx(uU,{entry:e,onChange:F});case"skills":return a.jsx(hU,{entry:e,onChange:F});case"monsters":return a.jsx(gU,{entry:e,onChange:F});default:return a.jsx("p",{children:"No form available for this category."})}},[e,N,F,d]),Y=g.filter(A=>{var k,K,z;const M=(k=A.name)==null?void 0:k.toLowerCase().includes(r.toLowerCase());let G=!0;if(l)if(N==="items")G=((K=A.category)==null?void 0:K.toLowerCase())===l.toLowerCase();else if(N==="spells"){const I=A.magic_schools;l==="General"?G=!I:G=(I==null?void 0:I.toLowerCase())===l.toLowerCase()}else N==="monsters"&&(G=((z=A.category)==null?void 0:z.toLowerCase())===l.toLowerCase());return M&&G}),H=w.useCallback(()=>{t(null),i(null)},[]),B=N==="items"?u:N==="spells"?["General",...d.map(A=>A.name)].sort():N==="monsters"?f.sort():[];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Game Data Management"}),a.jsx(V,{variant:"primary",icon:zt,onClick:O,disabled:b,children:"Add Entry"})]}),E&&a.jsx(Ce,{message:`Error loading data: ${E}`}),a.jsx("div",{className:"flex gap-4 border-b overflow-x-auto pb-2",children:yU.map(({id:A,label:M,icon:G})=>a.jsxs("button",{onClick:()=>v(A),className:`px-4 py-2 font-medium flex items-center gap-2 whitespace-nowrap ${N===A?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,disabled:b,children:[a.jsx(G,{className:"w-5 h-5"}),M]},A))}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:`Search ${N}...`,value:r,onChange:A=>n(A.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg",disabled:b})]}),(N==="items"||N==="spells"||N==="monsters")&&B.length>0&&a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-48",children:[a.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:l,onChange:A=>o(A.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",disabled:b,children:[a.jsxs("option",{value:"",children:["All ",N==="items"?"Categories":N==="spells"?"Schools":N==="monsters"?"Categories":""]}),B.map(A=>a.jsx("option",{value:A,children:A},A))]}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:a.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),b&&!g.length?a.jsxs("p",{className:"text-center py-4",children:["Loading ",N,"..."]}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Name"}),N==="spells"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"School"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Rank"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"WP Cost"})]}),N==="items"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Category"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Cost"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Weight"})]}),N==="abilities"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"WP Cost"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Requirement"})]}),N==="kin"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Key Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Typical Profession"})]}),N==="profession"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Key Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Skills"})]}),N==="skills"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Attribute"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Description"})]}),N==="monsters"&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Category"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"HP"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Armor"}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Size"})]}),a.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:Y.map(A=>{var k,K,z;let M="N/A";N==="abilities"&&(M=bU(A.requirement));const G=N==="monsters"?A:null;return a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.name}),N==="spells"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.magic_schools||"General"}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.rank===0?"Trick":`Rank ${A.rank}`}),a.jsxs("td",{className:"px-4 py-2 align-top",children:[A.willpower_cost," WP"]})]}),N==="items"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.category}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.cost}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.weight})]}),N==="abilities"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.willpower_cost??"N/A"}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 max-w-xs truncate",title:typeof M=="string"?M:"Invalid Data",children:M})]}),N==="kin"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.key_attribute}),a.jsx("td",{className:"px-4 py-2 align-top",children:A.typical_profession})]}),N==="profession"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.key_attribute}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 max-w-xs truncate",children:Array.isArray(A.skills)?A.skills.join(", "):""})]}),N==="skills"&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:A.attribute||"N/A"}),a.jsx("td",{className:"px-4 py-2 align-top text-sm text-gray-600 truncate max-w-xs",title:A.description||"",children:A.description})]}),N==="monsters"&&G&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-2 align-top",children:G.category}),a.jsx("td",{className:"px-4 py-2 align-top",children:(k=G.stats)==null?void 0:k.HP}),a.jsx("td",{className:"px-4 py-2 align-top",children:(K=G.stats)==null?void 0:K.ARMOR}),a.jsx("td",{className:"px-4 py-2 align-top",children:(z=G.stats)==null?void 0:z.SIZE})]}),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{variant:"secondary",size:"sm",icon:Pu,onClick:()=>{i(null),t(A)},disabled:!A.id,children:"Edit"}),a.jsx(V,{variant:"danger",size:"sm",icon:Kr,onClick:()=>A.id&&T(A.id),disabled:!A.id||b,children:"Delete"})]})})]},A.id||A.name)})})]}),Y.length===0&&!b&&!E&&a.jsx("p",{className:"text-center text-gray-500 py-4",children:r||l?`No ${N} found matching filters.`:`No entries for '${N}'.`})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white py-2 z-10 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.id?`Edit ${N}`:`New ${N}`}),a.jsx("button",{onClick:H,className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),s&&a.jsx("div",{className:"mb-4",children:a.jsx(Ce,{message:s})}),a.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:Q()}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6 sticky bottom-0 bg-white py-3 z-10 border-t",children:[a.jsx(V,{variant:"secondary",onClick:H,disabled:b,children:"Cancel"}),a.jsx(V,{variant:"primary",icon:Pr,onClick:D,disabled:b,children:b?"Saving...":e.id?"Update Entry":"Save Entry"})]})]})})]})}function vU(){const{user:e}=Ot(),[t,r]=w.useState(!1),[n,s]=w.useState(null),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(""),[h,f]=w.useState(null),[p,g]=w.useState(!1),b=async E=>{E.preventDefault();try{if(!i.trim()||!o.trim()||!c.trim()){f("All fields are required");return}if(!e){f("You must be logged in to create or edit entries");return}if(n){const{error:x}=await re.from("compendium").update({title:i,content:o,category:c}).eq("id",n);if(x)throw x}else{const{error:x}=await re.from("compendium").insert([{title:i,content:o,category:c,created_by:e.id}]);if(x)throw x}l(""),u(""),d(""),r(!1),s(null)}catch(x){f(x instanceof Error?x.message:"Failed to save entry")}};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),a.jsx("input",{type:"text",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>g(!1),className:`p-2 rounded-lg ${p?"text-gray-600 hover:bg-gray-100":"bg-blue-100 text-blue-700"}`,children:a.jsx(C2,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>g(!0),className:`p-2 rounded-lg ${p?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(A2,{className:"w-5 h-5"})})]})]}),p?a.jsx("div",{className:"min-h-[300px] p-4 border border-gray-300 rounded-md bg-white overflow-auto",children:a.jsx(dg,{content:o})}):a.jsx("textarea",{value:o,onChange:E=>u(E.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:`# Heading 1
## Heading 2

Regular text with **bold** and *italic* formatting.

> Blockquote for important notes

| Table | Header |
|--------|---------|
| Cell 1 | Cell 2 |`})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null),l(""),u(""),d(""),g(!1)},className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(Pr,{className:"w-5 h-5"}),n?"Update Entry":"Save Entry"]})]})]})})}function wU(){const[e,t]=w.useState("users"),r=()=>{switch(e){case"users":return a.jsx(XF,{});case"gameData":return a.jsx(FN,{});case"compendium":return a.jsx(vU,{});default:return null}},n=[{key:"users",label:"Users",Icon:H0}];return a.jsxs("div",{className:"",children:[n.length>0&&a.jsx("nav",{className:"border-b",children:a.jsx("ul",{className:"flex -mb-px",children:n.map(({key:s,label:i,Icon:l})=>a.jsx("li",{className:"mr-6",children:a.jsxs("button",{onClick:()=>t(s),className:e===s?"flex items-center py-2 px-4 text-blue-600 border-b-2 border-blue-600 font-semibold":"flex items-center py-2 px-4 text-gray-600 hover:text-gray-800 hover:border-b-2 hover:border-gray-300",children:[a.jsx(l,{className:"w-5 h-5 mr-2"}),i]})},s))})}),a.jsx("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:r()})]})}function e1({children:e,className:t="",onClick:r}){return a.jsx("div",{className:`bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 ${t} ${r?"cursor-pointer":""}`,onClick:r,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:r?n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),r())}:void 0,children:e})}const Pf=[{id:"profile",label:"Profile Settings",icon:Al,description:"Manage your personal information and account settings"},{id:"appearance",label:"Appearance",icon:P2,description:"Customize the look and feel of the application"},{id:"notifications",label:"Notifications",icon:k2,description:"Configure your notification preferences"},{id:"localization",label:"Localization",icon:I2,description:"Set your language, timezone and regional preferences"},{id:"game-data",label:"Game Data Editor",icon:Xa,description:"Edit game data such as spells and items",adminOnly:!0},{id:"admin",label:"Admin Panel",icon:os,description:"System administration and user management",adminOnly:!0}];function EU(){const{isAdmin:e}=Ot(),[t,r]=w.useState(()=>"profile"),n=i=>{const l=Pf.find(o=>o.id===i);l&&(!l.adminOnly||e())?r(i):l!=null&&l.adminOnly&&!e()&&(console.warn("Attempted to access admin settings without privileges."),r("profile"))};Wr.useEffect(()=>{const i=Pf.find(l=>l.id===t);i!=null&&i.adminOnly&&!e()&&r("profile")},[t,e]);const s=()=>{switch(t){case"profile":return a.jsx(zF,{});case"appearance":return a.jsx(qF,{});case"notifications":return a.jsx(VF,{});case"localization":return a.jsx(KF,{});case"game-data":return e()?a.jsx(FN,{}):a.jsx(No,{to:"/settings",replace:!0});case"admin":return e()?a.jsx(wU,{}):a.jsx(No,{to:"/settings",replace:!0});default:return a.jsx(No,{to:"/settings",replace:!0})}};return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(F2,{className:"w-8 h-8 text-gray-700"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 md:col-span-4 space-y-4",children:Pf.filter(i=>!i.adminOnly||e()).map(i=>a.jsx(e1,{onClick:()=>n(i.id),className:`cursor-pointer transition-all ${t===i.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${t===i.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:a.jsx(i.icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium",children:i.label}),a.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),a.jsx(Sa,{className:`w-5 h-5 ${t===i.id?"text-blue-500":"text-gray-400"}`})]})},i.id))}),a.jsx("div",{className:"col-span-12 md:col-span-8",children:a.jsx(e1,{children:s()})})]})]})}function _U(){const[e,t]=w.useState(!0),[r,n]=w.useState(""),[s,i]=w.useState(""),[l,o]=w.useState(""),[u,c]=w.useState(""),[d,h]=w.useState("player"),[f,p]=w.useState(null),[g,b]=w.useState(null),[E,x]=w.useState({}),[y,v]=w.useState(!1),[N,_]=w.useState(navigator.onLine),{signIn:S,signUp:R}=Ot(),j=Xr(),D=ha();w.useEffect(()=>{var H;(H=D.state)!=null&&H.message&&(b(D.state.message),j(D.pathname,{replace:!0,state:{}}))},[D,j]),w.useEffect(()=>{const H=()=>_(!0),B=()=>_(!1);return window.addEventListener("online",H),window.addEventListener("offline",B),()=>{window.removeEventListener("online",H),window.removeEventListener("offline",B)}},[]);const T=()=>{n(""),i(""),o(""),c(""),h("player"),p(null),b(null),x({})},F=()=>{t(!e),T()},O=async()=>{const H=MF.safeParse({email:r.trim(),password:s});if(!H.success){const B={};return H.error.errors.forEach(A=>{A.path[0]&&(B[String(A.path[0])]=A.message)}),x(B),p("Please fix the errors in the form."),!1}try{v(!0);const{email:B,password:A}=H.data;return await S(B,A),!0}catch(B){return p(B instanceof Error?B.message:"Login failed. Please try again."),!1}finally{v(!1)}},Q=async()=>{const H=FF.safeParse({username:l.trim(),email:r.trim(),password:s,confirmPassword:u,role:d});if(!H.success){const B={};return H.error.errors.forEach(A=>{A.path[0]&&(B[String(A.path[0])]=A.message)}),x(B),p("Please fix the errors in the form."),!1}try{v(!0);const{email:B,password:A,username:M,role:G}=H.data;return await R(B,A,M,G),b("Registration successful! Please check your email to verify your account before logging in."),t(!0),T(),n(B),!0}catch(B){return p(B instanceof Error?B.message:"Signup failed. Please try again."),!1}finally{v(!1)}},Y=async H=>{if(H.preventDefault(),p(null),b(null),x({}),!N){p("No internet connection");return}e?await O():await Q()};return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(os,{className:"mx-auto h-12 w-12 text-blue-600"}),a.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:e?"Log in to DragonBane":"Create your DragonBane Account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e?"Enter your details to access your account":"Fill in the details to register"})]}),!N&&a.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Et,{className:"h-5 w-5 text-yellow-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No internet connection"}),a.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Please check your internet connection and try again."})]})]})}),f&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Et,{className:"h-5 w-5 text-red-400 mr-2"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:e?"Login Error":"Signup Error"}),a.jsx("p",{className:"mt-2 text-sm text-red-700",children:f})]})]})}),g&&a.jsx("div",{className:"rounded-md bg-green-50 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Et,{className:"h-5 w-5 text-green-400 mr-2"})," ",a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),a.jsx("p",{className:"mt-2 text-sm text-green-700",children:g})]})]})}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:Y,noValidate:!0,children:[a.jsxs("div",{className:"space-y-4",children:[!e&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Al,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,autoComplete:"username",value:l,onChange:H=>o(H.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.username?"border-red-500":"border-gray-300"}`,placeholder:"Choose a username",disabled:y})]}),E.username&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.username})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(F0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:r,onChange:H=>n(H.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address",disabled:y})]}),E.email&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.email})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:e?"current-password":"new-password",value:s,onChange:H=>i(H.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password",disabled:y})]}),E.password&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.password})]}),!e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,autoComplete:"new-password",value:u,onChange:H=>c(H.target.value),className:`pl-10 w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${E.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm password",disabled:y})]}),E.confirmPassword&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.confirmPassword})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Register as"}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"player",checked:d==="player",onChange:()=>h("player"),disabled:y}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Player"})]}),a.jsxs("label",{className:"inline-flex items-center",children:[a.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"role",value:"dm",checked:d==="dm",onChange:()=>h("dm"),disabled:y}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Dungeon Master (DM)"})]})]}),E.role&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.role})]})]})]}),a.jsx(V,{type:"submit",variant:"primary",fullWidth:!0,loading:y,disabled:!N||y,icon:e?M0:H0,iconPosition:"left",children:e?"Log in":"Sign up"})]}),a.jsx("div",{className:"text-sm text-center",children:a.jsx("button",{type:"button",onClick:F,className:"font-medium text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:y,children:e?"Don't have an account? Sign up":"Already have an account? Log in"})})]})})}const t1=({type:e})=>a.jsx("span",{className:"font-mono px-1 border rounded bg-gray-100 text-xs",children:e}),NU={d4:4,d6:6,d8:8,d10:10,d12:12,d20:20};function r1(e){return Math.floor(Math.random()*NU[e])+1}function kU(){const{showDiceRoller:e,toggleDiceRoller:t,currentConfig:r,dicePool:n,addDie:s,removeLastDie:i,clearDicePool:l,isBoonActive:o,isBaneActive:u,setBoon:c,setBane:d,addRollToHistory:h,rollHistory:f,clearHistory:p}=ma(),{markSkillInSession:g}=ir(),[b,E]=w.useState([]),[x,y]=w.useState([]),[v,N]=w.useState(null),[_,S]=w.useState(!1),[R,j]=w.useState(void 0),[D,T]=w.useState(!1),F=(r==null?void 0:r.rollMode)==="skillCheck",O=(r==null?void 0:r.rollMode)==="deathRoll",Q=(r==null?void 0:r.rollMode)==="rallyRoll",Y=(r==null?void 0:r.rollMode)==="recoveryRoll",H=(r==null?void 0:r.rollMode)==="advancementRoll",B=w.useCallback(()=>{if(n.length===0)return;const k=n.map(Z=>({type:Z,value:r1(Z)}));let K=[],z=k.reduce((Z,ye)=>Z+ye.value,0),I=!1,he,Ee=r==null?void 0:r.skillName;if((o||u)&&n.length===1&&n[0]==="d20"){K=[{type:"d20",value:r1("d20")}];const Z=k[0].value,ye=K[0].value;o?z=Math.min(Z,ye):z=Math.max(Z,ye)}else n.length===1&&n[0]==="d20"&&(z=k[0].value);if(n.length===1&&n[0]==="d20"){const Z=typeof z=="number"?z:k[0].value;Z===1?(I=!0,z="Dragon!",he=!0):Z===20&&(I=!0,z="Demon!",he=!1),(r==null?void 0:r.targetValue)!==void 0&&!I&&(F||Q||H?he=Z<=r.targetValue:O&&(he=Z<=r.targetValue,Z===1&&(I=!0,z="Dragon!",he=!0),Z===20&&(I=!0,z="Demon!",he=!1))),F&&Ee&&(Z===1||Z===20)&&g(Ee)}else Y&&n.length===1&&n[0]==="d6"&&(z=k[0].value,he=void 0,I=!1);E(k),y(K),N(z),S(I),j(he);const be={description:(r==null?void 0:r.description)||`${n.join(", ")} Roll`,dicePool:[...n],results:k,boonResults:K.length>0?K:void 0,finalOutcome:z,isBoon:o,isBane:u,targetValue:r==null?void 0:r.targetValue,isSuccess:he,isCritical:I,skillName:Ee};h(be),r!=null&&r.onRollComplete&&r.onRollComplete(be)},[n,o,u,r,h,g]);if(w.useEffect(()=>{e||(E([]),y([]),N(null),S(!1),j(void 0),T(!1))},[e]),w.useEffect(()=>{E([]),y([]),N(null),S(!1),j(void 0)},[n,o,u]),!e)return null;const A=()=>r!=null&&r.description?r.description:O?"Death Save (d20 vs CON)":Q?"Rally Roll (d20 vs WIL, Bane)":Y?"Recovery Roll (1d6 HP)":H?"Advancement Roll (d20 vs Skill)":F?"Skill Check (d20 vs Skill)":"Dice Roller",M=()=>O?a.jsx(yd,{className:"w-5 h-5 mr-2 text-red-500"}):Q?a.jsx(H2,{className:"w-5 h-5 mr-2 text-yellow-500"}):Y?a.jsx(P0,{className:"w-5 h-5 mr-2 text-green-500"}):H?a.jsx(uo,{className:"w-5 h-5 mr-2 text-blue-500"}):F?a.jsx(bd,{className:"w-5 h-5 mr-2 text-purple-500"}):a.jsx(On,{className:"w-5 h-5 mr-2"}),G=O||Q||Y||H;return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[M(),A()]}),a.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-700",children:a.jsx(Lt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:D?a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Roll History"}),a.jsxs(V,{onClick:p,variant:"danger",size:"xs",disabled:f.length===0,children:[a.jsx(Kr,{className:"w-3 h-3 mr-1"})," Clear"]})]}),f.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No rolls yet."}):a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(k=>a.jsxs("li",{className:"text-xs border-b pb-1",children:[a.jsx("p",{className:"font-medium",children:k.description}),a.jsxs("p",{children:["Pool: ",k.dicePool.join(", ")," ",k.isBoon?"(Boon)":"",k.isBane?"(Bane)":""]}),a.jsxs("p",{children:["Rolls: ",k.results.map(K=>K.value).join(", ")," ",k.boonResults?`| Boon/Bane: ${k.boonResults.map(K=>K.value).join(", ")}`:""]}),a.jsxs("p",{children:["Outcome: ",a.jsx("span",{className:"font-semibold",children:k.finalOutcome}),k.targetValue!==void 0&&` (vs ${k.targetValue})`,k.isSuccess===!0&&a.jsx("span",{className:"text-green-600 ml-1",children:"(Success)"}),k.isSuccess===!1&&a.jsx("span",{className:"text-red-600 ml-1",children:"(Failure)"}),k.isCritical&&a.jsx("span",{className:"text-purple-600 ml-1",children:"(Critical!)"})]}),k.skillName&&a.jsxs("p",{className:"text-gray-500",children:["Skill: ",k.skillName]})]},k.id))})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-3 border rounded bg-gray-50 min-h-[50px] flex flex-wrap gap-2 items-center",children:n.length===0?a.jsx("span",{className:"text-gray-500 italic",children:"Dice pool is empty"}):n.map((k,K)=>a.jsxs("button",{onClick:()=>!G&&i(k),className:`px-2 py-1 border rounded shadow-sm flex items-center ${G?"bg-gray-300 cursor-not-allowed":"bg-white hover:bg-red-50 hover:border-red-300"}`,title:G?void 0:`Remove ${k}`,disabled:G,children:[a.jsx(t1,{type:k}),!G&&a.jsx(Lt,{className:"w-3 h-3 ml-1 text-red-500"})]},K))}),!G&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-4",children:["d4","d6","d8","d10","d12","d20"].map(k=>a.jsx(V,{onClick:()=>s(k),variant:"outline",size:"sm",children:a.jsx(t1,{type:k})},k))}),n.length===1&&n[0]==="d20"&&!G&&a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsxs(V,{onClick:()=>c(!o),variant:o?"success":"outline",size:"sm",className:`flex items-center ${o?"ring-2 ring-green-400 ring-offset-1":""}`,children:[a.jsx(bd,{className:`w-4 h-4 mr-1 ${o?"text-white":"text-green-500"}`})," Boon"]}),a.jsxs(V,{onClick:()=>d(!u),variant:u?"danger":"outline",size:"sm",className:`flex items-center ${u?"ring-2 ring-red-400 ring-offset-1":""}`,children:[a.jsx(UA,{className:`w-4 h-4 mr-1 ${u?"text-white":"text-red-500"}`})," Bane"]})]}),b.length>0&&a.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50 border-blue-200 text-center",children:[a.jsxs("p",{className:"text-sm text-blue-700 mb-1",children:["Rolled: ",b.map(k=>k.value).join(", "),x.length>0&&` | Boon/Bane: ${x.map(k=>k.value).join(", ")}`]}),a.jsx("p",{className:`text-2xl font-bold ${_?"text-purple-600":"text-blue-900"}`,children:v}),(r==null?void 0:r.targetValue)!==void 0&&!_&&a.jsxs("p",{className:"text-sm text-gray-600",children:["(Target: ",r.targetValue,")"]}),R===!0&&!_&&a.jsx("p",{className:"text-green-600 font-semibold mt-1",children:"Success!"}),R===!1&&!_&&a.jsx("p",{className:"text-red-600 font-semibold mt-1",children:"Failure!"})]})]})}),a.jsxs("div",{className:"p-4 border-t flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{children:[a.jsxs(V,{onClick:()=>T(!D),variant:"secondary",size:"sm",children:[a.jsx(SA,{className:"w-4 h-4 mr-1"})," ",D?"Roller":"History"]}),!D&&!G&&a.jsxs(V,{onClick:l,variant:"ghost",size:"sm",className:"ml-2 text-red-600 hover:bg-red-100",disabled:n.length===0,children:[a.jsx(Kr,{className:"w-4 h-4 mr-1"})," Clear Pool"]})]}),!D&&a.jsxs(V,{onClick:B,disabled:n.length===0,size:"lg",children:[a.jsx(On,{className:"w-5 h-5 mr-2"})," Roll"]})]})]})})}function SU({children:e}){const{user:t}=Ot(),r=ha();return t?a.jsx(a.Fragment,{children:e}):a.jsx(No,{to:"/login",state:{from:r},replace:!0})}function TU({textToCopy:e}){const[t,r]=w.useState(!1),n=async()=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Failed to copy text: ",s)}};return a.jsx(V,{variant:"ghost",size:"icon",onClick:n,"aria-label":t?"Copied":"Copy to clipboard",children:t?a.jsx(Bi,{className:"w-5 h-5 text-green-500"}):a.jsx(j2,{className:"w-5 h-5 text-gray-500"})})}function n1({isOpen:e,onClose:t,onConfirm:r,title:n,description:s,confirmText:i="Confirm",cancelText:l="Cancel",isLoading:o=!1,isDestructive:u=!1,icon:c}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-4",children:[c&&a.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${u?"bg-red-100":"bg-blue-100"}`,children:c}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",id:"modal-title",children:n}),a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:s})})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3",children:[a.jsx(V,{variant:"secondary",onClick:t,disabled:o,className:"mt-3 sm:mt-0 w-full sm:w-auto",children:l}),a.jsx(V,{variant:u?"danger":"primary",onClick:r,loading:o,className:"w-full sm:w-auto",children:i})]})]})}):null}function CU({partyId:e,isDM:t}){const{user:r}=Ot(),[n,s]=w.useState([]),[i,l]=w.useState([]),[o,u]=w.useState(null),[c,d]=w.useState(!1),[h,f]=w.useState(null),[p,g]=w.useState(""),[b,E]=w.useState(""),[x,y]=w.useState(""),[v,N]=w.useState("all"),[_,S]=w.useState(""),[R,j]=w.useState(!0),[D,T]=w.useState(null),[F,O]=w.useState(null),Q=w.useCallback(()=>{g(""),E(""),y(v==="all"?"":v),O(null)},[v]),Y=()=>{Q(),d(!0),f(null),u(null)},H=z=>{u(z),f(z.id),d(!1),g(z.title),E(z.content),y(z.category),O(null)},B=()=>{d(!1),f(null),Q(),h&&u(null)},A=w.useCallback(async()=>{if(e){j(!0),T(null);try{const{data:z,error:I}=await re.from("notes").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(I)throw I;s(z||[]);const he=Array.from(new Set((z==null?void 0:z.map(Ee=>Ee.category).filter(Boolean))||[]));l(he)}catch(z){console.error("Error loading party notes:",z),T(z instanceof Error?z.message:"Failed to load party notes"),s([])}finally{j(!1)}}},[e]);w.useEffect(()=>{A()},[A]);const M=async()=>{if(!r){O("User not authenticated.");return}if(!p.trim()){O("Note title cannot be empty.");return}if(!x.trim()){O("Note category cannot be empty.");return}O(null);const z={title:p.trim(),content:b||"",category:x.trim(),party_id:e,user_id:r.id,updated_at:new Date().toISOString()};try{let I=null;if(h){const{data:he,error:Ee}=await re.from("notes").update(z).eq("id",h).select().single();if(Ee)throw Ee;I=he}else{const{updated_at:he,...Ee}=z,{data:be,error:Z}=await re.from("notes").insert([Ee]).select().single();if(Z)throw Z;I=be}B(),await A(),I&&u(I)}catch(I){console.error("Error saving note:",I);let he="Failed to save note.";I instanceof Error&&(I.message.includes("RLS")?he="Permission denied. Could not save the note due to security policies.":"code"in I&&I.code==="23505"?he="A note with this title might already exist in this party.":he=`Failed to save note: ${I.message}`),O(he)}},G=async z=>{if(window.confirm("Are you sure you want to delete this note?"))try{T(null);const{error:I}=await re.from("notes").delete().eq("id",z);if(I)throw I;await A(),(o==null?void 0:o.id)===z&&u(null),h===z&&B()}catch(I){console.error("Error deleting note:",I),T(I instanceof Error?`Failed to delete note: ${I.message}`:"An unknown error occurred while deleting.")}},k=n.filter(z=>{const I=z.title.toLowerCase().includes(_.toLowerCase())||z.content.toLowerCase().includes(_.toLowerCase()),he=v==="all"||z.category===v;return I&&he});if(R&&n.length===0&&!e)return a.jsx("div",{className:"p-4",children:a.jsx(Ce,{message:"Party ID is missing. Cannot load notes."})});if(R&&n.length===0)return a.jsxs("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:[" ",a.jsx(ze,{size:"lg"}),a.jsx("p",{className:"text-lg text-gray-600 ml-3",children:"Loading party notes..."})]});const K=c||h;return a.jsxs("div",{className:"flex h-[calc(100vh-150px)] overflow-hidden bg-gray-50",children:[" ",a.jsxs("div",{className:"w-1/4 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Ou,{className:"w-5 h-5 text-indigo-600"}),"Party Notes"]}),a.jsx(V,{variant:"primary",size:"sm",icon:zt,onClick:Y,children:"New Note"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Search notes...",value:_,onChange:z=>S(z.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"}),a.jsxs("select",{id:"category-filter",value:v,onChange:z=>N(z.target.value),className:"w-full pl-9 pr-7 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white text-sm","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(z=>a.jsx("option",{value:z,children:z},z))]}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:a.jsx(O0,{className:"w-3 h-3 fill-current text-gray-500"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[D&&!K&&a.jsx("div",{className:"p-3",children:a.jsx(Ce,{message:D,onClose:()=>T(null)})}),k.length>0?k.map(z=>a.jsxs("div",{onClick:()=>{(!h||h!==z.id)&&(u(z),d(!1),f(null))},className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${(o==null?void 0:o.id)===z.id&&!K?"bg-indigo-50 border-l-4 border-indigo-500":""} ${h===z.id?"bg-yellow-50 border-l-4 border-yellow-500":""}`,children:[a.jsx("h3",{className:"font-semibold text-sm truncate",children:z.title}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-0.5",children:[a.jsx(my,{className:"w-2.5 h-2.5"}),a.jsx("span",{className:"truncate",children:z.category})]})]},z.id)):!R&&a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(ml,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),_||v!=="all"?"No notes match filters.":"No notes in this party yet."]})]})]}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:K?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-3xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Edit Party Note":"Create New Party Note"}),a.jsx("button",{onClick:B,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100","aria-label":"Close form",children:a.jsx(Lt,{className:"w-5 h-5"})})]}),F&&a.jsx("div",{className:"mb-4",children:a.jsx(Ce,{message:F,onClose:()=>O(null)})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"note-title",type:"text",value:p,onChange:z=>g(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"note-category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{id:"note-category",type:"text",value:x,onChange:z=>y(z.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Quests, Locations, NPCs",list:"category-suggestions",required:!0}),i.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("datalist",{id:"category-suggestions",children:i.map(z=>a.jsx("option",{value:z},z))}),a.jsxs("select",{value:x,onChange:z=>y(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white text-sm","aria-label":"Select existing category",children:[a.jsx("option",{value:"",disabled:!0,children:"Select existing..."}),i.map(z=>a.jsx("option",{value:z,children:z},z))]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"note-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Content (Markdown supported)"}),a.jsx("textarea",{id:"note-content",value:b,onChange:z=>E(z.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your notes here..."})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-3",children:[a.jsx(V,{variant:"secondary",onClick:B,children:"Cancel"}),a.jsx(V,{variant:"primary",icon:Pr,onClick:M,disabled:R||!p.trim()||!x.trim(),children:R?"Saving...":h?"Update Note":"Save Note"})]})]}):o?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:o.title}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx(my,{className:"w-3 h-3"}),a.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-700",children:o.category})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(V,{variant:"secondary",size:"sm",icon:Pu,onClick:()=>H(o),children:"Edit"}),a.jsx(V,{variant:"danger_outline",size:"sm",icon:Kr,onClick:()=>G(o.id),children:"Delete"})]})]}),a.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",children:a.jsx(dg,{content:o.content})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-6 pt-3 border-t border-gray-200",children:["Created: ",new Date(o.created_at).toLocaleDateString(),o.updated_at&&new Date(o.updated_at).getTime()!==new Date(o.created_at).getTime()&&a.jsxs("span",{children:[" | Updated: ",new Date(o.updated_at).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"text-center py-20",children:[a.jsx(ml,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-xl font-medium text-gray-500",children:"Select a party note to view its details"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Or, create a new note using the button in the sidebar."}),D&&a.jsx("div",{className:"mt-6 max-w-md mx-auto",children:a.jsx(Ce,{message:D,onClose:()=>T(null)})})]})})]})}async function jU(e){if(!e)return console.warn("fetchTasks called without partyId"),[];const{data:t,error:r}=await re.from("party_tasks").select("*").eq("party_id",e).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching tasks:",r),new Error(r.message||"Failed to fetch tasks");return t||[]}async function AU(e,t){if(!t)throw new Error("User must be authenticated to create a task.");if(!e.party_id)throw new Error("Party ID is required to create a task.");if(!e.title||e.title.trim()==="")throw new Error("Task title cannot be empty.");const{data:r,error:n}=await re.from("party_tasks").insert({party_id:e.party_id,title:e.title,description:e.description,created_by_user_id:t.id,status:"open"}).select().single();if(n)throw console.error("Error creating task:",n),new Error(n.message||"Failed to create task");if(!r)throw new Error("Task creation did not return data.");return r}async function IU(e,t){if(!e)throw new Error("Task ID is required to update a task.");const r={...t};t.status&&(t.status==="completed"?r.completed_at=new Date().toISOString():t.status==="open"&&(r.completed_at=null));const{data:n,error:s}=await re.from("party_tasks").update(r).eq("id",e).select().single();if(s)throw console.error("Error updating task:",s),new Error(s.message||"Failed to update task");if(!n)throw new Error("Task update did not return data.");return n}async function RU(e){if(!e)throw new Error("Task ID is required to delete a task.");const{error:t}=await re.from("party_tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),new Error(t.message||"Failed to delete task")}function LU(){const e=Xr(),{setGlobalError:t}=V2(),r=w.useCallback((i,l)=>{const o=i instanceof Error?i.message:String(i);$i.handleError(i,{action:l==null?void 0:l.action,additionalData:{critical:l==null?void 0:l.critical}}),(l==null?void 0:l.showError)!==!1&&t(o),l!=null&&l.redirect&&e(l.redirect),l!=null&&l.critical&&e("/error",{state:{error:o}})},[e,t]),n=w.useCallback((i,l)=>{$i.handleAuthError(i,{action:l==null?void 0:l.action});const o=i instanceof Error?i.message:String(i);t(o),e((l==null?void 0:l.redirect)||"/login")},[e,t]),s=w.useCallback((i,l)=>{$i.handleNetworkError(i,{action:l==null?void 0:l.action}),t("Network error. Please check your connection and try again."),l!=null&&l.retry&&setTimeout(l.retry,1e3)},[t]);return{handleError:r,handleAuthError:n,handleNetworkError:s}}function OU({partyId:e,isDM:t}){const{user:r}=Ot(),n=Zr(),{handleError:s}=LU(),[i,l]=w.useState(""),[o,u]=w.useState(""),[c,d]=w.useState(!1),{data:h,isLoading:f,error:p}=jt({queryKey:["partyTasks",e],queryFn:()=>jU(e),enabled:!!e}),g=jr({mutationFn:_=>AU(_,r),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]}),l(""),u(""),d(!1)},onError:_=>{s(_,{action:"creating task"})}}),b=jr({mutationFn:({taskId:_,updates:S})=>IU(_,S),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:_=>{s(_,{action:"updating task"})}}),E=jr({mutationFn:_=>RU(_),onSuccess:()=>{n.invalidateQueries({queryKey:["partyTasks",e]})},onError:_=>{s(_,{action:"deleting task"})}}),x=_=>{if(_.preventDefault(),!i.trim()){s(new Error("Task title cannot be empty."),{action:"adding task",showError:!0});return}g.mutate({party_id:e,title:i.trim(),description:o.trim()||void 0})},y=_=>{b.mutate({taskId:_.id,updates:{status:_.status==="open"?"completed":"open"}})},v=_=>{window.confirm("Are you sure you want to delete this task?")&&E.mutate(_)},N=_=>t||_.created_by_user_id===(r==null?void 0:r.id);return f?a.jsx(ze,{}):p?a.jsx(Ce,{message:`Failed to load tasks: ${p.message}`}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Party Tasks"}),t&&a.jsx(V,{icon:c?void 0:zt,onClick:()=>d(!c),variant:c?"secondary":"primary",children:c?"Cancel":"Add Task"})]}),t&&c&&a.jsxs("form",{onSubmit:x,className:"p-4 border rounded-lg bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"newTaskTitle",className:"block text-sm font-medium text-gray-700",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",id:"newTaskTitle",value:i,onChange:_=>l(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g., Clear out the goblin cave",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"newTaskDescription",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),a.jsx("textarea",{id:"newTaskDescription",value:o,onChange:_=>u(_.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Any additional details about the task..."})]}),a.jsx(V,{type:"submit",loading:g.isPending,icon:zt,children:"Add Task"})]}),h&&h.length>0?a.jsx("ul",{className:"space-y-3",children:h.map(_=>{var S;return a.jsxs("li",{className:`p-4 border rounded-lg flex items-start justify-between gap-4 ${_.status==="completed"?"bg-green-50 border-green-200":"bg-white"}`,children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>y(_),loading:b.isPending&&((S=b.variables)==null?void 0:S.taskId)===_.id,className:_.status==="completed"?"text-green-600 hover:text-green-700":"text-gray-400 hover:text-gray-600","aria-label":_.status==="completed"?"Mark as open":"Mark as completed",children:_.status==="completed"?a.jsx(su,{size:20}):a.jsx(vA,{size:20})}),a.jsx("h3",{className:`text-lg font-medium ${_.status==="completed"?"line-through text-gray-500":""}`,children:_.title})]}),_.description&&a.jsx("p",{className:`mt-1 text-sm ${_.status==="completed"?"text-gray-400":"text-gray-600"}`,children:_.description}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Added on: ",new Date(_.created_at).toLocaleDateString(),_.completed_at&&_.status==="completed"&&a.jsxs("span",{children:[" | Completed on: ",new Date(_.completed_at).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:N(_)&&a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>v(_.id),loading:E.isPending&&E.variables===_.id,className:"text-red-500 hover:text-red-700","aria-label":"Delete task",children:a.jsx(Kr,{size:18})})})]},_.id)})}):a.jsxs("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(B0,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tasks yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t?"Get started by adding a new task for your party.":"The DM hasn't added any tasks yet."}),t&&!c&&a.jsx(V,{onClick:()=>d(!0),className:"mt-4",icon:zt,children:"Add First Task"})]})]})}function PU({partyId:e,members:t,isDM:r}){var G;const n=Zr(),[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(null),[d,h]=w.useState(""),[f,p]=w.useState("all"),[g,b]=w.useState(""),[E,x]=w.useState([]),[y,v]=w.useState([]),[N,_]=w.useState(!1),{data:S=[],isLoading:R,error:j}=jt({queryKey:["gameItems"],queryFn:uh,staleTime:1e3*60*10}),D=k=>{if(k)return S.find(K=>K.name===k)};w.useEffect(()=>{T(),F()},[e]);async function T(){try{o(!0),c(null);const{data:k,error:K}=await re.from("party_inventory").select("*").eq("party_id",e);if(K)throw K;i(k||[])}catch(k){c(k instanceof Error?k.message:"Failed to load inventory"),i([])}finally{o(!1)}}async function F(){try{const{data:k,error:K}=await re.from("party_inventory_log").select("*").eq("party_id",e).order("timestamp",{ascending:!1}).limit(50);if(K)throw K;v(k||[])}catch(k){console.error("Failed to load transaction log:",k),v([])}}const O=async()=>{if(!(!g||E.length===0))try{c(null);const k=t.find(K=>K.id===g);if(!k)throw new Error("Character not found");await Promise.all(E.map(async K=>{const z=s.find(te=>te.id===K);if(!z||!z.name||z.quantity<1)return;let I;if(z.quantity>1?{error:I}=await re.from("party_inventory").update({quantity:z.quantity-1}).eq("id",z.id):{error:I}=await re.from("party_inventory").delete().eq("id",z.id),I)throw I;const he=k.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}},Ee=he.inventory||[],be=D(z.name);if(be){const te=Ee.findIndex(ce=>ce.name===be.name);if(te>-1)Ee[te].quantity+=1;else{const ce={...be,id:void 0,quantity:1,originalName:be.name};Ee.push(ce)}}else{console.warn(`Details not found for item: ${z.name}. Transferring with basic info.`);const te={name:z.name,quantity:1,originalName:z.name,description:z.description,category:z.category},ce=Ee.findIndex(_e=>_e.name===te.name);ce>-1?Ee[ce].quantity+=1:Ee.push(te)}const{error:Z}=await re.from("characters").update({equipment:{...he,inventory:Ee}}).eq("id",k.id);if(Z)throw Z;const{error:ye}=await re.from("party_inventory_log").insert([{party_id:e,item_name:z.name,quantity:1,from_type:"party",from_id:e,to_type:"character",to_id:k.id}]);if(ye)throw ye})),await Promise.all([T(),F(),n.invalidateQueries({queryKey:["character",k.id]}),n.invalidateQueries({queryKey:["party",e]})]),x([])}catch(k){c(k instanceof Error?k.message:"Failed to transfer items"),await T()}},Q=async(k,K)=>{try{c(null);const z=t.find(te=>te.id===k);if(!z)throw new Error("Character not found");if(!K.name){console.warn("Attempted to transfer an item without a name.");return}const I=z.equipment||{inventory:[],equipped:{weapons:[]},money:{gold:0,silver:0,copper:0}};let he=I.inventory||[];const Ee=he.findIndex(te=>te.name===K.name);if(Ee===-1){console.warn(`Item "${K.name}" not found in character ${k}'s inventory.`);return}he[Ee].quantity>1?he[Ee].quantity-=1:he=[...he.slice(0,Ee),...he.slice(Ee+1)];const{error:be}=await re.from("characters").update({equipment:{...I,inventory:he}}).eq("id",z.id);if(be)throw be;const Z=s.find(te=>te.name===K.name);if(Z){const{error:te}=await re.from("party_inventory").update({quantity:Z.quantity+1}).eq("id",Z.id);if(te)throw te}else{const{error:te}=await re.from("party_inventory").insert([{party_id:e,name:K.name,quantity:1,category:K.category||"misc",description:K.description||K.effect}]).select();if(te)throw te}const{error:ye}=await re.from("party_inventory_log").insert([{party_id:e,item_name:K.name,quantity:1,from_type:"character",from_id:z.id,to_type:"party",to_id:e}]);if(ye)throw ye;await Promise.all([T(),F(),n.invalidateQueries({queryKey:["character",z.id]}),n.invalidateQueries({queryKey:["party",e]})])}catch(z){c(z instanceof Error?z.message:"Failed to transfer item to party")}},Y=s.map(k=>k.category).filter(k=>typeof k=="string"&&k.trim()!==""),H=["all",...new Set(Y)],B=s.filter(k=>{const z=(k.name||"").toLowerCase().includes(d.toLowerCase()),I=f==="all"||k.category===f;return z&&I}),A=t.find(k=>k.id===g),M=((G=A==null?void 0:A.equipment)==null?void 0:G.inventory)??[];return a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-12 lg:col-span-7",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Party Inventory"}),a.jsx(V,{variant:"secondary",onClick:()=>_(!N),children:N?"Hide History":"Show History"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search items...",value:d,onChange:k=>h(k.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("select",{value:f,onChange:k=>p(k.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:H.map(k=>a.jsx("option",{value:k,children:k==="all"?"All Categories":k},k))})]})]}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[l?a.jsx(ze,{}):u?a.jsx(Ce,{message:u}):B.map(k=>a.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer ${E.includes(k.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-100"}`,onClick:()=>{k.id?x(K=>K.includes(k.id)?K.filter(z=>z!==k.id):[...K,k.id]):console.warn("Attempted to select an item without an ID:",k)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:k.name||"Unnamed Item"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",k.quantity]})]}),k.category&&a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100",children:k.category})]}),k.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:k.description})]},k.id)),!l&&B.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:d||f!=="all"?"No items found matching filters.":"Party inventory is empty."})})]})]})}),a.jsxs("div",{className:"col-span-12 lg:col-span-5",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Transfer Items"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Character"}),a.jsxs("select",{value:g,onChange:k=>b(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Choose a character..."}),t.map(k=>a.jsxs("option",{value:k.id,children:[k.name," (",k.kin," ",k.profession,")"]},k.id))]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsx(V,{variant:"secondary",icon:R0,disabled:!g||E.length===0,onClick:O,title:"Transfer selected items from Party to Character",children:"To Character"})}),g&&A&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-4",children:[A.name,"'s Inventory"]}),a.jsxs("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded p-2",children:[M.map((k,K)=>a.jsxs("div",{className:"p-2 border-b flex items-center justify-between text-sm",children:[a.jsxs("span",{children:[k.name||"Unnamed Item"," (Qty: ",k.quantity,")"]}),a.jsx(V,{variant:"secondary",size:"sm",icon:E2,onClick:()=>Q(g,k),disabled:!k.name,title:k.name?`Transfer ${k.name} to Party`:"Cannot transfer unnamed item",children:"Give"})]},k.id||`${k.name||"unknown"}-${K}`)),M.length===0&&a.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Character inventory is empty."})]})]})]}),N&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Transaction History"}),a.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[y.map(k=>{var K,z;return a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"font-medium",children:[k.item_name||"Unknown Item"," (Qty: ",k.quantity,")"]}),a.jsx("span",{className:"text-gray-500 text-xs",children:new Date(k.timestamp).toLocaleString()})]}),a.jsxs("p",{className:"text-gray-600 text-xs",children:[k.from_type==="party"?"Party":((K=t.find(I=>I.id===k.from_id))==null?void 0:K.name)||"Unknown Char","  ",k.to_type==="party"?"Party":((z=t.find(I=>I.id===k.to_id))==null?void 0:z.name)||"Unknown Char"]})]},k.id)}),y.length===0&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:"No transactions recorded yet."})]})]})]})]})}async function DU(){const{data:e,error:t}=await re.from("monsters").select("*");if(t)throw console.error("Error fetching all monsters:",t),t;return e||[]}function MU(e){const t=Zr();w.useEffect(()=>{if(!e)return;const r=[],n=re.channel(`encounter:${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"encounters",filter:`id=eq.${e}`},i=>{console.log("Encounter updated:",i),t.invalidateQueries({queryKey:["encounterDetails",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter channel error for ${e}:`,l)});r.push(n);const s=re.channel(`encounter_combatants:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`encounter_id=eq.${e}`},i=>{console.log("Encounter combatants changed:",i),t.invalidateQueries({queryKey:["encounterCombatants",e]})}).subscribe((i,l)=>{i==="SUBSCRIBED"&&console.log(`Subscribed to encounter_combatants:${e}`),(i==="CHANNEL_ERROR"||i==="TIMED_OUT")&&console.error(`Encounter combatants channel error for ${e}:`,l)});return r.push(s),()=>{console.log(`Unsubscribing from encounter channels for ${e}`),r.forEach(i=>re.removeChannel(i))}},[e,t])}function FU({partyId:e,partyMembers:t,isDM:r}){const n=Zr(),{activeEncounter:s,fetchActiveEncounter:i,clearActiveEncounter:l}=ir(),[o,u]=w.useState(""),[c,d]=w.useState(""),[h,f]=w.useState(""),[p,g]=w.useState(""),[b,E]=w.useState(""),[x,y]=w.useState(""),[v,N]=w.useState({}),[_,S]=w.useState(!1),[R,j]=w.useState(""),[D,T]=w.useState("");w.useEffect(()=>{e?(async()=>{n.invalidateQueries({queryKey:["latestEncounter",e]});const ee=await mE(e);ee&&n.setQueryData(["encounterDetails",ee.id],ee)})():(n.removeQueries({queryKey:["latestEncounter",e]}),n.removeQueries({queryKey:["encounterDetails"]}),n.removeQueries({queryKey:["encounterCombatants"]}))},[e,n]);const F=s==null?void 0:s.id,{data:O,isLoading:Q,error:Y}=jt({queryKey:["encounterDetails",F],queryFn:()=>F?z6(F):Promise.resolve(null),enabled:!!F,initialData:s}),{data:H,isLoading:B,error:A}=jt({queryKey:["encounterCombatants",F],queryFn:()=>F?pE(F):Promise.resolve([]),enabled:!!F}),M=w.useMemo(()=>(H==null?void 0:H.slice().sort((W,ee)=>{const pe=W.initiative_roll??-1/0,Ne=ee.initiative_roll??-1/0;return pe!==Ne?Ne-pe:(W.display_name??"").localeCompare(ee.display_name??"")}))||[],[H]),{data:G,isLoading:k,error:K}=jt({queryKey:["allMonsters"],queryFn:DU});MU(F),w.useEffect(()=>{if(!M)return;const W={};M.forEach(ee=>{W[ee.id]={current_hp:String(ee.current_hp??ee.max_hp??0),current_wp:ee.max_wp!=null?String(ee.current_wp??ee.max_wp):void 0,initiative_roll:ee.initiative_roll!=null?String(ee.initiative_roll):""}}),N(W)},[M]),w.useEffect(()=>{O&&(j(O.name),T(O.description||""))},[O]);const z=jr({mutationFn:W=>q6(e,W.name,W.description),onSuccess:W=>{n.invalidateQueries({queryKey:["latestEncounter",e]}),n.setQueryData(["encounterDetails",W.id],W),u(""),d("")}}),I=jr({mutationFn:W=>{if(!F)throw new Error("No active encounter");return V6(F,W)},onSuccess:()=>{n.invalidateQueries({queryKey:["encounterCombatants",F]}),f(""),g(""),E(""),y("")}}),he=jr({mutationFn:W=>gE(W.id,W.updates),onSuccess:W=>{n.setQueryData(["encounterCombatants",F],ee=>(ee==null?void 0:ee.map(pe=>pe.id===W.id?W:pe))??[]),N(ee=>({...ee,[W.id]:{current_hp:String(W.current_hp??W.max_hp??0),current_wp:W.max_wp!=null?String(W.current_wp??W.max_wp):void 0,initiative_roll:W.initiative_roll!=null?String(W.initiative_roll):""}}))}}),Ee=jr({mutationFn:G6,onSuccess:(W,ee)=>{n.invalidateQueries({queryKey:["encounterCombatants",F]}),N(pe=>{const Ne={...pe};return delete Ne[ee],Ne})}}),be=jr({mutationFn:W=>{if(!F)throw new Error("No active encounter to update");return W6(F,W)},onSuccess:W=>{n.setQueryData(["encounterDetails",F],W),n.invalidateQueries({queryKey:["latestEncounter",e]}),S(!1),j(W.name),T(W.description||"")}}),Z=W=>{W.preventDefault(),o.trim()&&z.mutate({name:o.trim(),description:c.trim()||void 0})},ye=()=>{!h||!F||I.mutate({type:"character",characterId:h,initiativeRoll:x?parseInt(x):null})},te=()=>{!p||!F||I.mutate({type:"monster",monsterId:p,customName:b||void 0,initiativeRoll:x?parseInt(x):null})},ce=W=>{const ee=v[W];if(!ee)return;const pe={current_hp:parseInt(ee.current_hp),initiative_roll:ee.initiative_roll?parseInt(ee.initiative_roll):null},Ne=M.find(et=>et.id===W);(Ne==null?void 0:Ne.max_wp)!=null&&(ee.current_wp!==void 0&&ee.current_wp!==null&&ee.current_wp.trim()!==""?pe.current_wp=parseInt(ee.current_wp):ee.current_wp===""&&(pe.current_wp=null));const Re=M.find(et=>et.id===W);if(!Re)return;let We=!1;pe.current_hp!==void 0&&pe.current_hp!==Re.current_hp&&(We=!0),pe.initiative_roll!==void 0&&pe.initiative_roll!==Re.initiative_roll&&(We=!0),pe.current_wp!==void 0&&pe.current_wp!==Re.current_wp&&(We=!0),We?he.mutate({id:W,updates:pe}):console.log("No changes to save for combatant",W)},_e=()=>{F&&be.mutate({status:"active",current_round:1})},Ie=()=>{F&&be.mutate({status:"completed"})},Le=()=>{F&&be.mutate({name:R,description:D})},Be=w.useMemo(()=>{const W=new Set(M.map(ee=>ee.character_id));return t.filter(ee=>!W.has(ee.id))},[t,M]);if(!r)return a.jsx("div",{className:"p-4 text-center text-gray-600",children:"Only the DM can view encounter details."});if(k)return a.jsx(ze,{});if(K)return a.jsx(Ce,{message:K.message});const $=O;return a.jsx("div",{className:"space-y-6",children:$?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[_?a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",value:R,onChange:W=>j(W.target.value),className:"w-full px-3 py-2 border rounded-md text-xl font-semibold",placeholder:"Encounter Name"}),a.jsx("textarea",{value:D,onChange:W=>T(W.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md text-gray-600",placeholder:"Description (optional)"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(V,{size:"sm",onClick:Le,isLoading:be.isPending,Icon:Pr,children:"Save"}),a.jsx(V,{size:"sm",variant:"secondary",onClick:()=>S(!1),Icon:ih,children:"Cancel"})]})]}):a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold",children:$.name}),$.description&&a.jsx("p",{className:"text-gray-600",children:$.description}),a.jsxs("p",{className:"mt-2 text-sm",children:["Status:"," ",a.jsx("span",{className:`font-medium ${$.status==="active"?"text-green-600":$.status==="planning"?"text-yellow-600":"text-blue-600"}`,children:$.status}),$.current_round!=null&&$.status==="active"&&` | Round: ${$.current_round}`]})]}),a.jsx(V,{size:"sm",variant:"ghost",onClick:()=>S(!0),Icon:D2,"aria-label":"Edit Encounter Details"})]}),a.jsxs("div",{className:"flex space-x-4 mt-4",children:[$.status==="planning"&&a.jsx(V,{onClick:_e,isLoading:be.isPending,Icon:PA,children:"Start Encounter"}),$.status==="active"&&a.jsx(V,{onClick:Ie,isLoading:be.isPending,Icon:$2,variant:"secondary",children:"End Encounter"}),$.status==="completed"&&a.jsx("p",{className:"text-gray-600 italic",children:"Encounter completed."})]})]}),($.status==="planning"||$.status==="active")&&a.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow space-y-6",children:[a.jsx("h4",{className:"text-lg font-medium",children:"Add Combatants"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("select",{value:h,onChange:W=>f(W.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Party Member"}),Be.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]}),a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:x,onChange:W=>y(W.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(V,{onClick:ye,Icon:H0,isLoading:I.isPending,disabled:!h,children:"Add Member"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("select",{value:p,onChange:W=>g(W.target.value),className:"w-full px-3 py-2 border rounded-md",children:[a.jsx("option",{value:"",children:"Select Monster"}),G==null?void 0:G.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]}),a.jsx("input",{type:"text",placeholder:"Custom Name (Optional)",value:b,onChange:W=>E(W.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx("input",{type:"number",placeholder:"Initiative (Optional)",value:x,onChange:W=>y(W.target.value),className:"w-full px-3 py-2 border rounded-md"}),a.jsx(V,{onClick:te,Icon:BA,isLoading:I.isPending,disabled:!p,children:"Add Monster"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-medium mb-4",children:"Combatants"}),B?a.jsx(ze,{}):A?a.jsx(Ce,{message:A.message}):M.length===0?a.jsx("p",{className:"text-gray-600",children:"No combatants added yet."}):a.jsx("ul",{className:"space-y-3",children:M.map(W=>{var ee,pe,Ne,Re,We,et,St,cr;return a.jsxs("li",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between bg-white p-4 rounded-lg shadow",children:[a.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[a.jsx("p",{className:"font-semibold",children:W.display_name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[a.jsx(D0,{size:14,className:"inline mr-1 text-red-500"}),((ee=v[W.id])==null?void 0:ee.current_hp)??W.current_hp," / ",W.max_hp,W.max_wp!=null&&a.jsxs(a.Fragment,{children:[a.jsx(Pn,{size:14,className:"inline ml-2 mr-1 text-blue-500"}),((pe=v[W.id])==null?void 0:pe.current_wp)??W.current_wp," / ",W.max_wp]})]}),(((Ne=v[W.id])==null?void 0:Ne.initiative_roll)||W.initiative_roll!=null)&&a.jsxs("p",{className:"text-xs text-gray-500",children:[a.jsx(B2,{size:12,className:"inline mr-1 text-green-500"}),"Initiative: ",((Re=v[W.id])==null?void 0:Re.initiative_roll)??W.initiative_roll]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-end sm:justify-start",children:[a.jsx("input",{type:"number","aria-label":`${W.display_name} Current HP`,value:((We=v[W.id])==null?void 0:We.current_hp)??"",onChange:dr=>N(X=>({...X,[W.id]:{...X[W.id],current_hp:dr.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"HP"}),W.max_wp!=null&&a.jsx("input",{type:"number","aria-label":`${W.display_name} Current WP`,value:((et=v[W.id])==null?void 0:et.current_wp)??"",onChange:dr=>N(X=>({...X,[W.id]:{...X[W.id],current_wp:dr.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"WP"}),a.jsx("input",{type:"number","aria-label":`${W.display_name} Initiative`,value:((St=v[W.id])==null?void 0:St.initiative_roll)??"",onChange:dr=>N(X=>({...X,[W.id]:{...X[W.id],initiative_roll:dr.target.value}})),className:"w-16 px-2 py-1 border rounded-md text-sm",placeholder:"Init"}),a.jsx(V,{size:"sm",onClick:()=>ce(W.id),Icon:Pr,isLoading:he.isPending&&((cr=he.variables)==null?void 0:cr.id)===W.id,children:"Save"}),a.jsx(V,{size:"sm",variant:"danger",onClick:()=>Ee.mutate(W.id),Icon:Kr,isLoading:Ee.isPending&&Ee.variables===W.id})]})]},W.id)})})]})]}):a.jsxs("form",{onSubmit:Z,className:"bg-gray-50 p-6 rounded-lg shadow space-y-4",children:[a.jsx("p",{className:"text-gray-700",children:"No encounter. Create one to begin."}),a.jsx("div",{children:a.jsx("input",{type:"text",placeholder:"Encounter Name",value:o,onChange:W=>u(W.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md"})}),a.jsx("div",{children:a.jsx("textarea",{placeholder:"Description (optional)",value:c,onChange:W=>d(W.target.value),rows:2,className:"w-full px-3 py-2 border rounded-md"})}),a.jsx(V,{Icon:ep,type:"submit",isLoading:z.isPending,children:"Create Encounter"})]})})}function UU(){const{id:e}=S0(),t=Xr(),{user:r,isDM:n}=Ot(),s=Zr(),[i,l]=w.useState(!1),[o,u]=w.useState(null),[c,d]=w.useState(null),[h,f]=w.useState("members"),{data:p,isLoading:g,error:b}=jt({queryKey:["party",e],queryFn:()=>EN(e),enabled:!!e}),E=jr({mutationFn:j=>{if(!e)throw new Error("Party ID is missing");return k7(e,j)},onSuccess:()=>{s.invalidateQueries({queryKey:["party",e]}),s.invalidateQueries({queryKey:["availableCharacters"]}),u(null),d(null)}}),x=jr({mutationFn:()=>{if(!e)throw new Error("Party ID is missing");return S7(e)},onSuccess:()=>{s.invalidateQueries({queryKey:["parties"]}),t("/adventure-party")}}),y=j=>{d(j),u("removeMember")},v=()=>{c&&E.mutate(c)},N=()=>{x.mutate()},_=r&&p&&r.id===p.created_by&&n(),S=`${window.location.origin}/party/join/${e}`;if(g)return a.jsx("div",{className:"flex justify-center items-center p-8",children:a.jsx(ze,{size:"lg"})});if(b)return a.jsx("div",{className:"p-8",children:a.jsx(Ce,{message:b.message})});if(!p)return a.jsx("div",{className:"p-8",children:a.jsx(Ce,{message:"Party not found."})});const R=[{id:"members",label:"Members",icon:ts},{id:"notes",label:"Notes",icon:OA},{id:"tasks",label:"Tasks",icon:wA},{id:"inventory",label:"Inventory",icon:N2},{id:"encounter",label:"Encounter",icon:U0}];return a.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[a.jsxs("div",{className:"bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:p.name}),a.jsx("p",{className:"text-gray-500 mt-1",children:"A band of brave adventurers."})]}),_&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 md:mt-0",children:[a.jsx(V,{variant:"primary",icon:R2,onClick:()=>l(!i),children:"Invite Player"}),a.jsx(V,{variant:"danger",icon:Kr,onClick:()=>u("deleteParty"),children:"Delete Party"})]})]}),i&&_&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[a.jsx("h3",{className:"font-semibold text-blue-800",children:"Share this link to invite players:"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-white p-2 rounded-md",children:[a.jsx("input",{type:"text",readOnly:!0,value:S,className:"w-full bg-transparent text-gray-700 focus:outline-none"}),a.jsx(TU,{textToCopy:S})]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-6 px-6","aria-label":"Tabs",children:R.map(j=>a.jsxs("button",{onClick:()=>f(j.id),className:`shrink-0 flex items-center gap-2 px-1 py-4 text-sm font-medium border-b-2 ${h===j.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(j.icon,{className:"w-5 h-5"}),j.label]},j.id))})}),a.jsxs("div",{className:"p-6",children:[h==="members"&&a.jsx("div",{className:"space-y-4",children:p.members.length>0?p.members.map(j=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-2 bg-gray-200 rounded-full",children:a.jsx(Xa,{className:"w-6 h-6 text-gray-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.kin," ",j.profession]})]})]}),_&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"outline",size:"sm",onClick:()=>t(`/character/${j.id}`),"aria-label":`View ${j.name}'s sheet`,icon:kA,children:"View Sheet"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>y(j.id),"aria-label":`Remove ${j.name}`,children:a.jsx(py,{className:"w-5 h-5 text-red-500"})})]})]},j.id)):a.jsx("p",{className:"text-center text-gray-500 py-8",children:"This party has no members yet. Invite someone!"})}),h==="notes"&&a.jsx(CU,{partyId:e,isDM:_}),h==="tasks"&&a.jsx(OU,{partyId:e,isDM:_}),h==="inventory"&&a.jsx(PU,{partyId:e,members:p.members,isDM:_}),h==="encounter"&&a.jsx(FU,{partyId:e,partyMembers:p.members,isDM:_})]})]}),a.jsx(n1,{isOpen:o==="removeMember",onClose:()=>u(null),onConfirm:v,title:"Remove Member",description:"Are you sure you want to remove this character from the party? This action cannot be undone.",confirmText:"Remove",isDestructive:!0,isLoading:E.isPending,icon:a.jsx(py,{className:"w-6 h-6 text-red-500"})}),a.jsx(n1,{isOpen:o==="deleteParty",onClose:()=>u(null),onConfirm:N,title:"Delete Party",description:"Are you sure you want to permanently delete this party? All members will be removed. This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:x.isPending,icon:a.jsx(U2,{className:"w-6 h-6 text-red-500"})})]})}function BU(){var E;const{id:e}=S0(),t=Xr(),{user:r}=Ot(),n=Zr(),[s,i]=w.useState(""),{data:l,isLoading:o,error:u}=jt({queryKey:["party",e],queryFn:()=>EN(e),enabled:!!e}),{data:c=[],isLoading:d,error:h}=jt({queryKey:["availableCharacters",r==null?void 0:r.id],queryFn:()=>wN(r==null?void 0:r.id),enabled:!!r}),f=jr({mutationFn:async x=>{if(!x)throw new Error("Please select a character");if(!e)throw new Error("Party ID is missing");const{error:y}=await re.from("party_members").insert([{party_id:e,character_id:x}]);if(y)throw y},onSuccess:()=>{n.invalidateQueries({queryKey:["party",e]}),n.invalidateQueries({queryKey:["parties"]}),n.invalidateQueries({queryKey:["availableCharacters",r==null?void 0:r.id]}),t(`/party/${e}`)}}),p=()=>{s&&f.mutate(s)},g=o||d,b=(u==null?void 0:u.message)||(h==null?void 0:h.message)||((E=f.error)==null?void 0:E.message);return g?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsx(ze,{size:"lg"})}):b?a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsx(Ce,{message:b}),a.jsx(V,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]}):l?a.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(ts,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Join Adventure Party"}),a.jsxs("p",{className:"text-gray-600 text-lg",children:["You've been invited to join ",a.jsx("b",{children:l.name}),"."]})]}),c.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-center text-gray-700",children:"Select one of your available characters to join the party."}),a.jsx("div",{className:"space-y-3",children:c.map(x=>a.jsxs("div",{onClick:()=>i(x.id),className:`p-4 border rounded-lg cursor-pointer transition-all flex items-center justify-between ${s===x.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-500":"border-gray-200 hover:border-blue-400"}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:x.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[x.kin," ",x.profession]})]}),s===x.id&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:a.jsx(Bi,{className:"w-4 h-4 text-white"})})]},x.id))}),a.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[a.jsx(V,{variant:"secondary",onClick:()=>t("/adventure-party"),children:"Cancel"}),a.jsx(V,{variant:"primary",loading:f.isPending,disabled:!s||f.isPending,onClick:p,children:"Join Party"})]})]}):a.jsxs("div",{className:"text-center py-8 border-t mt-8",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any available characters to join with."}),a.jsx(V,{variant:"primary",onClick:()=>t("/"),children:"Create a Character"})]})]})}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsx(Ce,{message:"Party not found."}),a.jsx(V,{variant:"secondary",onClick:()=>t("/adventure-party"),className:"mt-4",children:"Back to Parties"})]})}function HU(){return a.jsxs(a.Fragment,{children:[" ",a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-white focus:text-blue-600",children:"Skip to main content"}),a.jsxs(Hx,{children:[a.jsx(Fr,{path:"/login",element:a.jsx(_U,{})}),a.jsx(Fr,{path:"*",element:a.jsx(SU,{children:a.jsxs(a.Fragment,{children:[a.jsx(r4,{}),a.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:a.jsxs(Hx,{children:[a.jsx(Fr,{path:"/",element:a.jsx($6,{})}),a.jsx(Fr,{path:"/character/:id",element:a.jsx(SI,{})}),a.jsx(Fr,{path:"/compendium",element:a.jsx(_7,{})}),a.jsx(Fr,{path:"/adventure-party",element:a.jsx(T7,{})}),a.jsx(Fr,{path:"/party/:id",element:a.jsx(UU,{})}),a.jsx(Fr,{path:"/party/join/:id",element:a.jsx(BU,{})}),a.jsx(Fr,{path:"/notes",element:a.jsx(C7,{})}),a.jsx(Fr,{path:"/settings",element:a.jsx(EU,{})}),a.jsx(Fr,{path:"*",element:a.jsx(No,{to:"/",replace:!0})})]})}),a.jsx(kU,{})]})})})]})]})}function $U(){const{showWarning:e,extendSession:t}=XA();return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-amber-100 rounded-full",children:a.jsx(lh,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Session Timeout Warning"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your session will expire in 30 seconds due to inactivity."})]})]}),a.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Et,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-amber-700",children:'Click "Continue Session" to stay logged in, or your session will end automatically.'})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx(V,{variant:"primary",onClick:t,children:"Continue Session"})})]})}):null}function zU(){return a.jsx(WC,{children:a.jsx(JA,{children:a.jsxs(Fw,{client:Y2,children:[a.jsx(VA,{children:a.jsx(QA,{children:a.jsx(ZA,{children:a.jsx(t4,{children:a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(HU,{}),a.jsx($U,{})]})})})})}),!1]})})})}Sw(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsxs(Fw,{client:Y2,children:[" ",a.jsx(zU,{})]})}));export{Od as g};
